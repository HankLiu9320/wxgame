	define("cocos2d-js-min.js", function(require, module, exports){ 			
!(function(t,e,i){function n(i,o){var s=e[i];if(!s){var a=t[i];if(!a){var c="function"==typeof require&&require;if(!o&&c)return c(i,!0);if(r)return r(i,!0);var h=new Error("Cannot find module '"+i+"'");throw h.code="MODULE_NOT_FOUND",h}var l={};s=e[i]={exports:l},a[0]((function(t){return n(a[1][t]||t)}),s,l)}return s.exports}for(var r="function"==typeof require&&require,o=0;o<i.length;o++)n(i[o])})({1:[(function(t,e,i){}),{}],2:[(function(t,e,i){function n(t){var e=cc.game.CONFIG_KEY,i=parseInt(t[e.renderMode])||0;(isNaN(i)||i>2||i<0)&&(t[e.renderMode]=0),cc._renderType=cc.game.RENDER_TYPE_CANVAS,cc._supportRender=!1,0===i?cc.sys.capabilities.opengl?(cc._renderType=cc.game.RENDER_TYPE_WEBGL,cc._supportRender=!0):cc.sys.capabilities.canvas&&(cc._renderType=cc.game.RENDER_TYPE_CANVAS,cc._supportRender=!0):1===i&&cc.sys.capabilities.canvas?(cc._renderType=cc.game.RENDER_TYPE_CANVAS,cc._supportRender=!0):2===i&&cc.sys.capabilities.opengl&&(cc._renderType=cc.game.RENDER_TYPE_WEBGL,cc._supportRender=!0)}function r(){cc._engineLoaded=!0,console.log(cc.ENGINE_VERSION),a&&a()}function o(){window.removeEventListener("load",o,!1),r()}cc._LogInfos=cc._LogInfos||{};window.CocosEngine=cc.ENGINE_VERSION="1.6.0",cc._drawingUtil=null,cc._renderContext=null,cc._supportRender=!1,cc._canvas=null,cc.container=null,cc._gameDiv=null,t("./cocos2d/core/utils/index.js"),t("./cocos2d/core/platform/CCSys");var s=!1,a=null;cc._engineLoaded=!1,cc.initEngine=function(t,e){if(s){var i=a;a=function(){i&&i(),e&&e()}}else a=e,!cc.game.config&&t?cc.game.config=t:cc.game.config||cc.game._loadConfig(),n(t=cc.game.config),document.body?r():window.addEventListener("load",o,!1),s=!0}}),{"./cocos2d/core/platform/CCSys":155,"./cocos2d/core/utils/index.js":195}],3:[(function(t,e,i){function n(t,e){return function(i){"use strict";if(1!==arguments.length){var n="";2===arguments.length?n="Arguments: "+arguments[1]:arguments.length>2&&(n="Arguments: "+cc.js.shiftArguments.apply(null,arguments).join(", ")),t(e+" "+i+", please go to "+s+"#"+i+" to see details. "+n)}else t(e+" "+i+", please go to "+s+"#"+i+" to see details.")}}var r,o=t("./cocos2d/core/platform/CCEnum");cc.DebugMode=o({NONE:0,INFO:1,WARN:2,ERROR:3,INFO_FOR_WEB_PAGE:4,WARN_FOR_WEB_PAGE:5,ERROR_FOR_WEB_PAGE:6});cc.log||console.log;cc._initDebugSetting=function(t){if(cc.log=cc.logID=cc.warn=cc.warnID=cc.error=cc.errorID=cc._throw=cc.assert=cc.assertID=function(){},t!==cc.DebugMode.NONE){t>cc.DebugMode.ERROR?(function(){function e(t){if(cc._canvas){if(!r){var e=document.createElement("Div");e.setAttribute("id","logInfoDiv"),e.setAttribute("width","200"),e.setAttribute("height",cc._canvas.height);var i=e.style;i.zIndex="99999",i.position="absolute",i.top=i.left="0",(r=document.createElement("textarea")).setAttribute("rows","20"),r.setAttribute("cols","30"),r.setAttribute("disabled","true");var n=r.style;n.backgroundColor="transparent",n.borderBottom="1px solid #cccccc",n.borderTopWidth=n.borderLeftWidth=n.borderRightWidth="0px",n.borderTopStyle=n.borderLeftStyle=n.borderRightStyle="none",n.padding="0px",n.margin=0,e.appendChild(r),cc._canvas.parentNode.appendChild(e)}r.value=r.value+t+"\r\n",r.scrollTop=r.scrollHeight}}cc.error=function(){e("ERROR :  "+cc.js.formatStr.apply(null,arguments))},cc.assert=function(t,i){"use strict";!t&&i&&e("ASSERT: "+(i=cc.js.formatStr.apply(null,cc.js.shiftArguments.apply(null,arguments))))},t!==cc.DebugMode.ERROR_FOR_WEB_PAGE&&(cc.warn=function(){e("WARN :  "+cc.js.formatStr.apply(null,arguments))}),t===cc.DebugMode.INFO_FOR_WEB_PAGE&&(cc.log=cc.info=function(){e(cc.js.formatStr.apply(null,arguments))})})():console&&console.log.apply&&(console.error||(console.error=console.log),console.warn||(console.warn=console.log),console.error.bind?cc.error=console.error.bind(console):cc.error=function(){return console.error.apply(console,arguments)},cc.assert=function(t,e){if(!t)throw e&&(e=cc.js.formatStr.apply(null,cc.js.shiftArguments.apply(null,arguments))),new Error(e)}),t!==cc.DebugMode.ERROR&&(console.warn.bind?cc.warn=console.warn.bind(console):cc.warn=function(){return console.warn.apply(console,arguments)}),t===cc.DebugMode.INFO&&(console.log.bind?cc.log=console.log.bind(console):cc.log=function(){return console.log.apply(console,arguments)},cc.info=function(){(console.info||console.log).apply(console,arguments)}),cc.warnID=n(cc.warn,"Warning"),cc.errorID=n(cc.error,"Error"),cc.logID=n(cc.log,"Log");var e=n((function(){for(var t=[!1],e=0;e<arguments.length;++e)t.push(arguments[e]);cc.assert.apply(null,t)}),"Assert");cc.assertID=function(t){"use strict";t||e.apply(null,cc.js.shiftArguments.apply(null,arguments))}}},cc._throw=function(t){var e=t.stack;e?cc.error(e):cc.error(t)};var s="https://github.com/cocos-creator/engine/blob/master/EngineErrorMap.md"}),{"./cocos2d/core/platform/CCEnum":148}],4:[(function(t,e,i){}),{}],5:[(function(t,e,i){cc.Action=cc._Class.extend({ctor:function(){this.originalTarget=null,this.target=null,this.tag=cc.Action.TAG_INVALID},clone:function(){var t=new cc.Action;return t.originalTarget=null,t.target=null,t.tag=this.tag,t},isDone:function(){return!0},startWithTarget:function(t){this.originalTarget=t,this.target=t},stop:function(){this.target=null},step:function(t){cc.logID(1006)},update:function(t){cc.logID(1007)},getTarget:function(){return this.target},setTarget:function(t){this.target=t},getOriginalTarget:function(){return this.originalTarget},setOriginalTarget:function(t){this.originalTarget=t},getTag:function(){return this.tag},setTag:function(t){this.tag=t},retain:function(){},release:function(){}}),cc.Action.TAG_INVALID=-1,cc.FiniteTimeAction=cc.Action.extend({_duration:0,ctor:function(){cc.Action.prototype.ctor.call(this),this._duration=0},getDuration:function(){return this._duration*(this._timesForRepeat||1)},setDuration:function(t){this._duration=t},reverse:function(){return cc.logID(1008),null},clone:function(){return new cc.FiniteTimeAction}}),cc.Speed=cc.Action.extend({_speed:0,_innerAction:null,ctor:function(t,e){cc.Action.prototype.ctor.call(this),this._speed=0,this._innerAction=null,t&&this.initWithAction(t,e)},getSpeed:function(){return this._speed},setSpeed:function(t){this._speed=t},initWithAction:function(t,e){if(!t)throw new Error("cc.Speed.initWithAction(): action must be non nil");return this._innerAction=t,this._speed=e,!0},clone:function(){var t=new cc.Speed;return t.initWithAction(this._innerAction.clone(),this._speed),t},startWithTarget:function(t){cc.Action.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},stop:function(){this._innerAction.stop(),cc.Action.prototype.stop.call(this)},step:function(t){this._innerAction.step(t*this._speed)},isDone:function(){return this._innerAction.isDone()},reverse:function(){return new cc.Speed(this._innerAction.reverse(),this._speed)},setInnerAction:function(t){this._innerAction!==t&&(this._innerAction=t)},getInnerAction:function(){return this._innerAction}}),cc.speed=function(t,e){return new cc.Speed(t,e)},cc.Follow=cc.Action.extend({_followedNode:null,_boundarySet:!1,_boundaryFullyCovered:!1,_halfScreenSize:null,_fullScreenSize:null,_worldRect:null,leftBoundary:0,rightBoundary:0,topBoundary:0,bottomBoundary:0,ctor:function(t,e){cc.Action.prototype.ctor.call(this),this._followedNode=null,this._boundarySet=!1,this._boundaryFullyCovered=!1,this._halfScreenSize=null,this._fullScreenSize=null,this.leftBoundary=0,this.rightBoundary=0,this.topBoundary=0,this.bottomBoundary=0,this._worldRect=cc.rect(0,0,0,0),t&&(e?this.initWithTarget(t,e):this.initWithTarget(t))},clone:function(){var t=new cc.Follow,e=this._worldRect,i=new cc.Rect(e.x,e.y,e.width,e.height);return t.initWithTarget(this._followedNode,i),t},isBoundarySet:function(){return this._boundarySet},setBoudarySet:function(t){this._boundarySet=t},initWithTarget:function(t,e){if(!t)throw new Error("cc.Follow.initWithAction(): followedNode must be non nil");var i=this;e=e||cc.rect(0,0,0,0),i._followedNode=t,i._worldRect=e,i._boundarySet=!cc._rectEqualToZero(e),i._boundaryFullyCovered=!1;var n=cc.director.getWinSize();return i._fullScreenSize=cc.p(n.width,n.height),i._halfScreenSize=cc.pMult(i._fullScreenSize,.5),i._boundarySet&&(i.leftBoundary=-(e.x+e.width-i._fullScreenSize.x),i.rightBoundary=-e.x,i.topBoundary=-e.y,i.bottomBoundary=-(e.y+e.height-i._fullScreenSize.y),i.rightBoundary<i.leftBoundary&&(i.rightBoundary=i.leftBoundary=(i.leftBoundary+i.rightBoundary)/2),i.topBoundary<i.bottomBoundary&&(i.topBoundary=i.bottomBoundary=(i.topBoundary+i.bottomBoundary)/2),i.topBoundary===i.bottomBoundary&&i.leftBoundary===i.rightBoundary&&(i._boundaryFullyCovered=!0)),!0},step:function(t){var e=this.target.convertToWorldSpaceAR(cc.Vec2.ZERO),i=this._followedNode.convertToWorldSpaceAR(cc.Vec2.ZERO),n=cc.pSub(e,i),r=this.target.parent.convertToNodeSpaceAR(cc.pAdd(n,this._halfScreenSize));if(this._boundarySet){if(this._boundaryFullyCovered)return;this.target.setPosition(cc.clampf(r.x,this.leftBoundary,this.rightBoundary),cc.clampf(r.y,this.bottomBoundary,this.topBoundary))}else this.target.setPosition(r.x,r.y)},isDone:function(){return!this._followedNode.isRunning()},stop:function(){this.target=null,cc.Action.prototype.stop.call(this)}}),cc.follow=function(t,e){return new cc.Follow(t,e)}}),{}],6:[(function(t,e,i){function n(t){for(var e=[],i=t.length-1;i>=0;i--)e.push(cc.p(t[i].x,t[i].y));return e}function r(t){for(var e=[],i=0;i<t.length;i++)e.push(cc.p(t[i].x,t[i].y));return e}cc.cardinalSplineAt=function(t,e,i,n,r,o){var s=o*o,a=s*o,c=(1-r)/2,h=c*(2*s-a-o),l=c*(-a+s)+(2*a-3*s+1),u=c*(a-2*s+o)+(-2*a+3*s),d=c*(a-s),_=t.x*h+e.x*l+i.x*u+n.x*d,f=t.y*h+e.y*l+i.y*u+n.y*d;return cc.p(_,f)},cc.getControlPointAt=function(t,e){return t[Math.min(t.length-1,Math.max(e,0))]},cc.CardinalSplineTo=cc.ActionInterval.extend({_points:null,_deltaT:0,_tension:0,_previousPosition:null,_accumulatedDiff:null,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),this._points=[],void 0!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){if(!e||0===e.length)throw new Error("Invalid configuration. It must at least have one control point");return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this.setPoints(e),this._tension=i,!0)},clone:function(){var t=new cc.CardinalSplineTo;return t.initWithDuration(this._duration,r(this._points),this._tension),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._deltaT=1/(this._points.length-1),this._previousPosition=cc.p(this.target.getPositionX(),this.target.getPositionY()),this._accumulatedDiff=cc.p(0,0)},update:function(t){t=this._computeEaseTime(t);var e,i,n=this._points;if(1===t)e=n.length-1,i=1;else{var r=this._deltaT;i=(t-r*(e=0|t/r))/r}var o=cc.cardinalSplineAt(cc.getControlPointAt(n,e-1),cc.getControlPointAt(n,e-0),cc.getControlPointAt(n,e+1),cc.getControlPointAt(n,e+2),this._tension,i);if(cc.macro.ENABLE_STACKABLE_ACTIONS){var s,a;if(s=this.target.getPositionX()-this._previousPosition.x,a=this.target.getPositionY()-this._previousPosition.y,0!==s||0!==a){var c=this._accumulatedDiff;s=c.x+s,a=c.y+a,c.x=s,c.y=a,o.x+=s,o.y+=a}}this.updatePosition(o)},reverse:function(){var t=n(this._points);return cc.cardinalSplineTo(this._duration,t,this._tension)},updatePosition:function(t){this.target.setPosition(t),this._previousPosition=t},getPoints:function(){return this._points},setPoints:function(t){this._points=t}}),cc.cardinalSplineTo=function(t,e,i){return new cc.CardinalSplineTo(t,e,i)},cc.CardinalSplineBy=cc.CardinalSplineTo.extend({_startPosition:null,ctor:function(t,e,i){cc.CardinalSplineTo.prototype.ctor.call(this),this._startPosition=cc.p(0,0),void 0!==i&&this.initWithDuration(t,e,i)},startWithTarget:function(t){cc.CardinalSplineTo.prototype.startWithTarget.call(this,t),this._startPosition.x=t.getPositionX(),this._startPosition.y=t.getPositionY()},reverse:function(){for(var t,e=this._points.slice(),i=e[0],r=1;r<e.length;++r)t=e[r],e[r]=cc.pSub(t,i),i=t;var o=n(e);i=o[o.length-1],o.pop(),i.x=-i.x,i.y=-i.y,o.unshift(i);for(r=1;r<o.length;++r)(t=o[r]).x=-t.x,t.y=-t.y,t.x+=i.x,t.y+=i.y,o[r]=t,i=t;return cc.cardinalSplineBy(this._duration,o,this._tension)},updatePosition:function(t){var e=this._startPosition,i=t.x+e.x,n=t.y+e.y;this._previousPosition.x=i,this._previousPosition.y=n,this.target.setPosition(i,n)},clone:function(){var t=new cc.CardinalSplineBy;return t.initWithDuration(this._duration,r(this._points),this._tension),t}}),cc.cardinalSplineBy=function(t,e,i){return new cc.CardinalSplineBy(t,e,i)},cc.CatmullRomTo=cc.CardinalSplineTo.extend({ctor:function(t,e){e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,t,e,.5)},clone:function(){var t=new cc.CatmullRomTo;return t.initWithDuration(this._duration,r(this._points)),t}}),cc.catmullRomTo=function(t,e){return new cc.CatmullRomTo(t,e)},cc.CatmullRomBy=cc.CardinalSplineBy.extend({ctor:function(t,e){cc.CardinalSplineBy.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,t,e,.5)},clone:function(){var t=new cc.CatmullRomBy;return t.initWithDuration(this._duration,r(this._points)),t}}),cc.catmullRomBy=function(t,e){return new cc.CatmullRomBy(t,e)}}),{}],7:[(function(t,e,i){cc.ActionEase=cc.ActionInterval.extend({_inner:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),t&&this.initWithAction(t)},initWithAction:function(t){if(!t)throw new Error("cc.ActionEase.initWithAction(): action must be non nil");return!!this.initWithDuration(t.getDuration())&&(this._inner=t,!0)},clone:function(){var t=new cc.ActionEase;return t.initWithAction(this._inner.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._inner.startWithTarget(this.target)},stop:function(){this._inner.stop(),cc.ActionInterval.prototype.stop.call(this)},update:function(t){this._inner.update(t)},reverse:function(){return new cc.ActionEase(this._inner.reverse())},getInnerAction:function(){return this._inner}}),cc.actionEase=function(t){return new cc.ActionEase(t)},cc.EaseRateAction=cc.ActionEase.extend({_rate:0,ctor:function(t,e){cc.ActionEase.prototype.ctor.call(this),void 0!==e&&this.initWithAction(t,e)},setRate:function(t){this._rate=t},getRate:function(){return this._rate},initWithAction:function(t,e){return!!cc.ActionEase.prototype.initWithAction.call(this,t)&&(this._rate=e,!0)},clone:function(){var t=new cc.EaseRateAction;return t.initWithAction(this._inner.clone(),this._rate),t},reverse:function(){return new cc.EaseRateAction(this._inner.reverse(),1/this._rate)}}),cc.easeRateAction=function(t,e){return new cc.EaseRateAction(t,e)},cc.EaseIn=cc.EaseRateAction.extend({update:function(t){this._inner.update(Math.pow(t,this._rate))},reverse:function(){return new cc.EaseIn(this._inner.reverse(),1/this._rate)},clone:function(){var t=new cc.EaseIn;return t.initWithAction(this._inner.clone(),this._rate),t}}),cc.easeIn=function(t){return{_rate:t,easing:function(t){return Math.pow(t,this._rate)},reverse:function(){return cc.easeIn(1/this._rate)}}},cc.EaseOut=cc.EaseRateAction.extend({update:function(t){this._inner.update(Math.pow(t,1/this._rate))},reverse:function(){return new cc.EaseOut(this._inner.reverse(),1/this._rate)},clone:function(){var t=new cc.EaseOut;return t.initWithAction(this._inner.clone(),this._rate),t}}),cc.easeOut=function(t){return{_rate:t,easing:function(t){return Math.pow(t,1/this._rate)},reverse:function(){return cc.easeOut(1/this._rate)}}},cc.EaseInOut=cc.EaseRateAction.extend({update:function(t){(t*=2)<1?this._inner.update(.5*Math.pow(t,this._rate)):this._inner.update(1-.5*Math.pow(2-t,this._rate))},clone:function(){var t=new cc.EaseInOut;return t.initWithAction(this._inner.clone(),this._rate),t},reverse:function(){return new cc.EaseInOut(this._inner.reverse(),this._rate)}}),cc.easeInOut=function(t){return{_rate:t,easing:function(t){return(t*=2)<1?.5*Math.pow(t,this._rate):1-.5*Math.pow(2-t,this._rate)},reverse:function(){return cc.easeInOut(this._rate)}}},cc.EaseExponentialIn=cc.ActionEase.extend({update:function(t){this._inner.update(0===t?0:Math.pow(2,10*(t-1)))},reverse:function(){return new cc.EaseExponentialOut(this._inner.reverse())},clone:function(){var t=new cc.EaseExponentialIn;return t.initWithAction(this._inner.clone()),t}}),cc._easeExponentialInObj={easing:function(t){return 0===t?0:Math.pow(2,10*(t-1))},reverse:function(){return cc._easeExponentialOutObj}},cc.easeExponentialIn=function(){return cc._easeExponentialInObj},cc.EaseExponentialOut=cc.ActionEase.extend({update:function(t){this._inner.update(1===t?1:1-Math.pow(2,-10*t))},reverse:function(){return new cc.EaseExponentialIn(this._inner.reverse())},clone:function(){var t=new cc.EaseExponentialOut;return t.initWithAction(this._inner.clone()),t}}),cc._easeExponentialOutObj={easing:function(t){return 1===t?1:1-Math.pow(2,-10*t)},reverse:function(){return cc._easeExponentialInObj}},cc.easeExponentialOut=function(){return cc._easeExponentialOutObj},cc.EaseExponentialInOut=cc.ActionEase.extend({update:function(t){1!==t&&0!==t&&(t=(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))),this._inner.update(t)},reverse:function(){return new cc.EaseExponentialInOut(this._inner.reverse())},clone:function(){var t=new cc.EaseExponentialInOut;return t.initWithAction(this._inner.clone()),t}}),cc._easeExponentialInOutObj={easing:function(t){return 1!==t&&0!==t?(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1))):t},reverse:function(){return cc._easeExponentialInOutObj}},cc.easeExponentialInOut=function(){return cc._easeExponentialInOutObj},cc.EaseSineIn=cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:-1*Math.cos(t*Math.PI/2)+1,this._inner.update(t)},reverse:function(){return new cc.EaseSineOut(this._inner.reverse())},clone:function(){var t=new cc.EaseSineIn;return t.initWithAction(this._inner.clone()),t}}),cc._easeSineInObj={easing:function(t){return 0===t||1===t?t:-1*Math.cos(t*Math.PI/2)+1},reverse:function(){return cc._easeSineOutObj}},cc.easeSineIn=function(){return cc._easeSineInObj},cc.EaseSineOut=cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:Math.sin(t*Math.PI/2),this._inner.update(t)},reverse:function(){return new cc.EaseSineIn(this._inner.reverse())},clone:function(){var t=new cc.EaseSineOut;return t.initWithAction(this._inner.clone()),t}}),cc._easeSineOutObj={easing:function(t){return 0===t||1===t?t:Math.sin(t*Math.PI/2)},reverse:function(){return cc._easeSineInObj}},cc.easeSineOut=function(){return cc._easeSineOutObj},cc.EaseSineInOut=cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:-.5*(Math.cos(Math.PI*t)-1),this._inner.update(t)},clone:function(){var t=new cc.EaseSineInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseSineInOut(this._inner.reverse())}}),cc._easeSineInOutObj={easing:function(t){return 0===t||1===t?t:-.5*(Math.cos(Math.PI*t)-1)},reverse:function(){return cc._easeSineInOutObj}},cc.easeSineInOut=function(){return cc._easeSineInOutObj},cc.EaseElastic=cc.ActionEase.extend({_period:.3,ctor:function(t,e){cc.ActionEase.prototype.ctor.call(this),t&&this.initWithAction(t,e)},getPeriod:function(){return this._period},setPeriod:function(t){this._period=t},initWithAction:function(t,e){return cc.ActionEase.prototype.initWithAction.call(this,t),this._period=null==e?.3:e,!0},reverse:function(){return cc.logID(1009),null},clone:function(){var t=new cc.EaseElastic;return t.initWithAction(this._inner.clone(),this._period),t}}),cc.EaseElasticIn=cc.EaseElastic.extend({update:function(t){var e=0;if(0===t||1===t)e=t;else{var i=this._period/4;t-=1,e=-Math.pow(2,10*t)*Math.sin((t-i)*Math.PI*2/this._period)}this._inner.update(e)},reverse:function(){return new cc.EaseElasticOut(this._inner.reverse(),this._period)},clone:function(){var t=new cc.EaseElasticIn;return t.initWithAction(this._inner.clone(),this._period),t}}),cc._easeElasticInObj={easing:function(t){return 0===t||1===t?t:(t-=1,-Math.pow(2,10*t)*Math.sin((t-.075)*Math.PI*2/.3))},reverse:function(){return cc._easeElasticOutObj}},cc.easeElasticIn=function(t){return t&&.3!==t?{_period:t,easing:function(t){return 0===t||1===t?t:(t-=1,-Math.pow(2,10*t)*Math.sin((t-this._period/4)*Math.PI*2/this._period))},reverse:function(){return cc.easeElasticOut(this._period)}}:cc._easeElasticInObj},cc.EaseElasticOut=cc.EaseElastic.extend({update:function(t){var e=0;if(0===t||1===t)e=t;else{var i=this._period/4;e=Math.pow(2,-10*t)*Math.sin((t-i)*Math.PI*2/this._period)+1}this._inner.update(e)},reverse:function(){return new cc.EaseElasticIn(this._inner.reverse(),this._period)},clone:function(){var t=new cc.EaseElasticOut;return t.initWithAction(this._inner.clone(),this._period),t}}),cc._easeElasticOutObj={easing:function(t){return 0===t||1===t?t:Math.pow(2,-10*t)*Math.sin((t-.075)*Math.PI*2/.3)+1},reverse:function(){return cc._easeElasticInObj}},cc.easeElasticOut=function(t){return t&&.3!==t?{_period:t,easing:function(t){return 0===t||1===t?t:Math.pow(2,-10*t)*Math.sin((t-this._period/4)*Math.PI*2/this._period)+1},reverse:function(){return cc.easeElasticIn(this._period)}}:cc._easeElasticOutObj},cc.EaseElasticInOut=cc.EaseElastic.extend({update:function(t){var e=0,i=this._period;if(0===t||1===t)e=t;else{t*=2,i||(i=this._period=.3*1.5);var n=i/4;e=(t-=1)<0?-.5*Math.pow(2,10*t)*Math.sin((t-n)*Math.PI*2/i):Math.pow(2,-10*t)*Math.sin((t-n)*Math.PI*2/i)*.5+1}this._inner.update(e)},reverse:function(){return new cc.EaseElasticInOut(this._inner.reverse(),this._period)},clone:function(){var t=new cc.EaseElasticInOut;return t.initWithAction(this._inner.clone(),this._period),t}}),cc.easeElasticInOut=function(t){return t=t||.3,{_period:t,easing:function(t){var e=0,i=this._period;if(0===t||1===t)e=t;else{t*=2,i||(i=this._period=.3*1.5);var n=i/4;e=(t-=1)<0?-.5*Math.pow(2,10*t)*Math.sin((t-n)*Math.PI*2/i):Math.pow(2,-10*t)*Math.sin((t-n)*Math.PI*2/i)*.5+1}return e},reverse:function(){return cc.easeElasticInOut(this._period)}}},cc.EaseBounce=cc.ActionEase.extend({bounceTime:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},clone:function(){var t=new cc.EaseBounce;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseBounce(this._inner.reverse())}}),cc.EaseBounceIn=cc.EaseBounce.extend({update:function(t){var e=1-this.bounceTime(1-t);this._inner.update(e)},reverse:function(){return new cc.EaseBounceOut(this._inner.reverse())},clone:function(){var t=new cc.EaseBounceIn;return t.initWithAction(this._inner.clone()),t}}),cc._bounceTime=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},cc._easeBounceInObj={easing:function(t){return 1-cc._bounceTime(1-t)},reverse:function(){return cc._easeBounceOutObj}},cc.easeBounceIn=function(){return cc._easeBounceInObj},cc.EaseBounceOut=cc.EaseBounce.extend({update:function(t){var e=this.bounceTime(t);this._inner.update(e)},reverse:function(){return new cc.EaseBounceIn(this._inner.reverse())},clone:function(){var t=new cc.EaseBounceOut;return t.initWithAction(this._inner.clone()),t}}),cc._easeBounceOutObj={easing:function(t){return cc._bounceTime(t)},reverse:function(){return cc._easeBounceInObj}},cc.easeBounceOut=function(){return cc._easeBounceOutObj},cc.EaseBounceInOut=cc.EaseBounce.extend({update:function(t){var e=0;t<.5?(t*=2,e=.5*(1-this.bounceTime(1-t))):e=.5*this.bounceTime(2*t-1)+.5,this._inner.update(e)},clone:function(){var t=new cc.EaseBounceInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseBounceInOut(this._inner.reverse())}}),cc._easeBounceInOutObj={easing:function(t){var e;return t<.5?(t*=2,e=.5*(1-cc._bounceTime(1-t))):e=.5*cc._bounceTime(2*t-1)+.5,e},reverse:function(){return cc._easeBounceInOutObj}},cc.easeBounceInOut=function(){return cc._easeBounceInOutObj},cc.EaseBackIn=cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:t*t*(2.70158*t-1.70158),this._inner.update(t)},reverse:function(){return new cc.EaseBackOut(this._inner.reverse())},clone:function(){var t=new cc.EaseBackIn;return t.initWithAction(this._inner.clone()),t}}),cc._easeBackInObj={easing:function(t){return 0===t||1===t?t:t*t*(2.70158*t-1.70158)},reverse:function(){return cc._easeBackOutObj}},cc.easeBackIn=function(){return cc._easeBackInObj},cc.EaseBackOut=cc.ActionEase.extend({update:function(t){t-=1,this._inner.update(t*t*(2.70158*t+1.70158)+1)},reverse:function(){return new cc.EaseBackIn(this._inner.reverse())},clone:function(){var t=new cc.EaseBackOut;return t.initWithAction(this._inner.clone()),t}}),cc._easeBackOutObj={easing:function(t){return(t-=1)*t*(2.70158*t+1.70158)+1},reverse:function(){return cc._easeBackInObj}},cc.easeBackOut=function(){return cc._easeBackOutObj},cc.EaseBackInOut=cc.ActionEase.extend({update:function(t){(t*=2)<1?this._inner.update(t*t*(3.5949095*t-2.5949095)/2):(t-=2,this._inner.update(t*t*(3.5949095*t+2.5949095)/2+1))},clone:function(){var t=new cc.EaseBackInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseBackInOut(this._inner.reverse())}}),cc._easeBackInOutObj={easing:function(t){return(t*=2)<1?t*t*(3.5949095*t-2.5949095)/2:(t-=2)*t*(3.5949095*t+2.5949095)/2+1},reverse:function(){return cc._easeBackInOutObj}},cc.easeBackInOut=function(){return cc._easeBackInOutObj},cc.EaseBezierAction=cc.ActionEase.extend({_p0:null,_p1:null,_p2:null,_p3:null,ctor:function(t){cc.ActionEase.prototype.ctor.call(this,t)},_updateTime:function(t,e,i,n,r){return Math.pow(1-r,3)*t+3*r*Math.pow(1-r,2)*e+3*Math.pow(r,2)*(1-r)*i+Math.pow(r,3)*n},update:function(t){var e=this._updateTime(this._p0,this._p1,this._p2,this._p3,t);this._inner.update(e)},clone:function(){var t=new cc.EaseBezierAction;return t.initWithAction(this._inner.clone()),t.setBezierParamer(this._p0,this._p1,this._p2,this._p3),t},reverse:function(){var t=new cc.EaseBezierAction(this._inner.reverse());return t.setBezierParamer(this._p3,this._p2,this._p1,this._p0),t},setBezierParamer:function(t,e,i,n){this._p0=t||0,this._p1=e||0,this._p2=i||0,this._p3=n||0}}),cc.easeBezierAction=function(t,e,i,n){return{easing:function(r){return cc.EaseBezierAction.prototype._updateTime(t,e,i,n,r)},reverse:function(){return cc.easeBezierAction(n,i,e,t)}}},cc.EaseQuadraticActionIn=cc.ActionEase.extend({_updateTime:function(t){return Math.pow(t,2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuadraticActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuadraticActionIn(this._inner.reverse())}}),cc._easeQuadraticActionIn={easing:cc.EaseQuadraticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionIn}},cc.easeQuadraticActionIn=function(){return cc._easeQuadraticActionIn},cc.EaseQuadraticActionOut=cc.ActionEase.extend({_updateTime:function(t){return-t*(t-2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuadraticActionOut;return t.initWithAction(),t},reverse:function(){return new cc.EaseQuadraticActionOut(this._inner.reverse())}}),cc._easeQuadraticActionOut={easing:cc.EaseQuadraticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionOut}},cc.easeQuadraticActionOut=function(){return cc._easeQuadraticActionOut},cc.EaseQuadraticActionInOut=cc.ActionEase.extend({_updateTime:function(t){return t*=2,t<1?t*t*.5:-.5*(--t*(t-2)-1)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuadraticActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuadraticActionInOut(this._inner.reverse())}}),cc._easeQuadraticActionInOut={easing:cc.EaseQuadraticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionInOut}},cc.easeQuadraticActionInOut=function(){return cc._easeQuadraticActionInOut},cc.EaseQuarticActionIn=cc.ActionEase.extend({_updateTime:function(t){return t*t*t*t},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuarticActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuarticActionIn(this._inner.reverse())}}),cc._easeQuarticActionIn={easing:cc.EaseQuarticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuarticActionIn}},cc.easeQuarticActionIn=function(){return cc._easeQuarticActionIn},cc.EaseQuarticActionOut=cc.ActionEase.extend({_updateTime:function(t){return-((t-=1)*t*t*t-1)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuarticActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuarticActionOut(this._inner.reverse())}}),cc._easeQuarticActionOut={easing:cc.EaseQuarticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuarticActionOut}},cc.easeQuarticActionOut=function(){return cc._easeQuarticActionOut},cc.EaseQuarticActionInOut=cc.ActionEase.extend({_updateTime:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuarticActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuarticActionInOut(this._inner.reverse())}}),cc._easeQuarticActionInOut={easing:cc.EaseQuarticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuarticActionInOut}},cc.easeQuarticActionInOut=function(){return cc._easeQuarticActionInOut},cc.EaseQuinticActionIn=cc.ActionEase.extend({_updateTime:function(t){return t*t*t*t*t},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuinticActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuinticActionIn(this._inner.reverse())}}),cc._easeQuinticActionIn={easing:cc.EaseQuinticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuinticActionIn}},cc.easeQuinticActionIn=function(){return cc._easeQuinticActionIn},cc.EaseQuinticActionOut=cc.ActionEase.extend({_updateTime:function(t){return(t-=1)*t*t*t*t+1},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuinticActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuinticActionOut(this._inner.reverse())}}),cc._easeQuinticActionOut={easing:cc.EaseQuinticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuinticActionOut}},cc.easeQuinticActionOut=function(){return cc._easeQuinticActionOut},cc.EaseQuinticActionInOut=cc.ActionEase.extend({_updateTime:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuinticActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuinticActionInOut(this._inner.reverse())}}),cc._easeQuinticActionInOut={easing:cc.EaseQuinticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuinticActionInOut}},cc.easeQuinticActionInOut=function(){return cc._easeQuinticActionInOut},cc.EaseCircleActionIn=cc.ActionEase.extend({_updateTime:function(t){return-1*(Math.sqrt(1-t*t)-1)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCircleActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCircleActionIn(this._inner.reverse())}}),cc._easeCircleActionIn={easing:cc.EaseCircleActionIn.prototype._updateTime,reverse:function(){return cc._easeCircleActionIn}},cc.easeCircleActionIn=function(){return cc._easeCircleActionIn},cc.EaseCircleActionOut=cc.ActionEase.extend({_updateTime:function(t){return t-=1,Math.sqrt(1-t*t)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCircleActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCircleActionOut(this._inner.reverse())}}),cc._easeCircleActionOut={easing:cc.EaseCircleActionOut.prototype._updateTime,reverse:function(){return cc._easeCircleActionOut}},cc.easeCircleActionOut=function(){return cc._easeCircleActionOut},cc.EaseCircleActionInOut=cc.ActionEase.extend({_updateTime:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):(t-=2,.5*(Math.sqrt(1-t*t)+1))},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCircleActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCircleActionInOut(this._inner.reverse())}}),cc._easeCircleActionInOut={easing:cc.EaseCircleActionInOut.prototype._updateTime,reverse:function(){return cc._easeCircleActionInOut}},cc.easeCircleActionInOut=function(){return cc._easeCircleActionInOut},cc.EaseCubicActionIn=cc.ActionEase.extend({_updateTime:function(t){return t*t*t},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCubicActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCubicActionIn(this._inner.reverse())}}),cc._easeCubicActionIn={easing:cc.EaseCubicActionIn.prototype._updateTime,reverse:function(){return cc._easeCubicActionIn}},cc.easeCubicActionIn=function(){return cc._easeCubicActionIn},cc.EaseCubicActionOut=cc.ActionEase.extend({_updateTime:function(t){return(t-=1)*t*t+1},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCubicActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCubicActionOut(this._inner.reverse())}}),cc._easeCubicActionOut={easing:cc.EaseCubicActionOut.prototype._updateTime,reverse:function(){return cc._easeCubicActionOut}},cc.easeCubicActionOut=function(){return cc._easeCubicActionOut},cc.EaseCubicActionInOut=cc.ActionEase.extend({_updateTime:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCubicActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCubicActionInOut(this._inner.reverse())}}),cc._easeCubicActionInOut={easing:cc.EaseCubicActionInOut.prototype._updateTime,reverse:function(){return cc._easeCubicActionInOut}},cc.easeCubicActionInOut=function(){return cc._easeCubicActionInOut}}),{}],8:[(function(t,e,i){cc.ActionInstant=cc.FiniteTimeAction.extend({isDone:function(){return!0},step:function(t){this.update(1)},update:function(t){},reverse:function(){return this.clone()},clone:function(){return new cc.ActionInstant}}),cc.Show=cc.ActionInstant.extend({update:function(t){for(var e=this.target.getComponentsInChildren(cc._SGComponent),i=0;i<e.length;++i)e[i].enabled=!0},reverse:function(){return new cc.Hide},clone:function(){return new cc.Show}}),cc.show=function(){return new cc.Show},cc.Hide=cc.ActionInstant.extend({update:function(t){for(var e=this.target.getComponentsInChildren(cc._SGComponent),i=0;i<e.length;++i)e[i].enabled=!1},reverse:function(){return new cc.Show},clone:function(){return new cc.Hide}}),cc.hide=function(){return new cc.Hide},cc.ToggleVisibility=cc.ActionInstant.extend({update:function(t){for(var e=this.target.getComponentsInChildren(cc._SGComponent),i=0;i<e.length;++i){var n=e[i];n.enabled=!n.enabled}},reverse:function(){return new cc.ToggleVisibility},clone:function(){return new cc.ToggleVisibility}}),cc.toggleVisibility=function(){return new cc.ToggleVisibility},cc.RemoveSelf=cc.ActionInstant.extend({_isNeedCleanUp:!0,ctor:function(t){cc.FiniteTimeAction.prototype.ctor.call(this),void 0!==t&&this.init(t)},update:function(t){this.target.removeFromParent(this._isNeedCleanUp)},init:function(t){return this._isNeedCleanUp=t,!0},reverse:function(){return new cc.RemoveSelf(this._isNeedCleanUp)},clone:function(){return new cc.RemoveSelf(this._isNeedCleanUp)}}),cc.removeSelf=function(t){return new cc.RemoveSelf(t)},cc.FlipX=cc.ActionInstant.extend({_flippedX:!1,ctor:function(t){cc.FiniteTimeAction.prototype.ctor.call(this),this._flippedX=!1,void 0!==t&&this.initWithFlipX(t)},initWithFlipX:function(t){return this._flippedX=t,!0},update:function(t){this.target.scaleX=Math.abs(this.target.scaleX)*(this._flippedX?-1:1)},reverse:function(){return new cc.FlipX(!this._flippedX)},clone:function(){var t=new cc.FlipX;return t.initWithFlipX(this._flippedX),t}}),cc.flipX=function(t){return new cc.FlipX(t)},cc.FlipY=cc.ActionInstant.extend({_flippedY:!1,ctor:function(t){cc.FiniteTimeAction.prototype.ctor.call(this),this._flippedY=!1,void 0!==t&&this.initWithFlipY(t)},initWithFlipY:function(t){return this._flippedY=t,!0},update:function(t){this.target.scaleY=Math.abs(this.target.scaleY)*(this._flippedY?-1:1)},reverse:function(){return new cc.FlipY(!this._flippedY)},clone:function(){var t=new cc.FlipY;return t.initWithFlipY(this._flippedY),t}}),cc.flipY=function(t){return new cc.FlipY(t)},cc.Place=cc.ActionInstant.extend({_x:0,_y:0,ctor:function(t,e){cc.FiniteTimeAction.prototype.ctor.call(this),this._x=0,this._y=0,void 0!==t&&(void 0!==t.x&&(e=t.y,t=t.x),this.initWithPosition(t,e))},initWithPosition:function(t,e){return this._x=t,this._y=e,!0},update:function(t){this.target.setPosition(this._x,this._y)},clone:function(){var t=new cc.Place;return t.initWithPosition(this._x,this._y),t}}),cc.place=function(t,e){return new cc.Place(t,e)},cc.CallFunc=cc.ActionInstant.extend({_selectorTarget:null,_function:null,_data:null,ctor:function(t,e,i){cc.FiniteTimeAction.prototype.ctor.call(this),this.initWithFunction(t,e,i)},initWithFunction:function(t,e,i){return t&&(this._function=t),e&&(this._selectorTarget=e),void 0!==i&&(this._data=i),!0},execute:function(){this._function&&this._function.call(this._selectorTarget,this.target,this._data)},update:function(t){this.execute()},getTargetCallback:function(){return this._selectorTarget},setTargetCallback:function(t){t!==this._selectorTarget&&(this._selectorTarget&&(this._selectorTarget=null),this._selectorTarget=t)},clone:function(){var t=new cc.CallFunc;return t.initWithFunction(this._function,this._selectorTarget,this._data),t}}),cc.callFunc=function(t,e,i){return new cc.CallFunc(t,e,i)}}),{}],9:[(function(t,e,i){cc.ActionInterval=cc.FiniteTimeAction.extend({_elapsed:0,_firstTick:!1,_easeList:null,_timesForRepeat:1,_repeatForever:!1,_repeatMethod:!1,_speed:1,_speedMethod:!1,ctor:function(t){this._speed=1,this._timesForRepeat=1,this._repeatForever=!1,this.MAX_VALUE=2,this._repeatMethod=!1,this._speedMethod=!1,cc.FiniteTimeAction.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(t)},getElapsed:function(){return this._elapsed},initWithDuration:function(t){return this._duration=0===t?cc.macro.FLT_EPSILON:t,this._elapsed=0,this._firstTick=!0,!0},isDone:function(){return this._elapsed>=this._duration},_cloneDecoration:function(t){t._repeatForever=this._repeatForever,t._speed=this._speed,t._timesForRepeat=this._timesForRepeat,t._easeList=this._easeList,t._speedMethod=this._speedMethod,t._repeatMethod=this._repeatMethod},_reverseEaseList:function(t){if(this._easeList){t._easeList=[];for(var e=0;e<this._easeList.length;e++)t._easeList.push(this._easeList[e].reverse())}},clone:function(){var t=new cc.ActionInterval(this._duration);return this._cloneDecoration(t),t},easing:function(t){this._easeList?this._easeList.length=0:this._easeList=[];for(var e=0;e<arguments.length;e++)this._easeList.push(arguments[e]);return this},_computeEaseTime:function(t){var e=this._easeList;if(!e||0===e.length)return t;for(var i=0,n=e.length;i<n;i++)t=e[i].easing(t);return t},step:function(t){this._firstTick?(this._firstTick=!1,this._elapsed=0):this._elapsed+=t;var e=this._elapsed/(this._duration>1.192092896e-7?this._duration:1.192092896e-7);e=1>e?e:1,this.update(e>0?e:0),this._repeatMethod&&this._timesForRepeat>1&&this.isDone()&&(this._repeatForever||this._timesForRepeat--,this.startWithTarget(this.target),this.step(this._elapsed-this._duration))},startWithTarget:function(t){cc.Action.prototype.startWithTarget.call(this,t),this._elapsed=0,this._firstTick=!0},reverse:function(){return cc.logID(1010),null},setAmplitudeRate:function(t){cc.logID(1011)},getAmplitudeRate:function(){return cc.logID(1012),0},speed:function(t){return t<=0?(cc.logID(1013),this):(this._speedMethod=!0,this._speed*=t,this)},getSpeed:function(){return this._speed},setSpeed:function(t){return this._speed=t,this},repeat:function(t){return t=Math.round(t),isNaN(t)||t<1?(cc.logID(1014),this):(this._repeatMethod=!0,this._timesForRepeat*=t,this)},repeatForever:function(){return this._repeatMethod=!0,this._timesForRepeat=this.MAX_VALUE,this._repeatForever=!0,this}}),cc.actionInterval=function(t){return new cc.ActionInterval(t)},cc.Sequence=cc.ActionInterval.extend({_actions:null,_split:null,_last:0,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._actions=[];var e=t instanceof Array?t:arguments;if(1!==e.length){var i=e.length-1;if(i>=0&&null==e[i]&&cc.logID(1015),i>=0){for(var n,r=e[0],o=1;o<i;o++)e[o]&&(n=r,r=cc.Sequence._actionOneTwo(n,e[o]));this.initWithTwoActions(r,e[i])}}else cc.errorID(1019)},initWithTwoActions:function(t,e){if(!t||!e)throw new Error("cc.Sequence.initWithTwoActions(): arguments must all be non nil");var i=t._duration+e._duration;return this.initWithDuration(i),this._actions[0]=t,this._actions[1]=e,!0},clone:function(){var t=new cc.Sequence;return this._cloneDecoration(t),t.initWithTwoActions(this._actions[0].clone(),this._actions[1].clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._split=this._actions[0]._duration/this._duration,this._last=-1},stop:function(){-1!==this._last&&this._actions[this._last].stop(),cc.Action.prototype.stop.call(this)},update:function(t){var e,i,n=0,r=this._split,o=this._actions,s=this._last;(t=this._computeEaseTime(t))<r?(e=0!==r?t/r:1,0===n&&1===s&&(o[1].update(0),o[1].stop())):(n=1,e=1===r?1:(t-r)/(1-r),-1===s&&(o[0].startWithTarget(this.target),o[0].update(1),o[0].stop()),s||(o[0].update(1),o[0].stop())),i=o[n],s===n&&i.isDone()||(s!==n&&i.startWithTarget(this.target),e*=i._timesForRepeat,i.update(e>1?e%1:e),this._last=n)},reverse:function(){var t=cc.Sequence._actionOneTwo(this._actions[1].reverse(),this._actions[0].reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.sequence=function(t){var e=t instanceof Array?t:arguments;if(1===e.length)return cc.errorID(1019),null;var i=e.length-1;i>=0&&null==e[i]&&cc.logID(1015);var n=null;if(i>=0){n=e[0];for(var r=1;r<=i;r++)e[r]&&(n=cc.Sequence._actionOneTwo(n,e[r]))}return n},cc.Sequence._actionOneTwo=function(t,e){var i=new cc.Sequence;return i.initWithTwoActions(t,e),i},cc.Repeat=cc.ActionInterval.extend({_times:0,_total:0,_nextDt:0,_actionInstant:!1,_innerAction:null,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithAction(t,e)},initWithAction:function(t,e){var i=t._duration*e;return!!this.initWithDuration(i)&&(this._times=e,this._innerAction=t,t instanceof cc.ActionInstant&&(this._actionInstant=!0,this._times-=1),this._total=0,!0)},clone:function(){var t=new cc.Repeat;return this._cloneDecoration(t),t.initWithAction(this._innerAction.clone(),this._times),t},startWithTarget:function(t){this._total=0,this._nextDt=this._innerAction._duration/this._duration,cc.ActionInterval.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},stop:function(){this._innerAction.stop(),cc.Action.prototype.stop.call(this)},update:function(t){t=this._computeEaseTime(t);var e=this._innerAction,i=this._duration,n=this._times,r=this._nextDt;if(t>=r){for(;t>r&&this._total<n;)e.update(1),this._total++,e.stop(),e.startWithTarget(this.target),r+=e._duration/i,this._nextDt=r;t>=1&&this._total<n&&(e.update(1),this._total++),this._actionInstant||(this._total===n?e.stop():e.update(t-(r-e._duration/i)))}else e.update(t*n%1)},isDone:function(){return this._total===this._times},reverse:function(){var t=new cc.Repeat(this._innerAction.reverse(),this._times);return this._cloneDecoration(t),this._reverseEaseList(t),t},setInnerAction:function(t){this._innerAction!==t&&(this._innerAction=t)},getInnerAction:function(){return this._innerAction}}),cc.repeat=function(t,e){return new cc.Repeat(t,e)},cc.RepeatForever=cc.ActionInterval.extend({_innerAction:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._innerAction=null,t&&this.initWithAction(t)},initWithAction:function(t){if(!t)throw new Error("cc.RepeatForever.initWithAction(): action must be non null");return this._innerAction=t,!0},clone:function(){var t=new cc.RepeatForever;return this._cloneDecoration(t),t.initWithAction(this._innerAction.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},step:function(t){var e=this._innerAction;e.step(t),e.isDone()&&(e.startWithTarget(this.target),e.step(e.getElapsed()-e._duration))},isDone:function(){return!1},reverse:function(){var t=new cc.RepeatForever(this._innerAction.reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t},setInnerAction:function(t){this._innerAction!==t&&(this._innerAction=t)},getInnerAction:function(){return this._innerAction}}),cc.repeatForever=function(t){return new cc.RepeatForever(t)},cc.Spawn=cc.ActionInterval.extend({_one:null,_two:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._one=null,this._two=null;var e=t instanceof Array?t:arguments;if(1!==e.length){var i=e.length-1;if(i>=0&&null==e[i]&&cc.logID(1015),i>=0){for(var n,r=e[0],o=1;o<i;o++)e[o]&&(n=r,r=cc.Spawn._actionOneTwo(n,e[o]));this.initWithTwoActions(r,e[i])}}else cc.errorID(1020)},initWithTwoActions:function(t,e){if(!t||!e)throw new Error("cc.Spawn.initWithTwoActions(): arguments must all be non null");var i=!1,n=t._duration,r=e._duration;return this.initWithDuration(Math.max(n,r))&&(this._one=t,this._two=e,n>r?this._two=cc.Sequence._actionOneTwo(e,cc.delayTime(n-r)):n<r&&(this._one=cc.Sequence._actionOneTwo(t,cc.delayTime(r-n))),i=!0),i},clone:function(){var t=new cc.Spawn;return this._cloneDecoration(t),t.initWithTwoActions(this._one.clone(),this._two.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._one.startWithTarget(t),this._two.startWithTarget(t)},stop:function(){this._one.stop(),this._two.stop(),cc.Action.prototype.stop.call(this)},update:function(t){t=this._computeEaseTime(t),this._one&&this._one.update(t),this._two&&this._two.update(t)},reverse:function(){var t=cc.Spawn._actionOneTwo(this._one.reverse(),this._two.reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.spawn=function(t){var e=t instanceof Array?t:arguments;if(1===e.length)return cc.errorID(1020),null;e.length>0&&null==e[e.length-1]&&cc.logID(1015);for(var i=e[0],n=1;n<e.length;n++)null!=e[n]&&(i=cc.Spawn._actionOneTwo(i,e[n]));return i},cc.Spawn._actionOneTwo=function(t,e){var i=new cc.Spawn;return i.initWithTwoActions(t,e),i},cc.RotateTo=cc.ActionInterval.extend({_dstAngleX:0,_startAngleX:0,_diffAngleX:0,_dstAngleY:0,_startAngleY:0,_diffAngleY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._dstAngleX=e||0,this._dstAngleY=void 0!==i?i:this._dstAngleX,!0)},clone:function(){var t=new cc.RotateTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._dstAngleX,this._dstAngleY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.rotationX%360,i=this._dstAngleX-e;i>180&&(i-=360),i<-180&&(i+=360),this._startAngleX=e,this._diffAngleX=i,this._startAngleY=t.rotationY%360;var n=this._dstAngleY-this._startAngleY;n>180&&(n-=360),n<-180&&(n+=360),this._diffAngleY=n},reverse:function(){cc.logID(1016)},update:function(t){t=this._computeEaseTime(t),this.target&&(this.target.rotationX=this._startAngleX+this._diffAngleX*t,this.target.rotationY=this._startAngleY+this._diffAngleY*t)}}),cc.rotateTo=function(t,e,i){return new cc.RotateTo(t,e,i)},cc.RotateBy=cc.ActionInterval.extend({_angleX:0,_startAngleX:0,_angleY:0,_startAngleY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._angleX=e||0,this._angleY=void 0!==i?i:this._angleX,!0)},clone:function(){var t=new cc.RotateBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._angleX,this._angleY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startAngleX=t.rotationX,this._startAngleY=t.rotationY},update:function(t){t=this._computeEaseTime(t),this.target&&(this.target.rotationX=this._startAngleX+this._angleX*t,this.target.rotationY=this._startAngleY+this._angleY*t)},reverse:function(){var t=new cc.RotateBy(this._duration,-this._angleX,-this._angleY);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.rotateBy=function(t,e,i){return new cc.RotateBy(t,e,i)},cc.MoveBy=cc.ActionInterval.extend({_positionDelta:null,_startPosition:null,_previousPosition:null,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),this._positionDelta=cc.p(0,0),this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(void 0!==e.x&&(i=e.y,e=e.x),this._positionDelta.x=e,this._positionDelta.y=i,!0)},clone:function(){var t=new cc.MoveBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._positionDelta),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.getPositionX(),i=t.getPositionY();this._previousPosition.x=e,this._previousPosition.y=i,this._startPosition.x=e,this._startPosition.y=i},update:function(t){if(t=this._computeEaseTime(t),this.target){var e=this._positionDelta.x*t,i=this._positionDelta.y*t,n=this._startPosition;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var r=this.target.getPositionX(),o=this.target.getPositionY(),s=this._previousPosition;n.x=n.x+r-s.x,n.y=n.y+o-s.y,e+=n.x,i+=n.y,s.x=e,s.y=i,this.target.setPosition(e,i)}else this.target.setPosition(n.x+e,n.y+i)}},reverse:function(){var t=new cc.MoveBy(this._duration,cc.p(-this._positionDelta.x,-this._positionDelta.y));return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.moveBy=function(t,e,i){return new cc.MoveBy(t,e,i)},cc.MoveTo=cc.MoveBy.extend({_endPosition:null,ctor:function(t,e,i){cc.MoveBy.prototype.ctor.call(this),this._endPosition=cc.p(0,0),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.MoveBy.prototype.initWithDuration.call(this,t,e,i)&&(void 0!==e.x&&(i=e.y,e=e.x),this._endPosition.x=e,this._endPosition.y=i,!0)},clone:function(){var t=new cc.MoveTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endPosition),t},startWithTarget:function(t){cc.MoveBy.prototype.startWithTarget.call(this,t),this._positionDelta.x=this._endPosition.x-t.getPositionX(),this._positionDelta.y=this._endPosition.y-t.getPositionY()}}),cc.moveTo=function(t,e,i){return new cc.MoveTo(t,e,i)},cc.SkewTo=cc.ActionInterval.extend({_skewX:0,_skewY:0,_startSkewX:0,_startSkewY:0,_endSkewX:0,_endSkewY:0,_deltaX:0,_deltaY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){var n=!1;return cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._endSkewX=e,this._endSkewY=i,n=!0),n},clone:function(){var t=new cc.SkewTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endSkewX,this._endSkewY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startSkewX=t.skewX%180,this._deltaX=this._endSkewX-this._startSkewX,this._deltaX>180&&(this._deltaX-=360),this._deltaX<-180&&(this._deltaX+=360),this._startSkewY=t.skewY%360,this._deltaY=this._endSkewY-this._startSkewY,this._deltaY>180&&(this._deltaY-=360),this._deltaY<-180&&(this._deltaY+=360)},update:function(t){t=this._computeEaseTime(t),this.target.skewX=this._startSkewX+this._deltaX*t,this.target.skewY=this._startSkewY+this._deltaY*t}}),cc.skewTo=function(t,e,i){return new cc.SkewTo(t,e,i)},cc.SkewBy=cc.SkewTo.extend({ctor:function(t,e,i){cc.SkewTo.prototype.ctor.call(this),void 0!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){var n=!1;return cc.SkewTo.prototype.initWithDuration.call(this,t,e,i)&&(this._skewX=e,this._skewY=i,n=!0),n},clone:function(){var t=new cc.SkewBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._skewX,this._skewY),t},startWithTarget:function(t){cc.SkewTo.prototype.startWithTarget.call(this,t),this._deltaX=this._skewX,this._deltaY=this._skewY,this._endSkewX=this._startSkewX+this._deltaX,this._endSkewY=this._startSkewY+this._deltaY},reverse:function(){var t=new cc.SkewBy(this._duration,-this._skewX,-this._skewY);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.skewBy=function(t,e,i){return new cc.SkewBy(t,e,i)},cc.JumpBy=cc.ActionInterval.extend({_startPosition:null,_delta:null,_height:0,_jumps:0,_previousPosition:null,ctor:function(t,e,i,n,r){cc.ActionInterval.prototype.ctor.call(this),this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),this._delta=cc.p(0,0),void 0!==n&&this.initWithDuration(t,e,i,n,r)},initWithDuration:function(t,e,i,n,r){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(void 0===r&&(r=n,n=i,i=e.y,e=e.x),this._delta.x=e,this._delta.y=i,this._height=n,this._jumps=r,!0)},clone:function(){var t=new cc.JumpBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._delta,this._height,this._jumps),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.getPositionX(),i=t.getPositionY();this._previousPosition.x=e,this._previousPosition.y=i,this._startPosition.x=e,this._startPosition.y=i},update:function(t){if(t=this._computeEaseTime(t),this.target){var e=t*this._jumps%1,i=4*this._height*e*(1-e);i+=this._delta.y*t;var n=this._delta.x*t,r=this._startPosition;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var o=this.target.getPositionX(),s=this.target.getPositionY(),a=this._previousPosition;r.x=r.x+o-a.x,r.y=r.y+s-a.y,n+=r.x,i+=r.y,a.x=n,a.y=i,this.target.setPosition(n,i)}else this.target.setPosition(r.x+n,r.y+i)}},reverse:function(){var t=new cc.JumpBy(this._duration,cc.p(-this._delta.x,-this._delta.y),this._height,this._jumps);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.jumpBy=function(t,e,i,n,r){return new cc.JumpBy(t,e,i,n,r)},cc.JumpTo=cc.JumpBy.extend({_endPosition:null,ctor:function(t,e,i,n,r){cc.JumpBy.prototype.ctor.call(this),this._endPosition=cc.p(0,0),void 0!==n&&this.initWithDuration(t,e,i,n,r)},initWithDuration:function(t,e,i,n,r){return!!cc.JumpBy.prototype.initWithDuration.call(this,t,e,i,n,r)&&(void 0===r&&(i=e.y,e=e.x),this._endPosition.x=e,this._endPosition.y=i,!0)},startWithTarget:function(t){cc.JumpBy.prototype.startWithTarget.call(this,t),this._delta.x=this._endPosition.x-this._startPosition.x,this._delta.y=this._endPosition.y-this._startPosition.y},clone:function(){var t=new cc.JumpTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endPosition,this._height,this._jumps),t}}),cc.jumpTo=function(t,e,i,n,r){return new cc.JumpTo(t,e,i,n,r)},cc.bezierAt=function(t,e,i,n,r){return Math.pow(1-r,3)*t+3*r*Math.pow(1-r,2)*e+3*Math.pow(r,2)*(1-r)*i+Math.pow(r,3)*n},cc.BezierBy=cc.ActionInterval.extend({_config:null,_startPosition:null,_previousPosition:null,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),this._config=[],this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._config=e,!0)},clone:function(){var t=new cc.BezierBy;this._cloneDecoration(t);for(var e=[],i=0;i<this._config.length;i++){var n=this._config[i];e.push(cc.p(n.x,n.y))}return t.initWithDuration(this._duration,e),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.getPositionX(),i=t.getPositionY();this._previousPosition.x=e,this._previousPosition.y=i,this._startPosition.x=e,this._startPosition.y=i},update:function(t){if(t=this._computeEaseTime(t),this.target){var e=this._config,i=e[0].x,n=e[1].x,r=e[2].x,o=e[0].y,s=e[1].y,a=e[2].y,c=cc.bezierAt(0,i,n,r,t),h=cc.bezierAt(0,o,s,a,t),l=this._startPosition;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var u=this.target.getPositionX(),d=this.target.getPositionY(),_=this._previousPosition;l.x=l.x+u-_.x,l.y=l.y+d-_.y,c+=l.x,h+=l.y,_.x=c,_.y=h,this.target.setPosition(c,h)}else this.target.setPosition(l.x+c,l.y+h)}},reverse:function(){var t=this._config,e=[cc.pAdd(t[1],cc.pNeg(t[2])),cc.pAdd(t[0],cc.pNeg(t[2])),cc.pNeg(t[2])],i=new cc.BezierBy(this._duration,e);return this._cloneDecoration(i),this._reverseEaseList(i),i}}),cc.bezierBy=function(t,e){return new cc.BezierBy(t,e)},cc.BezierTo=cc.BezierBy.extend({_toConfig:null,ctor:function(t,e){cc.BezierBy.prototype.ctor.call(this),this._toConfig=[],e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._toConfig=e,!0)},clone:function(){var t=new cc.BezierTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toConfig),t},startWithTarget:function(t){cc.BezierBy.prototype.startWithTarget.call(this,t);var e=this._startPosition,i=this._toConfig,n=this._config;n[0]=cc.pSub(i[0],e),n[1]=cc.pSub(i[1],e),n[2]=cc.pSub(i[2],e)}}),cc.bezierTo=function(t,e){return new cc.BezierTo(t,e)},cc.ScaleTo=cc.ActionInterval.extend({_scaleX:1,_scaleY:1,_startScaleX:1,_startScaleY:1,_endScaleX:0,_endScaleY:0,_deltaX:0,_deltaY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._endScaleX=e,this._endScaleY=null!=i?i:e,!0)},clone:function(){var t=new cc.ScaleTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endScaleX,this._endScaleY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startScaleX=t.scaleX,this._startScaleY=t.scaleY,this._deltaX=this._endScaleX-this._startScaleX,this._deltaY=this._endScaleY-this._startScaleY},update:function(t){t=this._computeEaseTime(t),this.target&&(this.target.scaleX=this._startScaleX+this._deltaX*t,this.target.scaleY=this._startScaleY+this._deltaY*t)}}),cc.scaleTo=function(t,e,i){return new cc.ScaleTo(t,e,i)},cc.ScaleBy=cc.ScaleTo.extend({startWithTarget:function(t){cc.ScaleTo.prototype.startWithTarget.call(this,t),this._deltaX=this._startScaleX*this._endScaleX-this._startScaleX,this._deltaY=this._startScaleY*this._endScaleY-this._startScaleY},reverse:function(){var t=new cc.ScaleBy(this._duration,1/this._endScaleX,1/this._endScaleY);return this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.ScaleBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endScaleX,this._endScaleY),t}}),cc.scaleBy=function(t,e,i){return new cc.ScaleBy(t,e,i)},cc.Blink=cc.ActionInterval.extend({_times:0,_originalState:!1,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._times=e,!0)},clone:function(){var t=new cc.Blink;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._times),t},update:function(t){if(t=this._computeEaseTime(t),this.target&&!this.isDone()){var e=1/this._times,i=t%e;this.target.opacity=i>e/2?255:0}},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._originalState=t.opacity},stop:function(){this.target.opacity=this._originalState,cc.ActionInterval.prototype.stop.call(this)},reverse:function(){var t=new cc.Blink(this._duration,this._times);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.blink=function(t,e){return new cc.Blink(t,e)},cc.FadeTo=cc.ActionInterval.extend({_toOpacity:0,_fromOpacity:0,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._toOpacity=e,!0)},clone:function(){var t=new cc.FadeTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t},update:function(t){t=this._computeEaseTime(t);var e=void 0!==this._fromOpacity?this._fromOpacity:255;this.target.opacity=e+(this._toOpacity-e)*t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._fromOpacity=t.opacity}}),cc.fadeTo=function(t,e){return new cc.FadeTo(t,e)},cc.FadeIn=cc.FadeTo.extend({_reverseAction:null,ctor:function(t){cc.FadeTo.prototype.ctor.call(this),null==t&&(t=0),this.initWithDuration(t,255)},reverse:function(){var t=new cc.FadeOut;return t.initWithDuration(this._duration,0),this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.FadeIn;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t},startWithTarget:function(t){this._reverseAction&&(this._toOpacity=this._reverseAction._fromOpacity),cc.FadeTo.prototype.startWithTarget.call(this,t)}}),cc.fadeIn=function(t){return new cc.FadeIn(t)},cc.FadeOut=cc.FadeTo.extend({ctor:function(t){cc.FadeTo.prototype.ctor.call(this),null==t&&(t=0),this.initWithDuration(t,0)},reverse:function(){var t=new cc.FadeIn;return t._reverseAction=this,t.initWithDuration(this._duration,255),this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.FadeOut;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t}}),cc.fadeOut=function(t){return new cc.FadeOut(t)},cc.TintTo=cc.ActionInterval.extend({_to:null,_from:null,ctor:function(t,e,i,n){cc.ActionInterval.prototype.ctor.call(this),this._to=cc.color(0,0,0),this._from=cc.color(0,0,0),e instanceof cc.Color&&(n=e.b,i=e.g,e=e.r),void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._to=cc.color(e,i,n),!0)},clone:function(){var t=new cc.TintTo;this._cloneDecoration(t);var e=this._to;return t.initWithDuration(this._duration,e.r,e.g,e.b),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._from=this.target.color},update:function(t){t=this._computeEaseTime(t);var e=this._from,i=this._to;e&&this.target.setColor(cc.color(e.r+(i.r-e.r)*t,e.g+(i.g-e.g)*t,e.b+(i.b-e.b)*t))}}),cc.tintTo=function(t,e,i,n){return new cc.TintTo(t,e,i,n)},cc.TintBy=cc.ActionInterval.extend({_deltaR:0,_deltaG:0,_deltaB:0,_fromR:0,_fromG:0,_fromB:0,ctor:function(t,e,i,n){cc.ActionInterval.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._deltaR=e,this._deltaG=i,this._deltaB=n,!0)},clone:function(){var t=new cc.TintBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._deltaR,this._deltaG,this._deltaB),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.color;this._fromR=e.r,this._fromG=e.g,this._fromB=e.b},update:function(t){t=this._computeEaseTime(t),this.target.color=cc.color(this._fromR+this._deltaR*t,this._fromG+this._deltaG*t,this._fromB+this._deltaB*t)},reverse:function(){var t=new cc.TintBy(this._duration,-this._deltaR,-this._deltaG,-this._deltaB);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.tintBy=function(t,e,i,n){return new cc.TintBy(t,e,i,n)},cc.DelayTime=cc.ActionInterval.extend({update:function(t){},reverse:function(){var t=new cc.DelayTime(this._duration);return this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.DelayTime;return this._cloneDecoration(t),t.initWithDuration(this._duration),t}}),cc.delayTime=function(t){return new cc.DelayTime(t)},cc.ReverseTime=cc.ActionInterval.extend({_other:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._other=null,t&&this.initWithAction(t)},initWithAction:function(t){if(!t)throw new Error("cc.ReverseTime.initWithAction(): action must be non null");if(t===this._other)throw new Error("cc.ReverseTime.initWithAction(): the action was already passed in.");return!!cc.ActionInterval.prototype.initWithDuration.call(this,t._duration)&&(this._other=t,!0)},clone:function(){var t=new cc.ReverseTime;return this._cloneDecoration(t),t.initWithAction(this._other.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._other.startWithTarget(t)},update:function(t){t=this._computeEaseTime(t),this._other&&this._other.update(1-t)},reverse:function(){return this._other.clone()},stop:function(){this._other.stop(),cc.Action.prototype.stop.call(this)}}),cc.reverseTime=function(t){return new cc.ReverseTime(t)},cc.Animate=cc.ActionInterval.extend({_animation:null,_nextFrame:0,_origFrame:null,_executedLoops:0,_splitTimes:null,_currFrameIndex:0,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._splitTimes=[],t&&this.initWithAnimation(t)},getAnimation:function(){return this._animation},setAnimation:function(t){this._animation=t},getCurrentFrameIndex:function(){return this._currFrameIndex},initWithAnimation:function(t){if(!t)throw new Error("cc.Animate.initWithAnimation(): animation must be non-NULL");var e=t.getDuration();if(this.initWithDuration(e*t.getLoops())){this._nextFrame=0,this.setAnimation(t),this._origFrame=null,this._executedLoops=0;var i=this._splitTimes;i.length=0;var n=0,r=e/t.getTotalDelayUnits(),o=t.getFrames();cc.js.array.verifyType(o,cc.AnimationFrame);for(var s=0;s<o.length;s++){var a=n*r/e;n+=o[s].getDelayUnits(),i.push(a)}return!0}return!1},clone:function(){var t=new cc.Animate;return this._cloneDecoration(t),t.initWithAnimation(this._animation.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._animation.getRestoreOriginalFrame()&&(this._origFrame=t.getSpriteFrame()),this._nextFrame=0,this._executedLoops=0},update:function(t){(t=this._computeEaseTime(t))<1&&((0|(t*=this._animation.getLoops()))>this._executedLoops&&(this._nextFrame=0,this._executedLoops++),t%=1);for(var e=this._animation.getFrames(),i=e.length,n=this._splitTimes,r=this._nextFrame;r<i&&n[r]<=t;r++)_currFrameIndex=r,this.target.setSpriteFrame(e[_currFrameIndex].getSpriteFrame()),this._nextFrame=r+1},reverse:function(){var t=this._animation,e=t.getFrames(),i=[];if(cc.js.array.verifyType(e,cc.AnimationFrame),e.length>0)for(var n=e.length-1;n>=0;n--){var r=e[n];if(!r)break;i.push(r.clone())}var o=new cc.SpriteFrameAnimation(i,t.getDelayPerUnit(),t.getLoops());o.setRestoreOriginalFrame(t.getRestoreOriginalFrame());var s=new cc.Animate(o);return this._cloneDecoration(s),this._reverseEaseList(s),s},stop:function(){this._animation.getRestoreOriginalFrame()&&this.target&&this.target.setSpriteFrame(this._origFrame),cc.Action.prototype.stop.call(this)}}),cc.animate=function(t){return new cc.Animate(t)},cc.TargetedAction=cc.ActionInterval.extend({_action:null,_forcedTarget:null,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),e&&this.initWithTarget(t,e)},initWithTarget:function(t,e){return!!this.initWithDuration(e._duration)&&(this._forcedTarget=t,this._action=e,!0)},clone:function(){var t=new cc.TargetedAction;return this._cloneDecoration(t),t.initWithTarget(this._forcedTarget,this._action.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._action.startWithTarget(this._forcedTarget)},stop:function(){this._action.stop()},update:function(t){t=this._computeEaseTime(t),this._action.update(t)},getForcedTarget:function(){return this._forcedTarget},setForcedTarget:function(t){this._forcedTarget!==t&&(this._forcedTarget=t)}}),cc.targetedAction=function(t,e){return new cc.TargetedAction(t,e)}}),{}],10:[(function(t,e,i){var n=function(){this.actions=[],this.target=null,this.actionIndex=0,this.currentAction=null,this.paused=!1,this.lock=!1};cc.ActionManager=cc._Class.extend({_elementPool:[],_searchElementByTarget:function(t,e){for(var i=0;i<t.length;i++)if(e===t[i].target)return t[i];return null},ctor:function(){this._hashTargets={},this._arrayTargets=[],this._currentTarget=null},_getElement:function(t,e){var i=this._elementPool.pop();return i||(i=new n),i.target=t,i.paused=!!e,i},_putElement:function(t){t.actions.length=0,t.actionIndex=0,t.currentAction=null,t.paused=!1,t.target=null,t.lock=!1,this._elementPool.push(t)},addAction:function(t,e,i){if(!t)throw new Error("cc.ActionManager.addAction(): action must be non-null");if(!e)throw new Error("cc.ActionManager.addAction(): action must be non-null");var n=this._hashTargets[e.__instanceId];n?n.actions||(n.actions=[]):(n=this._getElement(e,i),this._hashTargets[e.__instanceId]=n,this._arrayTargets.push(n)),n.actions.push(t),t.startWithTarget(e)},removeAllActions:function(){for(var t=this._arrayTargets,e=0;e<t.length;e++){var i=t[e];i&&this.removeAllActionsFromTarget(i.target,!0)}},removeAllActionsFromTarget:function(t,e){if(null!=t){var i=this._hashTargets[t.__instanceId];i&&(i.actions.length=0,this._deleteHashElement(i))}},removeAction:function(t){if(null!=t){var e=t.getOriginalTarget(),i=this._hashTargets[e.__instanceId];if(i){for(var n=0;n<i.actions.length;n++)if(i.actions[n]===t){i.actions.splice(n,1),i.actionIndex>=n&&i.actionIndex--;break}}else cc.logID(1001)}},removeActionByTag:function(t,e){t===cc.Action.TAG_INVALID&&cc.logID(1002),cc.assertID(e,1003);var i=this._hashTargets[e.__instanceId];if(i)for(var n=i.actions.length,r=0;r<n;++r){var o=i.actions[r];if(o&&o.getTag()===t&&o.getOriginalTarget()===e){this._removeActionAtIndex(r,i);break}}},getActionByTag:function(t,e){t===cc.Action.TAG_INVALID&&cc.logID(1004);var i=this._hashTargets[e.__instanceId];if(i){if(null!=i.actions)for(var n=0;n<i.actions.length;++n){var r=i.actions[n];if(r&&r.getTag()===t)return r}cc.logID(1005,t)}return null},getNumberOfRunningActionsInTarget:function(t){var e=this._hashTargets[t.__instanceId];return e&&e.actions?e.actions.length:0},pauseTarget:function(t){var e=this._hashTargets[t.__instanceId];e&&(e.paused=!0)},resumeTarget:function(t){var e=this._hashTargets[t.__instanceId];e&&(e.paused=!1)},pauseAllRunningActions:function(){for(var t=[],e=this._arrayTargets,i=0;i<e.length;i++){var n=e[i];n&&!n.paused&&(n.paused=!0,t.push(n.target))}return t},resumeTargets:function(t){if(t)for(var e=0;e<t.length;e++)t[e]&&this.resumeTarget(t[e])},pauseTargets:function(t){if(t)for(var e=0;e<t.length;e++)t[e]&&this.pauseTarget(t[e])},purgeSharedManager:function(){cc.director.getScheduler().unscheduleUpdate(this)},_removeActionAtIndex:function(t,e){e.actions[t];e.actions.splice(t,1),e.actionIndex>=t&&e.actionIndex--,0===e.actions.length&&this._deleteHashElement(e)},_deleteHashElement:function(t){var e=!1;if(t&&!t.lock&&this._hashTargets[t.target.__instanceId]){delete this._hashTargets[t.target.__instanceId];for(var i=this._arrayTargets,n=0,r=i.length;n<r;n++)if(i[n]===t){i.splice(n,1);break}this._putElement(t),e=!0}return e},update:function(t){for(var e,i=this._arrayTargets,n=0;n<i.length;n++){if(this._currentTarget=i[n],!(e=this._currentTarget).paused&&e.actions){for(e.lock=!0,e.actionIndex=0;e.actionIndex<e.actions.length;e.actionIndex++)if(e.currentAction=e.actions[e.actionIndex],e.currentAction){if(e.currentAction.step(t*(e.currentAction._speedMethod?e.currentAction._speed:1)),e.currentAction&&e.currentAction.isDone()){e.currentAction.stop();var r=e.currentAction;e.currentAction=null,this.removeAction(r)}e.currentAction=null}e.lock=!1}0===e.actions.length&&this._deleteHashElement(e)&&n--}}})}),{}],11:[(function(t,e,i){t("./CCActionManager"),t("./CCAction"),t("./CCActionInterval"),t("./CCActionInstant"),t("./CCActionEase"),t("./CCActionCatmullRom")}),{"./CCAction":5,"./CCActionCatmullRom":6,"./CCActionEase":7,"./CCActionInstant":8,"./CCActionInterval":9,"./CCActionManager":10}],12:[(function(t,e,i){function n(t,e){a.call(this,t),this.animation=e}function r(t){var e=t.split(".");return e.shift(),e.length>0?e:null}function o(t,e){function i(t){if(!Array.isArray(t))return!1;for(var e=0,i=t.length;e<i;e++){var n=t[e];if(!Array.isArray(n)||6!==n.length)return!1}return!0}function n(t,n,o){var a,u=t instanceof cc.Node&&"position"===n,d=[];(a=u?new h:new c).target=t;var _,f=n.indexOf(".");-1!==f?t[_=n.slice(0,f)]:_=n,a.prop=_,a.subProps=r(n);for(var p=0,g=o.length;p<g;p++){var v=o[p],m=v.frame/e.duration;if(a.ratios.push(m),u){var y=v.motionPath;y&&!i(y)&&(cc.errorID(3904,t.name,n,p),y=null),d.push(y)}var T=v.value;a.values.push(T);var C=v.curve;if(C){if("string"==typeof C){a.types.push(C);continue}if(Array.isArray(C)){C[0]===C[1]&&C[2]===C[3]?a.types.push(c.Linear):a.types.push(c.Bezier(C));continue}}a.types.push(c.Linear)}return u&&l(d,a,s.duration,s.sample),a}function o(t,e){var i=e.props,r=e.comps;if(i)for(var o in i){u=n(t,o,l=i[o]);a.push(u)}if(r)for(var s in r){var c=t.getComponent(s);if(c){var h=r[s];for(var o in h){var l=h[o],u=n(c,o,l);a.push(u)}}}}var s=e.clip,a=e.curves;a.length=0,e.duration=s.duration,e.speed=s.speed,e.wrapMode=s.wrapMode,e.frameRate=s.sample,(e.wrapMode&_.Loop)===_.Loop?e.repeatCount=1/0:e.repeatCount=1;var p=s.curveData,g=p.paths;o(t,p);for(var v in g){var m=cc.find(v,t);m&&o(m,g[v])}var y=s.events;if(y)for(var T,C=0,x=y.length;C<x;C++){T||((T=new u).target=t,a.push(T));var E,S=y[C],b=S.frame/e.duration,A=f(T.ratios,b);A>=0?E=T.events[A]:(E=new d,T.ratios.push(b),T.events.push(E)),E.add(S.func,S.params)}}var s=cc.js,a=t("./animators").Animator,c=t("./animation-curves").DynamicAnimCurve,h=t("./animation-curves").SampledAnimCurve,l=t("./motion-path-helper").sampleMotionPaths,u=t("./animation-curves").EventAnimCurve,d=t("./animation-curves").EventInfo,_=t("./types").WrapModeMask,f=t("../core/utils/binary-search").binarySearchEpsilon;s.extend(n,a);var p=n.prototype;p.playState=function(t,e){t.clip&&(t.curveLoaded||o(this.target,t),this.addAnimation(t),t.animator=this,t.play(),"number"==typeof e&&t.setTime(e),this.play())},p.addAnimation=function(t){a.prototype.addAnimation.call(this,t);for(var e=this.animation._listeners,i=0,n=e.length;i<n;i++){var r=e[i];t.on(r[0],r[1],r[2],r[3])}},p.removeAnimation=function(t){a.prototype.removeAnimation.call(this,t),t.animator=null},p.sample=function(){var t=this._anims,e=t.array;for(t.i=0;t.i<e.length;++t.i)e[t.i].sample()},p.stopState=function(t){t&&t.stop()},p.pauseState=function(t){t&&t.pause()},p.resumeState=function(t){t&&t.resume(),this.isPaused&&this.resume()},p.setStateTime=function(t,e){if(void 0!==e)t&&(t.setTime(e),t.sample());else{e=t;var i=this._anims,n=i.array;for(i.i=0;i.i<n.length;++i.i){var r=n[i.i];r.setTime(e),r.sample()}}},p.onStop=function(){var t=this._anims,e=t.array;for(t.i=0;t.i<e.length;++t.i)e[t.i].stop();a.prototype.onStop.call(this)},p.onPause=function(){for(var t=this._anims.array,e=0;e<t.length;++e){var i=t[e];i.pause(),i.animator=null}a.prototype.onPause.call(this)},p.onResume=function(){for(var t=this._anims.array,e=0;e<t.length;++e){var i=t[e];i.animator=this,i.resume()}a.prototype.onResume.call(this)},p._reloadClip=function(t){o(this.target,t)},e.exports=n}),{"../core/utils/binary-search":192,"./animation-curves":14,"./animators":17,"./motion-path-helper":21,"./types":23}],13:[(function(t,e,i){var n=cc.Class({name:"cc.AnimationClip",extends:cc.Asset,properties:{_duration:{default:0,type:"Float"},duration:{get:function(){return this._duration}},sample:{default:60},speed:{default:1},wrapMode:{default:cc.WrapMode.Normal},curveData:{default:{},visible:!1},events:{default:[],visible:!1}},statics:{createWithSpriteFrames:function(t,e){if(!Array.isArray(t))return cc.errorID(3905),null;var i=new n;i.sample=e||i.sample,i._duration=t.length/i.sample;for(var r=[],o=1/i.sample,s=0,a=t.length;s<a;s++)r[s]={frame:s*o,value:t[s]};return i.curveData={comps:{"cc.Sprite":{spriteFrame:r}}},i}}});cc.AnimationClip=e.exports=n}),{}],14:[(function(t,e,i){function n(t,e){if("string"==typeof e){var i=cc.Easing[e];i?t=i(t):cc.errorID(3906,e)}else Array.isArray(e)&&(t=r(e,t));return t}var r=t("./bezier").bezierByTime,o=t("../core/utils/binary-search").binarySearchEpsilon,s=t("./types").WrapModeMask,a=t("./types").WrappedInfo,c=cc.Class({name:"cc.AnimCurve",sample:function(t,e,i){},onTimeChangedManually:function(){}}),h=cc.Class({name:"cc.DynamicAnimCurve",extends:c,properties:{target:null,prop:"",values:[],ratios:[],types:[],subProps:null},_calcValue:function(t,e){var i=this.values,n=i[t-1],r=i[t];return"number"==typeof n?n+(r-n)*e:n&&n.lerp?n.lerp(r,e):n},_applyValue:function(t,e,i){t[e]=i},_findFrameIndex:o,sample:function(t,e,i){var r=this.values,o=this.ratios,s=o.length;if(0!==s){var a,c=this._findFrameIndex(o,e);if(c<0)if((c=~c)<=0)a=r[0];else if(c>=s)a=r[s-1];else{var h=o[c-1],l=(e-h)/(o[c]-h);l=n(l,this.types[c-1]),a=this._calcValue(c,l)}else a=r[c];var u=this.subProps;if(u){for(var d=this.target[this.prop],_=d,f=0;f<u.length-1;f++){var p=u[f];if(!_)return;_=_[p]}var g=u[u.length-1];if(!_)return;this._applyValue(_,g,a),a=d}this._applyValue(this.target,this.prop,a)}}});h.Linear=null,h.Bezier=function(t){return t};var l=cc.Class({name:"cc.SampledAnimCurve",extends:h,_findFrameIndex:function(t,e){var i=t.length-1;if(0===i)return 0;var n=t[0];if(e<n)return 0;var r=t[i];if(e>r)return i;var o=(e=(e-n)/(r-n))/(1/i),s=0|o;return o-s<1e-6?s:~(s+1)}}),u=function(){this.events=[]};u.prototype.add=function(t,e){this.events.push({func:t||"",params:e||[]})};var d=cc.Class({name:"cc.EventAnimCurve",extends:c,properties:{target:null,ratios:[],events:[],_wrappedInfo:{default:function(){return new a}},_lastWrappedInfo:null,_ignoreIndex:NaN},_wrapIterations:function(t){return t-(0|t)==0&&(t-=1),0|t},sample:function(t,e,i){var n=this.ratios.length,r=i.getWrappedInfo(i.time,this._wrappedInfo),c=r.direction,h=o(this.ratios,r.ratio);if(h<0&&(h=~h-1,c<0&&(h+=1)),this._ignoreIndex!==h&&(this._ignoreIndex=NaN),r.frameIndex=h,!this._lastWrappedInfo)return this._fireEvent(h),void(this._lastWrappedInfo=new a(r));var l=i.wrapMode,u=this._wrapIterations(r.iterations),d=this._lastWrappedInfo,_=this._wrapIterations(d.iterations),f=d.frameIndex,p=d.direction,g=-1!==_&&u!==_;if(f===h&&g&&1===n)this._fireEvent(0);else if(f!==h||g){c=p;do{if(f!==h){if(-1===c&&0===f&&h>0?((l&s.PingPong)===s.PingPong?c*=-1:f=n,_++):1===c&&f===n-1&&h<n-1&&((l&s.PingPong)===s.PingPong?c*=-1:f=-1,_++),f===h)break;if(_>u)break}f+=c,cc.director.getAnimationManager().pushDelayEvent(this,"_fireEvent",[f])}while(f!==h&&f>-1&&f<n)}this._lastWrappedInfo.set(r)},_fireEvent:function(t){if(!(t<0||t>=this.events.length||this._ignoreIndex===t)){var e=this.events[t].events;if(this.target.isValid)for(var i=this.target._components,n=0;n<e.length;n++)for(var r=e[n],o=r.func,s=0;s<i.length;s++){var a=i[s],c=a[o];c&&c.apply(a,r.params)}}},onTimeChangedManually:function(t,e){this._lastWrappedInfo=null,this._ignoreIndex=NaN;var i=e.getWrappedInfo(t,this._wrappedInfo),n=i.direction,r=o(this.ratios,i.ratio);r<0&&(r=~r-1,n<0&&(r+=1),this._ignoreIndex=r)}});e.exports={AnimCurve:c,DynamicAnimCurve:h,SampledAnimCurve:l,EventAnimCurve:d,EventInfo:u,computeRatioByType:n}}),{"../core/utils/binary-search":192,"./bezier":18,"./types":23}],15:[(function(t,e,n){var r=cc.js,o=cc.Class({ctor:function(){this.__instanceId=cc.ClassManager.getNewInstanceId(),this._animators=new r.array.MutableForwardIterator([]),this._delayEvents=[]},update:function(t){var e=this._animators,n=e.array;for(e.i=0;e.i<n.length;++e.i){var r=n[e.i];r._isPlaying&&!r._isPaused&&r.update(t)}var o=this._delayEvents;for(i=0,l=o.length;i<l;i++){var s=o[i];s.target[s.func].apply(s.target,s.args)}o.length=0},destruct:function(){},addAnimator:function(t){-1===this._animators.array.indexOf(t)&&this._animators.push(t)},removeAnimator:function(t){var e=this._animators.array.indexOf(t);e>=0?this._animators.fastRemoveAt(e):cc.errorID(3907)},pushDelayEvent:function(t,e,i){this._delayEvents.push({target:t,func:e,args:i})}});cc.AnimationManager=e.exports=o}),{}],16:[(function(t,e,i){function n(t,e){o.call(this,null,null,{duration:t.length}),this._emit=this.emit,this.emit=function(){for(var t=new Array(arguments.length),e=0,i=t.length;e<i;e++)t[e]=arguments[e];cc.director.getAnimationManager().pushDelayEvent(this,"_emit",t)},this._clip=t,this._name=e||t.name}var r=cc.js,o=t("./types").AnimationNode;r.extend(n,o);var s=n.prototype;r.get(s,"clip",(function(){return this._clip})),r.get(s,"name",(function(){return this._name})),r.obsolete(s,"AnimationState.length","duration"),r.getset(s,"curveLoaded",(function(){return this.curves.length>0}),(function(){this.curves.length=0})),s.onPlay=function(){this.setTime(0),o.prototype.onPlay.call(this)},s.onStop=function(){o.prototype.onStop.call(this),this.animator&&this.animator.removeAnimation(this)},s.setTime=function(t){this.time=t||0;var e=this;this.curves.forEach((function(i){i.onTimeChangedManually(t,e)}))},cc.AnimationState=e.exports=n}),{"./types":23}],17:[(function(t,e,i){function n(t){this.target=t,this._anims=new c.array.MutableForwardIterator([])}function r(t){n.call(this,t)}function o(t){for(var e=0,i=0,n=t.length,r=0;r<n;r++){var o=t[r],s=o.ratio;if(0===r&&"number"!=typeof s?o.computedRatio=s=0:r===n-1&&"number"!=typeof s&&(o.computedRatio=s=1),"number"==typeof s){if(e+1<r)for(var a=(s-i)/(r-e),c=e+1;c<r;c++)i+=a,t[c].computedRatio=i;e=r,i=s}}}function s(t,e,i){for(var n,r=0;r<t.length;r++)if((n=t[r]).target===e&&n.prop===i)return n;return null}function a(t,e,i,n,r){var o=s(t,e,i);o||(o=new u,t.push(o),o.target=e,o.prop=i),o.values.push(n),o.ratios.push(r)}var c=cc.js,h=t("./playable"),l=t("./types").AnimationNode,u=t("./animation-curves").DynamicAnimCurve;c.extend(n,h);var d=n.prototype;d.update=function(t){var e=this._anims,i=e.array,n=0,r=i.length;for(e.i=0;e.i<i.length;++e.i){var o=i[e.i];o._isPlaying&&!o._isPaused&&(o.update(t),o._isPlaying||n++)}var s=n>=r;(0===i.length||s)&&this.stop()},d.stopStatesExcept=function(t){var e=this._anims,i=e.array;for(e.i=0;e.i<i.length;++e.i){var n=i[e.i];n!==t&&this.stopState(n)}},d.on=function(t,e,i,n){for(var r=this._anims.array,o=0;o<r.length;++o)r[o].on(t,e,i,n)},d.onPlay=function(){cc.director.getAnimationManager().addAnimator(this)},d.onStop=function(){this._isPaused||cc.director.getAnimationManager().removeAnimator(this)},d.onResume=function(){cc.director.getAnimationManager().addAnimator(this)},d.onPause=function(){cc.director.getAnimationManager().removeAnimator(this)},d.addAnimation=function(t){-1===this._anims.array.indexOf(t)&&this._anims.push(t)},d.removeAnimation=function(t){var e=this._anims.array.indexOf(t);e>=0?this._anims.fastRemoveAt(e):cc.errorID(3908)},c.extend(r,n);var _=r.prototype;_.animate=function(t,e){if(!t)return cc.errorID(3909),null;o(t);var i=this._doAnimate(t,e);return this.play(),i},_._doAnimate=function(t,e){var i=new l(this,null,e);i.play();for(var n=i.curves,r=-1,o=0;o<t.length;o++){var s=t[o],c=s.ratio;if("number"!=typeof c&&(c=s.computedRatio),c<0)cc.errorID(3910);else if(c<r)cc.errorID(3911);else{r=c;for(var h in s){var u=s[h];if("props"===h)for(var d in u)a(n,this.target,d,u[d],c);else if("comps"===h)for(var _ in u){var f=this.target.getComponent(_),p=u[_];for(var d in p)a(n,f,d,p[d],c)}}}}return this._anims.push(i),i},e.exports={Animator:n,EntityAnimator:r}}),{"./animation-curves":14,"./playable":22,"./types":23}],18:[(function(t,e,i){function n(t,e,i,n,r){var o=1-r;return t*o*o*o+3*e*o*o*r+3*i*o*r*r+n*r*r*r}function r(t){return t<0?-Math.pow(-t,1/3):Math.pow(t,1/3)}function o(t,e){var i,n,o,s,d,_=e-0,f=e-t[0],p=3*_,g=3*f,v=3*(e-t[2]),m=1/(-_+g-v+(e-1)),y=(p-6*f+v)*m,T=y*(1/3),C=(-p+g)*m,x=1/3*(3*C-y*y),E=x*(1/3),S=(2*y*y*y-9*y*C+27*(_*m))/27,b=S/2,A=b*b+E*E*E;if(A<0){var R=1/3*-x,I=u(R*R*R),w=-S/(2*I),O=c(w<-1?-1:w>1?1:w),L=2*r(I);return o=L*a(O*(1/3))-T,s=L*a((O+l)*(1/3))-T,d=L*a((O+2*l)*(1/3))-T,0<=o&&o<=1?0<=s&&s<=1?0<=d&&d<=1?h(o,s,d):h(o,s):0<=d&&d<=1?h(o,d):o:0<=s&&s<=1?0<=d&&d<=1?h(s,d):s:d}if(0===A)return i=b<0?r(-b):-r(b),o=2*i-T,s=-i-T,0<=o&&o<=1?0<=s&&s<=1?h(o,s):o:s;var P=u(A);return i=r(-b+P),n=r(b+P),o=i-n-T}function s(t,e){var i=o(t,e),n=1-i;return 0*n*n*n+3*t[1]*i*n*n+3*t[3]*i*i*n+1*i*i*i}var a=Math.cos,c=Math.acos,h=Math.max,l=2*Math.PI,u=Math.sqrt;e.exports={bezier:n,bezierByTime:s}}),{}],19:[(function(t,e,i){function n(t,e){return function(i){return i<.5?e(2*i)/2:t(2*i-1)/2+.5}}var r={constant:function(){return 0},linear:function(t){return t},quadIn:function(t){return t*t},quadOut:function(t){return t*(2-t)},quadInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},quartIn:function(t){return t*t*t*t},quartOut:function(t){return 1- --t*t*t*t},quartInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},quintIn:function(t){return t*t*t*t*t},quintOut:function(t){return--t*t*t*t*t+1},quintInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},sineIn:function(t){return 1-Math.cos(t*Math.PI/2)},sineOut:function(t){return Math.sin(t*Math.PI/2)},sineInOut:function(t){return.5*(1-Math.cos(Math.PI*t))},expoIn:function(t){return 0===t?0:Math.pow(1024,t-1)},expoOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},expoInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},circIn:function(t){return 1-Math.sqrt(1-t*t)},circOut:function(t){return Math.sqrt(1- --t*t)},circInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},elasticIn:function(t){var e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),-i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4))},elasticOut:function(t){var e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/.4)+1)},elasticInOut:function(t){var e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),(t*=2)<1?i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4)*-.5:i*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4)*.5+1)},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},backInOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)},bounceOut:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},smooth:function(t){return t<=0?0:t>=1?1:t*t*(3-2*t)},fade:function(t){return t<=0?0:t>=1?1:t*t*t*(t*(6*t-15)+10)}};r.quadOutIn=n(r.quadIn,r.quadOut),r.cubicOutIn=n(r.cubicIn,r.cubicOut),r.quartOutIn=n(r.quartIn,r.quartOut),r.quintOutIn=n(r.quintIn,r.quintOut),r.sineOutIn=n(r.sineIn,r.sineOut),r.expoOutIn=n(r.expoIn,r.expoOut),r.circOutIn=n(r.circIn,r.circOut),r.backOutIn=n(r.backIn,r.backOut),r.backOutIn=n(r.backIn,r.backOut),r.bounceIn=function(t){return 1-r.bounceOut(1-t)},r.bounceInOut=function(t){return t<.5?.5*r.bounceIn(2*t):.5*r.bounceOut(2*t-1)+.5},r.bounceOutIn=n(r.bounceIn,r.bounceOut),cc.Easing=e.exports=r}),{}],20:[(function(t,e,i){t("./bezier"),t("./easing"),t("./types"),t("./motion-path-helper"),t("./animation-curves"),t("./animation-clip"),t("./animators"),t("./animation-manager"),t("./animation-state"),t("./animation-animator")}),{"./animation-animator":12,"./animation-clip":13,"./animation-curves":14,"./animation-manager":15,"./animation-state":16,"./animators":17,"./bezier":18,"./easing":19,"./motion-path-helper":21,"./types":23}],21:[(function(t,e,i){function n(t){this.points=t||[],this.beziers=[],this.ratios=[],this.progresses=[],this.length=0,this.computeBeziers()}function r(){this.start=l(),this.end=l(),this.startCtrlPoint=l(),this.endCtrlPoint=l()}function o(t,e,i,r){function o(t){return t instanceof cc.Vec2?{in:t,pos:t,out:t}:Array.isArray(t)&&6===t.length?{in:l(t[2],t[3]),pos:l(t[0],t[1]),out:l(t[4],t[5])}:{in:cc.Vec2.ZERO,pos:cc.Vec2.ZERO,out:cc.Vec2.ZERO}}function c(t,e,i){f.push(t),p.push(e),g.push(i)}var u=e.values;if(0!==t.length&&0!==u.length)if(1!==(u=u.map((function(t){return l(t[0],t[1])}))).length){for(var d=e.types,_=e.ratios,f=e.values=[],p=e.types=[],g=e.ratios=[],v=0,m=s.Linear,y=0,T=t.length;y<T-1;y++){var C,x=t[y],E=_[y],S=_[y+1]-E,b=u[y],A=u[y+1],R=d[y],I=[],w=v/S,O=1/(S*i*r);if(x&&x.length>0){var L=[];L.push(o(b));for(var P=0,D=x.length;P<D;P++){var N=o(x[P]);L.push(N)}L.push(o(A));var F=new n(L);F.computeBeziers();for(var M=F.progresses;1-w>1e-6;){var B,z,V,W;if((C=a(C=w,R))<0)W=(0-C)*(z=F.beziers[0]).getLength(),V=z.start.sub(z.endCtrlPoint).normalize(),B=z.start.add(V.mul(W));else if(C>1)W=(C-1)*(z=F.beziers[F.beziers.length-1]).getLength(),V=z.end.sub(z.startCtrlPoint).normalize(),B=z.end.add(V.mul(W));else{var U=h(M,C);U<0&&(U=~U),C-=U>0?M[U-1]:0,C/=F.ratios[U],B=F.beziers[U].getPointAt(C)}I.push(B),w+=O}}else for(;1-w>1e-6;)C=a(C=w,R),I.push(b.lerp(A,C)),w+=O;m="constant"===R?R:s.Linear;for(var P=0,D=I.length;P<D;P++){var k=E+v+O*P*S;c(I[P],m,k)}v=Math.abs(w-1)>1e-6?(w-1)*S:0}_[_.length-1]!==g[g.length-1]&&c(u[u.length-1],m,_[_.length-1])}else e.values=u}var s=t("./animation-curves").DynamicAnimCurve,a=t("./animation-curves").computeRatioByType,c=t("./bezier").bezier,h=t("../core/utils/binary-search").binarySearchEpsilon,l=cc.v2;n.prototype.computeBeziers=function(){this.beziers.length=0,this.ratios.length=0,this.progresses.length=0,this.length=0;for(var t,e=1;e<this.points.length;e++){var i=this.points[e-1],n=this.points[e];(t=new r).start=i.pos,t.startCtrlPoint=i.out,t.end=n.pos,t.endCtrlPoint=n.in,this.beziers.push(t),this.length+=t.getLength()}for(var o=0,e=0;e<this.beziers.length;e++)t=this.beziers[e],this.ratios[e]=t.getLength()/this.length,this.progresses[e]=o+=this.ratios[e];return this.beziers},r.prototype.getPointAt=function(t){var e=this.getUtoTmapping(t);return this.getPoint(e)},r.prototype.getPoint=function(t){var e=c(this.start.x,this.startCtrlPoint.x,this.endCtrlPoint.x,this.end.x,t),i=c(this.start.y,this.startCtrlPoint.y,this.endCtrlPoint.y,this.end.y,t);return new l(e,i)},r.prototype.getLength=function(){var t=this.getLengths();return t[t.length-1]},r.prototype.getLengths=function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===t+1)return this.cacheArcLengths;var e,i,n=[],r=this.getPoint(0),o=0;for(n.push(0),i=1;i<=t;i++)e=this.getPoint(i/t),o+=cc.pDistance(e,r),n.push(o),r=e;return this.cacheArcLengths=n,n},r.prototype.getUtoTmapping=function(t,e){var i,n=this.getLengths(),r=0,o=n.length;i=e||t*n[o-1];for(var s,a=0,c=o-1;a<=c;)if(r=Math.floor(a+(c-a)/2),(s=n[r]-i)<0)a=r+1;else{if(!(s>0)){c=r;break}c=r-1}if(r=c,n[r]===i)return l=r/(o-1);var h=n[r],l=(r+(i-h)/(n[r+1]-h))/(o-1);return l},e.exports={sampleMotionPaths:o,Curve:n,Bezier:r}}),{"../core/utils/binary-search":192,"./animation-curves":14,"./bezier":18}],22:[(function(t,e,i){function n(){this._isPlaying=!1,this._isPaused=!1,this._stepOnce=!1}var r=cc.js,o=n.prototype;r.get(o,"isPlaying",(function(){return this._isPlaying}),!0),r.get(o,"isPaused",(function(){return this._isPaused}),!0);var s=function(){};o.onPlay=s,o.onPause=s,o.onResume=s,o.onStop=s,o.onError=s,o.play=function(){this._isPlaying?this._isPaused?(this._isPaused=!1,this.onResume()):this.onError("already-playing"):(this._isPlaying=!0,this.onPlay())},o.stop=function(){this._isPlaying&&(this._isPlaying=!1,this.onStop(),this._isPaused=!1)},o.pause=function(){this._isPlaying&&(this._isPaused=!0,this.onPause())},o.resume=function(){this._isPlaying&&this._isPaused&&(this._isPaused=!1,this.onResume())},o.step=function(){this.pause(),this._stepOnce=!0,this._isPlaying||this.play()},e.exports=n}),{}],23:[(function(t,e,i){function n(t){t?this.set(t):(this.ratio=0,this.time=0,this.direction=1,this.stopped=!0,this.iterations=0,this.frameIndex=void 0)}function r(){a.call(this)}function o(t,e,i){if(r.call(this),cc.EventTarget.call(this),this._firstFramePlayed=!1,this._delay=0,this._delayTime=0,this._wrappedInfo=new n,this._lastWrappedInfo=null,this.animator=t,this.curves=e||[],this.delay=0,this.repeatCount=1,this.duration=1,this.speed=1,this.wrapMode=h.Normal,i){this.delay=i.delay||this.delay;var o=i.duration;void 0!==o&&(this.duration=o);var s=i.speed;void 0!==s&&(this.speed=s);var a=i.wrapMode;if(void 0!==a){var l="number"==typeof a;this.wrapMode=l?a:h[a]}var u=i.repeatCount;void 0!==u?this.repeatCount=u:this.wrapMode&c.Loop&&(this.repeatCount=1/0)}this.time=0}var s=cc.js,a=t("./playable"),c={Loop:2,ShouldWrap:4,PingPong:22,Reverse:36},h=cc.Enum({Default:0,Normal:1,Reverse:c.Reverse,Loop:c.Loop,LoopReverse:c.Loop|c.Reverse,PingPong:c.PingPong,PingPongReverse:c.PingPong|c.Reverse});cc.WrapMode=h,n.prototype.set=function(t){this.ratio=t.ratio,this.time=t.time,this.direction=t.direction,this.stopped=t.stopped,this.iterations=t.iterations,this.frameIndex=t.frameIndex},s.extend(r,a),r.prototype.update=function(t){},s.extend(o,r);var l=o.prototype;l.update=function(t){if(!(this._delayTime>0&&(this._delayTime-=t,this._delayTime>0))){this._firstFramePlayed?this.time+=t*this.speed:this._firstFramePlayed=!0;var e=this.sample();this._lastWrappedInfo||(this._lastWrappedInfo=new n(e));var i=(0|e.iterations)>(0|this._lastWrappedInfo.iterations);this.repeatCount>1&&i&&((this.wrapMode&c.Reverse)===c.Reverse?this._lastWrappedInfo.direction<0&&this.emit("lastframe",this):this._lastWrappedInfo.direction>0&&this.emit("lastframe",this)),e.stopped&&(this.stop(),this.emit("finished",this)),this._lastWrappedInfo.set(e)}},l._needRevers=function(t){var e=this.wrapMode,i=!1;return(e&c.PingPong)===c.PingPong&&(t-(0|t)==0&&t>0&&(t-=1),1&t&&(i=!i)),(e&c.Reverse)===c.Reverse&&(i=!i),i},l.getWrappedInfo=function(t,e){e=e||new n;var i=!1,r=this.duration,o=0,s=this.wrapMode,a=Math.abs(t/r);a>this.repeatCount&&(a=this.repeatCount);var h=!1;s&c.ShouldWrap&&(h=this._needRevers(a));var l=h?-1:1;if(this.speed<0&&(l*=-1),a>=this.repeatCount){i=!0;var u=this.repeatCount-(0|this.repeatCount);0===u&&(u=1),t=u*r*(t>0?1:-1)}if(t>r){var d=t%r;t=0===d?r:d}else t<0&&0!==(t%=r)&&(t+=r);return s&c.ShouldWrap&&h&&(t=r-t),o=t/r,e.ratio=o,e.time=t,e.direction=l,e.stopped=i,e.iterations=a,e},l.sample=function(){for(var t=this.getWrappedInfo(this.time,this._wrappedInfo),e=this.curves,i=0,n=e.length;i<n;i++)e[i].sample(t.time,t.ratio,this);return t},l.onStop=function(){this.emit("stop",this)},l.onPlay=function(){this._delayTime=this._delay,this.emit("play",this)},l.onPause=function(){this.emit("pause",this)},l.onResume=function(){this.emit("resume",this)},s.getset(l,"wrapMode",(function(){return this._wrapMode}),(function(t){this._wrapMode=t,this.time=0,t&c.Loop?this.repeatCount=1/0:this.repeatCount=1})),s.getset(l,"delay",(function(){return this._delay}),(function(t){this._delayTime=this._delay=t})),cc.js.mixin(l,cc.EventTarget.prototype),cc.AnimationNode=o,e.exports={WrapModeMask:c,WrapMode:h,AnimationNode:o,WrappedInfo:n}}),{"./playable":22}],24:[(function(t,e,i){var n=t("../core/event/event-target"),r=!1,o=[],s=function(t){n.call(this),this._src=t,this._audioType=s.Type.UNKNOWN,this._element=null,this._eventList={},this._state=s.State.INITIALZING,this._loaded=!1,this._onended=function(){this.emit("ended")}.bind(this)};cc.js.extend(s,n),s.Type={DOM:"AUDIO",WEBAUDIO:"WEBAUDIO",NATIVE:"NATIVE",UNKNOWN:"UNKNOWN"},s.State={ERROR:-1,INITIALZING:0,PLAYING:1,PAUSED:2},(function(t){t.preload=function(){var t=this._src,e=this;if(!t)return this._src="",this._audioType=s.Type.UNKNOWN,this._element=null,this._state=s.State.INITIALZING,void(this._loaded=!1);var i=cc.loader.getItem(t);if(i||(i=cc.loader.getItem(t+"?useDom=1")),!i)return cc.loader.load(t,(function(i){if(!i){var n=cc.loader.getItem(t);e.mount(n.element||n.buffer),e.emit("load")}}));i.complete&&(e.mount(i.element||i.buffer),e.emit("load"))},t._bindEnded=function(t){t=t||this._onended,this._audioType===s.Type.DOM?this._element.addEventListener("ended",t):this._element.onended=t},t._unbindEnded=function(){this._audioType===s.Type.DOM?this._element.removeEventListener("ended",this._onended):this._element.onended=null},t.mount=function(t){cc._isWechatGame()||t instanceof HTMLElement?(this._element=document.createElement("audio"),this._element.src=t.src,this._audioType=s.Type.DOM):(this._element=new a(t,this),this._audioType=s.Type.WEBAUDIO),this._state=s.State.INITIALZING,this._loaded=!0},t.play=function(){this._element&&(this._bindEnded(),this._element.play(),this.emit("play"),this._state=s.State.PLAYING,!cc._isWechatGame()&&this._audioType===s.Type.DOM&&this._element.paused&&o.push({instance:this,offset:0,audio:this._element}),r||(r=!0,cc.game.canvas.addEventListener("touchstart",(function(){for(var t;t=o.pop();)t.audio.play(t.offset)}))))},t.pause=function(){this._element&&(this._unbindEnded(),this._element.pause(),this.emit("pause"),this._state=s.State.PAUSED)},t.resume=function(){this._element&&0!==this._element.currentTime&&(this._bindEnded(),this._element.play(),this.emit("resume"),this._state=s.State.PLAYING)},t.stop=function(){if(this._element){try{this._element.currentTime=0}catch(t){}this._element.pause();for(var t=0;t<o.length;t++)if(o[t].instance===this){o.splice(t,1);break}this._unbindEnded(),this.emit("stop"),this._state=s.State.PAUSED}},t.setLoop=function(t){this._element&&(this._element.loop=t)},t.getLoop=function(){return this._element&&this._element.loop},t.setVolume=function(t){this._element&&(this._element.volume=t)},t.getVolume=function(){return this._element?this._element.volume:1},t.setCurrentTime=function(t){if(this._element){this._unbindEnded(),cc._isWechatGame()||this._bindEnded(function(){this._bindEnded()}.bind(this));try{this._element.currentTime=t}catch(n){var e=this._element;if(e.addEventListener){var i=function(){e.removeEventListener("loadedmetadata",i),e.currentTime=t};e.addEventListener("loadedmetadata",i)}}}},t.getCurrentTime=function(){return this._element?this._element.currentTime:0},t.getDuration=function(){return this._element?this._element.duration:0},t.getState=function(){var t=this._element;return s.State.PLAYING===this._state&&t.paused&&(this._state=s.State.PAUSED),this._state},t.__defineGetter__("src",(function(){return this._src})),t.__defineSetter__("src",(function(t){return this._src=t})),t.__defineGetter__("paused",(function(){return!this._element||this._element.paused}))})(s.prototype);var a=function(t,e){this._audio=e,this._context=cc.sys.__audioSupport.context,this._buffer=t,this._volume=this._context.createGain(),this._volume.gain.value=1,this._volume.connect(this._context.destination),this._loop=!1,this._startTime=-1,this._currentSource=null,this.playedLength=0,this._currextTimer=null,this._endCallback=function(){this.onended&&this.onended(this)}.bind(this)};!(function(t){t.play=function(t){this._currentSource&&!this.paused&&(this._currentSource.onended=null,this._currentSource.stop(0),this.playedLength=0);var e=this._context.createBufferSource();e.buffer=this._buffer,e.connect(this._volume),e.loop=this._loop,this._startTime=this._context.currentTime,(t=t||this.playedLength)&&(this._startTime-=t);var i,n=this._buffer.duration,r=t;if(this._loop?e.start?e.start(0,r):e.notoGrainOn?e.noteGrainOn(0,r):e.noteOn(0,r):(i=n-t,e.start?e.start(0,r,i):e.notoGrainOn?e.noteGrainOn(0,r,i):e.noteOn(0,r,i)),this._currentSource=e,e.onended=this._endCallback,(!e.context.state||"suspended"===e.context.state)&&0===this._context.currentTime){var s=this;clearTimeout(this._currextTimer),this._currextTimer=setTimeout((function(){cc._isWechatGame()||0!==s._context.currentTime||o.push({instance:s._audio,offset:t,audio:s})}),10)}},t.pause=function(){if(clearTimeout(this._currextTimer),!this.paused){this.playedLength=this._context.currentTime-this._startTime,this.playedLength%=this._buffer.duration;var t=this._currentSource;this._currentSource=null,this._startTime=-1,t&&t.stop(0)}},t.__defineGetter__("paused",(function(){return(!this._currentSource||!this._currentSource.loop)&&(-1===this._startTime||this._context.currentTime-this._startTime>this._buffer.duration)})),t.__defineGetter__("loop",(function(){return this._loop})),t.__defineSetter__("loop",(function(t){return this._currentSource&&(this._currentSource.loop=t),this._loop=t})),t.__defineGetter__("volume",(function(){return this._volume.gain.value})),t.__defineSetter__("volume",(function(t){return this._volume.gain.value=t,cc.sys.os===cc.sys.OS_IOS&&!this.paused&&this._currentSource&&(this._currentSource.onended=null,this.pause(),this.play()),t})),t.__defineGetter__("currentTime",(function(){return this.paused?this.playedLength:(this.playedLength=this._context.currentTime-this._startTime,this.playedLength%=this._buffer.duration,this.playedLength)})),t.__defineSetter__("currentTime",(function(t){return this.paused?this.playedLength=t:(this.pause(),this.playedLength=t,this.play()),t})),t.__defineGetter__("duration",(function(){return this._buffer.duration}))})(a.prototype),e.exports=cc.Audio=s}),{"../core/event/event-target":110}],25:[(function(t,e,i){var n=t("./CCAudio"),r=0,o={},s={},a=function(t){var e=r++,i=s[t];i||(i=s[t]=[]);var a;if(h._maxAudioInstance<=i.length){var c=i.shift();o[c].stop()}var l=function(){var t=this.instanceId;delete o[t];var e=i.indexOf(t);cc.js.array.fastRemoveAt(i,e)};return(a=new n(t)).on("ended",l),a.on("stop",l),o[e]=a,a.instanceId=e,i.push(e),a},c=function(t){return o[t]},h={AudioState:n.State,_maxWebAudioSize:2097152,_maxAudioInstance:24,_id2audio:o,play:function(t,e,i){t=cc._appendLocalUrlPrefix(t);var n=a(t),r=function(){n.setLoop(e||!1),("number"!=typeof i||isNaN(i))&&(i=1),n.setVolume(i),n.play()};return n.__callback=r,n.on("load",r),n.preload(),n.instanceId},setLoop:function(t,e){var i=c(t);i&&i.setLoop&&i.setLoop(e)},isLoop:function(t){var e=c(t);return!(!e||!e.isLoop)&&e.isLoop()},setVolume:function(t,e){var i=c(t);i&&(i._loaded||i.once("load",(function(){i.setVolume&&i.setVolume(e)})),i.setVolume&&i.setVolume(e))},getVolume:function(t){var e=c(t);return e&&e.getVolume?e.getVolume():1},setCurrentTime:function(t,e){var i=c(t);return!!i&&(i._loaded?(i.setCurrentTime&&i.setCurrentTime(e),!0):(i.once("load",(function(){i.setCurrentTime&&i.setCurrentTime(e)})),!0))},getCurrentTime:function(t){var e=c(t);return e&&e.getCurrentTime?e.getCurrentTime():0},getDuration:function(t){var e=c(t);return e&&e.getDuration?e.getDuration():0},getState:function(t){var e=c(t);return e&&e.getState?e.getState():this.AudioState.ERROR},setFinishCallback:function(t,e){var i=c(t);i&&(i.off("ended",i._finishCallback),i._finishCallback=e,i.on("ended",i._finishCallback))},pause:function(t){var e=c(t);return!(!e||!e.pause)&&(e.pause(),!0)},_pauseIDCache:[],pauseAll:function(){for(var t in o){var e=o[t];e.getState()===n.State.PLAYING&&(this._pauseIDCache.push(t),e.pause())}},resume:function(t){var e=c(t);if(!e||!e.resume)return!1;0===e.getCurrentTime()?e.play():e.resume()},resumeAll:function(){for(;this._pauseIDCache.length>0;){var t=this._pauseIDCache.pop(),e=c(t);e&&e.resume&&e.resume()}},stop:function(t){var e=c(t);return!(!e||!e.stop)&&(e.off("load",e.__callback),e.stop(),!0)},stopAll:function(){for(var t in o){var e=o[t];e&&e.stop&&(e.stop(),e.off("load",e.__callback))}},setMaxAudioInstance:function(t){return this._maxAudioInstance=t},getMaxAudioInstance:function(){return this._maxAudioInstance},uncache:function(t){var e=s[t];if(e)for(;e.length>0;){var i=e.pop(),n=o[i];n&&(n.stop(),delete o[i])}},uncacheAll:function(){this.stopAll(),o={},s={}},getProfile:function(t){},preload:function(t,e){cc.loader.load(t,(function(t){t||e()}))},setMaxWebAudioSize:function(t){this._maxWebAudioSize=1024*t},_breakCache:null,_break:function(){this._breakCache=[];for(var t in o){var e=o[t];e.getState()===n.State.PLAYING&&(this._breakCache.push(t),e.pause())}},_restore:function(){if(this._breakCache){for(;this._breakCache.length>0;){var t=this._breakCache.pop(),e=c(t);e&&e.resume&&e.resume()}this._breakCache=null}}};e.exports=cc.audioEngine=h;var l=t("./deprecated");l.removed(h),l.deprecated(h)}),{"./CCAudio":24,"./deprecated":26}],26:[(function(t,e,i){var n=cc.js;i.removed=function(t){function e(){cc.errorID(1403)}n.getset(t,"willPlayMusic",e,e)},i.deprecated=function(t){var e=-1,i=1,r=1,o=1,s=1,a=[];n.get(t,"playMusic",(function(){return function(n,s){return t.stop(e),e=t.play(n,s,o),i=n,r=s,e}})),n.get(t,"stopMusic",(function(){return function(){return t.stop(e),e}})),n.get(t,"pauseMusic",(function(){return function(){return t.pause(e),e}})),n.get(t,"resumeMusic",(function(){return function(){return t.resume(e),e}})),n.get(t,"rewindMusic",(function(){return function(){return t.setCurrentTime(e,0),e}})),n.get(t,"getMusicVolume",(function(){return function(){return o}})),n.get(t,"setMusicVolume",(function(){return function(i){return o=i,t.setVolume(e,o),o}})),n.get(t,"isMusicPlaying",(function(){return function(){return t.getState(e)===t.AudioState.PLAYING}})),n.get(t,"playEffect",(function(){return function(e,i,n){return t.play(e,i||!1,void 0===n?s:n)}})),n.get(t,"setEffectsVolume",(function(i){return function(i){s=i;var n=t._id2audio;for(var r in n)r!==e&&t.setVolume(r,i)}})),n.get(t,"getEffectsVolume",(function(){return function(){return s}})),n.get(t,"pauseEffect",(function(){return function(e){return t.pause(e)}})),n.get(t,"pauseAllEffects",(function(){return function(){a.length=0;var i=t._id2audio;for(var n in i)if(n!==e){var r=i[n];r.getState()===t.AudioState.PLAYING&&(a.push(n),r.pause())}}})),n.get(t,"resumeEffect",(function(){return function(e){t.resume(e)}})),n.get(t,"resumeAllEffects",(function(){return function(){for(var e=t._id2audio;a.length>0;){var i=e[a.pop()];i&&i.resume&&i.resume()}}})),n.get(t,"stopEffect",(function(){return function(e){return t.stop(e)}})),n.get(t,"stopAllEffects",(function(){return function(){var i=t._id2audio;for(var n in i)if(n!==e){var r=i[n];r.getState()===t.AudioState.PLAYING&&r.stop()}}})),n.get(t,"unloadEffect",(function(){return function(e){return t.stop(e)}})),n.get(t,"end",(function(){return function(){return t.stopAll()}}))}}),{}],27:[(function(t,e,i){cc.ClippingNode=_ccsg.Node.extend({inverted:!1,_alphaThreshold:0,_stencil:null,_className:"ClippingNode",_originStencilProgram:null,ctor:function(t){t=t||null,_ccsg.Node.prototype.ctor.call(this),this._stencil=t,t&&(this._originStencilProgram=t.getShaderProgram()),this.alphaThreshold=1,this.inverted=!1,this._renderCmd.initStencilBits()},onEnter:function(){_ccsg.Node.prototype.onEnter.call(this),this._stencil&&this._stencil.performRecursive(_ccsg.Node.performType.onEnter)},onEnterTransitionDidFinish:function(){_ccsg.Node.prototype.onEnterTransitionDidFinish.call(this),this._stencil&&this._stencil.performRecursive(_ccsg.Node.performType.onEnterTransitionDidFinish)},onExitTransitionDidStart:function(){this._stencil&&this._stencil.performRecursive(_ccsg.Node.performType.onExitTransitionDidStart),_ccsg.Node.prototype.onExitTransitionDidStart.call(this)},onExit:function(){this._stencil&&this._stencil.performRecursive(_ccsg.Node.performType.onExit),_ccsg.Node.prototype.onExit.call(this)},visit:function(t){this._renderCmd.clippingVisit(t&&t._renderCmd)},_visitChildren:function(){this._reorderChildDirty&&this.sortAllChildren();for(var t,e=this._children,i=0,n=e.length;i<n;i++)(t=e[i])&&t._visible&&t.visit(this);this._renderCmd._dirtyFlag=0},getAlphaThreshold:function(){return this._alphaThreshold},setAlphaThreshold:function(t){1===t&&t!==this._alphaThreshold&&this._renderCmd.resetProgramByStencil(),this._alphaThreshold=t},isInverted:function(){return this.inverted},setInverted:function(t){this.inverted=t},getStencil:function(){return this._stencil},setStencil:function(t){this._stencil!==t&&(t&&(this._originStencilProgram=t.getShaderProgram()),this._renderCmd.setStencil(t))},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.ClippingNode.CanvasRenderCmd(this):new cc.ClippingNode.WebGLRenderCmd(this)}}),cc.ClippingNode.stencilBits=-1;var n=cc.ClippingNode.prototype;cc.defineGetterSetter(n,"stencil",n.getStencil,n.setStencil),cc.defineGetterSetter(n,"alphaThreshold",n.getAlphaThreshold,n.setAlphaThreshold)}),{}],28:[(function(t,e,i){cc.ClippingNode.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!1,this._rendererClipCmd=new cc.CustomRenderCmd(this,this._drawStencilCommand),this._rendererRestoreCmd=new cc.CustomRenderCmd(this,this._restoreCmdCallback)};var n=cc.ClippingNode.CanvasRenderCmd.prototype=Object.create(_ccsg.Node.CanvasRenderCmd.prototype);n.constructor=cc.ClippingNode.CanvasRenderCmd,n.resetProgramByStencil=function(){},n.initStencilBits=function(){},n.setStencil=function(t){null!=t&&(this._node._stencil=t,t instanceof cc.DrawNode||cc.errorID(6300))},n._restoreCmdCallback=function(t){(t||cc._renderContext).restore()},n._drawStencilCommand=function(t,e,i){var n=t||cc._renderContext,r=n.getContext();n.save(),r.beginPath(),n.setTransform(this._worldTransform,e,i);for(var o=this._node._stencil._buffer,s=0;s<o.length;++s){var a=o[s].verts;if(!(a.length<3)){r.moveTo(a[0].x,-a[0].y);for(var c=1;c<a.length;++c)r.lineTo(a[c].x,-a[c].y)}}r.clip()},n.clippingVisit=function(t){var e=this._node;if(t=t||this.getParentRenderCmd(),this._propagateFlagsDown(t),e._visible){t&&(this._curLevel=t._curLevel+1),this._syncStatus(t),e._stencil&&cc.renderer.pushRenderCommand(this._rendererClipCmd);var i,n=e._children,r=n.length;if(r>0)for(e.sortAllChildren(),i=0;i<r;i++)n[i].visit(e);e._stencil&&cc.renderer.pushRenderCommand(this._rendererRestoreCmd),this._dirtyFlag=0}}}),{}],29:[(function(t,e,i){function n(t,e){t.shaderProgram=e;var i=t.children;if(i)for(var r=0;r<i.length;r++)n(i[r],e)}var r={stencilEnabled:!1,depthWriteMask:!0};cc.ClippingNode.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!1,this._beforeVisitCmd=new cc.CustomRenderCmd(this,this._onBeforeVisit),this._afterDrawStencilCmd=new cc.CustomRenderCmd(this,this._onAfterDrawStencil),this._afterVisitCmd=new cc.CustomRenderCmd(this,this._onAfterVisit),this._previousState=null,this._state={stencilEnabled:!0,stencilWriteMask:0,depthWriteMask:!1,stencilFunc:0,stencilRef:0,stencilValueMask:0}};var o=cc.ClippingNode.WebGLRenderCmd.prototype=Object.create(_ccsg.Node.WebGLRenderCmd.prototype);o.constructor=cc.ClippingNode.WebGLRenderCmd,cc.ClippingNode.WebGLRenderCmd._init_once=null,cc.ClippingNode.WebGLRenderCmd._visit_once=null,cc.ClippingNode.WebGLRenderCmd._layer=-1,o.initStencilBits=function(){cc.ClippingNode.WebGLRenderCmd._init_once=!0,cc.ClippingNode.WebGLRenderCmd._init_once&&(cc.ClippingNode.stencilBits=cc._renderContext.getParameter(cc._renderContext.STENCIL_BITS),cc.ClippingNode.stencilBits<=0&&cc.logID(6301),cc.ClippingNode.WebGLRenderCmd._init_once=!1)},o.transform=function(t,e){var i=this._node;this.originTransform(t,e),i._stencil&&(i._stencil._renderCmd.transform(this,!0),i._stencil._dirtyFlag&=~_ccsg.Node._dirtyFlags.transformDirty)},o.clippingVisit=function(t){var e=this._node;if(t=t||this.getParentRenderCmd(),this.visit(t),cc.ClippingNode.stencilBits<1)e._visitChildren();else if(e._stencil&&e._stencil.visible){if(cc.ClippingNode.WebGLRenderCmd._layer+1===cc.ClippingNode.stencilBits)return cc.ClippingNode.WebGLRenderCmd._visit_once=!0,cc.ClippingNode.WebGLRenderCmd._visit_once&&(cc.logID(6302,cc.ClippingNode.stencilBits),cc.ClippingNode.WebGLRenderCmd._visit_once=!1),void e._visitChildren();cc.renderer.pushRenderCommand(this._beforeVisitCmd),e._stencil.visit(e),cc.renderer.pushRenderCommand(this._afterDrawStencilCmd);var i=e._children;if(i&&i.length>0){var n=i.length;e.sortAllChildren();for(var r=0;r<n;r++)i[r].visit(e)}cc.renderer.pushRenderCommand(this._afterVisitCmd),this._dirtyFlag=0}else e.inverted&&e._visitChildren()},o.setStencil=function(t){var e=this._node;e._stencil&&(e._stencil._parent=null),e._stencil=t,e._stencil&&(e._stencil._parent=e)},o._drawFullScreenQuadClearStencil=function(){var t=cc.math.projection_matrix_stack;t.push(),t.top.identity();var e=cc.math.modelview_matrix_stack;e.push(),e.top.identity(),cc._drawingUtil.drawSolidRect(cc.p(-1,-1),cc.p(1,1),cc.color(255,255,255,255)),t.pop(),e.pop()},o.resetProgramByStencil=function(){var t=this._node;if(t._stencil){var e=t._originStencilProgram;n(t._stencil,e)}},o._onBeforeVisit=function(t){var e=t||cc._renderContext,i=this._node;cc.ClippingNode.WebGLRenderCmd._layer++;var o=1<<cc.ClippingNode.WebGLRenderCmd._layer,s=o|o-1;if(this._previousState=r,e.enable(e.STENCIL_TEST),e.stencilMask(o),e.depthMask(!1),e.stencilFunc(e.NEVER,o,o),e.stencilOp(this._node.inverted?e.REPLACE:e.ZERO,e.KEEP,e.KEEP),this._drawFullScreenQuadClearStencil(),e.stencilFunc(e.NEVER,o,o),e.stencilOp(this._node.inverted?e.ZERO:e.REPLACE,e.KEEP,e.KEEP),i.alphaThreshold<1){var a=cc.shaderCache.programForKey(cc.macro.SHADER_POSITION_TEXTURECOLORALPHATEST);cc.gl.useProgram(a.getProgram()),a.setUniformLocationWith1f(cc.macro.UNIFORM_ALPHA_TEST_VALUE_S,i.alphaThreshold),a.setUniformLocationWithMatrix4fv(cc.macro.UNIFORM_MVMATRIX_S,cc.renderer.mat4Identity.mat),n(i._stencil,a)}this._state.stencilWriteMask=o,this._state.stencilRef=this._state.stencilValueMask=s,this._state.stencilFunc=e.NEVER,r=this._state},o._onAfterDrawStencil=function(t){var e=t||cc._renderContext;e.depthMask(this._previousState.depthWriteMask),e.stencilFunc(e.EQUAL,this._state.stencilRef,this._state.stencilValueMask),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),this._state.stencilFunc=e.EQUAL},o._onAfterVisit=function(t){var e=t||cc._renderContext,i=this._previousState;i.stencilEnabled?(e.stencilFunc(i.stencilFunc,i.stencilRef,i.stencilValueMask),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.stencilMask(i.stencilWriteMask)):e.disable(e.STENCIL_TEST),r=this._previousState,this._previousState=null,cc.ClippingNode.WebGLRenderCmd._layer--}}),{}],30:[(function(t,e,i){cc.Codec={name:"Jacob__Codec"},cc.Codec.Base64=t("./base64"),cc.Codec.GZip=t("./gzip"),cc.Codec.unzip=function(){return cc.Codec.GZip.gunzip.apply(cc.Codec.GZip,arguments)},cc.Codec.unzipBase64=function(){var t=cc.Codec.Base64.decode.apply(cc.Codec.Base64,arguments);try{return cc.Codec.GZip.gunzip.call(cc.Codec.GZip,t)}catch(e){return t.slice(7)}},cc.Codec.unzipBase64AsArray=function(t,e){e=e||1;var i,n,r,o=this.unzipBase64(t),s=[];for(i=0,r=o.length/e;i<r;i++)for(s[i]=0,n=e-1;n>=0;--n)s[i]+=o.charCodeAt(i*e+n)<<8*n;return s},cc.Codec.unzipAsArray=function(t,e){e=e||1;var i,n,r,o=this.unzip(t),s=[];for(i=0,r=o.length/e;i<r;i++)for(s[i]=0,n=e-1;n>=0;--n)s[i]+=o.charCodeAt(i*e+n)<<8*n;return s}}),{"./base64":31,"./gzip":32}],31:[(function(t,e,i){var n=t("../core/utils/misc").BASE64_VALUES,r={name:"Jacob__Codec__Base64"};r.decode=function(t){var e,i,r,o,s,a,c=[],h=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");h<t.length;)e=n[t.charCodeAt(h++)]<<2|(o=n[t.charCodeAt(h++)])>>4,i=(15&o)<<4|(s=n[t.charCodeAt(h++)])>>2,r=(3&s)<<6|(a=n[t.charCodeAt(h++)]),c.push(String.fromCharCode(e)),64!==s&&c.push(String.fromCharCode(i)),64!==a&&c.push(String.fromCharCode(r));return c=c.join("")},r.decodeAsArray=function(t,e){var i,n,r,o=this.decode(t),s=[];for(i=0,r=o.length/e;i<r;i++)for(s[i]=0,n=e-1;n>=0;--n)s[i]+=o.charCodeAt(i*e+n)<<8*n;return s},e.exports=r}),{"../core/utils/misc":196}],32:[(function(t,e,i){var n=function(t){this.data=t,this.debug=!1,this.gpflags=void 0,this.files=0,this.unzipped=[],this.buf32k=new Array(32768),this.bIdx=0,this.modeZIP=!1,this.bytepos=0,this.bb=1,this.bits=0,this.nameBuf=[],this.fileout=void 0,this.literalTree=new Array(n.LITERALS),this.distanceTree=new Array(32),this.treepos=0,this.Places=null,this.len=0,this.fpos=new Array(17),this.fpos[0]=0,this.flens=void 0,this.fmax=void 0};n.gunzip=function(t){return t.constructor===Array||(t.constructor,String),new n(t).gunzip()[0][0]},n.HufNode=function(){this.b0=0,this.b1=0,this.jump=null,this.jumppos=-1},n.LITERALS=288,n.NAMEMAX=256,n.bitReverse=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],n.cplens=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],n.cplext=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],n.cpdist=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],n.cpdext=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],n.border=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],n.prototype.gunzip=function(){return this.outputArr=[],this.nextFile(),this.unzipped},n.prototype.readByte=function(){return this.bits+=8,this.bytepos<this.data.length?this.data.charCodeAt(this.bytepos++):-1},n.prototype.byteAlign=function(){this.bb=1},n.prototype.readBit=function(){var t;return this.bits++,t=1&this.bb,this.bb>>=1,0===this.bb&&(this.bb=this.readByte(),t=1&this.bb,this.bb=this.bb>>1|128),t},n.prototype.readBits=function(t){for(var e=0,i=t;i--;)e=e<<1|this.readBit();return t&&(e=n.bitReverse[e]>>8-t),e},n.prototype.flushBuffer=function(){this.bIdx=0},n.prototype.addBuffer=function(t){this.buf32k[this.bIdx++]=t,this.outputArr.push(String.fromCharCode(t)),32768===this.bIdx&&(this.bIdx=0)},n.prototype.IsPat=function(){for(;;){if(this.fpos[this.len]>=this.fmax)return-1;if(this.flens[this.fpos[this.len]]===this.len)return this.fpos[this.len]++;this.fpos[this.len]++}},n.prototype.Rec=function(){var t,e=this.Places[this.treepos];if(17===this.len)return-1;if(this.treepos++,this.len++,(t=this.IsPat())>=0)e.b0=t;else if(e.b0=32768,this.Rec())return-1;if((t=this.IsPat())>=0)e.b1=t,e.jump=null;else if(e.b1=32768,e.jump=this.Places[this.treepos],e.jumppos=this.treepos,this.Rec())return-1;return this.len--,0},n.prototype.CreateTree=function(t,e,i,n){var r;for(this.Places=t,this.treepos=0,this.flens=i,this.fmax=e,r=0;r<17;r++)this.fpos[r]=0;return this.len=0,this.Rec()?-1:0},n.prototype.DecodeValue=function(t){for(var e,i,n=0,r=t[n];;)if(this.readBit()){if(!(32768&r.b1))return r.b1;for(r=r.jump,e=t.length,i=0;i<e;i++)if(t[i]===r){n=i;break}}else{if(!(32768&r.b0))return r.b0;r=t[++n]}return-1},n.prototype.DeflateLoop=function(){var t,e,i;do{if(t=this.readBit(),0===(e=this.readBits(2))){var r,o;for(this.byteAlign(),r=this.readByte(),r|=this.readByte()<<8,o=this.readByte(),65535&(r^~(o|=this.readByte()<<8))&&document.write("BlockLen checksum mismatch\n");r--;)g=this.readByte(),this.addBuffer(g)}else if(1===e)for(;;)if((s=n.bitReverse[this.readBits(7)]>>1)>23?(s=s<<1|this.readBit())>199?s=(s-=128)<<1|this.readBit():(s-=48)>143&&(s+=136):s+=256,s<256)this.addBuffer(s);else{if(256===s)break;for(s-=257,f=this.readBits(n.cplext[s])+n.cplens[s],s=n.bitReverse[this.readBits(5)]>>3,n.cpdext[s]>8?(p=this.readBits(8),p|=this.readBits(n.cpdext[s]-8)<<8):p=this.readBits(n.cpdext[s]),p+=n.cpdist[s],s=0;s<f;s++){g=this.buf32k[this.bIdx-p&32767];this.addBuffer(g)}}else if(2===e){var s,a,c,h,l,u=new Array(320);for(c=257+this.readBits(5),h=1+this.readBits(5),l=4+this.readBits(4),s=0;s<19;s++)u[s]=0;for(s=0;s<l;s++)u[n.border[s]]=this.readBits(3);for(f=this.distanceTree.length,i=0;i<f;i++)this.distanceTree[i]=new n.HufNode;if(this.CreateTree(this.distanceTree,19,u,0))return this.flushBuffer(),1;a=c+h,i=0;for(;i<a;)if(0,(s=this.DecodeValue(this.distanceTree))<16)u[i++]=s;else if(16===s){var d;if(s=3+this.readBits(2),i+s>a)return this.flushBuffer(),1;for(d=i?u[i-1]:0;s--;)u[i++]=d}else{if(s=17===s?3+this.readBits(3):11+this.readBits(7),i+s>a)return this.flushBuffer(),1;for(;s--;)u[i++]=0}for(f=this.literalTree.length,i=0;i<f;i++)this.literalTree[i]=new n.HufNode;if(this.CreateTree(this.literalTree,c,u,0))return this.flushBuffer(),1;for(f=this.literalTree.length,i=0;i<f;i++)this.distanceTree[i]=new n.HufNode;var _=new Array;for(i=c;i<u.length;i++)_[i-c]=u[i];if(this.CreateTree(this.distanceTree,h,_,0))return this.flushBuffer(),1;for(;;)if((s=this.DecodeValue(this.literalTree))>=256){var f,p;if(0==(s-=256))break;for(s--,f=this.readBits(n.cplext[s])+n.cplens[s],s=this.DecodeValue(this.distanceTree),n.cpdext[s]>8?(p=this.readBits(8),p|=this.readBits(n.cpdext[s]-8)<<8):p=this.readBits(n.cpdext[s]),p+=n.cpdist[s];f--;){var g=this.buf32k[this.bIdx-p&32767];this.addBuffer(g)}}else this.addBuffer(s)}}while(!t);return this.flushBuffer(),this.byteAlign(),0},n.prototype.unzipFile=function(t){var e;for(this.gunzip(),e=0;e<this.unzipped.length;e++)if(this.unzipped[e][1]===t)return this.unzipped[e][0]},n.prototype.nextFile=function(){this.outputArr=[],this.modeZIP=!1;var t=[];if(t[0]=this.readByte(),t[1]=this.readByte(),120===t[0]&&218===t[1]&&(this.DeflateLoop(),this.unzipped[this.files]=[this.outputArr.join(""),"geonext.gxt"],this.files++),31===t[0]&&139===t[1]&&(this.skipdir(),this.unzipped[this.files]=[this.outputArr.join(""),"file"],this.files++),80===t[0]&&75===t[1]&&(this.modeZIP=!0,t[2]=this.readByte(),t[3]=this.readByte(),3===t[2]&&4===t[3])){t[0]=this.readByte(),t[1]=this.readByte(),this.gpflags=this.readByte(),this.gpflags|=this.readByte()<<8;var e=this.readByte();e|=this.readByte()<<8,this.readByte(),this.readByte(),this.readByte(),this.readByte();this.readByte();this.readByte()<<8,this.readByte()<<16,this.readByte()<<24;this.readByte();this.readByte()<<8,this.readByte()<<16,this.readByte()<<24;var i=this.readByte();i|=this.readByte()<<8;var r=this.readByte();for(r|=this.readByte()<<8,s=0,this.nameBuf=[];i--;){var o=this.readByte();"/"===o|":"===o?s=0:s<n.NAMEMAX-1&&(this.nameBuf[s++]=String.fromCharCode(o))}this.fileout||(this.fileout=this.nameBuf);for(var s=0;s<r;)o=this.readByte(),s++;8===e&&(this.DeflateLoop(),this.unzipped[this.files]=[this.outputArr.join(""),this.nameBuf.join("")],this.files++),this.skipdir()}},n.prototype.skipdir=function(){var t,e,i,r,o=[];if(8&this.gpflags&&(o[0]=this.readByte(),o[1]=this.readByte(),o[2]=this.readByte(),o[3]=this.readByte(),t=this.readByte(),t|=this.readByte()<<8,t|=this.readByte()<<16,t|=this.readByte()<<24,e=this.readByte(),e|=this.readByte()<<8,e|=this.readByte()<<16,e|=this.readByte()<<24),this.modeZIP&&this.nextFile(),o[0]=this.readByte(),8!==o[0])return 0;if(this.gpflags=this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),4&this.gpflags)for(o[0]=this.readByte(),o[2]=this.readByte(),this.len=o[0]+256*o[1],i=0;i<this.len;i++)this.readByte();if(8&this.gpflags)for(i=0,this.nameBuf=[];r=this.readByte();)"7"!==r&&":"!==r||(i=0),i<n.NAMEMAX-1&&(this.nameBuf[i++]=r);if(16&this.gpflags)for(;r=this.readByte(););2&this.gpflags&&(this.readByte(),this.readByte()),this.DeflateLoop(),e=this.readByte(),e|=this.readByte()<<8,e|=this.readByte()<<16,e|=this.readByte()<<24,this.modeZIP&&this.nextFile()},e.exports=n}),{}],33:[(function(t,e,i){(function(){"use strict";function t(t){throw t}function e(t,e){var i=t.split("."),n=y;!(i[0]in n)&&n.execScript&&n.execScript("var "+i[0]);for(var r;i.length&&(r=i.shift());)i.length||e===v?n=n[r]?n[r]:n[r]={}:n[r]=e}function i(t){if("string"==typeof t){var e,i,n=t.split("");for(e=0,i=n.length;e<i;e++)n[e]=(255&n[e].charCodeAt(0))>>>0;t=n}for(var r,o=1,s=0,a=t.length,c=0;0<a;){a-=r=1024<a?1024:a;do{s+=o+=t[c++]}while(--r);o%=65521,s%=65521}return(s<<16|o)>>>0}function n(e,i){this.index="number"==typeof i?i:0,this.i=0,this.buffer=e instanceof(T?Uint8Array:Array)?e:new(T?Uint8Array:Array)(32768),2*this.buffer.length<=this.index&&t(Error("invalid index")),this.buffer.length<=this.index&&this.f()}function r(t){this.buffer=new(T?Uint16Array:Array)(2*t),this.length=0}function o(t){var e,i,n,r,o,s,a,c,h,l=t.length,u=0,d=Number.POSITIVE_INFINITY;for(c=0;c<l;++c)t[c]>u&&(u=t[c]),t[c]<d&&(d=t[c]);for(e=1<<u,i=new(T?Uint32Array:Array)(e),n=1,r=0,o=2;n<=u;){for(c=0;c<l;++c)if(t[c]===n){for(s=0,a=r,h=0;h<n;++h)s=s<<1|1&a,a>>=1;for(h=s;h<e;h+=o)i[h]=n<<16|c;++r}++n,r<<=1,o<<=1}return[i,u,d]}function s(t,e){this.h=w,this.w=0,this.input=t,this.b=0,e&&(e.lazy&&(this.w=e.lazy),"number"==typeof e.compressionType&&(this.h=e.compressionType),e.outputBuffer&&(this.a=T&&e.outputBuffer instanceof Array?new Uint8Array(e.outputBuffer):e.outputBuffer),"number"==typeof e.outputIndex&&(this.b=e.outputIndex)),this.a||(this.a=new(T?Uint8Array:Array)(32768))}function a(t,e){this.length=t,this.G=e}function c(e,i){function n(e,i){var n,r=e.G,o=[],s=0;n=F[e.length],o[s++]=65535&n,o[s++]=n>>16&255,o[s++]=n>>24;var a;switch(m){case 1===r:a=[0,r-1,0];break;case 2===r:a=[1,r-2,0];break;case 3===r:a=[2,r-3,0];break;case 4===r:a=[3,r-4,0];break;case 6>=r:a=[4,r-5,1];break;case 8>=r:a=[5,r-7,1];break;case 12>=r:a=[6,r-9,2];break;case 16>=r:a=[7,r-13,2];break;case 24>=r:a=[8,r-17,3];break;case 32>=r:a=[9,r-25,3];break;case 48>=r:a=[10,r-33,4];break;case 64>=r:a=[11,r-49,4];break;case 96>=r:a=[12,r-65,5];break;case 128>=r:a=[13,r-97,5];break;case 192>=r:a=[14,r-129,6];break;case 256>=r:a=[15,r-193,6];break;case 384>=r:a=[16,r-257,7];break;case 512>=r:a=[17,r-385,7];break;case 768>=r:a=[18,r-513,8];break;case 1024>=r:a=[19,r-769,8];break;case 1536>=r:a=[20,r-1025,9];break;case 2048>=r:a=[21,r-1537,9];break;case 3072>=r:a=[22,r-2049,10];break;case 4096>=r:a=[23,r-3073,10];break;case 6144>=r:a=[24,r-4097,11];break;case 8192>=r:a=[25,r-6145,11];break;case 12288>=r:a=[26,r-8193,12];break;case 16384>=r:a=[27,r-12289,12];break;case 24576>=r:a=[28,r-16385,13];break;case 32768>=r:a=[29,r-24577,13];break;default:t("invalid distance")}n=a,o[s++]=n[0],o[s++]=n[1],o[s++]=n[2];var c,h;for(c=0,h=o.length;c<h;++c)p[g++]=o[c];C[o[0]]++,x[o[3]]++,y=e.length+i-1,d=null}var r,o,s,c,h,l,u,d,_,f={},p=T?new Uint16Array(2*i.length):[],g=0,y=0,C=new(T?Uint32Array:Array)(286),x=new(T?Uint32Array:Array)(30),E=e.w;if(!T){for(s=0;285>=s;)C[s++]=0;for(s=0;29>=s;)x[s++]=0}for(C[256]=1,r=0,o=i.length;r<o;++r){for(s=h=0,c=3;s<c&&r+s!==o;++s)h=h<<8|i[r+s];if(f[h]===v&&(f[h]=[]),l=f[h],!(0<y--)){for(;0<l.length&&32768<r-l[0];)l.shift();if(r+3>=o){for(d&&n(d,-1),s=0,c=o-r;s<c;++s)_=i[r+s],p[g++]=_,++C[_];break}if(0<l.length){var S=v,b=v,A=0,R=v,I=v,w=v,O=v,L=i.length,I=0,O=l.length;t:for(;I<O;I++){if(S=l[O-I-1],R=3,3<A){for(w=A;3<w;w--)if(i[S+w-1]!==i[r+w-1])continue t;R=A}for(;258>R&&r+R<L&&i[S+R]===i[r+R];)++R;if(R>A&&(b=S,A=R),258===R)break}u=new a(A,r-b),d?d.length<u.length?(_=i[r-1],p[g++]=_,++C[_],n(u,0)):n(d,-1):u.length<E?d=u:n(u,0)}else d?n(d,-1):(_=i[r],p[g++]=_,++C[_])}l.push(r)}return p[g++]=256,C[256]++,e.L=C,e.K=x,T?p.subarray(0,g):p}function h(t,e){function i(t){var e=E[t][S[t]];e===v?(i(t+1),i(t+1)):--C[e],++S[t]}var n,o,s,a,c,h=t.length,l=new r(572),u=new(T?Uint8Array:Array)(h);if(!T)for(a=0;a<h;a++)u[a]=0;for(a=0;a<h;++a)0<t[a]&&l.push(a,t[a]);if(n=Array(l.length/2),o=new(T?Uint32Array:Array)(l.length/2),1===n.length)return u[l.pop().index]=1,u;for(a=0,c=l.length/2;a<c;++a)n[a]=l.pop(),o[a]=n[a].value;var d,_,f,p,g,v=o.length,m=new(T?Uint16Array:Array)(e),y=new(T?Uint8Array:Array)(e),C=new(T?Uint8Array:Array)(v),x=Array(e),E=Array(e),S=Array(e),b=(1<<e)-v,A=1<<e-1;for(m[e-1]=v,_=0;_<e;++_)b<A?y[_]=0:(y[_]=1,b-=A),b<<=1,m[e-2-_]=(m[e-1-_]/2|0)+v;for(m[0]=y[0],x[0]=Array(m[0]),E[0]=Array(m[0]),_=1;_<e;++_)m[_]>2*m[_-1]+y[_]&&(m[_]=2*m[_-1]+y[_]),x[_]=Array(m[_]),E[_]=Array(m[_]);for(d=0;d<v;++d)C[d]=e;for(f=0;f<m[e-1];++f)x[e-1][f]=o[f],E[e-1][f]=f;for(d=0;d<e;++d)S[d]=0;for(1===y[e-1]&&(--C[0],++S[e-1]),_=e-2;0<=_;--_){for(p=d=0,g=S[_+1],f=0;f<m[_];f++)(p=x[_+1][g]+x[_+1][g+1])>o[d]?(x[_][f]=p,E[_][f]=v,g+=2):(x[_][f]=o[d],E[_][f]=d,++d);S[_]=0,1===y[_]&&i(_)}for(s=C,a=0,c=n.length;a<c;++a)u[n[a].index]=s[a];return u}function l(e){var i,n,r,o,s=new(T?Uint16Array:Array)(e.length),a=[],c=[],h=0;for(i=0,n=e.length;i<n;i++)a[e[i]]=1+(0|a[e[i]]);for(i=1,n=16;i<=n;i++)c[i]=h,(h+=0|a[i])>1<<i&&t("overcommitted"),h<<=1;for(65536>h&&t("undercommitted"),i=0,n=e.length;i<n;i++)for(h=c[e[i]],c[e[i]]+=1,r=s[i]=0,o=e[i];r<o;r++)s[i]=s[i]<<1|1&h,h>>>=1;return s}function u(t,e){this.input=t,this.a=new(T?Uint8Array:Array)(32768),this.h=M.j;var i,n={};!e&&(e={})||"number"!=typeof e.compressionType||(this.h=e.compressionType);for(i in e)n[i]=e[i];n.outputBuffer=this.a,this.z=new s(this.input,n)}function d(e,i){switch(this.k=[],this.l=32768,this.e=this.g=this.c=this.q=0,this.input=T?new Uint8Array(e):e,this.s=!1,this.m=z,this.B=!1,!i&&(i={})||(i.index&&(this.c=i.index),i.bufferSize&&(this.l=i.bufferSize),i.bufferType&&(this.m=i.bufferType),i.resize&&(this.B=i.resize)),this.m){case B:this.b=32768,this.a=new(T?Uint8Array:Array)(32768+this.l+258);break;case z:this.b=0,this.a=new(T?Uint8Array:Array)(this.l),this.f=this.J,this.t=this.H,this.o=this.I;break;default:t(Error("invalid inflate mode"))}}function _(e,i){for(var n,r=e.g,o=e.e,s=e.input,a=e.c;o<i;)(n=s[a++])===v&&t(Error("input buffer is broken")),r|=n<<o,o+=8;return n=r&(1<<i)-1,e.g=r>>>i,e.e=o-i,e.c=a,n}function f(e,i){for(var n,r,o,s=e.g,a=e.e,c=e.input,h=e.c,l=i[0],u=i[1];a<u;)(n=c[h++])===v&&t(Error("input buffer is broken")),s|=n<<a,a+=8;return r=l[s&(1<<u)-1],o=r>>>16,e.g=s>>o,e.e=a-o,e.c=h,65535&r}function p(t){function e(t,e,i){var n,r,o,s;for(s=0;s<t;)switch(n=f(this,e)){case 16:for(o=3+_(this,2);o--;)i[s++]=r;break;case 17:for(o=3+_(this,3);o--;)i[s++]=0;r=0;break;case 18:for(o=11+_(this,7);o--;)i[s++]=0;r=0;break;default:r=i[s++]=n}return i}var i,n,r,s,a=_(t,5)+257,c=_(t,5)+1,h=_(t,4)+4,l=new(T?Uint8Array:Array)(G.length);for(s=0;s<h;++s)l[G[s]]=_(t,3);i=o(l),n=new(T?Uint8Array:Array)(a),r=new(T?Uint8Array:Array)(c),t.o(o(e.call(t,a,i,n)),o(e.call(t,c,i,r)))}function g(e,i){var n,r;switch(this.input=e,this.c=0,!i&&(i={})||(i.index&&(this.c=i.index),i.verify&&(this.M=i.verify)),n=e[this.c++],r=e[this.c++],15&n){case pt:this.method=pt;break;default:t(Error("unsupported compression method"))}0!=((n<<8)+r)%31&&t(Error("invalid fcheck flag:"+((n<<8)+r)%31)),32&r&&t(Error("fdict flag is not supported")),this.A=new d(e,{index:this.c,bufferSize:i.bufferSize,bufferType:i.bufferType,resize:i.resize})}var v=void 0,m=!0,y=this,T="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array;n.prototype.f=function(){var t,e=this.buffer,i=e.length,n=new(T?Uint8Array:Array)(i<<1);if(T)n.set(e);else for(t=0;t<i;++t)n[t]=e[t];return this.buffer=n},n.prototype.d=function(t,e,i){var n,r=this.buffer,o=this.index,s=this.i,a=r[o];if(i&&1<e&&(t=8<e?(A[255&t]<<24|A[t>>>8&255]<<16|A[t>>>16&255]<<8|A[t>>>24&255])>>32-e:A[t]>>8-e),8>e+s)a=a<<e|t,s+=e;else for(n=0;n<e;++n)a=a<<1|t>>e-n-1&1,8==++s&&(s=0,r[o++]=A[a],a=0,o===r.length&&(r=this.f()));r[o]=a,this.buffer=r,this.i=s,this.index=o},n.prototype.finish=function(){var t,e=this.buffer,i=this.index;return 0<this.i&&(e[i]<<=8-this.i,e[i]=A[e[i]],i++),T?t=e.subarray(0,i):(e.length=i,t=e),t};var C,x=new(T?Uint8Array:Array)(256);for(C=0;256>C;++C){for(var E=b=C,S=7,b=b>>>1;b;b>>>=1)E<<=1,E|=1&b,--S;x[C]=(E<<S&255)>>>0}var A=x,R=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];T&&new Uint32Array(R),r.prototype.getParent=function(t){return 2*((t-2)/4|0)},r.prototype.push=function(t,e){var i,n,r,o=this.buffer;for(i=this.length,o[this.length++]=e,o[this.length++]=t;0<i&&(n=this.getParent(i),o[i]>o[n]);)r=o[i],o[i]=o[n],o[n]=r,r=o[i+1],o[i+1]=o[n+1],o[n+1]=r,i=n;return this.length},r.prototype.pop=function(){var t,e,i,n,r,o=this.buffer;for(e=o[0],t=o[1],this.length-=2,o[0]=o[this.length],o[1]=o[this.length+1],r=0;!((n=2*r+2)>=this.length)&&(n+2<this.length&&o[n+2]>o[n]&&(n+=2),o[n]>o[r]);)i=o[r],o[r]=o[n],o[n]=i,i=o[r+1],o[r+1]=o[n+1],o[n+1]=i,r=n;return{index:t,value:e,length:this.length}};var I,w=2,O={NONE:0,r:1,j:w,N:3},L=[];for(I=0;288>I;I++)switch(m){case 143>=I:L.push([I+48,8]);break;case 255>=I:L.push([I-144+400,9]);break;case 279>=I:L.push([I-256+0,7]);break;case 287>=I:L.push([I-280+192,8]);break;default:t("invalid literal: "+I)}s.prototype.n=function(){var e,i,r,o,s=this.input;switch(this.h){case 0:for(r=0,o=s.length;r<o;){var a=i=T?s.subarray(r,r+65535):s.slice(r,r+65535),u=(r+=i.length)===o,d=v,_=v,f=v,p=v,g=v,y=this.a,C=this.b;if(T){for(y=new Uint8Array(this.a.buffer);y.length<=C+a.length+5;)y=new Uint8Array(y.length<<1);y.set(this.a)}if(d=u?1:0,y[C++]=0|d,_=a.length,f=65536+~_&65535,y[C++]=255&_,y[C++]=_>>>8&255,y[C++]=255&f,y[C++]=f>>>8&255,T)y.set(a,C),C+=a.length,y=y.subarray(0,C);else{for(p=0,g=a.length;p<g;++p)y[C++]=a[p];y.length=C}this.b=C,this.a=y}break;case 1:var x=new n(new Uint8Array(this.a.buffer),this.b);x.d(1,1,m),x.d(1,2,m);var E,S,b,A=c(this,s);for(E=0,S=A.length;E<S;E++)if(b=A[E],n.prototype.d.apply(x,L[b]),256<b)x.d(A[++E],A[++E],m),x.d(A[++E],5),x.d(A[++E],A[++E],m);else if(256===b)break;this.a=x.finish(),this.b=this.a.length;break;case w:var R,I,O,P,D,N,F,M,B,z,V,W,U,k,G,H=new n(new Uint8Array(this.a),this.b),X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=Array(19);for(R=w,H.d(1,1,m),H.d(R,2,m),I=c(this,s),F=l(N=h(this.L,15)),B=l(M=h(this.K,7)),O=286;257<O&&0===N[O-1];O--);for(P=30;1<P&&0===M[P-1];P--);var j,q,Q,Z,K,J,$=O,tt=P,et=new(T?Uint32Array:Array)($+tt),it=new(T?Uint32Array:Array)(316),nt=new(T?Uint8Array:Array)(19);for(j=q=0;j<$;j++)et[q++]=N[j];for(j=0;j<tt;j++)et[q++]=M[j];if(!T)for(j=0,Z=nt.length;j<Z;++j)nt[j]=0;for(j=K=0,Z=et.length;j<Z;j+=q){for(q=1;j+q<Z&&et[j+q]===et[j];++q);if(Q=q,0===et[j])if(3>Q)for(;0<Q--;)it[K++]=0,nt[0]++;else for(;0<Q;)(J=138>Q?Q:138)>Q-3&&J<Q&&(J=Q-3),10>=J?(it[K++]=17,it[K++]=J-3,nt[17]++):(it[K++]=18,it[K++]=J-11,nt[18]++),Q-=J;else if(it[K++]=et[j],nt[et[j]]++,3>--Q)for(;0<Q--;)it[K++]=et[j],nt[et[j]]++;else for(;0<Q;)(J=6>Q?Q:6)>Q-3&&J<Q&&(J=Q-3),it[K++]=16,it[K++]=J-3,nt[16]++,Q-=J}for(e=T?it.subarray(0,K):it.slice(0,K),z=h(nt,7),k=0;19>k;k++)Y[k]=z[X[k]];for(D=19;4<D&&0===Y[D-1];D--);for(V=l(z),H.d(O-257,5,m),H.d(P-1,5,m),H.d(D-4,4,m),k=0;k<D;k++)H.d(Y[k],3,m);for(k=0,G=e.length;k<G;k++)if(W=e[k],H.d(V[W],z[W],m),16<=W){switch(k++,W){case 16:U=2;break;case 17:U=3;break;case 18:U=7;break;default:t("invalid code: "+W)}H.d(e[k],U,m)}var rt,ot,st,at,ct,ht,lt,ut,dt=[F,N],_t=[B,M];for(ct=dt[0],ht=dt[1],lt=_t[0],ut=_t[1],rt=0,ot=I.length;rt<ot;++rt)if(st=I[rt],H.d(ct[st],ht[st],m),256<st)H.d(I[++rt],I[++rt],m),at=I[++rt],H.d(lt[at],ut[at],m),H.d(I[++rt],I[++rt],m);else if(256===st)break;this.a=H.finish(),this.b=this.a.length;break;default:t("invalid compression type")}return this.a};var P,D,N=[];for(P=3;258>=P;P++)D=(function(){var e=P;switch(m){case 3===e:return[257,e-3,0];case 4===e:return[258,e-4,0];case 5===e:return[259,e-5,0];case 6===e:return[260,e-6,0];case 7===e:return[261,e-7,0];case 8===e:return[262,e-8,0];case 9===e:return[263,e-9,0];case 10===e:return[264,e-10,0];case 12>=e:return[265,e-11,1];case 14>=e:return[266,e-13,1];case 16>=e:return[267,e-15,1];case 18>=e:return[268,e-17,1];case 22>=e:return[269,e-19,2];case 26>=e:return[270,e-23,2];case 30>=e:return[271,e-27,2];case 34>=e:return[272,e-31,2];case 42>=e:return[273,e-35,3];case 50>=e:return[274,e-43,3];case 58>=e:return[275,e-51,3];case 66>=e:return[276,e-59,3];case 82>=e:return[277,e-67,4];case 98>=e:return[278,e-83,4];case 114>=e:return[279,e-99,4];case 130>=e:return[280,e-115,4];case 162>=e:return[281,e-131,5];case 194>=e:return[282,e-163,5];case 226>=e:return[283,e-195,5];case 257>=e:return[284,e-227,5];case 258===e:return[285,e-258,0];default:t("invalid length: "+e)}})(),N[P]=D[2]<<24|D[1]<<16|D[0];var F=T?new Uint32Array(N):N,M=O;u.prototype.n=function(){var e,n,r,o,s,a,c,h=0;switch(c=this.a,e=pt){case pt:n=Math.LOG2E*Math.log(32768)-8;break;default:t(Error("invalid compression method"))}switch(r=n<<4|e,c[h++]=r,e){case pt:switch(this.h){case M.NONE:s=0;break;case M.r:s=1;break;case M.j:s=2;break;default:t(Error("unsupported compression type"))}break;default:t(Error("invalid compression method"))}return o=s<<6|0,c[h++]=o|31-(256*r+o)%31,a=i(this.input),this.z.b=h,c=this.z.n(),h=c.length,T&&((c=new Uint8Array(c.buffer)).length<=h+4&&(this.a=new Uint8Array(c.length+4),this.a.set(c),c=this.a),c=c.subarray(0,h+4)),c[h++]=a>>24&255,c[h++]=a>>16&255,c[h++]=a>>8&255,c[h++]=255&a,c},e("Zlib.Deflate",u),e("Zlib.Deflate.compress",(function(t,e){return new u(t,e).n()})),e("Zlib.Deflate.CompressionType",M),e("Zlib.Deflate.CompressionType.NONE",M.NONE),e("Zlib.Deflate.CompressionType.FIXED",M.r),e("Zlib.Deflate.CompressionType.DYNAMIC",M.j);var B=0,z=1,V={D:B,C:z};d.prototype.p=function(){for(;!this.s;){var e=_(this,3);switch(1&e&&(this.s=m),e>>>=1){case 0:var i=this.input,n=this.c,r=this.a,o=this.b,s=v,a=v,c=v,h=r.length,l=v;switch(this.e=this.g=0,(s=i[n++])===v&&t(Error("invalid uncompressed block header: LEN (first byte)")),a=s,(s=i[n++])===v&&t(Error("invalid uncompressed block header: LEN (second byte)")),a|=s<<8,(s=i[n++])===v&&t(Error("invalid uncompressed block header: NLEN (first byte)")),c=s,(s=i[n++])===v&&t(Error("invalid uncompressed block header: NLEN (second byte)")),c|=s<<8,a===~c&&t(Error("invalid uncompressed block header: length verify")),n+a>i.length&&t(Error("input buffer is broken")),this.m){case B:for(;o+a>r.length;){if(l=h-o,a-=l,T)r.set(i.subarray(n,n+l),o),o+=l,n+=l;else for(;l--;)r[o++]=i[n++];this.b=o,r=this.f(),o=this.b}break;case z:for(;o+a>r.length;)r=this.f({v:2});break;default:t(Error("invalid inflate mode"))}if(T)r.set(i.subarray(n,n+a),o),o+=a,n+=a;else for(;a--;)r[o++]=i[n++];this.c=n,this.b=o,this.a=r;break;case 1:this.o(et,nt);break;case 2:p(this);break;default:t(Error("unknown BTYPE: "+e))}}return this.t()};var W,U,k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],G=T?new Uint16Array(k):k,H=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],X=T?new Uint16Array(H):H,Y=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],j=T?new Uint8Array(Y):Y,q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Q=T?new Uint16Array(q):q,Z=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],K=T?new Uint8Array(Z):Z,J=new(T?Uint8Array:Array)(288);for(W=0,U=J.length;W<U;++W)J[W]=143>=W?8:255>=W?9:279>=W?7:8;var $,tt,et=o(J),it=new(T?Uint8Array:Array)(30);for($=0,tt=it.length;$<tt;++$)it[$]=5;var nt=o(it);d.prototype.o=function(t,e){var i=this.a,n=this.b;this.u=t;for(var r,o,s,a,c=i.length-258;256!==(r=f(this,t));)if(256>r)n>=c&&(this.b=n,i=this.f(),n=this.b),i[n++]=r;else for(a=X[o=r-257],0<j[o]&&(a+=_(this,j[o])),r=f(this,e),s=Q[r],0<K[r]&&(s+=_(this,K[r])),n>=c&&(this.b=n,i=this.f(),n=this.b);a--;)i[n]=i[n++-s];for(;8<=this.e;)this.e-=8,this.c--;this.b=n},d.prototype.I=function(t,e){var i=this.a,n=this.b;this.u=t;for(var r,o,s,a,c=i.length;256!==(r=f(this,t));)if(256>r)n>=c&&(i=this.f(),c=i.length),i[n++]=r;else for(a=X[o=r-257],0<j[o]&&(a+=_(this,j[o])),r=f(this,e),s=Q[r],0<K[r]&&(s+=_(this,K[r])),n+a>c&&(i=this.f(),c=i.length);a--;)i[n]=i[n++-s];for(;8<=this.e;)this.e-=8,this.c--;this.b=n},d.prototype.f=function(){var t,e,i=new(T?Uint8Array:Array)(this.b-32768),n=this.b-32768,r=this.a;if(T)i.set(r.subarray(32768,i.length));else for(t=0,e=i.length;t<e;++t)i[t]=r[t+32768];if(this.k.push(i),this.q+=i.length,T)r.set(r.subarray(n,n+32768));else for(t=0;32768>t;++t)r[t]=r[n+t];return this.b=32768,r},d.prototype.J=function(t){var e,i,n,r,o=this.input.length/this.c+1|0,s=this.input,a=this.a;return t&&("number"==typeof t.v&&(o=t.v),"number"==typeof t.F&&(o+=t.F)),2>o?(i=(s.length-this.c)/this.u[2],r=i/2*258|0,n=r<a.length?a.length+r:a.length<<1):n=a.length*o,T?(e=new Uint8Array(n)).set(a):e=a,this.a=e},d.prototype.t=function(){var t,e,i,n,r,o=0,s=this.a,a=this.k,c=new(T?Uint8Array:Array)(this.q+(this.b-32768));if(0===a.length)return T?this.a.subarray(32768,this.b):this.a.slice(32768,this.b);for(e=0,i=a.length;e<i;++e)for(n=0,r=(t=a[e]).length;n<r;++n)c[o++]=t[n];for(e=32768,i=this.b;e<i;++e)c[o++]=s[e];return this.k=[],this.buffer=c},d.prototype.H=function(){var t,e=this.b;return T?this.B?(t=new Uint8Array(e)).set(this.a.subarray(0,e)):t=this.a.subarray(0,e):(this.a.length>e&&(this.a.length=e),t=this.a),this.buffer=t},g.prototype.p=function(){var e,n=this.input;return e=this.A.p(),this.c=this.A.c,this.M&&(n[this.c++]<<24|n[this.c++]<<16|n[this.c++]<<8|n[this.c++])>>>0!==i(e)&&t(Error("invalid adler-32 checksum")),e},e("Zlib.Inflate",g),e("Zlib.Inflate.BufferType",V),V.ADAPTIVE=V.C,V.BLOCK=V.D,e("Zlib.Inflate.prototype.decompress",g.prototype.p);var rt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];T&&new Uint16Array(rt);var ot=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258];T&&new Uint16Array(ot);var st=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0];T&&new Uint8Array(st);var at=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];T&&new Uint16Array(at);var ct=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];T&&new Uint8Array(ct);var ht,lt,ut=new(T?Uint8Array:Array)(288);for(ht=0,lt=ut.length;ht<lt;++ht)ut[ht]=143>=ht?8:255>=ht?9:279>=ht?7:8;o(ut);var dt,_t,ft=new(T?Uint8Array:Array)(30);for(dt=0,_t=ft.length;dt<_t;++dt)ft[dt]=5;o(ft);var pt=8}).call(window);var n=window.Zlib;n.Deflate=n.Deflate,n.Deflate.compress=n.Deflate.compress,n.Inflate=n.Inflate,n.Inflate.BufferType=n.Inflate.BufferType,n.Inflate.prototype.decompress=n.Inflate.prototype.decompress,e.exports=n}),{}],34:[(function(t,e,i){cc.configuration={ERROR:0,STRING:1,INT:2,DOUBLE:3,BOOLEAN:4,_maxTextureSize:0,_maxModelviewStackDepth:0,_supportsPVRTC:!1,_supportsNPOT:!1,_supportsBGRA8888:!1,_supportsDiscardFramebuffer:!1,_supportsShareableVAO:!1,_maxSamplesAllowed:0,_maxTextureUnits:0,_GlExtensions:"",_valueDict:{},_inited:!1,_init:function(){var t=this._valueDict;t["cocos2d.x.version"]=cc.ENGINE_VERSION,t["cocos2d.x.compiled_with_profiler"]=!1,t["cocos2d.x.compiled_with_gl_state_cache"]=cc.macro.ENABLE_GL_STATE_CACHE,this._inited=!0},getMaxTextureSize:function(){return this._maxTextureSize},getMaxModelviewStackDepth:function(){return this._maxModelviewStackDepth},getMaxTextureUnits:function(){return this._maxTextureUnits},supportsNPOT:function(){return this._supportsNPOT},supportsPVRTC:function(){return this._supportsPVRTC},supportsETC:function(){return!1},supportsS3TC:function(){return!1},supportsATITC:function(){return!1},supportsBGRA8888:function(){return this._supportsBGRA8888},supportsDiscardFramebuffer:function(){return this._supportsDiscardFramebuffer},supportsShareableVAO:function(){return this._supportsShareableVAO},checkForGLExtension:function(t){return this._GlExtensions.indexOf(t)>-1},getValue:function(t,e){this._inited||this._init();var i=this._valueDict;return i[t]?i[t]:e},setValue:function(t,e){this._valueDict[t]=e},gatherGPUInfo:function(){if(cc._renderType!==cc.game.RENDER_TYPE_CANVAS){this._inited||this._init();var t=cc._renderContext,e=this._valueDict;e["gl.vendor"]=t.getParameter(t.VENDOR),e["gl.renderer"]=t.getParameter(t.RENDERER),e["gl.version"]=t.getParameter(t.VERSION),this._GlExtensions="";for(var i=t.getSupportedExtensions(),n=0;n<i.length;n++)this._GlExtensions+=i[n]+" ";this._maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),e["gl.max_texture_size"]=this._maxTextureSize,this._maxTextureUnits=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),e["gl.max_texture_units"]=this._maxTextureUnits,this._supportsPVRTC=this.checkForGLExtension("GL_IMG_texture_compression_pvrtc"),e["gl.supports_PVRTC"]=this._supportsPVRTC,this._supportsNPOT=!1,e["gl.supports_NPOT"]=this._supportsNPOT,this._supportsBGRA8888=this.checkForGLExtension("GL_IMG_texture_format_BGRA888"),e["gl.supports_BGRA8888"]=this._supportsBGRA8888,this._supportsDiscardFramebuffer=this.checkForGLExtension("GL_EXT_discard_framebuffer"),e["gl.supports_discard_framebuffer"]=this._supportsDiscardFramebuffer,this._supportsShareableVAO=this.checkForGLExtension("vertex_array_object"),e["gl.supports_vertex_array_object"]=this._supportsShareableVAO,cc.checkGLErrorDebug()}},loadConfigFile:function(t){this._inited||this._init();var e=cc.loader.getRes(t);if(!e)throw new Error("Please load the resource first : "+t);cc.assertID(e,1101,t);var i=e.data;if(i)for(var n in i)this._valueDict[n]=i[n];else cc.logID(1100,t)}}}),{}],35:[(function(t,e,i){var n=t("./event/event-target"),r=t("./platform/_CCClass"),o=t("./load-pipeline/auto-release-utils"),s=t("./component-scheduler"),a=t("./node-activator"),c=t("./event/event-listeners");cc.g_NumberOfDraws=0,cc.Director=r.extend({ctor:function(){var t=this;n.call(t),t._landscape=!1,t._nextDeltaTimeZero=!1,t._paused=!1,t._purgeDirectorInNextLoop=!1,t._sendCleanupToScene=!1,t._animationInterval=0,t._oldAnimationInterval=0,t._projection=0,t._projectionDelegate=null,t._contentScaleFactor=1,t._winSizeInPoints=null,t._openGLView=null,t._scenesStack=null,t._nextScene=null,t._loadingScene="",t._runningScene=null,t._scene=null,t._totalFrames=0,t._lastUpdate=Date.now(),t._deltaTime=0,t._dirtyRegion=null,t._scheduler=null,t._compScheduler=null,t._nodeActivator=null,t._actionManager=null,cc.game.on(cc.game.EVENT_SHOW,(function(){t._lastUpdate=Date.now()}))},init:function(){return this._oldAnimationInterval=this._animationInterval=1/cc.defaultFPS,this._scenesStack=[],this._projection=cc.Director.PROJECTION_DEFAULT,this._projectionDelegate=null,this._totalFrames=0,this._lastUpdate=Date.now(),this._paused=!1,this._purgeDirectorInNextLoop=!1,this._winSizeInPoints=cc.size(0,0),this._openGLView=null,this._contentScaleFactor=1,this._scheduler=new cc.Scheduler,cc.ActionManager?(this._actionManager=new cc.ActionManager,this._scheduler.scheduleUpdate(this._actionManager,cc.Scheduler.PRIORITY_SYSTEM,!1)):this._actionManager=null,this.sharedInit(),!0},sharedInit:function(){this._compScheduler=new s,this._nodeActivator=new a,cc.AnimationManager?(this._animationManager=new cc.AnimationManager,this._scheduler.scheduleUpdate(this._animationManager,cc.Scheduler.PRIORITY_SYSTEM,!1)):this._animationManager=null,cc.CollisionManager?(this._collisionManager=new cc.CollisionManager,this._scheduler.scheduleUpdate(this._collisionManager,cc.Scheduler.PRIORITY_SYSTEM,!1)):this._collisionManager=null,cc.PhysicsManager?(this._physicsManager=new cc.PhysicsManager,this._scheduler.scheduleUpdate(this._physicsManager,cc.Scheduler.PRIORITY_SYSTEM,!1)):this._physicsManager=null,cc._widgetManager&&cc._widgetManager.init(this),cc.loader.init(this)},calculateDeltaTime:function(){var t=Date.now();this._nextDeltaTimeZero?(this._deltaTime=0,this._nextDeltaTimeZero=!1):(this._deltaTime=(t-this._lastUpdate)/1e3,cc.game.config[cc.game.CONFIG_KEY.debugMode]>0&&this._deltaTime>1&&(this._deltaTime=1/60)),this._lastUpdate=t},convertToGL:function(t){var e=cc.game.container,i=cc.view,n=e.getBoundingClientRect(),r=n.left+window.pageXOffset-e.clientLeft,o=n.top+window.pageYOffset-e.clientTop,s=i._devicePixelRatio*(t.x-r),a=i._devicePixelRatio*(o+n.height-t.y);return i._isRotated?{x:i._viewPortRect.width-a,y:s}:{x:s,y:a}},convertToUI:function(t){var e=cc.game.container,i=cc.view,n=e.getBoundingClientRect(),r=n.left+window.pageXOffset-e.clientLeft,o=n.top+window.pageYOffset-e.clientTop,s={x:0,y:0};return i._isRotated?(s.x=r+t.y/i._devicePixelRatio,s.y=o+n.height-(i._viewPortRect.width-t.x)/i._devicePixelRatio):(s.x=r+t.x*i._devicePixelRatio,s.y=o+n.height-t.y*i._devicePixelRatio),s},_visitScene:function(){if(this._runningScene){var t=cc.renderer;t.childrenOrderDirty?(t.clearRenderCommands(),cc.renderer.assignedZ=0,this._runningScene._renderCmd._curLevel=0,this._runningScene.visit(),t.resetFlag()):t.transformDirty()&&t.transform()}},end:function(){this._purgeDirectorInNextLoop=!0},getContentScaleFactor:function(){return this._contentScaleFactor},getWinSize:function(){return cc.size(this._winSizeInPoints)},getWinSizeInPixels:function(){return cc.size(this._winSizeInPoints.width*this._contentScaleFactor,this._winSizeInPoints.height*this._contentScaleFactor)},getVisibleSize:null,getVisibleOrigin:null,getZEye:null,pause:function(){this._paused||(this._oldAnimationInterval=this._animationInterval,this.setAnimationInterval(.25),this._paused=!0)},popScene:function(){cc.assertID(this._runningScene,1204),this._scenesStack.pop();var t=this._scenesStack.length;0===t?this.end():(this._sendCleanupToScene=!0,this._nextScene=this._scenesStack[t-1])},purgeCachedData:function(){cc.textureCache._clear(),cc.loader.releaseAll()},purgeDirector:function(){this.getScheduler().unscheduleAll(),this._compScheduler.unscheduleAll(),this._nodeActivator.reset(),cc.eventManager&&cc.eventManager.setEnabled(!1),this._runningScene&&(this._runningScene.performRecursive(_ccsg.Node.performType.onExitTransitionDidStart),this._runningScene.performRecursive(_ccsg.Node.performType.onExit),this._runningScene.performRecursive(_ccsg.Node.performType.cleanup),cc.renderer.clearRenderCommands()),this._runningScene=null,this._nextScene=null,this._scenesStack.length=0,this.stopAnimation(),this.purgeCachedData()},reset:function(){this.purgeDirector(),cc.eventManager&&cc.eventManager.setEnabled(!0),this._actionManager&&this._scheduler.scheduleUpdate(this._actionManager,cc.Scheduler.PRIORITY_SYSTEM,!1),this._animationManager&&this._scheduler.scheduleUpdate(this._animationManager,cc.Scheduler.PRIORITY_SYSTEM,!1),this._collisionManager&&this._scheduler.scheduleUpdate(this._collisionManager,cc.Scheduler.PRIORITY_SYSTEM,!1),this._physicsManager&&this._scheduler.scheduleUpdate(this._physicsManager,cc.Scheduler.PRIORITY_SYSTEM,!1),this.startAnimation()},pushScene:function(t){cc.assertID(t,1205),this._sendCleanupToScene=!1,this._scenesStack.push(t),this._nextScene=t},runSceneImmediate:function(t,e,i){t instanceof cc.Scene&&t._load();for(var n=cc.game,r=Object.keys(n._persistRootNodes).map((function(t){return n._persistRootNodes[t]})),s=0;s<r.length;s++){var a=r[s];n._ignoreRemovePersistNode=a,a.parent=null,n._ignoreRemovePersistNode=null}var c=this._scene,h=c&&c.autoReleaseAssets&&c.dependAssets;o.autoRelease(h,t.dependAssets,r),cc.isValid(c)&&c.destroy(),this._scene=null,cc.Object._deferredDestroy(),e&&e(),this.emit(cc.Director.EVENT_BEFORE_SCENE_LAUNCH,t);var l=t;if(t instanceof cc.Scene){this._scene=t,l=t._sgNode;for(var u=0;u<r.length;u++){var d=r[u],_=t.getChildByUuid(d.uuid);if(_){var f=_.getSiblingIndex();_._destroyImmediate(),t.insertChild(d,f)}else d.parent=t}t._activate()}if(this._runningScene){var p=this._scenesStack.length;this._scenesStack[Math.max(p-1,0)]=l,this._sendCleanupToScene=!0,this._nextScene=l}else this.pushScene(l),this.startAnimation();this._nextScene&&this.setNextScene(),i&&i(null,t),this.emit(cc.Director.EVENT_AFTER_SCENE_LAUNCH,t)},runScene:function(t,e,i){cc.assertID(t,1205),t instanceof cc.Scene&&t._load(),this.once(cc.Director.EVENT_AFTER_UPDATE,(function(){this.runSceneImmediate(t,e,i)}))},_getSceneUuid:function(t){var e=cc.game._sceneInfos;if("string"==typeof t){t.endsWith(".fire")||(t+=".fire"),"/"===t[0]||t.startsWith("db://assets/")||(t="/"+t);for(var i=0;i<e.length;i++){var n=e[i];if(n.url.endsWith(t))return n}}else if("number"==typeof t){if(0<=t&&t<e.length)return e[t];cc.errorID(1206,t)}else cc.errorID(1207,t);return null},loadScene:function(t,e,i){if(this._loadingScene)return cc.errorID(1208,t,this._loadingScene),!1;var n=this._getSceneUuid(t);if(n){var r=n.uuid;this.emit(cc.Director.EVENT_BEFORE_SCENE_LOADING,t),this._loadingScene=t;return this._loadSceneByUuid(r,e,i),!0}return cc.errorID(1209,t),!1},preloadScene:function(t,e){var i=this._getSceneUuid(t);if(i)this.emit(cc.Director.EVENT_BEFORE_SCENE_LOADING,t),cc.loader.load({uuid:i.uuid,type:"uuid"},(function(i,n){i&&cc.errorID(1210,t,i.message),e&&e(i,n)}));else{var n='Can not preload the scene "'+t+'" because it is not in the build settings.';e(new Error(n)),cc.error("preloadScene: "+n)}},_loadSceneByUuid:function(t,e,i,n){console.time("LoadScene "+t),cc.AssetLibrary.loadAsset(t,(function(n,r){console.timeEnd("LoadScene "+t);var o=cc.director;if(o._loadingScene="",n)n="Failed to load scene: "+n,cc.error(n);else{if(r instanceof cc.SceneAsset){var s=r.scene;return s._id=r._uuid,s._name=r._name,void o.runSceneImmediate(s,i,e)}n="The asset "+t+" is not a scene",cc.error(n)}e&&e(n)}))},resume:function(){this._paused&&(this.setAnimationInterval(this._oldAnimationInterval),this._lastUpdate=Date.now(),this._lastUpdate||cc.logID(1200),this._paused=!1,this._deltaTime=0)},setContentScaleFactor:function(t){t!==this._contentScaleFactor&&(this._contentScaleFactor=t)},setDepthTest:null,setClearColor:null,setDefaultValues:function(){},setNextDeltaTimeZero:function(t){this._nextDeltaTimeZero=t},setNextScene:function(){var t=!1,e=!1;if(cc.TransitionScene&&(t=!!this._runningScene&&this._runningScene instanceof cc.TransitionScene,e=!!this._nextScene&&this._nextScene instanceof cc.TransitionScene),!e){var i=this._runningScene;i&&(i.performRecursive(_ccsg.Node.performType.onExitTransitionDidStart),i.performRecursive(_ccsg.Node.performType.onExit)),this._sendCleanupToScene&&i&&i.performRecursive(_ccsg.Node.performType.cleanup)}this._runningScene=this._nextScene,cc.renderer.childrenOrderDirty=!0,this._nextScene=null,t||null===this._runningScene||(this._runningScene.performRecursive(_ccsg.Node.performType.onEnter),this._runningScene.performRecursive(_ccsg.Node.performType.onEnterTransitionDidFinish))},getDelegate:function(){return this._projectionDelegate},setDelegate:function(t){this._projectionDelegate=t},setOpenGLView:null,setProjection:null,setViewport:null,getOpenGLView:null,getProjection:null,setAlphaBlending:null,isSendCleanupToScene:function(){return this._sendCleanupToScene},getRunningScene:function(){return this._runningScene},getScene:function(){return this._scene},getAnimationInterval:function(){return this._animationInterval},isDisplayStats:function(){return!!cc.profiler&&cc.profiler.isShowingStats()},setDisplayStats:function(t){cc.profiler&&(t?cc.profiler.showStats():cc.profiler.hideStats(),cc.game.config[cc.game.CONFIG_KEY.showFPS]=!!t)},isNextDeltaTimeZero:function(){return this._nextDeltaTimeZero},isPaused:function(){return this._paused},getTotalFrames:function(){return this._totalFrames},popToRootScene:function(){this.popToSceneStackLevel(1)},popToSceneStackLevel:function(t){cc.assertID(this._runningScene,1203);var e=this._scenesStack,i=e.length;if(0!==i){if(!(t>i)){for(;i>t;){var n=e.pop();n.running&&(n.performRecursive(_ccsg.Node.performType.onExitTransitionDidStart),n.performRecursive(_ccsg.Node.performType.onExit)),n.performRecursive(_ccsg.Node.performType.cleanup),i--}this._nextScene=e[e.length-1],this._sendCleanupToScene=!0}}else this.end()},getScheduler:function(){return this._scheduler},setScheduler:function(t){this._scheduler!==t&&(this._scheduler=t)},getActionManager:function(){return this._actionManager},setActionManager:function(t){this._actionManager!==t&&(this._actionManager&&this._scheduler.unscheduleUpdate(this._actionManager),this._actionManager=t,this._scheduler.scheduleUpdate(this._actionManager,cc.Scheduler.PRIORITY_SYSTEM,!1))},getAnimationManager:function(){return this._animationManager},getCollisionManager:function(){return this._collisionManager},getPhysicsManager:function(){return this._physicsManager},getDeltaTime:function(){return this._deltaTime}}),cc.js.addon(cc.Director.prototype,n.prototype),cc.Director.EVENT_PROJECTION_CHANGED="director_projection_changed",cc.Director.EVENT_BEFORE_SCENE_LOADING="director_before_scene_loading",cc.Director.EVENT_BEFORE_SCENE_LAUNCH="director_before_scene_launch",cc.Director.EVENT_AFTER_SCENE_LAUNCH="director_after_scene_launch",cc.Director.EVENT_BEFORE_UPDATE="director_before_update",cc.Director.EVENT_AFTER_UPDATE="director_after_update",cc.Director.EVENT_BEFORE_VISIT="director_before_visit",cc.Director.EVENT_AFTER_VISIT="director_after_visit",cc.Director.EVENT_AFTER_DRAW="director_after_draw",cc.DisplayLinkDirector=cc.Director.extend({invalid:!1,startAnimation:function(){this._nextDeltaTimeZero=!0,this.invalid=!1},mainLoop:function(){this._purgeDirectorInNextLoop?(this._purgeDirectorInNextLoop=!1,this.purgeDirector()):this.invalid||(this.calculateDeltaTime(),this._paused||(this.emit(cc.Director.EVENT_BEFORE_UPDATE),this._compScheduler.startPhase(),this._compScheduler.updatePhase(this._deltaTime),this._scheduler.update(this._deltaTime),this._compScheduler.lateUpdatePhase(this._deltaTime),this.emit(cc.Director.EVENT_AFTER_UPDATE),cc.Object._deferredDestroy()),this._nextScene&&this.setNextScene(),this.emit(cc.Director.EVENT_BEFORE_VISIT),this._visitScene(),this.emit(cc.Director.EVENT_AFTER_VISIT),cc.g_NumberOfDraws=0,cc.renderer.clear(),cc.renderer.rendering(cc._renderContext),this._totalFrames++,this.emit(cc.Director.EVENT_AFTER_DRAW),cc.eventManager.frameUpdateListeners())},stopAnimation:function(){this.invalid=!0},setAnimationInterval:function(t){this._animationInterval=t,this.invalid||(this.stopAnimation(),this.startAnimation())},__fastOn:function(t,e,i){var n=this._bubblingListeners;n||(n=this._bubblingListeners=new c),n.add(t,e,i)},__fastOff:function(t,e,i){var n=this._bubblingListeners;n&&n.remove(t,e,i)}}),cc.Director.sharedDirector=null,cc.Director.firstUseDirector=!0,cc.Director._getInstance=function(){return cc.Director.firstUseDirector&&(cc.Director.firstUseDirector=!1,cc.Director.sharedDirector=new cc.DisplayLinkDirector,cc.Director.sharedDirector.init()),cc.Director.sharedDirector},cc.defaultFPS=60,cc.Director.PROJECTION_2D=0,cc.Director.PROJECTION_3D=1,cc.Director.PROJECTION_CUSTOM=3,cc.Director.PROJECTION_DEFAULT=cc.Director.PROJECTION_2D}),{"./component-scheduler":71,"./event/event-listeners":109,"./event/event-target":110,"./load-pipeline/auto-release-utils":131,"./node-activator":144,"./platform/_CCClass":158}],36:[(function(t,e,i){t("./CCDirector"),t("./CCGame"),cc.game.once(cc.game.EVENT_RENDERER_INITED,(function(){if(cc._renderType===cc.game.RENDER_TYPE_CANVAS){var t=cc.Director.prototype;t.getProjection=function(t){return this._projection},t.setProjection=function(t){this._projection=t,this.emit(cc.Director.EVENT_PROJECTION_CHANGED,this)},t.setDepthTest=function(){},t.setClearColor=function(t){cc.renderer._clearColor=t,cc.renderer._clearFillStyle="rgb("+t.r+","+t.g+","+t.b+")"},t.setOpenGLView=function(t){this._winSizeInPoints.width=cc._canvas.width,this._winSizeInPoints.height=cc._canvas.height,this._openGLView=t||cc.view,cc.eventManager&&cc.eventManager.setEnabled(!0)},t.getVisibleSize=function(){return this.getWinSize()},t.getVisibleOrigin=function(){return cc.p(0,0)}}}))}),{"./CCDirector":35,"./CCGame":40}],37:[(function(t,e,i){t("./CCDirector"),t("./CCGame"),t("../kazmath/index.js");var n=cc.math;cc.game.once(cc.game.EVENT_RENDERER_INITED,(function(){if(cc._renderType===cc.game.RENDER_TYPE_WEBGL){cc.DirectorDelegate=cc._Class.extend({updateProjection:function(){}});var t=cc.Director.prototype,e=function(t){if(t&&t._renderCmd){t._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty);var i,n=t._children;for(i=0;i<n.length;i++)e(n[i])}};cc.Director._getInstance().on(cc.Director.EVENT_PROJECTION_CHANGED,(function(){for(var t=cc.director._scenesStack,i=0;i<t.length;i++)e(t[i])})),t.setProjection=function(t){var e=this,i=e._winSizeInPoints;e.setViewport();var r=e._openGLView,o=r._viewPortRect.x/r._scaleX,s=r._viewPortRect.y/r._scaleY;switch(t){case cc.Director.PROJECTION_2D:n.glMatrixMode(n.KM_GL_PROJECTION),n.glLoadIdentity();var a=n.Matrix4.createOrthographicProjection(0,i.width,0,i.height,-1024,1024);n.glMultMatrix(a),n.glMatrixMode(n.KM_GL_MODELVIEW),n.glLoadIdentity();break;case cc.Director.PROJECTION_3D:var c=e.getZEye(),h=new n.Matrix4,l=new n.Matrix4;n.glMatrixMode(n.KM_GL_PROJECTION),n.glLoadIdentity(),h=n.Matrix4.createPerspectiveProjection(60,i.width/i.height,.1,2*c),n.glMultMatrix(h);var u=new n.Vec3(-o+i.width/2,-s+i.height/2,c),d=new n.Vec3(-o+i.width/2,-s+i.height/2,0),_=new n.Vec3(0,1,0);l.lookAt(u,d,_),n.glMultMatrix(l),n.glMatrixMode(n.KM_GL_MODELVIEW),n.glLoadIdentity();break;case cc.Director.PROJECTION_CUSTOM:e._projectionDelegate&&e._projectionDelegate.updateProjection();break;default:cc.logID(1201)}e._projection=t,e.emit(cc.Director.EVENT_PROJECTION_CHANGED,e),cc.gl.setProjectionMatrixDirty(),cc.renderer.childrenOrderDirty=!0},t.setDepthTest=function(t){cc.renderer.setDepthTest(t)},t.setClearColor=function(t){var e=cc.renderer._clearColor;e.r=t.r/255,e.g=t.g/255,e.b=t.b/255,e.a=t.a/255},t.setOpenGLView=function(t){var e=this;e._winSizeInPoints.width=cc._canvas.width,e._winSizeInPoints.height=cc._canvas.height,e._openGLView=t||cc.view,cc.configuration.gatherGPUInfo(),e.setGLDefaultValues(),cc.eventManager&&cc.eventManager.setEnabled(!0)},t.getVisibleSize=function(){return this._openGLView.getVisibleSize()},t.getVisibleOrigin=function(){return this._openGLView.getVisibleOrigin()},t.getZEye=function(){return this._winSizeInPoints.height/1.1566},t.setViewport=function(){var t=this._openGLView;if(t){var e=this._winSizeInPoints;t.setViewPortInPoints(-t._viewPortRect.x/t._scaleX,-t._viewPortRect.y/t._scaleY,e.width,e.height)}},t.getOpenGLView=function(){return this._openGLView},t.getProjection=function(){return this._projection},t.setAlphaBlending=function(t){t?cc.gl.blendFunc(cc.macro.BLEND_SRC,cc.macro.BLEND_DST):cc.gl.blendFunc(cc.macro.ONE,cc.macro.ZERO)},t.setGLDefaultValues=function(){var t=this;t.setAlphaBlending(!0),t.setProjection(t._projection),cc._renderContext.clearColor(0,0,0,0)}}}))}),{"../kazmath/index.js":215,"./CCDirector":35,"./CCGame":40}],38:[(function(t,e,i){cc.DrawingPrimitiveCanvas=cc._Class.extend({_cacheArray:[],ctor:function(t){this._renderContext=t},drawPoint:function(t,e){e||(e=1);var i=cc.view.getScaleX(),n=cc.view.getScaleY(),r=cc.p(t.x*i,t.y*n),o=this._renderContext.getContext();o.beginPath(),o.arc(r.x,-r.y,e*i,0,2*Math.PI,!1),o.closePath(),o.fill()},drawPoints:function(t,e,i){if(null!=t){i||(i=1);var n=this._renderContext.getContext(),r=cc.view.getScaleX(),o=cc.view.getScaleY();n.beginPath();for(var s=0,a=t.length;s<a;s++)n.arc(t[s].x*r,-t[s].y*o,i*r,0,2*Math.PI,!1);n.closePath(),n.fill()}},drawLine:function(t,e){var i=this._renderContext.getContext(),n=cc.view.getScaleX(),r=cc.view.getScaleY();i.beginPath(),i.moveTo(t.x*n,-t.y*r),i.lineTo(e.x*n,-e.y*r),i.closePath(),i.stroke()},drawRect:function(t,e){this.drawLine(cc.p(t.x,t.y),cc.p(e.x,t.y)),this.drawLine(cc.p(e.x,t.y),cc.p(e.x,e.y)),this.drawLine(cc.p(e.x,e.y),cc.p(t.x,e.y)),this.drawLine(cc.p(t.x,e.y),cc.p(t.x,t.y))},drawSolidRect:function(t,e,i){var n=[t,cc.p(e.x,t.y),e,cc.p(t.x,e.y)];this.drawSolidPoly(n,4,i)},drawPoly:function(t,e,i,n){if(n=n||!1,null!=t){if(t.length<3)throw new Error("Polygon's point must greater than 2");var r=t[0],o=this._renderContext.getContext(),s=cc.view.getScaleX(),a=cc.view.getScaleY();o.beginPath(),o.moveTo(r.x*s,-r.y*a);for(var c=1,h=t.length;c<h;c++)o.lineTo(t[c].x*s,-t[c].y*a);i&&o.closePath(),n?o.fill():o.stroke()}},drawSolidPoly:function(t,e,i){this.setDrawColor(i.r,i.g,i.b,i.a),this.drawPoly(t,e,!0,!0)},drawCircle:function(t,e,i,n,r){r=r||!1;var o=this._renderContext.getContext(),s=cc.view.getScaleX(),a=cc.view.getScaleY();o.beginPath();var c=i-2*Math.PI;o.arc(0|t.x*s,0|-t.y*a,e*s,-i,-c,!1),r&&o.lineTo(0|t.x*s,0|-t.y*a),o.stroke()},drawQuadBezier:function(t,e,i,n){var r=this._cacheArray;r.length=0;for(var o=0,s=0;s<n;s++){var a=Math.pow(1-o,2)*t.x+2*(1-o)*o*e.x+o*o*i.x,c=Math.pow(1-o,2)*t.y+2*(1-o)*o*e.y+o*o*i.y;r.push(cc.p(a,c)),o+=1/n}r.push(cc.p(i.x,i.y)),this.drawPoly(r,n+1,!1,!1)},drawCubicBezier:function(t,e,i,n,r){var o=this._cacheArray;o.length=0;for(var s=0,a=0;a<r;a++){var c=Math.pow(1-s,3)*t.x+3*Math.pow(1-s,2)*s*e.x+3*(1-s)*s*s*i.x+s*s*s*n.x,h=Math.pow(1-s,3)*t.y+3*Math.pow(1-s,2)*s*e.y+3*(1-s)*s*s*i.y+s*s*s*n.y;o.push(cc.p(c,h)),s+=1/r}o.push(cc.p(n.x,n.y)),this.drawPoly(o,r+1,!1,!1)},drawCatmullRom:function(t,e){this.drawCardinalSpline(t,.5,e)},drawCardinalSpline:function(t,e,i){cc._renderContext.setStrokeStyle("rgba(255,255,255,1)");var n=this._cacheArray;n.length=0;for(var r,o,s=1/t.length,a=0;a<i+1;a++){var c=a/i;1===c?(r=t.length-1,o=1):o=(c-s*(r=0|c/s))/s;var h=cc.cardinalSplineAt(cc.getControlPointAt(t,r-1),cc.getControlPointAt(t,r-0),cc.getControlPointAt(t,r+1),cc.getControlPointAt(t,r+2),e,o);n.push(h)}this.drawPoly(n,i+1,!1,!1)},drawImage:function(t,e,i,n,r){var o=arguments.length,s=this._renderContext.getContext();switch(o){case 2:var a=t.height;s.drawImage(t,e.x,-(e.y+a));break;case 3:s.drawImage(t,e.x,-(e.y+i.height),i.width,i.height);break;case 5:s.drawImage(t,e.x,e.y,i.width,i.height,n.x,-(n.y+r.height),r.width,r.height);break;default:throw new Error("Argument must be non-nil")}},drawStar:function(t,e,i){var n=t||this._renderContext,r=n.getContext();e*=cc.view.getScaleX();var o="rgba("+(0|i.r)+","+(0|i.g)+","+(0|i.b);n.setFillStyle(o+",1)");var s=e/10;r.beginPath(),r.moveTo(-e,e),r.lineTo(0,s),r.lineTo(e,e),r.lineTo(s,0),r.lineTo(e,-e),r.lineTo(0,-s),r.lineTo(-e,-e),r.lineTo(-s,0),r.lineTo(-e,e),r.closePath(),r.fill();var a=r.createRadialGradient(0,0,s,0,0,e);a.addColorStop(0,o+", 1)"),a.addColorStop(.3,o+", 0.8)"),a.addColorStop(1,o+", 0.0)"),n.setFillStyle(a),r.beginPath();var c=cc.macro.PI2;r.arc(0,0,e-s,0,c,!1),r.closePath(),r.fill()},drawColorBall:function(t,e,i){var n=t||this._renderContext,r=n.getContext();e*=cc.view.getScaleX();var o="rgba("+(0|i.r)+","+(0|i.g)+","+(0|i.b),s=e/10,a=r.createRadialGradient(0,0,s,0,0,e);a.addColorStop(0,o+", 1)"),a.addColorStop(.3,o+", 0.8)"),a.addColorStop(.6,o+", 0.4)"),a.addColorStop(1,o+", 0.0)"),n.setFillStyle(a),r.beginPath();var c=cc.macro.PI2;r.arc(0,0,e,0,c,!1),r.closePath(),r.fill()},fillText:function(t,e,i){this._renderContext.getContext().fillText(t,e,-i)},setDrawColor:function(t,e,i,n){this._renderContext.setFillStyle("rgba("+t+","+e+","+i+","+n/255+")"),this._renderContext.setStrokeStyle("rgba("+t+","+e+","+i+","+n/255+")")},setPointSize:function(t){},setLineWidth:function(t){this._renderContext.getContext().lineWidth=t*cc.view.getScaleX()}})}),{}],39:[(function(t,e,i){var n=cc.macro;cc.DrawingPrimitiveWebGL=cc._Class.extend({_initialized:!1,_shader:null,_colorLocation:"u_color",_pointSizeLocation:"u_pointSize",_pointSize:-1,ctor:function(t){if(null==t&&(t=cc._renderContext),!cc._isWechatGame()&&!t instanceof WebGLRenderingContext)throw new Error("Can't initialise DrawingPrimitiveWebGL. context need is WebGLRenderingContext");this._renderContext=t,this._colorArray=new Float32Array([1,1,1,1])},lazy_init:function(){var t=this;t._initialized||(t._shader=cc.shaderCache.programForKey(n.SHADER_POSITION_UCOLOR),t._shader._addUniformLocation(t._colorLocation),t._shader._addUniformLocation(t._pointSizeLocation),t._initialized=!0)},drawInit:function(){this._initialized=!1},drawPoint:function(t){this.lazy_init();var e=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),e.enableVertexAttribArray(n.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray),this._shader.setUniformLocationWith1f(this._pointSizeLocation,this._pointSize);var i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,new Float32Array([t.x,t.y]),e.STATIC_DRAW),e.vertexAttribPointer(n.VERTEX_ATTRIB_POSITION,2,e.FLOAT,!1,0,0),e.drawArrays(e.POINTS,0,1),e.deleteBuffer(i),cc.incrementGLDraws(1)},drawPoints:function(t,e){if(t&&0!==t.length){this.lazy_init();var i=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),i.enableVertexAttribArray(n.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray),this._shader.setUniformLocationWith1f(this._pointSizeLocation,this._pointSize);var r=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,r),i.bufferData(i.ARRAY_BUFFER,this._pointsToTypeArray(t),i.STATIC_DRAW),i.vertexAttribPointer(n.VERTEX_ATTRIB_POSITION,2,i.FLOAT,!1,0,0),i.drawArrays(i.POINTS,0,t.length),i.deleteBuffer(r),cc.incrementGLDraws(1)}},_pointsToTypeArray:function(t){for(var e=new Float32Array(2*t.length),i=0;i<t.length;i++)e[2*i]=t[i].x,e[2*i+1]=t[i].y;return e},drawLine:function(t,e){this.lazy_init();var i=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),i.enableVertexAttribArray(n.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var r=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,r),i.bufferData(i.ARRAY_BUFFER,this._pointsToTypeArray([t,e]),i.STATIC_DRAW),i.vertexAttribPointer(n.VERTEX_ATTRIB_POSITION,2,i.FLOAT,!1,0,0),i.drawArrays(i.LINES,0,2),i.deleteBuffer(r),cc.incrementGLDraws(1)},drawRect:function(t,e){this.drawLine(cc.p(t.x,t.y),cc.p(e.x,t.y)),this.drawLine(cc.p(e.x,t.y),cc.p(e.x,e.y)),this.drawLine(cc.p(e.x,e.y),cc.p(t.x,e.y)),this.drawLine(cc.p(t.x,e.y),cc.p(t.x,t.y))},drawSolidRect:function(t,e,i){var n=[t,cc.p(e.x,t.y),e,cc.p(t.x,e.y)];this.drawSolidPoly(n,4,i)},drawPoly:function(t,e,i){this.lazy_init();var r=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),r.enableVertexAttribArray(n.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var o=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,o),r.bufferData(r.ARRAY_BUFFER,this._pointsToTypeArray(t),r.STATIC_DRAW),r.vertexAttribPointer(n.VERTEX_ATTRIB_POSITION,2,r.FLOAT,!1,0,0),i?r.drawArrays(r.LINE_LOOP,0,t.length):r.drawArrays(r.LINE_STRIP,0,t.length),r.deleteBuffer(o),cc.incrementGLDraws(1)},drawSolidPoly:function(t,e,i){this.lazy_init(),i&&this.setDrawColor(i.r,i.g,i.b,i.a);var r=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),r.enableVertexAttribArray(n.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var o=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,o),r.bufferData(r.ARRAY_BUFFER,this._pointsToTypeArray(t),r.STATIC_DRAW),r.vertexAttribPointer(n.VERTEX_ATTRIB_POSITION,2,r.FLOAT,!1,0,0),r.drawArrays(r.TRIANGLE_FAN,0,t.length),r.deleteBuffer(o),cc.incrementGLDraws(1)},drawCircle:function(t,e,i,r,o){this.lazy_init();var s=1;o&&s++;var a=2*Math.PI/r,c=new Float32Array(2*(r+2));if(c){for(var h=0;h<=r;h++){var l=h*a,u=e*Math.cos(l+i)+t.x,d=e*Math.sin(l+i)+t.y;c[2*h]=u,c[2*h+1]=d}c[2*(r+1)]=t.x,c[2*(r+1)+1]=t.y;var _=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),_.enableVertexAttribArray(n.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var f=_.createBuffer();_.bindBuffer(_.ARRAY_BUFFER,f),_.bufferData(_.ARRAY_BUFFER,c,_.STATIC_DRAW),_.vertexAttribPointer(n.VERTEX_ATTRIB_POSITION,2,_.FLOAT,!1,0,0),_.drawArrays(_.LINE_STRIP,0,r+s),_.deleteBuffer(f),cc.incrementGLDraws(1)}},drawQuadBezier:function(t,e,i,r){this.lazy_init();for(var o=new Float32Array(2*(r+1)),s=0,a=0;a<r;a++)o[2*a]=Math.pow(1-s,2)*t.x+2*(1-s)*s*e.x+s*s*i.x,o[2*a+1]=Math.pow(1-s,2)*t.y+2*(1-s)*s*e.y+s*s*i.y,s+=1/r;o[2*r]=i.x,o[2*r+1]=i.y;var c=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),c.enableVertexAttribArray(n.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var h=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,h),c.bufferData(c.ARRAY_BUFFER,o,c.STATIC_DRAW),c.vertexAttribPointer(n.VERTEX_ATTRIB_POSITION,2,c.FLOAT,!1,0,0),c.drawArrays(c.LINE_STRIP,0,r+1),c.deleteBuffer(h),cc.incrementGLDraws(1)},drawCubicBezier:function(t,e,i,r,o){this.lazy_init();for(var s=new Float32Array(2*(o+1)),a=0,c=0;c<o;c++)s[2*c]=Math.pow(1-a,3)*t.x+3*Math.pow(1-a,2)*a*e.x+3*(1-a)*a*a*i.x+a*a*a*r.x,s[2*c+1]=Math.pow(1-a,3)*t.y+3*Math.pow(1-a,2)*a*e.y+3*(1-a)*a*a*i.y+a*a*a*r.y,a+=1/o;s[2*o]=r.x,s[2*o+1]=r.y;var h=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),h.enableVertexAttribArray(n.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var l=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,l),h.bufferData(h.ARRAY_BUFFER,s,h.STATIC_DRAW),h.vertexAttribPointer(n.VERTEX_ATTRIB_POSITION,2,h.FLOAT,!1,0,0),h.drawArrays(h.LINE_STRIP,0,o+1),h.deleteBuffer(l),cc.incrementGLDraws(1)},drawCatmullRom:function(t,e){this.drawCardinalSpline(t,.5,e)},drawCardinalSpline:function(t,e,i){this.lazy_init();for(var r,o,s=new Float32Array(2*(i+1)),a=1/t.length,c=0;c<i+1;c++){var h=c/i;1===h?(r=t.length-1,o=1):o=(h-a*(r=0|h/a))/a;var l=cc.cardinalSplineAt(cc.getControlPointAt(t,r-1),cc.getControlPointAt(t,r),cc.getControlPointAt(t,r+1),cc.getControlPointAt(t,r+2),e,o);s[2*c]=l.x,s[2*c+1]=l.y}var u=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),u.enableVertexAttribArray(n.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var d=u.createBuffer();u.bindBuffer(u.ARRAY_BUFFER,d),u.bufferData(u.ARRAY_BUFFER,s,u.STATIC_DRAW),u.vertexAttribPointer(n.VERTEX_ATTRIB_POSITION,2,u.FLOAT,!1,0,0),u.drawArrays(u.LINE_STRIP,0,i+1),u.deleteBuffer(d),cc.incrementGLDraws(1)},setDrawColor:function(t,e,i,n){this._colorArray[0]=t/255,this._colorArray[1]=e/255,this._colorArray[2]=i/255,this._colorArray[3]=n/255},setPointSize:function(t){this._pointSize=t},setLineWidth:function(t){this._renderContext.lineWidth&&this._renderContext.lineWidth(t)}})}),{}],40:[(function(t,e,i){var n,r=t("./event/event-target");n=t("./platform/CCView"),t("../audio/CCAudioEngine");var o=t("./platform/CCInputManager"),s={EVENT_HIDE:"game_on_hide",EVENT_SHOW:"game_on_show",EVENT_GAME_INITED:"game_inited",EVENT_RENDERER_INITED:"renderer_inited",RENDER_TYPE_CANVAS:0,RENDER_TYPE_WEBGL:1,RENDER_TYPE_OPENGL:2,_persistRootNodes:{},_ignoreRemovePersistNode:null,CONFIG_KEY:{width:"width",height:"height",debugMode:"debugMode",exposeClassName:"exposeClassName",showFPS:"showFPS",frameRate:"frameRate",id:"id",renderMode:"renderMode",registerSystemEvent:"registerSystemEvent",jsList:"jsList",scenes:"scenes"},_paused:!0,_configLoaded:!1,_isCloning:!1,_prepareCalled:!1,_prepared:!1,_rendererInitialized:!1,_renderContext:null,_intervalId:null,_lastTime:null,_frameTime:null,_sceneInfos:[],frame:null,container:null,canvas:null,config:null,onStart:null,setFrameRate:function(t){var e=this;e.config[e.CONFIG_KEY.frameRate]=t,e._intervalId&&window.cancelAnimFrame(e._intervalId),e._intervalId=0,e._paused=!0,e._setAnimFrame(),e._runMainLoop()},step:function(){cc.director.mainLoop()},pause:function(){this._paused||(this._paused=!0,cc.audioEngine&&cc.audioEngine._break(),this._intervalId&&window.cancelAnimFrame(this._intervalId),this._intervalId=0)},resume:function(){this._paused&&(this._paused=!1,cc.audioEngine&&cc.audioEngine._restore(),this._runMainLoop())},isPaused:function(){return this._paused},restart:function(){cc.director.once(cc.Director.EVENT_AFTER_DRAW,(function(){cc.director.getScene().destroy(),cc.Object._deferredDestroy(),cc.director.purgeDirector(),cc.audioEngine&&cc.audioEngine.uncacheAll(),cc.director.reset(),s.onStart()}))},end:function(){close()},prepare:function(t){var e=this,i=e.config,r=e.CONFIG_KEY;if(this._configLoaded){if(this._prepared)t&&t();else if(!this._prepareCalled)if(cc._engineLoaded){this._prepareCalled=!0,this._initRenderer(i[r.width],i[r.height]),cc.view=n?n._getInstance():null,cc.director=cc.Director._getInstance(),cc.director.setOpenGLView&&cc.director.setOpenGLView(cc.view),cc.winSize=cc.director.getWinSize(),this._initEvents(),this._setAnimFrame(),this._runMainLoop();var o=i[r.jsList];o&&o.length>0?cc.loader.load(o,(function(i){if(i)throw new Error(JSON.stringify(i));e._prepared=!0,t&&t(),e.emit(e.EVENT_GAME_INITED)})):(t&&t(),e.emit(e.EVENT_GAME_INITED))}else cc.initEngine(this.config,(function(){e.prepare(t)}))}else this._loadConfig((function(){e.prepare(t)}))},run:function(t,e){"function"==typeof t?s.onStart=t:(t&&(s.config=t),"function"==typeof e&&(s.onStart=e)),this.prepare(s.onStart&&s.onStart.bind(s))},addPersistRootNode:function(t){if(cc.Node.isNode(t)&&t.uuid){var e=t.uuid;if(!this._persistRootNodes[e]){var i=cc.director._scene;if(cc.isValid(i)){if(t.parent){if(!(t.parent instanceof cc.Scene))return void cc.warnID(3801);if(t.parent!==i)return void cc.warnID(3802)}else t.parent=i;this._persistRootNodes[e]=t,t._persistNode=!0}}}else cc.warnID(3800)},removePersistRootNode:function(t){if(t!==this._ignoreRemovePersistNode){var e=t.uuid||"";t===this._persistRootNodes[e]&&(delete this._persistRootNodes[e],t._persistNode=!1)}},isPersistRootNode:function(t){return t._persistNode},_setAnimFrame:function(){this._lastTime=new Date;var t=s.config[s.CONFIG_KEY.frameRate];this._frameTime=1e3/t,60!==t&&30!==t?(window.requestAnimFrame=this._stTime,window.cancelAnimFrame=this._ctTime):(window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||this._stTime,window.cancelAnimFrame=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.oCancelAnimationFrame||this._ctTime)},_stTime:function(t){var e=(new Date).getTime(),i=Math.max(0,s._frameTime-(e-s._lastTime)),n=window.setTimeout((function(){t()}),i);return s._lastTime=e+i,n},_ctTime:function(t){window.clearTimeout(t)},_runMainLoop:function(){var t,e=this,i=e.config,n=e.CONFIG_KEY,r=cc.director,o=!0,s=i[n.frameRate];r.setDisplayStats(i[n.showFPS]),t=function(){if(!e._paused){if(30===s&&(o=!o))return void(e._intervalId=window.requestAnimFrame(t));r.mainLoop(),e._intervalId=window.requestAnimFrame(t)}},e._intervalId=window.requestAnimFrame(t),e._paused=!1},_loadConfig:function(t){if(this.config)return this._initConfig(this.config),void(t&&t());if(document.ccConfig)return this._initConfig(document.ccConfig),void(t&&t());var e=this;cc.loader.load("project.json",(function(i,n){i&&cc.logID(3818),e._initConfig(n||{}),t&&t()}))},_initConfig:function(t){var e=this.CONFIG_KEY;"number"!=typeof t[e.debugMode]&&(t[e.debugMode]=0),t[e.exposeClassName]=!!t[e.exposeClassName],"number"!=typeof t[e.frameRate]&&(t[e.frameRate]=60),"number"!=typeof t[e.renderMode]&&(t[e.renderMode]=0),"boolean"!=typeof t[e.registerSystemEvent]&&(t[e.registerSystemEvent]=!0),t[e.showFPS]=!(e.showFPS in t)||!!t[e.showFPS],this._sceneInfos=t[e.scenes]||[],this.collisionMatrix=t.collisionMatrix||[],this.groupList=t.groupList||[],cc._initDebugSetting(t[e.debugMode]),this.config=t,this._configLoaded=!0},_initRenderer:function(t,e){if(!this._rendererInitialized){if(!cc._supportRender)throw new Error("The renderer doesn't support the renderMode "+this.config[this.CONFIG_KEY.renderMode]);var i,n,r=this.config[s.CONFIG_KEY.id],o=window,a=r instanceof HTMLElement?r:document.querySelector(r)||document.querySelector("#"+r);cc._isWechatGame()?(this.container=cc.container=n=document.createElement("DIV"),this.frame=n.parentNode===document.body?document.documentElement:n.parentNode,this.canvas=cc._canvas=i=window.canvas):"CANVAS"===a.tagName?(t=t||a.width,e=e||a.height,this.canvas=cc._canvas=i=a,this.container=cc.container=n=document.createElement("DIV"),i.parentNode&&i.parentNode.insertBefore(n,i)):("DIV"!==a.tagName&&cc.warnID(3819),t=t||a.clientWidth,e=e||a.clientHeight,this.canvas=cc._canvas=i=document.createElement("CANVAS"),this.container=cc.container=n=document.createElement("DIV"),a.appendChild(n)),cc._renderType===s.RENDER_TYPE_WEBGL&&(cc._isWechatGame()?this._renderContext=cc._renderContext=cc.webglContext=cc.create3DContext(i,{stencil:!0,alpha:!0,antialias:cc.sys.isMobile,preserveDrawingBuffer:!0}):this._renderContext=cc._renderContext=cc.webglContext=cc.create3DContext(i,{stencil:!0,alpha:!0,antialias:cc.sys.isMobile})),this._renderContext?(cc.renderer=cc.rendererWebGL,o.gl=this._renderContext,cc.renderer.init(),cc._drawingUtil=new cc.DrawingPrimitiveWebGL(this._renderContext),cc.textureCache._initializingRenderer(),cc.glExt={},cc.glExt.instanced_arrays=o.gl.getExtension("ANGLE_instanced_arrays"),cc.glExt.element_uint=o.gl.getExtension("OES_element_index_uint")):(cc._renderType=s.RENDER_TYPE_CANVAS,cc.renderer=cc.rendererCanvas,cc.renderer.init(),this._renderContext=cc._renderContext=new cc.CanvasContextWrapper(i.getContext("2d")),cc._drawingUtil=cc.DrawingPrimitiveCanvas?new cc.DrawingPrimitiveCanvas(this._renderContext):null),cc._gameDiv=n,s.canvas.oncontextmenu=function(){if(!cc._isContextMenuEnable)return!1},this.emit(this.EVENT_RENDERER_INITED,!0),this._rendererInitialized=!0}},_initEvents:function(){var t,e=window;this.config[this.CONFIG_KEY.registerSystemEvent]&&o.registerSystemEvent(this.canvas),void 0!==document.hidden?t="hidden":void 0!==document.mozHidden?t="mozHidden":void 0!==document.msHidden?t="msHidden":void 0!==document.webkitHidden&&(t="webkitHidden");var i=["visibilitychange","mozvisibilitychange","msvisibilitychange","webkitvisibilitychange","qbrowserVisibilityChange"],n=function(){s.emit(s.EVENT_HIDE,s)},r=function(){s.emit(s.EVENT_SHOW,s)};if(t)for(var a=0;a<i.length;a++)document.addEventListener(i[a],(function(e){var i=document[t];(i=i||e.hidden)?n():r()}),!1);else e.addEventListener("blur",n,!1),e.addEventListener("focus",r,!1);navigator.userAgent.indexOf("MicroMessenger")>-1&&(e.onfocus=function(){r()}),"onpageshow"in window&&"onpagehide"in window&&(e.addEventListener("pagehide",n,!1),e.addEventListener("pageshow",r,!1)),this.on(s.EVENT_HIDE,(function(){s.pause()})),this.on(s.EVENT_SHOW,(function(){s.resume()}))}};r.call(s),cc.js.addon(s,r.prototype),cc.game=e.exports=s}),{"../audio/CCAudioEngine":25,"./event/event-target":110,"./platform/CCInputManager":150,"./platform/CCView":156}],41:[(function(t,e,i){"use strict";function n(t){var e=cc.Mask;if(e)for(var i=0,n=t;n&&cc.Node.isNode(n);n=n._parent,++i)if(n.getComponent(e))return{index:i,node:n};return null}function r(t){t._parent._delaySort(),cc.eventManager._setDirtyForNode(t)}var o=t("./utils/prefab-helper"),s=t("./utils/scene-graph-helper"),a=cc.Object.Flags.Destroying,c=t("./utils/misc"),h=(t("./event/event"),!!cc.ActionManager),l=function(){},u=cc.Enum({TOUCH_START:"touchstart",TOUCH_MOVE:"touchmove",TOUCH_END:"touchend",TOUCH_CANCEL:"touchcancel",MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_UP:"mouseup",MOUSE_WHEEL:"mousewheel"}),d=[u.TOUCH_START,u.TOUCH_MOVE,u.TOUCH_END,u.TOUCH_CANCEL],_=[u.MOUSE_DOWN,u.MOUSE_ENTER,u.MOUSE_MOVE,u.MOUSE_LEAVE,u.MOUSE_UP,u.MOUSE_WHEEL],f=null,p=function(t,e){var i=t.getLocation(),n=this.owner;return!!n._hitTest(i,this)&&(e.type=u.TOUCH_START,e.touch=t,e.bubbles=!0,n.dispatchEvent(e),!0)},g=function(t,e){var i=this.owner;e.type=u.TOUCH_MOVE,e.touch=t,e.bubbles=!0,i.dispatchEvent(e)},v=function(t,e){var i=t.getLocation(),n=this.owner;n._hitTest(i,this)?e.type=u.TOUCH_END:e.type=u.TOUCH_CANCEL,e.touch=t,e.bubbles=!0,n.dispatchEvent(e)},m=function(t){var e=t.getLocation(),i=this.owner;i._hitTest(e,this)&&(t.stopPropagation(),t.type=u.MOUSE_DOWN,i.dispatchEvent(t))},y=function(t){var e=t.getLocation(),i=this.owner;i._hitTest(e,this)?(t.stopPropagation(),this._previousIn||(f&&(t.type=u.MOUSE_LEAVE,f.dispatchEvent(t),f._mouseListener._previousIn=!1),f=this.owner,t.type=u.MOUSE_ENTER,i.dispatchEvent(t),this._previousIn=!0),t.type=u.MOUSE_MOVE,i.dispatchEvent(t)):this._previousIn&&(t.type=u.MOUSE_LEAVE,i.dispatchEvent(t),this._previousIn=!1,f=null)},T=function(t){var e=t.getLocation(),i=this.owner;i._hitTest(e,this)&&(t.stopPropagation(),t.type=u.MOUSE_UP,i.dispatchEvent(t))},C=function(t){var e=t.getLocation(),i=this.owner;i._hitTest(e,this)&&(t.type=u.MOUSE_WHEEL,i.dispatchEvent(t))},x=cc.Class({name:"cc.Node",extends:t("./utils/base-node"),properties:{_opacity:255,_color:cc.Color.WHITE,_cascadeOpacityEnabled:!0,_anchorPoint:cc.p(.5,.5),_contentSize:cc.size(0,0),_rotationX:0,_rotationY:0,_scaleX:1,_scaleY:1,_position:cc.p(0,0),_skewX:0,_skewY:0,_localZOrder:0,_globalZOrder:0,_opacityModifyRGB:!1,groupIndex:{default:0,type:cc.Integer},group:{get:function(){return cc.game.groupList[this.groupIndex]||""},set:function(t){this.groupIndex=cc.game.groupList.indexOf(t),this.emit("group-changed")}},x:{get:function(){return this._position.x},set:function(t){var e=this._position;if(t!==e.x){e.x=t,this._sgNode.setPositionX(t);var i=this._hasListenerCache;i&&i["position-changed"]&&this.emit("position-changed")}}},y:{get:function(){return this._position.y},set:function(t){var e=this._position;if(t!==e.y){e.y=t,this._sgNode.setPositionY(t);var i=this._hasListenerCache;i&&i["position-changed"]&&this.emit("position-changed")}}},rotation:{get:function(){return this._rotationX!==this._rotationY&&cc.logID(1602),this._rotationX},set:function(t){if(this._rotationX!==t||this._rotationY!==t){this._rotationX=this._rotationY=t,this._sgNode.rotation=t;var e=this._hasListenerCache;e&&e["rotation-changed"]&&this.emit("rotation-changed")}}},rotationX:{get:function(){return this._rotationX},set:function(t){if(this._rotationX!==t){this._rotationX=t,this._sgNode.rotationX=t;var e=this._hasListenerCache;e&&e["rotation-changed"]&&this.emit("rotation-changed")}}},rotationY:{get:function(){return this._rotationY},set:function(t){if(this._rotationY!==t){this._rotationY=t,this._sgNode.rotationY=t;var e=this._hasListenerCache;e&&e["rotation-changed"]&&this.emit("rotation-changed")}}},scaleX:{get:function(){return this._scaleX},set:function(t){if(this._scaleX!==t){this._scaleX=t,this._sgNode.scaleX=t;var e=this._hasListenerCache;e&&e["scale-changed"]&&this.emit("scale-changed")}}},scaleY:{get:function(){return this._scaleY},set:function(t){if(this._scaleY!==t){this._scaleY=t,this._sgNode.scaleY=t;var e=this._hasListenerCache;e&&e["scale-changed"]&&this.emit("scale-changed")}}},skewX:{get:function(){return this._skewX},set:function(t){this._skewX=t,this._sgNode.skewX=t}},skewY:{get:function(){return this._skewY},set:function(t){this._skewY=t,this._sgNode.skewY=t}},opacity:{get:function(){return this._opacity},set:function(t){if(this._opacity!==t&&(this._opacity=t,this._sgNode.setOpacity(t),!this._cascadeOpacityEnabled)){var e=this._sizeProvider;e instanceof _ccsg.Node&&e!==this._sgNode&&e.setOpacity(t)}},range:[0,255]},cascadeOpacity:{get:function(){return this._cascadeOpacityEnabled},set:function(t){if(this._cascadeOpacityEnabled!==t){this._cascadeOpacityEnabled=t,this._sgNode.cascadeOpacity=t;var e=t?255:this._opacity,i=this._sizeProvider;i instanceof _ccsg.Node&&i.setOpacity(e)}}},color:{get:function(){return this._color.clone()},set:function(t){this._color.equals(t)||(this._color.fromColor(t),this._sizeProvider instanceof _ccsg.Node&&this._sizeProvider.setColor(t))}},anchorX:{get:function(){return this._anchorPoint.x},set:function(t){var e=this._anchorPoint;if(e.x!==t){e.x=t;var i=this._sizeProvider;i instanceof _ccsg.Node&&i.setAnchorPoint(e),this.emit("anchor-changed")}}},anchorY:{get:function(){return this._anchorPoint.y},set:function(t){var e=this._anchorPoint;if(e.y!==t){e.y=t;var i=this._sizeProvider;i instanceof _ccsg.Node&&i.setAnchorPoint(e),this.emit("anchor-changed")}}},width:{get:function(){if(this._sizeProvider){var t=this._sizeProvider._getWidth();return this._contentSize.width=t,t}return this._contentSize.width},set:function(t){if(t!==this._contentSize.width){var e=this._sizeProvider;e&&e.setContentSize(t,e._getHeight());this._contentSize.width=t,this.emit("size-changed")}}},height:{get:function(){if(this._sizeProvider){var t=this._sizeProvider._getHeight();return this._contentSize.height=t,t}return this._contentSize.height},set:function(t){if(t!==this._contentSize.height){var e=this._sizeProvider;e&&e.setContentSize(e._getWidth(),t);this._contentSize.height=t,this.emit("size-changed")}}},zIndex:{get:function(){return this._localZOrder},set:function(t){this._localZOrder!==t&&(this._localZOrder=t,this._sgNode.zIndex=t,this._parent&&r(this))}}},ctor:function(t){var e=this._sgNode=new _ccsg.Node;cc.game._isCloning||(e.cascadeOpacity=!0),this._sizeProvider=null,this._reorderChildDirty=!1,this._widget=null,this._touchListener=null,this._mouseListener=null},statics:{isNode:function(t){return t instanceof x&&(t.constructor===x||!(t instanceof cc.Scene))}},_onSetParent:function(t){var e=this._sgNode;e.parent&&e.parent.removeChild(e,!1),t&&(t._sgNode.addChild(e),t._delaySort())},_onSiblingIndexChanged:function(t){for(var e,i=this._parent,n=i._children,r=0,o=n.length;r<o;r++)(e=n[r]._sgNode)._arrivalOrder=r,cc.eventManager._setDirtyForNode(e);cc.renderer.childrenOrderDirty=!0,i._sgNode._reorderChildDirty=!0,i._delaySort()},_onPreDestroy:function(){var t=this._onPreDestroyBase();h&&cc.director.getActionManager().removeAllActionsFromTarget(this),f===this&&(f=null),this._reorderChildDirty&&cc.director.__fastOff(cc.Director.EVENT_AFTER_UPDATE,this.sortAllChildren,this),cc.eventManager.removeListeners(this),t||this._removeSgNode()},_onPostActivated:function(t){var e=h?cc.director.getActionManager():null;if(t)if(e&&e.resumeTarget(this),cc.eventManager.resumeTarget(this),this._touchListener){var i=this._touchListener.mask=n(this);this._mouseListener&&(this._mouseListener.mask=i)}else this._mouseListener&&(this._mouseListener.mask=n(this));else e&&e.pauseTarget(this),cc.eventManager.pauseTarget(this)},_onHierarchyChanged:function(t){this._onHierarchyChangedBase(t),cc._widgetManager._nodesOrderDirty=!0},_onBatchCreated:function(){var t=this._prefab;t&&t.sync&&!t._synced&&t.root===this&&o.syncWithPrefab(this),this._updateDummySgNode(),this._parent&&this._parent._sgNode.addChild(this._sgNode),this._activeInHierarchy||(h&&cc.director.getActionManager().pauseTarget(this),cc.eventManager.pauseTarget(this));for(var e=this._children,i=0,n=e.length;i<n;i++)e[i]._onBatchCreated()},on:function(t,e,i,r){var o=!1;return-1!==d.indexOf(t)?this._touchListener||(this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,owner:this,mask:n(this),onTouchBegan:p,onTouchMoved:g,onTouchEnded:v}),cc.eventManager.addListener(this._touchListener,this),o=!0):-1!==_.indexOf(t)&&(this._mouseListener||(this._mouseListener=cc.EventListener.create({event:cc.EventListener.MOUSE,_previousIn:!1,owner:this,mask:n(this),onMouseDown:m,onMouseMove:y,onMouseUp:T,onMouseScroll:C}),cc.eventManager.addListener(this._mouseListener,this),o=!0)),o&&!this._activeInHierarchy&&cc.director.getScheduler().schedule((function(){this._activeInHierarchy||cc.eventManager.pauseTarget(this)}),this,0,0,0,!1),this._EventTargetOn(t,e,i,r)},off:function(t,e,i,n){this._EventTargetOff(t,e,i,n),-1!==d.indexOf(t)?this._checkTouchListeners():-1!==_.indexOf(t)&&this._checkMouseListeners()},targetOff:function(t){this._EventTargetTargetOff(t),this._checkTouchListeners(),this._checkMouseListeners()},pauseSystemEvents:function(t){cc.eventManager.pauseTarget(this,t)},resumeSystemEvents:function(t){cc.eventManager.resumeTarget(this,t)},_checkTouchListeners:function(){if(!(this._objFlags&a)&&this._touchListener){var t=0;if(this._bubblingListeners)for(;t<d.length;++t)if(this._bubblingListeners.has(d[t]))return;if(this._capturingListeners)for(;t<d.length;++t)if(this._capturingListeners.has(d[t]))return;cc.eventManager.removeListener(this._touchListener),this._touchListener=null}},_checkMouseListeners:function(){if(!(this._objFlags&a)&&this._mouseListener){var t=0;if(this._bubblingListeners)for(;t<_.length;++t)if(this._bubblingListeners.has(_[t]))return;if(this._capturingListeners)for(;t<_.length;++t)if(this._capturingListeners.has(_[t]))return;f===this&&(f=null),cc.eventManager.removeListener(this._mouseListener),this._mouseListener=null}},_hitTest:function(t,e){var i,n=this.width,r=this.height,o=cc.rect(0,0,n,r);i=cc.Camera&&cc.Camera.main?cc.Camera.main.getNodeToCameraTransform(this):this.getNodeToWorldTransform(),cc._rectApplyAffineTransformIn(o,i);var s=t.x-o.x,a=o.x+o.width-t.x,c=t.y-o.y,h=o.y+o.height-t.y;if(s>=0&&a>=0&&h>=0&&c>=0){if(e&&e.mask){for(var l=e.mask,u=this,d=0;u&&d<l.index;++d,u=u.parent);if(u===l.node){var _=u.getComponent(cc.Mask);return!_||!_.enabledInHierarchy||_._hitTest(t)}return e.mask=null,!0}return!0}return!1},_getCapturingTargets:function(t,e){for(var i=this.parent;i;)i.hasEventListener(t,!0)&&e.push(i),i=i.parent},_getBubblingTargets:function(t,e){for(var i=this.parent;i;)i.hasEventListener(t)&&e.push(i),i=i.parent},isRunning:function(){return this._activeInHierarchy},runAction:h?function(t){if(this.active)return cc.assertID(t,1618),cc.macro.ENABLE_GC_FOR_NATIVE_OBJECTS||this._retainAction(t),cc.director.getActionManager().addAction(t,this,!1),t}:l,pauseAllActions:h?function(){cc.director.getActionManager().pauseTarget(this)}:l,resumeAllActions:h?function(){cc.director.getActionManager().resumeTarget(this)}:l,stopAllActions:h?function(){cc.director.getActionManager().removeAllActionsFromTarget(this)}:l,stopAction:h?function(t){cc.director.getActionManager().removeAction(t)}:l,stopActionByTag:h?function(t){t!==cc.Action.TAG_INVALID?cc.director.getActionManager().removeActionByTag(t,this):cc.logID(1612)}:l,getActionByTag:h?function(t){return t===cc.Action.TAG_INVALID?(cc.logID(1613),null):cc.director.getActionManager().getActionByTag(t,this)}:function(){return null},getNumberOfRunningActions:h?function(){return cc.director.getActionManager().getNumberOfRunningActionsInTarget(this)}:function(){return 0},_retainAction:function(t){},_releaseAllActions:function(){},setTag:function(t){this._tag=t,this._sgNode.tag=t},getPosition:function(){return new cc.Vec2(this._position)},setPosition:function(t,e){var i;void 0===e?(i=t.x,e=t.y):i=t;var n=this._position;if(n.x!==i||n.y!==e){n.x=i,n.y=e,this._sgNode.setPosition(i,e);var r=this._hasListenerCache;r&&r["position-changed"]&&this.emit("position-changed")}},getScale:function(){return this._scaleX!==this._scaleY&&cc.logID(1603),this._scaleX},setScale:function(t,e){if("object"==typeof t?(e=t.y,t=t.x):e=e||0===e?e:t,this._scaleX!==t||this._scaleY!==e){this._scaleX=t,this._scaleY=e,this._sgNode.setScale(t,e);var i=this._hasListenerCache;i&&i["scale-changed"]&&this.emit("scale-changed")}},getContentSize:function(t){if(this._sizeProvider&&!t){var e=this._sizeProvider.getContentSize();return this._contentSize=e,cc.size(e)}return cc.size(this._contentSize)},setContentSize:function(t,e){var i=this._contentSize;if(void 0===e){if(t.width===i.width&&t.height===i.height)return;i.width=t.width,i.height=t.height}else{if(t===i.width&&e===i.height)return;i.width=t,i.height=e}this._sizeProvider&&this._sizeProvider.setContentSize(i),this.emit("size-changed")},setOpacityModifyRGB:function(t){if(this._opacityModifyRGB!==t){this._opacityModifyRGB=t,this._sgNode.setOpacityModifyRGB(t);var e=this._sizeProvider;e instanceof _ccsg.Node&&e!==this._sgNode&&e.setOpacityModifyRGB(t)}},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setGlobalZOrder:function(t){this._globalZOrder=t,this._sgNode.setGlobalZOrder(t)},getGlobalZOrder:function(){return this._globalZOrder=this._sgNode.getGlobalZOrder(),this._globalZOrder},getAnchorPoint:function(){return cc.p(this._anchorPoint)},setAnchorPoint:function(t,e){var i=this._anchorPoint;if(void 0===e){if(t.x===i.x&&t.y===i.y)return;i.x=t.x,i.y=t.y}else{if(t===i.x&&e===i.y)return;i.x=t,i.y=e}var n=this._sizeProvider;n instanceof _ccsg.Node&&n.setAnchorPoint(i),this.emit("anchor-changed")},getAnchorPointInPoints:function(){return this._sgNode.getAnchorPointInPoints()},getDisplayedOpacity:function(){return this._sgNode.getDisplayedOpacity()},_updateDisplayedOpacity:function(t){this._sgNode.updateDisplayedOpacity(t)},getDisplayedColor:function(){return this._sgNode.getDisplayedColor()},getNodeToParentTransformAR:function(){var t=this.getContentSize(),e=this._sgNode.getNodeToParentTransform();if(!this._isSgTransformArToMe(t)){var i=this._anchorPoint.x*t.width,n=this._anchorPoint.y*t.height,r=cc.affineTransformMake(1,0,0,1,i,n);e=cc.affineTransformConcatIn(r,e)}return e},getBoundingBox:function(){var t=this.getContentSize(),e=cc.rect(0,0,t.width,t.height);return cc._rectApplyAffineTransformIn(e,this.getNodeToParentTransform())},getBoundingBoxToWorld:function(){var t;return this.parent&&(t=this.parent.getNodeToWorldTransformAR()),this._getBoundingBoxTo(t)},_getBoundingBoxTo:function(t){var e=this.getContentSize(),i=e.width,n=e.height,r=cc.rect(-this._anchorPoint.x*i,-this._anchorPoint.y*n,i,n),o=cc.affineTransformConcat(this.getNodeToParentTransformAR(),t);if(cc._rectApplyAffineTransformIn(r,o),!this._children)return r;for(var s=this._children,a=0;a<s.length;a++){var c=s[a];if(c&&c.active){var h=c._getBoundingBoxTo(o);h&&(r=cc.rectUnion(r,h))}}return r},getNodeToParentTransform:function(){var t=this.getContentSize(),e=this._sgNode.getNodeToParentTransform();if(this._isSgTransformArToMe(t)){var i=-this._anchorPoint.x*t.width,n=-this._anchorPoint.y*t.height,r=cc.affineTransformMake(1,0,0,1,i,n);e=cc.affineTransformConcatIn(r,e)}return e},getNodeToWorldTransform:function(){var t=this.getContentSize();cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene();var e=this._sgNode.getNodeToWorldTransform();if(this._isSgTransformArToMe(t)){var i=-this._anchorPoint.x*t.width,n=-this._anchorPoint.y*t.height,r=cc.affineTransformMake(1,0,0,1,i,n);e=cc.affineTransformConcatIn(r,e)}return e},getNodeToWorldTransformAR:function(){var t=this.getContentSize();cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene();var e=this._sgNode.getNodeToWorldTransform();if(!this._isSgTransformArToMe(t)){var i=this._anchorPoint.x*t.width,n=this._anchorPoint.y*t.height,r=cc.affineTransformMake(1,0,0,1,i,n);e=cc.affineTransformConcatIn(r,e)}return e},getParentToNodeTransform:function(){return this._sgNode.getParentToNodeTransform()},getWorldToNodeTransform:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene(),this._sgNode.getWorldToNodeTransform()},_isSgTransformArToMe:function(t){var e=this._sgNode.getContentSize();return 0===e.width&&0===e.height&&(0!==t.width||0!==t.height)||!!this._sgNode.isIgnoreAnchorPointForPosition()},convertToNodeSpace:function(t){cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene();var e=this._sgNode.convertToNodeSpace(t);return cc.pAdd(e,cc.p(this._anchorPoint.x*this._contentSize.width,this._anchorPoint.y*this._contentSize.height))},convertToWorldSpace:function(t){cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene();var e=t.x-this._anchorPoint.x*this._contentSize.width,i=t.y-this._anchorPoint.y*this._contentSize.height;return cc.v2(this._sgNode.convertToWorldSpace(cc.v2(e,i)))},convertToNodeSpaceAR:function(t){return cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene(),this._sgNode.isIgnoreAnchorPointForPosition()?cc.v2(this._sgNode.convertToNodeSpace(t)):this._sgNode.convertToNodeSpaceAR(t)},convertToWorldSpaceAR:function(t){return cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene(),this._sgNode.isIgnoreAnchorPointForPosition()?cc.v2(this._sgNode.convertToWorldSpace(t)):cc.v2(this._sgNode.convertToWorldSpaceAR(t))},convertTouchToNodeSpace:function(t){return this.convertToNodeSpace(t.getLocation())},convertTouchToNodeSpaceAR:function(t){return this.convertToNodeSpaceAR(t.getLocation())},setNodeDirty:function(){this._sgNode.setNodeDirty()},addChild:function(t,e,i){e=void 0===e?t._localZOrder:e;var n,r=!1;void 0===i?(i=void 0,n=t._name):cc.js.isString(i)?(n=i,i=void 0):cc.js.isNumber(i)&&(r=!0,n=""),cc.assertID(t,1606),cc.assertID(null===t._parent,1605),t.parent=this,t.zIndex=e,r?t.setTag(i):t.setName(n)},cleanup:function(){h&&cc.director.getActionManager().removeAllActionsFromTarget(this),cc.eventManager.removeListeners(this);var t,e,i=this._children.length;for(t=0;t<i;++t)(e=this._children[t])&&e.cleanup()},sortAllChildren:function(){if(this._reorderChildDirty){this._reorderChildDirty=!1;var t=this._children;if(t.length>1){var e,i,n,r=t.length;for(e=1;e<r;e++){for(n=t[e],i=e-1;i>=0;){if(n._localZOrder<t[i]._localZOrder)t[i+1]=t[i];else{if(!(n._localZOrder===t[i]._localZOrder&&n._sgNode._arrivalOrder<t[i]._sgNode._arrivalOrder))break;t[i+1]=t[i]}i--}t[i+1]=n}this.emit("child-reorder")}cc.director.__fastOff(cc.Director.EVENT_AFTER_UPDATE,this.sortAllChildren,this)}},_delaySort:function(){this._reorderChildDirty||(this._reorderChildDirty=!0,cc.director.__fastOn(cc.Director.EVENT_AFTER_UPDATE,this.sortAllChildren,this))},_updateDummySgNode:function(){var t=this,e=t._sgNode;e.setPosition(t._position),e.setRotationX(t._rotationX),e.setRotationY(t._rotationY),e.setScale(t._scaleX,t._scaleY),e.setSkewX(t._skewX),e.setSkewY(t._skewY);var i=e._arrivalOrder;e.setLocalZOrder(t._localZOrder),e._arrivalOrder=i,e.setGlobalZOrder(t._globalZOrder),e.setOpacity(t._opacity),e.setOpacityModifyRGB(t._opacityModifyRGB),e.setCascadeOpacityEnabled(t._cascadeOpacityEnabled),e.setTag(t._tag)},_updateSgNode:function(){this._updateDummySgNode();var t=this._sgNode;t.setAnchorPoint(this._anchorPoint),t.setVisible(this._active),t.setColor(this._color);var e=h?cc.director.getActionManager():null;this._activeInHierarchy?(e&&e.resumeTarget(this),cc.eventManager.resumeTarget(this)):(e&&e.pauseTarget(this),cc.eventManager.pauseTarget(this))},_removeSgNode:s.removeSgNode,onRestore:!1}),E=["parent","tag","skewX","skewY","position","rotation","rotationX","rotationY","scale","scaleX","scaleY","opacity","color"],S={x:["getPositionX","setPositionX"],y:["getPositionY","setPositionY"],zIndex:["getLocalZOrder","setLocalZOrder"],opacityModifyRGB:["isOpacityModifyRGB","setOpacityModifyRGB"],cascadeOpacity:["isCascadeOpacityEnabled","setCascadeOpacityEnabled"]};c.propertyDefine(x,E,S),x.EventType=u,cc.Node=e.exports=x}),{"./event/event":111,"./utils/base-node":191,"./utils/misc":196,"./utils/prefab-helper":198,"./utils/scene-graph-helper":199}],42:[(function(t,e,i){cc.Scene=cc.Class({name:"cc.Scene",extends:t("./CCNode"),properties:{autoReleaseAssets:void 0},ctor:function(){var t=this._sgNode=new _ccsg.Scene;t.setAnchorPoint(0,0),this._anchorPoint.x=0,this._anchorPoint.y=0,this._activeInHierarchy=!1,this._inited=!cc.game._isCloning,this.dependAssets=null},destroy:function(){this._super(),this._activeInHierarchy=!1},_onHierarchyChanged:function(){},_instantiate:null,_load:function(){this._inited||(this._onBatchCreated(),this._inited=!0)},_activate:function(t){t=!1!==t,cc.director._nodeActivator.activateNode(this,t)}}),e.exports=cc.Scene}),{"./CCNode":41}],43:[(function(t,e,i){function n(){this._scheduler=null,this._elapsed=-1,this._runForever=!1,this._useDelay=!1,this._timesExecuted=0,this._repeat=0,this._delay=0,this._interval=0,this._target=null,this._callback=null}var r=function(t,e,i,n,r,o,s){this.prev=t,this.next=e,this.callback=i,this.target=n,this.priority=r,this.paused=o,this.markedForDeletion=s,this.isUpdate=!i},o=[];r.get=function(t,e,i,n,s,a,c){var h=o.pop();return h?(h.prev=t,h.next=e,h.callback=i,h.target=n,h.priority=s,h.paused=a,h.markedForDeletion=c,h.isUpdate=!i):h=new r(t,e,i,n,s,a,c),h},r.put=function(t){o.length<20&&(t.prev=t.next=t.callback=t.target=null,o.push(t))};var s=function(t,e,i,n){this.list=t,this.entry=e,this.target=i,this.callback=n},a=[];s.get=function(t,e,i,n){var r=a.pop();return r?(r.list=t,r.entry=e,r.target=i,r.callback=n):r=new s(t,e,i,n),r},s.put=function(t){a.length<20&&(t.list=t.entry=t.target=t.callback=null,a.push(t))};var c=function(t,e,i,n,r,o){var s=this;s.timers=t,s.target=e,s.timerIndex=i,s.currentTimer=n,s.currentTimerSalvaged=r,s.paused=o},h=[];c.get=function(t,e,i,n,r,o){var s=h.pop();return s?(s.timers=t,s.target=e,s.timerIndex=i,s.currentTimer=n,s.currentTimerSalvaged=r,s.paused=o):s=new c(t,e,i,n,r,o),s},c.put=function(t){h.length<20&&(t.timers=t.target=t.currentTimer=null,h.push(t))};var l=n.prototype;l.initWithCallback=function(t,e,i,n,r,o){return this._scheduler=t,this._target=i,this._callback=e,this._elapsed=-1,this._interval=n,this._delay=o,this._useDelay=this._delay>0,this._repeat=r,this._runForever=this._repeat===cc.macro.REPEAT_FOREVER,!0},l.getInterval=function(){return this._interval},l.setInterval=function(t){this._interval=t},l.update=function(t){-1===this._elapsed?(this._elapsed=0,this._timesExecuted=0):(this._elapsed+=t,this._runForever&&!this._useDelay?this._elapsed>=this._interval&&(this.trigger(),this._elapsed=0):(this._useDelay?this._elapsed>=this._delay&&(this.trigger(),this._elapsed-=this._delay,this._timesExecuted+=1,this._useDelay=!1):this._elapsed>=this._interval&&(this.trigger(),this._elapsed=0,this._timesExecuted+=1),this._callback&&!this._runForever&&this._timesExecuted>this._repeat&&this.cancel()))},l.getCallback=function(){return this._callback},l.trigger=function(){this._target&&this._callback&&this._callback.call(this._target,this._elapsed)},l.cancel=function(){this._scheduler.unschedule(this._callback,this._target)};var u=[];n.get=function(){return u.pop()||new n},n.put=function(t){u.length<20&&(t._scheduler=t._target=t._callback=null,u.push(t))};var d=function(t){return t.__instanceId||t.uuid};cc.Scheduler=cc._Class.extend({ctor:function(){this._timeScale=1,this._updatesNegList=[],this._updates0List=[],this._updatesPosList=[],this._hashForUpdates={},this._hashForTimers={},this._currentTarget=null,this._currentTargetSalvaged=!1,this._updateHashLocked=!1,this._arrayForTimers=[]},_removeHashElement:function(t){delete this._hashForTimers[d(t.target)];for(var e=this._arrayForTimers,i=0,n=e.length;i<n;i++)if(e[i]===t){e.splice(i,1);break}c.put(t)},_removeUpdateFromHash:function(t){var e=d(t.target),i=this,n=i._hashForUpdates[e];if(n){for(var o=n.list,a=n.entry,c=0,h=o.length;c<h;c++)if(o[c]===a){o.splice(c,1);break}delete i._hashForUpdates[e],r.put(a),s.put(n)}},_priorityIn:function(t,e,i){for(var n=0;n<t.length;n++)if(i<t[n].priority)return void t.splice(n,0,e);t.push(e)},_appendIn:function(t,e){t.push(e)},setTimeScale:function(t){this._timeScale=t},getTimeScale:function(){return this._timeScale},update:function(t){this._updateHashLocked=!0,1!==this._timeScale&&(t*=this._timeScale);var e,i,n,r;for(e=0,n=(i=this._updatesNegList).length;e<n;e++)(r=i[e]).paused||r.markedForDeletion||(r.isUpdate?r.target.update(t):r.callback.call(r.target,t));for(e=0,n=(i=this._updates0List).length;e<n;e++)(r=i[e]).paused||r.markedForDeletion||(r.isUpdate?r.target.update(t):r.callback.call(r.target,t));for(e=0,n=(i=this._updatesPosList).length;e<n;e++)(r=i[e]).paused||r.markedForDeletion||(r.isUpdate?r.target.update(t):r.callback.call(r.target,t));var o,s=this._arrayForTimers;for(e=0;e<s.length;e++){if(o=s[e],this._currentTarget=o,this._currentTargetSalvaged=!1,!o.paused)for(o.timerIndex=0;o.timerIndex<o.timers.length;++o.timerIndex)o.currentTimer=o.timers[o.timerIndex],o.currentTimerSalvaged=!1,o.currentTimer.update(t),o.currentTimer=null;this._currentTargetSalvaged&&0===this._currentTarget.timers.length&&(this._removeHashElement(this._currentTarget),--e)}for(e=0,i=this._updatesNegList;e<i.length;)(r=i[e]).markedForDeletion?this._removeUpdateFromHash(r):e++;for(e=0,i=this._updates0List;e<i.length;)(r=i[e]).markedForDeletion?this._removeUpdateFromHash(r):e++;for(e=0,i=this._updatesPosList;e<i.length;)(r=i[e]).markedForDeletion?this._removeUpdateFromHash(r):e++;this._updateHashLocked=!1,this._currentTarget=null},scheduleCallbackForTarget:function(t,e,i,n,r,o){this.schedule(e,t,i,n,r,o)},schedule:function(t,e,i,r,o,s){"use strict";if("function"!=typeof t){var a=t;t=e,e=a}4!==arguments.length&&5!==arguments.length||(s=!!r,r=cc.macro.REPEAT_FOREVER,o=0),cc.assertID(e,1502);var h=d(e);cc.assertID(h,1510);var l=this._hashForTimers[h];l?l.paused!==s&&cc.warnID(1511):(l=c.get(null,e,0,null,null,s),this._arrayForTimers.push(l),this._hashForTimers[h]=l);var u,_;if(null==l.timers)l.timers=[];else for(_=0;_<l.timers.length;++_)if((u=l.timers[_])&&t===u._callback)return cc.logID(1507,u.getInterval(),i),void(u._interval=i);(u=n.get()).initWithCallback(this,t,e,i,r,o),l.timers.push(u)},scheduleUpdate:function(t,e,i,n){var o=d(t);cc.assertID(o,1510);var a=this._hashForUpdates[o];if(a&&a.entry){if(a.entry.priority===e)return a.entry.markedForDeletion=!1,void(a.entry.paused=i);if(this._updateHashLocked)return cc.logID(1506),a.entry.markedForDeletion=!1,void(a.entry.paused=i);this.unscheduleUpdate(t)}var c,h=r.get(null,null,n,t,e,i,!1);0===e?(c=this._updates0List,this._appendIn(c,h)):(c=e<0?this._updatesNegList:this._updatesPosList,this._priorityIn(c,h,e)),this._hashForUpdates[o]=s.get(c,h,t,null)},unschedule:function(t,e){if(e&&t){var i=d(e);cc.assertID(i,1510);var r=this,o=r._hashForTimers[i];if(o)for(var s=o.timers,a=0,c=s.length;a<c;a++){var h=s[a];if(t===h._callback)return h!==o.currentTimer||o.currentTimerSalvaged||(o.currentTimerSalvaged=!0),s.splice(a,1),n.put(h),o.timerIndex>=a&&o.timerIndex--,void(0===s.length&&(r._currentTarget===o?r._currentTargetSalvaged=!0:r._removeHashElement(o)))}}},unscheduleUpdate:function(t){if(t){var e=d(t);cc.assertID(e,1510);var i=this._hashForUpdates[e];i&&(this._updateHashLocked?i.entry.markedForDeletion=!0:this._removeUpdateFromHash(i.entry))}},unscheduleAllForTarget:function(t){if(t){var e=d(t);cc.assertID(e,1510);var i=this._hashForTimers[e];if(i){var r=i.timers;r.indexOf(i.currentTimer)>-1&&!i.currentTimerSalvaged&&(i.currentTimerSalvaged=!0);for(var o=0,s=r.length;o<s;o++)n.put(r[o]);r.length=0,this._currentTarget===i?this._currentTargetSalvaged=!0:this._removeHashElement(i)}this.unscheduleUpdate(t)}},unscheduleAll:function(){this.unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},unscheduleAllWithMinPriority:function(t){var e,i,n=this._arrayForTimers;for(e=n.length-1;e>=0;e--)i=n[e],this.unscheduleAllForTarget(i.target);var r,o=0;if(t<0)for(e=0;e<this._updatesNegList.length;)o=this._updatesNegList.length,(r=this._updatesNegList[e])&&r.priority>=t&&this.unscheduleUpdate(r.target),o==this._updatesNegList.length&&e++;if(t<=0)for(e=0;e<this._updates0List.length;)o=this._updates0List.length,(r=this._updates0List[e])&&this.unscheduleUpdate(r.target),o==this._updates0List.length&&e++;for(e=0;e<this._updatesPosList.length;)o=this._updatesPosList.length,(r=this._updatesPosList[e])&&r.priority>=t&&this.unscheduleUpdate(r.target),o==this._updatesPosList.length&&e++},isScheduled:function(t,e){cc.assertID(t,1508),cc.assertID(e,1509);var i=d(e);cc.assertID(i,1510);var n=this._hashForTimers[i];if(!n)return!1;if(null==n.timers)return!1;for(var r=n.timers,o=0;o<r.length;++o)if(t===r[o]._callback)return!0;return!1},pauseAllTargets:function(){return this.pauseAllTargetsWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},pauseAllTargetsWithMinPriority:function(t){var e,i,n,r=[],o=this._arrayForTimers;for(i=0,n=o.length;i<n;i++)(e=o[i])&&(e.paused=!0,r.push(e.target));var s;if(t<0)for(i=0;i<this._updatesNegList.length;i++)(s=this._updatesNegList[i])&&s.priority>=t&&(s.paused=!0,r.push(s.target));if(t<=0)for(i=0;i<this._updates0List.length;i++)(s=this._updates0List[i])&&(s.paused=!0,r.push(s.target));for(i=0;i<this._updatesPosList.length;i++)(s=this._updatesPosList[i])&&s.priority>=t&&(s.paused=!0,r.push(s.target));return r},resumeTargets:function(t){if(t)for(var e=0;e<t.length;e++)this.resumeTarget(t[e])},pauseTarget:function(t){cc.assertID(t,1503);var e=d(t);cc.assertID(e,1510);var i=this,n=i._hashForTimers[e];n&&(n.paused=!0);var r=i._hashForUpdates[e];r&&(r.entry.paused=!0)},resumeTarget:function(t){cc.assertID(t,1504);var e=d(t);cc.assertID(e,1510);var i=this,n=i._hashForTimers[e];n&&(n.paused=!1);var r=i._hashForUpdates[e];r&&(r.entry.paused=!1)},isTargetPaused:function(t){cc.assertID(t,1505);var e=d(t);cc.assertID(e,1510);var i=this._hashForTimers[e];if(i)return i.paused;var n=this._hashForUpdates[e];return!!n&&n.entry.paused},scheduleUpdateForTarget:function(t,e,i){this.scheduleUpdate(t,e,i)},unscheduleCallbackForTarget:function(t,e){this.unschedule(e,t)},unscheduleUpdateForTarget:function(t){this.unscheduleUpdate(t)},unscheduleAllCallbacksForTarget:function(t){this.unscheduleAllForTarget(t)},unscheduleAllCallbacks:function(){this.unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},unscheduleAllCallbacksWithMinPriority:function(t){this.unscheduleAllWithMinPriority(t)}}),cc.Scheduler.PRIORITY_SYSTEM=1<<31,cc.Scheduler.PRIORITY_NON_SYSTEM=cc.Scheduler.PRIORITY_SYSTEM+1}),{}],44:[(function(t,e,i){var n=t("./CCRawAsset");cc.Asset=cc.Class({name:"cc.Asset",extends:n,properties:{rawUrl:{get:function(){if(this._rawFiles){if(cc.AssetLibrary)return cc.AssetLibrary.getLibUrlNoExt(this._uuid)+"/"+this._rawFiles[0];cc.errorID(6400)}return""},visible:!1},rawUrls:{get:function(){if(this._rawFiles){if(cc.AssetLibrary){var t=cc.AssetLibrary.getLibUrlNoExt(this._uuid)+"/";return this._rawFiles.map((function(e){return t+e}))}cc.errorID(6401)}return[]},visible:!1},_rawFiles:null},statics:{deserialize:function(t){return cc.deserialize(t)},preventDeferredLoadDependents:!1},serialize:function(){return Editor.serialize(this)},createNode:null,_setRawFiles:function(t){this._rawFiles=t.length>0?t:null},_preloadRawFiles:null}),e.exports=cc.Asset}),{"./CCRawAsset":50}],45:[(function(t,e,i){var n=cc.Class({name:"cc.AudioClip",extends:cc.RawAsset});cc.AudioClip=n,e.exports=n}),{}],46:[(function(t,e,i){var n=cc.Class({name:"cc.BitmapFont",extends:cc.Font,properties:{fntDataStr:{default:""},spriteFrame:{default:null,type:cc.SpriteFrame},fontSize:{default:-1},_fntConfig:null}});cc.BitmapFont=n,e.exports=n}),{}],47:[(function(t,e,i){var n=cc.Class({name:"cc.Font",extends:cc.Asset});cc.Font=n,e.exports=n}),{}],48:[(function(t,e,i){var n=cc.Class({name:"cc.LabelAtlas",extends:cc.BitmapFont});cc.LabelAtlas=n,e.exports=n}),{}],49:[(function(t,e,i){var n=cc.Class({name:"cc.Prefab",extends:cc.Asset,properties:{data:null,asyncLoadAssets:void 0,_createFunction:{default:null,serializable:!1}},createNode:!1,compileCreateFunction:function(){var e=t("../platform/instantiate-jit");this._createFunction=e.compile(this.data)},_doInstantiate:function(t){return this.data._prefab?this.data._prefab._synced=!0:cc.warnID(3700),this._createFunction||this.compileCreateFunction(),this._createFunction(t)},_instantiate:function(){var t;return cc.supportJit?(t=this._doInstantiate(),this.data._instantiate(t)):t=this.data._instantiate(),t}});cc.Prefab=e.exports=n,cc.js.obsolete(cc,"cc._Prefab","Prefab")}),{"../platform/instantiate-jit":165}],50:[(function(t,e,i){var n=t("../platform/CCObject");cc.RawAsset=cc.Class({name:"cc.RawAsset",extends:n,ctor:function(){Object.defineProperty(this,"_uuid",{value:"",writable:!0})},statics:{createNodeByInfo:null}}),Object.defineProperty(cc.RawAsset,"isRawAssetType",{value:function(t){return cc.isChildClassOf(t,cc.RawAsset)&&!cc.isChildClassOf(t,cc.Asset)}}),e.exports=cc.RawAsset}),{"../platform/CCObject":152}],51:[(function(t,e,i){var n=cc.Class({name:"cc.SceneAsset",extends:cc.Asset,properties:{scene:null,asyncLoadAssets:void 0}});cc.SceneAsset=n,e.exports=n}),{}],52:[(function(t,e,i){var n=cc.Class({name:"cc.Script",extends:cc.Asset});cc._Script=n;var r=cc.Class({name:"cc.JavaScript",extends:n});cc._JavaScript=r;var o=cc.Class({name:"cc.CoffeeScript",extends:n});cc._CoffeeScript=o;var s=cc.Class({name:"cc.TypeScript",extends:n});cc._TypeScript=s}),{}],53:[(function(t,e,i){var n=cc.Class({name:"cc.SpriteAtlas",extends:cc.Asset,properties:{_spriteFrames:{default:{}}},getTexture:function(){var t=Object.keys(this._spriteFrames);if(t.length>0){var e=this._spriteFrames[t[0]];return e?e.getTexture():null}return null},getSpriteFrame:function(t){return this._spriteFrames[t]},getSpriteFrames:function(){var t=[],e=this._spriteFrames;for(var i in e)t.push(e[i]);return t}});cc.SpriteAtlas=n,e.exports=n}),{}],54:[(function(t,e,i){var n=cc.Class({name:"cc.TTFFont",extends:cc.Font});cc.TTFFont=n,e.exports=n}),{}],55:[(function(t,e,i){t("./CCRawAsset"),t("./CCAsset"),t("./CCFont"),t("./CCPrefab"),t("./CCAudioClip"),t("./CCScripts"),t("./CCSceneAsset"),t("../sprites/CCSpriteFrame"),t("../textures/CCTexture2D"),t("./CCTTFFont"),t("./CCSpriteAtlas"),t("./CCBitmapFont"),t("./CCLabelAtlas")}),{"../sprites/CCSpriteFrame":185,"../textures/CCTexture2D":186,"./CCAsset":44,"./CCAudioClip":45,"./CCBitmapFont":46,"./CCFont":47,"./CCLabelAtlas":48,"./CCPrefab":49,"./CCRawAsset":50,"./CCSceneAsset":51,"./CCScripts":52,"./CCSpriteAtlas":53,"./CCTTFFont":54}],56:[(function(t,e,i){var n=t("../utils/misc"),r=!!cc.ActionManager,o=function(){};cc.s_globalOrderOfArrival=1,_ccsg.Node=cc.Class({name:"ccsg.Node",properties:{_running:!1,_localZOrder:0,_globalZOrder:0,_arrivalOrder:0,_reorderChildDirty:!1,_vertexZ:0,_customZ:void 0,_rotationX:0,_rotationY:0,_scaleX:1,_scaleY:1,_position:cc.p(0,0),_skewX:0,_skewY:0,_children:[],_visible:!0,_anchorPoint:cc.p(0,0),_contentSize:cc.size(0,0),_parent:null,_ignoreAnchorPointForPosition:!1,tag:cc.macro.NODE_TAG_INVALID,_name:"",_realOpacity:255,_realColor:cc.Color.WHITE,_cascadeColorEnabled:!1,_cascadeOpacityEnabled:!1,_isTransitionFinished:!1,_actionManager:null,_scheduler:null,_renderCmd:null},ctor:function(){this.__instanceId=cc.ClassManager.getNewInstanceId(),this._renderCmd=this._createRenderCmd()},init:function(){return!0},attr:function(t){for(var e in t)this[e]=t[e]},getSkewX:function(){return this._skewX},setSkewX:function(t){this._skewX=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},getSkewY:function(){return this._skewY},setSkewY:function(t){this._skewY=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},setLocalZOrder:function(t){this._parent?this._parent.reorderChild(this,t):this._localZOrder=t,cc.eventManager._setDirtyForNode(this)},_setLocalZOrder:function(t){this._localZOrder=t},getLocalZOrder:function(){return this._localZOrder},getZOrder:function(){return cc.logID(1600),this.getLocalZOrder()},setZOrder:function(t){cc.logID(1601),this.setLocalZOrder(t)},setGlobalZOrder:function(t){this._globalZOrder!==t&&(this._globalZOrder=t,cc.eventManager._setDirtyForNode(this))},getGlobalZOrder:function(){return this._globalZOrder},getVertexZ:function(){return this._vertexZ},setVertexZ:function(t){this._customZ=this._vertexZ=t},getRotation:function(){return this._rotationX!==this._rotationY&&cc.logID(1602),this._rotationX},setRotation:function(t){this._rotationX=this._rotationY=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},getRotationX:function(){return this._rotationX},setRotationX:function(t){this._rotationX=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},getRotationY:function(){return this._rotationY},setRotationY:function(t){this._rotationY=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},getScale:function(){return this._scaleX!==this._scaleY&&cc.logID(1603),this._scaleX},setScale:function(t,e){this._scaleX=t,this._scaleY=e||0===e?e:t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},getScaleX:function(){return this._scaleX},setScaleX:function(t){this._scaleX=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},getScaleY:function(){return this._scaleY},setScaleY:function(t){this._scaleY=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},setPosition:function(t,e){var i=this._position;if(void 0===e){if(i.x===t.x&&i.y===t.y)return;i.x=t.x,i.y=t.y}else{if(i.x===t&&i.y===e)return;i.x=t,i.y=e}this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},getPosition:function(){return cc.p(this._position)},getPositionX:function(){return this._position.x},setPositionX:function(t){this._position.x=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},getPositionY:function(){return this._position.y},setPositionY:function(t){this._position.y=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},getChildrenCount:function(){return this._children.length},getChildren:function(){return this._children},isVisible:function(){return this._visible},setVisible:function(t){this._visible!==t&&(this._visible=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty),cc.renderer.childrenOrderDirty=!0)},getAnchorPoint:function(){return cc.p(this._anchorPoint)},setAnchorPoint:function(t,e){var i=this._anchorPoint;if(void 0===e){if(t.x===i.x&&t.y===i.y)return;i.x=t.x,i.y=t.y}else{if(t===i.x&&e===i.y)return;i.x=t,i.y=e}this._renderCmd._updateAnchorPointInPoint()},_getAnchorX:function(){return this._anchorPoint.x},_setAnchorX:function(t){this._anchorPoint.x!==t&&(this._anchorPoint.x=t,this._renderCmd._updateAnchorPointInPoint())},_getAnchorY:function(){return this._anchorPoint.y},_setAnchorY:function(t){this._anchorPoint.y!==t&&(this._anchorPoint.y=t,this._renderCmd._updateAnchorPointInPoint())},getAnchorPointInPoints:function(){return this._renderCmd.getAnchorPointInPoints()},_getWidth:function(){return this._contentSize.width},_setWidth:function(t){this._contentSize.width=t,this._renderCmd._updateAnchorPointInPoint()},_getHeight:function(){return this._contentSize.height},_setHeight:function(t){this._contentSize.height=t,this._renderCmd._updateAnchorPointInPoint()},getContentSize:function(){return cc.size(this._contentSize)},setContentSize:function(t,e){var i=this._contentSize;if(void 0===e){if(t.width===i.width&&t.height===i.height)return;i.width=t.width,i.height=t.height}else{if(t===i.width&&e===i.height)return;i.width=t,i.height=e}this._renderCmd._updateAnchorPointInPoint()},isRunning:function(){return this._running},getParent:function(){return this._parent},setParent:function(t){this._parent=t;var e=_ccsg.Node._dirtyFlags;this._renderCmd.setDirtyFlag(e.transformDirty|e.opacityDirty)},isIgnoreAnchorPointForPosition:function(){return this._ignoreAnchorPointForPosition},setIgnoreAnchorPointForPosition:function(t){t!==this._ignoreAnchorPointForPosition&&(this._ignoreAnchorPointForPosition=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty))},getTag:function(){return this.tag},setTag:function(t){this.tag=t},setName:function(t){this._name=t},getName:function(){return this._name},updateOrderOfArrival:function(){this._arrivalOrder=++cc.s_globalOrderOfArrival},getScheduler:function(){return this._scheduler||cc.director.getScheduler()},setScheduler:function(t){this._scheduler!==t&&(this.unscheduleAllCallbacks(),this._scheduler=t)},boundingBox:function(){return cc.logID(1608),this.getBoundingBox()},getBoundingBox:function(){var t=cc.rect(0,0,this._contentSize.width,this._contentSize.height);return cc._rectApplyAffineTransformIn(t,this.getNodeToParentTransform())},cleanup:function(){this.stopAllActions(),this.unscheduleAllCallbacks(),cc.eventManager.removeListeners(this)},getChildByTag:function(t){var e=this._children;if(null!==e)for(var i=0;i<e.length;i++){var n=e[i];if(n&&n.tag===t)return n}return null},getChildByName:function(t){if(!t)return cc.log("Invalid name"),null;for(var e=this._children,i=0,n=e.length;i<n;i++)if(e[i]._name===t)return e[i];return null},addChild:function(t,e,i){e=void 0===e?t._localZOrder:e;var n,r=!1;void 0===i?n=t._name:"string"==typeof i?(n=i,i=void 0):"number"==typeof i&&(r=!0,n=""),cc.assertID(t,1606),cc.assertID(null===t._parent,1605),this._addChildHelper(t,e,i,n,r)},_addChildHelper:function(t,e,i,n,r){this._children||(this._children=[]),this._insertChild(t,e),r?t.setTag(i):t.setName(n),t.setParent(this),t.updateOrderOfArrival(),this._running&&(t.performRecursive(_ccsg.Node.performType.onEnter),this._isTransitionFinished&&t.performRecursive(_ccsg.Node.performType.onEnterTransitionDidFinish)),t._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty),this._cascadeColorEnabled&&t._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.colorDirty),this._cascadeOpacityEnabled&&t._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.opacityDirty)},removeFromParent:function(t){this._parent&&(void 0===t&&(t=!0),this._parent.removeChild(this,t))},removeFromParentAndCleanup:function(t){cc.logID(1607),this.removeFromParent(t)},removeChild:function(t,e){0!==this._children.length&&(void 0===e&&(e=!0),this._children.indexOf(t)>-1&&this._detachChild(t,e),cc.renderer.childrenOrderDirty=!0)},removeChildByTag:function(t,e){t===cc.macro.NODE_TAG_INVALID&&cc.logID(1609);var i=this.getChildByTag(t);i?this.removeChild(i,e):cc.logID(1610,t)},removeAllChildrenWithCleanup:function(t){this.removeAllChildren(t)},removeAllChildren:function(t){var e=this._children;if(null!==e){void 0===t&&(t=!0);for(var i=0;i<e.length;i++){var n=e[i];n&&(this._running&&(n.performRecursive(_ccsg.Node.performType.onExitTransitionDidStart),n.performRecursive(_ccsg.Node.performType.onExit)),t&&n.performRecursive(_ccsg.Node.performType.cleanup),n.parent=null,n._renderCmd.detachFromParent())}this._children.length=0,cc.renderer.childrenOrderDirty=!0}},_detachChild:function(t,e){this._running&&(t.performRecursive(_ccsg.Node.performType.onExitTransitionDidStart),t.performRecursive(_ccsg.Node.performType.onExit)),e&&t.performRecursive(_ccsg.Node.performType.cleanup),t.parent=null,t._renderCmd.detachFromParent(),cc.js.array.remove(this._children,t)},_insertChild:function(t,e){cc.renderer.childrenOrderDirty=this._reorderChildDirty=!0,this._children.push(t),t._setLocalZOrder(e)},setNodeDirty:function(){this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},reorderChild:function(t,e){cc.assertID(t,1617),-1!==this._children.indexOf(t)?e!==t.zIndex&&(cc.renderer.childrenOrderDirty=this._reorderChildDirty=!0,t.updateOrderOfArrival(),t._setLocalZOrder(e),this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.orderDirty)):cc.logID(1635)},sortAllChildren:function(){if(this._reorderChildDirty){var t,e,i,n=this._children,r=n.length;for(t=1;t<r;t++){for(i=n[t],e=t-1;e>=0;){if(i._localZOrder<n[e]._localZOrder)n[e+1]=n[e];else{if(!(i._localZOrder===n[e]._localZOrder&&i._arrivalOrder<n[e]._arrivalOrder))break;n[e+1]=n[e]}e--}n[e+1]=i}this._reorderChildDirty=!1}},draw:function(t){},transformAncestors:function(){null!==this._parent&&(this._parent.transformAncestors(),this._parent.transform())},onEnter:function(){this._isTransitionFinished=!1,this._running=!0,this.resume()},performRecursive:function(t){var e=_ccsg.Node.performType;if(!(t>=e.max)){var i,n,r,o,s,a=0,c=_ccsg.Node._performStacks[_ccsg.Node._performing];for(c||(c=[],_ccsg.Node._performStacks.push(c)),c.length=0,_ccsg.Node._performing++,r=c[0]=this;r;){if((i=r._children)&&i.length>0)for(o=0,s=i.length;o<s;++o)n=i[o],c.push(n);r=c[++a]}switch(t){case e.onEnter:for(o=c.length-1;o>=0;--o)r=c[o],c[o]=null,r&&r.onEnter();break;case e.onExit:for(o=c.length-1;o>=0;--o)r=c[o],c[o]=null,r&&r.onExit();break;case e.onEnterTransitionDidFinish:for(o=c.length-1;o>=0;--o)r=c[o],c[o]=null,r&&r.onEnterTransitionDidFinish();break;case e.cleanup:for(o=c.length-1;o>=0;--o)r=c[o],c[o]=null,r&&r.cleanup();break;case e.onExitTransitionDidStart:for(o=c.length-1;o>=0;--o)r=c[o],c[o]=null,r&&r.onExitTransitionDidStart()}_ccsg.Node._performing--}},onEnterTransitionDidFinish:function(){this._isTransitionFinished=!0},onExitTransitionDidStart:function(){},onExit:function(){this._running=!1,this.pause()},runAction:r?function(t){return cc.assertID(t,1618),cc.director.getActionManager().addAction(t,this,!this._running),t}:o,stopAllActions:r?function(){cc.director.getActionManager().removeAllActionsFromTarget(this)}:o,stopAction:r?function(t){cc.director.getActionManager().removeAction(t)}:o,stopActionByTag:r?function(t){t!==cc.Action.TAG_INVALID?cc.director.getActionManager().removeActionByTag(t,this):cc.logID(1612)}:o,getActionByTag:r?function(t){return t===cc.Action.TAG_INVALID?(cc.logID(1613),null):cc.director.getActionManager().getActionByTag(t,this)}:function(){return null},getNumberOfRunningActions:r?function(){return cc.director.getActionManager().getNumberOfRunningActionsInTarget(this)}:function(){return 0},scheduleUpdate:function(){this.scheduleUpdateWithPriority(0)},scheduleUpdateWithPriority:function(t){this.scheduler.scheduleUpdate(this,t,!this._running)},unscheduleUpdate:function(){this.scheduler.unscheduleUpdate(this)},schedule:function(t,e,i,n,r){var o=arguments.length;"function"==typeof t?1===o?(e=0,i=cc.macro.REPEAT_FOREVER,n=0,r=this.__instanceId):2===o?"number"==typeof e?(i=cc.macro.REPEAT_FOREVER,n=0,r=this.__instanceId):(r=e,e=0,i=cc.macro.REPEAT_FOREVER,n=0):3===o?("string"==typeof i?(r=i,i=cc.macro.REPEAT_FOREVER):r=this.__instanceId,n=0):4===o&&(r=this.__instanceId):1===o?(e=0,i=cc.macro.REPEAT_FOREVER,n=0):2===o&&(i=cc.macro.REPEAT_FOREVER,n=0),cc.assertID(t,1619),cc.assertID(e>=0,1620),e=e||0,i=isNaN(i)?cc.macro.REPEAT_FOREVER:i,n=n||0,this.scheduler.schedule(t,this,e,i,n,!this._running,r)},scheduleOnce:function(t,e,i){void 0===i&&(i=this.__instanceId),this.schedule(t,0,0,e,i)},unschedule:function(t){t&&this.scheduler.unschedule(t,this)},unscheduleAllCallbacks:function(){this.scheduler.unscheduleAllForTarget(this)},resumeSchedulerAndActions:function(){cc.logID(1614),this.resume()},resume:function(){this.scheduler.resumeTarget(this),r&&cc.director.getActionManager().resumeTarget(this),cc.eventManager.resumeTarget(this)},pauseSchedulerAndActions:function(){cc.logID(1615),this.pause()},pause:function(){this.scheduler.pauseTarget(this),r&&cc.director.getActionManager().pauseTarget(this),cc.eventManager.pauseTarget(this)},getParentToNodeTransform:function(){return this._renderCmd.getParentToNodeTransform()},parentToNodeTransform:function(){return this.getParentToNodeTransform()},getNodeToWorldTransform:function(){for(var t=this.getNodeToParentTransform(),e=this._parent;null!==e;e=e.parent)t=cc.affineTransformConcat(t,e.getNodeToParentTransform());return t},nodeToWorldTransform:function(){return this.getNodeToWorldTransform()},getWorldToNodeTransform:function(){return cc.affineTransformInvert(this.getNodeToWorldTransform())},worldToNodeTransform:function(){return this.getWorldToNodeTransform()},convertToNodeSpace:function(t){return cc.pointApplyAffineTransform(t,this.getWorldToNodeTransform())},convertToWorldSpace:function(t){return t=t||cc.v2(0,0),cc.pointApplyAffineTransform(t,this.getNodeToWorldTransform())},convertToNodeSpaceAR:function(t){return cc.pSub(this.convertToNodeSpace(t),this._renderCmd.getAnchorPointInPoints())},convertToWorldSpaceAR:function(t){t=t||cc.v2(0,0);var e=cc.pAdd(t,this._renderCmd.getAnchorPointInPoints());return this.convertToWorldSpace(e)},_convertToWindowSpace:function(t){var e=this.convertToWorldSpace(t);return cc.director.convertToUI(e)},convertTouchToNodeSpace:function(t){var e=t.getLocation();return this.convertToNodeSpace(e)},convertTouchToNodeSpaceAR:function(t){var e=cc.director.convertToGL(t.getLocation());return this.convertToNodeSpaceAR(e)},updateTransform:function(){for(var t,e=this._children,i=0;i<e.length;i++)(t=e[i])&&t.updateTransform()},retain:function(){},release:function(){},visit:function(t){var e=this._renderCmd,i=t?t._renderCmd:null;if(this._visible){var n=cc.renderer;e.visit(i);var r,o,s=this._children,a=s.length;if(a>0){for(this._reorderChildDirty&&this.sortAllChildren(),r=0;r<a&&(o=s[r])._localZOrder<0;r++)o.visit(this);for(n.pushRenderCommand(e);r<a;r++)s[r].visit(this)}else n.pushRenderCommand(e);e._dirtyFlag=0}else e._propagateFlagsDown(i)},transform:function(t,e){this._renderCmd.transform(t,e)},nodeToParentTransform:function(){return this.getNodeToParentTransform()},getNodeToParentTransform:function(t){var e=this._renderCmd.getNodeToParentTransform();if(t){for(var i={a:e.a,b:e.b,c:e.c,d:e.d,tx:e.tx,ty:e.ty},n=this._parent;null!=n&&n!=t;n=n.getParent())cc.affineTransformConcatIn(i,n.getNodeToParentTransform());return i}return e},getNodeToParentAffineTransform:function(t){return this.getNodeToParentTransform(t)},getShaderProgram:function(){return this._renderCmd.getShaderProgram()},setShaderProgram:function(t){this._renderCmd.setShaderProgram(t)},getGLServerState:function(){return 0},setGLServerState:function(t){},getBoundingBoxToWorld:function(){var t=cc.rect(0,0,this._contentSize.width,this._contentSize.height),e=this.getNodeToWorldTransform();if(cc._rectApplyAffineTransformIn(t,e),!this._children)return t;for(var i=this._children,n=0;n<i.length;n++){var r=i[n];if(r&&r._visible){var o=r._getBoundingBoxToCurrentNode(e);o&&(t=cc.rectUnion(t,o))}}return t},_getBoundingBoxToCurrentNode:function(t){var e=cc.rect(0,0,this._contentSize.width,this._contentSize.height),i=void 0===t?this.getNodeToParentTransform():cc.affineTransformConcat(this.getNodeToParentTransform(),t);if(cc._rectApplyAffineTransformIn(e,i),!this._children)return e;for(var n=this._children,r=0;r<n.length;r++){var o=n[r];if(o&&o._visible){var s=o._getBoundingBoxToCurrentNode(i);s&&(e=cc.rectUnion(e,s))}}return e},getOpacity:function(){return this._realOpacity},getDisplayedOpacity:function(){return this._renderCmd.getDisplayedOpacity()},setOpacity:function(t){this._realOpacity=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.opacityDirty)},updateDisplayedOpacity:function(t){this._renderCmd._updateDisplayOpacity(t)},isCascadeOpacityEnabled:function(){return this._cascadeOpacityEnabled},setCascadeOpacityEnabled:function(t){this._cascadeOpacityEnabled!==t&&(this._cascadeOpacityEnabled=t,this._renderCmd.setCascadeOpacityEnabledDirty())},getColor:function(){var t=this._realColor;return cc.color(t.r,t.g,t.b,t.a)},getDisplayedColor:function(){return this._renderCmd.getDisplayedColor()},setColor:function(t){var e=this._realColor;e.r=t.r,e.g=t.g,e.b=t.b,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.colorDirty)},updateDisplayedColor:function(t){this._renderCmd._updateDisplayColor(t)},isCascadeColorEnabled:function(){return this._cascadeColorEnabled},setCascadeColorEnabled:function(t){this._cascadeColorEnabled!==t&&(this._cascadeColorEnabled=t,this._renderCmd.setCascadeColorEnabledDirty())},setOpacityModifyRGB:function(t){},isOpacityModifyRGB:function(){return!1},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new _ccsg.Node.CanvasRenderCmd(this):new _ccsg.Node.WebGLRenderCmd(this)}}),_ccsg.Node.extend=cc._Class.extend,_ccsg.Node.prototype.ctor=_ccsg.Node,_ccsg.Node.performType={onEnter:1,onExit:2,cleanup:3,onEnterTransitionDidFinish:4,onExitTransitionDidStart:5,max:6},_ccsg.Node._performStacks=[[]],_ccsg.Node._performing=0;var s=["skewX","skewY","vertexZ","rotation","rotationX","rotationY","scale","scaleX","scaleY","children","childrenCount","parent","scheduler","shaderProgram","opacity","color"],a={x:["getPositionX","setPositionX"],y:["getPositionY","setPositionY"],width:["_getWidth","_setWidth"],height:["_getHeight","_setHeight"],anchorX:["_getAnchorX","_setAnchorX"],anchorY:["_getAnchorY","_setAnchorY"],zIndex:["getLocalZOrder","setLocalZOrder"],visible:["isVisible","setVisible"],running:["isRunning"],ignoreAnchor:["isIgnoreAnchorPointForPosition","setIgnoreAnchorPointForPosition"],opacityModifyRGB:["isOpacityModifyRGB","setOpacityModifyRGB"],cascadeOpacity:["isCascadeOpacityEnabled","setCascadeOpacityEnabled"],cascadeColor:["isCascadeColorEnabled","setCascadeColorEnabled"]};n.propertyDefine(_ccsg.Node,s,a)}),{"../utils/misc":196}],57:[(function(t,e,i){function n(t,e){var i,n,r,o,s,a,c=1,h=_ccsg.Node._performStacks[_ccsg.Node._performing];h||(h=[],_ccsg.Node._performStacks.push(h)),h.length=0,_ccsg.Node._performing++,h[0]=t;for(;c;)if(c--,r=h[c],h[c]=null,r&&(i=r._children)&&i.length>0)for(o=r._renderCmd,s=0,a=i.length;s<a;++s)(n=i[s])._visible&&(h[c]=n,c++,n._renderCmd[e](o));_ccsg.Node._performing--}cc.CustomRenderCmd=function(t,e){this._needDraw=!0,this._target=t,this._callback=e},cc.CustomRenderCmd.prototype.rendering=function(t,e,i){this._callback&&this._callback.call(this._target,t,e,i)};var r=_ccsg.Node._dirtyFlags={transformDirty:1,visibleDirty:2,colorDirty:4,opacityDirty:8,cacheDirty:16,orderDirty:32,textDirty:64,gradientDirty:128,textureDirty:256,contentDirty:512,cullingDirty:1024,COUNT:9};cc.js.get(r,"all",(function(){return(1<<r.COUNT)-1}),!1),_ccsg.Node._requestDirtyFlag=function(t){cc.assertID(!r[t],1622,t);var e=1<<r.COUNT;return r[t]=e,r.COUNT++,e};var o=Math.PI/180;_ccsg.Node.RenderCmd=function(t){this._node=t,this._anchorPointInPoints=new cc.Vec2(0,0),this._needDraw=!1,this._dirtyFlag=1,this._curLevel=-1,this._cameraFlag=0,this._displayedColor=new cc.Color(255,255,255,255),this._displayedOpacity=255,this._cascadeColorEnabledDirty=!1,this._cascadeOpacityEnabledDirty=!1,this._transform={a:1,b:0,c:0,d:1,tx:0,ty:0},this._worldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0},this._inverse={a:1,b:0,c:0,d:1,tx:0,ty:0},this._transformUpdated=!1,cc.renderer.pushDirtyNode(this)},_ccsg.Node.RenderCmd.prototype={constructor:_ccsg.Node.RenderCmd,_ctor:_ccsg.Node.RenderCmd,getAnchorPointInPoints:function(){return cc.p(this._anchorPointInPoints)},getDisplayedColor:function(){var t=this._displayedColor;return cc.color(t.r,t.g,t.b,t.a)},getDisplayedOpacity:function(){return this._displayedOpacity},setCascadeColorEnabledDirty:function(){this._cascadeColorEnabledDirty=!0,this.setDirtyFlag(r.colorDirty)},setCascadeOpacityEnabledDirty:function(){this._cascadeOpacityEnabledDirty=!0,this.setDirtyFlag(r.opacityDirty)},getParentToNodeTransform:function(){return this._dirtyFlag&r.transformDirty&&cc.affineTransformInvertOut(this.getNodeToParentTransform(),this._inverse),this._inverse},detachFromParent:function(){},_updateAnchorPointInPoint:function(){var t=this._anchorPointInPoints,e=this._node._contentSize,i=this._node._anchorPoint;t.x=e.width*i.x,t.y=e.height*i.y,this.setDirtyFlag(r.transformDirty)},setDirtyFlag:function(t){0===this._dirtyFlag&&0!==t&&cc.renderer.pushDirtyNode(this),this._dirtyFlag|=t},getParentRenderCmd:function(){return this._node&&this._node._parent&&this._node._parent._renderCmd?this._node._parent._renderCmd:null},updateTransform:function(t,e){var i=this._node,n=t?t._worldTransform:null,r=this._transform,s=this._worldTransform;if(!this._transformUpdated){var a=i._rotationX||i._rotationY,c=i._skewX||i._skewY,h=i._scaleX,l=i._scaleY,u=this._anchorPointInPoints.x,d=this._anchorPointInPoints.y,_=1,f=0,p=0,g=1;if(a||c){if(r.tx=i._position.x,r.ty=i._position.y,a){var v=i._rotationX*o;if(p=Math.sin(v),g=Math.cos(v),i._rotationY===i._rotationX)_=g,f=-p;else{var m=i._rotationY*o;_=Math.cos(m),f=-Math.sin(m)}}if(r.a=_*=h,r.b=f*=h,r.c=p*=l,r.d=g*=l,c){var y=Math.tan(i._skewX*o),T=Math.tan(i._skewY*o);y===1/0&&(y=99999999),T===1/0&&(T=99999999),r.a=_+p*T,r.b=f+g*T,r.c=p+_*y,r.d=g+f*y}(u||d)&&(r.tx-=r.a*u+r.c*d,r.ty-=r.b*u+r.d*d,i._ignoreAnchorPointForPosition&&(r.tx+=u,r.ty+=d))}else r.a=h,r.b=0,r.c=0,r.d=l,r.tx=i._position.x,r.ty=i._position.y,(u||d)&&(r.tx-=r.a*u,r.ty-=r.d*d,i._ignoreAnchorPointForPosition&&(r.tx+=u,r.ty+=d))}n?(s.a=r.a*n.a+r.b*n.c,s.b=r.a*n.b+r.b*n.d,s.c=r.c*n.a+r.d*n.c,s.d=r.c*n.b+r.d*n.d,s.tx=r.tx*n.a+r.ty*n.c+n.tx,s.ty=r.tx*n.b+r.ty*n.d+n.ty):(s.a=r.a,s.b=r.b,s.c=r.c,s.d=r.d,s.tx=r.tx,s.ty=r.ty)},transform:function(t,e){this.updateTransform(t),this._currentRegion&&(this._updateCurrentRegions(),this._notifyRegionStatus&&this._notifyRegionStatus(_ccsg.Node.CanvasRenderCmd.RegionStatus.DirtyDouble)),cc.macro.ENABLE_CULLING?(this._updateCameraFlag(t),this._doCulling&&this._doCulling()):this._doCulling&&(this._needDraw=!0),e&&n(this._node,"transform")},_updateCameraFlag:function(t){var e=cc.Camera;cc._renderType===cc.game.RENDER_TYPE_WEBGL&&e&&t&&this._cameraFlag!=e.flags.InCamera&&(this._cameraFlag=t._cameraFlag>0?e.flags.ParentInCamera:0)},culling:function(t,e){cc.macro.ENABLE_CULLING?(this._updateCameraFlag(t),this._doCulling&&this._doCulling(),e&&n(this._node,"culling")):this._doCulling&&(this._needDraw=!0)},getNodeToParentTransform:function(){return this._dirtyFlag&r.transformDirty&&this.transform(),this._transform},setNodeToParentTransform:function(t){t?(this._transform=t,this._transformUpdated=!0):this._transformUpdated=!1,this.setDirtyFlag(r.transformDirty)},_propagateFlagsDown:function(t){if(t){var e=this._dirtyFlag,i=t._node,n=t._dirtyFlag;i._cascadeColorEnabled&&n&r.colorDirty&&(e|=r.colorDirty),i._cascadeOpacityEnabled&&n&r.opacityDirty&&(e|=r.opacityDirty),n&r.transformDirty&&(e|=r.transformDirty),n&r.cullingDirty&&(e|=r.cullingDirty),this._dirtyFlag=e}},visit:function(t){var e=this._node,i=cc.renderer;(t=t||this.getParentRenderCmd())&&(this._curLevel=t._curLevel+1),this._propagateFlagsDown(t),isNaN(e._customZ)&&(e._vertexZ=i.assignedZ,i.assignedZ+=i.assignedZStep),this._syncStatus(t)},_updateDisplayColor:function(t){var e,i,n,o,s=this._node,a=this._displayedColor,c=s._realColor;if(this._notifyRegionStatus&&this._notifyRegionStatus(_ccsg.Node.CanvasRenderCmd.RegionStatus.Dirty),this._cascadeColorEnabledDirty&&!s._cascadeColorEnabled){a.r=c.r,a.g=c.g,a.b=c.b;var h=new cc.Color(255,255,255,255);for(e=0,i=(n=s._children).length;e<i;e++)(o=n[e])&&o._renderCmd&&o._renderCmd._updateDisplayColor(h);this._cascadeColorEnabledDirty=!1}else{if(void 0===t){var l=s._parent;t=l&&l._cascadeColorEnabled?l.getDisplayedColor():cc.Color.WHITE}if(a.r=0|c.r*t.r/255,a.g=0|c.g*t.g/255,a.b=0|c.b*t.b/255,s._cascadeColorEnabled)for(e=0,i=(n=s._children).length;e<i;e++)(o=n[e])&&o._renderCmd&&(o._renderCmd._updateDisplayColor(a),o._renderCmd._updateColor())}this._dirtyFlag&=~r.colorDirty},_updateDisplayOpacity:function(t){var e,i,n,o,s=this._node;if(this._notifyRegionStatus&&this._notifyRegionStatus(_ccsg.Node.CanvasRenderCmd.RegionStatus.Dirty),this._cascadeOpacityEnabledDirty&&!s._cascadeOpacityEnabled){for(this._displayedOpacity=s._realOpacity,e=0,i=(n=s._children).length;e<i;e++)(o=n[e])&&o._renderCmd&&o._renderCmd._updateDisplayOpacity(255);this._cascadeOpacityEnabledDirty=!1}else{if(void 0===t){var a=s._parent;t=255,a&&a._cascadeOpacityEnabled&&(t=a.getDisplayedOpacity())}if(this._displayedOpacity=s._realOpacity*t/255,s._cascadeOpacityEnabled)for(e=0,i=(n=s._children).length;e<i;e++)(o=n[e])&&o._renderCmd&&(o._renderCmd._updateDisplayOpacity(this._displayedOpacity),o._renderCmd._updateColor())}this._dirtyFlag&=~r.opacityDirty},_syncDisplayColor:function(t){var e=this._node,i=this._displayedColor,n=e._realColor;if(void 0===t){var r=e._parent;t=r&&r._cascadeColorEnabled?r.getDisplayedColor():cc.Color.WHITE}i.r=0|n.r*t.r/255,i.g=0|n.g*t.g/255,i.b=0|n.b*t.b/255},_syncDisplayOpacity:function(t){var e=this._node;if(void 0===t){var i=e._parent;t=255,i&&i._cascadeOpacityEnabled&&(t=i.getDisplayedOpacity())}this._displayedOpacity=e._realOpacity*t/255},_updateColor:function(){},updateStatus:function(){var t=this._dirtyFlag,e=t&r.colorDirty,i=t&r.opacityDirty;if(t&r.contentDirty&&(this._notifyRegionStatus&&this._notifyRegionStatus(_ccsg.Node.CanvasRenderCmd.RegionStatus.Dirty),this._dirtyFlag&=~r.contentDirty),e&&this._updateDisplayColor(),i&&this._updateDisplayOpacity(),(e||i)&&this._updateColor(),t&r.transformDirty){var n=this.getParentRenderCmd();this.transform(n,!0),this._dirtyFlag&=~r.transformDirty,this._dirtyFlag&=~r.cullingDirty}else t&r.cullingDirty&&(this.culling(n,!0),this._dirtyFlag&=~r.cullingDirty)},_syncStatus:function(t){var e=this._dirtyFlag,i=e&r.colorDirty,n=e&r.opacityDirty;i&&this._syncDisplayColor(),n&&this._syncDisplayOpacity(),(i||n)&&this._updateColor(),e&r.transformDirty?this.transform(t):e&r.cullingDirty&&this.culling(t)}},_ccsg.Node.RenderCmd.prototype.originUpdateTransform=_ccsg.Node.RenderCmd.prototype.updateTransform,_ccsg.Node.RenderCmd.prototype.originTransform=_ccsg.Node.RenderCmd.prototype.transform,_ccsg.Node.RenderCmd.prototype.originCulling=_ccsg.Node.RenderCmd.prototype.culling,_ccsg.Node.RenderCmd.prototype.originUpdateStatus=_ccsg.Node.RenderCmd.prototype.updateStatus,_ccsg.Node.RenderCmd.prototype._originSyncStatus=_ccsg.Node.RenderCmd.prototype._syncStatus}),{}],58:[(function(t,e,i){_ccsg.Node.CanvasRenderCmd=function(t){this._ctor(t),this._currentRegion=new cc.Region,this._oldRegion=new cc.Region,this._regionFlag=0},_ccsg.Node.CanvasRenderCmd.RegionStatus={NotDirty:0,Dirty:1,DirtyDouble:2};var n=_ccsg.Node.CanvasRenderCmd.prototype=Object.create(_ccsg.Node.RenderCmd.prototype);n.constructor=_ccsg.Node.CanvasRenderCmd,n._rootCtor=_ccsg.Node.CanvasRenderCmd,n._notifyRegionStatus=function(t){this._needDraw&&this._regionFlag<t&&(this._regionFlag=t)};var r=new cc.Rect;n.getLocalBB=function(){var t=this._node;return r.x=r.y=0,r.width=t._contentSize.width,r.height=t._contentSize.height,r},n._updateCurrentRegions=function(){var t=this._currentRegion;this._currentRegion=this._oldRegion,this._oldRegion=t,_ccsg.Node.CanvasRenderCmd.RegionStatus.DirtyDouble!==this._regionFlag||this._currentRegion.isEmpty()||this._oldRegion.union(this._currentRegion),this._currentRegion.updateRegion(this.getLocalBB(),this._worldTransform)},n.detachFromParent=function(){for(var t,e=this._node._children,i=0,n=e.length;i<n;i++)(t=e[i])&&t._renderCmd&&t._renderCmd.detachFromParent()},n.setShaderProgram=function(t){},n.getShaderProgram=function(){return null},_ccsg.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc=function(t){return t?t.src===cc.macro.SRC_ALPHA&&t.dst===cc.macro.ONE||t.src===cc.macro.ONE&&t.dst===cc.macro.ONE?"lighter":t.src===cc.macro.ZERO&&t.dst===cc.macro.SRC_ALPHA?"destination-in":t.src===cc.macro.ZERO&&t.dst===cc.macro.ONE_MINUS_SRC_ALPHA?"destination-out":"source-over":"source-over"}}),{}],59:[(function(t,e,i){_ccsg.Node.WebGLRenderCmd=function(t){this._ctor(t),this._shaderProgram=null};var n=_ccsg.Node.WebGLRenderCmd.prototype=Object.create(_ccsg.Node.RenderCmd.prototype);n.constructor=_ccsg.Node.WebGLRenderCmd,n._rootCtor=_ccsg.Node.WebGLRenderCmd,n._updateColor=function(){},n.setShaderProgram=function(t){this._shaderProgram=t},n.getShaderProgram=function(){return this._shaderProgram}}),{}],60:[(function(t,e,i){function n(t){return t instanceof cc.Scene?cc.visibleRect:!t._sizeProvider||t._sizeProvider instanceof _ccsg.Node?t._contentSize:t.getContentSize()}function r(t,e,i,n){for(var r=t._parent._scaleX,o=t._parent._scaleY,s=0,a=0,c=t._parent;;){var h=c._position;if(s+=h.x,a+=h.y,!(c=c._parent))return i.x=i.y=0,void(n.x=n.y=1);if(c===e)break;var l=c._scaleX,u=c._scaleY;s*=l,a*=u,r*=l,o*=u}n.x=0!==r?1/r:1,n.y=0!==o?1/o:1,i.x=-s,i.y=-a}function o(t,e){var i,o,s,a=e._target;a?r(t,i=a,o=u,s=d):i=t._parent;var c=n(i),_=i._anchorPoint,f=i instanceof cc.Scene,p=t._position.x,g=t._position.y,v=t._anchorPoint;if(e._alignFlags&h){var m,y,T=c.width;f?(m=cc.visibleRect.left.x,y=cc.visibleRect.right.x):y=(m=-_.x*T)+T,m+=e._isAbsLeft?e._left:e._left*T,y-=e._isAbsRight?e._right:e._right*T,a&&(m+=o.x,m*=s.x,y+=o.x,y*=s.x);var C,x=v.x,E=t._scaleX;if(E<0&&(x=1-x,E=-E),e.isStretchWidth)C=y-m,0!==E&&(t.width=C/E),p=m+x*C;else if(C=t.width*E,e.isAlignHorizontalCenter){var S=e._isAbsHorizontalCenter?e._horizontalCenter:e._horizontalCenter*T,b=(.5-_.x)*c.width;a&&(S*=s.x,b+=o.x,b*=s.x),p=b+(x-.5)*C+S}else p=e.isAlignLeft?m+x*C:y+(x-1)*C}if(e._alignFlags&l){var A,R,I=c.height;f?(R=cc.visibleRect.bottom.y,A=cc.visibleRect.top.y):A=(R=-_.y*I)+I,R+=e._isAbsBottom?e._bottom:e._bottom*I,A-=e._isAbsTop?e._top:e._top*I,a&&(R+=o.y,R*=s.y,A+=o.y,A*=s.y);var w,O=v.y,L=t._scaleY;if(L<0&&(O=1-O,L=-L),e.isStretchHeight)w=A-R,0!==L&&(t.height=w/L),g=R+O*w;else if(w=t.height*L,e.isAlignVerticalCenter){var P=e._isAbsVerticalCenter?e._verticalCenter:e._verticalCenter*I,D=(.5-_.y)*c.height;a&&(P*=s.y,D+=o.y,D*=s.y),g=D+(O-.5)*w+P}else g=e.isAlignBottom?R+O*w:A+(O-1)*w}t.setPosition(p,g)}function s(t){var e=t._widget;if(e){o(t,e),e.isAlignOnce?e.enabled=!1:_.push(e)}for(var i=t._children,n=0;n<i.length;n++){var r=i[n];r._active&&s(r)}}function a(){var t=cc.director.getScene();if(t){if(f.isAligning=!0,f._nodesOrderDirty)_.length=0,s(t),f._nodesOrderDirty=!1;else{var e,i=f._activeWidgetsIterator;for(i.i=0;i.i<_.length;++i.i)o((e=_[i.i]).node,e)}f.isAligning=!1}}function c(t){var e=t._parent;cc.Node.isNode(e)&&c(e);var i=t._widget||t.getComponent(cc.Widget);i&&o(t,i)}var h=56,l=7,u=cc.Vec2.ZERO,d=cc.Vec2.ONE,_=[],f=cc._widgetManager=e.exports={_AlignFlags:{TOP:1,MID:2,BOT:4,LEFT:8,CENTER:16,RIGHT:32},isAligning:!1,_nodesOrderDirty:!1,_activeWidgetsIterator:new cc.js.array.MutableForwardIterator(_),init:function(t){t.on(cc.Director.EVENT_BEFORE_VISIT,a)},add:function(t){t.node._widget=t,this._nodesOrderDirty=!0},remove:function(t){t.node._widget=null,this._activeWidgetsIterator.remove(t)},updateAlignment:c}}),{}],61:[(function(t,e,i){var n;n=_ccsg.Node._dirtyFlags.cullingDirty,t("./CCSGCameraNode");var r=cc.Class({name:"cc.Camera",extends:cc._RendererUnderSG,ctor:function(){this.viewMatrix=cc.affineTransformMake(),this.invertViewMatrix=cc.affineTransformMake(),this._lastViewMatrix=cc.affineTransformMake(),this._sgTarges=[],this._checkedTimes=0,this.visibleRect={left:cc.v2(),right:cc.v2(),top:cc.v2(),bottom:cc.v2()},this.viewPort=cc.rect()},editor:!1,properties:{_targets:{default:[],type:cc.Node,visible:!0},zoomRatio:1},statics:{main:null},_createSgNode:function(){if(cc._renderType===cc.game.RENDER_TYPE_CANVAS){cc.errorID(8301);var t=new _ccsg.Node;return t.setTransform=t.addTarget=t.removeTarget=function(){},t}return new _ccsg.CameraNode},_initSgNode:function(){},_addSgTargetInSg:function(t){var e;if(t instanceof cc.Node?e=t._sgNode:t instanceof _ccsg.Node&&(e=t),e&&!e._cameraInfo){e._cameraInfo={touched:this._checkedTimes},this._sgNode.addTarget(e),this._sgTarges.push(e);var i=e._renderCmd;i.setDirtyFlag(n),i._cameraFlag=r.flags.InCamera,cc.renderer.childrenOrderDirty=!0}},_removeTargetInSg:function(t){var e;if(t instanceof cc.Node?e=t._sgNode:t instanceof _ccsg.Node&&(e=t),e&&e._cameraInfo){this._sgNode.removeTarget(e),delete e._cameraInfo,cc.js.array.remove(this._sgTarges,e);var i=e._renderCmd;i.setDirtyFlag(n),i._cameraFlag=0,cc.renderer.childrenOrderDirty=!0}},onEnable:function(){if(r.main)cc.errorID(8300);else{r.main=this;for(var t=this._targets,e=0,i=t.length;e<i;e++)this._addSgTargetInSg(t[e])}},onDisable:function(){if(r.main===this){r.main=null;for(var t=this._sgTarges,e=t.length-1;e>=0;e--)this._removeTargetInSg(t[e])}},addTarget:function(t){-1===this._targets.indexOf(t)&&(this._addSgTargetInSg(t),this._targets.push(t))},removeTarget:function(t){-1!==this._targets.indexOf(t)&&(this._removeTargetInSg(t),cc.js.array.remove(this._targets,t))},getTargets:function(){return this._targets},getNodeToCameraTransform:function(t){var e=t.getNodeToWorldTransform();return this.containsNode(t)&&(e=cc.affineTransformConcatIn(e,cc.Camera.main.viewMatrix)),e},getCameraToWorldPoint:function(t){return cc.Camera.main&&(t=cc.pointApplyAffineTransform(t,cc.Camera.main.invertViewMatrix)),t},containsNode:function(t){t instanceof cc.Node&&(t=t._sgNode);for(var e=this._sgTarges;t;){if(-1!==e.indexOf(t))return!0;t=t.parent}return!1},_setSgNodesCullingDirty:function(){for(var t=this._sgTarges,e=0;e<t.length;e++)t[e]._renderCmd.setDirtyFlag(n)},_checkSgTargets:function(){for(var t=this._targets,e=this._sgTarges,i=++this._checkedTimes,n=0,r=t.length;n<r;n++){var o=t[n],s=o;o instanceof cc.Node&&(s=o._sgNode)&&!s._cameraInfo&&this._addSgTargetInSg(s),s&&(s._cameraInfo.touched=i)}for(var a=e.length-1;a>=0;a--){var c=e[a];c._cameraInfo.touched!==i&&this._removeTargetInSg(c)}},lateUpdate:function(){this._checkSgTargets();var t=this.viewMatrix,e=this.invertViewMatrix,i=this.viewPort,n=cc.visibleRect,r=this.visibleRect,o=this.node.getNodeToWorldTransformAR(),s=.5*-(Math.atan2(o.b,o.a)+Math.atan2(-o.c,o.d)),a=1,c=0,h=0,l=1;s&&(h=Math.sin(s),a=l=Math.cos(s),c=-h);var u=this.zoomRatio;a*=u,c*=u,h*=u,l*=u,t.a=a,t.b=c,t.c=h,t.d=l;var d=n.center;t.tx=d.x-(a*o.tx+h*o.ty),t.ty=d.y-(c*o.tx+l*o.ty),cc.affineTransformInvertOut(t,e),i.x=n.bottomLeft.x,i.y=n.bottomLeft.y,i.width=n.width,i.height=n.height,cc._rectApplyAffineTransformIn(i,e),r.left.x=i.xMin,r.right.x=i.xMax,r.bottom.y=i.yMin,r.top.y=i.yMax,this._sgNode.setTransform(a,c,h,l,t.tx,t.ty);var _=this._lastViewMatrix;_.a===t.a&&_.b===t.b&&_.c===t.c&&_.d===t.d&&_.tx===t.tx&&_.ty===t.ty||(this._setSgNodesCullingDirty(),_.a=t.a,_.b=t.b,_.c=t.c,_.d=t.d,_.tx=t.tx,_.ty=t.ty)}});r.flags=cc.Enum({InCamera:1,ParentInCamera:2}),e.exports=cc.Camera=r}),{"./CCSGCameraNode":62}],62:[(function(t,e,i){var n=_ccsg.Node.extend({ctor:function(){this._super(),this._mat=new cc.math.Matrix4,this._mat.identity(),this._beforeVisitCmd=new cc.CustomRenderCmd(this,this._onBeforeVisit),this._afterVisitCmd=new cc.CustomRenderCmd(this,this._onAfterVisit)},setTransform:function(t,e,i,n,r,o){var s=this._mat.mat;s[0]=t,s[1]=e,s[4]=i,s[5]=n,s[12]=r,s[13]=o},addTarget:function(t){var e=t._cameraInfo;e.sgCameraNode=this,e.originVisit=t.visit,t.visit=this._visit},removeTarget:function(t){t.visit=t._cameraInfo.originVisit},_visit:function(t){var e=this._cameraInfo,i=e.sgCameraNode;cc.renderer.pushRenderCommand(i._beforeVisitCmd),e.originVisit.call(this,t),cc.renderer.pushRenderCommand(i._afterVisitCmd)},_onBeforeVisit:function(){cc.renderer._breakBatch(),cc.math.glMatrixMode(cc.math.KM_GL_PROJECTION),cc.current_stack.push(),cc.current_stack.top.multiply(this._mat)},_onAfterVisit:function(){cc.renderer._breakBatch(),cc.math.glMatrixMode(cc.math.KM_GL_PROJECTION),cc.current_stack.pop()}});e.exports=_ccsg.CameraNode=n}),{}],63:[(function(t,e,i){cc.Collider.Box=cc.Class({properties:{_offset:cc.v2(0,0),_size:cc.size(100,100),offset:{tooltip:!1,get:function(){return this._offset},set:function(t){this._offset=t},type:cc.Vec2},size:{tooltip:!1,get:function(){return this._size},set:function(t){this._size.width=t.width<0?0:t.width,this._size.height=t.height<0?0:t.height},type:cc.Size}},resetInEditor:!1});var n=cc.Class({name:"cc.BoxCollider",extends:cc.Collider,mixins:[cc.Collider.Box],editor:!1});cc.BoxCollider=e.exports=n}),{}],64:[(function(t,e,i){cc.Collider.Circle=cc.Class({properties:{_offset:cc.v2(0,0),_radius:50,offset:{get:function(){return this._offset},set:function(t){this._offset=t},type:cc.Vec2},radius:{tooltip:!1,get:function(){return this._radius},set:function(t){this._radius=t<0?0:t}}},resetInEditor:!1});var n=cc.Class({name:"cc.CircleCollider",extends:cc.Collider,mixins:[cc.Collider.Circle],editor:!1});cc.CircleCollider=e.exports=n}),{}],65:[(function(t,e,i){var n=cc.Class({name:"cc.Collider",extends:cc.Component,properties:{editing:{default:!1,serializable:!1,tooltip:!1},tag:{tooltip:!1,default:0,range:[0,1e7],type:cc.Integer}},onDisable:function(){cc.director.getCollisionManager().removeCollider(this)},onEnable:function(){cc.director.getCollisionManager().addCollider(this)}});cc.Collider=e.exports=n}),{}],66:[(function(t,e,i){var n=t("./CCContact"),r=n.CollisionType,o=cc.rect(),s=cc.v2(),a=cc.Class({mixins:[cc.EventTarget],properties:{enabled:!1,enabledDrawBoundingBox:!1},ctor:function(){this.__instanceId=cc.ClassManager.getNewInstanceId(),this._contacts=[],this._colliders=[],this._debugDrawer=null,this._enabledDebugDraw=!1},update:function(t){if(this.enabled){var e,i,n=this._colliders;for(e=0,i=n.length;e<i;e++)this.updateCollider(n[e]);var o=this._contacts,s=[];for(e=0,i=o.length;e<i;e++){var a=o[e].updateState();a!==r.None&&s.push([a,o[e]])}for(e=0,i=s.length;e<i;e++){var c=s[e];this._doCollide(c[0],c[1])}this.drawColliders()}},_doCollide:function(t,e){var i;switch(t){case r.CollisionEnter:i="onCollisionEnter";break;case r.CollisionStay:i="onCollisionStay";break;case r.CollisionExit:i="onCollisionExit"}var n,o,s,a=e.collider1,c=e.collider2,h=a.node._components,l=c.node._components;for(n=0,o=h.length;n<o;n++)(s=h[n])[i]&&s[i](c,a);for(n=0,o=l.length;n<o;n++)(s=l[n])[i]&&s[i](a,c)},shouldCollide:function(t,e){var i=t.node,n=e.node,r=cc.game.collisionMatrix;return i!==n&&r[i.groupIndex][n.groupIndex]},initCollider:function(t){if(!t.world){var e=t.world={};e.aabb=cc.rect(),e.preAabb=cc.rect(),e.radius=0,t instanceof cc.BoxCollider?(e.position=null,e.points=[cc.v2(),cc.v2(),cc.v2(),cc.v2()]):t instanceof cc.PolygonCollider?(e.position=null,e.points=t.points.map((function(t){return cc.v2(t.x,t.y)}))):t instanceof cc.CircleCollider&&(e.position=cc.v2(),e.points=null)}},updateCollider:function(t){if(void 0===t.node.isStatic||!t.node.isStatic||!t.node.aabbInit){t.node.aabbInit=!0;var e=t.offset,i=t.world,n=i.aabb,r=i.transform=t.node.getNodeToWorldTransformAR(),a=i.preAabb;if(a.x=n.x,a.y=n.y,a.width=n.width,a.height=n.height,t instanceof cc.BoxCollider){var c=t.size;o.x=e.x-c.width/2,o.y=e.y-c.height/2,o.width=c.width,o.height=c.height;var h=i.points,l=h[0],u=h[1],d=h[2],_=h[3];cc.obbApplyAffineTransform(o,r,l,u,d,_);var f=Math.min(l.x,u.x,d.x,_.x),p=Math.min(l.y,u.y,d.y,_.y),g=Math.max(l.x,u.x,d.x,_.x),v=Math.max(l.y,u.y,d.y,_.y);n.x=f,n.y=p,n.width=g-f,n.height=v-p}else if(t instanceof cc.CircleCollider){S=cc.pointApplyAffineTransform(t.offset,r);i.position.x=S.x,i.position.y=S.y,r.tx=r.ty=0,s.x=t.radius,s.y=0;var m=cc.pointApplyAffineTransform(s,r),y=Math.sqrt(m.x*m.x+m.y*m.y);i.radius=y,n.x=S.x-y,n.y=S.y-y,n.width=2*y,n.height=2*y}else if(t instanceof cc.PolygonCollider){var T=t.points,C=i.points;C.length=T.length;for(var f=1e6,p=1e6,g=-1e6,v=-1e6,x=0,E=T.length;x<E;x++){C[x]||(C[x]=cc.v2()),s.x=T[x].x+e.x,s.y=T[x].y+e.y;var S=cc.pointApplyAffineTransform(s,r);C[x].x=S.x,C[x].y=S.y,S.x>g&&(g=S.x),S.x<f&&(f=S.x),S.y>v&&(v=S.y),S.y<p&&(p=S.y)}n.x=f,n.y=p,n.width=g-f,n.height=v-p}}},addCollider:function(t){var e=this._colliders;if(-1===e.indexOf(t)){for(var i=0,r=e.length;i<r;i++){var o=e[i];if(this.shouldCollide(t,o)){var s=new n(t,o);this._contacts.push(s)}}e.push(t),this.initCollider(t)}t.node.on("group-changed",this.onNodeGroupChanged,this)},removeCollider:function(t){var e=this._colliders,i=e.indexOf(t);if(i>=0){e.splice(i,1);for(var n=this._contacts,o=n.length-1;o>=0;o--){var s=n[o];s.collider1!==t&&s.collider2!==t||(s.touching&&this._doCollide(r.CollisionExit,s),n.splice(o,1))}t.node.off("group-changed",this.onNodeGroupChanged,this)}else cc.errorID(6600)},attachDebugDrawToCamera:function(t){this._debugDrawer&&t.addTarget(this._debugDrawer)},detachDebugDrawFromCamera:function(t){this._debugDrawer&&t.removeTarget(this._debugDrawer)},onNodeGroupChanged:function(t){for(var e=t.currentTarget.getComponents(cc.Collider),i=0,n=e.length;i<n;i++)this.removeCollider(e[i]),this.addCollider(e[i])},drawColliders:function(){var t=this._debugDrawer;if(this._enabledDebugDraw&&t){t.clear();for(var e=this._colliders,i=0,n=e.length;i<n;i++){var r=e[i];if(r instanceof cc.BoxCollider||r instanceof cc.PolygonCollider){var o=r.world.points;if(o.length>0){t.strokeColor=cc.Color.WHITE,t.moveTo(o[0].x,o[0].y);for(var s=1;s<o.length;s++)t.lineTo(o[s].x,o[s].y);t.close(),t.stroke()}}else r instanceof cc.CircleCollider&&(t.circle(r.world.position.x,r.world.position.y,r.world.radius),t.stroke());if(this.enabledDrawBoundingBox){var a=r.world.aabb;t.strokeColor=cc.Color.BLUE,t.moveTo(a.xMin,a.yMin),t.lineTo(a.xMin,a.yMax),t.lineTo(a.xMax,a.yMax),t.lineTo(a.xMax,a.yMin),t.close(),t.stroke()}}}},onSceneLaunched:function(){this._enabledDebugDraw&&this._debugDrawer&&(this._debugDrawer.removeFromParent(),cc.director.getScene()._sgNode.addChild(this._debugDrawer))}});cc.js.getset(a.prototype,"enabledDebugDraw",(function(){return this._enabledDebugDraw}),(function(t){t&&!this._enabledDebugDraw?(this._debugDrawer||(this._debugDrawer=new _ccsg.GraphicsNode,this._debugDrawer.retain()),cc.director.getScene()._sgNode.addChild(this._debugDrawer),cc.director.on(cc.Director.EVENT_AFTER_SCENE_LAUNCH,this.onSceneLaunched,this)):!t&&this._enabledDebugDraw&&(this._debugDrawer.clear(),this._debugDrawer.removeFromParent(!1),cc.director.off(cc.Director.EVENT_AFTER_SCENE_LAUNCH,this.onSceneLaunched,this)),this._enabledDebugDraw=t})),cc.CollisionManager=e.exports=a}),{"./CCContact":67}],67:[(function(t,e,i){function n(t,e){this.collider1=t,this.collider2=e,this.touching=!1;var i=t instanceof cc.BoxCollider||t instanceof cc.PolygonCollider,n=e instanceof cc.BoxCollider||e instanceof cc.PolygonCollider,o=t instanceof cc.CircleCollider,s=e instanceof cc.CircleCollider;i&&n?this.testFunc=r.polygonPolygon:o&&s?this.testFunc=r.circleCircle:i&&s?this.testFunc=r.polygonCircle:o&&n?(this.testFunc=r.polygonCircle,this.collider1=e,this.collider2=t):cc.errorID(6601,cc.js.getClassName(t),cc.js.getClassName(e))}var r=t("./CCIntersection"),o=cc.Enum({None:0,CollisionEnter:1,CollisionStay:2,CollisionExit:3});n.prototype.test=function(){var t=this.collider1.world,e=this.collider2.world;return(void 0===this.collider1.node.disableCollider||!this.collider1.node.disableCollider)&&((void 0===this.collider2.node.disableCollider||!this.collider2.node.disableCollider)&&!!t.aabb.intersects(e.aabb))},n.prototype.updateState=function(){var t=this.test(),e=o.None;return t&&!this.touching?(this.touching=!0,e=o.CollisionEnter):t&&this.touching?e=o.CollisionStay:!t&&this.touching&&(this.touching=!1,e=o.CollisionExit),e},n.CollisionType=o,e.exports=n}),{"./CCIntersection":68}],68:[(function(t,e,i){function n(t,e,i,n){var r=(n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x),o=(e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x),s=(n.y-i.y)*(e.x-t.x)-(n.x-i.x)*(e.y-t.y);if(0!==s){var a=r/s,c=o/s;if(0<=a&&a<=1&&0<=c&&c<=1)return!0}return!1}function r(t,e,i){for(var r=i.length,o=0;o<r;++o)if(n(t,e,i[o],i[(o+1)%r]))return!0;return!1}function o(t,e){for(var i=!1,n=t.x,r=t.y,o=e.length,s=0,a=o-1;s<o;a=s++){var c=e[s].x,h=e[s].y,l=e[a].x,u=e[a].y;h>r!=u>r&&n<(l-c)*(r-h)/(u-h)+c&&(i=!i)}return i}function s(t,e,i,n){var r,o=i.x-e.x,s=i.y-e.y,a=o*o+s*s,c=((t.x-e.x)*o+(t.y-e.y)*s)/a;return r=n?a?c<0?e:c>1?i:cc.v2(e.x+c*o,e.y+c*s):e:cc.v2(e.x+c*o,e.y+c*s),o=t.x-r.x,s=t.y-r.y,Math.sqrt(o*o+s*s)}var a={};a.lineLine=n,a.lineRect=function(t,e,i){var r=new cc.Vec2(i.x,i.y),o=new cc.Vec2(i.x,i.yMax),s=new cc.Vec2(i.xMax,i.yMax),a=new cc.Vec2(i.xMax,i.y);return!!(n(t,e,r,o)||n(t,e,o,s)||n(t,e,s,a)||n(t,e,a,r))},a.linePolygon=r,a.rectRect=function(t,e){var i=t.x,n=t.y,r=t.x+t.width,o=t.y+t.height,s=e.x,a=e.y,c=e.x+e.width,h=e.y+e.height;return i<=c&&r>=s&&n<=h&&o>=a},a.rectPolygon=function(t,e){var i,n,s=new cc.Vec2(t.x,t.y),a=new cc.Vec2(t.x,t.yMax),c=new cc.Vec2(t.xMax,t.yMax),h=new cc.Vec2(t.xMax,t.y);if(r(s,a,e))return!0;if(r(a,c,e))return!0;if(r(c,h,e))return!0;if(r(h,s,e))return!0;for(i=0,n=e.length;i<n;++i)if(o(e[i],t))return!0;return!!(o(s,e)||o(a,e)||o(c,e)||o(h,e))},a.polygonPolygon=function(t,e){var i,n;for(i=0,n=t.length;i<n;++i)if(r(t[i],t[(i+1)%n],e))return!0;for(i=0,n=e.length;i<n;++i)if(o(e[i],t))return!0;for(i=0,n=t.length;i<n;++i)if(o(t[i],e))return!0;return!1},a.circleCircle=function(t,e){return t.position.sub(e.position).mag()<t.radius+e.radius},a.polygonCircle=function(t,e){var i=e.position;if(o(i,t))return!0;for(var n=0,r=t.length;n<r;n++)if(s(i,0===n?t[t.length-1]:t[n-1],t[n],!0)<e.radius)return!0;return!1},a.pointInPolygon=o,a.pointLineDistance=s,cc.Intersection=e.exports=a}),{}],69:[(function(t,e,i){cc.Collider.Polygon=cc.Class({properties:{threshold:{default:1,serializable:!1,visible:!1},_offset:cc.v2(0,0),offset:{get:function(){return this._offset},set:function(t){this._offset=t},type:cc.Vec2},points:{tooltip:!1,default:function(){return[cc.v2(-50,-50),cc.v2(50,-50),cc.v2(50,50),cc.v2(-50,50)]},type:[cc.Vec2]}},resetPointsByContour:!1});var n=cc.Class({name:"cc.PolygonCollider",extends:cc.Collider,mixins:[cc.Collider.Polygon],editor:!1});cc.PolygonCollider=e.exports=n}),{}],70:[(function(t,e,i){t("./CCCollisionManager"),t("./CCCollider"),t("./CCBoxCollider"),t("./CCCircleCollider"),t("./CCPolygonCollider")}),{"./CCBoxCollider":63,"./CCCircleCollider":64,"./CCCollider":65,"./CCCollisionManager":66,"./CCPolygonCollider":69}],71:[(function(t,e,i){function n(t,e){for(var i=e.constructor._executionOrder,n=e.__instanceId,r=0,o=t.length-1,s=o>>>1;r<=o;s=r+o>>>1){var a=t[s],c=a.constructor._executionOrder;if(c>i)o=s-1;else if(c<i)r=s+1;else{var h=a.__instanceId;if(h>n)o=s-1;else{if(!(h<n))return s;r=s+1}}}return~r}function r(t,e){for(var i=t.array,n=t.i+1;n<i.length;){var r=i[n];r._enabled&&r.node._activeInHierarchy?++n:(t.removeAt(n),e&&(r._objFlags&=~e))}}function o(t,e){return t.constructor._executionOrder-e.constructor._executionOrder}function s(t,e){if("function"==typeof t)return e?function(e,i){var n=e.array;for(e.i=0;e.i<n.length;++e.i){var r=n[e.i];t(r,i)}}:function(e){var i=e.array;for(e.i=0;e.i<i.length;++e.i){var n=i[e.i];t(n)}};var i="var a=it.array;for(it.i=0;it.i<a.length;++it.i){var c=a[it.i];"+t+"}";return e?Function("it","dt",i):Function("it",i)}function a(){this.startInvoker=new v(s(_)),this.updateInvoker=new m(s(f,!0)),this.lateUpdateInvoker=new m(s(p,!0)),this.scheduleInNextFrame=[],this._updating=!1}t("./platform/CCClass");var c=t("./platform/CCObject").Flags,h=t("./platform/js").array,l=c.IsStartCalled,u=c.IsOnEnableCalled,d=(c.IsEditorOnEnableCalled,cc.supportJit),_=d?"c.start();c._objFlags|="+l:function(t){t.start(),t._objFlags|=l},f=d?"c.update(dt)":function(t,e){t.update(e)},p=d?"c.lateUpdate(dt)":function(t,e){t.lateUpdate(e)},g=cc.Class({__ctor__:function(t){var e=h.MutableForwardIterator;this._zero=new e([]),this._neg=new e([]),this._pos=new e([]),this._invoke=t},statics:{stableRemoveInactive:r},add:null,remove:null,invoke:null}),v=cc.Class({extends:g,add:function(t){var e=t.constructor._executionOrder;(0===e?this._zero:e<0?this._neg:this._pos).array.push(t)},remove:function(t){var e=t.constructor._executionOrder;(0===e?this._zero:e<0?this._neg:this._pos).fastRemove(t)},cancelInactive:function(t){r(this._zero,t),r(this._neg,t),r(this._pos,t)},invoke:function(){var t=this._neg;t.array.length>0&&(t.array.sort(o),this._invoke(t),t.array.length=0),this._invoke(this._zero),this._zero.array.length=0;var e=this._pos;e.array.length>0&&(e.array.sort(o),this._invoke(e),e.array.length=0)}}),m=cc.Class({extends:g,add:function(t){var e=t.constructor._executionOrder;if(0===e)this._zero.array.push(t);else{var i=e<0?this._neg.array:this._pos.array,r=n(i,t);r<0&&i.splice(~r,0,t)}},remove:function(t){var e=t.constructor._executionOrder;if(0===e)this._zero.fastRemove(t);else{var i=e<0?this._neg:this._pos,r=n(i.array,t);r>=0&&i.removeAt(r)}},invoke:function(t){this._neg.array.length>0&&this._invoke(this._neg,t),this._invoke(this._zero,t),this._pos.array.length>0&&this._invoke(this._pos,t)}}),y=cc.Class({ctor:a,unscheduleAll:a,statics:{LifeCycleInvoker:g,OneOffInvoker:v,createInvokeImpl:s,invokeOnEnable:function(t){var e=cc.director._compScheduler,i=t.array;for(t.i=0;t.i<i.length;++t.i){var n=i[t.i];n._enabled&&(n.onEnable(),!n.node._activeInHierarchy||e._onEnabled(n))}}},_onEnabled:function(t){cc.director.getScheduler().resumeTarget(t),t._objFlags|=u,this._updating?this.scheduleInNextFrame.push(t):this._scheduleImmediate(t)},_onDisabled:function(t){cc.director.getScheduler().pauseTarget(t),t._objFlags&=~u;var e=this.scheduleInNextFrame.indexOf(t);e>=0?h.fastRemoveAt(this.scheduleInNextFrame,e):(!t.start||t._objFlags&l||this.startInvoker.remove(t),t.update&&this.updateInvoker.remove(t),t.lateUpdate&&this.lateUpdateInvoker.remove(t))},enableComp:function(t,e){if(!(t._objFlags&u)){if(t.onEnable){if(e)return void e.add(t);if(t.onEnable(),!t.node._activeInHierarchy)return}this._onEnabled(t)}},disableComp:function(t){t._objFlags&u&&(t.onDisable&&t.onDisable(),this._onDisabled(t))},_scheduleImmediate:function(t){!t.start||t._objFlags&l||this.startInvoker.add(t),t.update&&this.updateInvoker.add(t),t.lateUpdate&&this.lateUpdateInvoker.add(t)},_deferredSchedule:function(){for(var t=this.scheduleInNextFrame,e=0,i=t.length;e<i;e++){var n=t[e];this._scheduleImmediate(n)}t.length=0},startPhase:function(){this._updating=!0,this.scheduleInNextFrame.length>0&&this._deferredSchedule(),this.startInvoker.invoke()},updatePhase:function(t){this.updateInvoker.invoke(t)},lateUpdatePhase:function(t){this.lateUpdateInvoker.invoke(t),this._updating=!1}});e.exports=y}),{"./platform/CCClass":146,"./platform/CCObject":152,"./platform/js":167,"./utils/misc":196}],72:[(function(t,e,i){function n(t,e){return t===e||t&&e&&(t.name===e.name||t._uuid===e._uuid)}var r=t("../../animation/animation-animator"),o=t("../../animation/animation-clip"),s=cc.Class({name:"cc.Animation",extends:t("./CCComponent"),mixins:[cc.EventTarget],editor:!1,ctor:function(){this._animator=null,this._nameToState={},this._didInit=!1,this._currentClip=null,this._listeners=[]},properties:{_defaultClip:{default:null,type:o},defaultClip:{type:o,get:function(){return this._defaultClip},set:function(t){return},tooltip:!1},currentClip:{get:function(){return this._currentClip},set:function(t){this._currentClip=t},type:o,visible:!1},_clips:{default:[],type:[o],tooltip:!1,visible:!0},playOnLoad:{default:!1,tooltip:!1}},start:function(){if(this.playOnLoad&&this._defaultClip){var t=this.getAnimationState(this._defaultClip.name);this._animator.playState(t)}},onEnable:function(){this._animator&&this._animator.resume()},onDisable:function(){this._animator&&this._animator.pause()},onDestroy:function(){this.stop()},getClips:function(){return this._clips},play:function(t,e){var i=this.playAdditive(t,e);return this._animator.stopStatesExcept(i),i},playAdditive:function(t,e){this._init();var i=this.getAnimationState(t||this._defaultClip&&this._defaultClip.name);if(i){this.enabled=!0;var n=this._animator;n.isPlaying&&i.isPlaying?i.isPaused?n.resumeState(i):(n.stopState(i),n.playState(i,e)):n.playState(i,e),this.currentClip=i.clip}return i},stop:function(t){if(this._didInit)if(t){var e=this._nameToState[t];e&&this._animator.stopState(e)}else this._animator.stop()},pause:function(t){if(this._didInit)if(t){var e=this._nameToState[t];e&&this._animator.pauseState(e)}else this.enabled=!1},resume:function(t){if(this._didInit)if(t){var e=this._nameToState[t];e&&this._animator.resumeState(e)}else this.enabled=!0},setCurrentTime:function(t,e){if(this._init(),e){var i=this._nameToState[e];i&&this._animator.setStateTime(i,t)}else this._animator.setStateTime(t)},getAnimationState:function(t){this._init();var e=this._nameToState[t];return e&&!e.curveLoaded&&this._animator._reloadClip(e),e||null},addClip:function(t,e){if(t){this._init(),cc.js.array.contains(this._clips,t)||this._clips.push(t),e=e||t.name;var i=this._nameToState[e];if(i){if(i.clip===t)return i;var n=this._clips.indexOf(i.clip);-1!==n&&this._clips.splice(n,1)}var r=new cc.AnimationState(t,e);return this._nameToState[e]=r,r}cc.warnID(3900)},removeClip:function(t,e){if(t){this._init();var i;for(var n in this._nameToState)if((i=this._nameToState[n]).clip===t)break;if(t===this._defaultClip){if(!e)return void cc.warnID(3902);this._defaultClip=null}if(i&&i.isPlaying){if(!e)return void cc.warnID(3903);this.stop(i.name)}this._clips=this._clips.filter((function(e){return e!==t})),i&&delete this._nameToState[i.name]}else cc.warnID(3901)},sample:function(t){if(this._init(),t){var e=this._nameToState[t];e&&e.sample()}else this._animator.sample()},on:function(t,e,i,n){this._init();for(var r=this._listeners,o=0,s=r.length;o<s;o++){var a=r[o];if(a[0]===t&&a[1]===e&&a[2]===i&&a[3]===n)return}return this._animator.on(t,e,i,n),r.push([t,e,i,n]),e},off:function(t,e,i,n){this._init();for(var r=this._listeners,o=this._nameToState,s=r.length-1;s>=0;s--){var a=r[s];if(a[0]===t&&a[1]===e&&a[2]===i&&a[3]===n){for(var c in o)o[c].off(t,e,i,n);r.splice(s,1)}}},_init:function(){this._didInit||(this._didInit=!0,this._animator=new r(this.node,this),this._createStates())},_createStates:function(){this._nameToState={};for(var t=null,e=!1,i=0;i<this._clips.length;++i){var r=this._clips[i];r&&(t=new cc.AnimationState(r),this._nameToState[t.name]=t,n(this._defaultClip,r)&&(e=t))}this._defaultClip&&!e&&(t=new cc.AnimationState(this._defaultClip),this._nameToState[t.name]=t)}});cc.Animation=e.exports=s}),{"../../animation/animation-animator":12,"../../animation/animation-clip":13,"./CCComponent":77}],73:[(function(t,e,i){var n=cc.Class({name:"cc.AudioSource",extends:t("./CCComponent"),editor:!1,ctor:function(){this.audio=new cc.Audio},properties:{_clip:{default:"",url:cc.AudioClip},_volume:1,_mute:!1,_loop:!1,_pausedFlag:{default:!1,serializable:!1},isPlaying:{get:function(){return!!this.audio&&this.audio.getState()===cc.Audio.State.PLAYING},visible:!1},clip:{get:function(){return this._clip},set:function(t){t!==this._clip&&(this._clip=t,this.audio.stop(),this.audio.src=this._clip,this.audio.preload&&this.audio.preload())},url:cc.AudioClip,tooltip:!1,animatable:!1},volume:{get:function(){return this._volume},set:function(t){t=cc.clamp01(t),this._volume=t;var e=this.audio;return e&&!this._mute&&(e.setVolume(t),e._loaded||e.on("load",(function(){e.setVolume(t)}))),t},tooltip:!1},mute:{get:function(){return this._mute},set:function(t){return this._mute=t,this.audio&&this.audio.setVolume(t?0:this._volume),t},animatable:!1,tooltip:!1},loop:{get:function(){return this._loop},set:function(t){return this._loop=t,this.audio&&this.audio.setLoop(t),t},animatable:!1,tooltip:!1},playOnLoad:{default:!1,tooltip:!1,animatable:!1},preload:{default:!1,animatable:!1}},_pausedCallback:function(){var t=this.audio;t&&!t.paused&&(this.audio.pause(),this._pausedFlag=!0)},_restoreCallback:function(){this.audio&&(this._pausedFlag&&this.audio.resume(),this._pausedFlag=!1)},onEnable:function(){this.playOnLoad&&this.play(),this.preload&&(this.audio.src=this._clip,this.audio.preload()),cc.game.on(cc.game.EVENT_HIDE,this._pausedCallback,this),cc.game.on(cc.game.EVENT_SHOW,this._restoreCallback,this)},onDisable:function(){this.stop(),cc.game.off(cc.game.EVENT_HIDE,this._pausedCallback,this),cc.game.off(cc.game.EVENT_SHOW,this._restoreCallback,this)},onDestroy:function(){this.stop(),cc.audioEngine.uncache(this._clip)},play:function(){if(this._clip){var t=this._mute?0:this._volume,e=this.audio,i=this._loop;if(e._loaded)return e.stop(),e.setCurrentTime(0),void e.play();e.src=this._clip,e.once("load",(function(){e.setLoop(i),e.setVolume(t),e.play()})),e.preload()}},stop:function(){this.audio&&this.audio.stop()},pause:function(){this.audio&&this.audio.pause()},resume:function(){this.audio&&this.audio.resume()},rewind:function(){this.audio&&this.audio.setCurrentTime(0)},getCurrentTime:function(){var t=0;return this.audio&&(t=this.audio.getCurrentTime()),t},setCurrentTime:function(t){var e=this.audio;return e?e._loaded?(e.setCurrentTime(t),t):(e.once("load",(function(){e.setCurrentTime(t)})),t):t},getDuration:function(){var t=0;return this.audio&&(t=this.audio.getDuration()),t}});cc.AudioSource=e.exports=n}),{"./CCComponent":77}],74:[(function(t,e,i){function n(t){t.stopPropagation()}var r=["touchstart","touchmove","touchend","mousedown","mousemove","mouseup","mouseenter","mouseleave","mousewheel"],o=cc.Class({name:"cc.BlockInputEvents",extends:t("./CCComponent"),editor:{menu:"i18n:MAIN_MENU.component.ui/Block Input Events",inspector:"packages://inspector/inspectors/comps/block-input-events.js",help:"i18n:COMPONENT.help_url.block-input-events"},onEnable:function(){for(var t=0;t<r.length;t++)this.node.on(r[t],n,this)},onDisable:function(){for(var t=0;t<r.length;t++)this.node.off(r[t],n,this)}});cc.BlockInputEvents=e.exports=o}),{"./CCComponent":77}],75:[(function(t,e,i){var n=cc.Enum({NONE:0,COLOR:1,SPRITE:2,SCALE:3}),r=cc.Class({name:"cc.Button",extends:t("./CCComponent"),ctor:function(){this._resetState(),this._fromColor=null,this._toColor=null,this._time=0,this._transitionFinished=!0,this._fromScale=1,this._toScale=1,this._originalScale=1,this._sprite=null},_resetState:function(){this._pressed=!1,this._hovered=!1},editor:!1,properties:{interactable:{default:!0,tooltip:!1,notify:function(t){this._updateState(),this.interactable||this._resetState()},animatable:!1},_resizeToTarget:{animatable:!1,set:function(t){t&&this._resizeNodeToTargetNode()}},enableAutoGrayEffect:{default:!1,tooltip:!1,notify:function(){this._updateDisabledState()}},transition:{default:n.NONE,tooltip:!1,type:n,animatable:!1},normalColor:{default:cc.color(214,214,214),displayName:"Normal",tooltip:!1,notify:function(){this._updateState()}},pressedColor:{default:cc.color(211,211,211),displayName:"Pressed",tooltip:!1},hoverColor:{default:cc.Color.WHITE,displayName:"Hover",tooltip:!1},disabledColor:{default:cc.color(124,124,124),displayName:"Disabled",tooltip:!1,notify:function(){this._updateState()}},duration:{default:.1,range:[0,10],tooltip:!1},zoomScale:{default:1.2,tooltip:!1},normalSprite:{default:null,type:cc.SpriteFrame,displayName:"Normal",tooltip:!1,notify:function(){this._updateState()}},pressedSprite:{default:null,type:cc.SpriteFrame,displayName:"Pressed",tooltip:!1},hoverSprite:{default:null,type:cc.SpriteFrame,displayName:"Hover",tooltip:!1},disabledSprite:{default:null,type:cc.SpriteFrame,displayName:"Disabled",tooltip:!1,notify:function(){this._updateState()}},target:{default:null,type:cc.Node,tooltip:!1,notify:function(){this._applyTarget()}},clickEvents:{default:[],type:cc.Component.EventHandler,tooltip:!1}},statics:{Transition:n},__preload:function(){this.target||(this.target=this.node),this._applyTarget(),this._updateState()},onEnable:function(){this.normalSprite&&this.normalSprite.ensureLoadTexture(),this.hoverSprite&&this.hoverSprite.ensureLoadTexture(),this.pressedSprite&&this.pressedSprite.ensureLoadTexture(),this.disabledSprite&&this.disabledSprite.ensureLoadTexture(),this._registerEvent()},update:function(t){var e=this.target;if(!this._transitionFinished&&(this.transition===n.COLOR||this.transition===n.SCALE)){this.time+=t;var i=1;this.duration>0&&(i=this.time/this.duration),i>=1&&(i=1,this._transitionFinished=!0),this.transition===n.COLOR?e.color=this._fromColor.lerp(this._toColor,i):this.transition===n.SCALE&&(e.scale=cc.lerp(this._fromScale,this._toScale,i))}},_registerEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this),this.node.on(cc.Node.EventType.MOUSE_ENTER,this._onMouseMoveIn,this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,this._onMouseMoveOut,this)},_getTargetSprite:function(t){var e=null;return t&&(e=t.getComponent(cc.Sprite)),e},_applyTarget:function(){this._sprite=this._getTargetSprite(this.target),this.target&&(this._originalScale=this.target.scale)},_onTouchBegan:function(t){this.interactable&&this.enabledInHierarchy&&(this._pressed=!0,this._updateState(),t.stopPropagation())},_onTouchMove:function(t){if(this.interactable&&this.enabledInHierarchy&&this._pressed){var e=t.touch,i=this.node._hitTest(e.getLocation());if(this.transition===n.SCALE&&this.target)i?(this._fromScale=this._originalScale,this._toScale=this._originalScale*this.zoomScale,this._transitionFinished=!1):(this.time=0,this._transitionFinished=!0,this.target.scale=this._originalScale);else{var r;r=i?"pressed":"normal",this._applyTransition(r)}t.stopPropagation()}},_onTouchEnded:function(t){this.interactable&&this.enabledInHierarchy&&(this._pressed&&(cc.Component.EventHandler.emitEvents(this.clickEvents,t),this.node.emit("click",this)),this._pressed=!1,this._updateState(),t.stopPropagation())},_zoomUp:function(){this._fromScale=this._originalScale,this._toScale=this._originalScale*this.zoomScale,this.time=0,this._transitionFinished=!1},_zoomBack:function(){this._fromScale=this.target.scale,this._toScale=this._originalScale,this.time=0,this._transitionFinished=!1},_onTouchCancel:function(){this.interactable&&this.enabledInHierarchy&&(this._pressed=!1,this._updateState())},_onMouseMoveIn:function(){!this._pressed&&this.interactable&&this.enabledInHierarchy&&(this.transition!==n.SPRITE||this.hoverSprite)&&(this._hovered||(this._hovered=!0,this._updateState()))},_onMouseMoveOut:function(){this._hovered&&(this._hovered=!1,this._updateState())},_updateState:function(){var t=this._getButtonState();this._applyTransition(t),this._updateDisabledState()},onDisable:function(){this._hovered=!1,this._pressed=!1,this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this),this.node.off(cc.Node.EventType.MOUSE_ENTER,this._onMouseMoveIn,this),this.node.off(cc.Node.EventType.MOUSE_LEAVE,this._onMouseMoveOut,this)},_getButtonState:function(){return this.interactable?this._pressed?"pressed":this._hovered?"hover":"normal":"disabled"},_updateColorTransition:function(t){var e=this[t+"Color"],i=this.target;this._fromColor=i.color.clone(),this._toColor=e,this.time=0,this._transitionFinished=!1},_updateSpriteTransition:function(t){var e=this[t+"Sprite"];this._sprite&&e&&(this._sprite.spriteFrame=e)},_updateScaleTransition:function(t){"pressed"===t?this._zoomUp():this._zoomBack()},_applyTransition:function(t){var e=this.transition;e===n.COLOR?this._updateColorTransition(t):e===n.SPRITE?this._updateSpriteTransition(t):e===n.SCALE&&this._updateScaleTransition(t)},_resizeNodeToTargetNode:!1,_updateDisabledState:function(){this._sprite&&this._sprite._sgNode.setState(0),this.enableAutoGrayEffect&&this.transition!==n.COLOR&&(this.transition===n.SPRITE&&this.disabledSprite||this._sprite&&!this.interactable&&this._sprite._sgNode.setState(1))}});cc.Button=e.exports=r}),{"./CCComponent":77}],76:[(function(t,e,i){var n={getContentSize:function(){return cc.visibleRect},setContentSize:function(t){},_getWidth:function(){return this.getContentSize().width},_getHeight:function(){return this.getContentSize().height}},r=cc.Class({name:"cc.Canvas",extends:t("./CCComponent"),editor:!1,resetInEditor:!1,statics:{instance:null},properties:{_designResolution:cc.size(960,640),designResolution:{get:function(){return cc.size(this._designResolution)},set:function(t){this._designResolution.width=t.width,this._designResolution.height=t.height,this.applySettings()},tooltip:!1},_fitWidth:!1,_fitHeight:!0,fitHeight:{get:function(){return this._fitHeight},set:function(t){this._fitHeight!==t&&(this._fitHeight=t,this.applySettings())},tooltip:!1},fitWidth:{get:function(){return this._fitWidth},set:function(t){this._fitWidth!==t&&(this._fitWidth=t,this.applySettings())},tooltip:!1}},ctor:function(){this._thisOnResized=this.onResized.bind(this)},__preload:function(){if(r.instance)return cc.errorID(6700,this.node.name,r.instance.node.name);if(r.instance=this,this.node._sizeProvider);else this.node._sizeProvider=n;cc.director.on(cc.Director.EVENT_BEFORE_VISIT,this.alignWithScreen,this),cc.sys.isMobile?window.addEventListener("resize",this._thisOnResized):cc.eventManager.addCustomListener("canvas-resize",this._thisOnResized),this.applySettings(),this.onResized()},onDestroy:function(){this.node._sizeProvider===n&&(this.node._sizeProvider=null),cc.director.off(cc.Director.EVENT_BEFORE_VISIT,this.alignWithScreen,this),cc.sys.isMobile?window.removeEventListener("resize",this._thisOnResized):cc.eventManager.removeCustomListeners("canvas-resize",this._thisOnResized),r.instance===this&&(r.instance=null)},alignWithScreen:function(){var t,e=cc.visibleRect,i=0,n=0;!this.fitHeight&&!this.fitWidth&&(i=.5*((t=cc.view.getDesignResolutionSize()).width-e.width),n=.5*(t.height-e.height)),this.node.setPosition(.5*e.width+i,.5*e.height+n)},onResized:function(){this.alignWithScreen()},applySettings:function(){var t,e=cc.ResolutionPolicy;t=this.fitHeight&&this.fitWidth?e.SHOW_ALL:this.fitHeight||this.fitWidth?this.fitWidth?e.FIXED_WIDTH:e.FIXED_HEIGHT:e.NO_BORDER;var i=this._designResolution;cc.view.setDesignResolutionSize(i.width,i.height,t)}});cc.Canvas=e.exports=r}),{"./CCComponent":77}],77:[(function(t,e,i){var n=t("../platform/CCObject"),r=t("../platform/js"),o=new(t("../platform/id-generater"))("Comp"),s=n.Flags.IsOnEnableCalled,a=n.Flags.IsOnLoadCalled,c=cc.Class({name:"cc.Component",extends:n,ctor:function(){this.__instanceId=cc.ClassManager.getNewInstanceId(),this.__eventTargets=[]},properties:{node:{default:null,visible:!1},name:{get:function(){if(this._name)return this._name;var t=cc.js.getClassName(this),e=t.lastIndexOf(".");return e>=0&&(t=t.slice(e+1)),this.node.name+"<"+t+">"},set:function(t){this._name=t},visible:!1},_id:{default:"",serializable:!1},uuid:{get:function(){var t=this._id;return t||(t=this._id=o.getNewId()),t},visible:!1},__scriptAsset:!1,_enabled:!0,enabled:{get:function(){return this._enabled},set:function(t){if(this._enabled!==t&&(this._enabled=t,this.node._activeInHierarchy)){var e=cc.director._compScheduler;t?e.enableComp(this):e.disableComp(this)}},visible:!1},enabledInHierarchy:{get:function(){return(this._objFlags&s)>0},visible:!1},_isOnLoadCalled:{get:function(){return this._objFlags&a}}},update:null,lateUpdate:null,__preload:null,onLoad:null,start:null,onEnable:null,onDisable:null,onDestroy:null,onFocusInEditor:null,onLostFocusInEditor:null,resetInEditor:null,addComponent:function(t){return this.node.addComponent(t)},getComponent:function(t){return this.node.getComponent(t)},getComponents:function(t){return this.node.getComponents(t)},getComponentInChildren:function(t){return this.node.getComponentInChildren(t)},getComponentsInChildren:function(t){return this.node.getComponentsInChildren(t)},_getLocalBounds:null,onRestore:null,destroy:function(){this._super()&&this._enabled&&this.node._activeInHierarchy&&cc.director._compScheduler.disableComp(this)},_onPreDestroy:function(){this.unscheduleAllCallbacks();for(var t=this.__eventTargets,e=0,i=t.length;e<i;++e){var n=t[e];n&&n.targetOff(this)}t.length=0,cc.director._nodeActivator.destroyComp(this),this.node._removeComponent(this)},_instantiate:function(t){return t||(t=cc.instantiate._clone(this,this)),t.node=null,t},isRunning:function(){return this.enabledInHierarchy},schedule:function(t,e,i,n){cc.assertID(t,1619),cc.assertID(e>=0,1620),e=e||0,i=isNaN(i)?cc.macro.REPEAT_FOREVER:i,n=n||0,cc.director.getScheduler().schedule(t,this,e,i,n,!this.enabledInHierarchy)},scheduleOnce:function(t,e){this.schedule(t,0,0,e)},unschedule:function(t){t&&cc.director.getScheduler().unschedule(t,this)},unscheduleAllCallbacks:function(){cc.director.getScheduler().unscheduleAllForTarget(this)}});c._requireComponent=null,c._executionOrder=0,r.value(c,"_registerEditorProps",(function(t,e){var i=e.requireComponent;i&&(t._requireComponent=i);var n=e.executionOrder;n&&"number"==typeof n&&(t._executionOrder=n)})),c.prototype.__scriptUuid="",cc.Component=e.exports=c}),{"../platform/CCObject":152,"../platform/id-generater":163,"../platform/js":167}],78:[(function(t,e,i){cc.Component.EventHandler=cc.Class({name:"cc.ClickEvent",properties:{target:{default:null,type:cc.Node},component:{default:""},handler:{default:""},customEventData:{default:""}},statics:{emitEvents:function(t){"use strict";var e,i,n;if(arguments.length>0)for(i=0,n=(e=new Array(arguments.length-1)).length;i<n;i++)e[i]=arguments[i+1];for(i=0,n=t.length;i<n;i++){var r=t[i];r instanceof cc.Component.EventHandler&&r.emit(e)}}},emit:function(t){var e=this.target;if(cc.isValid(e)){var i=e.getComponent(this.component);if(cc.isValid(i)){var n=i[this.handler];"function"==typeof n&&(null!=this.customEventData&&""!==this.customEventData&&(t=t.slice()).push(this.customEventData),n.apply(i,t))}}}})}),{}],79:[(function(t,e,i){t("../editbox/CCSGEditBox");var n=_ccsg.EditBox.KeyboardReturnType,r=_ccsg.EditBox.InputMode,o=_ccsg.EditBox.InputFlag,s=cc.Class({name:"cc.EditBox",extends:cc._RendererUnderSG,editor:!1,properties:{_useOriginalSize:!0,_string:"",string:{tooltip:!1,get:function(){return this._sgNode.string},set:function(t){this._sgNode.string=this._string=t}},backgroundImage:{tooltip:!1,default:null,type:cc.SpriteFrame,notify:function(){var t=this._sgNode,e=t.getBackgroundSprite();this.backgroundImage?this._createBackgroundSprite().setContentSize(t.getContentSize()):e.removeFromParent()}},returnType:{default:n.DEFAULT,tooltip:!1,displayName:"KeyboardReturnType",type:n,notify:function(){this._sgNode.returnType=this.returnType}},inputFlag:{tooltip:!1,default:o.DEFAULT,type:o,notify:function(){this._sgNode.inputFlag=this.inputFlag}},inputMode:{tooltip:!1,default:r.ANY,type:r,notify:function(){this._sgNode.inputMode=this.inputMode}},fontSize:{tooltip:!1,default:20,notify:function(){this._sgNode.fontSize=this.fontSize}},lineHeight:{tooltip:!1,default:40,notify:function(){this._sgNode.setLineHeight(this.lineHeight)}},fontColor:{tooltip:!1,default:cc.Color.WHITE,notify:function(){this._sgNode.fontColor=this.fontColor}},placeholder:{tooltip:!1,default:"Enter text here...",notify:function(){this._sgNode.placeholder=this.placeholder}},placeholderFontSize:{tooltip:!1,default:20,notify:function(){this._sgNode.placeholderFontSize=this.placeholderFontSize}},placeholderFontColor:{tooltip:!1,default:cc.Color.GRAY,notify:function(){this._sgNode.placeholderFontColor=this.placeholderFontColor}},maxLength:{tooltip:!1,default:20,notify:function(){this._sgNode.maxLength=this.maxLength}},stayOnTop:{tooltip:!1,default:!1,notify:function(){this._sgNode.stayOnTop(this.stayOnTop),this._sgNode.fontSize=this.fontSize,this._sgNode.fontColor=this.fontColor}},_tabIndex:0,tabIndex:{tooltip:!1,get:function(){return this._tabIndex},set:function(t){this._tabIndex=t,this._sgNode.setTabIndex(t)}},editingDidBegan:{default:[],type:cc.Component.EventHandler},textChanged:{default:[],type:cc.Component.EventHandler},editingDidEnded:{default:[],type:cc.Component.EventHandler},editingReturn:{default:[],type:cc.Component.EventHandler}},statics:{KeyboardReturnType:n,InputFlag:o,InputMode:r},_applyCapInset:function(t){var e=this.backgroundImage;t.setInsetTop(e.insetTop),t.setInsetBottom(e.insetBottom),t.setInsetRight(e.insetRight),t.setInsetLeft(e.insetLeft)},_createSgNode:function(){return new _ccsg.EditBox(cc.size(160,40))},_createBackgroundSprite:function(){var t=this._sgNode,e=new cc.Scale9Sprite;return e.setRenderingType(cc.Scale9Sprite.RenderingType.SLICED),this.backgroundImage&&(this.backgroundImage.ensureLoadTexture(),e.setSpriteFrame(this.backgroundImage),this._applyCapInset(e)),t.initWithSizeAndBackgroundSprite(cc.size(160,40),e),e},_initSgNode:function(){var t=this._sgNode;t.createDomElementIfNeeded(),this._createBackgroundSprite(),t.setContentSize(this.node.getContentSize()),t.inputMode=this.inputMode,t.maxLength=this.maxLength,t.string=this._string,t.fontSize=this.fontSize,t.fontColor=this.fontColor,t.placeholder=this.placeholder,t.placeholderFontSize=this.placeholderFontSize,t.placeholderFontColor=this.placeholderFontColor,t.inputFlag=this.inputFlag,t.returnType=this.returnType,t.setLineHeight(this.lineHeight),t.stayOnTop(this.stayOnTop),t.setTabIndex(this.tabIndex),t.setDelegate(this)},editBoxEditingDidBegan:function(){cc.Component.EventHandler.emitEvents(this.editingDidBegan,this),this.node.emit("editing-did-began",this)},editBoxEditingDidEnded:function(){cc.Component.EventHandler.emitEvents(this.editingDidEnded,this),this.node.emit("editing-did-ended",this)},editBoxTextChanged:function(t,e){cc.Component.EventHandler.emitEvents(this.textChanged,e,this),this.node.emit("text-changed",this)},editBoxEditingReturn:function(){cc.Component.EventHandler.emitEvents(this.editingReturn,this),this.node.emit("editing-return",this)},onDestroy:function(){this._sgNode.setDelegate(null),this._super()},__preload:function(){this._super(),this._registerEvent()},_registerEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this)},_onTouchBegan:function(t){this._sgNode&&this._sgNode._onTouchBegan(t.touch),t.stopPropagation()},_onTouchEnded:function(t){this._sgNode&&this._sgNode._onTouchEnded(),t.stopPropagation()},setFocus:function(){this._sgNode&&this._sgNode.setFocus()},isFocused:function(){var t=!1;return this._sgNode&&(t=this._sgNode.isFocused()),t}});cc.EditBox=e.exports=s}),{"../editbox/CCSGEditBox":102}],80:[(function(t,e,i){t("../label/CCSGLabel"),t("../label/CCSGLabelCanvasRenderCmd"),t("../label/CCSGLabelWebGLRenderCmd");var n=cc.TextAlignment,r=cc.VerticalTextAlignment,o=_ccsg.Label.Overflow,s=cc.Class({name:"cc.Label",extends:cc._RendererUnderSG,ctor:function(){},editor:!1,_updateSgNodeString:function(){this._sgNode.setString(this.string),this._updateNodeSize()},_updateSgNodeFontSize:function(){this._sgNode&&(this._sgNode.setFontSize(this._fontSize),this._updateNodeSize())},properties:{_useOriginalSize:!0,string:{default:"Label",multiline:!0,tooltip:!1,notify:function(){this._sgNode&&this._updateSgNodeString()}},horizontalAlign:{default:n.LEFT,type:n,tooltip:!1,notify:function(){this._sgNode&&this._sgNode.setHorizontalAlign(this.horizontalAlign)},animatable:!1},verticalAlign:{default:r.TOP,type:r,tooltip:!1,notify:function(){this._sgNode&&this._sgNode.setVerticalAlign(this.verticalAlign)},animatable:!1},_actualFontSize:{default:40},actualFontSize:{displayName:"Actual Font Size",animatable:!1,readonly:!0,get:function(){return this._sgNode&&(this._actualFontSize=this._sgNode.getFontSize()),this._actualFontSize}},_fontSize:40,fontSize:{get:function(){return this._fontSize},set:function(t){this._fontSize=t,this._updateSgNodeFontSize()},tooltip:!1},fontFamily:{default:"Arial",tooltip:!1,notify:function(){this._sgNode&&this._sgNode.setFontFamily(this.fontFamily)},animatable:!1},_lineHeight:40,lineHeight:{get:function(){return this._sgNode&&(this._lineHeight=this._sgNode.getLineHeight()),this._lineHeight},set:function(t){this._lineHeight=t,this._sgNode&&(this._sgNode.setLineHeight(t),this._updateNodeSize())},tooltip:!1},overflow:{default:o.NONE,type:o,tooltip:!1,notify:function(){this._sgNode&&(this._sgNode.setOverflow(this.overflow),this._updateNodeSize())},animatable:!1},_enableWrapText:!0,enableWrapText:{get:function(){return this._sgNode&&(this._enableWrapText=this._sgNode.isWrapTextEnabled()),this._enableWrapText},set:function(t){this._enableWrapText=t,this._sgNode&&this._sgNode.enableWrapText(t)},animatable:!1,tooltip:!1},_N$file:null,font:{get:function(){return this._N$file},set:function(t){if(t||(this._isSystemFontUsed=!0),this._N$file=t,this._bmFontOriginalSize=-1,t&&this._isSystemFontUsed&&(this._isSystemFontUsed=!1),this._sgNode){"string"==typeof t&&cc.warnID(4e3);var e=this.font;e instanceof cc.BitmapFont?e.spriteFrame?this._sgNode.setFontAsset(e):(cc.warnID(4011,e.name),this._sgNode.setFontFamily("")):this._sgNode.setFontAsset(e)}t instanceof cc.BitmapFont&&(this._bmFontOriginalSize=t.fontSize)},type:cc.Font,tooltip:!1,animatable:!1},_isSystemFontUsed:!0,useSystemFont:{get:function(){return this._isSystemFontUsed},set:function(t){this._isSystemFontUsed=!!t,t&&(this.font=null,this._sgNode&&this._sgNode.setFontFamily(this.fontFamily))},animatable:!1,tooltip:!1},_bmFontOriginalSize:{displayName:"BMFont Original Size",default:-1,serializable:!1,readonly:!0,visible:!0,animatable:!1},_spacingX:0,spacingX:{get:function(){return this._spacingX},set:function(t){this._spacingX=t,this._sgNode&&(this._sgNode.setSpacingX(this.spacingX),this._updateNodeSize())}}},statics:{HorizontalAlign:n,VerticalAlign:r,Overflow:o},__preload:function(){this._super(),this._sgNode.on("load",this._updateNodeSize,this),this._updateNodeSize()},_createSgNode:function(){return null},_initSgNode:function(){var t=this.font;"string"==typeof t&&cc.warnID(4e3);var e;t instanceof cc.BitmapFont?t.spriteFrame?e=this._sgNode=_ccsg.Label.pool.get(this.string,t):(cc.warnID(4011,t.name),e=this._sgNode=_ccsg.Label.pool.get(this.string)):e=this._sgNode=_ccsg.Label.pool.get(this.string,t,null,this._fontSize),t instanceof cc.BitmapFont&&(this._bmFontOriginalSize=t.fontSize),e.setVisible(!1),e.setHorizontalAlign(this.horizontalAlign),e.setVerticalAlign(this.verticalAlign),e.setFontSize(this._fontSize),this.useSystemFont&&e.setFontFamily(this.fontFamily),e.setOverflow(this.overflow),e.enableWrapText(this._enableWrapText),e.setLineHeight(this._lineHeight),e.setString(this.string),t instanceof cc.BitmapFont&&e.setSpacingX(this.spacingX),e.setContentSize(this.node.getContentSize()),e.setColor(this.node.color)},_updateNodeSize:function(){this._sgNode&&this._sgNode.parent&&(this.overflow!==o.NONE&&this.overflow!==o.RESIZE_HEIGHT||this.node.setContentSize(this._sgNode.getContentSize()))},onDestroy:function(){var t=this._sgNode;this._super(),t&&(t.removeFromParent(!0),_ccsg.Label.pool.put(t))}});cc.Label=e.exports=s}),{"../label/CCSGLabel":123,"../label/CCSGLabelCanvasRenderCmd":124,"../label/CCSGLabelWebGLRenderCmd":125}],81:[(function(t,e,i){var n=cc.Class({name:"cc.LabelOutline",extends:t("./CCComponent"),editor:!1,ctor:function(){this._labelSGNode=null},properties:{_color:cc.color(255,255,255,255),_width:1,color:{get:function(){return this._color},set:function(t){this._color=cc.color(t),this._labelSGNode&&this._labelSGNode.setOutlineColor(cc.color(this._color))}},width:{get:function(){return this._width},set:function(t){this._width=t,this._labelSGNode&&(this._labelSGNode.setOutlineWidth(t),this._labelSGNode.setMargin(t))}}},onEnable:function(){var t=this.node.getComponent("cc.Label"),e=this._labelSGNode=t&&t._sgNode;this._labelSGNode&&(e.setOutlined(!0),e.setOutlineColor(cc.color(this._color)),e.setOutlineWidth(this._width),e.setMargin(this._width))},onDisable:function(){this._labelSGNode&&(this._labelSGNode.setOutlined(!1),this._labelSGNode.setMargin(0)),this._labelSGNode=null}});cc.LabelOutline=e.exports=n}),{"./CCComponent":77}],82:[(function(t,e,i){var n=cc.Enum({NONE:0,HORIZONTAL:1,VERTICAL:2,GRID:3}),r=cc.Enum({NONE:0,CONTAINER:1,CHILDREN:2}),o=cc.Enum({HORIZONTAL:0,VERTICAL:1}),s=cc.Enum({BOTTOM_TO_TOP:0,TOP_TO_BOTTOM:1}),a=cc.Enum({LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1}),c=cc.Class({name:"cc.Layout",extends:t("./CCComponent"),editor:!1,properties:{_layoutSize:cc.size(300,200),_layoutDirty:{default:!0,serializable:!1},_resize:r.NONE,_N$layoutType:n.NONE,type:{type:n,get:function(){return this._N$layoutType},set:function(t){this._N$layoutType=t,this._doLayoutDirty()},tooltip:!1,animatable:!1},resizeMode:{type:r,tooltip:!1,animatable:!1,get:function(){return this._resize},set:function(t){this.type===n.NONE&&t===r.CHILDREN||(this._resize=t,this._doLayoutDirty())}},cellSize:{default:cc.size(40,40),tooltip:!1,type:cc.Size,notify:function(){this._doLayoutDirty()}},startAxis:{default:o.HORIZONTAL,tooltip:!1,type:o,notify:function(){this._doLayoutDirty()},animatable:!1},_N$padding:{default:0},paddingLeft:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},paddingRight:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},paddingTop:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},paddingBottom:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},spacingX:{default:0,notify:function(){this._doLayoutDirty()},tooltip:!1},spacingY:{default:0,notify:function(){this._doLayoutDirty()},tooltip:!1},verticalDirection:{default:s.TOP_TO_BOTTOM,type:s,notify:function(){this._doLayoutDirty()},tooltip:!1,animatable:!1},horizontalDirection:{default:a.LEFT_TO_RIGHT,type:a,notify:function(){this._doLayoutDirty()},tooltip:!1,animatable:!1}},statics:{Type:n,VerticalDirection:s,HorizontalDirection:a,ResizeMode:r,AxisDirection:o},_migratePaddingData:function(){this.paddingLeft=this._N$padding,this.paddingRight=this._N$padding,this.paddingTop=this._N$padding,this.paddingBottom=this._N$padding,this._N$padding=0},onEnable:function(){this._addEventListeners(),cc.sizeEqualToSize(this.node.getContentSize(),cc.size(0,0))&&this.node.setContentSize(this._layoutSize),0!==this._N$padding&&this._migratePaddingData(),this._doLayoutDirty()},onDisable:function(){this._removeEventListeners()},_doLayoutDirty:function(){this._layoutDirty=!0},_addEventListeners:function(){cc.director.on(cc.Director.EVENT_BEFORE_VISIT,this.updateLayout,this),this.node.on("size-changed",this._resized,this),this.node.on("anchor-changed",this._doLayoutDirty,this),this.node.on("child-added",this._childAdded,this),this.node.on("child-removed",this._childRemoved,this),this.node.on("child-reorder",this._doLayoutDirty,this),this._addChildrenEventListeners()},_removeEventListeners:function(){cc.director.off(cc.Director.EVENT_BEFORE_VISIT,this.updateLayout,this),this.node.off("size-changed",this._resized,this),this.node.off("anchor-changed",this._doLayoutDirty,this),this.node.off("child-added",this._childAdded,this),this.node.off("child-removed",this._childRemoved,this),this.node.off("child-reorder",this._doLayoutDirty,this),this._removeChildrenEventListeners()},_addChildrenEventListeners:function(){this.node.children.forEach(function(t){t.on("size-changed",this._doLayoutDirty,this),t.on("position-changed",this._doLayoutDirty,this),t.on("anchor-changed",this._doLayoutDirty,this),t.on("active-in-hierarchy-changed",this._doLayoutDirty,this)}.bind(this))},_removeChildrenEventListeners:function(){this.node.children.forEach(function(t){t.off("size-changed",this._doLayoutDirty,this),t.off("position-changed",this._doLayoutDirty,this),t.off("anchor-changed",this._doLayoutDirty,this),t.off("active-in-hierarchy-changed",this._doLayoutDirty,this)}.bind(this))},_childAdded:function(t){var e=t.detail;e.on("size-changed",this._doLayoutDirty,this),e.on("position-changed",this._doLayoutDirty,this),e.on("anchor-changed",this._doLayoutDirty,this),e.on("active-in-hierarchy-changed",this._doLayoutDirty,this),this._doLayoutDirty()},_childRemoved:function(t){var e=t.detail;e.off("size-changed",this._doLayoutDirty,this),e.off("position-changed",this._doLayoutDirty,this),e.off("anchor-changed",this._doLayoutDirty,this),e.off("active-in-hierarchy-changed",this._doLayoutDirty,this),this._doLayoutDirty()},_resized:function(){this._layoutSize=this.node.getContentSize(),this._doLayoutDirty()},_doLayoutHorizontally:function(t,e,i,o){var c=this.node.getAnchorPoint(),h=this.node.children,l=1,u=this.paddingLeft,d=-c.x*t;this.horizontalDirection===a.RIGHT_TO_LEFT&&(l=-1,d=(1-c.x)*t,u=this.paddingRight);var _=d+l*u-l*this.spacingX,f=0,p=0,g=0,v=0,m=0,y=0,T=this.cellSize.width;return this.type!==n.GRID&&this.resizeMode===r.CHILDREN&&(T=(t-(this.paddingLeft+this.paddingRight)-(h.length-1)*this.spacingX)/h.length),h.forEach(function(h){if(h.activeInHierarchy){this._resize===r.CHILDREN&&(h.width=T,this.type===n.GRID&&(h.height=this.cellSize.height));var C=h.anchorX;g>p&&(p=g),h.height>=p&&(g=p,p=h.height,y=h.getAnchorPoint().y),this.horizontalDirection===a.RIGHT_TO_LEFT&&(C=1-h.anchorX),_=_+l*C*h.width+l*this.spacingX;var x=l*(1-C)*h.width;if(e){var E=_+x+l*(l>0?this.paddingRight:this.paddingLeft),S=this.horizontalDirection===a.LEFT_TO_RIGHT&&E>(1-c.x)*t,b=this.horizontalDirection===a.RIGHT_TO_LEFT&&E<-c.x*t;(S||b)&&(h.height>=p?(0===g&&(g=p),f+=g,g=p):(f+=p,g=h.height,p=0),_=d+l*(u+C*h.width),v++)}var A=i(h,f,v);t>=h.width+this.paddingLeft+this.paddingRight&&o&&h.setPosition(cc.p(_,A));var R,I=1,w=0===p?h.height:p;this.verticalDirection===s.TOP_TO_BOTTOM?(m=m||this.node._contentSize.height,(R=A+(I=-1)*(w*y+this.paddingBottom))<m&&(m=R)):(m=m||-this.node._contentSize.height,(R=A+I*(w*y+this.paddingTop))>m&&(m=R)),_+=x}}.bind(this)),m},_getVerticalBaseHeight:function(t){var e=0,i=0;return this.resizeMode===r.CONTAINER?(t.forEach((function(t){t.activeInHierarchy&&(i++,e+=t.height)})),e+=(i-1)*this.spacingY+this.paddingBottom+this.paddingTop):e=this.node.getContentSize().height,e},_doLayoutVertically:function(t,e,i,o){var c=this.node.getAnchorPoint(),h=this.node.children,l=1,u=this.paddingBottom,d=-c.y*t;this.verticalDirection===s.TOP_TO_BOTTOM&&(l=-1,d=(1-c.y)*t,u=this.paddingTop);var _=d+l*u-l*this.spacingY,f=0,p=0,g=0,v=0,m=0,y=0,T=this.cellSize.height;return this.type!==n.GRID&&this.resizeMode===r.CHILDREN&&(T=(t-(this.paddingTop+this.paddingBottom)-(h.length-1)*this.spacingY)/h.length),h.forEach(function(h){if(h.activeInHierarchy){this.resizeMode===r.CHILDREN&&(h.height=T,this.type===n.GRID&&(h.width=this.cellSize.width));var C=h.anchorY;g>p&&(p=g),h.width>=p&&(g=p,p=h.width,y=h.getAnchorPoint().x),this.verticalDirection===s.TOP_TO_BOTTOM&&(C=1-h.anchorY),_=_+l*C*h.height+l*this.spacingY;var x=l*(1-C)*h.height;if(e){var E=_+x+l*(l>0?this.paddingTop:this.paddingBottom),S=this.verticalDirection===s.BOTTOM_TO_TOP&&E>(1-c.y)*t,b=this.verticalDirection===s.TOP_TO_BOTTOM&&E<-c.y*t;(S||b)&&(h.width>=p?(0===g&&(g=p),f+=g,g=p):(f+=p,g=h.width,p=0),_=d+l*(u+C*h.height),v++)}var A=i(h,f,v);t>=h.height+(this.paddingTop+this.paddingBottom)&&o&&h.setPosition(cc.p(A,_));var R,I=1,w=0===p?h.width:p;this.horizontalDirection===a.RIGHT_TO_LEFT?(I=-1,m=m||this.node._contentSize.width,(R=A+I*(w*y+this.paddingLeft))<m&&(m=R)):(m=m||-this.node._contentSize.width,(R=A+I*(w*y+this.paddingRight))>m&&(m=R)),_+=x}}.bind(this)),m},_doLayoutBasic:function(){var t=null;if(this.node.children.forEach((function(e){e.activeInHierarchy&&(t=t?cc.rectUnion(t,e.getBoundingBoxToWorld()):e.getBoundingBoxToWorld())})),t){var e=this.node.parent.convertToNodeSpaceAR(cc.p(t.x,t.y));e=cc.pAdd(e,cc.p(-this.paddingLeft,-this.paddingBottom));var i=this.node.parent.convertToNodeSpaceAR(cc.p(t.x+t.width,t.y+t.height));i=cc.pAdd(i,cc.p(this.paddingRight,this.paddingTop));var n=cc.size(parseFloat((i.x-e.x).toFixed(2)),parseFloat((i.y-e.y).toFixed(2))),r=this.node.getPosition(),o=(r.x-e.x)/n.width,s=(r.y-e.y)/n.height,a=cc.p(parseFloat(o.toFixed(2)),parseFloat(s.toFixed(2)));this.node.setAnchorPoint(a),this.node.setContentSize(n)}},_doLayoutGridAxisHorizontal:function(t,e){var i=e.width,n=1,o=-t.y*e.height,a=this.paddingBottom;this.verticalDirection===s.TOP_TO_BOTTOM&&(n=-1,o=(1-t.y)*e.height,a=this.paddingTop);var c=function(t,e,i){return o+n*(e+t.anchorY*t.height+a+i*this.spacingY)}.bind(this),h=0;if(this.resizeMode===r.CONTAINER){var l=this._doLayoutHorizontally(i,!0,c,!1);(h=o-l)<0&&(h*=-1),o=-t.y*h,this.verticalDirection===s.TOP_TO_BOTTOM&&(n=-1,o=(1-t.y)*h)}this._doLayoutHorizontally(i,!0,c,!0),this.resizeMode===r.CONTAINER&&this.node.setContentSize(i,h)},_doLayoutGridAxisVertical:function(t,e){var i=e.height,n=1,o=-t.x*e.width,s=this.paddingLeft;this.horizontalDirection===a.RIGHT_TO_LEFT&&(n=-1,o=(1-t.x)*e.width,s=this.paddingRight);var c=function(t,e,i){return o+n*(e+t.anchorX*t.width+s+i*this.spacingX)}.bind(this),h=0;if(this.resizeMode===r.CONTAINER){var l=this._doLayoutVertically(i,!0,c,!1);(h=o-l)<0&&(h*=-1),o=-t.x*h,this.horizontalDirection===a.RIGHT_TO_LEFT&&(n=-1,o=(1-t.x)*h)}this._doLayoutVertically(i,!0,c,!0),this.resizeMode===r.CONTAINER&&this.node.setContentSize(h,i)},_doLayoutGrid:function(){var t=this.node.getAnchorPoint(),e=this.node.getContentSize();this.startAxis===o.HORIZONTAL?this._doLayoutGridAxisHorizontal(t,e):this.startAxis===o.VERTICAL&&this._doLayoutGridAxisVertical(t,e)},_getHorizontalBaseWidth:function(t){var e=0,i=0;return this.resizeMode===r.CONTAINER?(t.forEach((function(t){t.activeInHierarchy&&(i++,e+=t.width)})),e+=(i-1)*this.spacingX+this.paddingLeft+this.paddingRight):e=this.node.getContentSize().width,e},_doLayout:function(){if(this.type===n.HORIZONTAL){var t=this._getHorizontalBaseWidth(this.node.children),e=function(t){return t.y};this._doLayoutHorizontally(t,!1,e,!0),this.node.width=t}else if(this.type===n.VERTICAL){var i=this._getVerticalBaseHeight(this.node.children),o=function(t){return t.x};this._doLayoutVertically(i,!1,o,!0),this.node.height=i}else this.type===n.NONE?this.resizeMode===r.CONTAINER&&this._doLayoutBasic():this.type===n.GRID&&this._doLayoutGrid()},updateLayout:function(){this._layoutDirty&&this.node.children.length>0&&(this._doLayout(),this._layoutDirty=!1)}});Object.defineProperty(c.prototype,"padding",{get:function(){return cc.warnID(4100),this.paddingLeft},set:function(t){this._N$padding=t,this._migratePaddingData(),this._doLayoutDirty()}}),cc.Layout=e.exports=c}),{"./CCComponent":77}],83:[(function(t,e,i){t("../../clipping-nodes/CCClippingNode"),t("../../clipping-nodes/CCClippingNodeCanvasRenderCmd"),t("../../clipping-nodes/CCClippingNodeWebGLRenderCmd");var n=cc._RendererInSG,r=cc.Enum({RECT:0,ELLIPSE:1,IMAGE_STENCIL:2}),o=cc.Class({name:"cc.Mask",extends:n,editor:!1,properties:{_clippingStencil:{default:null,serializable:!1},_type:r.RECT,type:{get:function(){return this._type},set:function(t){this._type=t,this._refreshStencil()},type:r,tooltip:!1},spriteFrame:{default:null,type:cc.SpriteFrame,tooltip:!1,notify:function(){this._refreshStencil()}},alphaThreshold:{default:1,type:cc.Float,range:[0,1,.1],slide:!0,tooltip:!1,notify:function(){cc._renderType!==cc.game.RENDER_TYPE_CANVAS?this._sgNode.setAlphaThreshold(this.alphaThreshold):cc.warnID(4201)}},inverted:{default:!1,type:cc.Boolean,tooltip:!1,notify:function(){cc._renderType!==cc.game.RENDER_TYPE_CANVAS?this._sgNode.setInverted(this.inverted):cc.warnID(4202)}},_segements:64,segements:{get:function(){return this._segements},set:function(t){this._segements=cc.clampf(t,3,1e4),this._refreshStencil()},tooltip:!1},_resizeToTarget:{animatable:!1,set:function(t){t&&this._resizeNodeToTargetNode()}}},statics:{Type:r},_resizeNodeToTargetNode:!1,_initSgNode:function(){},_createSgNode:function(){return new cc.ClippingNode},_hitTest:function(t){var e=this.node.getContentSize(),i=e.width,n=e.height,o=this.node.getNodeToWorldTransform();if(this.type===r.RECT||this.type===r.IMAGE_STENCIL){var s=cc.rect(0,0,i,n);cc._rectApplyAffineTransformIn(s,o);var a=t.x-s.x,c=s.x+s.width-t.x,h=t.y-s.y,l=s.y+s.height-t.y;return a>=0&&c>=0&&l>=0&&h>=0}if(this.type===r.ELLIPSE){var u=i/2,d=n/2,_=o.a*u+o.c*d+o.tx,f=o.b*u+o.d*d+o.ty,p=t.x-_,g=t.y-f;return p*p/(u*u)+g*g/(d*d)<1}},onEnable:function(){this._super(),this.spriteFrame&&this.spriteFrame.ensureLoadTexture(),this._refreshStencil(),this.node.on("size-changed",this._refreshStencil,this),this.node.on("anchor-changed",this._refreshStencil,this)},onDisable:function(){this._super(),this.node.off("size-changed",this._refreshStencil,this),this.node.off("anchor-changed",this._refreshStencil,this)},_calculateCircle:function(t,e,i){for(var n=[],r=2*Math.PI/i,o=0;o<i;++o)n.push(cc.v2(e.x*Math.cos(r*o)+t.x,e.y*Math.sin(r*o)+t.y));return n},_refreshStencil:function(){if(this.type!==r.IMAGE_STENCIL||cc._renderType===cc.game.RENDER_TYPE_WEBGL){var t=this.node.getContentSize(),e=this.node.getAnchorPoint(),i=this._clippingStencil;if(this._type===r.IMAGE_STENCIL)i instanceof cc.Scale9Sprite&&i._spriteFrame===this.spriteFrame||((i=new cc.Scale9Sprite).setSpriteFrame(this.spriteFrame),this._sgNode.setStencil(i)),i.setContentSize(t),i.setAnchorPoint(e),this._sgNode.setAlphaThreshold(this.alphaThreshold);else{i instanceof cc.DrawNode||(i=new cc.DrawNode,this._sgNode.setStencil(i));var n=t.width,o=t.height,s=-n*e.x,a=-o*e.y,c=cc.color(255,255,255,0);if(i.clear(),this._type===r.RECT){var h=[cc.v2(s,a),cc.v2(s+n,a),cc.v2(s+n,a+o),cc.v2(s,a+o)];i.drawPoly(h,c,0,c)}else if(this._type===r.ELLIPSE){var l=cc.v2(s+n/2,a+o/2),u={x:n/2,y:o/2};i.drawPoly(this._calculateCircle(l,u,this._segements),c,0,c)}}this._sgNode.setInverted(this.inverted),this._clippingStencil=i,cc.renderer.childrenOrderDirty=!0}else cc.warnID(4200)}});cc.Mask=e.exports=o}),{"../../clipping-nodes/CCClippingNode":27,"../../clipping-nodes/CCClippingNodeCanvasRenderCmd":28,"../../clipping-nodes/CCClippingNodeWebGLRenderCmd":29}],84:[(function(t,e,i){var n=cc.Enum({Unified:0,Free:1}),r=cc.Enum({Horizontal:0,Vertical:1}),o=cc.Enum({PAGE_TURNING:0}),s=cc.Class({name:"cc.PageView",extends:cc.ScrollView,editor:!1,ctor:function(){this._curPageIdx=0,this._lastPageIdx=0,this._pages=[],this._scrollCenterOffsetX=[],this._scrollCenterOffsetY=[]},properties:{sizeMode:{default:n.Unified,type:n,tooltip:!1,notify:function(){this._syncSizeMode()}},direction:{default:r.Horizontal,type:r,tooltip:!1,notify:function(){this._syncScrollDirection()}},scrollThreshold:{default:.5,type:cc.Float,slide:!0,range:[0,1,.01],tooltip:!1},autoPageTurningThreshold:{default:100,type:cc.Float,tooltip:!1},pageTurningEventTiming:{default:.1,type:cc.Float,range:[0,1,.01],tooltip:!1},indicator:{default:null,type:cc.PageViewIndicator,tooltip:!1,notify:function(){this.indicator&&this.indicator.setPageView(this)}},pageTurningSpeed:{default:.3,type:cc.Float,tooltip:!1},pageEvents:{default:[],type:cc.Component.EventHandler,tooltip:!1}},statics:{SizeMode:n,Direction:r,EventType:o},__preload:function(){this.node.on("size-changed",this._updateAllPagesSize,this)},onEnable:function(){this._super(),this.node.on("scroll-ended-with-threshold",this._dispatchPageTurningEvent,this)},onDisable:function(){this._super(),this.node.off("scroll-ended-with-threshold",this._dispatchPageTurningEvent,this)},onLoad:function(){this._initPages(),this.indicator&&this.indicator.setPageView(this)},onDestroy:function(){this.node.off("size-changed",this._updateAllPagesSize,this)},getCurrentPageIndex:function(){return this._curPageIdx},setCurrentPageIndex:function(t){this.scrollToPage(t,!0)},getPages:function(){return this._pages},addPage:function(t){t&&-1===this._pages.indexOf(t)&&this.content&&(this.content.addChild(t),this._pages.push(t),this._updatePageView())},insertPage:function(t,e){e<0||!t||-1!==this._pages.indexOf(t)||!this.content||(e>=this._pages.length?this.addPage(t):(this._pages.splice(e,0,t),this.content.addChild(t),this._updatePageView()))},removePage:function(t){if(t&&this.content){var e=this._pages.indexOf(t);-1!==e?this.removePageAtIndex(e):cc.warnID(4300,t.name)}},removePageAtIndex:function(t){var e=this._pages;if(!(t<0||t>=e.length)){var i=e[t];i&&(this.content.removeChild(i),e.splice(t,1),this._updatePageView())}},removeAllPages:function(){if(this.content){for(var t=this._pages,e=0,i=t.length;e<i;e++)this.content.removeChild(t[e]);this._pages.length=0,this._updatePageView()}},scrollToPage:function(t,e){t<0||t>this._pages.length||(e=void 0!==e?e:.3,this._curPageIdx=t,this.scrollToOffset(this._moveOffsetValue(t),e,!0),this.indicator&&this.indicator._changedState())},getScrollEndedEventTiming:function(){return this.pageTurningEventTiming},_syncScrollDirection:function(){this.horizontal=this.direction===r.Horizontal,this.vertical=this.direction===r.Vertical},_syncSizeMode:function(){if(this.content){var t=this.content.getComponent(cc.Layout);if(t){if(0===this._pages.length)t.padding=0;else{var e=this._pages[this._pages.length-1];this.sizeMode===n.Free&&(this.direction===r.Horizontal?(t.paddingLeft=(this.node.width-this._pages[0].width)/2,t.paddingRight=(this.node.width-e.width)/2):this.direction===r.Vertical&&(t.paddingTop=(this.node.height-this._pages[0].height)/2,t.paddingBottom=(this.node.height-e.height)/2))}t.updateLayout()}}},_updatePageView:function(){var t=this._pages.length,e=this.content.getComponent(cc.Layout);e&&e.enabled&&e.updateLayout(),this._curPageIdx>=t&&(this._curPageIdx=0===t?0:t-1,this._lastPageIdx=this._curPageIdx);for(var i=0;i<t;++i)this._pages[i].setSiblingIndex(i),this.direction===r.Horizontal?this._scrollCenterOffsetX[i]=Math.abs(this.content.x+this._pages[i].x):this._scrollCenterOffsetY[i]=Math.abs(this.content.y+this._pages[i].y);this.indicator&&this.indicator._refresh()},_updateAllPagesSize:function(){if(this.sizeMode===n.Unified)for(var t=this._pages,e=this.node.getContentSize(),i=0,r=t.length;i<r;i++)t[i].setContentSize(e)},_initPages:function(){if(this.content){for(var t=this.content.children,e=0;e<t.length;++e){var i=t[e];this._pages.indexOf(i)>=0||this._pages.push(i)}this._syncScrollDirection(),this._syncSizeMode(),this._updatePageView()}},_dispatchPageTurningEvent:function(){this._lastPageIdx!==this._curPageIdx&&(this._lastPageIdx=this._curPageIdx,cc.Component.EventHandler.emitEvents(this.pageEvents,this,o.PAGE_TURNING),this.node.emit("page-turning",this))},_isScrollable:function(t,e,i){if(this.sizeMode===n.Free){var o,s;if(this.direction===r.Horizontal)return o=this._scrollCenterOffsetX[e],s=this._scrollCenterOffsetX[i],Math.abs(t.x)>=Math.abs(o-s)*this.scrollThreshold;if(this.direction===r.Vertical)return o=this._scrollCenterOffsetY[e],s=this._scrollCenterOffsetY[i],Math.abs(t.y)>=Math.abs(o-s)*this.scrollThreshold}else{if(this.direction===r.Horizontal)return Math.abs(t.x)>=this.node.width*this.scrollThreshold;if(this.direction===r.Vertical)return Math.abs(t.y)>=this.node.height*this.scrollThreshold}},_isQuicklyScrollable:function(t){if(this.direction===r.Horizontal){if(Math.abs(t.x)>this.autoPageTurningThreshold)return!0}else if(this.direction===r.Vertical&&Math.abs(t.y)>this.autoPageTurningThreshold)return!0;return!1},_moveOffsetValue:function(t){var e=cc.p(0,0);return this.sizeMode===n.Free?this.direction===r.Horizontal?e.x=this._scrollCenterOffsetX[t]:this.direction===r.Vertical&&(e.y=this._scrollCenterOffsetY[t]):this.direction===r.Horizontal?e.x=t*this.node.width:this.direction===r.Vertical&&(e.y=t*this.node.height),e},_getDragDirection:function(t){return this.direction===r.Horizontal?0===t.x?0:t.x>0?1:-1:this.direction===r.Vertical?0===t.y?0:t.y<0?1:-1:void 0},_handleReleaseLogic:function(t){var e=this._startBounceBackIfNeeded(),i=cc.pSub(this._touchBeganPosition,this._touchEndPosition);if(e){var n=this._getDragDirection(i);if(0===n)return;this._curPageIdx=n>0?this._pages.length-1:0,this.indicator&&this.indicator._changedState()}else{var r=this._curPageIdx,o=r+this._getDragDirection(i),s=this.pageTurningSpeed*Math.abs(r-o);if(o<this._pages.length){if(this._isScrollable(i,r,o))return void this.scrollToPage(o,s);var a=this._calculateTouchMoveVelocity();if(this._isQuicklyScrollable(a))return void this.scrollToPage(o,s)}this.scrollToPage(r,s)}},_onTouchBegan:function(t,e){this._touchBeganPosition=t.touch.getLocation(),this._super(t,e)},_onTouchMoved:function(t,e){this._super(t,e)},_onTouchEnded:function(t,e){this._touchEndPosition=t.touch.getLocation(),this._super(t,e)},_onTouchCancelled:function(t,e){this._touchEndPosition=t.touch.getLocation(),this._super(t,e)},_onMouseWheel:function(){}});cc.PageView=e.exports=s}),{}],85:[(function(t,e,i){var n=cc.Enum({HORIZONTAL:0,VERTICAL:1}),r=cc.Class({name:"cc.PageViewIndicator",extends:t("./CCComponent"),editor:!1,properties:{_layout:null,_pageView:null,_indicators:[],spriteFrame:{default:null,type:cc.SpriteFrame,tooltip:!1},direction:{default:n.HORIZONTAL,type:n,tooltip:!1},cellSize:{default:cc.size(20,20),tooltip:!1},spacing:{default:0,tooltip:!1}},statics:{Direction:n},onLoad:function(){this._updateLayout()},setPageView:function(t){this._pageView=t,this._refresh()},_updateLayout:function(){this._layout=this.getComponent(cc.Layout),this._layout||(this._layout=this.addComponent(cc.Layout)),this.direction===n.HORIZONTAL?(this._layout.type=cc.Layout.Type.HORIZONTAL,this._layout.spacingX=this.spacing):this.direction===n.VERTICAL&&(this._layout.type=cc.Layout.Type.VERTICAL,this._layout.spacingY=this.spacing),this._layout.resizeMode=cc.Layout.ResizeMode.CONTAINER},_createIndicator:function(){var t=new cc.Node;return t.addComponent(cc.Sprite).spriteFrame=this.spriteFrame,t.parent=this.node,t.width=this.cellSize.width,t.height=this.cellSize.height,t},_changedState:function(){var t=this._indicators;if(0!==t.length){var e=this._pageView._curPageIdx;if(!(e>=t.length)){for(var i=0;i<t.length;++i)t[i].opacity=127.5;t[e].opacity=255}}},_refresh:function(){if(this._pageView){var t=this._indicators,e=this._pageView.getPages();if(e.length!==t.length){var i=0;if(e.length>t.length)for(i=0;i<e.length;++i)t[i]||(t[i]=this._createIndicator());else for(i=t.length-e.length;i>0;--i){var n=t[i-1];this.node.removeChild(n),t.splice(i-1,1)}this._layout&&this._layout.enabledInHierarchy&&this._layout.updateLayout(),this._changedState()}}}});cc.PageViewIndicator=e.exports=r}),{"./CCComponent":77}],86:[(function(t,e,i){var n=cc.Enum({HORIZONTAL:0,VERTICAL:1,FILLED:2}),r=cc.Class({name:"cc.ProgressBar",extends:t("./CCComponent"),editor:!1,_initBarSprite:function(){if(this.barSprite){var t=this.barSprite.node;if(!t)return;var e=this.node.getContentSize(),i=this.node.getAnchorPoint(),r=t.getContentSize();t.parent===this.node&&this.node.setContentSize(r),this.barSprite.fillType===cc.Sprite.FillType.RADIAL&&(this.mode=n.FILLED);var o=t.getContentSize();if(this.mode===n.HORIZONTAL?this.totalLength=o.width:this.mode===n.VERTICAL?this.totalLength=o.height:this.totalLength=this.barSprite.fillRange,t.parent===this.node){var s=-e.width*i.x;t.setPosition(cc.p(s,0))}}},_updateBarStatus:function(){if(this.barSprite){var t=this.barSprite.node;if(!t)return;var e,i,r,o=t.getAnchorPoint(),s=t.getContentSize(),a=t.getPosition(),c=cc.p(0,.5),h=cc.clamp01(this.progress),l=this.totalLength*h;switch(this.mode){case n.HORIZONTAL:this.reverse&&(c=cc.p(1,.5)),e=cc.size(l,s.height),i=this.totalLength,r=s.height;break;case n.VERTICAL:c=this.reverse?cc.p(.5,1):cc.p(.5,0),e=cc.size(s.width,l),i=s.width,r=this.totalLength}if(this.mode===n.FILLED)this.barSprite.type!==cc.Sprite.Type.FILLED?cc.warn("ProgressBar FILLED mode only works when barSprite's Type is FILLED!"):(this.reverse&&(l*=-1),this.barSprite.fillRange=l);else if(this.barSprite.type!==cc.Sprite.Type.FILLED){var u=c.x-o.x,d=c.y-o.y,_=cc.p(i*u,r*d);t.setPosition(cc.pAdd(a,_)),t.setAnchorPoint(c),t.setContentSize(e)}else cc.warn("ProgressBar non-FILLED mode only works when barSprite's Type is non-FILLED!")}},properties:{barSprite:{default:null,type:cc.Sprite,tooltip:!1,notify:function(){this._initBarSprite()},animatable:!1},mode:{default:n.HORIZONTAL,type:n,tooltip:!1,notify:function(){if(this.barSprite){var t=this.barSprite.node;if(!t)return;var e=t.getContentSize();this.mode===n.HORIZONTAL?this.totalLength=e.width:this.mode===n.VERTICAL?this.totalLength=e.height:this.mode===n.FILLED&&(this.totalLength=this.barSprite.fillRange)}},animatable:!1},_N$totalLength:1,totalLength:{range:[0,Number.MAX_VALUE],tooltip:!1,get:function(){return this._N$totalLength},set:function(t){this.mode===n.FILLED&&(t=cc.clamp01(t)),this._N$totalLength=t,this._updateBarStatus()}},progress:{default:1,type:"Float",range:[0,1,.1],slide:!0,tooltip:!1,notify:function(){this._updateBarStatus()}},reverse:{default:!1,tooltip:!1,notify:function(){this.barSprite&&(this.barSprite.fillStart=1-this.barSprite.fillStart),this._updateBarStatus()},animatable:!1}},statics:{Mode:n}});cc.ProgressBar=e.exports=r}),{"./CCComponent":77}],87:[(function(t,e,i){var n=cc.Class({extends:t("./CCSGComponent"),name:"cc._RendererInSG",ctor:function(){var t=this._sgNode=this._createSgNode();t.setVisible(!1),this._plainNode=new _ccsg.Node},__preload:function(){this._initSgNode()},onEnable:function(){this._replaceSgNode(this._sgNode)},onDisable:function(){this._replaceSgNode(this._plainNode)},onDestroy:function(){this._removeSgNode()},_replaceSgNode:function(t){var e=this.node,i=e._sgNode;i._entity=null;var n=i.getChildren().slice();i.removeAllChildren(!1),t.getChildrenCount()>0&&t.removeAllChildren(!1);for(var r=0,o=n.length;r<o;++r)t.addChild(n[r]);var s=i.getParent();s&&(s.removeChild(i,!1),s.addChild(t),t._arrivalOrder=i._arrivalOrder,cc.renderer.childrenOrderDirty=s._reorderChildDirty=!0),e._sgNode=t,e._sgNode._entity=e,e._updateSgNode()}});cc._RendererInSG=e.exports=n}),{"./CCSGComponent":90}],88:[(function(t,e,i){var n=cc.Class({extends:t("./CCSGComponent"),name:"cc._RendererUnderSG",ctor:function(){var t=this._sgNode=this._createSgNode();t&&t.setVisible(!1)},__preload:function(){this._initSgNode(),this._registSizeProvider(),this._appendSgNode(this._sgNode)},onEnable:function(){this._sgNode&&this._sgNode.setVisible(!0)},onDisable:function(){this._sgNode&&this._sgNode.setVisible(!1)},onDestroy:function(){this.node._sizeProvider===this._sgNode&&(this.node._sizeProvider=null),this._removeSgNode()},_appendSgNode:function(t){if(t){var e=this.node;t.setColor(e._color),e._cascadeOpacityEnabled||t.setOpacity(e._opacity),t.setAnchorPoint(e._anchorPoint),t.setOpacityModifyRGB(e._opacityModifyRGB),t.setLocalZOrder(-1),e._sgNode.addChild(t)}}});cc._RendererUnderSG=e.exports=n}),{"./CCSGComponent":90}],89:[(function(t,e,i){t("../label/CCHtmlTextParser"),t("../label/CCTextUtils");var n=cc.TextAlignment,r=cc.VerticalTextAlignment,o=cc.Class({name:"cc.RichText",extends:cc._RendererUnderSG,ctor:function(){this._textArray=null,this._labelSegments=[],this._labelSegmentsCache=[],this._linesWidth=[],this._resetState(),this._updateRichTextStatus=this._updateRichText},editor:!1,properties:{string:{default:"<color=#00ff00>Rich</c><color=#0fffff>Text</color>",multiline:!0,tooltip:!1,notify:function(){this._updateRichTextStatus()}},horizontalAlign:{default:n.LEFT,type:n,tooltip:!1,animatable:!1,notify:function(t){this.horizontalAlign!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},fontSize:{default:40,tooltip:!1,notify:function(t){this.fontSize!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},font:{default:null,type:cc.TTFFont,tooltip:!1,notify:function(t){this.font!==t&&(this._layoutDirty=!0,this.font&&this._onTTFLoaded(),this._updateRichTextStatus())}},maxWidth:{default:0,tooltip:!1,notify:function(t){this.maxWidth!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},lineHeight:{default:40,tooltip:!1,notify:function(t){this.lineHeight!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},imageAtlas:{default:null,type:cc.SpriteAtlas,tooltip:!1,notify:function(t){this.imageAtlas!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}}},statics:{HorizontalAlign:n,VerticalAlign:r},onEnable:function(){this._super(),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this)},onDisable:function(){this._super(),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this)},_createSgNode:function(){var t=new _ccsg.Node;t.setCascadeOpacityEnabled(!0);var e=this;return t.setColor=function(){e._updateLabelSegmentTextAttributes()},t._setContentSize=t.setContentSize,t.setContentSize=function(){},t},_updateLabelSegmentTextAttributes:function(){this._labelSegments.forEach(function(t){this._applyTextAttribute(t)}.bind(this))},_initSgNode:function(){this._updateRichText(),this._onTTFLoaded()},_createFontLabel:function(t){return _ccsg.Label.pool.get(t,this.font,null,this.fontSize)},_getFontRawUrl:function(){return this.font instanceof cc.TTFFont?this.font.rawUrl:""},_onTTFLoaded:function(){var t=this._getFontRawUrl();if(t){var e=this;cc.CustomFontLoader.loadTTF(t,(function(){e._layoutDirty=!0,e._updateRichText()}))}},_measureText:function(t,e){var i=this,n=function(e){var n;return 0===i._labelSegmentsCache.length?(n=i._createFontLabel(e),i._labelSegmentsCache.push(n)):(n=i._labelSegmentsCache[0]).setString(e),n._styleIndex=t,i._applyTextAttribute(n),n.getContentSize().width};return e?n(e):n},_onTouchEnded:function(t){if(this.enabledInHierarchy)for(var e=this.node.getComponents(cc.Component),i=0;i<this._labelSegments.length;++i){var n=this._labelSegments[i],r=n._clickHandler;r&&this._containsTouchLocation(n,t.touch.getLocation())&&e.forEach((function(e){e.enabledInHierarchy&&e[r]&&e[r](t)}))}},_containsTouchLocation:function(t,e){var i=t.getBoundingBoxToWorld();return cc.rectContainsPoint(i,e)},_resetState:function(){var t=this._sgNode;t&&t.removeAllChildren(),this._labelSegments.length=0,this._labelSegmentsCache.length=0,this._linesWidth.length=0,this._lineOffsetX=0,this._lineCount=1,this._labelWidth=0,this._labelHeight=0,this._layoutDirty=!0},_addLabelSegment:function(t,e){var i;0===this._labelSegmentsCache.length?i=this._createFontLabel(t):(i=this._labelSegmentsCache.pop()).setString(t),i._styleIndex=e,i._lineCount=this._lineCount,this._applyTextAttribute(i),i.setAnchorPoint(0,0),this._sgNode.addChild(i),this._labelSegments.push(i);return i},_updateRichTextWithMaxWidth:function(t,e,i){var n,r=e;if(this._lineOffsetX>0&&r+this._lineOffsetX>this.maxWidth)for(var o=0;this._lineOffsetX<=this.maxWidth;){var s=this._getFirstWordLen(t,o,t.length),a=t.substr(o,s),c=this._measureText(i,a);if(!(this._lineOffsetX+c<=this.maxWidth)){if(o>0){var h=t.substr(0,o);this._addLabelSegment(h,i),t=t.substr(o,t.length),r=this._measureText(i,t)}this._updateLineInfo();break}this._lineOffsetX+=c,o+=s}if(r>this.maxWidth)for(var l=cc.TextUtils.fragmentText(t,r,this.maxWidth,this._measureText(i)),u=0;u<l.length;++u){var d=l[u],_=(n=this._addLabelSegment(d,i)).getContentSize();this._lineOffsetX+=_.width,l.length>1&&u<l.length-1&&this._updateLineInfo()}else this._lineOffsetX+=r,this._addLabelSegment(t,i)},_isLastComponentCR:function(t){return t.length-1===t.lastIndexOf("\n")},_updateLineInfo:function(){this._linesWidth.push(this._lineOffsetX),this._lineOffsetX=0,this._lineCount++},_needsUpdateTextLayout:function(t){if(this._layoutDirty||!this._textArray||!t)return!0;if(this._textArray.length!==t.length)return!0;for(var e=0;e<this._textArray.length;++e){var i=this._textArray[e],n=t[e];if(i.text!=n.text)return!0;if(i.style){if(n.style){if(i.style.size!==n.style.size||i.style.italic!==n.style.italic||i.style.isImage!==n.style.isImage)return!0;if(i.style.isImage===n.style.isImage&&i.style.src!==n.style.src)return!0}else if(i.style.size||i.style.italic||i.style.isImage)return!0}else if(n.style&&(n.style.size||n.style.italic||n.style.isImage))return!0}return!1},_onSpriteFrameLoaded:function(t,e){var i;(i=e||t.target).__sprite.setSpriteFrame(i)},_applySpriteFrame:function(t){t&&(t.textureLoaded()?this._onSpriteFrameLoaded(null,t):(t.once("load",this._onSpriteFrameLoaded,this),t.ensureLoadTexture()))},_addRichTextImageElement:function(t){var e=t.style.src,i=this.imageAtlas.getSpriteFrame(e);if(i){var n=new cc.Scale9Sprite;n.setAnchorPoint(0,0),i.__sprite=n,this._sgNode.addChild(n),this._labelSegments.push(n);var r=i.getRect(),o=1,s=r.width,a=r.height,c=t.style.imageWidth,h=t.style.imageHeight;h>0&&h<this.lineHeight?(s*=o=h/a,a*=o):(s*=o=this.lineHeight/a,a*=o),c>0&&(s=c),this.maxWidth>0?(this._lineOffsetX+s>this.maxWidth&&this._updateLineInfo(),this._lineOffsetX+=s):(this._lineOffsetX+=s,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX)),this._applySpriteFrame(i),n.setContentSize(s,a),n._lineCount=this._lineCount,t.style.event&&t.style.event.click&&(n._clickHandler=t.style.event.click)}else cc.warnID(4400)},_updateRichText:function(){if(this.enabled){var t=cc.htmlTextParser.parse(this.string);if(!this._needsUpdateTextLayout(t))return this._textArray=t,void this._updateLabelSegmentTextAttributes();this._textArray=t;var e=this._sgNode;this._resetState();for(var i,n=!1,r=0;r<this._textArray.length;++r){var o=this._textArray[r],s=o.text;if(""===s){if(o.style&&o.style.newline){this._updateLineInfo();continue}if(o.style&&o.style.isImage&&this.imageAtlas){this._addRichTextImageElement(o);continue}}for(var a=s.split("\n"),c=0;c<a.length;++c){var h=a[c];if(""!==h)if(n=!1,this.maxWidth>0){var l=this._measureText(r,h);this._updateRichTextWithMaxWidth(h,l,r),a.length>1&&c<a.length-1&&this._updateLineInfo()}else i=this._addLabelSegment(h,r).getContentSize(),this._lineOffsetX+=i.width,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX),a.length>1&&c<a.length-1&&this._updateLineInfo();else{if(this._isLastComponentCR(s)&&c==a.length-1)continue;this._updateLineInfo(),n=!0}}}n||this._linesWidth.push(this._lineOffsetX),this.maxWidth>0&&(this._labelWidth=this.maxWidth),this._labelHeight=this._lineCount*this.lineHeight,e._setContentSize(this._labelWidth,this._labelHeight),this.node.emit("size-changed"),this._updateRichTextPosition(),this._layoutDirty=!1}},_getFirstWordLen:function(t,e,i){var n=t.charAt(e);if(cc.TextUtils.isUnicodeCJK(n)||cc.TextUtils.isUnicodeSpace(n))return 1;for(var r=1,o=e+1;o<i&&(n=t.charAt(o),!cc.TextUtils.isUnicodeSpace(n)&&!cc.TextUtils.isUnicodeCJK(n));++o)r++;return r},_updateRichTextPosition:function(){for(var t=0,e=1,i=this._lineCount,n=0;n<this._labelSegments.length;++n){var r=this._labelSegments[n],o=r._lineCount;o>e&&(t=0,e=o);var s=0;switch(this.horizontalAlign){case cc.TextAlignment.LEFT:s=0;break;case cc.TextAlignment.CENTER:s=(this._labelWidth-this._linesWidth[o-1])/2;break;case cc.TextAlignment.RIGHT:s=this._labelWidth-this._linesWidth[o-1]}r.setPositionX(t+s);var a=r.getContentSize(),c=(i-o)*this.lineHeight;r instanceof cc.Scale9Sprite&&(c+=(this.lineHeight-r.getContentSize().height)/2),r.setPositionY(c),o===e&&(t+=a.width)}},_convertLiteralColorValue:function(t){var e=t.toUpperCase();return cc.Color[e]?cc.Color[e]:cc.hexToColor(t)},_applyTextAttribute:function(t){if(!(t instanceof cc.Scale9Sprite)){var e=t._styleIndex;t.setLineHeight(this.lineHeight),t.setVerticalAlign(r.CENTER);var i=null;this._textArray[e]&&(i=this._textArray[e].style),i&&i.color?t.setColor(this._convertLiteralColorValue(i.color)):t.setColor(this.node.color),i&&i.bold?t.enableBold(!0):t.enableBold(!1),i&&i.italic?t.enableItalics(!0):t.enableItalics(!1),i&&i.underline?t.enableUnderline(!0):t.enableUnderline(!1),i&&i.outline?(t.setOutlined(!0),t.setOutlineColor(this._convertLiteralColorValue(i.outline.color)),t.setOutlineWidth(i.outline.width),t.setMargin(i.outline.width)):(t.setOutlined(!1),t.setMargin(0)),i&&i.size?t.setFontSize(i.size):t.setFontSize(this.fontSize),i&&i.event&&i.event.click&&(t._clickHandler=i.event.click)}},onDestroy:function(){this._super();for(var t=0;t<this._labelSegments.length;++t)this._labelSegments[t].removeFromParent(!0),_ccsg.Label.pool.put(this._labelSegments[t]);this._resetState()}});cc.RichText=e.exports=o}),{"../label/CCHtmlTextParser":122,"../label/CCTextUtils":126}],90:[(function(t,e,i){var n=t("../utils/scene-graph-helper"),r=cc.Class({extends:t("./CCComponent"),name:"cc._SGComponent",editor:!1,properties:{_sgNode:{default:null,serializable:!1}},_createSgNode:null,_initSgNode:null,_removeSgNode:n.removeSgNode,_registSizeProvider:function(){if(this.node._sizeProvider);else this.node._sizeProvider=this._sgNode}});cc._SGComponent=e.exports=r}),{"../utils/scene-graph-helper":199,"./CCComponent":77}],91:[(function(t,e,i){var n=cc.Enum({HORIZONTAL:0,VERTICAL:1}),r=cc.Class({name:"cc.Scrollbar",extends:t("./CCComponent"),editor:!1,properties:{_scrollView:null,_touching:!1,_autoHideRemainingTime:{default:0,serializable:!1},_opacity:255,handle:{default:null,type:cc.Sprite,tooltip:!1,notify:function(){this._onScroll(cc.p(0,0))},animatable:!1},direction:{default:n.HORIZONTAL,type:n,tooltip:!1,notify:function(){this._onScroll(cc.p(0,0))},animatable:!1},enableAutoHide:{default:!0,animatable:!1,tooltip:!1},autoHideTime:{default:1,animatable:!1,tooltip:!1}},statics:{Direction:n},setTargetScrollView:function(t){this._scrollView=t},_convertToScrollViewSpace:function(t){var e=t.convertToWorldSpace(cc.p(0,0));return this._scrollView.node.convertToNodeSpace(e)},_setOpacity:function(t){this.handle&&this.node.setOpacity(t)},_onScroll:function(t){if(this._scrollView){var e=this._scrollView.content;if(e){var i=e.getContentSize(),r=this._scrollView.node.getContentSize(),o=this.node.getContentSize();if(this._conditionalDisableScrollBar(i,r))return;this.enableAutoHide&&(this._autoHideRemainingTime=this.autoHideTime,this._setOpacity(this._opacity));var s=0,a=0,c=0,h=0,l=0;this.direction===n.HORIZONTAL?(s=i.width,a=r.width,l=o.width,c=t.x,h=-this._convertToScrollViewSpace(e).x):this.direction===n.VERTICAL&&(s=i.height,a=r.height,l=o.height,c=t.y,h=-this._convertToScrollViewSpace(e).y);var u=this._calculateLength(s,a,l,c),d=this._calculatePosition(s,a,l,h,c,u);this._updateLength(u),this._updateHanlderPosition(d)}}},_updateHanlderPosition:function(t){if(this.handle){var e=this._fixupHandlerPosition();this.handle.node.setPosition(cc.pAdd(t,e))}},_fixupHandlerPosition:function(){var t=this.node.getContentSize(),e=this.node.getAnchorPoint(),i=this.handle.node.getContentSize(),r=this.handle.node.parent,o=this.node.convertToWorldSpaceAR(cc.p(-t.width*e.x,-t.height*e.y)),s=r.convertToNodeSpaceAR(o);return this.direction===n.HORIZONTAL?s=cc.pAdd(s,cc.p(0,(t.height-i.height)/2)):this.direction===n.VERTICAL&&(s=cc.pAdd(s,cc.p((t.width-i.width)/2,0))),this.handle.node.setPosition(s),s},_onTouchBegan:function(){this.enableAutoHide&&(this._touching=!0)},_conditionalDisableScrollBar:function(t,e){return t.width<=e.width&&this.direction===n.HORIZONTAL||t.height<=e.height&&this.direction===n.VERTICAL},_onTouchEnded:function(){if(this.enableAutoHide&&(this._touching=!1,!(this.autoHideTime<=0))){if(this._scrollView){var t=this._scrollView.content;if(t){var e=t.getContentSize(),i=this._scrollView.node.getContentSize();if(this._conditionalDisableScrollBar(e,i))return}}this._autoHideRemainingTime=this.autoHideTime}},_calculateLength:function(t,e,i,n){var r=t;return n&&(r+=20*(n>0?n:-n)),i*(e/r)},_calculatePosition:function(t,e,i,r,o,s){var a=t-e;o&&(a+=Math.abs(o));var c=0;a&&(c=r/a,c=cc.clamp01(c));var h=(i-s)*c;return this.direction===n.VERTICAL?cc.p(0,h):cc.p(h,0)},_updateLength:function(t){if(this.handle){var e=this.handle.node,i=e.getContentSize();e.setAnchorPoint(cc.p(0,0)),this.direction===n.HORIZONTAL?e.setContentSize(t,i.height):e.setContentSize(i.width,t)}},_processAutoHide:function(t){if(this.enableAutoHide&&!(this._autoHideRemainingTime<=0)&&!this._touching&&(this._autoHideRemainingTime-=t,this._autoHideRemainingTime<=this.autoHideTime)){this._autoHideRemainingTime=Math.max(0,this._autoHideRemainingTime);var e=this._opacity*(this._autoHideRemainingTime/this.autoHideTime);this._setOpacity(e)}},start:function(){this.enableAutoHide&&this._setOpacity(0)},hide:function(){this._autoHideRemainingTime=0,this._setOpacity(0)},show:function(){this._autoHideRemainingTime=this.autoHideTime,this._setOpacity(this._opacity)},update:function(t){this._processAutoHide(t)}});cc.Scrollbar=e.exports=r}),{"./CCComponent":77}],92:[(function(t,e,i){var n=function(t){return(t-=1)*t*t*t*t+1},r=function(){return(new Date).getMilliseconds()},o=cc.Enum({SCROLL_TO_TOP:0,SCROLL_TO_BOTTOM:1,SCROLL_TO_LEFT:2,SCROLL_TO_RIGHT:3,SCROLLING:4,BOUNCE_TOP:5,BOUNCE_BOTTOM:6,BOUNCE_LEFT:7,BOUNCE_RIGHT:8,AUTOSCROLL_ENDED:9,TOUCH_UP:10,AUTOSCROLL_ENDED_WITH_THRESHOLD:11}),s={"scroll-to-top":o.SCROLL_TO_TOP,"scroll-to-bottom":o.SCROLL_TO_BOTTOM,"scroll-to-left":o.SCROLL_TO_LEFT,"scroll-to-right":o.SCROLL_TO_RIGHT,scrolling:o.SCROLLING,"bounce-bottom":o.BOUNCE_BOTTOM,"bounce-left":o.BOUNCE_LEFT,"bounce-right":o.BOUNCE_RIGHT,"bounce-top":o.BOUNCE_TOP,"scroll-ended":o.AUTOSCROLL_ENDED,"touch-up":o.TOUCH_UP,"scroll-ended-with-threshold":o.AUTOSCROLL_ENDED_WITH_THRESHOLD},a=cc.Class({name:"cc.ScrollView",extends:t("./CCViewGroup"),editor:!1,ctor:function(){this._topBoundary=0,this._bottomBoundary=0,this._leftBoundary=0,this._rightBoundary=0,this._touchMoveDisplacements=[],this._touchMoveTimeDeltas=[],this._touchMovePreviousTimestamp=0,this._touchMoved=!1,this._autoScrolling=!1,this._autoScrollAttenuate=!1,this._autoScrollStartPosition=cc.p(0,0),this._autoScrollTargetDelta=cc.p(0,0),this._autoScrollTotalTime=0,this._autoScrollAccumulatedTime=0,this._autoScrollCurrentlyOutOfBoundary=!1,this._autoScrollBraking=!1,this._autoScrollBrakingStartPosition=cc.p(0,0),this._outOfBoundaryAmount=cc.p(0,0),this._outOfBoundaryAmountDirty=!0,this._stopMouseWheel=!1,this._mouseWheelEventElapsedTime=0,this._isScrollEndedWithThresholdEventFired=!1,this._scrollEventEmitMask=0,this._isBouncing=!1},properties:{content:{default:void 0,type:cc.Node,tooltip:!1},horizontal:{default:!0,animatable:!1,tooltip:!1},vertical:{default:!0,animatable:!1,tooltip:!1},inertia:{default:!0,tooltip:!1},brake:{default:.5,type:"Float",range:[0,1,.1],tooltip:!1},elastic:{default:!0,animatable:!1,tooltip:!1},bounceDuration:{default:1,range:[0,10],tooltip:!1},horizontalScrollBar:{default:void 0,type:cc.Scrollbar,tooltip:!1,notify:function(){this.horizontalScrollBar&&(this.horizontalScrollBar.setTargetScrollView(this),this._updateScrollBar(0))},animatable:!1},verticalScrollBar:{default:void 0,type:cc.Scrollbar,tooltip:!1,notify:function(){this.verticalScrollBar&&(this.verticalScrollBar.setTargetScrollView(this),this._updateScrollBar(0))},animatable:!1},scrollEvents:{default:[],type:cc.Component.EventHandler,tooltip:!1},cancelInnerEvents:{default:!0,animatable:!1,tooltip:!1}},statics:{EventType:o},scrollToBottom:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(0,0),applyToHorizontal:!1,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i,!0)},scrollToTop:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(0,1),applyToHorizontal:!1,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},scrollToLeft:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(0,0),applyToHorizontal:!0,applyToVertical:!1});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},scrollToRight:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(1,0),applyToHorizontal:!0,applyToVertical:!1});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},scrollToTopLeft:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(0,1),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},scrollToTopRight:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(1,1),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},scrollToBottomLeft:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(0,0),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},scrollToBottomRight:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(1,0),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},scrollToOffset:function(t,e,i){var n=this.getMaxScrollOffset(),r=cc.p(0,0);0===n.x?r.x=0:r.x=t.x/n.x,0===n.y?r.y=1:r.y=(n.y-t.y)/n.y,this.scrollTo(r,e,i)},getScrollOffset:function(){var t=this._getContentTopBoundary()-this._topBoundary,e=this._getContentLeftBoundary()-this._leftBoundary;return cc.p(e,t)},getMaxScrollOffset:function(){var t=this.node.getContentSize(),e=this.content.getContentSize(),i=e.width-t.width,n=e.height-t.height;return i=i>=0?i:0,n=n>=0?n:0,cc.p(i,n)},scrollToPercentHorizontal:function(t,e,i){var n=this._calculateMovePercentDelta({anchor:cc.p(t,0),applyToHorizontal:!0,applyToVertical:!1});e?this._startAutoScroll(n,e,!1!==i):this._moveContent(n)},scrollTo:function(t,e,i){var n=this._calculateMovePercentDelta({anchor:t,applyToHorizontal:!0,applyToVertical:!0});e?this._startAutoScroll(n,e,!1!==i):this._moveContent(n)},scrollToPercentVertical:function(t,e,i){var n=this._calculateMovePercentDelta({anchor:cc.p(0,t),applyToHorizontal:!1,applyToVertical:!0});e?this._startAutoScroll(n,e,!1!==i):this._moveContent(n)},stopAutoScroll:function(){this._autoScrolling=!1,this._autoScrollAccumulatedTime=this._autoScrollTotalTime},setContentPosition:function(t){cc.pFuzzyEqual(t,this.getContentPosition(),1e-4)||(this.content.setPosition(t),this._outOfBoundaryAmountDirty=!0)},getContentPosition:function(){return this.content.getPosition()},_registerEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this,!0),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this,!0),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this,!0),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this,!0),this.node.on(cc.Node.EventType.MOUSE_WHEEL,this._onMouseWheel,this,!0)},_unregisterEvent:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this,!0),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this,!0),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this,!0),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this,!0),this.node.off(cc.Node.EventType.MOUSE_WHEEL,this._onMouseWheel,this,!0)},_onMouseWheel:function(t,e){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(t,e)){var i=cc.p(0,0),n=-.1;this.vertical?i=cc.p(0,t.getScrollY()*n):this.horizontal&&(i=cc.p(t.getScrollY()*n,0)),this._mouseWheelEventElapsedTime=0,this._processDeltaMove(i),this._stopMouseWheel||(this._handlePressLogic(),this.schedule(this._checkMouseWheel,1/60),this._stopMouseWheel=!0),this._stopPropagationIfTargetIsMe(t)}},_checkMouseWheel:function(t){var e=this._getHowMuchOutOfBoundary();if(!cc.pFuzzyEqual(e,cc.p(0,0),1e-4))return this._processInertiaScroll(),this.unschedule(this._checkMouseWheel),void(this._stopMouseWheel=!1);this._mouseWheelEventElapsedTime+=t,this._mouseWheelEventElapsedTime>.1&&(this._onScrollBarTouchEnded(),this.unschedule(this._checkMouseWheel),this._stopMouseWheel=!1)},_calculateMovePercentDelta:function(t){var e=t.anchor,i=t.applyToHorizontal,n=t.applyToVertical;this._calculateBoundary(),e=cc.pClamp(e,cc.p(0,0),cc.p(1,1));var r=this.node.getContentSize(),o=this.content.getContentSize(),s=this._getContentBottomBoundary()-this._bottomBoundary;s=-s;var a=this._getContentLeftBoundary()-this._leftBoundary;a=-a;var c=cc.p(0,0),h=0;return i&&(h=o.width-r.width,c.x=a-h*e.x),n&&(h=o.height-r.height,c.y=s-h*e.y),c},_moveContentToTopLeft:function(t){var e=this.content.getContentSize(),i=this._getContentBottomBoundary()-this._bottomBoundary;i=-i;var n=cc.p(0,0),r=0,o=this._getContentLeftBoundary()-this._leftBoundary;o=-o,e.height<t.height?(r=e.height-t.height,n.y=i-r,this.verticalScrollBar&&this.verticalScrollBar.hide()):this.verticalScrollBar&&this.verticalScrollBar.show(),e.width<t.width?(r=e.width-t.width,n.x=o,this.horizontalScrollBar&&this.horizontalScrollBar.hide()):this.horizontalScrollBar&&this.horizontalScrollBar.show(),this._moveContent(n),this._adjustContentOutOfBoundary()},_calculateBoundary:function(){if(this.content){var t=this.content.getComponent(cc.Layout);t&&t.enabledInHierarchy&&t.updateLayout();var e=this.node.getContentSize(),i=this._convertToContentParentSpace(cc.p(0,0));this._leftBoundary=i.x,this._bottomBoundary=i.y;var n=this._convertToContentParentSpace(cc.p(e.width,e.height));this._rightBoundary=n.x,this._topBoundary=n.y,this._moveContentToTopLeft(e)}},_convertToContentParentSpace:function(t){var e=this.node.convertToWorldSpace(t);return this.content.parent.convertToNodeSpaceAR(e)},_hasNestedViewGroup:function(t,e){if(t.eventPhase===cc.Event.CAPTURING_PHASE){if(e)for(var i=0;i<e.length;++i){var n=e[i];if(this.node===n)return!!t.target.getComponent(cc.ViewGroup);if(n.getComponent(cc.ViewGroup))return!0}return!1}},_stopPropagationIfTargetIsMe:function(t){t.eventPhase===cc.Event.AT_TARGET&&t.target===this.node&&t.stopPropagation()},_onTouchBegan:function(t,e){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(t,e)){var i=t.touch;this.content&&this._handlePressLogic(i),this._touchMoved=!1,this._stopPropagationIfTargetIsMe(t)}},_onTouchMoved:function(t,e){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(t,e)){var i=t.touch;if(this.content&&this._handleMoveLogic(i),this.cancelInnerEvents){var n=cc.pSub(i.getLocation(),i.getStartLocation());if(cc.pLength(n)>7&&!this._touchMoved&&t.target!==this.node){var r=new cc.Event.EventTouch(t.getTouches(),t.bubbles);r.type=cc.Node.EventType.TOUCH_CANCEL,r.touch=t.touch,r.simulate=!0,t.target.dispatchEvent(r),this._touchMoved=!0}this._stopPropagationIfTargetIsMe(t)}}},_onTouchEnded:function(t,e){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(t,e)){this._dispatchEvent("touch-up");var i=t.touch;this.content&&this._handleReleaseLogic(i),this._touchMoved?t.stopPropagation():this._stopPropagationIfTargetIsMe(t)}},_onTouchCancelled:function(t,e){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(t,e)){if(!t.simulate){var i=t.touch;this.content&&this._handleReleaseLogic(i)}this._stopPropagationIfTargetIsMe(t)}},_processDeltaMove:function(t){this._scrollChildren(t),this._gatherTouchMove(t)},_handleMoveLogic:function(t){var e=t.getDelta();this._processDeltaMove(e)},_scrollChildren:function(t){var e,i=t=this._clampDelta(t);this.elastic&&(e=this._getHowMuchOutOfBoundary(),i.x*=0===e.x?1:.5,i.y*=0===e.y?1:.5),this.elastic||(e=this._getHowMuchOutOfBoundary(i),i=cc.pAdd(i,e));var n=-1;i.y>0?this.content.y-this.content.anchorY*this.content.height+i.y>this._bottomBoundary&&(n="scroll-to-bottom"):i.y<0?this.content.y-this.content.anchorY*this.content.height+this.content.height+i.y<=this._topBoundary&&(n="scroll-to-top"):i.x<0?this.content.x-this.content.anchorX*this.content.width+this.content.width+i.x<=this._rightBoundary&&(n="scroll-to-right"):i.x>0&&this.content.x-this.content.anchorX*this.content.width+i.x>=this._leftBoundary&&(n="scroll-to-left"),this._moveContent(i,!1),0===i.x&&0===i.y||this._dispatchEvent("scrolling"),-1!==n&&this._dispatchEvent(n)},_handlePressLogic:function(){this._autoScrolling&&this._dispatchEvent("scroll-ended"),this._autoScrolling=!1,this._isBouncing=!1,this._touchMovePreviousTimestamp=r(),this._touchMoveDisplacements.length=0,this._touchMoveTimeDeltas.length=0,this._onScrollBarTouchBegan()},_clampDelta:function(t){var e=this.content.getContentSize(),i=this.node.getContentSize();return e.width<i.width&&(t.x=0),e.height<i.height&&(t.y=0),t},_gatherTouchMove:function(t){for(t=this._clampDelta(t);this._touchMoveDisplacements.length>=5;)this._touchMoveDisplacements.shift(),this._touchMoveTimeDeltas.shift();this._touchMoveDisplacements.push(t);var e=r();this._touchMoveTimeDeltas.push((e-this._touchMovePreviousTimestamp)/1e3),this._touchMovePreviousTimestamp=e},_startBounceBackIfNeeded:function(){if(!this.elastic)return!1;var t=this._getHowMuchOutOfBoundary();if(t=this._clampDelta(t),cc.pFuzzyEqual(t,cc.p(0,0),1e-4))return!1;var e=Math.max(this.bounceDuration,0);return this._startAutoScroll(t,e,!0),this._isBouncing||(t.y>0&&this._dispatchEvent("bounce-top"),t.y<0&&this._dispatchEvent("bounce-bottom"),t.x>0&&this._dispatchEvent("bounce-right"),t.x<0&&this._dispatchEvent("bounce-left"),this._isBouncing=!0),!0},_processInertiaScroll:function(){if(!this._startBounceBackIfNeeded()&&this.inertia){var t=this._calculateTouchMoveVelocity();!cc.pFuzzyEqual(t,cc.p(0,0),1e-4)&&this.brake<1&&this._startInertiaScroll(t)}this._onScrollBarTouchEnded()},_handleReleaseLogic:function(t){var e=t.getDelta();this._gatherTouchMove(e),this._processInertiaScroll()},_isOutOfBoundary:function(){var t=this._getHowMuchOutOfBoundary();return!cc.pFuzzyEqual(t,cc.p(0,0),1e-4)},_isNecessaryAutoScrollBrake:function(){if(this._autoScrollBraking)return!0;if(this._isOutOfBoundary()){if(!this._autoScrollCurrentlyOutOfBoundary)return this._autoScrollCurrentlyOutOfBoundary=!0,this._autoScrollBraking=!0,this._autoScrollBrakingStartPosition=this.getContentPosition(),!0}else this._autoScrollCurrentlyOutOfBoundary=!1;return!1},getScrollEndedEventTiming:function(){return 1e-4},_processAutoScrolling:function(t){var e=this._isNecessaryAutoScrollBrake(),i=e?.05:1;this._autoScrollAccumulatedTime+=t*(1/i);var r=Math.min(1,this._autoScrollAccumulatedTime/this._autoScrollTotalTime);this._autoScrollAttenuate&&(r=n(r));var o=cc.pAdd(this._autoScrollStartPosition,cc.pMult(this._autoScrollTargetDelta,r)),s=Math.abs(r-1)<=1e-4;if(Math.abs(r-1)<=this.getScrollEndedEventTiming()&&!this._isScrollEndedWithThresholdEventFired&&(this._dispatchEvent("scroll-ended-with-threshold"),this._isScrollEndedWithThresholdEventFired=!0),this.elastic){var a=cc.pSub(o,this._autoScrollBrakingStartPosition);e&&(a=cc.pMult(a,i)),o=cc.pAdd(this._autoScrollBrakingStartPosition,a)}else{var c=cc.pSub(o,this.getContentPosition()),h=this._getHowMuchOutOfBoundary(c);cc.pFuzzyEqual(h,cc.p(0,0),1e-4)||(o=cc.pAdd(o,h),s=!0)}s&&(this._autoScrolling=!1);var l=cc.pSub(o,this.getContentPosition());this._moveContent(l,s),this._dispatchEvent("scrolling"),this._autoScrolling||(this._isBouncing=!1,this._dispatchEvent("scroll-ended"))},_startInertiaScroll:function(t){var e=cc.pMult(t,.7);this._startAttenuatingAutoScroll(e,t)},_calculateAttenuatedFactor:function(t){return this.brake<=0?1-this.brake:(1-this.brake)*(1/(1+14e-6*t+t*t*8e-9))},_startAttenuatingAutoScroll:function(t,e){var i=this._calculateAutoScrollTimeByInitalSpeed(cc.pLength(e)),n=cc.pNormalize(t),r=this.content.getContentSize(),o=this.node.getContentSize(),s=r.width-o.width,a=r.height-o.height,c=this._calculateAttenuatedFactor(s),h=this._calculateAttenuatedFactor(a);n=cc.p(n.x*s*(1-this.brake)*c,n.y*a*h*(1-this.brake));var l=cc.pLength(t),u=cc.pLength(n)/l;n=cc.pAdd(n,t),this.brake>0&&u>7&&(u=Math.sqrt(u),n=cc.pAdd(cc.pMult(t,u),t)),this.brake>0&&u>3&&(i*=u=3),0===this.brake&&u>1&&(i*=u),this._startAutoScroll(n,i,!0)},_calculateAutoScrollTimeByInitalSpeed:function(t){return Math.sqrt(Math.sqrt(t/5))},_startAutoScroll:function(t,e,i){var n=this._flattenVectorByDirection(t);this._autoScrolling=!0,this._autoScrollTargetDelta=n,this._autoScrollAttenuate=i,this._autoScrollStartPosition=this.getContentPosition(),this._autoScrollTotalTime=e,this._autoScrollAccumulatedTime=0,this._autoScrollBraking=!1,this._isScrollEndedWithThresholdEventFired=!1,this._autoScrollBrakingStartPosition=cc.p(0,0);var r=this._getHowMuchOutOfBoundary();if(!cc.pFuzzyEqual(r,cc.p(0,0),1e-4)){this._autoScrollCurrentlyOutOfBoundary=!0;var o=this._getHowMuchOutOfBoundary(n);(r.x*o.x>0||r.y*o.y>0)&&(this._autoScrollBraking=!0)}},_calculateTouchMoveVelocity:function(){var t=0;if((t=this._touchMoveTimeDeltas.reduce((function(t,e){return t+e}),t))<=0||t>=.5)return cc.p(0,0);var e=cc.p(0,0);return e=this._touchMoveDisplacements.reduce((function(t,e){return cc.pAdd(t,e)}),e),cc.p(e.x*(1-this.brake)/t,e.y*(1-this.brake)/t)},_flattenVectorByDirection:function(t){var e=t;return e.x=this.horizontal?e.x:0,e.y=this.vertical?e.y:0,e},_moveContent:function(t,e){var i=this._flattenVectorByDirection(t),n=cc.pAdd(this.getContentPosition(),i);this.setContentPosition(n);var r=this._getHowMuchOutOfBoundary();this._updateScrollBar(r),this.elastic&&e&&this._startBounceBackIfNeeded()},_getContentLeftBoundary:function(){return this.getContentPosition().x-this.content.getAnchorPoint().x*this.content.getContentSize().width},_getContentRightBoundary:function(){var t=this.content.getContentSize();return this._getContentLeftBoundary()+t.width},_getContentTopBoundary:function(){var t=this.content.getContentSize();return this._getContentBottomBoundary()+t.height},_getContentBottomBoundary:function(){return this.getContentPosition().y-this.content.getAnchorPoint().y*this.content.getContentSize().height},_getHowMuchOutOfBoundary:function(t){if(t=t||cc.p(0,0),cc.pFuzzyEqual(t,cc.p(0,0),1e-4)&&!this._outOfBoundaryAmountDirty)return this._outOfBoundaryAmount;var e=cc.p(0,0);return this._getContentLeftBoundary()+t.x>this._leftBoundary?e.x=this._leftBoundary-(this._getContentLeftBoundary()+t.x):this._getContentRightBoundary()+t.x<this._rightBoundary&&(e.x=this._rightBoundary-(this._getContentRightBoundary()+t.x)),this._getContentTopBoundary()+t.y<this._topBoundary?e.y=this._topBoundary-(this._getContentTopBoundary()+t.y):this._getContentBottomBoundary()+t.y>this._bottomBoundary&&(e.y=this._bottomBoundary-(this._getContentBottomBoundary()+t.y)),cc.pFuzzyEqual(t,cc.p(0,0),1e-4)&&(this._outOfBoundaryAmount=e,this._outOfBoundaryAmountDirty=!1),e=this._clampDelta(e)},_updateScrollBar:function(t){this.horizontalScrollBar&&this.horizontalScrollBar._onScroll(t),this.verticalScrollBar&&this.verticalScrollBar._onScroll(t)},_onScrollBarTouchBegan:function(){this.horizontalScrollBar&&this.horizontalScrollBar._onTouchBegan(),this.verticalScrollBar&&this.verticalScrollBar._onTouchBegan()},_onScrollBarTouchEnded:function(){this.horizontalScrollBar&&this.horizontalScrollBar._onTouchEnded(),this.verticalScrollBar&&this.verticalScrollBar._onTouchEnded()},_dispatchEvent:function(t){if("scroll-ended"===t)this._scrollEventEmitMask=0;else if("scroll-to-top"===t||"scroll-to-bottom"===t||"scroll-to-left"===t||"scroll-to-right"===t){var e=1<<s[t];if(this._scrollEventEmitMask&e)return;this._scrollEventEmitMask|=e}cc.Component.EventHandler.emitEvents(this.scrollEvents,this,s[t]),this.node.emit(t,this)},_adjustContentOutOfBoundary:function(){if(this._outOfBoundaryAmountDirty=!0,this._isOutOfBoundary()){var t=this._getHowMuchOutOfBoundary(cc.p(0,0)),e=cc.pAdd(this.getContentPosition(),t);this.content&&(this.content.setPosition(e),this._updateScrollBar(0))}},start:function(){this._calculateBoundary(),this.content&&cc.director.once(cc.Director.EVENT_AFTER_VISIT,this._adjustContentOutOfBoundary,this)},_hideScrollbar:function(){this.horizontalScrollBar&&this.horizontalScrollBar.hide(),this.verticalScrollBar&&this.verticalScrollBar.hide()},_showScrollbar:function(){this.horizontalScrollBar&&this.horizontalScrollBar.show(),this.verticalScrollBar&&this.verticalScrollBar.show()},onDisable:function(){this._unregisterEvent(),this.node.off("size-changed",this._calculateBoundary,this),this.content&&this.content.off("size-changed",this._calculateBoundary,this),this._hideScrollbar(),this.stopAutoScroll()},onEnable:function(){this._registerEvent(),this.node.on("size-changed",this._calculateBoundary,this),this.content&&this.content.on("size-changed",this._calculateBoundary,this),this._showScrollbar()},update:function(t){this._autoScrolling&&this._processAutoScrolling(t)}});cc.ScrollView=e.exports=a}),{"./CCViewGroup":98}],93:[(function(t,e,i){var n=cc.Enum({Horizontal:0,Vertical:1}),r=cc.Class({name:"cc.Slider",extends:t("./CCComponent"),editor:!1,ctor:function(){this._dragging=!1},properties:{handle:{default:null,type:cc.Button,tooltip:!1,notify:function(){}},direction:{default:n.Horizontal,type:n,tooltip:!1},progress:{default:.5,type:cc.Float,range:[0,1,.1],slide:!0,tooltip:!1,notify:function(){this._updateHandlePosition()}},slideEvents:{default:[],type:cc.Component.EventHandler,tooltip:!1}},statics:{Direction:n},__preload:function(){this._updateHandlePosition()},onEnable:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this),this.handle&&this.handle.isValid&&(this.handle.node.on(cc.Node.EventType.TOUCH_START,this._onHandleDragStart,this),this.handle.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.handle.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this))},onDisable:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this),this.handle&&this.handle.isValid&&(this.handle.node.off(cc.Node.EventType.TOUCH_START,this._onHandleDragStart,this),this.handle.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.handle.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this))},_onHandleDragStart:function(t){this._dragging=!0,t.stopPropagation()},_onTouchBegan:function(t){this.handle&&(this._dragging=!0,this._handleSliderLogic(t.touch),t.stopPropagation())},_onTouchMoved:function(t){this._dragging&&(this._handleSliderLogic(t.touch),t.stopPropagation())},_onTouchEnded:function(t){this._dragging=!1,t.stopPropagation()},_onTouchCancelled:function(t){this._dragging=!1,t.stopPropagation()},_handleSliderLogic:function(t){this._updateProgress(t),this._emitSlideEvent()},_emitSlideEvent:function(){cc.Component.EventHandler.emitEvents(this.slideEvents,this),this.node.emit("slide",this)},_updateProgress:function(t){if(this.handle){var e=null,i=0,r=this.node.convertTouchToNodeSpaceAR(t);this.direction===n.Horizontal?(e=this.node.width/2-this.handle.node.width*this.handle.node.anchorX,i=cc.clamp01((r.x+e)/(2*e),0,1)):this.direction===n.Vertical&&(e=this.node.height/2-this.handle.node.height*this.handle.node.anchorY,i=cc.clamp01((r.y+e)/(2*e),0,1)),this.progress=i}},_updateHandlePosition:function(){if(this.handle){var t;t=this.direction===n.Horizontal?cc.p(-this.node.width*this.node.anchorX+this.progress*this.node.width,0):cc.p(0,-this.node.height*this.node.anchorY+this.progress*this.node.height);var e=this.node.convertToWorldSpaceAR(t);this.handle.node.position=this.handle.node.parent.convertToNodeSpaceAR(e)}}});cc.Slider=e.exports=r}),{"./CCComponent":77}],94:[(function(t,e,i){var n=t("./CCRendererUnderSG"),r=cc.Scale9Sprite.RenderingType,o=cc.Scale9Sprite.FillType,s=cc.BlendFunc.BlendFactor,a=cc.Enum({CUSTOM:0,TRIMMED:1,RAW:2}),c=cc.Class({name:"cc.Sprite",extends:n,editor:!1,ctor:function(){this._blendFunc=new cc.BlendFunc(this._srcBlendFactor,this._dstBlendFactor)},properties:{_spriteFrame:{default:null,type:cc.SpriteFrame},_type:r.SIMPLE,_sizeMode:a.TRIMMED,_fillType:0,_fillCenter:cc.v2(0,0),_fillStart:0,_fillRange:0,_isTrimmedMode:!0,_srcBlendFactor:s.SRC_ALPHA,_dstBlendFactor:s.ONE_MINUS_SRC_ALPHA,_atlas:{default:null,type:cc.SpriteAtlas,tooltip:!1,editorOnly:!0,visible:!0,animatable:!1},spriteFrame:{get:function(){return this._spriteFrame},set:function(t,e){var i=this._spriteFrame;i!==t&&(this._spriteFrame=t,this._applySpriteFrame(i))},type:cc.SpriteFrame},type:{get:function(){return this._type},set:function(t){this._type=t,this._sgNode.setRenderingType(t)},type:r,animatable:!1,tooltip:!1},fillType:{get:function(){return this._fillType},set:function(t){this._fillType=t,this._sgNode&&this._sgNode.setFillType(t)},type:o,tooltip:!1},fillCenter:{get:function(){return this._fillCenter},set:function(t){this._fillCenter=cc.v2(t),this._sgNode&&this._sgNode.setFillCenter(this._fillCenter)},tooltip:!1},fillStart:{get:function(){return this._fillStart},set:function(t){this._fillStart=cc.clampf(t,-1,1),this._sgNode&&this._sgNode.setFillStart(t)},tooltip:!1},fillRange:{get:function(){return this._fillRange},set:function(t){this._fillRange=cc.clampf(t,-1,1),this._sgNode&&this._sgNode.setFillRange(t)},tooltip:!1},trim:{get:function(){return this._isTrimmedMode},set:function(t){this._isTrimmedMode!==t&&(this._isTrimmedMode=t,this._sgNode.enableTrimmedContentSize(t))},animatable:!1,tooltip:!1},srcBlendFactor:{get:function(){return this._srcBlendFactor},set:function(t){this._srcBlendFactor=t,this._blendFunc.src=t,this._sgNode.setBlendFunc(this._blendFunc)},animatable:!1,type:s,tooltip:!1},dstBlendFactor:{get:function(){return this._dstBlendFactor},set:function(t){this._dstBlendFactor=t,this._blendFunc.dst=t,this._sgNode.setBlendFunc(this._blendFunc)},animatable:!1,type:s,tooltip:!1},sizeMode:{get:function(){return this._sizeMode},set:function(t){this._sizeMode=t,t!==a.CUSTOM&&this._applySpriteSize()},animatable:!1,type:a,tooltip:!1}},statics:{FillType:o,Type:r,SizeMode:a},setVisible:function(t){this.enabled=t},setInsetLeft:function(t){this._sgNode.setInsetLeft(t)},getInsetLeft:function(){return this._sgNode.getInsetLeft()},setInsetTop:function(t){this._sgNode.setInsetTop(t)},getInsetTop:function(){return this._sgNode.getInsetTop()},setInsetRight:function(t){this._sgNode.setInsetRight(t)},getInsetRight:function(){return this._sgNode.getInsetRight()},setInsetBottom:function(t){this._sgNode.setInsetBottom(t)},getInsetBottom:function(){return this._sgNode.getInsetBottom()},onEnable:function(){this._sgNode&&this._spriteFrame&&this._spriteFrame.textureLoaded()&&this._sgNode.setVisible(!0)},_applyAtlas:!1,_applySpriteFrameInsets:function(){var t=this._spriteFrame,e=this._sgNode;e.setInsetTop(t.insetTop),e.setInsetBottom(t.insetBottom),e.setInsetRight(t.insetRight),e.setInsetLeft(t.insetLeft)},_applySpriteSize:function(){if(a.CUSTOM!==this._sizeMode&&this._spriteFrame)if(a.RAW===this._sizeMode){var t=this._spriteFrame.getOriginalSize();this.node.setContentSize(t)}else if(a.TRIMMED===this._sizeMode){var e=this._spriteFrame.getRect();this.node.setContentSize(cc.size(e.width,e.height))}else this.node.setContentSize(this.node.getContentSize(!0));else this.node.setContentSize(this.node.getContentSize(!0))},_onTextureLoaded:function(t){var e=this;if(e.isValid){var i=e._sgNode;i.setSpriteFrame(e._spriteFrame),e._applySpriteSize(),e.enabledInHierarchy&&!i.isVisible()&&i.setVisible(!0)}},_applySpriteFrame:function(t,e){var i=this._sgNode;t&&t.off&&t.off("load",this._onTextureLoaded,this);var n=this._spriteFrame;n?(e||this._applySpriteFrameInsets(),n.textureLoaded()?this._onTextureLoaded(null):(n.once("load",this._onTextureLoaded,this),n.ensureLoadTexture())):i.setVisible(!1)},_createSgNode:function(){return new cc.Scale9Sprite},_initSgNode:function(){var t=this._sgNode,e=0!==t.getInsetLeft()||0!==t.getInsetRight()||0!==t.getInsetTop()||0!==t.getInsetBottom();this._applySpriteFrame(null,e),t.setContentSize(this.node.getContentSize(!0)),this._applySpriteSize(),t.setRenderingType(this._type),t.setFillType(this._fillType),t.setFillCenter(this._fillCenter),t.setFillStart(this._fillStart),t.setFillRange(this._fillRange),t.enableTrimmedContentSize(this._isTrimmedMode),this._blendFunc.src=this._srcBlendFactor,this._blendFunc.dst=this._dstBlendFactor,t.setBlendFunc(this._blendFunc)},_resized:!1}),h=["insetLeft","insetTop","insetRight","insetBottom"],l={type:[null,"setRenderingType"]};t("../utils/misc").propertyDefine(c,h,l),cc.Sprite=e.exports=c}),{"../utils/misc":196,"./CCRendererUnderSG":88}],95:[(function(t,e,i){var n=cc.Enum({NONE:0,CHECKBOX:1,TEXT_ATLAS:2,SLIDER_BAR:3,LIST_VIEW:4,PAGE_VIEW:5}),r=cc.Enum({VERTICAL:0,HORIZONTAL:1}),o=cc.Enum({TOP:0,CENTER:1,BOTTOM:2}),s=cc.Enum({LEFT:0,CENTER:1,RIGHT:2}),a=cc.Class({name:"cc.StudioComponent",extends:cc.Component,editor:!1,properties:!1,statics:{ComponentType:n,ListDirection:r,VerticalAlign:o,HorizontalAlign:s}});cc.StudioComponent=e.exports=a}),{}],96:[(function(t,e,i){var n=cc.Class({name:"cc.Toggle",extends:t("./CCButton"),editor:!1,properties:{isChecked:{default:!0,tooltip:!1,notify:function(){this._updateCheckMark()}},toggleGroup:{default:null,tooltip:!1,type:cc.ToggleGroup},checkMark:{default:null,type:cc.Sprite,tooltip:!1},checkEvents:{default:[],type:cc.Component.EventHandler},_resizeToTarget:{animatable:!1,set:function(t){t&&this._resizeNodeToTargetNode()}}},__preload:function(){this._super()},onEnable:function(){this._super(),this._registerToggleEvent(),this.toggleGroup&&this.toggleGroup.enabled&&this.toggleGroup.addToggle(this)},onDisable:function(){this._super(),this._unregisterToggleEvent(),this.toggleGroup&&this.toggleGroup.enabled&&this.toggleGroup.removeToggle(this)},_updateCheckMark:function(){this.checkMark&&(this.checkMark.node.active=!!this.isChecked)},_updateDisabledState:function(){this._super(),this.checkMark&&this.checkMark._sgNode.setState(0),this.enableAutoGrayEffect&&this.checkMark&&!this.interactable&&this.checkMark._sgNode.setState(1)},_registerToggleEvent:function(){this.node.on("click",this.toggle,this)},_unregisterToggleEvent:function(){this.node.off("click",this.toggle,this)},toggle:function(t){this.toggleGroup&&this.toggleGroup.enabled&&this.isChecked&&!this.toggleGroup.allowSwitchOff||(this.isChecked=!this.isChecked,this._updateCheckMark(),this.toggleGroup&&this.toggleGroup.enabled&&this.toggleGroup.updateToggles(this),this._emitToggleEvents(t))},_emitToggleEvents:function(){this.node.emit("toggle",this),this.checkEvents&&cc.Component.EventHandler.emitEvents(this.checkEvents,this)},check:function(){this.toggleGroup&&this.toggleGroup.enabled&&this.isChecked&&!this.toggleGroup.allowSwitchOff||(this.isChecked=!0,this.toggleGroup&&this.toggleGroup.enabled&&this.toggleGroup.updateToggles(this),this._emitToggleEvents())},uncheck:function(){this.toggleGroup&&this.toggleGroup.enabled&&this.isChecked&&!this.toggleGroup.allowSwitchOff||(this.isChecked=!1,this._emitToggleEvents())}});cc.Toggle=e.exports=n}),{"./CCButton":75}],97:[(function(t,e,i){var n=cc.Class({name:"cc.ToggleGroup",extends:cc.Component,ctor:function(){this._toggleItems=[]},editor:!1,properties:{allowSwitchOff:{tooltip:!1,default:!1},toggleItems:{get:function(){return this._toggleItems}}},updateToggles:function(t){this.enabledInHierarchy&&this._toggleItems.forEach((function(e){t.isChecked&&e!==t&&e.isChecked&&e.enabled&&(e.isChecked=!1)}))},addToggle:function(t){-1===this._toggleItems.indexOf(t)&&this._toggleItems.push(t),this._allowOnlyOneToggleChecked()},removeToggle:function(t){var e=this._toggleItems.indexOf(t);e>-1&&this._toggleItems.splice(e,1),this._makeAtLeastOneToggleChecked()},_allowOnlyOneToggleChecked:function(){var t=!1;return this._toggleItems.forEach((function(e){t&&e.enabled&&(e.isChecked=!1),e.isChecked&&e.enabled&&(t=!0)})),t},_makeAtLeastOneToggleChecked:function(){this._allowOnlyOneToggleChecked()||this.allowSwitchOff||this._toggleItems.length>0&&(this._toggleItems[0].isChecked=!0)},start:function(){this._makeAtLeastOneToggleChecked()}});cc.ToggleGroup=e.exports=n}),{}],98:[(function(t,e,i){var n=cc.Class({name:"cc.ViewGroup",extends:t("./CCComponent")});cc.ViewGroup=e.exports=n}),{"./CCComponent":77}],99:[(function(t,e,i){var n=t("../base-ui/CCWidgetManager"),r=n._AlignFlags,o=r.TOP,s=r.MID,a=r.BOT,c=r.LEFT,h=r.CENTER,l=r.RIGHT,u=o|a,d=c|l,_=cc.Class({name:"cc.Widget",extends:t("./CCComponent"),editor:!1,properties:{target:{get:function(){return this._target},set:function(t){this._target=t},type:cc.Node,tooltip:!1},isAlignTop:{get:function(){return(this._alignFlags&o)>0},set:function(t){this._setAlign(o,t)},animatable:!1,tooltip:!1},isAlignVerticalCenter:{get:function(){return(this._alignFlags&s)>0},set:function(t){t?(this.isAlignTop=!1,this.isAlignBottom=!1,this._alignFlags|=s):this._alignFlags&=~s},animatable:!1,tooltip:!1},isAlignBottom:{get:function(){return(this._alignFlags&a)>0},set:function(t){this._setAlign(a,t)},animatable:!1,tooltip:!1},isAlignLeft:{get:function(){return(this._alignFlags&c)>0},set:function(t){this._setAlign(c,t)},animatable:!1,tooltip:!1},isAlignHorizontalCenter:{get:function(){return(this._alignFlags&h)>0},set:function(t){t?(this.isAlignLeft=!1,this.isAlignRight=!1,this._alignFlags|=h):this._alignFlags&=~h},animatable:!1,tooltip:!1},isAlignRight:{get:function(){return(this._alignFlags&l)>0},set:function(t){this._setAlign(l,t)},animatable:!1,tooltip:!1},isStretchWidth:{get:function(){return(this._alignFlags&d)===d},visible:!1},isStretchHeight:{get:function(){return(this._alignFlags&u)===u},visible:!1},top:{get:function(){return this._top},set:function(t){this._top=t},tooltip:!1},bottom:{get:function(){return this._bottom},set:function(t){this._bottom=t},tooltip:!1},left:{get:function(){return this._left},set:function(t){this._left=t},tooltip:!1},right:{get:function(){return this._right},set:function(t){this._right=t},tooltip:!1},horizontalCenter:{get:function(){return this._horizontalCenter},set:function(t){this._horizontalCenter=t},tooltip:!1},verticalCenter:{get:function(){return this._verticalCenter},set:function(t){this._verticalCenter=t},tooltip:!1},isAbsoluteHorizontalCenter:{get:function(){return this._isAbsHorizontalCenter},set:function(t){this._isAbsHorizontalCenter=t},animatable:!1},isAbsoluteVerticalCenter:{get:function(){return this._isAbsVerticalCenter},set:function(t){this._isAbsVerticalCenter=t},animatable:!1},isAbsoluteTop:{get:function(){return this._isAbsTop},set:function(t){this._isAbsTop=t},animatable:!1},isAbsoluteBottom:{get:function(){return this._isAbsBottom},set:function(t){this._isAbsBottom=t},animatable:!1},isAbsoluteLeft:{get:function(){return this._isAbsLeft},set:function(t){this._isAbsLeft=t},animatable:!1},isAbsoluteRight:{get:function(){return this._isAbsRight},set:function(t){this._isAbsRight=t},animatable:!1},isAlignOnce:{default:!0,tooltip:!1,displayName:"AlignOnce"},_target:null,_alignFlags:0,_left:0,_right:0,_top:0,_bottom:0,_verticalCenter:0,_horizontalCenter:0,_isAbsLeft:!0,_isAbsRight:!0,_isAbsTop:!0,_isAbsBottom:!0,_isAbsHorizontalCenter:!0,_isAbsVerticalCenter:!0,_originalWidth:0,_originalHeight:0},onEnable:function(){n.add(this)},onDisable:function(){n.remove(this)},_setAlign:function(t,e){if(e!=(this._alignFlags&t)>0){var i=(t&d)>0;e?(this._alignFlags|=t,i?(this.isAlignHorizontalCenter=!1,this.isStretchWidth&&(this._originalWidth=this.node.width)):(this.isAlignVerticalCenter=!1,this.isStretchHeight&&(this._originalHeight=this.node.height))):(i?this.isStretchWidth&&(this.node.width=this._originalWidth):this.isStretchHeight&&(this.node.height=this._originalHeight),this._alignFlags&=~t)}},updateAlignment:function(){n.updateAlignment(this.node)}});cc.Widget=e.exports=_}),{"../base-ui/CCWidgetManager":60,"./CCComponent":77}],100:[(function(t,e,i){t("./CCComponent"),t("./CCRendererInSG"),t("./CCRendererUnderSG"),t("./CCComponentEventHandler"),t("./missing-script"),e.exports=[t("./CCSprite"),t("./CCWidget"),t("./CCCanvas"),t("./CCAudioSource"),t("./CCAnimation"),t("./CCButton"),t("./CCLabel"),t("./CCProgressBar"),t("./CCMask"),t("./CCScrollBar"),t("./CCScrollView"),t("./CCPageViewIndicator"),t("./CCPageView"),t("./CCSlider"),t("./CCLayout"),t("./CCEditBox"),t("./CCWebView"),t("./CCSpriteDistortion"),t("./CCLabelOutline"),t("./CCRichText"),t("./CCToggleGroup"),t("./CCToggle"),t("./CCBlockInputEvents")]}),{"./CCAnimation":72,"./CCAudioSource":73,"./CCBlockInputEvents":74,"./CCButton":75,"./CCCanvas":76,"./CCComponent":77,"./CCComponentEventHandler":78,"./CCEditBox":79,"./CCLabel":80,"./CCLabelOutline":81,"./CCLayout":82,"./CCMask":83,"./CCPageView":84,"./CCPageViewIndicator":85,"./CCProgressBar":86,"./CCRendererInSG":87,"./CCRendererUnderSG":88,"./CCRichText":89,"./CCScrollBar":91,"./CCScrollView":92,"./CCSlider":93,"./CCSprite":94,"./CCSpriteDistortion":1,"./CCToggle":96,"./CCToggleGroup":97,"./CCWebView":1,"./CCWidget":99,"./missing-script":101}],101:[(function(t,e,i){var n=cc.js,r=t("../utils/misc").BUILTIN_CLASSID_RE,o=cc.Class({name:"cc.MissingClass",properties:{_$erialized:{default:null,visible:!1,editorOnly:!0}}}),s=cc.Class({name:"cc.MissingScript",extends:cc.Component,editor:{inspector:"packages://inspector/inspectors/comps/missing-script.js"},properties:{compiled:{default:!1,serializable:!1},_$erialized:{default:null,visible:!1,editorOnly:!0}},ctor:!1,statics:{safeFindClass:function(t,e){var i=n._getClassById(t);return i||(t?(cc.deserialize.reportMissingClass(t),s.getMissingWrapper(t,e)):null)},getMissingWrapper:function(t,e){return e.node&&(/^[0-9a-zA-Z+/]{23}$/.test(t)||r.test(t))?s:o}},onLoad:function(){cc.warnID(4600,this.node.name)}});cc._MissingScript=e.exports=s}),{"../utils/misc":196}],102:[(function(t,e,i){function n(t){var e=t.convertToWorldSpace(cc.p(0,0)),i=cc.visibleRect.height,n=.5;cc.visibleRect.width>i&&(n=.7),setTimeout((function(){if(window.scrollY<o&&e.y<i*n){var t=i*n-e.y-window.scrollY;t<35&&(t=35),t>320&&(t=320),window.scrollTo(t,t)}}),s)}function r(t){return t.charAt(0).toUpperCase()+t.slice(1)}var o=40,s=400,a=t("../platform/utils"),c=function(t){return t.replace(/(?:^|\s)\S/g,(function(t){return t.toUpperCase()}))},h=cc.Enum({DEFAULT:0,DONE:1,SEND:2,SEARCH:3,GO:4}),l=cc.Enum({ANY:0,EMAIL_ADDR:1,NUMERIC:2,PHONE_NUMBER:3,URL:4,DECIMAL:5,SINGLE_LINE:6}),u=cc.Enum({PASSWORD:0,SENSITIVE:1,INITIAL_CAPS_WORD:2,INITIAL_CAPS_SENTENCE:3,INITIAL_CAPS_ALL_CHARACTERS:4,DEFAULT:5});cc.EditBoxDelegate=cc._Class.extend({editBoxEditingDidBegan:function(t){},editBoxEditingDidEnded:function(t){},editBoxTextChanged:function(t,e){},editBoxEditingReturn:function(t){}}),_ccsg.EditBox=_ccsg.Node.extend({_backgroundSprite:null,_delegate:null,_editBoxInputMode:l.ANY,_editBoxInputFlag:u.DEFAULT,_keyboardReturnType:h.DEFAULT,_maxLength:50,_text:"",_placeholderText:"",_alwaysOnTop:!1,_placeholderFontName:"",_placeholderFontSize:14,__fullscreen:!1,__autoResize:!1,_placeholderColor:null,_className:"EditBox",ctor:function(t,e){_ccsg.Node.prototype.ctor.call(this),this._textColor=cc.Color.WHITE,this._placeholderColor=cc.Color.GRAY,this.initWithSizeAndBackgroundSprite(t,e),this._renderCmd._createLabels()},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new _ccsg.EditBox.CanvasRenderCmd(this):new _ccsg.EditBox.WebGLRenderCmd(this)},setContentSize:function(t,e){void 0!==t.width&&void 0!==t.height&&(e=t.height,t=t.width),_ccsg.Node.prototype.setContentSize.call(this,t,e),this._updateEditBoxSize(t,e)},setVisible:function(t){_ccsg.Node.prototype.setVisible.call(this,t),this._renderCmd.updateVisibility()},createDomElementIfNeeded:function(){this._renderCmd._edTxt||this._renderCmd._createDomTextArea()},setTabIndex:function(t){this._renderCmd._edTxt&&(this._renderCmd._edTxt.tabIndex=t)},getTabIndex:function(){return this._renderCmd._edTxt?this._renderCmd._edTxt.tabIndex:(cc.warnID(4700),-1)},setFocus:function(){this._renderCmd._edTxt&&this._renderCmd._edTxt.focus()},isFocused:function(){return this._renderCmd._edTxt?document.activeElement===this._renderCmd._edTxt:(cc.warnID(4700),!1)},stayOnTop:function(t){this._alwaysOnTop!==t&&(this._alwaysOnTop=t,this._renderCmd.stayOnTop(this._alwaysOnTop))},cleanup:function(){this._super(),this._renderCmd.removeDom()},_onTouchBegan:function(t){var e=t.getLocation(),i=cc.rect(0,0,this._contentSize.width,this._contentSize.height);return!!cc.rectContainsPoint(i,this.convertToNodeSpace(e))||(this._renderCmd._endEditing(),!1)},_onTouchEnded:function(){this._renderCmd._beginEditing()},_updateBackgroundSpriteSize:function(t,e){this._backgroundSprite&&this._backgroundSprite.setContentSize(t,e)},_updateEditBoxSize:function(t,e){var i="number"==typeof t.width?t.width:t,n="number"==typeof t.height?t.height:e;this._updateBackgroundSpriteSize(i,n),this._renderCmd.updateSize(i,n)},setLineHeight:function(t){this._renderCmd.setLineHeight(t)},setFont:function(t,e){this._renderCmd.setFont(t,e)},_setFont:function(t){this._renderCmd._setFont(t)},getBackgroundSprite:function(){return this._backgroundSprite},setFontName:function(t){this._renderCmd.setFontName(t)},setFontSize:function(t){this._renderCmd.setFontSize(t)},setString:function(t){t.length>=this._maxLength&&(t=t.slice(0,this._maxLength)),this._text=t,this._renderCmd.setString(t)},setFontColor:function(t){this._textColor=t,this._renderCmd.setFontColor(t)},setMaxLength:function(t){isNaN(t)||(t<0&&(t=65535),this._maxLength=t,this._renderCmd.setMaxLength(t))},getMaxLength:function(){return this._maxLength},setPlaceHolder:function(t){null!==t&&(this._renderCmd.setPlaceHolder(t),this._placeholderText=t)},setPlaceholderFont:function(t,e){this._placeholderFontName=t,this._placeholderFontSize=e,this._renderCmd._updateDOMPlaceholderFontStyle()},_setPlaceholderFont:function(t){var e=cc.LabelTTF._fontStyleRE.exec(t);e&&(this._placeholderFontName=e[2],this._placeholderFontSize=parseInt(e[1]),this._renderCmd._updateDOMPlaceholderFontStyle())},setPlaceholderFontName:function(t){this._placeholderFontName=t,this._renderCmd._updateDOMPlaceholderFontStyle()},setPlaceholderFontSize:function(t){this._placeholderFontSize=t,this._renderCmd._updateDOMPlaceholderFontStyle()},setPlaceholderFontColor:function(t){this._placeholderColor=t,this._renderCmd.setPlaceholderFontColor(t)},setInputFlag:function(t){this._editBoxInputFlag=t,this._renderCmd.setInputFlag(t)},getString:function(){return this._text},initWithSizeAndBackgroundSprite:function(t,e){return this._backgroundSprite&&this._backgroundSprite.removeFromParent(),this._backgroundSprite=e,_ccsg.Node.prototype.setContentSize.call(this,t),this._backgroundSprite&&!this._backgroundSprite.parent&&(this._backgroundSprite.setAnchorPoint(cc.p(0,0)),this.addChild(this._backgroundSprite),this._updateBackgroundSpriteSize(t.width,t.height)),this.x=0,this.y=0,!0},setDelegate:function(t){this._delegate=t},getPlaceHolder:function(){return this._placeholderText},setInputMode:function(t){if(this._editBoxInputMode!==t){var e=this.getString();this._editBoxInputMode=t,this._renderCmd.setInputMode(t),this._renderCmd.transform(),this.setString(e),this._renderCmd._updateLabelPosition(this.getContentSize())}},setReturnType:function(t){this._keyboardReturnType=t,this._renderCmd._updateDomInputType()},initWithBackgroundColor:function(t,e){this._edWidth=t.width,this.dom.style.width=this._edWidth.toString()+"px",this._edHeight=t.height,this.dom.style.height=this._edHeight.toString()+"px",this.dom.style.backgroundColor=cc.colorToHex(e)}});var d=_ccsg.EditBox.prototype;cc.defineGetterSetter(d,"font",null,d._setFont),cc.defineGetterSetter(d,"fontName",null,d.setFontName),cc.defineGetterSetter(d,"fontSize",null,d.setFontSize),cc.defineGetterSetter(d,"fontColor",null,d.setFontColor),cc.defineGetterSetter(d,"string",d.getString,d.setString),cc.defineGetterSetter(d,"maxLength",d.getMaxLength,d.setMaxLength),cc.defineGetterSetter(d,"placeholder",d.getPlaceHolder,d.setPlaceHolder),cc.defineGetterSetter(d,"placeholderFont",null,d._setPlaceholderFont),cc.defineGetterSetter(d,"placeholderFontName",null,d.setPlaceholderFontName),cc.defineGetterSetter(d,"placeholderFontSize",null,d.setPlaceholderFontSize),cc.defineGetterSetter(d,"placeholderFontColor",null,d.setPlaceholderFontColor),cc.defineGetterSetter(d,"inputFlag",null,d.setInputFlag),cc.defineGetterSetter(d,"delegate",null,d.setDelegate),cc.defineGetterSetter(d,"inputMode",null,d.setInputMode),cc.defineGetterSetter(d,"returnType",null,d.setReturnType),d=null,_ccsg.EditBox.InputMode=l,_ccsg.EditBox.InputFlag=u,_ccsg.EditBox.KeyboardReturnType=h,(function(t){t._polyfill={zoomInvalid:!1},cc.sys.OS_ANDROID!==cc.sys.os||cc.sys.browserType!==cc.sys.BROWSER_TYPE_SOUGOU&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_360||(t._polyfill.zoomInvalid=!0)})(_ccsg.EditBox),(function(t){var e=function(){}.prototype=Object.create(Object.prototype);e.updateMatrix=function(){if(this._edTxt){var e=this._node,i=cc.view._scaleX,n=cc.view._scaleY,r=cc.view._devicePixelRatio,o=this._worldTransform;i/=r,n/=r;var s=cc.game.container,a=o.a*i,c=o.b,h=o.c,l=o.d*n,u=s&&s.style.paddingLeft&&parseInt(s.style.paddingLeft),d=s&&s.style.paddingBottom&&parseInt(s.style.paddingBottom),_=o.tx*i+u,f=o.ty*n+d;t.zoomInvalid&&(this.updateSize(e._contentSize.width*a,e._contentSize.height*l),a=1,l=1);var p="matrix("+a+","+-c+","+-h+","+l+","+_+","+-f+")";this._edTxt.style.transform=p,this._edTxt.style["-webkit-transform"]=p,this._edTxt.style["transform-origin"]="0px 100% 0px",this._edTxt.style["-webkit-transform-origin"]="0px 100% 0px"}},e.updateVisibility=function(){this._edTxt&&(this._node.visible?this._edTxt.style.visibility="visible":this._edTxt.style.visibility="hidden")},e.stayOnTop=function(t){t?(this._removeLabels(),this._edTxt.style.display=""):(this._createLabels(),this._edTxt.style.display="none",this._showLabels())},e._beginEditingOnMobile=function(t){this.__orientationChanged=function(){n(t)},window.addEventListener("orientationchange",this.__orientationChanged),cc.view.isAutoFullScreenEnabled()?(this.__fullscreen=!0,cc.view.enableAutoFullScreen(!1),cc.screen.exitFullScreen()):this.__fullscreen=!1,this.__autoResize=cc.view.__resizeWithBrowserSize,cc.view.resizeWithBrowserSize(!1)},e._endEditingOnMobile=function(){if(this.__rotateScreen){cc.container.style["-webkit-transform"]="rotate(90deg)",cc.container.style.transform="rotate(90deg)";var t=cc.view,e=t._originalDesignResolutionSize.width,i=t._originalDesignResolutionSize.height;e>0&&t.setDesignResolutionSize(e,i,t._resolutionPolicy),this.__rotateScreen=!1}window.removeEventListener("orientationchange",this.__orientationChanged),window.scrollTo(0,0),this.__fullscreen&&cc.view.enableAutoFullScreen(!0),this.__autoResize&&cc.view.resizeWithBrowserSize(!0)},e._onFocusOnMobile=function(t){cc.view._isRotated?(cc.container.style["-webkit-transform"]="rotate(0deg)",cc.container.style.transform="rotate(0deg)",cc.view._isRotated=!1,cc.view.getResolutionPolicy().apply(cc.view,cc.view.getDesignResolutionSize()),cc.view._isRotated=!0,window.scrollTo(35,35),this.__rotateScreen=!0):this.__rotateScreen=!1,n(t)},e._createDomInput=function(){this.removeDom();var t=this,e=this._edTxt=document.createElement("input");return e.type="text",e.style.fontSize=this._edFontSize+"px",e.style.color="#000000",e.style.border=0,e.style.background="transparent",e.style.width="100%",e.style.height="100%",e.style.active=0,e.style.outline="medium",e.style.padding="0",e.style.textTransform="uppercase",e.style.display="none",e.style.position="absolute",e.style.bottom="0px",e.style.left="2px",e.style.className="cocosEditBox",e.addEventListener("input",(function(){var e=t._editBox;this.value.length>this.maxLength&&(this.value=this.value.slice(0,this.maxLength)),e._delegate&&e._delegate.editBoxTextChanged&&e._text!==this.value&&(e._text=this.value,t._updateDomTextCases(),e._delegate.editBoxTextChanged(e,e._text))})),e.addEventListener("keypress",(function(e){var i=t._editBox;e.keyCode===cc.KEY.enter&&(e.stopPropagation(),e.preventDefault(),""===this.value&&(this.style.fontSize=i._placeholderFontSize+"px",this.style.color=cc.colorToHex(i._placeholderColor)),i._text=this.value,t._updateDomTextCases(),t._endEditing(),i._delegate&&i._delegate.editBoxEditingReturn&&i._delegate.editBoxEditingReturn(i),cc._canvas.focus())})),e.addEventListener("focus",(function(){var e=t._editBox;this.style.fontSize=t._edFontSize+"px",this.style.color=cc.colorToHex(e._textColor),t._hiddenLabels(),cc.sys.isMobile&&t._onFocusOnMobile(e),e._delegate&&e._delegate.editBoxEditingDidBegan&&e._delegate.editBoxEditingDidBegan(e)})),e.addEventListener("blur",(function(){var e=t._editBox;e._text=this.value,t._updateDomTextCases(),e._delegate&&e._delegate.editBoxEditingDidEnded&&e._delegate.editBoxEditingDidEnded(e),""===this.value&&(this.style.fontSize=e._placeholderFontSize+"px",this.style.color=cc.colorToHex(e._placeholderColor)),t._endEditing()})),this._addDomToGameContainer(),e},e._createDomTextArea=function(){this.removeDom();var t=this,e=this._edTxt=document.createElement("textarea");return e.type="text",e.style.fontSize=this._edFontSize+"px",e.style.color="#000000",e.style.border=0,e.style.background="transparent",e.style.width="100%",e.style.height="100%",e.style.active=0,e.style.outline="medium",e.style.padding="0",e.style.resize="none",e.style.textTransform="uppercase",e.style.overflow_y="scroll",e.style.display="none",e.style.position="absolute",e.style.bottom="0px",e.style.left="2px",e.style.className="cocosEditBox",e.addEventListener("input",(function(){this.value.length>this.maxLength&&(this.value=this.value.slice(0,this.maxLength));var e=t._editBox;e._delegate&&e._delegate.editBoxTextChanged&&e._text.toLowerCase()!==this.value.toLowerCase()&&(e._text=this.value,t._updateDomTextCases(),e._delegate.editBoxTextChanged(e,e._text))})),e.addEventListener("focus",(function(){var e=t._editBox;t._hiddenLabels(),this.style.fontSize=t._edFontSize+"px",this.style.color=cc.colorToHex(e._textColor),cc.sys.isMobile&&t._onFocusOnMobile(e),e._delegate&&e._delegate.editBoxEditingDidBegan&&e._delegate.editBoxEditingDidBegan(e)})),e.addEventListener("keypress",(function(e){var i=t._editBox;e.keyCode===cc.KEY.enter&&(e.stopPropagation(),i._delegate&&i._delegate.editBoxEditingReturn&&i._delegate.editBoxEditingReturn(i))})),e.addEventListener("blur",(function(){var e=t._editBox;e._text=this.value,t._updateDomTextCases(),e._delegate&&e._delegate.editBoxEditingDidEnded&&e._delegate.editBoxEditingDidEnded(e),""===this.value&&(this.style.fontSize=e._placeholderFontSize+"px",this.style.color=cc.colorToHex(e._placeholderColor)),t._endEditing()})),this._addDomToGameContainer(),e},e._createLabels=function(){var t=this._editBox.getContentSize();this._textLabel||(this._textLabel=_ccsg.Label.pool.get(),this._textLabel.setAnchorPoint(cc.p(0,1)),this._textLabel.setOverflow(_ccsg.Label.Overflow.CLAMP),this._editBox.addChild(this._textLabel,100)),this._placeholderLabel||(this._placeholderLabel=_ccsg.Label.pool.get(),this._placeholderLabel.setAnchorPoint(cc.p(0,1)),this._placeholderLabel.setColor(cc.Color.GRAY),this._editBox.addChild(this._placeholderLabel,100)),this._updateLabelPosition(t)},e._removeLabels=function(){this._textLabel&&(this._editBox.removeChild(this._textLabel),this._textLabel=null)},e._updateLabelPosition=function(t){if(this._textLabel&&this._placeholderLabel){var e=cc.size(t.width-2,t.height);this._textLabel.setContentSize(e),this._placeholderLabel.setLineHeight(t.height);var i=this._placeholderLabel.getContentSize();this._editBox._editBoxInputMode===l.ANY?(this._textLabel.setPosition(2,t.height),this._placeholderLabel.setPosition(2,t.height),this._placeholderLabel.setVerticalAlign(cc.VerticalTextAlignment.TOP),this._textLabel.setVerticalAlign(cc.VerticalTextAlignment.TOP),this._textLabel.enableWrapText(!0)):(this._textLabel.enableWrapText(!1),this._textLabel.setPosition(2,t.height),this._placeholderLabel.setPosition(2,(t.height+i.height)/2),this._placeholderLabel.setVerticalAlign(cc.VerticalTextAlignment.CENTER),this._textLabel.setVerticalAlign(cc.VerticalTextAlignment.CENTER))}},e.setLineHeight=function(t){this._textLabel&&this._textLabel.setLineHeight(t)},e._hiddenLabels=function(){this._textLabel&&this._textLabel.setVisible(!1),this._placeholderLabel&&this._placeholderLabel.setVisible(!1)},e._updateDomTextCases=function(){var t=this._editBox._editBoxInputFlag;t===u.INITIAL_CAPS_ALL_CHARACTERS?this._editBox._text=this._editBox._text.toUpperCase():t===u.INITIAL_CAPS_WORD?this._editBox._text=c(this._editBox._text):t===u.INITIAL_CAPS_SENTENCE&&(this._editBox._text=r(this._editBox._text))},e._updateLabelStringStyle=function(){if("password"===this._edTxt.type){for(var t="",e=this._editBox._text.length,i=0;i<e;++i)t+="●";this._textLabel&&this._textLabel.setString(t)}else this._updateDomTextCases(),this._textLabel&&this._textLabel.setString(this._editBox._text)},e._showLabels=function(){this._hiddenLabels(),""===this._edTxt.value?this._placeholderLabel&&(this._placeholderLabel.setVisible(!0),this._placeholderLabel.setString(this._editBox._placeholderText)):this._textLabel&&(this._textLabel.setVisible(!0),this._textLabel.setString(this._editBox._text)),this._updateLabelStringStyle()},e._beginEditing=function(){this._editBox._alwaysOnTop||"none"===this._edTxt.style.display&&(this._edTxt.style.display="",cc.sys.browserType===cc.sys.BROWSER_TYPE_UC?setTimeout(function(){this._edTxt.focus()}.bind(this),s):this._edTxt.focus()),cc.sys.isMobile&&!this._editingMode&&this._beginEditingOnMobile(this._editBox),this._editingMode=!0},e._endEditing=function(){if(this._editBox._alwaysOnTop||(this._edTxt.style.display="none"),this._showLabels(),cc.sys.isMobile&&this._editingMode){var t=this;setTimeout((function(){t._endEditingOnMobile()}),s)}this._editingMode=!1},e._setFont=function(t){var e=cc.LabelTTF._fontStyleRE.exec(t),i=e[2],n=parseInt(e[1]);e&&this.setFont(i,n)},e.setFont=function(t,e){this._edFontName=t||this._edFontName,this._edFontSize=e||this._edFontSize,this._updateDOMFontStyle()},e.setFontName=function(t){this._edFontName=t||this._edFontName,this._updateDOMFontStyle()},e.setFontSize=function(t){this._edFontSize=t||this._edFontSize,this._updateDOMFontStyle()},e.setFontColor=function(t){this._edTxt&&(this._edTxt.value!==this._editBox._placeholderText&&(this._edTxt.style.color=cc.colorToHex(t)),this._textLabel&&this._textLabel.setColor(t))},e.setPlaceHolder=function(t){this._placeholderLabel.setString(t)},e.setMaxLength=function(t){this._edTxt&&(this._edTxt.maxLength=t)},e._updateDOMPlaceholderFontStyle=function(){this._placeholderLabel.setFontFamily(this._editBox._placeholderFontName),this._placeholderLabel.setFontSize(this._editBox._placeholderFontSize)},e.setPlaceholderFontColor=function(t){this._placeholderLabel.setColor(t)},e._updateDomInputType=function(){var t=this._editBox._editBoxInputMode;t===l.EMAIL_ADDR?this._edTxt.type="email":t===l.NUMERIC||t===l.DECIMAL?this._edTxt.type="number":t===l.PHONE_NUMBER?(this._edTxt.type="number",this._edTxt.pattern="[0-9]*"):t===l.URL?this._edTxt.type="url":(this._edTxt.type="text",this._editBox._keyboardReturnType===h.SEARCH&&(this._edTxt.type="search")),this._editBox._editBoxInputFlag===u.PASSWORD&&(this._edTxt.type="password")},e.setInputFlag=function(t){this._edTxt&&(this._updateDomInputType(),this._edTxt.style.textTransform="none",t===u.INITIAL_CAPS_ALL_CHARACTERS?this._edTxt.style.textTransform="uppercase":t===u.INITIAL_CAPS_WORD&&(this._edTxt.style.textTransform="capitalize"),this._updateLabelStringStyle())},e.setInputMode=function(t){t===l.ANY?this._createDomTextArea():this._createDomInput(),this._updateDomInputType();var e=this._node.getContentSize();this.updateSize(e.width,e.height)},e.setString=function(t){this._edTxt&&null!==t&&(this._edTxt.value=t,""===t?(this._placeholderLabel&&(this._placeholderLabel.setString(this._editBox._placeholderText),this._placeholderLabel.setColor(this._editBox._placeholderColor)),this._editingMode||(this._placeholderLabel&&this._placeholderLabel.setVisible(!0),this._textLabel&&this._textLabel.setVisible(!1))):(this._edTxt.style.color=cc.colorToHex(this._editBox._textColor),this._textLabel&&this._textLabel.setColor(this._editBox._textColor),this._editingMode||(this._placeholderLabel&&this._placeholderLabel.setVisible(!1),this._textLabel&&this._textLabel.setVisible(!0)),this._updateLabelStringStyle()))},e._updateDOMFontStyle=function(){this._edTxt&&(""!==this._edTxt.value&&(this._edTxt.style.fontFamily=this._edFontName,this._edTxt.style.fontSize=this._edFontSize+"px"),this._textLabel&&(this._textLabel.setFontSize(this._edFontSize),this._textLabel.setFontFamily(this._edFontName)))},e.updateSize=function(t,e){var i=this._edTxt;i&&(i.style.width=t+"px",i.style.height=e+"px",this._updateLabelPosition(cc.size(t,e)))},e._addDomToGameContainer=function(){cc.game.container.appendChild(this._edTxt)},e.removeDom=function(){var t=this._edTxt;t&&a.contains(cc.game.container,t)&&cc.game.container.removeChild(t),this._edTxt=null},e.initializeRenderCmd=function(t){this._editBox=t,this._edFontSize=14,this._edFontName="Arial",this._textLabel=null,this._placeholderLabel=null,this._editingMode=!1,this.__fullscreen=!1,this.__autoResize=!1,this.__rotateScreen=!1,this.__orientationChanged=null},_ccsg.EditBox.CanvasRenderCmd=function(t){this._rootCtor(t),this.initializeRenderCmd(t)};var i=_ccsg.EditBox.CanvasRenderCmd.prototype=Object.create(_ccsg.Node.CanvasRenderCmd.prototype);cc.js.mixin(i,e),i.constructor=_ccsg.EditBox.CanvasRenderCmd,i.transform=function(t,e){this.originTransform(t,e),this.updateMatrix()},_ccsg.EditBox.WebGLRenderCmd=function(t){this._rootCtor(t),this.initializeRenderCmd(t)};var o=_ccsg.EditBox.WebGLRenderCmd.prototype=Object.create(_ccsg.Node.WebGLRenderCmd.prototype);cc.js.mixin(o,e),o.constructor=_ccsg.EditBox.WebGLRenderCmd,o.transform=function(t,e){this.originTransform(t,e),this.updateMatrix()}})(_ccsg.EditBox._polyfill)}),{"../platform/utils":171}],103:[(function(t,e,i){var n=cc.js;t("../event/event");var r=function(t,e){cc.Event.call(this,cc.Event.MOUSE,e),this._eventType=t,this._button=0,this._x=0,this._y=0,this._prevX=0,this._prevY=0,this._scrollX=0,this._scrollY=0};n.extend(r,cc.Event);var o=r.prototype;o.setScrollData=function(t,e){this._scrollX=t,this._scrollY=e},o.getScrollX=function(){return this._scrollX},o.getScrollY=function(){return this._scrollY},o.setLocation=function(t,e){this._x=t,this._y=e},o.getLocation=function(){return{x:this._x,y:this._y}},o.getLocationInView=function(){return{x:this._x,y:cc.view._designResolutionSize.height-this._y}},o._setPrevCursor=function(t,e){this._prevX=t,this._prevY=e},o.getPreviousLocation=function(){return{x:this._prevX,y:this._prevY}},o.getDelta=function(){return{x:this._x-this._prevX,y:this._y-this._prevY}},o.getDeltaX=function(){return this._x-this._prevX},o.getDeltaY=function(){return this._y-this._prevY},o.setButton=function(t){this._button=t},o.getButton=function(){return this._button},o.getLocationX=function(){return this._x},o.getLocationY=function(){return this._y},r.NONE=0,r.DOWN=1,r.UP=2,r.MOVE=3,r.SCROLL=4,r.BUTTON_LEFT=0,r.BUTTON_RIGHT=2,r.BUTTON_MIDDLE=1,r.BUTTON_4=3,r.BUTTON_5=4,r.BUTTON_6=5,r.BUTTON_7=6,r.BUTTON_8=7;var s=function(t,e){cc.Event.call(this,cc.Event.TOUCH,e),this._eventCode=0,this._touches=t||[],this.touch=null,this.currentTouch=null};n.extend(s,cc.Event),(o=s.prototype).getEventCode=function(){return this._eventCode},o.getTouches=function(){return this._touches},o._setEventCode=function(t){this._eventCode=t},o._setTouches=function(t){this._touches=t},o.setLocation=function(t,e){this.touch&&this.touch.setTouchInfo(this.touch.getID(),t,e)},o.getLocation=function(){return this.touch?this.touch.getLocation():cc.v2()},o.getLocationInView=function(){return this.touch?this.touch.getLocationInView():cc.v2()},o.getPreviousLocation=function(){return this.touch?this.touch.getPreviousLocation():cc.v2()},o.getStartLocation=function(){return this.touch?this.touch.getStartLocation():cc.v2()},o.getID=function(){return this.touch?this.touch.getID():null},o.getDelta=function(){return this.touch?this.touch.getDelta():cc.v2()},o.getDeltaX=function(){return this.touch?this.touch.getDelta().x:0},o.getDeltaY=function(){return this.touch?this.touch.getDelta().y:0},o.getLocationX=function(){return this.touch?this.touch.getLocationX():0},o.getLocationY=function(){return this.touch?this.touch.getLocationY():0},s.MAX_TOUCHES=5,s.BEGAN=0,s.MOVED=1,s.ENDED=2,s.CANCELED=3;var a=function(t,e){cc.Event.call(this,cc.Event.ACCELERATION,e),this.acc=t};n.extend(a,cc.Event);var c=function(t,e,i){cc.Event.call(this,cc.Event.KEYBOARD,i),this.keyCode=t,this.isPressed=e};n.extend(c,cc.Event),cc.Event.EventMouse=r,cc.Event.EventTouch=s,cc.Event.EventAcceleration=a,cc.Event.EventKeyboard=c,e.exports=cc.Event}),{"../event/event":111}],104:[(function(t,e,i){cc.EventListener=cc._Class.extend({ctor:function(t,e,i){this._onEvent=i,this._type=t||0,this._listenerID=e||"",this._registered=!1,this._fixedPriority=0,this._node=null,this._target=null,this._paused=!0,this._isEnabled=!0},_setPaused:function(t){this._paused=t},_isPaused:function(){return this._paused},_setRegistered:function(t){this._registered=t},_isRegistered:function(){return this._registered},_getType:function(){return this._type},_getListenerID:function(){return this._listenerID},_setFixedPriority:function(t){this._fixedPriority=t},_getFixedPriority:function(){return this._fixedPriority},_setSceneGraphPriority:function(t){this._target=t,this._node=t},_getSceneGraphPriority:function(){return this._node},checkAvailable:function(){return null!==this._onEvent},clone:function(){return null},setEnabled:function(t){this._isEnabled=t},isEnabled:function(){return this._isEnabled},retain:function(){},release:function(){}}),cc.EventListener.UNKNOWN=0,cc.EventListener.TOUCH_ONE_BY_ONE=1,cc.EventListener.TOUCH_ALL_AT_ONCE=2,cc.EventListener.KEYBOARD=3,cc.EventListener.MOUSE=4,cc.EventListener.ACCELERATION=6,cc.EventListener.CUSTOM=8,cc._EventListenerCustom=cc.EventListener.extend({_onCustomEvent:null,ctor:function(t,e){this._onCustomEvent=e,cc.EventListener.prototype.ctor.call(this,cc.EventListener.CUSTOM,t,this._callback)},_callback:function(t){null!==this._onCustomEvent&&this._onCustomEvent(t)},checkAvailable:function(){return cc.EventListener.prototype.checkAvailable.call(this)&&null!==this._onCustomEvent},clone:function(){return new cc._EventListenerCustom(this._listenerID,this._onCustomEvent)}}),cc._EventListenerMouse=cc.EventListener.extend({onMouseDown:null,onMouseUp:null,onMouseMove:null,onMouseScroll:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.MOUSE,cc._EventListenerMouse.LISTENER_ID,this._callback)},_callback:function(t){var e=cc.Event.EventMouse;switch(t._eventType){case e.DOWN:this.onMouseDown&&this.onMouseDown(t);break;case e.UP:this.onMouseUp&&this.onMouseUp(t);break;case e.MOVE:this.onMouseMove&&this.onMouseMove(t);break;case e.SCROLL:this.onMouseScroll&&this.onMouseScroll(t)}},clone:function(){var t=new cc._EventListenerMouse;return t.onMouseDown=this.onMouseDown,t.onMouseUp=this.onMouseUp,t.onMouseMove=this.onMouseMove,t.onMouseScroll=this.onMouseScroll,t},checkAvailable:function(){return!0}}),cc._EventListenerMouse.LISTENER_ID="__cc_mouse",cc._EventListenerTouchOneByOne=cc.EventListener.extend({_claimedTouches:null,swallowTouches:!1,onTouchBegan:null,onTouchMoved:null,onTouchEnded:null,onTouchCancelled:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.TOUCH_ONE_BY_ONE,cc._EventListenerTouchOneByOne.LISTENER_ID,null),this._claimedTouches=[]},setSwallowTouches:function(t){this.swallowTouches=t},isSwallowTouches:function(){return this.swallowTouches},clone:function(){var t=new cc._EventListenerTouchOneByOne;return t.onTouchBegan=this.onTouchBegan,t.onTouchMoved=this.onTouchMoved,t.onTouchEnded=this.onTouchEnded,t.onTouchCancelled=this.onTouchCancelled,t.swallowTouches=this.swallowTouches,t},checkAvailable:function(){return!!this.onTouchBegan||(cc.logID(1801),!1)}}),cc._EventListenerTouchOneByOne.LISTENER_ID="__cc_touch_one_by_one",cc._EventListenerTouchAllAtOnce=cc.EventListener.extend({onTouchesBegan:null,onTouchesMoved:null,onTouchesEnded:null,onTouchesCancelled:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.TOUCH_ALL_AT_ONCE,cc._EventListenerTouchAllAtOnce.LISTENER_ID,null)},clone:function(){var t=new cc._EventListenerTouchAllAtOnce;return t.onTouchesBegan=this.onTouchesBegan,t.onTouchesMoved=this.onTouchesMoved,t.onTouchesEnded=this.onTouchesEnded,t.onTouchesCancelled=this.onTouchesCancelled,t},checkAvailable:function(){return null!==this.onTouchesBegan||null!==this.onTouchesMoved||null!==this.onTouchesEnded||null!==this.onTouchesCancelled||(cc.logID(1802),!1)}}),cc._EventListenerTouchAllAtOnce.LISTENER_ID="__cc_touch_all_at_once",cc.EventListener.create=function(t){cc.assertID(t&&t.event,1900);var e=t.event;delete t.event;var i=null;e===cc.EventListener.TOUCH_ONE_BY_ONE?i=new cc._EventListenerTouchOneByOne:e===cc.EventListener.TOUCH_ALL_AT_ONCE?i=new cc._EventListenerTouchAllAtOnce:e===cc.EventListener.MOUSE?i=new cc._EventListenerMouse:e===cc.EventListener.CUSTOM?(i=new cc._EventListenerCustom(t.eventName,t.callback),delete t.eventName,delete t.callback):e===cc.EventListener.KEYBOARD?i=new cc._EventListenerKeyboard:e===cc.EventListener.ACCELERATION&&(i=new cc._EventListenerAcceleration(t.callback),delete t.callback);for(var n in t)i[n]=t[n];return i},cc._EventListenerAcceleration=cc.EventListener.extend({_onAccelerationEvent:null,ctor:function(t){this._onAccelerationEvent=t,cc.EventListener.prototype.ctor.call(this,cc.EventListener.ACCELERATION,cc._EventListenerAcceleration.LISTENER_ID,this._callback)},_callback:function(t){this._onAccelerationEvent(t.acc,t)},checkAvailable:function(){return cc.assertID(this._onAccelerationEvent,1803),!0},clone:function(){return new cc._EventListenerAcceleration(this._onAccelerationEvent)}}),cc._EventListenerAcceleration.LISTENER_ID="__cc_acceleration",cc._EventListenerKeyboard=cc.EventListener.extend({onKeyPressed:null,onKeyReleased:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.KEYBOARD,cc._EventListenerKeyboard.LISTENER_ID,this._callback)},_callback:function(t){t.isPressed?this.onKeyPressed&&this.onKeyPressed(t.keyCode,t):this.onKeyReleased&&this.onKeyReleased(t.keyCode,t)},clone:function(){var t=new cc._EventListenerKeyboard;return t.onKeyPressed=this.onKeyPressed,t.onKeyReleased=this.onKeyReleased,t},checkAvailable:function(){return null!==this.onKeyPressed||null!==this.onKeyReleased||(cc.logID(1800),!1)}}),cc._EventListenerKeyboard.LISTENER_ID="__cc_keyboard"}),{}],105:[(function(t,e,i){var n=cc._Class.extend({ctor:function(){this._fixedListeners=[],this._sceneGraphListeners=[],this.gt0Index=0},size:function(){return this._fixedListeners.length+this._sceneGraphListeners.length},empty:function(){return 0===this._fixedListeners.length&&0===this._sceneGraphListeners.length},push:function(t){0===t._getFixedPriority()?this._sceneGraphListeners.push(t):this._fixedListeners.push(t)},clearSceneGraphListeners:function(){this._sceneGraphListeners.length=0},clearFixedListeners:function(){this._fixedListeners.length=0},clear:function(){this._sceneGraphListeners.length=0,this._fixedListeners.length=0},getFixedPriorityListeners:function(){return this._fixedListeners},getSceneGraphPriorityListeners:function(){return this._sceneGraphListeners}}),r=function(t){var e=cc.Event,i=t.type;return i===e.ACCELERATION?cc._EventListenerAcceleration.LISTENER_ID:i===e.KEYBOARD?cc._EventListenerKeyboard.LISTENER_ID:i.startsWith(e.MOUSE)?cc._EventListenerMouse.LISTENER_ID:(i.startsWith(e.TOUCH)&&cc.logID(2e3),"")};cc.eventManager={DIRTY_NONE:0,DIRTY_FIXED_PRIORITY:1,DIRTY_SCENE_GRAPH_PRIORITY:2,DIRTY_ALL:3,_listenersMap:{},_priorityDirtyFlagMap:{},_nodeListenersMap:{},_nodePriorityMap:{},_globalZOrderNodeMap:{},_toAddedListeners:[],_toRemovedListeners:[],_dirtyNodes:[],_inDispatch:0,_isEnabled:!1,_nodePriorityIndex:0,_internalCustomListenerIDs:[],_setDirtyForNode:function(t){if(void 0!==this._nodeListenersMap[t.__instanceId]&&this._dirtyNodes.push(t),t.getChildren)for(var e=t.getChildren(),i=0,n=e?e.length:0;i<n;i++)this._setDirtyForNode(e[i])},pauseTarget:function(t,e){if(t instanceof cc._BaseNode||t instanceof _ccsg.Node){var i,n,r=this._nodeListenersMap[t.__instanceId];if(r)for(i=0,n=r.length;i<n;i++)r[i]._setPaused(!0);if(!0===e){var o=t.getChildren();for(i=0,n=o?o.length:0;i<n;i++)this.pauseTarget(o[i],!0)}}else cc.warnID(3506)},resumeTarget:function(t,e){if(t instanceof cc._BaseNode||t instanceof _ccsg.Node){var i,n,r=this._nodeListenersMap[t.__instanceId];if(r)for(i=0,n=r.length;i<n;i++)r[i]._setPaused(!1);if(this._setDirtyForNode(t),!0===e&&t.getChildren){var o=t.getChildren();for(i=0,n=o?o.length:0;i<n;i++)this.resumeTarget(o[i],!0)}}else cc.warnID(3506)},_addListener:function(t){0===this._inDispatch?this._forceAddEventListener(t):this._toAddedListeners.push(t)},_forceAddEventListener:function(t){var e=t._getListenerID(),i=this._listenersMap[e];if(i||(i=new n,this._listenersMap[e]=i),i.push(t),0===t._getFixedPriority()){this._setDirty(e,this.DIRTY_SCENE_GRAPH_PRIORITY);var r=t._getSceneGraphPriority();null===r&&cc.logID(3507),this._associateNodeAndEventListener(r,t),r.isRunning()&&this.resumeTarget(r)}else this._setDirty(e,this.DIRTY_FIXED_PRIORITY)},_getListeners:function(t){return this._listenersMap[t]},_updateDirtyFlagForSceneGraph:function(){if(0!==this._dirtyNodes.length){for(var t,e,i=this._dirtyNodes,n=this._nodeListenersMap,r=0,o=i.length;r<o;r++)if(t=n[i[r].__instanceId])for(var s=0,a=t.length;s<a;s++)(e=t[s])&&this._setDirty(e._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY);this._dirtyNodes.length=0}},_removeAllListenersInVector:function(t){if(t)for(var e,i=0;i<t.length;)(e=t[i])._setRegistered(!1),null!=e._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(e._getSceneGraphPriority(),e),e._setSceneGraphPriority(null)),0===this._inDispatch?cc.js.array.remove(t,e):++i},_removeListenersForListenerID:function(t){var e,i=this._listenersMap[t];if(i){var n=i.getFixedPriorityListeners(),r=i.getSceneGraphPriorityListeners();this._removeAllListenersInVector(r),this._removeAllListenersInVector(n),delete this._priorityDirtyFlagMap[t],this._inDispatch||(i.clear(),delete this._listenersMap[t])}var o,s=this._toAddedListeners;for(e=0;e<s.length;)(o=s[e])&&o._getListenerID()===t?cc.js.array.remove(s,o):++e},_sortEventListeners:function(t){var e=this.DIRTY_NONE,i=this._priorityDirtyFlagMap;if(i[t]&&(e=i[t]),e!==this.DIRTY_NONE&&(i[t]=this.DIRTY_NONE,e&this.DIRTY_FIXED_PRIORITY&&this._sortListenersOfFixedPriority(t),e&this.DIRTY_SCENE_GRAPH_PRIORITY)){var n=cc.director.getScene();n&&this._sortListenersOfSceneGraphPriority(t,n)}},_sortListenersOfSceneGraphPriority:function(t,e){var i=this._getListeners(t);if(i){var n=i.getSceneGraphPriorityListeners();n&&0!==n.length&&(this._nodePriorityIndex=0,this._nodePriorityMap={},this._visitTarget(e,!0),i.getSceneGraphPriorityListeners().sort(this._sortEventListenersOfSceneGraphPriorityDes))}},_sortEventListenersOfSceneGraphPriorityDes:function(t,e){var i=cc.eventManager._nodePriorityMap,n=t._getSceneGraphPriority(),r=e._getSceneGraphPriority();return e&&r&&i[r.__instanceId]?t&&n&&i[n.__instanceId]?i[r.__instanceId]-i[n.__instanceId]:1:-1},_sortListenersOfFixedPriority:function(t){var e=this._listenersMap[t];if(e){var i=e.getFixedPriorityListeners();if(i&&0!==i.length){i.sort(this._sortListenersOfFixedPriorityAsc);for(var n=0,r=i.length;n<r&&!(i[n]._getFixedPriority()>=0);)++n;e.gt0Index=n}}},_sortListenersOfFixedPriorityAsc:function(t,e){return t._getFixedPriority()-e._getFixedPriority()},_onUpdateListeners:function(t){var e,i,n,r=t.getFixedPriorityListeners(),o=t.getSceneGraphPriorityListeners(),s=this._toRemovedListeners;if(o)for(e=0;e<o.length;)(i=o[e])._isRegistered()?++e:(cc.js.array.remove(o,i),-1!==(n=s.indexOf(i))&&s.splice(n,1));if(r)for(e=0;e<r.length;)(i=r[e])._isRegistered()?++e:(cc.js.array.remove(r,i),-1!==(n=s.indexOf(i))&&s.splice(n,1));o&&0===o.length&&t.clearSceneGraphListeners(),r&&0===r.length&&t.clearFixedListeners()},frameUpdateListeners:function(){var t=this._listenersMap,e=this._priorityDirtyFlagMap;for(var i in t)t[i].empty()&&(delete e[i],delete t[i]);var n=this._toAddedListeners;if(0!==n.length){for(var r=0,o=n.length;r<o;r++)this._forceAddEventListener(n[r]);n.length=0}0!==this._toRemovedListeners.length&&this._cleanToRemovedListeners()},_updateTouchListeners:function(t){var e=this._inDispatch;if(cc.assertID(e>0,3508),!(e>1)){var i;(i=this._listenersMap[cc._EventListenerTouchOneByOne.LISTENER_ID])&&this._onUpdateListeners(i),(i=this._listenersMap[cc._EventListenerTouchAllAtOnce.LISTENER_ID])&&this._onUpdateListeners(i),cc.assertID(1===e,3509);var n=this._toAddedListeners;if(0!==n.length){for(var r=0,o=n.length;r<o;r++)this._forceAddEventListener(n[r]);this._toAddedListeners.length=0}0!==this._toRemovedListeners.length&&this._cleanToRemovedListeners()}},_cleanToRemovedListeners:function(){for(var t=this._toRemovedListeners,e=0;e<t.length;e++){var i=t[e],n=this._listenersMap[i._getListenerID()];if(n){var r,o=n.getFixedPriorityListeners(),s=n.getSceneGraphPriorityListeners();s&&-1!==(r=s.indexOf(i))&&s.splice(r,1),o&&-1!==(r=o.indexOf(i))&&o.splice(r,1)}}t.length=0},_onTouchEventCallback:function(t,e){if(!t._isRegistered)return!1;var i=e.event,n=i.currentTouch;i.currentTarget=t._node;var r,o=!1,s=i.getEventCode(),a=cc.Event.EventTouch;return s===a.BEGAN?t.onTouchBegan&&(o=t.onTouchBegan(n,i))&&t._registered&&t._claimedTouches.push(n):t._claimedTouches.length>0&&-1!==(r=t._claimedTouches.indexOf(n))&&(o=!0,s===a.MOVED&&t.onTouchMoved?t.onTouchMoved(n,i):s===a.ENDED?(t.onTouchEnded&&t.onTouchEnded(n,i),t._registered&&t._claimedTouches.splice(r,1)):s===a.CANCELLED&&(t.onTouchCancelled&&t.onTouchCancelled(n,i),t._registered&&t._claimedTouches.splice(r,1))),i.isStopped()?(cc.eventManager._updateTouchListeners(i),!0):!!(o&&t._registered&&t.swallowTouches)&&(e.needsMutableSet&&e.touches.splice(n,1),!0)},_dispatchTouchEvent:function(t){this._sortEventListeners(cc._EventListenerTouchOneByOne.LISTENER_ID),this._sortEventListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID);var e=this._getListeners(cc._EventListenerTouchOneByOne.LISTENER_ID),i=this._getListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID);if(null!==e||null!==i){var n=t.getTouches(),r=cc.js.array.copy(n),o={event:t,needsMutableSet:e&&i,touches:r,selTouch:null};if(e)for(var s=0;s<n.length;s++)t.currentTouch=n[s],t._propagationStopped=t._propagationImmediateStopped=!1,this._dispatchEventToListeners(e,this._onTouchEventCallback,o);i&&r.length>0&&(this._dispatchEventToListeners(i,this._onTouchesEventCallback,{event:t,touches:r}),t.isStopped())||this._updateTouchListeners(t)}},_onTouchesEventCallback:function(t,e){if(!t._registered)return!1;var i=cc.Event.EventTouch,n=e.event,r=e.touches,o=n.getEventCode();return n.currentTarget=t._node,o===i.BEGAN&&t.onTouchesBegan?t.onTouchesBegan(r,n):o===i.MOVED&&t.onTouchesMoved?t.onTouchesMoved(r,n):o===i.ENDED&&t.onTouchesEnded?t.onTouchesEnded(r,n):o===i.CANCELLED&&t.onTouchesCancelled&&t.onTouchesCancelled(r,n),!!n.isStopped()&&(cc.eventManager._updateTouchListeners(n),!0)},_associateNodeAndEventListener:function(t,e){var i=this._nodeListenersMap[t.__instanceId];i||(i=[],this._nodeListenersMap[t.__instanceId]=i),i.push(e)},_dissociateNodeAndEventListener:function(t,e){var i=this._nodeListenersMap[t.__instanceId];i&&(cc.js.array.remove(i,e),0===i.length&&delete this._nodeListenersMap[t.__instanceId])},_dispatchEventToListeners:function(t,e,i){var n,r,o=!1,s=t.getFixedPriorityListeners(),a=t.getSceneGraphPriorityListeners(),c=0;if(s&&0!==s.length)for(;c<t.gt0Index;++c)if((r=s[c]).isEnabled()&&!r._isPaused()&&r._isRegistered()&&e(r,i)){o=!0;break}if(a&&!o)for(n=0;n<a.length;n++)if((r=a[n]).isEnabled()&&!r._isPaused()&&r._isRegistered()&&e(r,i)){o=!0;break}if(s&&!o)for(;c<s.length;++c)if((r=s[c]).isEnabled()&&!r._isPaused()&&r._isRegistered()&&e(r,i)){o=!0;break}},_setDirty:function(t,e){var i=this._priorityDirtyFlagMap;null==i[t]?i[t]=e:i[t]=e|i[t]},_visitTarget:function(t,e){t._reorderChildDirty&&t.sortAllChildren();var i=t.getChildren(),n=0,r=i.length,o=this._globalZOrderNodeMap,s=this._nodeListenersMap;if(r>0){for(var a;n<r&&((a=i[n])&&a.getLocalZOrder()<0);n++)this._visitTarget(a,!1);for(void 0!==s[t.__instanceId]&&(o[t.getGlobalZOrder()]||(o[t.getGlobalZOrder()]=[]),o[t.getGlobalZOrder()].push(t.__instanceId));n<r;n++)(a=i[n])&&this._visitTarget(a,!1)}else void 0!==s[t.__instanceId]&&(o[t.getGlobalZOrder()]||(o[t.getGlobalZOrder()]=[]),o[t.getGlobalZOrder()].push(t.__instanceId));if(e){var c=[];for(var h in o)c.push(h);c.sort(this._sortNumberAsc);var l,u,d=c.length,_=this._nodePriorityMap;for(n=0;n<d;n++)for(l=o[c[n]],u=0;u<l.length;u++)_[l[u]]=++this._nodePriorityIndex;this._globalZOrderNodeMap={}}},_sortNumberAsc:function(t,e){return t-e},hasEventListener:function(t){return!!this._getListeners(t)},addListener:function(t,e){if(cc.assertID(t&&e,3503),cc.js.isNumber(e)||e instanceof cc._BaseNode||e instanceof _ccsg.Node){if(t instanceof cc.EventListener){if(t._isRegistered())return void cc.logID(3505)}else cc.assertID(!cc.js.isNumber(e),3504),t=cc.EventListener.create(t);if(t.checkAvailable()){if(cc.js.isNumber(e)){if(0===e)return void cc.logID(3500);t._setSceneGraphPriority(null),t._setFixedPriority(e),t._setRegistered(!0),t._setPaused(!1),this._addListener(t)}else t._setSceneGraphPriority(e),t._setFixedPriority(0),t._setRegistered(!0),this._addListener(t);return t}}else cc.warnID(3506)},addCustomListener:function(t,e){var i=new cc._EventListenerCustom(t,e);return this.addListener(i,1),i},removeListener:function(t){if(null!=t){var e,i=this._listenersMap;for(var n in i){var r=i[n],o=r.getFixedPriorityListeners(),s=r.getSceneGraphPriorityListeners();if((e=this._removeListenerInVector(s,t))?this._setDirty(t._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY):(e=this._removeListenerInVector(o,t))&&this._setDirty(t._getListenerID(),this.DIRTY_FIXED_PRIORITY),r.empty()&&(delete this._priorityDirtyFlagMap[t._getListenerID()],delete i[n]),e)break}if(!e)for(var a=this._toAddedListeners,c=0,h=a.length;c<h;c++){var l=a[c];if(l===t){cc.js.array.remove(a,l),l._setRegistered(!1);break}}}},_removeListenerInCallback:function(t,e){if(null==t)return!1;for(var i=0,n=t.length;i<n;i++){var r=t[i];if(r._onCustomEvent===e||r._onEvent===e)return r._setRegistered(!1),null!=r._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(r._getSceneGraphPriority(),r),r._setSceneGraphPriority(null)),0===this._inDispatch?cc.js.array.remove(t,r):this._toRemovedListeners.push(r),!0}return!1},_removeListenerInVector:function(t,e){if(null==t)return!1;for(var i=0,n=t.length;i<n;i++){var r=t[i];if(r===e)return r._setRegistered(!1),null!=r._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(r._getSceneGraphPriority(),r),r._setSceneGraphPriority(null)),0===this._inDispatch?cc.js.array.remove(t,r):this._toRemovedListeners.push(r),!0}return!1},removeListeners:function(t,e){var i=this;if(cc.js.isNumber(t)||t instanceof cc._BaseNode||t instanceof _ccsg.Node)if(void 0!==t.__instanceId){delete i._nodePriorityMap[t.__instanceId],cc.js.array.remove(i._dirtyNodes,t);var n,r=i._nodeListenersMap[t.__instanceId];if(r){var o=cc.js.array.copy(r);for(n=0;n<o.length;n++)i.removeListener(o[n]);delete i._nodeListenersMap[t.__instanceId]}var s=i._toAddedListeners;for(n=0;n<s.length;){var a=s[n];a._getSceneGraphPriority()===t?(a._setSceneGraphPriority(null),a._setRegistered(!1),s.splice(n,1)):++n}if(!0===e){var c,h=t.getChildren();for(n=0,c=h.length;n<c;n++)i.removeListeners(h[n],!0)}}else t===cc.EventListener.TOUCH_ONE_BY_ONE?i._removeListenersForListenerID(cc._EventListenerTouchOneByOne.LISTENER_ID):t===cc.EventListener.TOUCH_ALL_AT_ONCE?i._removeListenersForListenerID(cc._EventListenerTouchAllAtOnce.LISTENER_ID):t===cc.EventListener.MOUSE?i._removeListenersForListenerID(cc._EventListenerMouse.LISTENER_ID):t===cc.EventListener.ACCELERATION?i._removeListenersForListenerID(cc._EventListenerAcceleration.LISTENER_ID):t===cc.EventListener.KEYBOARD?i._removeListenersForListenerID(cc._EventListenerKeyboard.LISTENER_ID):cc.logID(3501);else cc.warnID(3506)},removeCustomListeners:function(t){this._removeListenersForListenerID(t)},removeAllListeners:function(){var t=this._listenersMap,e=this._internalCustomListenerIDs;for(var i in t)-1===e.indexOf(i)&&this._removeListenersForListenerID(i)},setPriority:function(t,e){if(null!=t){var i=this._listenersMap;for(var n in i){var r=i[n].getFixedPriorityListeners();if(r&&-1!==r.indexOf(t))return null!=t._getSceneGraphPriority()&&cc.logID(3502),void(t._getFixedPriority()!==e&&(t._setFixedPriority(e),this._setDirty(t._getListenerID(),this.DIRTY_FIXED_PRIORITY)))}}},setEnabled:function(t){this._isEnabled=t},isEnabled:function(){return this._isEnabled},dispatchEvent:function(t){if(this._isEnabled){if(this._updateDirtyFlagForSceneGraph(),this._inDispatch++,!t||!t.getType)throw new Error("event is undefined");if(t.getType().startsWith(cc.Event.TOUCH))return this._dispatchTouchEvent(t),void this._inDispatch--;var e=r(t);this._sortEventListeners(e);var i=this._listenersMap[e];null!=i&&(this._dispatchEventToListeners(i,this._onListenerCallback,t),this._onUpdateListeners(i)),this._inDispatch--}},_onListenerCallback:function(t,e){return e.currentTarget=t._target,t._onEvent(e),e.isStopped()},dispatchCustomEvent:function(t,e){var i=new cc.Event.EventCustom(t);i.setUserData(e),this.dispatchEvent(i)}}}),{}],106:[(function(t,e,i){var n=t("../event/event-target"),r=cc.Enum({KEY_DOWN:"keydown",KEY_UP:"keyup",DEVICEMOTION:"devicemotion"}),o=null,s=null,a=0,c=cc.Class({name:"SystemEvent",extends:n,statics:{EventType:r},on:function(t,e,i,n){if(this._super(t,e,i,n),(t===r.KEY_DOWN||t===r.KEY_UP)&&(o||(o=cc.EventListener.create({event:cc.EventListener.KEYBOARD,onKeyPressed:function(t,e){e.type=r.KEY_DOWN,cc.systemEvent.dispatchEvent(e)},onKeyReleased:function(t,e){e.type=r.KEY_UP,cc.systemEvent.dispatchEvent(e)}})),!cc.eventManager.hasEventListener(cc._EventListenerKeyboard.LISTENER_ID))){var c=cc.director.getTotalFrames();c!==a&&(cc.eventManager.addListener(o,1),a=c)}t===r.DEVICEMOTION&&(s||(s=cc.EventListener.create({event:cc.EventListener.ACCELERATION,callback:function(t,e){e.type=r.DEVICEMOTION,cc.systemEvent.dispatchEvent(e)}})),cc.eventManager.hasEventListener(cc._EventListenerAcceleration.LISTENER_ID)||cc.eventManager.addListener(s,1))},off:function(t,e,i,n){if(this._super(t,e,i,n),o&&(t===r.KEY_DOWN||t===r.KEY_UP)){var a=this.hasEventListener(r.KEY_DOWN),c=this.hasEventListener(r.KEY_UP);a||c||cc.eventManager.removeListener(o)}s&&t===r.DEVICEMOTION&&cc.eventManager.removeListener(s)}});cc.SystemEvent=e.exports=c,cc.systemEvent=new cc.SystemEvent}),{"../event/event-target":110}],107:[(function(t,e,i){cc.Touch=cc._Class.extend({ctor:function(t,e,i){this._lastModified=0,this.setTouchInfo(i,t,e)},getLocation:function(){return{x:this._point.x,y:this._point.y}},getLocationX:function(){return this._point.x},getLocationY:function(){return this._point.y},getPreviousLocation:function(){return{x:this._prevPoint.x,y:this._prevPoint.y}},getStartLocation:function(){return{x:this._startPoint.x,y:this._startPoint.y}},getDelta:function(){return cc.pSub(this._point,this._prevPoint)},getLocationInView:function(){return{x:this._point.x,y:cc.view._designResolutionSize.height-this._point.y}},getPreviousLocationInView:function(){return{x:this._prevPoint.x,y:cc.view._designResolutionSize.height-this._prevPoint.y}},getStartLocationInView:function(){return{x:this._startPoint.x,y:cc.view._designResolutionSize.height-this._startPoint.y}},getID:function(){return this._id},setTouchInfo:function(t,e,i){this._prevPoint=this._point,this._point=cc.p(e||0,i||0),this._id=t,this._startPointCaptured||(this._startPoint=cc.p(this._point),cc.view._convertPointWithScale(this._startPoint),this._startPointCaptured=!0)},_setPoint:function(t,e){void 0===e?(this._point.x=t.x,this._point.y=t.y):(this._point.x=t,this._point.y=e)},_setPrevPoint:function(t,e){this._prevPoint=void 0===e?cc.p(t.x,t.y):cc.p(t||0,e||0)}})}),{}],108:[(function(t,e,i){t("./CCTouch"),t("./CCEventListener"),t("./CCEventManager"),t("./CCEvent"),t("./CCSystemEvent")}),{"./CCEvent":103,"./CCEventListener":104,"./CCEventManager":105,"./CCSystemEvent":106,"./CCTouch":107}],109:[(function(t,e,i){function n(){o.call(this)}var r=cc.js,o=t("../platform/callbacks-invoker").CallbacksHandler;r.extend(n,o),n.prototype.invoke=function(t,e){var i=t.type,n=this._callbackTable[i];if(n){var r=!n.isInvoking;n.isInvoking=!0;for(var o=n.callbacks,s=n.targets,a=0,c=o.length;a<c;++a){var h=o[a];if(h){var l=s[a]||t.currentTarget;if(h.call(l,t,e),t._propagationImmediateStopped)break}}r&&(n.isInvoking=!1,n.containCanceled&&n.purgeCanceled())}},e.exports=n}),{"../platform/callbacks-invoker":160}],110:[(function(t,e,i){function n(){this._capturingListeners=null,this._bubblingListeners=null,this._hasListenerCache=null}var r=t("./event-listeners");t("./event");var o=cc.js.array.fastRemove,s=new Array(16);s.length=0;var a=function(t,e){var i,n;for(e.target=t,s.length=0,t._getCapturingTargets(e.type,s),e.eventPhase=1,n=s.length-1;n>=0;--n)if((i=s[n])._isTargetActive(e.type)&&i._capturingListeners&&(e.currentTarget=i,i._capturingListeners.invoke(e,s),e._propagationStopped))return void(s.length=0);if(s.length=0,t._isTargetActive(e.type)&&(e.eventPhase=2,e.currentTarget=t,t._capturingListeners&&t._capturingListeners.invoke(e),!e._propagationImmediateStopped&&t._bubblingListeners&&t._bubblingListeners.invoke(e)),!e._propagationStopped&&e.bubbles)for(t._getBubblingTargets(e.type,s),e.eventPhase=3,n=0;n<s.length;++n)if((i=s[n])._isTargetActive(e.type)&&i._bubblingListeners&&(e.currentTarget=i,i._bubblingListeners.invoke(e),e._propagationStopped))return void(s.length=0);s.length=0},c=n.prototype;c._addEventFlag=function(t,e,i){var n=this._hasListenerCache;n||(n=this._hasListenerCache=cc.js.createMap()),void 0===n[t]&&(n[t]=0);var r=i?2:4;n[t]|=r},c._removeEventFlag=function(t,e,i){var n=this._hasListenerCache;if(n&&!e.has(t)){var r=i?2:4;n[t]&=~r,0===n[t]&&delete n[t]}},c._resetFlagForTarget=function(t,e,i){var n=this._hasListenerCache;if(n){var r=i?2:4;for(var o in n)e.has(o)||(n[o]&=~r,0===n[o]&&delete n[o])}},c.hasEventListener=function(t,e){var i=this._hasListenerCache;if(!i)return!1;var n=i[t];return!!(e&&2&n)||!(e||!(4&n))},c.on=function(t,e,i,n){"boolean"==typeof i?(n=i,i=void 0):n=!!n;if(e){var o=null;return(o=n?this._capturingListeners=this._capturingListeners||new r:this._bubblingListeners=this._bubblingListeners||new r).has(t,e,i)||(o.add(t,e,i),i&&i.__eventTargets&&i.__eventTargets.push(this),this._addEventFlag(t,o,n)),e}cc.errorID(6800)},c.off=function(t,e,i,n){if("boolean"==typeof i?(n=i,i=void 0):n=!!n,e){var r=n?this._capturingListeners:this._bubblingListeners;r&&(r.remove(t,e,i),i&&i.__eventTargets&&o(i.__eventTargets,this),this._removeEventFlag(t,r,n))}else this._capturingListeners&&this._capturingListeners.removeAll(t),this._bubblingListeners&&this._bubblingListeners.removeAll(t),this._hasListenerCache&&delete this._hasListenerCache[t]},c.targetOff=function(t){this._capturingListeners&&(this._capturingListeners.removeAll(t),this._resetFlagForTarget(t,this._capturingListeners,!0)),this._bubblingListeners&&(this._bubblingListeners.removeAll(t),this._resetFlagForTarget(t,this._bubblingListeners,!1))},c.once=function(t,e,i,n){var r=this,o=function(s){r.off(t,o,i,n),e.call(this,s)};this.on(t,o,i,n)},c.dispatchEvent=function(t){a(this,t),s.length=0},c.emit=function(t,e){var i=this._hasListenerCache;if(i){var n=i[t];if(n){var r=cc.Event.EventCustom.get(t);r.detail=e,r.eventPhase=2,r.target=r.currentTarget=this;var o=this._capturingListeners;o&&2&n&&o.invoke(r);var s=this._bubblingListeners;s&&4&n&&!r._propagationImmediateStopped&&s.invoke(r),cc.Event.EventCustom.put(r)}}},c._isTargetActive=function(t){return!0},c._getCapturingTargets=function(t,e){},c._getBubblingTargets=function(t,e){},n.prototype._EventTargetOn=n.prototype.on,n.prototype._EventTargetOnce=n.prototype.once,n.prototype._EventTargetOff=n.prototype.off,n.prototype._EventTargetTargetOff=n.prototype.targetOff,cc.EventTarget=e.exports=n}),{"./event":111,"./event-listeners":109}],111:[(function(t,e,i){var n=t("../platform/js");cc.Event=function(t,e){this.type=t,this.bubbles=!!e,this.target=null,this.currentTarget=null,this.eventPhase=0,this._propagationStopped=!1,this._propagationImmediateStopped=!1},cc.Event.prototype={constructor:cc.Event,unuse:function(){this.type=cc.Event.NO_TYPE,this.target=null,this.currentTarget=null,this.eventPhase=cc.Event.NONE,this._propagationStopped=!1,this._propagationImmediateStopped=!1},reuse:function(t,e){this.type=t,this.bubbles=e||!1},stopPropagation:function(){this._propagationStopped=!0},stopPropagationImmediate:function(){this._propagationImmediateStopped=!0},isStopped:function(){return this._propagationStopped||this._propagationImmediateStopped},getCurrentTarget:function(){return this.currentTarget},getType:function(){return this.type}},cc.Event.NO_TYPE="no_type",cc.Event.TOUCH="touch",cc.Event.MOUSE="mouse",cc.Event.KEYBOARD="keyboard",cc.Event.ACCELERATION="acceleration",cc.Event.NONE=0,cc.Event.CAPTURING_PHASE=1,cc.Event.AT_TARGET=2,cc.Event.BUBBLING_PHASE=3;var r=function(t,e){cc.Event.call(this,t,e),this.detail=null};n.extend(r,cc.Event),r.prototype.reset=r,r.prototype.setUserData=function(t){this.detail=t},r.prototype.getUserData=function(){return this.detail},r.prototype.getEventName=cc.Event.prototype.getType;var o=new n.Pool(10);r.put=function(t){o.put(t)},r.get=function(t,e){var i=o._get();return i?i.reset(t,e):i=new r(t,e),i},cc.Event.EventCustom=r,e.exports=cc.Event}),{"../platform/js":167}],112:[(function(t,e,i){t("./event"),t("./event-listeners"),t("./event-target")}),{"./event":111,"./event-listeners":109,"./event-target":110}],113:[(function(t,e,i){"use strict";function n(t,e,i){i=i||2;var n=e&&e.length,o=n?e[0]*i:t.length,a=r(t,0,o,i,!0),c=[];if(!a)return c;var h,l,d,_,f,p,g;if(n&&(a=u(t,e,a,i)),t.length>80*i){h=d=t[0],l=_=t[1];for(var v=i;v<o;v+=i)f=t[v],p=t[v+1],f<h&&(h=f),p<l&&(l=p),f>d&&(d=f),p>_&&(_=p);g=Math.max(d-h,_-l)}return s(a,c,i,h,l,g),c}function r(t,e,i,n,r){var o,s;if(r===L(t,e,i,n)>0)for(o=e;o<i;o+=n)s=I(o,t[o],t[o+1],s);else for(o=i-n;o>=e;o-=n)s=I(o,t[o],t[o+1],s);return s&&x(s,s.next)&&(w(s),s=s.next),s}function o(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!x(n,n.next)&&0!==C(n.prev,n,n.next))n=n.next;else{if(w(n),(n=e=n.prev)===n.next)return null;i=!0}}while(i||n!==e);return e}function s(t,e,i,n,r,u,d){if(t){!d&&u&&p(t,n,r,u);for(var _,f,g=t;t.prev!==t.next;)if(_=t.prev,f=t.next,u?c(t,n,r,u):a(t))e.push(_.i/i),e.push(t.i/i),e.push(f.i/i),w(t),t=f.next,g=f.next;else if((t=f)===g){d?1===d?s(t=h(t,e,i),e,i,n,r,u,2):2===d&&l(t,e,i,n,r,u):s(o(t),e,i,n,r,u,1);break}}}function a(t){var e=t.prev,i=t,n=t.next;if(C(e,i,n)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(y(e.x,e.y,i.x,i.y,n.x,n.y,r.x,r.y)&&C(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function c(t,e,i,n){var r=t.prev,o=t,s=t.next;if(C(r,o,s)>=0)return!1;for(var a=r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,c=r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,h=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,l=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,u=v(a,c,e,i,n),d=v(h,l,e,i,n),_=t.nextZ;_&&_.z<=d;){if(_!==t.prev&&_!==t.next&&y(r.x,r.y,o.x,o.y,s.x,s.y,_.x,_.y)&&C(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(_=t.prevZ;_&&_.z>=u;){if(_!==t.prev&&_!==t.next&&y(r.x,r.y,o.x,o.y,s.x,s.y,_.x,_.y)&&C(_.prev,_,_.next)>=0)return!1;_=_.prevZ}return!0}function h(t,e,i){var n=t;do{var r=n.prev,o=n.next.next;!x(r,o)&&E(r,n,n.next,o)&&b(r,o)&&b(o,r)&&(e.push(r.i/i),e.push(n.i/i),e.push(o.i/i),w(n),w(n.next),n=t=o),n=n.next}while(n!==t);return n}function l(t,e,i,n,r,a){var c=t;do{for(var h=c.next.next;h!==c.prev;){if(c.i!==h.i&&T(c,h)){var l=R(c,h);return c=o(c,c.next),l=o(l,l.next),s(c,e,i,n,r,a),void s(l,e,i,n,r,a)}h=h.next}c=c.next}while(c!==t)}function u(t,e,i,n){var s,a,c,h=[];for(s=0,a=e.length;s<a;s++)(c=r(t,e[s]*n,s<a-1?e[s+1]*n:t.length,n,!1))===c.next&&(c.steiner=!0),h.push(m(c));for(h.sort(d),s=0;s<h.length;s++)_(h[s],i),i=o(i,i.next);return i}function d(t,e){return t.x-e.x}function _(t,e){if(e=f(t,e)){var i=R(e,t);o(i,i.next)}}function f(t,e){var i,n=e,r=t.x,o=t.y,s=-1/0;do{if(o<=n.y&&o>=n.next.y){var a=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>s){if(s=a,a===r){if(o===n.y)return n;if(o===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(r===s)return i.prev;var c,h=i,l=i.x,u=i.y,d=1/0;for(n=i.next;n!==h;)r>=n.x&&n.x>=l&&y(o<u?r:s,o,l,u,o<u?s:r,o,n.x,n.y)&&((c=Math.abs(o-n.y)/(r-n.x))<d||c===d&&n.x>i.x)&&b(n,t)&&(i=n,d=c),n=n.next;return i}function p(t,e,i,n){var r=t;do{null===r.z&&(r.z=v(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,g(r)}function g(t){var e,i,n,r,o,s,a,c,h=1;do{for(i=t,t=null,o=null,s=0;i;){for(s++,n=i,a=0,e=0;e<h&&(a++,n=n.nextZ);e++);for(c=h;a>0||c>0&&n;)0===a?(r=n,n=n.nextZ,c--):0!==c&&n?i.z<=n.z?(r=i,i=i.nextZ,a--):(r=n,n=n.nextZ,c--):(r=i,i=i.nextZ,a--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;i=n}o.nextZ=null,h*=2}while(s>1);return t}function v(t,e,i,n,r){return t=32767*(t-i)/r,e=32767*(e-n)/r,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function m(t){var e=t,i=t;do{e.x<i.x&&(i=e),e=e.next}while(e!==t);return i}function y(t,e,i,n,r,o,s,a){return(r-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(n-a)-(i-s)*(e-a)>=0&&(i-s)*(o-a)-(r-s)*(n-a)>=0}function T(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!S(t,e)&&b(t,e)&&b(e,t)&&A(t,e)}function C(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function x(t,e){return t.x===e.x&&t.y===e.y}function E(t,e,i,n){return!!(x(t,e)&&x(i,n)||x(t,n)&&x(i,e))||C(t,e,i)>0!=C(t,e,n)>0&&C(i,n,t)>0!=C(i,n,e)>0}function S(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&E(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function b(t,e){return C(t.prev,t,t.next)<0?C(t,e,t.next)>=0&&C(t,t.prev,e)>=0:C(t,e,t.prev)<0||C(t,t.next,e)<0}function A(t,e){var i=t,n=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{i.y>o!=i.next.y>o&&r<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}function R(t,e){var i=new O(t.i,t.x,t.y),n=new O(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,o.next=n,n.prev=o,n}function I(t,e,i,n){var r=new O(t,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function w(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function O(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function L(t,e,i,n){for(var r=0,o=e,s=i-n;o<i;o+=n)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}e.exports=n,n.deviation=function(t,e,i,n){var r=e&&e.length,o=r?e[0]*i:t.length,s=Math.abs(L(t,0,o,i));if(r)for(var a=0,c=e.length;a<c;a++){var h=e[a]*i,l=a<c-1?e[a+1]*i:t.length;s-=Math.abs(L(t,h,l,i))}var u=0;for(a=0;a<n.length;a+=3){var d=n[a]*i,_=n[a+1]*i,f=n[a+2]*i;u+=Math.abs((t[d]-t[f])*(t[_+1]-t[d+1])-(t[d]-t[_])*(t[f+1]-t[d+1]))}return 0===s&&0===u?0:Math.abs((u-s)/s)},n.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)i.vertices.push(t[r][o][s]);r>0&&(n+=t[r-1].length,i.holes.push(n))}return i}}),{}],114:[(function(t,e,i){cc.js;var n=t("./types").LineCap,r=t("./types").LineJoin,o=t("./helper"),s=function(t){this._rootCtor(t),this._needDraw=!0,this.cmds=[],this.style={strokeStyle:"black",fillStyle:"white",lineCap:"butt",lineJoin:"miter",miterLimit:10}},a=s.prototype=Object.create(_ccsg.Node.CanvasRenderCmd.prototype);a.constructor=s,a._updateCurrentRegions=function(){var t=this._currentRegion;this._currentRegion=this._oldRegion,this._oldRegion=t,this._currentRegion.setTo(0,0,cc.visibleRect.width,cc.visibleRect.height)},a.rendering=function(t,e,i){var n=t||cc._renderContext,r=n.getContext();n.setTransform(this._worldTransform,e,i),r.save(),r.scale(1,-1);var o=this.style;r.strokeStyle=o.strokeStyle,r.fillStyle=o.fillStyle,r.lineWidth=o.lineWidth,r.lineJoin=o.lineJoin,r.miterLimit=o.miterLimit;for(var s=!0,a=this.cmds,c=0,h=a.length;c<h;c++){var l=a[c],u=l[0],d=l[1];"moveTo"===u&&s?(r.beginPath(),s=!1):"fill"!==u&&"stroke"!==u&&"fillRect"!==u||(s=!0),"function"==typeof r[u]?r[u].apply(r,d):r[u]=d}r.restore()},a.setStrokeColor=function(t){var e="rgba("+(0|t.r)+","+(0|t.g)+","+(0|t.b)+","+t.a/255+")";this.cmds.push(["strokeStyle",e]),this.style.strokeStyle=e},a.setFillColor=function(t){var e="rgba("+(0|t.r)+","+(0|t.g)+","+(0|t.b)+","+t.a/255+")";this.cmds.push(["fillStyle",e]),this.style.fillStyle=e},a.setLineWidth=function(t){this.cmds.push(["lineWidth",t]),this.style.lineWidth=t},a.setLineCap=function(t){var e="butt";t===n.BUTT?e="butt":t===n.ROUND?e="round":t===n.SQUARE&&(e="square"),this.cmds.push(["lineCap",e]),this.style.lineCap=e},a.setLineJoin=function(t){var e="bevel";t===r.BEVEL?e="bevel":t===r.ROUND?e="round":t===r.MITER&&(e="miter"),this.cmds.push(["lineJoin",e]),this.style.lineJoin=e},a.setMiterLimit=function(t){this.cmds.push(["miterLimit",t]),this.style.miterLimit=t},a.beginPath=function(){},a.moveTo=function(t,e){this.cmds.push(["moveTo",[t,e]])},a.lineTo=function(t,e){this.cmds.push(["lineTo",[t,e]])},a.bezierCurveTo=function(t,e,i,n,r,o){this.cmds.push(["bezierCurveTo",[t,e,i,n,r,o]])},a.quadraticCurveTo=function(t,e,i,n){this.cmds.push(["quadraticCurveTo",[t,e,i,n]])},a.arc=function(t,e,i,n,r,s){o.arc(this,t,e,i,n,r,s)},a.ellipse=function(t,e,i,n){o.ellipse(this,t,e,i,n)},a.circle=function(t,e,i){o.ellipse(this,t,e,i,i)},a.rect=function(t,e,i,n){this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+n),this.lineTo(t,e+n),this.close()},a.roundRect=function(t,e,i,n,r){o.roundRect(this,t,e,i,n,r)},a.fillRect=function(t,e,i,n){this.cmds.push(["fillRect",[t,e,i,n]]),this.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},a.close=function(){this.cmds.push(["closePath",[]])},a.stroke=function(){this.cmds.push(["stroke",[]]),this.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},a.fill=function(){this.cmds.push(["fill",[]]),this.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},a.clear=function(){this.cmds.length=0,this.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},e.exports=s}),{"./helper":118,"./types":120}],115:[(function(t,e,i){var n=t("./graphics-canvas-cmd"),r=t("./graphics-webgl-cmd"),o=t("./types").LineCap,s=t("./types").LineJoin,a=(cc.js,_ccsg.Node.extend({ctor:function(){this._super(),this.strokeColor=cc.Color.BLACK,this.fillColor=cc.Color.WHITE},clear:function(t){this._renderCmd.clear(t)},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new n(this):new r(this)}})),c=a.prototype;c._strokeColor=null,c._fillColor=null,c._lineWidth=1,c._lineCap=o.BUTT,c._lineJoin=s.MITER,c._miterLimit=10,c.setStrokeColor=function(t){this._strokeColor=t,this._renderCmd.setStrokeColor(t)},c.getStrokeColor=function(){return this._strokeColor},c.setFillColor=function(t){this._fillColor=t,this._renderCmd.setFillColor(t)},c.getFillColor=function(){return this._fillColor},c.setLineWidth=function(t){this._lineWidth=t,this._renderCmd.setLineWidth(t)},c.getLineWidth=function(){return this._lineWidth},c.setLineCap=function(t){this._lineCap=t,this._renderCmd.setLineCap(t)},c.getLineCap=function(){return this._lineCap},c.setLineJoin=function(t){this._lineJoin=t,this._renderCmd.setLineJoin(t)},c.getLineJoin=function(){return this._lineJoin},c.setMiterLimit=function(t){this._miterLimit=t,this._renderCmd.setMiterLimit(t)},c.getMiterLimit=function(){return this._miterLimit},c.beginPath=function(){this._renderCmd.beginPath()},c.moveTo=function(t,e){this._renderCmd.moveTo(t,e)},c.lineTo=function(t,e){this._renderCmd.lineTo(t,e)},c.bezierCurveTo=function(t,e,i,n,r,o){this._renderCmd.bezierCurveTo(t,e,i,n,r,o)},c.quadraticCurveTo=function(t,e,i,n){this._renderCmd.quadraticCurveTo(t,e,i,n)},c.arc=function(t,e,i,n,r,o){this._renderCmd.arc(t,e,i,n,r,o)},c.ellipse=function(t,e,i,n){this._renderCmd.ellipse(t,e,i,n)},c.circle=function(t,e,i){this._renderCmd.circle(t,e,i)},c.rect=function(t,e,i,n){this._renderCmd.rect(t,e,i,n)},c.roundRect=function(t,e,i,n,r){this._renderCmd.roundRect(t,e,i,n,r)},c.fillRect=function(t,e,i,n){this._renderCmd.fillRect(t,e,i,n)},c.close=function(){this._renderCmd.close()},c.stroke=function(){this._renderCmd.stroke()},c.fill=function(){this._renderCmd.fill()},e.exports=a}),{"./graphics-canvas-cmd":114,"./graphics-webgl-cmd":116,"./types":120}],116:[(function(t,e,i){function n(t,e,i){return t<e?e:t>i?i:t}function r(t,e){d.call(this,t,e),this.reset()}function o(){this.reset()}function s(){this.vertsOffset=0,this.vertsVBO=gl.createBuffer(),this.vertsBuffer=null,this.uint32VertsBuffer=null,this.vertsDirty=!1,this.indicesOffset=0,this.indicesVBO=gl.createBuffer(),this.indicesBuffer=null,this.indicesDirty=!1}function a(t){this._rootCtor(t),this._needDraw=!0;cc._renderContext;this._buffers=[],this._buffer=null,this._allocBuffer(),this._matrix=new cc.math.Matrix4,this._matrix.identity(),this._paths=[],this._points=[],this._curColorValue=0,this._blendFunc=new cc.BlendFunc(cc.macro.BLEND_SRC,cc.macro.BLEND_DST);var e=new cc.GLProgram;e.initWithVertexShaderByteArray(cc.PresetShaders.POSITION_COLOR_VERT,cc.PresetShaders.POSITION_COLOR_FRAG),e.retain(),e.addAttribute(cc.macro.ATTRIBUTE_NAME_POSITION,cc.macro.VERTEX_ATTRIB_POSITION),e.addAttribute(cc.macro.ATTRIBUTE_NAME_COLOR,cc.macro.VERTEX_ATTRIB_COLOR),e.link(),e.updateUniforms(),this._shaderProgram=e,this._allocVerts(f)}var c=t("./types").LineCap,h=t("./types").LineJoin,l=t("./earcut"),u=t("./helper"),d=cc.Vec2,_=cc.js,f=32,p=Math.PI,g=Math.min,v=Math.max,m=Math.ceil,y=Math.acos,T=Math.cos,C=Math.sin,x=Math.atan2,E=Math.abs,S=cc.Enum({PT_CORNER:1,PT_LEFT:2,PT_BEVEL:4,PT_INNERBEVEL:8});_.extend(r,d),r.prototype.reset=function(){this.dx=0,this.dy=0,this.dmx=0,this.dmy=0,this.flags=0,this.len=0},o.prototype.reset=function(){this.closed=!1,this.nbevel=0,this.complex=!0,this.points?this.points.length=0:this.points=[]},s.prototype.clear=function(){this.vertsOffset=0,this.indicesOffset=0},s.prototype.alloc=function(t,e){var i=this.vertsOffset+t;if(i>65535)return!1;var n=this.vertsBuffer,r=n?n.length/3:0;if(i>r){for(0===r&&(r=f);i>r;)r*=2;var o=new Float32Array(3*r),s=new Uint32Array(o.buffer);if(n)for(var a=this.uint32VertsBuffer,c=0,h=n.length;c<h;c+=3)o[c]=n[c],o[c+1]=n[c+1],s[c+2]=a[c+2];this.vertsBuffer=o,this.uint32VertsBuffer=s}var l=this.indicesBuffer,u=this.indicesOffset+e,d=l?l.length:0;if(u>d){for(0===d&&(d=3*f);u>d;)d*=2;var _=new Uint16Array(d);if(l)for(var c=0,h=l.length;c<h;c++)_[c]=l[c];this.indicesBuffer=_}return!0},(a.prototype=Object.create(_ccsg.Node.WebGLRenderCmd.prototype)).constructor=a;var b=a.prototype;b._tessTol=.25,b._distTol=.01,b.lineWidth=1,b.lineCap=c.BUTT,b.lineJoin=h.MITER,b.miterLimit=10,b.beginPath=function(){this._pathOffset=this._pathLength},b.moveTo=function(t,e){this._updatePathOffset&&(this._pathOffset=this._pathLength,this._updatePathOffset=!1),this._addPath(),this._addPoint(t,e,S.PT_CORNER),this._commandx=t,this._commandy=e},b.lineTo=function(t,e){this._addPoint(t,e,S.PT_CORNER),this._commandx=t,this._commandy=e},b.bezierCurveTo=function(t,e,i,n,r,o){var s=this._curPath,a=s.points[s.points.length-1];a.x!==t||a.y!==e||i!==r||n!==o?(this._tesselateBezier(a.x,a.y,t,e,i,n,r,o,0,S.PT_CORNER),this._commandx=r,this._commandy=o):this.lineTo(r,o)},b.quadraticCurveTo=function(t,e,i,n){var r=this._commandx,o=this._commandy;this.bezierCurveTo(r+2/3*(t-r),o+2/3*(e-o),i+2/3*(t-i),n+2/3*(e-n),i,n)},b.arc=function(t,e,i,n,r,o){u.arc(this,t,e,i,n,r,o)},b.ellipse=function(t,e,i,n){u.ellipse(this,t,e,i,n),this._curPath.complex=!1},b.circle=function(t,e,i){u.ellipse(this,t,e,i,i),this._curPath.complex=!1},b.rect=function(t,e,i,n){this.moveTo(t,e),this.lineTo(t,e+n),this.lineTo(t+i,e+n),this.lineTo(t+i,e),this.close(),this._curPath.complex=!1},b.roundRect=function(t,e,i,n,r){u.roundRect(this,t,e,i,n,r),this._curPath.complex=!1},b.fillRect=function(t,e,i,n){this.rect(t,e,i,n),this.fill()},b.close=function(){this._curPath.closed=!0},b.stroke=function(){this._flattenPaths();var t=this._strokeColor;this._curColorValue=(t.a<<24>>>0)+(t.b<<16)+(t.g<<8)+t.r,this._expandStroke(),this._updatePathOffset=!0},b.fill=function(){var t=this._fillColor;this._curColorValue=(t.a<<24>>>0)+(t.b<<16)+(t.g<<8)+t.r,this._expandFill(),this._updatePathOffset=!0,this._filling=!1},b._strokeColor=null,b._fillColor=null,b.setStrokeColor=function(t){this._strokeColor=t},b.getStrokeColor=function(){return this._strokeColor},b.setFillColor=function(t){this._fillColor=t},b.getFillColor=function(){return this._fillColor},b.setLineWidth=function(t){this.lineWidth=t},b.setLineJoin=function(t){this.lineJoin=t},b.setLineCap=function(t){this.lineCap=t},b.setMiterLimit=function(t){this.miterLimit=t},_.getset(b,"strokeColor",b.getStrokeColor,b.setStrokeColor),_.getset(b,"fillColor",b.getFillColor,b.setFillColor),b._render=function(){var t=this._buffers;if(0!==t.length)for(var e=cc._renderContext,i=0,n=t.length;i<n;i++){var r=t[i];e.bindBuffer(e.ARRAY_BUFFER,r.vertsVBO),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.indicesVBO),r.vertsDirty&&(e.bufferData(e.ARRAY_BUFFER,r.vertsBuffer,e.STREAM_DRAW),r.vertsDirty=!1),r.indicesDirty&&r.indicesBuffer&&(e.bufferData(e.ELEMENT_ARRAY_BUFFER,r.indicesBuffer,e.STREAM_DRAW),r.indicesDirty=!1),e.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_POSITION),e.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_COLOR),e.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_POSITION,2,e.FLOAT,!1,12,0),e.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_COLOR,4,e.UNSIGNED_BYTE,!0,12,8),e.drawElements(e.TRIANGLES,r.indicesOffset,e.UNSIGNED_SHORT,0),cc.g_NumberOfDraws++}},b.rendering=function(){cc.gl.blendFunc(this._blendFunc.src,this._blendFunc.dst);var t=this._worldTransform,e=this._matrix.mat;e[0]=t.a,e[4]=t.c,e[12]=t.tx,e[1]=t.b,e[5]=t.d,e[13]=t.ty;var i=this._shaderProgram;i.use(),i._setUniformForMVPMatrixWithMat4(this._matrix),this._render()},b.clear=function(t){if(this._pathLength=0,this._pathOffset=0,this._pointsOffset=0,this._curPath=null,t)this._paths.length=0,this._points.length=0,this._buffer=null,this._buffers=[];else{for(var e=this._buffers,i=0;i<e.length;i++)e[i].clear();this._buffer=e[0]}},b._updatePathOffset=!1,b._paths=null,b._pathLength=0,b._pathOffset=0,b._points=null,b._pointsOffset=0,b._commandx=0,b._commandy=0,b._addPath=function(){var t=this._pathLength,e=this._paths[t];return e?e.reset():(e=new o,this._paths.push(e)),this._pathLength++,this._curPath=e,e},b._addPoint=function(t,e,i){var n=this._curPath;if(n){var o,s=this._points,a=n.points;(o=s[this._pointsOffset++])?(o.x=t,o.y=e):(o=new r(t,e),s.push(o)),o.flags=i,a.push(o)}},b._flattenPaths=function(){for(var t=this._paths,e=this._pathOffset,i=this._pathLength;e<i;e++){var n=t[e],r=n.points,o=r[r.length-1],s=r[0];o.equals(s)&&(n.closed=!0,r.pop(),o=r[r.length-1]);for(var a=0,c=r.length;a<c;a++){var h=s.sub(o);o.len=h.mag(),(h.x||h.y)&&h.normalizeSelf(),o.dx=h.x,o.dy=h.y,o=s,s=r[a+1]}}},b._allocBuffer=function(){if(this._buffer){var t=this._buffers.indexOf(this._buffer);if(t<this._buffers.length-1)return void(this._buffer=this._buffers[t+1])}var e=new s;this._buffers.push(e),this._buffer=e},b._allocVerts=function(t){this._buffer||this._allocBuffer();var e=3*(t-2*(this._pathLength-this._pathOffset));this._buffer.alloc(t,e)||(this._allocBuffer(),this._buffer.alloc(t,e)),this._buffer.vertsDirty=!0},b._expandStroke=function(){var t=.5*this.lineWidth,e=this.lineCap,i=this.lineJoin,n=this.miterLimit,r=this._curveDivs(t,p,this._tessTol),o=this._paths;this._calculateJoins(t,i,n);for(var s=0,a=this._pathOffset,l=this._pathLength;a<l;a++){T=(m=o[a]).points.length;i===h.ROUND?s+=2*(T+m.nbevel*(r+2)+1):s+=2*(T+5*m.nbevel+1),m.closed||(e===c.ROUND?s+=2*(2*r+2):s+=12)}this._allocVerts(s);for(var u=this._buffer,a=this._pathOffset,l=this._pathLength;a<l;a++){var d,_,f,g,v,m=o[a],y=m.points,T=m.points.length;v=m.closed;var C=u.vertsOffset;if(v?(d=y[T-1],_=y[0],f=0,g=T):(d=y[0],_=y[1],f=1,g=T-1),!v){(R=_.sub(d)).normalizeSelf();var x=R.x,E=R.y;e===c.BUTT?this._buttCap(d,x,E,t,0):e===c.SQUARE?this._buttCap(d,x,E,t,t):e===c.ROUND&&this._roundCapStart(d,x,E,t,r)}for(var b=f;b<g;++b)i===h.ROUND?this._roundJoin(d,_,t,t,r):0!=(_.flags&(S.PT_BEVEL|S.PT_INNERBEVEL))?this._bevelJoin(d,_,t,t):(this._vset(_.x+_.dmx*t,_.y+_.dmy*t),this._vset(_.x-_.dmx*t,_.y-_.dmy*t)),d=_,_=y[b+1];if(v){var A=u.vertsBuffer;this._vset(A[3*C],A[3*C+1]),this._vset(A[3*(C+1)],A[3*(C+1)+1])}else{var R=_.sub(d);R.normalizeSelf();var x=R.x,E=R.y;e===c.BUTT?this._buttCap(_,x,E,t,0):e===c.BUTT||e===c.SQUARE?this._buttCap(_,x,E,t,t):e===c.ROUND&&this._roundCapEnd(_,x,E,t,r)}for(var I=u.indicesOffset,w=u.indicesBuffer,O=C+2,L=u.vertsOffset;O<L;O++)w[I++]=O-2,w[I++]=O-1,w[I++]=O;u.indicesOffset=I,u.indicesDirty=!0}},b._expandFill=function(){for(var t=this._paths,e=0,i=this._pathOffset,n=this._pathLength;i<n;i++)e+=a=(o=t[i]).points.length;this._allocVerts(e);for(var r=this._buffer,i=this._pathOffset,n=this._pathLength;i<n;i++){var o=t[i],s=o.points,a=s.length;if(0!==a){for(var c=r.vertsOffset,h=0;h<a;++h)this._vset(s[h].x,s[h].y,.5,1);var u=o.indicesOffset=r.indicesOffset,d=r.indicesBuffer,_=0;if(o.complex){for(var f=[],p=3*c,g=3*r.vertsOffset,i=p;i<g;i+=3)f.push(r.vertsBuffer[i]),f.push(r.vertsBuffer[i+1]);var v=l(f,null,2);if(!v||0===v.length)continue;for(var h=0,m=_=v.length;h<m;h++)d[u+h]=v[h]+c}else{for(var y=c,p=c+2,g=r.vertsOffset;p<g;p++)d[u++]=y,d[u++]=p-1,d[u++]=p;_=u-r.indicesOffset}r.indicesOffset+=_,r.indicesDirty=!0}}},b._curveDivs=function(t,e,i){var n=2*y(t/(t+i));return v(2,m(e/n))},b._calculateJoins=function(t,e,i){var n=0;t>0&&(n=1/t);for(var r=this._paths,o=this._pathOffset,s=this._pathLength;o<s;o++){var a=r[o],c=a.points,l=c.length,u=c[l-1],d=c[0];a.nbevel=0;for(var _=0;_<l;_++){var f,p,m=u.dy,y=-u.dx,T=d.dy,C=-d.dx;if(d.dmx=.5*(m+T),d.dmy=.5*(y+C),(f=d.dmx*d.dmx+d.dmy*d.dmy)>1e-6){var x=1/f;x>600&&(x=600),d.dmx*=x,d.dmy*=x}d.dx*u.dy-u.dx*d.dy>0&&(0,d.flags|=S.PT_LEFT),f*(p=v(11,g(u.len,d.len)*n))*p<1&&(d.flags|=S.PT_INNERBEVEL),d.flags&S.PT_CORNER&&(f*i*i<1||e===h.BEVEL||e===h.ROUND)&&(d.flags|=S.PT_BEVEL),0!=(d.flags&(S.PT_BEVEL|S.PT_INNERBEVEL))&&a.nbevel++,u=d,d=c[_+1]}}},b._vset=function(t,e){var i=this._buffer,n=3*i.vertsOffset,r=i.vertsBuffer;r[n]=t,r[n+1]=e,i.uint32VertsBuffer[n+2]=this._curColorValue,i.vertsOffset++},b._chooseBevel=function(t,e,i,n){var r,o,s,a,c=i.x,h=i.y;return 0!==t?(r=c+e.dy*n,o=h-e.dx*n,s=c+i.dy*n,a=h-i.dx*n):(r=s=c+i.dmx*n,o=a=h+i.dmy*n),[r,o,s,a]},b._buttCap=function(t,e,i,n,r){var o=t.x-e*r,s=t.y-i*r,a=i,c=-e;this._vset(o+a*n,s+c*n),this._vset(o-a*n,s-c*n)},b._roundCapStart=function(t,e,i,n,r){for(var o=t.x,s=t.y,a=i,c=-e,h=0;h<r;h++){var l=h/(r-1)*p,u=T(l)*n,d=C(l)*n;this._vset(o-a*u-e*d,s-c*u-i*d),this._vset(o,s)}this._vset(o+a*n,s+c*n),this._vset(o-a*n,s-c*n)},b._roundCapEnd=function(t,e,i,n,r){var o=t.x,s=t.y,a=i,c=-e;this._vset(o+a*n,s+c*n),this._vset(o-a*n,s-c*n);for(var h=0;h<r;h++){var l=h/(r-1)*p,u=T(l)*n,d=C(l)*n;this._vset(o,s),this._vset(o-a*u+e*d,s-c*u+i*d)}},b._roundJoin=function(t,e,i,r,o){var s=t.dy,a=-t.dx,c=e.dy,h=-e.dx,l=e.x,u=e.y;if(0!=(e.flags&S.PT_LEFT)){var d=(R=this._chooseBevel(e.flags&S.PT_INNERBEVEL,t,e,i))[0],_=R[1],f=R[2],g=R[3],v=x(-a,-s);(P=x(-h,-c))>v&&(P-=2*p),this._vset(d,_),this._vset(l-s*r,e.y-a*r);for(var y=n(m((v-P)/p)*o,2,o),E=0;E<y;E++){var b=l+T(N=v+(D=E/(y-1))*(P-v))*r,A=u+C(N)*r;this._vset(l,u),this._vset(b,A)}this._vset(f,g),this._vset(l-c*r,u-h*r)}else{var R=this._chooseBevel(e.flags&S.PT_INNERBEVEL,t,e,-r),I=R[0],w=R[1],O=R[2],L=R[3],v=x(a,s),P=x(h,c);P<v&&(P+=2*p),this._vset(l+s*r,u+a*r),this._vset(I,w);for(var y=n(m((P-v)/p)*o,2,o),E=0;E<y;E++){var D=E/(y-1),N=v+D*(P-v),F=l+T(N)*i,M=u+C(N)*i;this._vset(F,M),this._vset(l,u)}this._vset(l+c*r,u+h*r),this._vset(O,L)}},b._bevelJoin=function(t,e,i,n){var r,o,s,a,c,h,l,u,d=t.dy,_=-t.dx,f=e.dy,p=-e.dx;if(e.flags&S.PT_LEFT)c=(g=this._chooseBevel(e.flags&S.PT_INNERBEVEL,t,e,i))[0],h=g[1],l=g[2],u=g[3],this._vset(c,h),this._vset(e.x-d*n,e.y-_*n),this._vset(l,u),this._vset(e.x-f*n,e.y-p*n);else{var g=this._chooseBevel(e.flags&S.PT_INNERBEVEL,t,e,-n);r=g[0],o=g[1],s=g[2],a=g[3],this._vset(e.x+d*i,e.y+_*i),this._vset(r,o),this._vset(e.x+f*i,e.y+p*i),this._vset(s,a)}},b._tesselateBezier=function(t,e,i,n,r,o,s,a,c,h){var l,u,d,_,f,p,g,v,m,y,T,C,x,b,A,R;c>10||(f=.5*(r+s),p=.5*(o+a),g=.5*((l=.5*(t+i))+(d=.5*(i+r))),v=.5*((u=.5*(e+n))+(_=.5*(n+o))),((A=E((i-s)*(b=a-e)-(n-a)*(x=s-t)))+(R=E((r-s)*b-(o-a)*x)))*(A+R)<this._tessTol*(x*x+b*b)?this._addPoint(s,a,0===h?h|S.PT_BEVEL:h):(T=.5*(g+(m=.5*(d+f))),C=.5*(v+(y=.5*(_+p))),this._tesselateBezier(t,e,l,u,g,v,T,C,c+1,0),this._tesselateBezier(T,C,m,y,f,p,s,a,c+1,h)))},e.exports=a}),{"./earcut":113,"./helper":118,"./types":120}],117:[(function(t,e,i){var n=t("./types").LineCap,r=t("./types").LineJoin,o=cc.Class({name:"cc.Graphics",extends:cc._RendererUnderSG,editor:!1,properties:{_lineWidth:1,_strokeColor:cc.Color.BLACK,_lineJoin:r.MITER,_lineCap:n.BUTT,_fillColor:cc.Color.WHITE,_miterLimit:10,lineWidth:{get:function(){return this._lineWidth},set:function(t){this._sgNode.lineWidth=this._lineWidth=t}},lineJoin:{get:function(){return this._lineJoin},set:function(t){this._sgNode.lineJoin=this._lineJoin=t},type:r},lineCap:{get:function(){return this._lineCap},set:function(t){this._sgNode.lineCap=this._lineCap=t},type:n},strokeColor:{get:function(){return this._strokeColor},set:function(t){this._sgNode.strokeColor=this._strokeColor=t}},fillColor:{get:function(){return this._fillColor},set:function(t){this._sgNode.fillColor=this._fillColor=t}},miterLimit:{get:function(){return this._miterLimit},set:function(t){this._sgNode.miterLimit=this._miterLimit=t}}},statics:{LineJoin:r,LineCap:n},_createSgNode:function(){return new _ccsg.GraphicsNode},_initSgNode:function(){var t=this._sgNode;t.lineWidth=this._lineWidth,t.lineJoin=this._lineJoin,t.lineCap=this._lineCap,t.strokeColor=this._strokeColor,t.fillColor=this._fillColor,t.miterLimit=this._miterLimit,t.setContentSize(this.node.getContentSize(!0))},moveTo:function(t,e){this._sgNode.moveTo(t,e)},lineTo:function(t,e){this._sgNode.lineTo(t,e)},bezierCurveTo:function(t,e,i,n,r,o){this._sgNode.bezierCurveTo(t,e,i,n,r,o)},quadraticCurveTo:function(t,e,i,n){this._sgNode.quadraticCurveTo(t,e,i,n)},arc:function(t,e,i,n,r,o){o=o||!1,this._sgNode.arc(t,e,i,n,r,o)},ellipse:function(t,e,i,n){this._sgNode.ellipse(t,e,i,n)},circle:function(t,e,i){this._sgNode.circle(t,e,i)},rect:function(t,e,i,n){this._sgNode.rect(t,e,i,n)},roundRect:function(t,e,i,n,r){this._sgNode.roundRect(t,e,i,n,r)},fillRect:function(t,e,i,n){this._sgNode.fillRect(t,e,i,n)},clear:function(t){this._sgNode.clear(!!t)},close:function(){this._sgNode.close()},stroke:function(){this._sgNode.stroke()},fill:function(){this._sgNode.fill()}});cc.Graphics=e.exports=o}),{"./types":120}],118:[(function(t,e,i){var n=Math.PI,r=Math.min,o=Math.max,s=Math.cos,a=Math.sin,c=Math.abs,h=Math.sign,l=.5522847493;e.exports={arc:function(t,e,i,h,l,u,d){var _,f,p=0,g=0,v=0,m=0,y=0,T=0,C=0,x=0,E=0,S=0,b=0,A=0,R=0,I=0;if(g=u-l,d=d||!1)if(c(g)>=2*n)g=2*n;else for(;g<0;)g+=2*n;else if(c(g)>=2*n)g=2*-n;else for(;g>0;)g-=2*n;for(f=0|o(1,r(c(g)/(.5*n)+.5,5)),m=c(4/3*(1-s(v=g/f/2))/a(v)),d||(m=-m),_=0;_<=f;_++)C=e+(y=s(p=l+g*(_/f)))*h,x=i+(T=a(p))*h,E=-T*h*m,S=y*h*m,0===_?t.moveTo(C,x):t.bezierCurveTo(b+R,A+I,C-E,x-S,C,x),b=C,A=x,R=E,I=S},ellipse:function(t,e,i,n,r){t.moveTo(e-n,i),t.bezierCurveTo(e-n,i+r*l,e-n*l,i+r,e,i+r),t.bezierCurveTo(e+n*l,i+r,e+n,i+r*l,e+n,i),t.bezierCurveTo(e+n,i-r*l,e+n*l,i-r,e,i-r),t.bezierCurveTo(e-n*l,i-r,e-n,i-r*l,e-n,i),t.close()},roundRect:function(t,e,i,n,o,s){if(s<.1)t.rect(e,i,n,o);else{var a=r(s,.5*c(n))*h(n),u=r(s,.5*c(o))*h(o);t.moveTo(e,i+u),t.lineTo(e,i+o-u),t.bezierCurveTo(e,i+o-u*(1-l),e+a*(1-l),i+o,e+a,i+o),t.lineTo(e+n-a,i+o),t.bezierCurveTo(e+n-a*(1-l),i+o,e+n,i+o-u*(1-l),e+n,i+o-u),t.lineTo(e+n,i+u),t.bezierCurveTo(e+n,i+u*(1-l),e+n-a*(1-l),i,e+n-a,i),t.lineTo(e+a,i),t.bezierCurveTo(e+a*(1-l),i,e,i+u*(1-l),e,i+u),t.close()}}}}),{}],119:[(function(t,e,i){"use strict";var n;(n=cc.sys.isNative?_ccsg.GraphicsNode=cc.GraphicsNode:_ccsg.GraphicsNode=t("./graphics-node"))&&t("../utils/misc").propertyDefine(n,["lineWidth","lineCap","lineJoin","miterLimit","strokeColor","fillColor"],{}),t("./graphics")}),{"../utils/misc":196,"./graphics":117,"./graphics-node":115}],120:[(function(t,e,i){"use strict";var n=cc.Enum({BUTT:0,ROUND:1,SQUARE:2}),r=cc.Enum({BEVEL:0,ROUND:1,MITER:2});e.exports={LineCap:n,LineJoin:r}}),{}],121:[(function(t,e,i){t("./platform/index.js"),t("./assets/index.js"),t("./CCNode"),t("./CCScene"),t("./components/index.js"),t("./graphics/index.js"),t("./collider/index.js"),t("./physics/index.js"),t("./camera/CCCamera"),t("./base-ui/CCWidgetManager")}),{"./CCNode":41,"./CCScene":42,"./assets/index.js":55,"./base-ui/CCWidgetManager":60,"./camera/CCCamera":61,"./collider/index.js":70,"./components/index.js":100,"./graphics/index.js":119,"./physics/index.js":1,"./platform/index.js":164}],122:[(function(t,e,i){var n=/^(click)(\s)*=/,r=/(\s)*src(\s)*=|(\s)*height(\s)*=|(\s)*width(\s)*=|(\s)*click(\s)*=/;cc.HtmlTextParser=function(){this._parsedObject={},this._specialSymbolArray=[],this._specialSymbolArray.push([/&lt;/g,"<"]),this._specialSymbolArray.push([/&gt;/g,">"]),this._specialSymbolArray.push([/&amp;/g,"&"]),this._specialSymbolArray.push([/&quot;/g,'"']),this._specialSymbolArray.push([/&apos;/g,"'"])},cc.HtmlTextParser.prototype={constructor:cc.HtmlTextParser,parse:function(t){this._resultObjectArray=[],this._stack=[];for(var e=0,i=t.length;e<i;){var n=t.indexOf("<",e);if(n<0)this._stack.pop(),this._processResult(t.substring(e)),e=i;else{this._processResult(t.substring(e,n));var r=t.indexOf(">",e);-1===r?r=n:"/"===t.charAt(n+1)?this._stack.pop():this._addToStack(t.substring(n+1,r)),e=r+1}}return this._resultObjectArray},_attributeToObject:function(t){var e,i,n,o,s={},a=(t=t.trim()).match(/^(color|size)(\s)*=/);if(a){if(e=a[0],""===(t=t.substring(e.length).trim()))return s;switch(i=t.indexOf(" "),e[0]){case"c":s.color=i>-1?t.substring(0,i).trim():t;break;case"s":s.size=parseInt(t)}return i>-1&&(o=t.substring(i+1).trim(),n=this._processEventHandler(o),s.event=n),s}if((a=t.match(/^(br(\s)*\/)/))&&a[0].length>0&&(e=a[0].trim()).startsWith("br")&&"/"===e[e.length-1])return s.isNewLine=!0,this._resultObjectArray.push({text:"",style:{newline:!0}}),s;if((a=t.match(/^(img(\s)*src(\s)*=[^>]+\/)/))&&a[0].length>0&&(e=a[0].trim()).startsWith("img")&&"/"===e[e.length-1]){a=t.match(r);for(var c,h=!1;a;)e=(t=t.substring(t.indexOf(a[0]))).substr(0,a[0].length),d=(i=(c=t.substring(e.length).trim()).indexOf(" "))>-1?c.substr(0,i):c,e=(e=e.replace(/[^a-zA-Z]/g,"").trim()).toLocaleLowerCase(),t=c.substring(i).trim(),"src"===e?(s.isImage=!0,d.endsWith("/")&&(d=d.substring(0,d.length-1)),0===d.indexOf("'")?(h=!0,d=d.substring(1,d.length-1)):0===d.indexOf('"')&&(h=!0,d=d.substring(1,d.length-1)),s.src=d):"height"===e?s.imageHeight=parseInt(d):"width"===e?s.imageWidth=parseInt(d):"click"===e&&(s.event=this._processEventHandler(e+"="+d)),a=t.match(r);return h&&s.isImage&&this._resultObjectArray.push({text:"",style:s}),{}}if(a=t.match(/^(outline(\s)*[^>]*)/)){var l={color:"#ffffff",width:1};if(t=a[0].substring("outline".length).trim()){var u=/(\s)*color(\s)*=|(\s)*width(\s)*=|(\s)*click(\s)*=/;a=t.match(u);for(var d;a;)e=(t=t.substring(t.indexOf(a[0]))).substr(0,a[0].length),d=(i=(c=t.substring(e.length).trim()).indexOf(" "))>-1?c.substr(0,i):c,e=(e=e.replace(/[^a-zA-Z]/g,"").trim()).toLocaleLowerCase(),t=c.substring(i).trim(),"click"===e?s.event=this._processEventHandler(e+"="+d):"color"===e?l.color=d:"width"===e&&(l.width=parseInt(d)),a=t.match(u)}s.outline=l}if((a=t.match(/^(on|u|b|i)(\s)*/))&&a[0].length>0){switch(e=a[0],t=t.substring(e.length).trim(),e[0]){case"u":s.underline=!0;break;case"i":s.italic=!0;break;case"b":s.bold=!0}if(""===t)return s;n=this._processEventHandler(t),s.event=n}return s},_processEventHandler:function(t){for(var e=0,i={},r=t.match(n),o=!1;r;){var s=r[0],a="";if(o=!1,'"'===(t=t.substring(s.length).trim()).charAt(0))(e=t.indexOf('"',1))>-1&&(a=t.substring(1,e).trim(),o=!0),e++;else if("'"===t.charAt(0))(e=t.indexOf("'",1))>-1&&(a=t.substring(1,e).trim(),o=!0),e++;else{var c=t.match(/(\S)+/);e=(a=c?c[0]:"").length}o&&(i[s=s.substring(0,s.length-1).trim()]=a),r=(t=t.substring(e).trim()).match(n)}return i},_addToStack:function(t){var e=this._attributeToObject(t);if(0===this._stack.length)this._stack.push(e);else{if(e.isNewLine||e.isImage)return;var i=this._stack[this._stack.length-1];for(var n in i)e[n]||(e[n]=i[n]);this._stack.push(e)}},_processResult:function(t){""!==t&&(t=this._escapeSpecialSymbol(t),this._stack.length>0?this._resultObjectArray.push({text:t,style:this._stack[this._stack.length-1]}):this._resultObjectArray.push({text:t}))},_escapeSpecialSymbol:function(t){for(var e=0;e<this._specialSymbolArray.length;++e){var i=this._specialSymbolArray[e][0],n=this._specialSymbolArray[e][1];t=t.replace(i,n)}return t}},cc.htmlTextParser=new cc.HtmlTextParser}),{}],123:[(function(t,e,i){t("./CCTextUtils");var n=t("../event/event-target"),r=t("../platform/js"),o=function(){this._u=0,this._v=0,this._width=0,this._height=0,this._offsetX=0,this._offsetY=0,this._textureID=0,this._validDefinition=!1,this._xAdvance=0};cc.FontAtlas=function(t){this._lineHeight=t.commonHeight,this._fontSize=t.fontSize,this._letterDefinitions={},this._fntConfig=t},cc.FontAtlas.prototype={constructor:cc.FontAtlas,setFontSize:function(t){this._fontSize=t},getOriginalFontSize:function(){return this._fntConfig.fontSize},addLetterDefinitions:function(t,e){this._letterDefinitions[t]=e},cloneLetterDefinition:function(){var t={};for(var e in this._letterDefinitions){var i=new o;cc.js.mixin(i,this._letterDefinitions[e]),t[e]=i}return t},assignLetterDefinitions:function(t){for(var e in this._letterDefinitions){var i=t[e],n=this._letterDefinitions[e];cc.js.mixin(n,i)}},scaleFontLetterDefinition:function(t){for(var e in this._letterDefinitions){var i=this._letterDefinitions[e];i._width*=t,i._height*=t,i._offsetX*=t,i._offsetY*=t,i._xAdvance*=t}},getLetterDefinitionForChar:function(t){return this._letterDefinitions.hasOwnProperty(t.charCodeAt(0))?this._letterDefinitions[t.charCodeAt(0)]:null}};var s=function(){this._char="",this._valid=!0,this._positionX=0,this._positionY=0,this._atlasIndex=0,this._lineIndex=0};_ccsg.Label=_ccsg.Node.extend({_hAlign:cc.TextAlignment.LEFT,_vAlign:cc.VerticalTextAlignment.TOP,_string:"",_fontSize:40,_drawFontsize:40,_overFlow:0,_isWrapText:!0,_spacingX:0,_blendFunc:null,_labelType:0,_fontHandle:"",_lineSpacing:0,_maxLineWidth:0,_labelDimensions:cc.size(0,0),_labelWidth:0,_labelHeight:0,_lineHeight:40,_outlined:!1,_outlineColor:null,_outlineWidth:1,_gradientEnabled:!1,_gradientStartColor:cc.color(255,255,255,255),_gradientEndColor:cc.color(255,255,255,255),_gradientDirection:0,_className:"Label",_margin:0,_isBold:!1,_isItalic:!1,_isUnderline:!1,_fontAsset:null,ctor:function(t,e){n.call(this);var i=e instanceof cc.Font,r=i?e.rawUrl:"";this._fontHandle=r,"string"!=typeof t&&(t=""+t),this._string=t,_ccsg.Node.prototype.ctor.call(this),this.setAnchorPoint(.5,.5),_ccsg.Node.prototype.setContentSize.call(this,128,128),this._blendFunc=cc.BlendFunc._alphaNonPremultiplied(),this._imageOffset=cc.p(0,0),this._numberOfLines=0,this._lettersInfo=[],this._linesWidth=[],this._linesOffsetX=[],this._horizontalKernings=[],this._reusedRect=cc.rect(0,0,0,0),i?this.setFontAsset(e):this.setFontFamily(r),this.setString(this._string)},_resetBMFont:function(){this._imageOffset.x=this._imageOffset.y=0,this._cascadeColorEnabled=!0,this._cascadeOpacityEnabled=!0,this._fontAtlas=null,this._config=null,this._numberOfLines=0,this._lettersInfo.length=0,this._linesWidth.length=0,this._linesOffsetX.length=0,this._textDesiredHeight=0,this._letterOffsetY=0,this._tailoredTopY=0,this._tailoredBottomY=0,this._bmfontScale=1,this._horizontalKernings.length=0,this._lineBreakWithoutSpaces=!1,this._reusedRect.x=this._reusedRect.y=this._reusedRect.width=this._reusedRect.height=0,this._textureLoaded=!1,this._spriteBatchNode&&(this.removeChild(this._spriteBatchNode),this._spriteBatchNode=null)},setHorizontalAlign:function(t){this._hAlign!==t&&(this._hAlign=t,this._notifyLabelSkinDirty())},getHorizontalAlign:function(){return this._hAlign},setVerticalAlign:function(t){this._vAlign!==t&&(this._vAlign=t,this._notifyLabelSkinDirty())},getVerticalAlign:function(){return this._vAlign},setString:function(t){"string"!=typeof t&&(t=""+t),this._string!==t&&(this._string=t,this._notifyLabelSkinDirty())},setMargin:function(t){this._margin!==t&&(this._margin=t,this._notifyLabelSkinDirty())},getString:function(){return this._string},getStringLength:function(){return this._string.length},enableWrapText:function(t){this._isWrapText!==t&&this._overFlow!==_ccsg.Label.Overflow.RESIZE_HEIGHT&&this._overFlow!==_ccsg.Label.Overflow.NONE&&(this._isWrapText=t,this._rescaleWithOriginalFontSize(),this._notifyLabelSkinDirty())},enableItalics:function(t){this._isItalic=t,t?this.setSkewX(12):this.setSkewX(0)},enableBold:function(t){this._isBold!==t&&(this._isBold=t,this._notifyLabelSkinDirty())},enableUnderline:function(t){this._isUnderline!==t&&(this._isUnderline=t,this._notifyLabelSkinDirty())},isWrapTextEnabled:function(){return this._isWrapText},getFontName:function(){return this._fontHandle},setFontSize:function(t){this._fontSize!==t&&(this._fontSize=t,this._drawFontsize=t,this._notifyLabelSkinDirty())},getFontSize:function(){return this._fontSize},isOutlined:function(){return this._outlined},setOutlined:function(t){this._outlined!==t&&(this._outlined=!!t,this._notifyLabelSkinDirty())},setFillColorGradientEnabled:function(t){this._gradientEnabled!==t&&(this._gradientEnabled=!!t,this._notifyLabelSkinDirty())},getFillColorGradientEnabled:function(){return this._gradientEnabled},setGradientStartColor:function(t){this._gradientStartColor!==t&&(this._gradientStartColor=t,this._notifyLabelSkinDirty())},getGradientStartColor:function(){return this._gradientStartColor},setGradientEndColor:function(t){this._gradientEndColor!==t&&(this._gradientEndColor=t,this._notifyLabelSkinDirty())},getGradientEndColor:function(){return this._gradientEndColor},setFillColorGradientDirection:function(t){this._gradientDirection=t,this._notifyLabelSkinDirty()},getFillColorGradientDirection:function(){return this._gradientDirection},getOutlineColor:function(){return this._outlineColor},setOutlineColor:function(t){this._outlineColor!==t&&(this._outlineColor=cc.color(t),this._notifyLabelSkinDirty())},setOutlineWidth:function(t){this._outlineWidth!==t&&(this._outlineWidth=t,this._notifyLabelSkinDirty())},getOutlineWidth:function(){return this._outlineWidth},_updateWrapText:function(t){t===_ccsg.Label.Overflow.RESIZE_HEIGHT&&(this._isWrapText=!0),t===_ccsg.Label.Overflow.NONE&&(this._isWrapText=!1)},_setOverflowBMFont:function(){this._labelType===_ccsg.Label.Type.BMFont&&(this._overFlow===_ccsg.Label.Overflow.RESIZE_HEIGHT&&this._setDimensions(this._labelDimensions.width,0),this._overFlow===_ccsg.Label.Overflow.NONE&&this._setDimensions(0,0),this._rescaleWithOriginalFontSize())},setOverflow:function(t){this._overFlow!==t&&(this._overFlow=t,this._updateWrapText(this._overFlow),this._setOverflowBMFont(),this._notifyLabelSkinDirty())},getOverflow:function(){return this._overFlow},setSpacingX:function(t){this._spacingX!==t&&(this._spacingX=t,this._notifyLabelSkinDirty())},setLineHeight:function(t){this._lineHeight!==t&&(this._lineHeight=t,this._notifyLabelSkinDirty())},setLineBreakWithoutSpace:function(t){this._lineBreakWithoutSpaces!==t&&(this._lineBreakWithoutSpaces=t,this._notifyLabelSkinDirty())},getSpacingX:function(){return this._spacingX},getLineHeight:function(){return this._lineHeight},getBMFontLineHeight:function(){if(this._fontAtlas)return this._fontAtlas._lineHeight},setFontFamily:function(t){this._resetBMFont(),this._fontHandle=t||"Arial",this._labelType=_ccsg.Label.Type.SystemFont,this._blendFunc=cc.BlendFunc._alphaPremultiplied(),this._renderCmd._needDraw=!0,this._notifyLabelSkinDirty(),this.emit("load")},setFontAsset:function(t){this._fontAsset=t;var e=t instanceof cc.Font;if(e){var i=e?t.rawUrl:"",n=cc.path.extname(i);this._resetBMFont(),".ttf"===n?(this._labelType=_ccsg.Label.Type.TTF,this._blendFunc=cc.BlendFunc._alphaPremultiplied(),this._renderCmd._needDraw=!0,this._fontHandle=this._loadTTFFont(i)):t.spriteFrame&&(this._labelType=_ccsg.Label.Type.BMFont,this._blendFunc=cc.BlendFunc._alphaNonPremultiplied(),this._renderCmd._needDraw=!1,this._initBMFontWithString(this._string,t)),this._notifyLabelSkinDirty()}else this.setFontFamily("")},_loadTTFFont:function(t){var e=this,i=cc.CustomFontLoader._getFontFamily(t);return cc.CustomFontLoader.loadTTF(t,(function(){e._notifyLabelSkinDirty(),e.emit("load")})),i},setContentSize:function(t,e){this._overFlow!==_ccsg.Label.Overflow.NONE&&this._setDimensions(t,e)},setBlendFunc:function(t,e){var i=this._blendFunc;void 0===e?(i.src=t.src,i.dst=t.dst):(i.src=t,i.dst=e)},getBlendFunc:function(){return new cc.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},_setupBMFontOverflowMetrics:function(t,e){this._overFlow===_ccsg.Label.Overflow.RESIZE_HEIGHT&&(e=0),this._overFlow===_ccsg.Label.Overflow.NONE&&(t=0,e=0),this._labelWidth=t,this._labelHeight=e,this._labelDimensions.width=t,this._labelDimensions.height=e,this._maxLineWidth=t},_updateLabel:function(){if(this._labelType===_ccsg.Label.Type.BMFont){var t=this._contentSize,e=t.width,i=t.height;this._setupBMFontOverflowMetrics(e,i),this._updateContent(),this.setColor(this.color)}else this._labelType!==_ccsg.Label.Type.TTF&&this._labelType!==_ccsg.Label.Type.SystemFont||this._renderCmd._bakeLabel()},_notifyLabelSkinDirty:function(){this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.textDirty|_ccsg.Node._dirtyFlags.contentDirty)},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_WEBGL?new _ccsg.Label.WebGLRenderCmd(this):new _ccsg.Label.CanvasRenderCmd(this)},getContentSize:function(){return this._renderCmd._dirtyFlag&_ccsg.Node._dirtyFlags.textDirty&&(this._updateLabel(),this._renderCmd._dirtyFlag&=~_ccsg.Node._dirtyFlags.textDirty),_ccsg.Node.prototype.getContentSize.call(this)},_getWidth:function(){return this._renderCmd._dirtyFlag&_ccsg.Node._dirtyFlags.textDirty&&(this._updateLabel(),this._renderCmd._dirtyFlag&=~_ccsg.Node._dirtyFlags.textDirty),_ccsg.Node.prototype._getWidth.call(this)},_getHeight:function(){return this._renderCmd._dirtyFlag&_ccsg.Node._dirtyFlags.textDirty&&(this._updateLabel(),this._renderCmd._dirtyFlag&=~_ccsg.Node._dirtyFlags.textDirty),_ccsg.Node.prototype._getHeight.call(this)},_alignText:function(){var t=!0;do{if(!this._spriteBatchNode)return!0;if(this._textDesiredHeight=0,this._linesWidth=[],this._lineBreakWithoutSpaces?this._multilineTextWrapByChar():this._multilineTextWrapByWord(),this._computeAlignmentOffset(),this._overFlow===_ccsg.Label.Overflow.SHRINK&&this.getFontSize()>0&&this._isVerticalClamp()&&this._shrinkLabelToContentSize(this._isVerticalClamp.bind(this)),!this._updateQuads()){t=!1,this._overFlow===_ccsg.Label.Overflow.SHRINK&&this._shrinkLabelToContentSize(this._isHorizontalClamp.bind(this));break}}while(0);return t},_isHorizontalClamped:function(t,e){var i=this._linesWidth[e],n=t>this._contentSize.width||t<0;return this._isWrapText?i>this._contentSize.width&&n:n},_updateQuads:function(){var t=!0;this._spriteBatchNode.removeAllChildren();for(var e=0;e<this._string.length;++e)if(this._lettersInfo[e]._valid){var i=this._fontAtlas._letterDefinitions[this._lettersInfo[e]._char];this._reusedRect.height=i._height,this._reusedRect.width=i._width,this._reusedRect.x=i._u,this._reusedRect.y=i._v;var n=this._lettersInfo[e]._positionY+this._letterOffsetY;if(this._labelHeight>0){if(n>this._tailoredTopY){var r=n-this._tailoredTopY;this._reusedRect.y+=r,this._reusedRect.height-=r,n-=r}n-i._height*this._bmfontScale<this._tailoredBottomY&&(this._reusedRect.height=n<this._tailoredBottomY?0:n-this._tailoredBottomY)}var o=this._lettersInfo[e]._lineIndex,s=this._lettersInfo[e]._positionX+i._width/2*this._bmfontScale+this._linesOffsetX[o];if(this._labelWidth>0&&this._isHorizontalClamped(s,o))if(this._overFlow===_ccsg.Label.Overflow.CLAMP)this._reusedRect.width=0;else if(this._overFlow===_ccsg.Label.Overflow.SHRINK){if(this._contentSize.width>i._width){t=!1;break}this._reusedRect.width=0}if(this._reusedRect.height>0&&this._reusedRect.width>0){var a=this.getChildByTag(e),c=this._spriteBatchNode._texture,h=this._spriteFrame,l=this._spriteFrame.isRotated(),u=h._originalSize,d=h._rect,_=h._offset,f=_.x+(u.width-d.width)/2,p=_.y-(u.height-d.height)/2;if(l){var g=this._reusedRect.x;this._reusedRect.x=d.x+d.height-this._reusedRect.y-this._reusedRect.height-p,this._reusedRect.y=g+d.y-f,this._reusedRect.y<0&&(this._reusedRect.height=this._reusedRect.height+p)}else this._reusedRect.x+=d.x-f,this._reusedRect.y+=d.y+p;a?a.setTextureRect(this._reusedRect,l):((a=new _ccsg.Sprite).initWithTexture(c,this._reusedRect,l),a.setAnchorPoint(cc.p(0,1)));var v=this._lettersInfo[e]._positionX+this._linesOffsetX[this._lettersInfo[e]._lineIndex];a.setPosition(v,n);var m=this._spriteBatchNode.getChildrenCount();this._lettersInfo[e]._atlasIndex=m,this._updateLetterSpriteScale(a),this._spriteBatchNode.addChild(a)}}return t},_updateLetterSpriteScale:function(t){this._labelType===_ccsg.Label.Type.BMFont&&this._fontSize>0&&t.setScale(this._bmfontScale)},_recordPlaceholderInfo:function(t,e){if(t>=this._lettersInfo.length){var i=new s;this._lettersInfo.push(i)}this._lettersInfo[t]._char=e,this._lettersInfo[t]._valid=!1},_recordLetterInfo:function(t,e,i,n){if(i>=this._lettersInfo.length){var r=new s;this._lettersInfo.push(r)}e=e.charCodeAt(0),this._lettersInfo[i]._lineIndex=n,this._lettersInfo[i]._char=e,this._lettersInfo[i]._valid=this._fontAtlas._letterDefinitions[e]._validDefinition,this._lettersInfo[i]._positionX=t.x,this._lettersInfo[i]._positionY=t.y},_setDimensions:function(t,e){var i="number"==typeof t.width?t.width:t,n="number"==typeof t.height?t.height:e,r=this.getContentSize();_ccsg.Node.prototype.setContentSize.call(this,t,e),n===r.height&&i===r.width||(this._setupBMFontOverflowMetrics(i,n),this._drawFontsize>0&&this._restoreFontSize(),this._notifyLabelSkinDirty())},_restoreFontSize:function(){this._fontSize=this._drawFontsize},_multilineTextWrap:function(t){var e=this.getStringLength(),i=0,n=0,r=0,o=0,s=0,a=this._lineSpacing,c=0,h=0,l=null,u=cc.p(0,0);this._updateBMFontScale();for(var d=0;d<e;){var _=this._string.charAt(d);if("\n"!==_){for(var f=t(this._string,d,e),p=c,g=h,v=s,m=n,y=!1,T=0;T<f;++T){var C=d+T;if("\r"!==(_=this._string.charAt(C)))if(l=this._fontAtlas.getLetterDefinitionForChar(_)){var x=m+l._offsetX*this._bmfontScale;if(this._isWrapText&&this._maxLineWidth>0&&n>0&&x+l._width*this._bmfontScale>this._maxLineWidth&&!cc.TextUtils.isUnicodeSpace(_)){this._linesWidth.push(s),s=0,i++,n=0,r-=this._lineHeight*this._bmfontScale+a,y=!0;break}u.x=x,u.y=r-l._offsetY*this._bmfontScale,this._recordLetterInfo(u,_,C,i),C+1<this._horizontalKernings.length&&C<e-1&&(m+=this._horizontalKernings[C+1]),m+=l._xAdvance*this._bmfontScale+this._spacingX,v=u.x+l._width*this._bmfontScale,p<u.y&&(p=u.y),g>u.y-l._height*this._bmfontScale&&(g=u.y-l._height*this._bmfontScale)}else this._recordPlaceholderInfo(C,_),console.log("Can't find letter definition in texture atlas "+this._config.atlasName+" for letter:"+_);else this._recordPlaceholderInfo(C,_)}y||(n=m,s=v,c<p&&(c=p),h>g&&(h=g),o<s&&(o=s),d+=f)}else this._linesWidth.push(s),s=0,i++,n=0,r-=this._lineHeight*this._bmfontScale+a,this._recordPlaceholderInfo(d,_),d++}this._linesWidth.push(s),this._numberOfLines=i+1,this._textDesiredHeight=this._numberOfLines*this._lineHeight*this._bmfontScale,this._numberOfLines>1&&(this._textDesiredHeight+=(this._numberOfLines-1)*this._lineSpacing);var E=cc.size(this._labelWidth,this._labelHeight);return this._labelWidth<=0&&(E.width=parseFloat(o.toFixed(2))),this._labelHeight<=0&&(E.height=parseFloat(this._textDesiredHeight.toFixed(2))),_ccsg.Node.prototype.setContentSize.call(this,E),this._tailoredTopY=E.height,this._tailoredBottomY=0,c>0&&(this._tailoredTopY=E.height+c),h<-this._textDesiredHeight&&(this._tailoredBottomY=this._textDesiredHeight+h),!0},_multilineTextWrapByWord:function(){return this._multilineTextWrap(this._getFirstWordLen.bind(this))},_multilineTextWrapByChar:function(){return this._multilineTextWrap(this._getFirstCharLen.bind(this))},_isVerticalClamp:function(){return this._textDesiredHeight>this._contentSize.height},_isHorizontalClamp:function(){for(var t=!1,e=0;e<this.getStringLength();++e)if(this._lettersInfo[e]._valid){var i=this._fontAtlas._letterDefinitions[this._lettersInfo[e]._char],n=this._lettersInfo[e]._positionX+i._width/2*this._bmfontScale,r=this._lettersInfo[e]._lineIndex;if(this._labelWidth>0)if(this._isWrapText){if(this._linesWidth[r]>this._contentSize.width&&(n>this._contentSize.width||n<0)){t=!0;break}}else if(n>this._contentSize.width){t=!0;break}}return t},_shrinkLabelToContentSize:function(t){for(var e=this.getFontSize(),i=0,n=this._fontAtlas.cloneLetterDefinition(),r=this._lineHeight,o=!0;t();){var s=e-++i;if(o=!1,s<=0)break;var a=s/e;this._fontAtlas.assignLetterDefinitions(n),this._fontAtlas.scaleFontLetterDefinition(a),this._lineHeight=r*a,this._lineBreakWithoutSpaces?this._multilineTextWrapByChar():this._multilineTextWrapByWord(),this._computeAlignmentOffset()}this._lineHeight=r,this._fontAtlas.assignLetterDefinitions(n),o||e-i>=0&&this._scaleFontSizeDown(e-i)},_scaleFontSizeDown:function(t){var e=!0;this._labelType===_ccsg.Label.Type.BMFont&&(t||(t=.1,e=!1),this._fontSize=t,e&&this._updateContent())},_updateContent:function(){this._fontAtlas&&(this._computeHorizontalKerningForText(this._string),this._alignText())},_computeAlignmentOffset:function(){switch(this._linesOffsetX=[],this._hAlign){case cc.TextAlignment.LEFT:for(var t=0;t<this._numberOfLines;++t)this._linesOffsetX.push(0);break;case cc.TextAlignment.CENTER:this._linesWidth.forEach(function(t){this._linesOffsetX.push((this._contentSize.width-t)/2)}.bind(this));break;case cc.TextAlignment.RIGHT:this._linesWidth.forEach(function(t){this._linesOffsetX.push(this._contentSize.width-t)}.bind(this))}switch(this._vAlign){case cc.VerticalTextAlignment.TOP:this._letterOffsetY=this._contentSize.height;break;case cc.VerticalTextAlignment.CENTER:this._letterOffsetY=(this._contentSize.height+this._textDesiredHeight)/2;break;case cc.VerticalTextAlignment.BOTTOM:this._letterOffsetY=this._textDesiredHeight}},_getFirstCharLen:function(){return 1},_getFirstWordLen:function(t,e,i){var n=t.charAt(e);if(cc.TextUtils.isUnicodeCJK(n)||"\n"===n||cc.TextUtils.isUnicodeSpace(n))return 1;var r=1;if(!(o=this._fontAtlas.getLetterDefinitionForChar(n)))return r;for(var o,s=o._xAdvance*this._bmfontScale+this._spacingX,a=e+1;a<i&&(n=t.charAt(a),o=this._fontAtlas.getLetterDefinitionForChar(n));++a){if(s+o._offsetX*this._bmfontScale+o._width*this._bmfontScale>this._maxLineWidth&&!cc.TextUtils.isUnicodeSpace(n)&&this._maxLineWidth>0)return r;if(s+=o._xAdvance*this._bmfontScale+this._spacingX,"\n"===n||cc.TextUtils.isUnicodeSpace(n)||cc.TextUtils.isUnicodeCJK(n))break;r++}return r},_updateBMFontScale:function(){if(this._labelType===_ccsg.Label.Type.BMFont){var t=this._fontAtlas._fontSize;this._bmfontScale=this._fontSize/t}else this._bmfontScale=1},_initBMFontWithString:function(t,e){if(this._config)return cc.logID(4002),!1;this._string=t,this._setBMFontFile(e)},_createSpriteBatchNode:function(t){this._spriteBatchNode=new cc.SpriteBatchNode(t,this._string.length),this._spriteBatchNode.setCascadeColorEnabled(!0),this._spriteBatchNode.setCascadeOpacityEnabled(!0),this.addChild(this._spriteBatchNode),this._updateContent(),this.setColor(this.color)},_createFontChars:function(){if(this._config){this._fontAtlas=new cc.FontAtlas(this._config),this._lineHeight||(this._lineHeight=this._fontAtlas._lineHeight);var t=this._config.fontDefDictionary;for(var e in t){var i=new o,n=t[e].rect;i._offsetX=t[e].xOffset,i._offsetY=t[e].yOffset,i._width=n.width,i._height=n.height,i._u=n.x+this._imageOffset.x,i._v=n.y+this._imageOffset.y,i._textureID=0,i._validDefinition=!0,i._xAdvance=t[e].xAdvance,this._fontAtlas.addLetterDefinitions(e,i)}}},_rescaleWithOriginalFontSize:function(){var t=this.getFontSize();this._drawFontsize-t>=1&&this._overFlow===_ccsg.Label.Overflow.SHRINK&&(this._labelType===_ccsg.Label.Type.BMFont?this._scaleFontSizeDown(this._drawFontsize):this._fontSize=this._drawFontsize)},_computeHorizontalKerningForText:function(){for(var t=this.getStringLength(),e=this._config.kerningDict,i=-1,n=0;n<t;++n){var r=this._string.charCodeAt(n),o=e[i<<16|65535&r]||0;this._horizontalKernings[n]=n<t-1?o:0,i=r}},_setBMFontFile:function(t){if(t&&this._labelType===_ccsg.Label.Type.BMFont){var e=this;this._resetBMFont();var i=this._fontAsset._fntConfig;i?e._config=i:cc.warn("Invalid BMFont Assets!");var n=t.spriteFrame;e._createFontChars(),e._spriteFrame=n;var r=function(){var t=n.getTexture();e._textureLoaded=t.isLoaded(),e._createSpriteBatchNode(t),e.emit("load")};n.textureLoaded()?r():(n.once("load",r),n.ensureLoadTexture())}}}),_ccsg.Label.pool=new r.Pool(function(t){return t instanceof _ccsg.Label&&(t._string="",t._fontAsset=null,t._fontHandle="",t._labelType=0,t._resetBMFont(),t._renderCmd._labelCanvas.width=1,t._renderCmd._labelCanvas.height=1,t._updateLabel(),!0)},20),_ccsg.Label.pool.get=function(t,e){var i=this._get();if(i){var n=e instanceof cc.Font,r=n?e.rawUrl:"";return i._fontHandle=r,"string"!=typeof t&&(t=""+t),i._string=t,i._position.x=0,i._position.y=0,i.setAnchorPoint(.5,.5),_ccsg.Node.prototype.setContentSize.call(i,128,128),n?i.setFontAsset(e):i.setFontFamily("Arial"),i.setString(t),i.setHorizontalAlign(cc.TextAlignment.LEFT),i.setVerticalAlign(cc.VerticalTextAlignment.TOP),i.setFontSize(40),i.setOverflow(0),i.enableWrapText(!0),i.setVisible(!0),i.setLineHeight(40),i.setOutlined(!1),i.enableBold(!1),i.enableItalics(!1),i.enableUnderline(!1),i}return new _ccsg.Label(t||"",e)};var a=_ccsg.Label.prototype;cc.js.addon(a,n.prototype),_ccsg.Label.Type=cc.Enum({TTF:0,BMFont:1,SystemFont:2}),_ccsg.Label.Overflow=cc.Enum({NONE:0,CLAMP:1,SHRINK:2,RESIZE_HEIGHT:3});var c=_ccsg.Label.prototype;Object.defineProperty(c,"width",{get:c._getWidth,set:_ccsg.Node.prototype._setWidth}),Object.defineProperty(c,"height",{get:c._getHeight,set:_ccsg.Node.prototype._setHeight})}),{"../event/event-target":110,"../platform/js":167,"./CCTextUtils":126}],124:[(function(t,e,i){!(function(){_ccsg.Label.TTFLabelBaker=function(){};var t=_ccsg.Label.TTFLabelBaker.prototype=Object.create(Object.prototype);t.updateStatus=function(){var t=_ccsg.Node._dirtyFlags,e=this._dirtyFlag,i=e&t.colorDirty,n=e&t.opacityDirty;i&&this._updateDisplayColor(),n&&(this._updateDisplayOpacity(),this._notifyRegionStatus&&this._notifyRegionStatus(_ccsg.Node.CanvasRenderCmd.RegionStatus.Dirty)),e&t.contentDirty&&(this._notifyRegionStatus&&this._notifyRegionStatus(_ccsg.Node.CanvasRenderCmd.RegionStatus.Dirty),this._dirtyFlag&=~t.contentDirty),(i||e&t.textDirty)&&(this._notifyRegionStatus&&this._notifyRegionStatus(_ccsg.Node.CanvasRenderCmd.RegionStatus.Dirty),this._rebuildLabelSkin()),this._dirtyFlag&t.transformDirty&&(this.transform(this.getParentRenderCmd(),!0),this._dirtyFlag&=~t.transformDirty)},t._syncStatus=function(t){var e=_ccsg.Node._dirtyFlags,i=this._dirtyFlag,n=t?t._node:null;n&&n._cascadeColorEnabled&&t._dirtyFlag&e.colorDirty&&(i|=e.colorDirty),n&&n._cascadeOpacityEnabled&&t._dirtyFlag&e.opacityDirty&&(i|=e.opacityDirty),t&&t._dirtyFlag&e.transformDirty&&(i|=e.transformDirty);var r=i&e.colorDirty,o=i&e.opacityDirty;this._dirtyFlag=i,r&&this._syncDisplayColor(),o&&this._syncDisplayOpacity(),(r||o||this._dirtyFlag&e.textDirty)&&this._rebuildLabelSkin(),this._dirtyFlag&e.transformDirty&&this.transform(t)},t._getLineHeight=function(){var t=this._node.getLineHeight(),e=this._node;return 0|(t=0===t?e._fontSize:t*e._fontSize/this._drawFontsize)},t._constructFontDesc=function(){var t=this._node,e=t._fontSize.toString()+"px ";return e+=0===t._fontHandle.length?"serif":t._fontHandle,t._isBold&&(e="bold "+e),e},t._measureText=function(t){return function(e){return t.measureText(e).width}},t._calculateLabelFont=function(){var t=this._node,e=t._string.split("\n");t._fontSize=t._drawFontsize;var i=this._constructFontDesc();this._labelContext.font=i;var n=this._calculateParagraphLength(e,this._labelContext);if(_ccsg.Label.Overflow.SHRINK===t._overFlow){this._splitedStrings=e;var r=0,o=0,s=0;if(t._isWrapText){var a=this._canvasSize.width-2*this._getMargin(),c=this._canvasSize.height-2*this._getMargin();if(a<0||c<0)return i=this._constructFontDesc(),this._labelContext.font=i,i;o=c+1,s=a+1;for(var h=this._drawFontsize+1,l="",u=!0,d=0|h;o>c||s>a;){if(u?h=d/2|0:d=h=d-1,h<=0){cc.logID(4003);break}for(t._fontSize=h,i=this._constructFontDesc(),this._labelContext.font=i,this._splitedStrings=[],o=0,r=0;r<e.length;++r){var _=0,f=this._labelContext.measureText(e[r]).width;for(l=cc.TextUtils.fragmentText(e[r],f,a,this._measureText(this._labelContext));_<l.length;)s=this._labelContext.measureText(l[_]).width,o+=this._getLineHeight(),++_;this._splitedStrings=this._splitedStrings.concat(l)}u&&(o>c?d=0|h:(u=!1,o=c+1))}}else{for(o=e.length*this._getLineHeight(),r=0;r<e.length;++r)s<n[r]&&(s=n[r]);var p=(this._canvasSize.width-2*this._getMargin())/s,g=this._canvasSize.height/o;t._fontSize=this._drawFontsize*Math.min(1,p,g)|0,i=this._constructFontDesc(),this._labelContext.font=i}}return i},t._getMargin=function(){return this._node&&this._node._margin||0},t._calculateParagraphLength=function(t,e){for(var i=[],n=0;n<t.length;++n){var r=e.measureText(t[n]);i.push(r.width)}return i},t._calculateCanvasSize=function(){var t=this._node,e=t._contentSize.width,i=t._contentSize.height;return e<=0&&(e=1),i<=0&&(i=1),cc.size(e,i)},t._calculateSplitedStrings=function(){var t,e=this._node,i=e._string.split("\n");if(e._isWrapText){this._splitedStrings=[];var n=this._canvasSize.width-2*this._getMargin();for(t=0;t<i.length;++t){var r=this._labelContext.measureText(i[t]).width,o=cc.TextUtils.fragmentText(i[t],r,n,this._measureText(this._labelContext));this._splitedStrings=this._splitedStrings.concat(o)}}else this._splitedStrings=i},t._updateLabelDimensions=function(){var t,e=this._node,i=e._string.split("\n"),n=this._labelContext;if(_ccsg.Label.Overflow.RESIZE_HEIGHT===e._overFlow)this._canvasSize.height=this._splitedStrings.length*this._getLineHeight(),_ccsg.Node.prototype.setContentSize.call(e,this._canvasSize);else if(_ccsg.Label.Overflow.NONE===e._overFlow){this._splitedStrings=i;var r=0,o=0;for(t=0;t<i.length;++t){var s=n.measureText(i[t]).width;r=r>s?r:s}o=this._splitedStrings.length*this._getLineHeight(),this._canvasSize.width=parseFloat(r.toFixed(2))+2*this._getMargin(),this._canvasSize.height=parseFloat(o.toFixed(2)),e._isItalic&&(this._canvasSize.width+=e._drawFontsize*Math.tan(.20943951)),_ccsg.Node.prototype.setContentSize.call(e,this._canvasSize)}this._labelCanvas.width=this._canvasSize.width,this._labelCanvas.height=this._canvasSize.height},t._calculateFillTextStartPosition=function(){var t,e,i=this._node,n=this._getLineHeight(),r=this._splitedStrings.length;return t=cc.TextAlignment.RIGHT===i._hAlign?this._canvasSize.width-this._getMargin():cc.TextAlignment.CENTER===i._hAlign?this._canvasSize.width/2:0+this._getMargin(),e=cc.VerticalTextAlignment.TOP===i._vAlign?0:cc.VerticalTextAlignment.CENTER===i._vAlign?this._canvasSize.height/2-n*(r-1)/2:this._canvasSize.height-n*(r-1),cc.p(t,e)},t._calculateTextBaseline=function(){var t,e,i=this._node;t=cc.TextAlignment.RIGHT===i._hAlign?"right":cc.TextAlignment.CENTER===i._hAlign?"center":"left",this._labelContext.textAlign=t,e=cc.VerticalTextAlignment.TOP===i._vAlign?"top":cc.VerticalTextAlignment.CENTER===i._vAlign?"middle":"bottom",this._labelContext.textBaseline=e},t._bakeLabel=function(){var t=this._node;this._drawFontsize=t._drawFontsize,this._canvasSize=this._calculateCanvasSize(),this._fontDesc=this._calculateLabelFont(),this._calculateSplitedStrings(),this._updateLabelDimensions(),this._calculateTextBaseline(),this._updateTexture()},t._calculateUnderlineStartPosition=function(){var t,e,i=this._node,n=this._getLineHeight(),r=this._splitedStrings.length;return t=0+this._getMargin(),e=cc.VerticalTextAlignment.TOP===i._vAlign?i._fontSize:cc.VerticalTextAlignment.CENTER===i._vAlign?this._canvasSize.height/2-n*(r-1)/2+i._fontSize/2:this._canvasSize.height-n*(r-1),cc.p(t,e)},t._updateTexture=function(){this._labelContext.clearRect(0,0,this._labelCanvas.width,this._labelCanvas.height),this._labelContext.font=this._fontDesc;var t=this._calculateFillTextStartPosition(),e=this._getLineHeight();this._labelContext.lineJoin="round";var i=this._displayedColor;this._labelContext.fillStyle="rgb("+i.r+","+i.g+","+i.b+")";for(var n,r=0;r<this._splitedStrings.length;++r){if(this._node.isOutlined()){var o=this._node.getOutlineColor()||cc.color(255,255,255,255);this._labelContext.globalCompositeOperation="source-over",this._labelContext.strokeStyle="rgb("+o.r+","+o.g+","+o.b+")",this._labelContext.lineWidth=2*this._node.getOutlineWidth(),this._labelContext.strokeText(this._splitedStrings[r],t.x,t.y+r*e)}if(this._node.getFillColorGradientEnabled()){var s=this._node.getGradientStartColor()||cc.color(255,255,255,255),a=this._node.getGradientEndColor()||cc.color(255,255,255,255),c=this._getGradientArgs(),h=this._labelContext.createLinearGradient(c.left,c.top,c.right,c.bottom);h.addColorStop(0,cc.colorToHex(s)),h.addColorStop(1,cc.colorToHex(a)),this._labelContext.fillStyle=h}this._labelContext.fillText(this._splitedStrings[r],t.x,t.y+r*e),this._node._isUnderline&&(n=this._calculateUnderlineStartPosition(),this._labelContext.save(),this._labelContext.beginPath(),this._labelContext.lineWidth=this._node._fontSize/8,this._labelContext.strokeStyle="rgb("+i.r+","+i.g+","+i.b+")",this._labelContext.moveTo(n.x,n.y+r*e-1),this._labelContext.lineTo(n.x+this._labelCanvas.width,n.y+r*e-1),this._labelContext.stroke(),this._labelContext.restore())}this._texture._textureLoaded=!1,this._texture._htmlElementObj=this._labelCanvas,this._texture.handleLoadedTexture(!0)},t._getGradientArgs=function(){this._gradientArgument={},this._gradientArgument.left=0,this._gradientArgument.top=0;var t=this._node._contentSize;switch(this._node.getFillColorGradientDirection()){case 0:this._gradientArgument.right=t.width,this._gradientArgument.bottom=0;break;case 1:this._gradientArgument.right=0,this._gradientArgument.bottom=t.height;break;case 2:this._gradientArgument.right=t.width,this._gradientArgument.bottom=t.height}return this._gradientArgument},t._rebuildLabelSkin=function(){this._dirtyFlag&=~_ccsg.Node._dirtyFlags.textDirty,this._node._updateLabel()}})(),(function(){_ccsg.Label.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._texture=new cc.Texture2D,this._labelCanvas=document.createElement("canvas"),this._labelCanvas.width=1,this._labelCanvas.height=1,this._labelContext=this._labelCanvas.getContext("2d"),this._texture.initWithElement(this._labelCanvas),this._splitedStrings=null};var t=_ccsg.Label.CanvasRenderCmd.prototype=Object.create(_ccsg.Node.CanvasRenderCmd.prototype);cc.js.mixin(t,_ccsg.Label.TTFLabelBaker.prototype),t.constructor=_ccsg.Label.CanvasRenderCmd,t._doCulling=function(){var t=cc.visibleRect,e=this._currentRegion,i=e._minX,n=e._maxX,r=e._minY,o=e._maxY,s=t.left.x,a=t.right.x,c=t.top.y,h=t.bottom.y;this._needDraw=!(n<s||i>a||o<h||r>c)},t.rendering=function(t,e,i){var n=this._node;if(n._labelType===_ccsg.Label.Type.TTF||n._labelType===_ccsg.Label.Type.SystemFont){var r=this._displayedOpacity,o=r/255;if(0===r)return;var s=t||cc._renderContext,a=s.getContext();if(s.setTransform(this._worldTransform,e,i),s.setCompositeOperation(_ccsg.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(n._blendFunc)),s.setGlobalAlpha(o),this._texture){var c,h,l,u,d;0,l=-this._node._contentSize.height,u=this._node._contentSize.width,d=this._node._contentSize.height,0,0,c=this._texture.getPixelWidth(),h=this._texture.getPixelHeight();var _=this._texture._htmlElementObj;""!==this._texture._pattern?(s.setFillStyle(a.createPattern(_,this._texture._pattern)),a.fillRect(0,l,u,d)):0!==c&&0!==h&&0!==u&&0!==d&&a.drawImage(_,0,0,c,h,0,l,u,d)}cc.g_NumberOfDraws=cc.g_NumberOfDraws+1}}})()}),{}],125:[(function(t,e,i){_ccsg.Label.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._texture=new cc.Texture2D,this._labelCanvas=document.createElement("canvas"),this._texture.initWithElement(this._labelCanvas),this._labelContext=this._labelCanvas.getContext("2d"),this._labelCanvas.width=1,this._labelCanvas.height=1,this._splitedStrings=null,this._drawFontsize=0,this._vertices=[{x:0,y:0,u:0,v:0},{x:0,y:0,u:0,v:1},{x:0,y:0,u:1,v:0},{x:0,y:0,u:1,v:1}],this._color=new Uint32Array(1),this._dirty=!1,this._shaderProgram=cc.shaderCache.programForKey(cc.macro.SHADER_SPRITE_POSITION_TEXTURECOLOR)};var n=_ccsg.Label.WebGLRenderCmd.prototype=Object.create(_ccsg.Node.WebGLRenderCmd.prototype);cc.js.mixin(n,_ccsg.Label.TTFLabelBaker.prototype),n.constructor=_ccsg.Label.WebGLRenderCmd,n.updateTransform=function(t){this.originUpdateTransform(t);this._node;var e=this._labelCanvas.width,i=this._labelCanvas.height,n=this._worldTransform,r=this._vertices;r[0].x=0*n.a+i*n.c+n.tx,r[0].y=0*n.b+i*n.d+n.ty,r[1].x=0*n.a+0*n.c+n.tx,r[1].y=0*n.b+0*n.d+n.ty,r[2].x=e*n.a+i*n.c+n.tx,r[2].y=e*n.b+i*n.d+n.ty,r[3].x=e*n.a+0*n.c+n.tx,r[3].y=e*n.b+0*n.d+n.ty},n._doCulling=function(){var t=this._node;if(t._string&&(t._labelType===_ccsg.Label.Type.TTF||t._labelType===_ccsg.Label.Type.SystemFont)){var e=cc.visibleRect;this._cameraFlag>0&&(e=cc.Camera.main.visibleRect);var i=e.left.x,n=e.right.x,r=e.top.y,o=e.bottom.y,s=this._vertices;(s[0].x-i&s[1].x-i&s[2].x-i&s[3].x-i)>>31||(n-s[0].x&n-s[1].x&n-s[2].x&n-s[3].x)>>31||(s[0].y-o&s[1].y-o&s[2].y-o&s[3].y-o)>>31||(r-s[0].y&r-s[1].y&r-s[2].y&r-s[3].y)>>31?this._needDraw=!1:this._needDraw=!0}},n.uploadData=function(t,e,i){var n=this._node;if(!n._string||n._labelType!==_ccsg.Label.Type.TTF&&n._labelType!==_ccsg.Label.Type.SystemFont)return 0;var r=this._displayedOpacity;this._color[0]=r<<24|r<<16|r<<8|r;var o,s,a=n._vertexZ,c=this._vertices,h=c.length,l=i;for(o=0;o<h;++o)s=c[o],t[l]=s.x,t[l+1]=s.y,t[l+2]=a,e[l+3]=this._color[0],t[l+4]=s.u,t[l+5]=s.v,l+=6;return h}}),{}],126:[(function(t,e,i){var n=function(){this._status="unloaded",this._observers=[],this._isLoadWithCSS=!1};n.prototype.onLoaded=function(){this._status="loaded",this._observers.forEach((function(t){t()}))},n.prototype.isLoaded=function(){return"loaded"===this._status},n.prototype.addHandler=function(t){-1===this._observers.indexOf(t)&&this._observers.push(t)};var r={_fontCache:{},_fontWidthCache:{},_canvasContext:null,_testString:"BESbswy",_allFontsLoaded:!1,_intervalId:0,loadTTF:function(t,e){var i=this._getFontFamily(t),n=cc.loader.md5Pipe;n&&(t=n.transformURL(t));var r=cc.sys.browserType!==cc.sys.BROWSER_TYPE_BAIDU&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_BAIDU_APP&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_MOBILE_QQ;window.FontFace&&r?this._loadWithFontFace(i,t,e):this._loadWithCSS(i,t,e),0===this._intervalId&&(this._intervalId=setInterval(this._checkFontLoaded.bind(this),100))},_checkFontLoaded:function(){this._allFontsLoaded=!0;for(var t in this._fontCache){var e=this._fontCache[t];if(!e.isLoaded()&&e._isLoadWithCSS){var i=this._fontWidthCache[t];this._canvasContext.font="40px "+t,i!==this._canvasContext.measureText(this._testString).width?e.onLoaded():this._allFontsLoaded=!1}}this._allFontsLoaded&&(clearInterval(this._intervalId),this._intervalId=0)},_loadWithFontFace:function(t,e,i){var r=this._fontCache[t];if(r)r.isLoaded()||r.addHandler(i);else{var o=new FontFace(t,"url('"+e+"')");document.fonts.add(o),(r=new n).addHandler(i),this._fontCache[t]=r,o.loaded.then((function(){r.onLoaded()}))}},_loadWithCSS:function(t,e,i){var r=this._fontCache[t];if(r)r.isLoaded()||r.addHandler(i);else{var o=document,s=document.createElement("style");s.type="text/css",o.body.appendChild(s);var a="";isNaN(t-0)?a+="@font-face { font-family:"+t+"; src:":a+="@font-face { font-family:'"+t+"'; src:",a+="url('"+e+"');",s.textContent=a+"}";var c=document.createElement("div"),h=c.style;if(h.fontFamily=t,c.innerHTML=".",h.position="absolute",h.left="-100px",h.top="-100px",o.body.appendChild(c),(r=new n).addHandler(i),this._fontCache[t]=r,r._isLoadWithCSS=!0,!this._canvasContext){var l=document.createElement("canvas");l.width=100,l.height=100,this._canvasContext=l.getContext("2d")}var u="40px "+t;this._canvasContext.font=u;var d=this._canvasContext.measureText(this._testString).width;this._fontWidthCache[t]=d;var _=this;s.onload=function(){setTimeout((function(){_._allFontsLoaded||(cc.logID(4004),r.onLoaded(),cc.director.getScheduler().unschedule(this._checkFontLoaded,this))}),2e4)}}},_getFontFamily:function(t){var e=t.lastIndexOf(".ttf");if(-1===e)return t;var i=t.lastIndexOf("/");return-1===i?t.substring(0,e)+"_LABEL":t.substring(i+1,e)+"_LABEL"}},o={label_wordRex:/([a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûа-яА-ЯЁё]+|\S)/,label_symbolRex:/^[!,.:;}\]%\?>、‘“》？。，！]/,label_lastWordRex:/([a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûаíìÍÌïÁÀáàÉÈÒÓòóŐőÙÚŰúűñÑæÆœŒÃÂãÔõěščřžýáíéóúůťďňĚŠČŘŽÁÍÉÓÚŤżźśóńłęćąŻŹŚÓŃŁĘĆĄ-яА-ЯЁё]+|\S)$/,label_lastEnglish:/[a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûаíìÍÌïÁÀáàÉÈÒÓòóŐőÙÚŰúűñÑæÆœŒÃÂãÔõěščřžýáíéóúůťďňĚŠČŘŽÁÍÉÓÚŤżźśóńłęćąŻŹŚÓŃŁĘĆĄ-яА-ЯЁё]+$/,label_firsrEnglish:/^[a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûаíìÍÌïÁÀáàÉÈÒÓòóŐőÙÚŰúűñÑæÆœŒÃÂãÔõěščřžýáíéóúůťďňĚŠČŘŽÁÍÉÓÚŤżźśóńłęćąŻŹŚÓŃŁĘĆĄ-яА-ЯЁё]/,label_wrapinspection:!0,isUnicodeCJK:function(t){var e=/[\u3000-\u303F]|[\u3040-\u309F]|[\u30A0-\u30FF]|[\uFF00-\uFFEF]|[\u4E00-\u9FAF]|[\u2605-\u2606]|[\u2190-\u2195]|\u203B/g,i=/^[\u1100-\u11FF]|[\u3130-\u318F]|[\uA960-\uA97F]|[\uAC00-\uD7AF]|[\uD7B0-\uD7FF]+$/;return/^[\u4E00-\u9FFF\u3400-\u4DFF]+$/.test(t)||e.test(t)||i.test(t)},isUnicodeSpace:function(t){return(t=t.charCodeAt(0))>=9&&t<=13||32===t||133===t||160===t||5760===t||t>=8192&&t<=8202||8232===t||8233===t||8239===t||8287===t||12288===t},fragmentText:function(t,e,i,n){var r=[];if(0===t.length||i<0)return r.push(""),r;for(var o=t;e>i&&o.length>1;){for(var s=o.length*(i/e)|0,a=o.substr(s),c=e-n(a),h=a,l=0,u=0;c>i&&u++<10;)s*=i/c,s|=0,c=e-n(a=o.substr(s));for(u=0;c<i&&u++<10;){if(a){var d=this.label_wordRex.exec(a);l=d?d[0].length:1,h=a}s+=l,c=e-n(a=o.substr(s))}0===(s-=l)&&(s=1,h=h.substr(1));var _,f=o.substr(0,s);this.label_wrapinspection&&this.label_symbolRex.test(h||a)&&(0===(s-=(_=this.label_lastWordRex.exec(f))?_[0].length:0)&&(s=1),h=o.substr(s),f=o.substr(0,s)),this.label_firsrEnglish.test(h)&&(_=this.label_lastEnglish.exec(f))&&f!==_[0]&&(s-=_[0].length,h=o.substr(s),f=o.substr(0,s)),f.trim().length>0&&r.push(f),e=n(o=h||a)}return o.length>0&&r.push(o),r}};cc.TextUtils=e.exports=o,cc.CustomFontLoader=e.exports=r}),{}],127:[(function(t,e,i){function n(t){var e,i,n;if("object"==typeof t){if(i=t,t.url)return i;e=t.uuid}else i={},e=t;return n=i.type?"uuid"===i.type:cc.AssetLibrary._getAssetUrl(e),cc.AssetLibrary._getAssetInfoInRuntime(e,p),i.url=n?p.url:e,p.url&&"uuid"===i.type&&p.raw?(i.type=null,i.isRawAsset=!0):n||(i.isRawAsset=!0),i}function r(){var t=new c,e=new h,i=new l;s.call(this,[t,e,i]),this.assetLoader=t,this.downloader=e,this.loader=i,this.onProgress=null,this._autoReleaseSetting={}}var o=t("../platform/js"),s=t("./pipeline"),a=t("./loading-items"),c=t("./asset-loader"),h=t("./downloader"),l=t("./loader"),u=t("./asset-table"),d=t("../platform/utils").callInNextTick,_=t("./auto-release-utils"),f=new u,p={url:null,raw:!1},g=[],v=[];o.extend(r,s);var m=r.prototype;m.init=function(t){},m.getXMLHttpRequest=function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},m.addDownloadHandlers=function(t){this.downloader.addHandlers(t)},m.addLoadHandlers=function(t){this.loader.addHandlers(t)},m.load=function(t,e,i){void 0===i&&(i=e,e=this.onProgress||null);var r=this,o=!1;t instanceof Array||(o=!0,t=t?[t]:[]),g.length=0;for(var s=0;s<t.length;++s){var c=t[s];c&&c.id&&(cc.warnID(4920,c.id),c.uuid||c.url||(c.url=c.id));var h=n(c);if(h.url||h.uuid){var l=this._cache[h.url];g.push(l||h)}}var u=a.create(this,e,(function(t,e){d((function(){if(i){if(o){var n=h.url;i.call(r,e.getError(n),e.getContent(n))}else i.call(r,t,e);i=null}e.destroy()}))}));a.initQueueDeps(u),u.append(g),g.length=0},m.flowInDeps=function(t,e,i){v.length=0;for(var r=0;r<e.length;++r){var o=n(e[r]);if(o.url||o.uuid){var s=this._cache[o.url];s?v.push(s):v.push(o)}}var c=a.create(this,t?function(t,e,i){this._ownerQueue&&this._ownerQueue.onProgress&&this._ownerQueue._childOnProgress(i)}:null,(function(e,n){i(e,n),t&&t.deps&&(t.deps.length=0),n.destroy()}));if(t){var h=a.getQueue(t);c._ownerQueue=h._ownerQueue||h}var l=c.append(v,t);return v.length=0,l},m._resources=f,m._getResUuid=function(t,e,i){if(!t)return null;var n=t.indexOf("?");-1!==n&&(t=t.substr(0,n));var r=f.getUuid(t,e);if(!r){var o=cc.path.extname(t);o&&(t=t.slice(0,-o.length),(r=f.getUuid(t,e))&&!i&&cc.warnID(4901,t,o))}return r},m._getReferenceKey=function(t){var e;return"object"==typeof t?e=t._uuid||null:"string"==typeof t&&(e=this._getResUuid(t,null,!0)||t),e?(cc.AssetLibrary._getAssetInfoInRuntime(e,p),this._cache[p.url]?p.url:e):(cc.warnID(4800,t),e)},m._urlNotFound=function(t,e,i){d((function(){t=cc.url.normalize(t);var n=(e?o.getClassName(e):"Asset")+' in "resources/'+t+'" does not exist.';i&&i(new Error(n),[])}))},m._parseLoadResArgs=function(t,e,i){if(void 0===i){var n=cc.isChildClassOf(t,cc.RawAsset);e?(i=e,n&&(e=this.onProgress||null)):void 0!==e||n||(i=t,e=this.onProgress||null,t=null),void 0===e||n||(e=t,t=null)}return{type:t,onProgress:e,onComplete:i}},m.loadRes=function(t,e,i,n){var r=this._parseLoadResArgs(e,i,n);e=r.type,i=r.onProgress,n=r.onComplete;var o=this,s=o._getResUuid(t,e);s?this.load({type:"uuid",uuid:s},i,(function(t,e){e&&o.setAutoReleaseRecursively(s,!1),n&&n(t,e)})):o._urlNotFound(t,e,n)},m._loadResUuids=function(t,e,i,n){if(t.length>0){var r=this,o=t.map((function(t){return{type:"uuid",uuid:t}}));this.load(o,e,(function(t,e){if(i){for(var s=[],a=n&&[],c=0;c<o.length;++c){var h=o[c].uuid,l=this._getReferenceKey(h),u=e.getContent(l);u&&(r.setAutoReleaseRecursively(h,!1),s.push(u),a&&a.push(n[c]))}n?i(t,s,a):i(t,s)}}))}else i&&d((function(){n?i(null,[],[]):i(null,[])}))},m.loadResArray=function(t,e,i,n){var r=this._parseLoadResArgs(e,i,n);e=r.type,i=r.onProgress,n=r.onComplete;for(var o=[],s=0;s<t.length;s++){var a=t[s],c=this._getResUuid(a,e);if(!c)return void this._urlNotFound(a,e,n);o.push(c)}this._loadResUuids(o,i,n)},m.loadResDir=function(t,e,i,n){var r=this._parseLoadResArgs(e,i,n);e=r.type,i=r.onProgress,n=r.onComplete;var o=[],s=f.getUuidArray(t,e,o);this._loadResUuids(s,i,n,o)},m.getRes=function(t,e){var i=this._cache[t];if(!i){var n=this._getResUuid(t,e,!0);if(!n)return null;var r=this._getReferenceKey(n);i=this._cache[r]}return i&&i.alias&&(i=i.alias),i&&i.complete?i.content:null},m.getResCount=function(){return Object.keys(this._cache).length},m.getDependsRecursively=function(t){if(t){var e=this._getReferenceKey(t),i=_.getDependsRecursively(e);return i.push(e),i}return[]},m.release=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++){var i=t[e];this.release(i)}else if(t){var n=this._getReferenceKey(t),r=this.getItem(n);if(r){this.removeItem(n);if((t=r.content)instanceof cc.Asset)for(var o=t.rawUrls,s=0;s<o.length;s++)this.release(o[s]);else t instanceof cc.Texture2D&&cc.textureCache.removeTextureForKey(r.url)}}},m.releaseAsset=function(t){var e=t._uuid;e&&this.release(e)},m.releaseRes=function(t,e){var i=this._getResUuid(t,e);i?this.release(i):cc.errorID(4914,t)},m.releaseResDir=function(t,e){for(var i=f.getUuidArray(t,e),n=0;n<i.length;n++){var r=i[n];this.release(r)}},m.releaseAll=function(){for(var t in this._cache)this.release(t)},m.removeItem=function(t){var e=s.prototype.removeItem.call(this,t);return delete this._autoReleaseSetting[t],e},m.setAutoRelease=function(t,e){var i=this._getReferenceKey(t);i&&(this._autoReleaseSetting[i]=!!e)},m.setAutoReleaseRecursively=function(t,e){e=!!e;var i=this._getReferenceKey(t);if(i){this._autoReleaseSetting[i]=e;for(var n=_.getDependsRecursively(i),r=0;r<n.length;r++){var o=n[r];this._autoReleaseSetting[o]=e}}},m.isAutoRelease=function(t){var e=this._getReferenceKey(t);return!!e&&!!this._autoReleaseSetting[e]},cc.loader=new r,e.exports=cc.loader}),{"../platform/js":167,"../platform/utils":171,"./asset-loader":128,"./asset-table":129,"./auto-release-utils":131,"./downloader":132,"./loader":135,"./loading-items":136,"./pipeline":139,"./released-asset-checker":140}],128:[(function(t,e,i){var n=t("../utils/CCPath"),r=t("./pipeline"),o=t("./loading-items"),s="AssetLoader",a=function(t){this.id=s,this.async=!0,this.pipeline=null};a.ID=s;var c=[];a.prototype.handle=function(t,e){var i=t.uuid;if(!i)return t.content?t.content:null;cc.AssetLibrary.queryAssetInfo(i,(function(r,s,a){if(r)e(r);else if(t.url=t.rawUrl=cc._appendLocalUrlPrefix(s),t.isRawAsset=a,a){var h=n.extname(s).toLowerCase();if(!h)return void e(new Error("Download Uuid: can not find type of raw asset["+i+"]: "+s));h=h.substr(1);var l=o.getQueue(t);c[0]={queueId:t.queueId,id:s,url:s,type:h,error:null,alias:t,complete:!0},l.append(c),t.type=h,e(null,t.content)}else t.type="uuid",e(null,t.content)}))},r.AssetLoader=e.exports=a}),{"../utils/CCPath":190,"./loading-items":136,"./pipeline":139}],129:[(function(t,e,i){function n(t,e){this.uuid=t,this.type=e}function r(){this._pathToUuid={}}function o(t,e){if(t.length>e.length){var i=t.charCodeAt(e.length);return 46===i||47===i}return!0}var s=t("../utils/misc").pushToMap,a=r.prototype;a.getUuid=function(t,e){t=cc.url.normalize(t);var i=this._pathToUuid[t];if(i)if(Array.isArray(i)){if(!e)return i[0].uuid;for(var n=0;n<i.length;n++){var r=i[n];if(cc.isChildClassOf(r.type,e))return r.uuid}}else if(!e||cc.isChildClassOf(i.type,e))return i.uuid;return""},a.getUuidArray=function(t,e,i){"/"===(t=cc.url.normalize(t))[t.length-1]&&(t=t.slice(0,-1));var n=this._pathToUuid,r=[],s=cc.isChildClassOf;for(var a in n)if(a.startsWith(t)&&o(a,t)||!t){var c=n[a];if(Array.isArray(c))for(var h=0;h<c.length;h++){var l=c[h];e&&!s(l.type,e)||(r.push(l.uuid),i&&i.push(a))}else e&&!s(c.type,e)||(r.push(c.uuid),i&&i.push(a))}return r},a.add=function(t,e,i,r){t=t.substring(0,t.length-cc.path.extname(t).length);var o=new n(e,i);s(this._pathToUuid,t,o,r)},a._getInfo_DEBUG=!1,a.reset=function(){this._pathToUuid={}},e.exports=r}),{"../utils/misc":196}],130:[(function(t,e,i){function n(e,i){var n=document.createElement("audio"),r=(0,t("./utils").urlAppendTimestamp)(e.url);if(n.src=r,cc._isWechatGame())e.element=n,i(null,e.url);else{var o=function(){clearTimeout(a),n.removeEventListener("canplaythrough",c,!1),n.removeEventListener("error",h,!1),s.USE_LOADER_EVENT&&n.removeEventListener(s.USE_LOADER_EVENT,c,!1)},a=setTimeout((function(){0===n.readyState?h():c()}),8e3),c=function(){o(),e.element=n,i(null,e.url)},h=function(){o();var t="load audio failure - "+e.url;cc.log(t),i(t,e.url)};n.addEventListener("canplaythrough",c,!1),n.addEventListener("error",h,!1),s.USE_LOADER_EVENT&&n.addEventListener(s.USE_LOADER_EVENT,c,!1)}}function r(t,e){c||e(new Error("Audio Downloader: no web audio context."));var i=cc.loader.getXMLHttpRequest();i.open("GET",t.url,!0),i.responseType="arraybuffer",i.onload=function(){c.decodeAudioData(i.response,(function(i){t.buffer=i,e(null,t.url)}),(function(){e("decode error - "+t.url,null)}))},i.onerror=function(){e("request error - "+t.url,null)},i.send()}t("../utils/CCPath");var o=t("../platform/CCSys"),s=(t("./pipeline"),t("../../audio/CCAudioEngine"),o.__audioSupport),a=s.format,c=s.context;e.exports=function(t,e){if(0===a.length)return new Error("Audio Downloader: audio not supported on this browser!");t.content=t.url,!s.WEB_AUDIO||t.urlParam&&t.urlParam.useDom?n(t,e):r(t,e)}}),{"../../audio/CCAudioEngine":25,"../platform/CCSys":155,"../utils/CCPath":190,"./pipeline":139,"./utils":142}],131:[(function(t,e,i){function n(t,e){var i=cc.loader.getItem(t);if(i){var r=i.dependKeys;if(r)for(var o=0;o<r.length;o++){var s=r[o];e[s]||(e[s]=!0,n(s,e))}}}function r(t,e){var i=cc.loader._getReferenceKey(t);e[i]||(e[i]=!0,n(i,e))}function o(t,e){for(var i=Object.getOwnPropertyNames(t),n=0;n<i.length;n++){var o=t[i[n]];if("object"==typeof o&&o)if(Array.isArray(o))for(var s=0;s<o.length;s++){var a=o[s];a instanceof cc.RawAsset&&r(a,e)}else if(o.constructor&&o.constructor!==Object)o instanceof cc.RawAsset&&r(o,e);else for(var c=Object.getOwnPropertyNames(o),h=0;h<c.length;h++){var l=o[c[h]];l instanceof cc.RawAsset&&r(l,e)}}}function s(t,e){for(var i=0;i<t._components.length;i++)o(t._components[i],e);for(var n=0;n<t._children.length;n++)s(t._children[n],e)}var a=t("../platform/js");e.exports={autoRelease:function(t,e,i){var n=cc.loader._autoReleaseSetting,r=a.createMap();if(e)for(var o=0;o<e.length;o++)r[e[o]]=!0;for(var c=0;c<i.length;c++)s(i[c],r);if(t)for(var h=0;h<t.length;h++){var l=t[h];!1===n[l]||r[l]||cc.loader.release(l)}for(var u=Object.keys(n),d=0;d<u.length;d++){var _=u[d];!0!==n[_]||r[_]||cc.loader.release(_)}},getDependsRecursively:function(t){var e={};return n(t,e),Object.keys(e)}}}),{"../platform/js":167}],132:[(function(t,e,i){function n(t,e,i,r){void 0===i&&(i=!0);var o=_(t.url);if(r=r||h.imagePool.get(),i&&"file:"!==window.location.protocol?r.crossOrigin="anonymous":r.crossOrigin=null,r.complete&&r.naturalWidth>0&&r.src===o)return r;!(function(){function i(){r.removeEventListener("load",i),r.removeEventListener("error",s),e(null,r)}function s(){r.removeEventListener("load",i),r.removeEventListener("error",s),"https:"!==window.location.protocol&&r.crossOrigin&&"anonymous"===r.crossOrigin.toLowerCase()?n(t,e,!1,r):e(new Error("Load image ("+o+") failed"))}r.addEventListener("load",i),r.addEventListener("error",s),r.src=o})()}function r(t,e,i){var n=document,r=document.createElement("style");r.type="text/css",n.body.appendChild(r);var o="";if(isNaN(t-0)?o+="@font-face { font-family:"+t+"; src:":o+="@font-face { font-family:'"+t+"'; src:",e instanceof Array)for(var s=0,a=e.length;s<a;s++){var h=e[s];i=c.extname(h).toLowerCase(),o+="url('"+e[s]+"') format('"+f[i]+"')",o+=s===a-1?";":","}else i=i.toLowerCase(),o+="url('"+e+"') format('"+f[i]+"');";r.textContent+=o+"}";var l=document.createElement("div"),u=l.style;u.fontFamily=t,l.innerHTML=".",u.position="absolute",u.left="-100px",u.top="-100px",n.body.appendChild(l)}function o(t,e){var i=t.url,n=t.type,o=t.name,s=t.srcs;if(o&&s?(-1===s.indexOf(i)&&s.push(i),r(o,s)):(n=c.extname(i),r(o=c.basename(i,n),i,n)),!document.fonts)return null;document.fonts.load("1em "+o).then((function(){e(null,null)}),(function(t){e(t)}))}var s,a=t("../platform/js"),c=t("../utils/CCPath"),h=t("../utils/misc"),l=t("./pipeline"),u=t("./pack-downloader"),d=t("./text-downloader"),_=t("./utils").urlAppendTimestamp,f={".eot":"embedded-opentype",".ttf":"truetype",".ttc":"truetype",".woff":"woff",".svg":"svg"},p={js:function(e,i,n){function r(){c.parentNode.removeChild(c),c.removeEventListener("load",r,!1),c.removeEventListener("error",o,!1),i(null,s)}function o(){c.parentNode.removeChild(c),c.removeEventListener("load",r,!1),c.removeEventListener("error",o,!1),i(new Error("Load "+s+" failed!"),s)}if(cc._isWechatGame())return t(e.url),void i(null,s);var s=e.url,a=document,c=document.createElement("script");c.async=n,c.src=_(s),c.addEventListener("load",r,!1),c.addEventListener("error",o,!1),a.body.appendChild(c)},png:n,jpg:n,bmp:n,jpeg:n,gif:n,ico:n,tiff:n,webp:function(t,e,i,r){return cc.sys.capabilities.webp?n(t,e,i,r):new Error("Load Webp ( "+t.url+" ) failed")},image:n,mp3:s=t("./audio-downloader"),ogg:s,wav:s,m4a:s,txt:d,xml:d,vsh:d,fsh:d,atlas:d,tmx:d,tsx:d,json:d,ExportJson:d,plist:d,fnt:d,font:o,eot:o,ttf:o,woff:o,svg:o,ttc:o,uuid:function(t,e){var i=u.load(t,e);return void 0===i?this.extMap.json(t,e):i||void 0},default:d},g="Downloader",v=function(t){this.id=g,this.async=!0,this.pipeline=null,this._curConcurrent=0,this._loadQueue=[],this.extMap=a.mixin(t,p)};v.ID=g,v.prototype.addHandlers=function(t){a.mixin(this.extMap,t)},v.prototype._handleLoadQueue=function(){for(;this._curConcurrent<cc.macro.DOWNLOAD_MAX_CONCURRENT;){var t=this._loadQueue.shift();if(!t)break;var e=this.handle(t.item,t.callback);void 0!==e&&(e instanceof Error?t.callback(e):t.callback(null,e))}},v.prototype.handle=function(t,e){var i=this,n=this.extMap[t.type]||this.extMap.default,r=void 0;if(this._curConcurrent<cc.macro.DOWNLOAD_MAX_CONCURRENT){if(this._curConcurrent++,void 0!==(r=n.call(this,t,(function(t,n){i._curConcurrent=Math.max(0,i._curConcurrent-1),i._handleLoadQueue(),e&&e(t,n)}))))return this._curConcurrent=Math.max(0,this._curConcurrent-1),this._handleLoadQueue(),r}else if(t.ignoreMaxConcurrency){if(void 0!==(r=n.call(this,t,e)))return r}else this._loadQueue.push({item:t,callback:e})},l.Downloader=e.exports=v}),{"../platform/js":167,"../utils/CCPath":190,"../utils/misc":196,"./audio-downloader":130,"./pack-downloader":138,"./pipeline":139,"./text-downloader":141,"./utils":142}],133:[(function(t,e,i){t("./downloader"),t("./loader"),t("./json-unpacker"),t("./loading-items"),t("./pipeline"),t("./CCLoader")}),{"./CCLoader":127,"./downloader":132,"./json-unpacker":134,"./loader":135,"./loading-items":136,"./pipeline":139}],134:[(function(t,e,i){function n(){this.jsons={},this.state=-1}n.prototype.read=function(t,e){var i="string"==typeof e?JSON.parse(e):e;i.length!==t.length&&cc.errorID(4915);for(var n=0;n<t.length;n++){var r=t[n],o=i[n];this.jsons[r]=o}},n.prototype.retrieve=function(t){return this.jsons[t]||null},e.exports=n}),{}],135:[(function(t,e,i){function n(t,e){if("string"!=typeof t.content)return new Error("JSON Loader: Input item doesn't contain string content");try{return JSON.parse(t.content)}catch(e){return new Error("JSON Loader: Parse json ["+t.id+"] failed : "+e)}}function r(t,e){if(!(cc._isWechatGame()||t.content instanceof Image))return new Error("Image Loader: Input item doesn't contain Image content");var i=t.rawUrl,n=cc.textureCache.getTextureForKey(i)||new a;return n.url=i,n.initWithElement(t.content),n.handleLoadedTexture(),cc._renderType===cc.game.RENDER_TYPE_WEBGL&&h.imagePool.put(t.content),cc.textureCache.cacheImage(i,n),n}var o=t("../platform/js"),s=t("./pipeline"),a=t("../textures/CCTexture2D"),c=t("./uuid-loader"),h=t("../utils/misc"),l={png:r,jpg:r,bmp:r,jpeg:r,gif:r,ico:r,tiff:r,webp:r,image:r,json:n,ExportJson:n,plist:function(t,e){if("string"!=typeof t.content)return new Error("Plist Loader: Input item doesn't contain string content");var i=cc.plistParser.parse(t.content);return i||new Error("Plist Loader: Parse ["+t.id+"] failed")},uuid:c,prefab:c,fire:c,scene:c,default:function(t,e){return null}},u=function(t){this.id="Loader",this.async=!0,this.pipeline=null,this.extMap=o.mixin(t,l)};u.ID="Loader",u.prototype.addHandlers=function(t){this.extMap=o.mixin(this.extMap,t)},u.prototype.handle=function(t,e){return(this.extMap[t.type]||this.extMap.default).call(this,t,e)},s.Loader=e.exports=u}),{"../platform/js":167,"../textures/CCTexture2D":186,"../utils/misc":196,"./pipeline":139,"./uuid-loader":143}],136:[(function(t,e,i){function n(t){return"string"==typeof(t.url||t)}function r(t){if(t){var e=t.split("?");if(e&&e[0]&&e[1]){var i={};return e[1].split("&").forEach((function(t){var e=t.split("=");i[e[0]]=e[1]})),i}}}function o(t,e){var i="object"==typeof t?t.url:t,n={queueId:e,id:i,url:i,rawUrl:void 0,urlParam:r(i),type:"",error:null,content:null,complete:!1,states:{},deps:null};if("object"==typeof t&&(h.mixin(n,t),t.skips))for(var o=0;o<t.skips.length;o++){var s=t.skips[o];n.states[s]=_.COMPLETE}return n.rawUrl=n.url,i&&!n.type&&(n.type=c.extname(i).toLowerCase().substr(1)),n}function s(t,e,i){if(!t||!e)return!1;var n=!1;if(p.push(e.id),e.deps){var r,o,a=e.deps;for(r=0;r<a.length;r++){if((o=a[r]).id===t.id){n=!0;break}if(!(p.indexOf(o.id)>=0)&&(o.deps&&s(t,o,!0))){n=!0;break}}}return i||(p.length=0),n}var a=t("../platform/callbacks-invoker"),c=t("../utils/CCPath"),h=t("../platform/js"),l=0|998*Math.random(),u={},d=[],_={WORKING:1,COMPLETE:2,ERROR:3},f={},p=[],g=function(t,e,i,n){a.call(this),this._id=++l,u[this._id]=this,this._pipeline=t,this._errorUrls=[],this._appending=!1,this._ownerQueue=null,this.onProgress=i,this.onComplete=n,this.map={},this.completed={},this.totalCount=0,this.completedCount=0,this._pipeline?this.active=!0:this.active=!1,e&&(e.length>0?this.append(e):this.allComplete())};g.ItemState=new cc.Enum(_),g.create=function(t,e,i,n){void 0===i?"function"==typeof e&&(n=e,e=i=null):void 0===n&&("function"==typeof e?(n=i,i=e,e=null):(n=i,i=null));var r=d.pop();return r?(r._pipeline=t,r.onProgress=i,r.onComplete=n,u[r._id]=r,r._pipeline&&(r.active=!0),e&&r.append(e)):r=new g(t,e,i,n),r},g.getQueue=function(t){return t.queueId?u[t.queueId]:null},g.itemComplete=function(t){var e=u[t.queueId];e&&e.itemComplete(t.id)},g.initQueueDeps=function(t){var e=f[t._id];e?(e.completed.length=0,e.deps.length=0):e=f[t._id]={completed:[],deps:[]}},g.registerQueueDep=function(t,e){var i=t.queueId||t;if(!i)return!1;var n=f[i];if(n)-1===n.deps.indexOf(e)&&n.deps.push(e);else if(t.id)for(var r in f){var o=f[r];-1!==o.deps.indexOf(t.id)&&-1===o.deps.indexOf(e)&&o.deps.push(e)}},g.finishDep=function(t){for(var e in f){var i=f[e];-1!==i.deps.indexOf(t)&&-1===i.completed.indexOf(t)&&i.completed.push(t)}};var v=g.prototype;h.mixin(v,a.prototype),v.append=function(t,e){if(!this.active)return[];e&&!e.deps&&(e.deps=[]),this._appending=!0;var i,r,a,c=[];for(i=0;i<t.length;++i)if(!(r=t[i]).queueId||this.map[r.id]){if(n(r)){var h=(a=o(r,this._id)).id;this.map[h]||(this.map[h]=a,this.totalCount++,e&&e.deps.push(a),g.registerQueueDep(e||this._id,h),c.push(a))}}else{if(this.map[r.id]=r,e&&e.deps.push(r),r.complete||s(e,r)){this.totalCount++,this.itemComplete(r.id);continue}var l=this,d=u[r.queueId];d&&(this.totalCount++,g.registerQueueDep(e||this._id,r.id),d.addListener(r.id,(function(t){l.itemComplete(t.id)})))}return this._appending=!1,this.completedCount===this.totalCount?this.allComplete():this._pipeline.flowIn(c),c},v._childOnProgress=function(t){if(this.onProgress){var e=f[this._id];this.onProgress(e?e.completed.length:this.completedCount,e?e.deps.length:this.totalCount,t)}},v.allComplete=function(){var t=0===this._errorUrls.length?null:this._errorUrls;this.onComplete&&this.onComplete(t,this)},v.isCompleted=function(){return this.completedCount>=this.totalCount},v.isItemCompleted=function(t){return!!this.completed[t]},v.exists=function(t){return!!this.map[t]},v.getContent=function(t){var e=this.map[t],i=null;return e&&(e.content?i=e.content:e.alias&&(i=e.alias.content)),i},v.getError=function(t){var e=this.map[t],i=null;return e&&(e.error?i=e.error:e.alias&&(i=e.alias.error)),i},v.addListener=a.prototype.add,v.hasListener=a.prototype.has,v.removeListener=a.prototype.remove,v.removeAllListeners=a.prototype.removeAll,v.removeItem=function(t){var e=this.map[t];e&&this.completed[e.alias||t]&&(delete this.completed[t],delete this.map[t],e.alias&&(delete this.completed[e.alias.id],delete this.map[e.alias.id]),this.completedCount--,this.totalCount--)},v.itemComplete=function(t){var e=this.map[t];if(e){var i=this._errorUrls.indexOf(t);if(e.error&&-1===i?this._errorUrls.push(t):e.error||-1===i||this._errorUrls.splice(i,1),this.completed[t]=e,this.completedCount++,g.finishDep(e.id),this.onProgress){var n=f[this._id];this.onProgress(n?n.completed.length:this.completedCount,n?n.deps.length:this.totalCount,e)}this.invoke(t,e),this.removeAll(t),!this._appending&&this.completedCount>=this.totalCount&&this.allComplete()}},v.destroy=function(){this.active=!1,this._appending=!1,this._pipeline=null,this._ownerQueue=null,this._errorUrls.length=0,this.onProgress=null,this.onComplete=null,this.map={},this.completed={},this.totalCount=0,this.completedCount=0,a.call(this),u[this._id]=null,f[this._id]&&(f[this._id].completed.length=0,f[this._id].deps.length=0),-1===d.indexOf(this)&&d.length<10&&d.push(this)},cc.LoadingItems=e.exports=g}),{"../platform/callbacks-invoker":160,"../platform/js":167,"../utils/CCPath":190}],137:[(function(t,e,i){var n=t("./pipeline"),r="MD5Pipe",o=/(\.[^.\n\\/]*)$/,s=function(t,e,i){this.id=r,this.async=!1,this.pipeline=null,this.md5AssetsMap=t,this.libraryBase=e,this.rawAssetsBase=i};s.ID=r,s.prototype.handle=function(t){return t.url=this.transformURL(t.url),t},s.prototype.transformURL=function(t){var e=t.indexOf("?"),i=t;if(-1!==e&&(i=t.substr(0,e)),i.startsWith(this.libraryBase))i=i.slice(this.libraryBase.length);else{if(!i.startsWith(this.rawAssetsBase))return t;i=i.slice(this.rawAssetsBase.length)}var n=this.md5AssetsMap[i];if(n){var r=!1;t=t.replace(o,(function(t,e){return r=!0,"."+n+e})),r||(t=t+"."+n)}return t},n.MD5Pipe=e.exports=s}),{"./pipeline":139}],138:[(function(t,e,i){function n(t,e){return new Error("Can not retrieve "+t+" from packer "+e)}var r=t("./json-unpacker"),o=t("../utils/misc").pushToMap,s={},a={},c={},h={Invalid:0,Removed:1,Downloading:2,Loaded:3};e.exports={initPacks:function(t){a=t;for(var e in t)for(var i=t[e],n=0;n<i.length;n++){var r=i[n],c=1===i.length;o(s,r,e,c)}},_loadNewPack:function(t,e,i){var r=this,o=cc.AssetLibrary.getLibUrlNoExt(e)+".json";cc.loader.load({url:o,ignoreMaxConcurrency:!0},(function(o,s){if(o)return cc.errorID(4916,t),i(o);var a=r._doLoadNewPack(t,e,s);a?i(null,a):i(n(t,e))}))},_doLoadNewPack:function(t,e,i){var n=c[e];return n.state!==h.Loaded&&(n.read(a[e],i),n.state=h.Loaded),n.retrieve(t)},_selectLoadedPack:function(t){for(var e=h.Invalid,i="",n=0;n<t.length;n++){var r=t[n],o=c[r];if(o){var s=o.state;if(s===h.Loaded)return r;s>e&&(e=s,i=r)}}return e!==h.Invalid?i:t[0]},load:function(t,e){var i=t.uuid,o=s[i];if(o){Array.isArray(o)&&(o=this._selectLoadedPack(o));var a=c[o];if(a&&a.state===h.Loaded){var l=a.retrieve(i);return l||n(i,o)}return a||(console.log("Create unpacker %s for %s",o,i),(a=c[o]=new r).state=h.Downloading),this._loadNewPack(i,o,e),null}}}}),{"../utils/misc":196,"./json-unpacker":134}],139:[(function(t,e,i){function n(t,e){var i=t.id,r=e.states[i],s=t.next,a=t.pipeline;if(!e.error&&r!==o.WORKING&&r!==o.ERROR)if(r===o.COMPLETE)s?n(s,e):a.flowOut(e);else{e.states[i]=o.WORKING;var c=t.handle(e,(function(t,r){t?(e.error=t,e.states[i]=o.ERROR,a.flowOut(e)):(r&&(e.content=r),e.states[i]=o.COMPLETE,s?n(s,e):a.flowOut(e))}));c instanceof Error?(e.error=c,e.states[i]=o.ERROR,a.flowOut(e)):void 0!==c&&(null!==c&&(e.content=c),e.states[i]=o.COMPLETE,s?n(s,e):a.flowOut(e))}}t("../platform/js");var r=t("./loading-items"),o=r.ItemState,s=function(t){this._pipes=t,this._cache={};for(var e=0;e<t.length;++e){var i=t[e];i.handle&&i.id&&(i.pipeline=this,i.next=e<t.length-1?t[e+1]:null)}};s.ItemState=o;var a=s.prototype;a.insertPipe=function(t,e){if(!t.handle||!t.id||e>this._pipes.length)cc.warnID(4921);else if(this._pipes.indexOf(t)>0)cc.warnID(4922);else{t.pipeline=this;var i=null;e<this._pipes.length&&(i=this._pipes[e]);var n=null;e>0&&(n=this._pipes[e-1]),n&&(n.next=t),t.next=i,this._pipes.splice(e,0,t)}},a.insertPipeAfter=function(t,e){var i=this._pipes.indexOf(t);i<0||this.insertPipe(e,i+1)},a.appendPipe=function(t){t.handle&&t.id&&(t.pipeline=this,t.next=null,this._pipes.length>0&&(this._pipes[this._pipes.length-1].next=t),this._pipes.push(t))},a.flowIn=function(t){var e,i,r=this._pipes[0];if(r){for(e=0;e<t.length;e++)i=t[e],this._cache[i.id]=i;for(e=0;e<t.length;e++)n(r,i=t[e])}else for(e=0;e<t.length;e++)this.flowOut(t[e])},a.flowInDeps=function(t,e,i){return r.create(this,(function(t,e){i(t,e),e.destroy()})).append(e,t)},a.flowOut=function(t){t.error?delete this._cache[t.id]:this._cache[t.id]||(this._cache[t.id]=t),t.complete=!0,r.itemComplete(t)},a.copyItemStates=function(t,e){if(e instanceof Array)for(var i=0;i<e.length;++i)e[i].states=t.states;else e.states=t.states},a.isFlowing=function(){return!0},a.getItems=function(){return null},a.getItem=function(t){var e=this._cache[t];return e?(e.alias&&(e=e.alias),e):e},a.removeItem=function(t){var e=this._cache[t];return e&&e.complete&&delete this._cache[t],e},a.clear=function(){for(var t in this._cache){var e=this._cache[t];delete this._cache[t],e.complete||(e.error=new Error("Canceled manually"),this.flowOut(e))}},cc.Pipeline=e.exports=s}),{"../platform/js":167,"./loading-items":136}],140:[(function(t,e,i){}),{"../platform/js":167}],141:[(function(t,e,i){var n=t("./utils").urlAppendTimestamp;e.exports=function(t,e){if(cc._isWechatGame())wx.getFileSystemManager().readFile({filePath:t.url,encoding:"utf8",success:function(t){e(null,t.data)},fail:function(t){cc.log("WeChat readFile fail "+t),e("file not found","file not found")}});else{var i=t.url,r=cc.loader.getXMLHttpRequest(),o="Load "+i+" failed!",s=window.navigator;i=n(i),cc.log("download:",i),r.open("GET",i,!0),/msie/i.test(s.userAgent)&&!/opera/i.test(s.userAgent)?(r.setRequestHeader("Accept-Charset","utf-8"),r.onreadystatechange=function(){4===r.readyState&&(200===r.status||0===r.status?e(null,r.responseText):e({status:r.status,errorMessage:o}))}):(r.overrideMimeType&&r.overrideMimeType("text/plain; charset=utf-8"),r.onload=function(){4===r.readyState&&(200===r.status||0===r.status?e(null,r.responseText):e({status:r.status,errorMessage:o}))},r.onerror=function(){e({status:r.status,errorMessage:o})}),r.send(null)}}}),{"./utils":142}],142:[(function(t,e,i){var n=/\?/;e.exports={urlAppendTimestamp:function(t){return cc.game.config.noCache&&"string"==typeof t&&(n.test(t)?t+="&_t="+(new Date-0):t+="?_t="+(new Date-0)),t}}}),{}],143:[(function(t,e,i){function n(t){return t&&(t[0]&&"cc.Scene"===t[0].__type__||t[1]&&"cc.Scene"===t[1].__type__||t[0]&&"cc.Prefab"===t[0].__type__)}function r(t,e,i,n,r,o){var s,a,h,l,u,d=n.uuidList,_=e.dependKeys=[];if(r)for(s=[],a=[],h=[],l=0;l<d.length;l++){u=d[l];var f=n.uuidObjList[l],p=n.uuidPropList[l],g=cc.AssetLibrary._getAssetInfoInRuntime(u);if(g.raw){var v=g.url;f[p]=v,_.push(v)}else s.push(f),a.push(p),h.push({type:"uuid",uuid:u,deferredLoadRaw:!0})}else for(s=n.uuidObjList,a=n.uuidPropList,h=new Array(d.length),l=0;l<d.length;l++)u=d[l],h[l]={type:"uuid",uuid:u};if(n.rawProp&&(s.push(i),a.push(n.rawProp),h.push(e.url)),i._preloadRawFiles){var m=o;o=function(){i._preloadRawFiles((function(t){m(t||null,i)}))}}if(0===h.length)return cc.deserialize.Details.pool.put(n),o(null,i);e.content=i,t.flowInDeps(e,h,(function(t,e){var r;for(var l in e.map)(r=e.map[l]).uuid&&r.content&&(r.content._uuid=r.uuid);for(var u=0;u<h.length;u++){var d=h[u].uuid,f=h[u].url,p=s[u],g=a[u];if(r=e.map[f]){var v={obj:p,prop:g};function m(t){var e=t.isRawAsset?t.rawUrl:t.content;this.obj[this.prop]=e,t.uuid!==i._uuid&&_.indexOf(t.id)<0&&_.push(t.id)}if(r.complete||r.content)r.error?cc._throw(r.error):m.call(v,r);else{var y=c.getQueue(r),T=y._callbackTable[d];T?T.unshift(m,v):y.addListener(d,m,v)}}}cc.deserialize.Details.pool.put(n),o(null,i)}))}function o(t,e,i){var n=e.deferredLoadRaw;return n?t instanceof cc.Asset&&t.constructor.preventDeferredLoadDependents&&(n=!1):i&&(t instanceof cc.SceneAsset||t instanceof cc.Prefab)&&(n=t.asyncLoadAssets),n}function s(t,e){var i;if("string"==typeof t.content)try{i=JSON.parse(t.content)}catch(e){return new Error("Uuid Loader: Parse asset ["+t.id+"] failed : "+e.stack)}else{if("object"!=typeof t.content)return new Error("JSON Loader: Input item doesn't contain string content");i=t.content}var s,c=n(i);s=c?cc._MissingScript.safeFindClass:function(t){var e=a._getClassById(t);return e||(cc.warnID(4903,t),Object)};var h,l=cc.deserialize.Details.pool.get();try{h=cc.deserialize(i,l,{classFinder:s,target:t.existingAsset,customEnv:t})}catch(e){cc.deserialize.Details.pool.put(l);var u=e.stack;return new Error("Uuid Loader: Deserialize asset ["+t.id+"] failed : "+u)}h._uuid=t.uuid;var d=o(h,t,c);r(this.pipeline,t,h,l,d,e)}var a=t("../platform/js");t("../platform/deserialize");var c=t("./loading-items");e.exports=s,s.isSceneObj=n}),{"../platform/deserialize":162,"../platform/js":167,"./loading-items":136}],144:[(function(t,e,i){function n(t,e,i){e?t._removeComponent(e):a.array.removeAt(t._components,i)}function r(){this._activatingStack=[]}var o=t("./component-scheduler"),s=t("./platform/CCObject").Flags,a=t("./platform/js"),c=s.IsPreloadStarted,h=s.IsOnLoadStarted,l=s.IsOnLoadCalled,u=s.Deactivating,d=cc.supportJit,_=d?"c.__preload();":function(t){t.__preload()},f=d?"c.onLoad();c._objFlags|="+l:function(t){t.onLoad(),t._objFlags|=l},p=cc.Class({extends:o.LifeCycleInvoker,add:function(t){this._zero.array.push(t)},remove:function(t){this._zero.fastRemove(t)},cancelInactive:function(t){o.LifeCycleInvoker.stableRemoveInactive(this._zero,t)},invoke:function(){this._invoke(this._zero),this._zero.array.length=0}}),g=o.createInvokeImpl(_),v=o.createInvokeImpl(f),m=new a.Pool(4);m.get=function(){var t=this._get()||{preload:new p(g),onLoad:new o.OneOffInvoker(v),onEnable:new o.OneOffInvoker(o.invokeOnEnable)};t.preload._zero.i=-1;var e=t.onLoad;return e._zero.i=-1,e._neg.i=-1,e._pos.i=-1,e=t.onEnable,e._zero.i=-1,e._neg.i=-1,e._pos.i=-1,t};var y=cc.Class({ctor:r,reset:r,_activateNodeRecursively:function(t,e,i,r){if(t._objFlags&u)cc.errorID(3816,t.name);else{t._activeInHierarchy=!0;for(var o=t._components.length,s=0;s<o;++s){var a=t._components[s];a instanceof cc.Component?this.activateComp(a,e,i,r):(n(t,a,s),--s,--o)}for(var c=0,h=t._children.length;c<h;++c){var l=t._children[c];l._active&&this._activateNodeRecursively(l,e,i,r)}t._onPostActivated(!0)}},_deactivateNodeRecursively:function(t){t._objFlags|=u,t._activeInHierarchy=!1;for(var e=t._components.length,i=0;i<e;++i){var n=t._components[i];if(n._enabled&&(cc.director._compScheduler.disableComp(n),t._activeInHierarchy))return void(t._objFlags&=~u)}for(var r=0,o=t._children.length;r<o;++r){var s=t._children[r];if(s._activeInHierarchy&&(this._deactivateNodeRecursively(s),t._activeInHierarchy))return void(t._objFlags&=~u)}t._onPostActivated(!1),t._objFlags&=~u},activateNode:function(t,e){if(e){var i=m.get();this._activatingStack.push(i),this._activateNodeRecursively(t,i.preload,i.onLoad,i.onEnable),i.preload.invoke(),i.onLoad.invoke(),i.onEnable.invoke(),this._activatingStack.pop(),m.put(i)}else{this._deactivateNodeRecursively(t);for(var n=this._activatingStack,r=0;r<n.length;r++){var o=n[r];o.preload.cancelInactive(c),o.onLoad.cancelInactive(h),o.onEnable.cancelInactive()}}t.emit("active-in-hierarchy-changed",t)},activateComp:function(t,e,i,n){if(t._objFlags&c||(t._objFlags|=c,"function"==typeof t.__preload&&(e?e.add(t):t.__preload())),t._objFlags&h||(t._objFlags|=h,t.onLoad?i?i.add(t):(t.onLoad(),t._objFlags|=l):t._objFlags|=l),t._enabled){if(!t.node._activeInHierarchy)return;cc.director._compScheduler.enableComp(t,n)}},destroyComp:function(t){cc.director._compScheduler.disableComp(t),t.onDestroy&&t._objFlags&l&&t.onDestroy()},resetComp:!1});e.exports=y}),{"./component-scheduler":71,"./platform/CCObject":152,"./platform/js":167,"./utils/misc":196}],145:[(function(t,e,i){function n(t){return t&&(t.constructor===cc.SceneAsset||t instanceof cc.Scene)}function r(t,e){this.url=t,this.type=e}var o=t("../assets/CCAsset"),s=t("./utils").callInNextTick,a=t("../load-pipeline/CCLoader"),c=t("../load-pipeline/pack-downloader"),h=t("../load-pipeline/auto-release-utils"),l=t("../utils/decode-uuid"),u=t("../load-pipeline/md5-pipe"),d="",_="",f={},p={loadAsset:function(t,e,i){if("string"!=typeof t)return s(e,new Error("[AssetLibrary] uuid must be string"),null);var r={uuid:t,type:"uuid"};i&&i.existingAsset&&(r.existingAsset=i.existingAsset),a.load(r,(function(i,r){if(i||!r)i=new Error("[AssetLibrary] loading JSON or dependencies failed: "+(i?i.message:"Unknown error"));else{if(r.constructor===cc.SceneAsset){var o=cc.loader._getReferenceKey(t);r.scene.dependAssets=h.getDependsRecursively(o)}if(n(r)){var s=cc.loader._getReferenceKey(t);a.removeItem(s)}}e&&e(i,r)}))},getLibUrlNoExt:function(t){return t=l(t),d+t.slice(0,2)+"/"+t},_queryAssetInfoInEditor:function(t,e){},_getAssetInfoInRuntime:function(t,e){e=e||{url:null,raw:!1};var i=f[t];return i&&!cc.isChildClassOf(i.type,cc.Asset)?(e.url=_+i.url,e.raw=!0):(e.url=this.getLibUrlNoExt(t)+".json",e.raw=!1),e},_getAssetUrl:function(t){var e=f[t];return e?_+e.url:null},queryAssetInfo:function(t,e){var i=this._getAssetInfoInRuntime(t);e(null,i.url,i.raw)},parseUuidInEditor:function(t){},loadJson:function(t,e){var i=""+((new Date).getTime()+Math.random()),r={uuid:i,type:"uuid",content:t,skips:[a.assetLoader.id,a.downloader.id]};a.load(r,(function(t,r){if(t)t=new Error("[AssetLibrary] loading JSON or dependencies failed: "+t.message);else{if(r.constructor===cc.SceneAsset){var o=cc.loader._getReferenceKey(i);r.scene.dependAssets=h.getDependsRecursively(o)}if(n(r)){var s=cc.loader._getReferenceKey(i);a.removeItem(s)}}r._uuid="",e&&e(t,r)}))},getAssetByUuid:function(t){return p._uuidToAsset[t]||null},init:function(t){var e=t.libraryPath;e=e.replace(/\\/g,"/"),d=cc._appendLocalUrlPrefix(cc.path.stripSep(e)+"/"),_=t.rawAssetsBase;var i=t.md5AssetsMap;if(i){var n=new u(i,d,_);cc.loader.insertPipeAfter(cc.loader.assetLoader,n),cc.loader.md5Pipe=n}var s=a._resources;s.reset();var h=t.rawAssets;if(h){for(var l in h){var p=h[l];for(var g in p){var v=p[g],m=v[0],y=v[1],T=cc.js._getClassById(y);if(T){if(f[g]=new r(l+"/"+m,T),"assets"===l&&m.startsWith("resources/")){if(cc.isChildClassOf(T,o)){var C=cc.path.extname(m);m=C?m.slice("resources/".length,-C.length):m.slice("resources/".length)}else m=m.slice("resources/".length);var x=1===v[2];s.add(m,g,T,!x)}}else cc.error("Cannot get",y)}}}t.packedAssets&&c.initPacks(t.packedAssets);var E=t.mountPaths;E||(E={assets:_+"assets",internal:_+"internal"}),cc.url._init(E)}};p._uuidToAsset={},e.exports=cc.AssetLibrary=p}),{"../assets/CCAsset":44,"../load-pipeline/CCLoader":127,"../load-pipeline/auto-release-utils":131,"../load-pipeline/md5-pipe":137,"../load-pipeline/pack-downloader":138,"../utils/decode-uuid":193,"./utils":171}],146:[(function(t,e,i){function n(t,e){t.indexOf(e)<0&&t.push(e)}function r(t,e){n(t.__props__,e)}function o(t,e,i,n,o){var s=n.default;b.setClassAttr(t,i,"default",s),r(t,i);var a=C(t,n,e,i,!1);if(a){for(var c=L,h=0;h<a.length;h++){var l=a[h];b.attr(t,i,l),l._onAfterProp&&c.push(l._onAfterProp)}for(var u=0;u<c.length;u++)c[u](t,i);L.length=0,a.length=0}}function s(t,e,i,n,r){var o=n.get,s=n.set,a=t.prototype,c=Object.getOwnPropertyDescriptor(a,i),h=!c;if(o){for(var l=C(t,n,e,i,!0),u=0;u<l.length;u++)b.attr(t,i,l[u]);l.length=0;b.setClassAttr(t,i,"serializable",!1),r||x.get(a,i,o,h,h)}s&&(r||x.set(a,i,s,h,h))}function a(t){return"function"==typeof t?t():t}function c(t,e,i){for(var n in e)t.hasOwnProperty(n)||i&&!i(n)||Object.defineProperty(t,n,x.getPropertyDescriptor(e,n))}function h(t,e,i,n){var r,o,s=n.__ctor__,a=n.ctor,h=n.__ES6__;h?(r=[a],o=a):(r=s?[s]:v(e,i,n),o=D(r,e,t,n),x.value(o,"extend",(function(t){return t.extends=this,T(t)}),!0)),x.value(o,"__ctors__",r.length>0?r:null,!0);var l=o.prototype;if(e&&(h||(x.extend(o,e),l=o.prototype),x.value(o,"$super",e)),i){for(var u=i.length-1;u>=0;u--){var d=i[u];c(l,d.prototype),c(o,d,(function(t){return d.hasOwnProperty(t)&&!0})),T._isCCClass(d)&&c(b.getClassAttrs(o).constructor.prototype,b.getClassAttrs(d).constructor.prototype)}l.constructor=o}return h||(l.__initProps__=g),x.setClassName(t,o),o}function l(t,e,i,n){var r=cc.Component,o=cc._RF.peek();if(o&&cc.isChildClassOf(e,r)){if(cc.isChildClassOf(o.cls,r))return cc.errorID(3615),null;t=t||o.script}var s=h(t,e,i,n);if(o)if(cc.isChildClassOf(e,r)){var a=o.uuid;a&&x._setClassId(a,s),o.cls=s}else cc.isChildClassOf(o.cls,r)||(o.cls=s);return s}function u(t){for(var e=x.getClassName(t),i=t.constructor,n="new "+e+"(",r=0;r<i.__props__.length;r++){var o=t[i.__props__[r]];if("object"==typeof o)return cc.errorID(3641,e),"new "+e+"()";n+=o,r<i.__props__.length-1&&(n+=",")}return n+")"}function d(t){for(var e=x.getClassName(t),i=t.constructor,n=new i,r=0;r<i.__props__.length;r++){var o=i.__props__[r],s=t[o];if("object"==typeof s)return cc.errorID(3641,e),n;n[o]=s}return n}function _(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}function f(t,e){for(var i=[],n="",r=0;r<e.length;r++){var o=e[r],s=o+A+"default";if(s in t){var a;a=P.test(o)?"this."+o+"=":"this["+_(o)+"]=";var c,h=t[s];if("object"==typeof h&&h)c=h instanceof cc.ValueType?u(h):Array.isArray(h)?"[]":"{}";else if("function"==typeof h){var l=i.length;i.push(h),c="F["+l+"]()"}else c="string"==typeof h?_(h):h;n+=a=a+c+";\n"}}return 0===i.length?Function(n):Function("F","return (function(){\n"+n+"})")(i)}function p(t,e){return function(){for(var i=[],n=0;n<e.length;n++){var r=e[n],o=r+A+"default";if(o in t){var s,a=t[o];if("object"==typeof a&&a)s=a instanceof cc.ValueType?d(a):Array.isArray(a)?[]:{};else if("function"==typeof a){var c=i.length;i.push(a),s=i[c]()}else s=a;this[r]=s}}}}function g(t){var e=b.getClassAttrs(t),i=t.__props__;null===i&&(O.init(),i=t.__props__);var n=cc.supportJit?f(e,i):p(e,i);t.prototype.__initProps__=n,n.call(this)}function v(t,e,i){for(var r=[],o=[t].concat(e),s=0;s<o.length;s++){var a=o[s];if(a)for(var c=(function(t){return T._isCCClass(t)?t.__ctors__||[]:[t]})(a),h=0;h<c.length;h++)n(r,c[h])}var l=i.ctor;return l&&r.push(l),r}function m(t,e,i){var n=!1;for(var r in e)if(!(w.indexOf(r)>=0)){var o=e[r];if("function"==typeof o){var s=x.getPropertyDescriptor(t.prototype,r);if(s){var a=s.value;if("function"==typeof a){N.test(o)&&(n=!0,e[r]=(function(t,e){return function(){var i=this._super;this._super=t;var n=e.apply(this,arguments);return this._super=i,n}})(a,o));continue}}}}return n}function y(t,e,i,n,r,a){if(t.__props__=[],n&&n.__props__&&(t.__props__=n.__props__.slice()),r)for(var c=0;c<r.length;++c){var h=r[c];h.__props__&&(t.__props__=t.__props__.concat(h.__props__.filter((function(e){return t.__props__.indexOf(e)<0}))))}if(i){I.preprocessAttrs(i,e,t,a);for(var l in i){var u=i[l];"default"in u?o(t,e,l,u,a):s(t,e,l,u,a)}}}function T(t){var e=(t=t||{}).name,i=t.extends,n=t.mixins,r=l(e,i,n,t);e||(e=cc.js.getClassName(r));var o=t.properties;"function"==typeof o||i&&null===i.__props__||n&&n.some((function(t){return null===t.__props__}))?(O.push({cls:r,props:o,mixins:n}),r.__props__=null):y(r,e,o,i,t.mixins,t.__ES6__);var s=t.statics;if(s){var a;for(a in s)r[a]=s[a]}for(var c in t)if(!(w.indexOf(c)>=0)){var h=t[c];I.validateMethodWithProps(h,c,e,r,i)&&x.value(r.prototype,c,h,!0,!0)}var u=t.editor;return u&&cc.isChildClassOf(i,cc.Component)&&cc.Component._registerEditorProps(r,u),r}function C(t,e,i,n,r){function o(){return c=n+A,a=b.getClassAttrsProto(t)}function s(t,i){if(t in e){var n=e[t];typeof n===i&&((a||o())[c+t]=n)}}var a=null,c="";M.length=0;var h=M,l=e.type;if(l){var u=F[l];if(u)h.push({type:l,_onAfterProp:R(u,"cc."+l)});else if("Object"===l);else if(l===b.ScriptUuid){var d=b.ObjectType(cc.ScriptAsset);d.type="Script",h.push(d)}else"object"==typeof l?E.isEnum(l)&&h.push({type:"Enum",enumList:E.getList(l)}):"function"==typeof l&&(e.url?h.push({type:"Object",ctor:l,_onAfterProp:R("String","cc.String")}):h.push(e._short?{type:"Object",ctor:l}:b.ObjectType(l)))}e.editorOnly&&((a||o())[c+"editorOnly"]=!0),e.url&&((a||o())[c+"saveUrlAsAsset"]=!0),!1===e.serializable&&((a||o())[c+"serializable"]=!1),s("formerlySerializedAs","string");var _=e.range;return _&&Array.isArray(_)&&_.length>=2&&((a||o())[c+"min"]=_[0],a[c+"max"]=_[1],_.length>2&&(a[c+"step"]=_[2])),s("min","number"),s("max","number"),s("step","number"),h}var x=t("./js"),E=t("./CCEnum"),S=t("./utils"),b=(S.isPlainEmptyObj_DEV,S.cloneable_DEV,t("./attribute")),A=b.DELIMETER,R=b.getTypeChecker,I=t("./preprocess-class");t("./requiring-frame");var w=["name","extends","mixins","ctor","__ctor__","properties","statics","editor","__ES6__"],O={datas:null,push:function(t){if(this.datas)this.datas.push(t);else{this.datas=[t];var e=this;setTimeout((function(){e.init()}),0)}},init:function(){var t=this.datas;if(t){for(var e=0;e<t.length;++e){var i=t[e],n=i.cls,r=i.props;"function"==typeof r&&(r=r());var o=x.getClassName(n);r?y(n,o,r,n.$super,i.mixins):cc.errorID(3633,o)}this.datas=null}}},L=[],P=/^[$A-Za-z_][0-9A-Za-z_$]*$/,D=cc.supportJit?function(t,e,i,n){var r="return function CCClass(){\n";e&&m(e,n)&&(r+="this._super=null;\n"),r+="this.__initProps__(CCClass);\n";var o=t.length;if(o>0){var s=!(i&&i.startsWith("cc."));s&&(r+="try{\n");var a="].apply(this,arguments);\n";if(1===o)r+="CCClass.__ctors__[0"+a;else{r+="var cs=CCClass.__ctors__;\n";for(var c=0;c<o;c++)r+="cs["+c+a}s&&(r+="}catch(e){\ncc._throw(e);\n}\n")}return r+="}",Function(r)()}:function(t,e,i,n){var r=e&&m(e,n);return function e(){r&&(this._super=null),this.__initProps__(e);var n=t.length,o=e.__ctors__;if(n>0)if(!(i&&i.startsWith("cc.")))try{if(1===n)o[0].apply(this,arguments);else for(s=0;s<n;s++)o[s].apply(this,arguments)}catch(t){cc._throw(t)}else if(1===n)o[0].apply(this,arguments);else for(var s=0;s<n;s++)o[s].apply(this,arguments)}},N=/xyz/.test((function(){xyz}))?/\b\._super\b/:/.*/;/xyz/.test((function(){xyz}));T._isCCClass=function(t){return t&&t.hasOwnProperty("__ctors__")},T._fastDefine=function(t,e,i){x.setClassName(t,e);for(var n=e.__props__=Object.keys(i),r=b.getClassAttrsProto(e),o=0;o<n.length;o++){var s=n[o];r[s+A+"visible"]=!1,r[s+A+"default"]=i[s]}},T.Attr=b,T.attr=b.attr,cc.isChildClassOf=function(t,e){if(t&&e){if("function"!=typeof t)return!1;if("function"!=typeof e)return!1;if(t===e)return!0;for(;;){if(!(t=x.getSuper(t)))return!1;if(t===e)return!0}}return!1},T.getInheritanceChain=function(t){for(var e=[];t=x.getSuper(t);)t!==Object&&e.push(t);return e};var F={Integer:"Number",Float:"Number",Boolean:"Boolean",String:"String"},M=[];cc.Class=T,e.exports={isArray:function(t){return t=a(t),Array.isArray(t)},fastDefine:T._fastDefine,getNewValueTypeCode:u,IDENTIFIER_RE:P,escapeForJS:_,getDefault:a}}),{"./CCEnum":148,"./attribute":159,"./js":167,"./preprocess-class":168,"./requiring-frame":169,"./utils":171}],147:[(function(t,e,i){function n(t){return t}function r(t,e){return t[e]||(t[e]={})}function o(t){return function(e){return"function"==typeof e?t(e):function(i){return t(i,e)}}}function s(t,e,i){return function(t){return function(i){return e(i,t)}}}function a(t){return s.bind(null,!1)}function c(t,e){return r(t,g)}function h(t){var e;try{e=t()}catch(e){return t}return"object"!=typeof e||null===e?e:t}function l(t){var e;try{e=new t}catch(t){return{}}return e}function u(t,e,i,n,r,o){var s=n&&(f.getFullFormOfProperty(n)||n),a=e[i],c=p.mixin(a||{},s||{});if(r&&(r.get||r.set)){r.get&&(c.get=r.get),r.set&&(c.set=r.set)}else{var u=void 0;if(r)r.initializer&&(u=h(r.initializer),!0);else{var d=o.default||(o.default=l(t));d.hasOwnProperty(i)&&(u=d[i],!0)}c.default=u}e[i]=c}function d(t,e,i){return t((function(t,n){var o=c(t,e);if(o){var s=void 0!==i?i:n;r(r(o,"proto"),"editor")[e]=s}}),e)}function _(t){return t(n)}t("./CCClass");var f=t("./preprocess-class"),p=t("./js"),g="__ccclassCache__",v=s.bind(null,!1),m=a(),y=a(),T=o((function(t,e){var i=p.getSuper(t);i===Object&&(i=null);var n={name:e,extends:i,ctor:t,__ES6__:!0},r=t[g];if(r){var o=r.proto;o&&p.mixin(n,o),t[g]=void 0}return cc.Class(n)})),C=_(o),x=d(v,"requireComponent"),E=_(m),S=d(y,"executionOrder"),b=_(o),A=_(o),R=_(m),I=_(m),w=_(m);cc._decorator=e.exports={ccclass:T,property:function(t,e,i){function n(t,e,i){var n=c(t.constructor);if(n){var s=r(r(n,"proto"),"properties");u(t.constructor,s,e,o,i,n)}}var o=null;if(void 0===e)return o=t,n;n(t,e,i)},executeInEditMode:C,requireComponent:x,menu:E,executionOrder:S,disallowMultiple:b,playOnFocus:A,inspector:R,icon:I,help:w,mixins:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){var i=c(e,"mixins");i&&(r(i,"proto").mixins=t)}}}}),{"./CCClass":146,"./js":167,"./preprocess-class":168,"./utils":171}],148:[(function(t,e,i){function n(t){if("__enums__"in t)return t;r.value(t,"__enums__",null,!0);for(var e=-1,i=Object.keys(t),n=0;n<i.length;n++){var o=i[n],s=t[o];if(-1===s)s=++e,t[o]=s;else if("number"==typeof s)e=s;else if("string"==typeof s&&Number.isInteger(parseFloat(o)))continue;var a=""+s;o!==a&&r.value(t,a,o)}return t}var r=t("./js");n.isEnum=function(t){return t&&t.hasOwnProperty("__enums__")},n.getList=function(t){if(t.__enums__)return t.__enums__;var e=t.__enums__=[];for(var i in t){var n=t[i];Number.isInteger(n)&&e.push({name:i,value:n})}return e.sort((function(t,e){return t.value-e.value})),e};e.exports=cc.Enum=n}),{"./js":167}],149:[(function(t,e,i){cc.ClassManager||t("./_CCClass");var n=t("./CCInputManager");n.__instanceId=cc.ClassManager.getNewInstanceId(),n.setAccelerometerEnabled=function(t){var e=this;if(e._accelEnabled!==t){e._accelEnabled=t;var i=cc.director.getScheduler();e._accelEnabled,e._accelCurTime=0,i.scheduleUpdate(e)}},n.setAccelerometerInterval=function(t){this._accelInterval!==t&&(this._accelInterval=t)},n._registerKeyboardEvent=function(){cc.game.canvas.addEventListener("keydown",(function(t){cc.eventManager.dispatchEvent(new cc.Event.EventKeyboard(t.keyCode,!0)),t.stopPropagation(),t.preventDefault()}),!1),cc.game.canvas.addEventListener("keyup",(function(t){cc.eventManager.dispatchEvent(new cc.Event.EventKeyboard(t.keyCode,!1)),t.stopPropagation(),t.preventDefault()}),!1)},n._registerAccelerometerEvent=function(){var t=window,e=this;e._acceleration=new cc.Acceleration,e._accelDeviceEvent=t.DeviceMotionEvent||t.DeviceOrientationEvent,cc.sys.browserType===cc.sys.BROWSER_TYPE_MOBILE_QQ&&(e._accelDeviceEvent=window.DeviceOrientationEvent);var i=e._accelDeviceEvent===t.DeviceMotionEvent?"devicemotion":"deviceorientation",n=navigator.userAgent;(/Android/.test(n)||/Adr/.test(n)&&cc.sys.browserType===cc.BROWSER_TYPE_UC)&&(e._minus=-1),t.addEventListener(i,e.didAccelerate.bind(e),!1)},n.didAccelerate=function(t){var e=this,i=window;if(e._accelEnabled){var n,r,o,s=e._acceleration;if(e._accelDeviceEvent===window.DeviceMotionEvent){var a=t.accelerationIncludingGravity;n=e._accelMinus*a.x*.1,r=e._accelMinus*a.y*.1,o=.1*a.z}else n=t.gamma/90*.981,r=-t.beta/90*.981,o=t.alpha/90*.981;s.x=n,s.y=r,s.z=o,s.timestamp=t.timeStamp||Date.now();var c=s.x;i.orientation===cc.macro.WEB_ORIENTATION_LANDSCAPE_RIGHT?(s.x=-s.y,s.y=c):i.orientation===cc.macro.WEB_ORIENTATION_LANDSCAPE_LEFT?(s.x=s.y,s.y=-c):i.orientation===cc.macro.WEB_ORIENTATION_PORTRAIT_UPSIDE_DOWN&&(s.x=-s.x,s.y=-s.y),cc.sys.os===cc.sys.OS_ANDROID&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_MOBILE_QQ&&(s.x=-s.x,s.y=-s.y)}}}),{"./CCInputManager":150,"./_CCClass":158}],150:[(function(t,e,i){var n=t("./CCMacro").TOUCH_TIMEOUT,r={_mousePressed:!1,_isRegisterEvent:!1,_preTouchPoint:cc.p(0,0),_prevMousePoint:cc.p(0,0),_preTouchPool:[],_preTouchPoolPointer:0,_touches:[],_touchesIntegerDict:{},_indexBitsUsed:0,_maxTouches:5,_accelEnabled:!1,_accelInterval:1/30,_accelMinus:1,_accelCurTime:0,_acceleration:null,_accelDeviceEvent:null,_getUnUsedIndex:function(){for(var t=this._indexBitsUsed,e=cc.sys.now(),i=0;i<this._maxTouches;i++){if(!(1&t))return this._indexBitsUsed|=1<<i,i;var r=this._touches[i];if(e-r._lastModified>n)return this._removeUsedIndexBit(i),delete this._touchesIntegerDict[r.getID()],i;t>>=1}return-1},_removeUsedIndexBit:function(t){if(!(t<0||t>=this._maxTouches)){var e=1<<t;e=~e,this._indexBitsUsed&=e}},_glView:null,handleTouchesBegin:function(t){for(var e,i,n,r=[],o=this._touchesIntegerDict,s=cc.sys.now(),a=0,c=t.length;a<c;a++)if(e=t[a],n=e.getID(),null==o[n]){var h=this._getUnUsedIndex();if(-1===h){cc.logID(2300,h);continue}(i=this._touches[h]=new cc.Touch(e._point.x,e._point.y,e.getID()))._lastModified=s,i._setPrevPoint(e._prevPoint),o[n]=h,r.push(i)}if(r.length>0){this._glView._convertTouchesWithScale(r);var l=new cc.Event.EventTouch(r);l._eventCode=cc.Event.EventTouch.BEGAN,cc.eventManager.dispatchEvent(l)}},handleTouchesMove:function(t){for(var e,i,n,r=[],o=this._touches,s=cc.sys.now(),a=0,c=t.length;a<c;a++)n=(e=t[a]).getID(),null!=(i=this._touchesIntegerDict[n])&&o[i]&&(o[i]._setPoint(e._point),o[i]._setPrevPoint(e._prevPoint),o[i]._lastModified=s,r.push(o[i]));if(r.length>0){this._glView._convertTouchesWithScale(r);var h=new cc.Event.EventTouch(r);h._eventCode=cc.Event.EventTouch.MOVED,cc.eventManager.dispatchEvent(h)}},handleTouchesEnd:function(t){var e=this.getSetOfTouchesEndOrCancel(t);if(e.length>0){this._glView._convertTouchesWithScale(e);var i=new cc.Event.EventTouch(e);i._eventCode=cc.Event.EventTouch.ENDED,cc.eventManager.dispatchEvent(i)}},handleTouchesCancel:function(t){var e=this.getSetOfTouchesEndOrCancel(t);if(e.length>0){this._glView._convertTouchesWithScale(e);var i=new cc.Event.EventTouch(e);i._eventCode=cc.Event.EventTouch.CANCELLED,cc.eventManager.dispatchEvent(i)}},getSetOfTouchesEndOrCancel:function(t){for(var e,i,n,r=[],o=this._touches,s=this._touchesIntegerDict,a=0,c=t.length;a<c;a++)null!=(i=s[n=(e=t[a]).getID()])&&o[i]&&(o[i]._setPoint(e._point),o[i]._setPrevPoint(e._prevPoint),r.push(o[i]),this._removeUsedIndexBit(i),delete s[n]);return r},getHTMLElementPosition:function(t){var e=document.documentElement,i=window.pageXOffset-e.clientLeft,n=window.pageYOffset-e.clientTop;if("function"==typeof t.getBoundingClientRect){var r=null;return r=cc._isWechatGame()?{left:0,top:0,width:window.innerWidth,height:window.innerHeight}:"function"==typeof t.getBoundingClientRect?t.getBoundingClientRect():t instanceof HTMLCanvasElement?{left:0,top:0,width:t.width,height:t.height}:{left:0,top:0,width:parseInt(t.style.width),height:parseInt(t.style.height)},{left:r.left+i,top:r.top+n,width:r.width,height:r.height}}return t instanceof HTMLCanvasElement?{left:i,top:n,width:t.width,height:t.height}:{left:i,top:n,width:parseInt(t.style.width),height:parseInt(t.style.height)}},getPreTouch:function(t){for(var e=null,i=this._preTouchPool,n=t.getID(),r=i.length-1;r>=0;r--)if(i[r].getID()===n){e=i[r];break}return e||(e=t),e},setPreTouch:function(t){for(var e=!1,i=this._preTouchPool,n=t.getID(),r=i.length-1;r>=0;r--)if(i[r].getID()===n){i[r]=t,e=!0;break}e||(i.length<=50?i.push(t):(i[this._preTouchPoolPointer]=t,this._preTouchPoolPointer=(this._preTouchPoolPointer+1)%50))},getTouchByXY:function(t,e,i){var n=this._preTouchPoint,r=this._glView.convertToLocationInView(t,e,i),o=new cc.Touch(r.x,r.y);return o._setPrevPoint(n.x,n.y),n.x=r.x,n.y=r.y,o},getMouseEvent:function(t,e,i){var n=this._prevMousePoint,r=new cc.Event.EventMouse(i);return r._setPrevCursor(n.x,n.y),n.x=t.x,n.y=t.y,this._glView._convertMouseToLocationInView(n,e),r.setLocation(n.x,n.y),r},getPointByEvent:function(t,e){return null!=t.pageX?{x:t.pageX,y:t.pageY}:(cc._isWechatGame()?(e.left=0,e.top=0):(e.left-=document.body.scrollLeft,e.top-=document.body.scrollTop),{x:t.clientX,y:t.clientY})},getTouchesByEvent:function(t,e){for(var i,n,r,o=[],s=this._glView,a=this._preTouchPoint,c=t.changedTouches.length,h=0;h<c;h++)if(i=t.changedTouches[h]){var l;l=cc.sys.BROWSER_TYPE_FIREFOX===cc.sys.browserType?s.convertToLocationInView(i.pageX,i.pageY,e):s.convertToLocationInView(i.clientX,i.clientY,e),null!=i.identifier?(n=new cc.Touch(l.x,l.y,i.identifier),r=this.getPreTouch(n).getLocation(),n._setPrevPoint(r.x,r.y),this.setPreTouch(n)):(n=new cc.Touch(l.x,l.y))._setPrevPoint(a.x,a.y),a.x=l.x,a.y=l.y,o.push(n)}return o},registerSystemEvent:function(t){function e(t){cc._isWechatGame()?(t.left=0,t.top=0):(t.left-=document.body.scrollLeft,t.top-=document.body.scrollTop)}if(!this._isRegisterEvent){this._glView=cc.view;var i=this,n="mouse"in cc.sys.capabilities;if(n){var r=cc.sys.isMobile;cc._isWechatGame()&&(r=!1,d=!0,n=!1),r||(window.addEventListener("mousedown",(function(){i._mousePressed=!0}),!1),window.addEventListener("mouseup",(function(e){if(i._mousePressed){i._mousePressed=!1;var n=i.getHTMLElementPosition(t),r=i.getPointByEvent(e,n);if(!cc.rectContainsPoint(new cc.Rect(n.left,n.top,n.width,n.height),r)){i.handleTouchesEnd([i.getTouchByXY(r.x,r.y,n)]);var o=i.getMouseEvent(r,n,cc.Event.EventMouse.UP);o.setButton(e.button),cc.eventManager.dispatchEvent(o)}}}),!1));for(var o=cc.Event.EventMouse,s=[!r&&["mousedown",o.DOWN,function(e,n,r,o){i._mousePressed=!0,i.handleTouchesBegin([i.getTouchByXY(r.x,r.y,o)]),cc._isWechatGame()||t.focus()}],!r&&["mouseup",o.UP,function(t,e,n,r){i._mousePressed=!1,i.handleTouchesEnd([i.getTouchByXY(n.x,n.y,r)])}],!r&&["mousemove",o.MOVE,function(t,e,n,r){i.handleTouchesMove([i.getTouchByXY(n.x,n.y,r)]),i._mousePressed||e.setButton(null)}],["mousewheel",o.SCROLL,function(t,e){e.setScrollData(0,t.wheelDelta)}],["DOMMouseScroll",o.SCROLL,function(t,e){e.setScrollData(0,-120*t.detail)}]],a=0;a<s.length;++a){var c=s[a];c&&(function(){var e=c[0],n=c[1],r=c[2];t.addEventListener(e,(function(e){var o=i.getHTMLElementPosition(t),s=i.getPointByEvent(e,o),a=i.getMouseEvent(s,o,n);a.setButton(e.button),r(e,a,s,o),cc.eventManager.dispatchEvent(a),e.stopPropagation(),e.preventDefault()}),!1)})()}}if(window.navigator.msPointerEnabled){var h={MSPointerDown:i.handleTouchesBegin,MSPointerMove:i.handleTouchesMove,MSPointerUp:i.handleTouchesEnd,MSPointerCancel:i.handleTouchesCancel},l=function(e){var n=h[e];t.addEventListener(e,(function(e){var r=i.getHTMLElementPosition(t);r.left-=document.documentElement.scrollLeft,r.top-=document.documentElement.scrollTop,n.call(i,[i.getTouchByXY(e.clientX,e.clientY,r)]),e.stopPropagation()}),!1)};for(var u in h)l(u)}var d="touches"in cc.sys.capabilities;if(d){var _={touchstart:function(e){i.handleTouchesBegin(e),cc._isWechatGame()||t.focus()},touchmove:function(t){i.handleTouchesMove(t)},touchend:function(t){i.handleTouchesEnd(t)},touchcancel:function(t){i.handleTouchesCancel(t)}},f=function(n){var r=_[n];t.addEventListener(n,(function(n){if(n.changedTouches){var o=i.getHTMLElementPosition(t);document.body;e(o),r(i.getTouchesByEvent(n,o)),n.stopPropagation(),n.preventDefault()}}),!1)};for(var u in _)f(u)}this._registerKeyboardEvent(),this._registerAccelerometerEvent(),this._isRegisterEvent=!0}},_registerKeyboardEvent:function(){},_registerAccelerometerEvent:function(){},update:function(t){this._accelCurTime>this._accelInterval&&(this._accelCurTime-=this._accelInterval,cc.eventManager.dispatchEvent(new cc.Event.EventAcceleration(this._acceleration))),this._accelCurTime+=t}};e.exports=r}),{"./CCMacro":151}],151:[(function(t,e,i){t("./_CCClass"),cc.KEY={none:0,back:6,menu:18,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,select:41,insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,"*":106,"+":107,"-":109,numdel:110,"/":111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,";":186,semicolon:186,equal:187,"=":187,",":188,comma:188,dash:189,".":190,period:190,forwardslash:191,grave:192,"[":219,openbracket:219,backslash:220,"]":221,closebracket:221,quote:222,dpadLeft:1e3,dpadRight:1001,dpadUp:1003,dpadDown:1004,dpadCenter:1005},cc.ImageFormat=cc.Enum({JPG:0,PNG:1,TIFF:2,WEBP:3,PVR:4,ETC:5,S3TC:6,ATITC:7,TGA:8,RAWDATA:9,UNKNOWN:10}),cc.getImageFormatByData=function(t){return t.length>8&&137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]&&13===t[4]&&10===t[5]&&26===t[6]&&10===t[7]?cc.ImageFormat.PNG:t.length>2&&(73===t[0]&&73===t[1]||77===t[0]&&77===t[1]||255===t[0]&&216===t[1])?cc.ImageFormat.TIFF:cc.ImageFormat.UNKNOWN},cc.macro={INVALID_INDEX:-1,NODE_TAG_INVALID:-1,PI:Math.PI,PI2:2*Math.PI,FLT_MAX:parseFloat("3.402823466e+38F"),FLT_MIN:parseFloat("1.175494351e-38F"),RAD:Math.PI/180,DEG:180/Math.PI,UINT_MAX:4294967295,REPEAT_FOREVER:Number.MAX_VALUE-1,FLT_EPSILON:1.192092896e-7,ONE:1,ZERO:0,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,DST_ALPHA:772,DST_COLOR:774,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,LINEAR:9729,BLEND_DST:771,WEB_ORIENTATION_PORTRAIT:0,WEB_ORIENTATION_LANDSCAPE_LEFT:-90,WEB_ORIENTATION_PORTRAIT_UPSIDE_DOWN:180,WEB_ORIENTATION_LANDSCAPE_RIGHT:90,ORIENTATION_PORTRAIT:1,ORIENTATION_LANDSCAPE:2,ORIENTATION_AUTO:3,DENSITYDPI_DEVICE:"device-dpi",DENSITYDPI_HIGH:"high-dpi",DENSITYDPI_MEDIUM:"medium-dpi",DENSITYDPI_LOW:"low-dpi",VERTEX_ATTRIB_FLAG_NONE:0,VERTEX_ATTRIB_FLAG_POSITION:1,VERTEX_ATTRIB_FLAG_COLOR:2,VERTEX_ATTRIB_FLAG_TEX_COORDS:4,VERTEX_ATTRIB_FLAG_POS_COLOR_TEX:7,GL_ALL:0,VERTEX_ATTRIB_POSITION:0,VERTEX_ATTRIB_COLOR:1,VERTEX_ATTRIB_TEX_COORDS:2,VERTEX_ATTRIB_MAX:3,UNIFORM_PMATRIX:0,UNIFORM_MVMATRIX:1,UNIFORM_MVPMATRIX:2,UNIFORM_TIME:3,UNIFORM_SINTIME:4,UNIFORM_COSTIME:5,UNIFORM_RANDOM01:6,UNIFORM_SAMPLER:7,UNIFORM_MAX:8,SHADER_POSITION_TEXTURECOLOR:"ShaderPositionTextureColor",SHADER_SPRITE_POSITION_TEXTURECOLOR:"ShaderSpritePositionTextureColor",SHADER_POSITION_TEXTURECOLORALPHATEST:"ShaderPositionTextureColorAlphaTest",SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST:"ShaderSpritePositionTextureColorAlphaTest",SHADER_POSITION_COLOR:"ShaderPositionColor",SHADER_SPRITE_POSITION_COLOR:"ShaderSpritePositionColor",SHADER_POSITION_TEXTURE:"ShaderPositionTexture",SHADER_POSITION_TEXTURE_UCOLOR:"ShaderPositionTexture_uColor",SHADER_POSITION_TEXTUREA8COLOR:"ShaderPositionTextureA8Color",SHADER_POSITION_UCOLOR:"ShaderPosition_uColor",SHADER_POSITION_LENGTHTEXTURECOLOR:"ShaderPositionLengthTextureColor",UNIFORM_PMATRIX_S:"CC_PMatrix",UNIFORM_MVMATRIX_S:"CC_MVMatrix",UNIFORM_MVPMATRIX_S:"CC_MVPMatrix",UNIFORM_TIME_S:"CC_Time",UNIFORM_SINTIME_S:"CC_SinTime",UNIFORM_COSTIME_S:"CC_CosTime",UNIFORM_RANDOM01_S:"CC_Random01",UNIFORM_SAMPLER_S:"CC_Texture0",UNIFORM_ALPHA_TEST_VALUE_S:"CC_alpha_value",ATTRIBUTE_NAME_COLOR:"a_color",ATTRIBUTE_NAME_POSITION:"a_position",ATTRIBUTE_NAME_TEX_COORD:"a_texCoord",ITEM_SIZE:32,CURRENT_ITEM:3233828865,ZOOM_ACTION_TAG:3233828866,NORMAL_TAG:8801,SELECTED_TAG:8802,DISABLE_TAG:8803,FIX_ARTIFACTS_BY_STRECHING_TEXEL:0,DIRECTOR_STATS_POSITION:cc.p(0,0),DIRECTOR_FPS_INTERVAL:.5,COCOSNODE_RENDER_SUBPIXEL:1,SPRITEBATCHNODE_RENDER_SUBPIXEL:1,AUTO_PREMULTIPLIED_ALPHA_FOR_PNG:0,OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA:0,TEXTURE_ATLAS_USE_TRIANGLE_STRIP:0,TEXTURE_ATLAS_USE_VAO:0,TEXTURE_NPOT_SUPPORT:0,USE_LA88_LABELS:1,SPRITE_DEBUG_DRAW:0,LABELBMFONT_DEBUG_DRAW:0,LABELATLAS_DEBUG_DRAW:0,ENABLE_STACKABLE_ACTIONS:1,ENABLE_GL_STATE_CACHE:1,TOUCH_TIMEOUT:5e3,BATCH_VERTEX_COUNT:2e4,ENABLE_GC_FOR_NATIVE_OBJECTS:!0,ENABLE_CULLING:!0,ENABLE_TILEDMAP_CULLING:!0,DOWNLOAD_MAX_CONCURRENT:64,ENABLE_TRANSPARENT_CANVAS:!1},cc.defineGetterSetter(cc.macro,"BLEND_SRC",(function(){return cc._renderType===cc.game.RENDER_TYPE_WEBGL&&cc.macro.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA?cc.macro.ONE:cc.macro.SRC_ALPHA})),cc.lerp=function(t,e,i){return t+(e-t)*i},cc.rand=function(){return 16777215*Math.random()},cc.randomMinus1To1=function(){return 2*(Math.random()-.5)},cc.random0To1=Math.random,cc.degreesToRadians=function(t){return t*cc.macro.RAD},cc.radiansToDegrees=function(t){return t*cc.macro.DEG},cc.nodeDrawSetup=function(t){t._shaderProgram&&(t._shaderProgram.use(),t._shaderProgram.setUniformForModelViewAndProjectionMatrixWithMat4())},cc.incrementGLDraws=function(t){cc.g_NumberOfDraws+=t},cc.checkGLErrorDebug=function(){if(cc._renderType===cc.game.RENDER_TYPE_WEBGL){var t=cc._renderContext.getError();t&&cc.logID(2400,t)}},e.exports=cc.macro}),{"./_CCClass":158}],152:[(function(t,e,i){function n(){this._name="",this._objFlags=0}function r(){for(var t=h.length,e=0;e<t;++e){var i=h[e];i._objFlags&c||i._destroyImmediate()}t===h.length?h.length=0:h.splice(0,t)}function o(t,e){var i,n={};for(i in t)if(t.hasOwnProperty(i))switch(typeof t[i]){case"string":n[i]="";break;case"object":case"function":n[i]=null}if(cc.Class._isCCClass(e))for(var r=cc.Class.Attr.getClassAttrs(e),o=e.__props__,s=0;s<o.length;s++){var c=(i=o[s])+cc.Class.Attr.DELIMETER+"default";if(c in r)switch(typeof r[c]){case"string":n[i]="";break;case"object":case"function":n[i]=null;break;case"undefined":n[i]=void 0}}var h=t instanceof cc._BaseNode||t instanceof cc.Component;if(cc.supportJit){var l="";for(i in n)if(!h||"_id"!==i){var u;u=a.IDENTIFIER_RE.test(i)?"o."+i+"=":"o["+a.escapeForJS(i)+"]=";var d=n[i];""===d&&(d='""'),l+=u+d+";\n"}return Function("o",l)}return function(t){for(i in n)h&&"_id"===i||(t[i]=n[i])}}var s=t("./js"),a=t("./CCClass"),c=1;a.fastDefine("cc.Object",n,{_name:"",_objFlags:0}),s.value(n,"Flags",{Destroyed:c,DontSave:8,EditorOnly:16,Dirty:32,DontDestroy:64,PersistentMask:-4192741,Destroying:128,Deactivating:256,IsPreloadStarted:8192,IsOnLoadStarted:32768,IsOnLoadCalled:16384,IsOnEnableCalled:2048,IsStartCalled:65536,IsEditorOnEnableCalled:4096,IsPositionLocked:1<<21,IsRotationLocked:1<<17,IsScaleLocked:1<<18,IsAnchorLocked:1<<19,IsSizeLocked:1<<20});var h=[];s.value(n,"_deferredDestroy",r);var l=n.prototype;s.getset(l,"name",(function(){return this._name}),(function(t){this._name=t})),s.get(l,"isValid",(function(){return!(this._objFlags&c)}));l.destroy=function(){return this._objFlags&c?(cc.warnID(5e3),!1):!(4&this._objFlags)&&(this._objFlags|=4,h.push(this),!0)},l._destruct=function(){var t=this.constructor,e=t.__destruct__;e||(e=o(this,t),s.value(t,"__destruct__",e,!0)),e(this)},l._onPreDestroy=null,l._destroyImmediate=function(){this._objFlags&c?cc.errorID(5e3):(this._onPreDestroy&&this._onPreDestroy(),this._destruct(),this._objFlags|=c)},l._deserialize=null,cc.isValid=function(t){return"object"==typeof t?!(!t||t._objFlags&c):void 0!==t},cc.Object=e.exports=n}),{"./CCClass":146,"./js":167}],153:[(function(t,e,i){cc.SAXParser=cc._Class.extend({ctor:function(){window.DOMParser?(this._isSupportDOMParser=!0,this._parser=new DOMParser):(this._isSupportDOMParser=!1,this._parser=null)},parse:function(t){return this._parseXML(t)},_parseXML:function(t){var e;return this._isSupportDOMParser?e=this._parser.parseFromString(t,"text/xml"):((e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t)),e}}),cc.PlistParser=cc.SAXParser.extend({parse:function(t){var e=this._parseXML(t),i=e.documentElement;if("plist"!==i.tagName)return cc.warnID(5100),{};for(var n=null,r=0,o=i.childNodes.length;r<o&&1!==(n=i.childNodes[r]).nodeType;r++);return e=null,this._parseNode(n)},_parseNode:function(t){var e=null,i=t.tagName;if("dict"===i)e=this._parseDict(t);else if("array"===i)e=this._parseArray(t);else if("string"===i)if(1===t.childNodes.length)e=t.firstChild.nodeValue;else{e="";for(var n=0;n<t.childNodes.length;n++)e+=t.childNodes[n].nodeValue}else"false"===i?e=!1:"true"===i?e=!0:"real"===i?e=parseFloat(t.firstChild.nodeValue):"integer"===i&&(e=parseInt(t.firstChild.nodeValue,10));return e},_parseArray:function(t){for(var e=[],i=0,n=t.childNodes.length;i<n;i++){var r=t.childNodes[i];1===r.nodeType&&e.push(this._parseNode(r))}return e},_parseDict:function(t){for(var e={},i=null,n=0,r=t.childNodes.length;n<r;n++){var o=t.childNodes[n];1===o.nodeType&&("key"===o.tagName?i=o.firstChild.nodeValue:e[i]=this._parseNode(o))}return e}}),cc.saxParser=new cc.SAXParser,cc.plistParser=new cc.PlistParser}),{}],154:[(function(t,e,i){cc.screen={_supportsFullScreen:!1,_preOnFullScreenChange:null,_touchEvent:"",_fn:null,_fnMap:[["requestFullscreen","exitFullscreen","fullscreenchange","fullscreenEnabled","fullscreenElement"],["requestFullScreen","exitFullScreen","fullScreenchange","fullScreenEnabled","fullScreenElement"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitfullscreenchange","webkitIsFullScreen","webkitCurrentFullScreenElement"],["mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozFullScreen","mozFullScreenElement"],["msRequestFullscreen","msExitFullscreen","MSFullscreenChange","msFullscreenEnabled","msFullscreenElement"]],init:function(){this._fn={};var t,e,i,n,r=this._fnMap;for(t=0,e=r.length;t<e;t++)if((i=r[t])&&i[1]in document){for(t=0,n=i.length;t<n;t++)this._fn[r[0][t]]=i[t];break}this._supportsFullScreen=void 0!==this._fn.requestFullscreen,this._touchEvent="ontouchstart"in window?"touchstart":"mousedown"},fullScreen:function(){return!!this._supportsFullScreen&&(void 0!==document[this._fn.fullscreenElement]&&null!==document[this._fn.fullscreenElement])},requestFullScreen:function(t,e){if(this._supportsFullScreen){if(t=t||document.documentElement,e){var i=this._fn.fullscreenchange;this._preOnFullScreenChange&&document.removeEventListener(i,this._preOnFullScreenChange),this._preOnFullScreenChange=e,document.addEventListener(i,e,!1)}return t[this._fn.requestFullscreen]()}},exitFullScreen:function(){return!this._supportsFullScreen||document[this._fn.exitFullscreen]()},autoFullScreen:function(t,e){function i(){n.removeEventListener(r._touchEvent,i),r.requestFullScreen(t,e)}t=t||document.body;var n=cc.game.canvas||t,r=this;this.requestFullScreen(t,e),n.addEventListener(this._touchEvent,i)}},cc.screen.init()}),{}],155:[(function(t,e,i){if(!cc.sys){cc.sys={};var n=cc.sys;n.LANGUAGE_ENGLISH="en",n.LANGUAGE_CHINESE="zh",n.LANGUAGE_FRENCH="fr",n.LANGUAGE_ITALIAN="it",n.LANGUAGE_GERMAN="de",n.LANGUAGE_SPANISH="es",n.LANGUAGE_DUTCH="du",n.LANGUAGE_RUSSIAN="ru",n.LANGUAGE_KOREAN="ko",n.LANGUAGE_JAPANESE="ja",n.LANGUAGE_HUNGARIAN="hu",n.LANGUAGE_PORTUGUESE="pt",n.LANGUAGE_ARABIC="ar",n.LANGUAGE_NORWEGIAN="no",n.LANGUAGE_POLISH="pl",n.LANGUAGE_TURKISH="tr",n.LANGUAGE_UKRAINIAN="uk",n.LANGUAGE_ROMANIAN="ro",n.LANGUAGE_BULGARIAN="bg",n.LANGUAGE_UNKNOWN="unknown",n.OS_IOS="iOS",n.OS_ANDROID="Android",n.OS_WINDOWS="Windows",n.OS_MARMALADE="Marmalade",n.OS_LINUX="Linux",n.OS_BADA="Bada",n.OS_BLACKBERRY="Blackberry",n.OS_OSX="OS X",n.OS_WP8="WP8",n.OS_WINRT="WINRT",n.OS_UNKNOWN="Unknown",n.UNKNOWN=-1,n.WIN32=0,n.LINUX=1,n.MACOS=2,n.ANDROID=3,n.IPHONE=4,n.IPAD=5,n.BLACKBERRY=6,n.NACL=7,n.EMSCRIPTEN=8,n.TIZEN=9,n.WINRT=10,n.WP8=11,n.MOBILE_BROWSER=100,n.DESKTOP_BROWSER=101,n.EDITOR_PAGE=102,n.EDITOR_CORE=103,n.BROWSER_TYPE_WECHAT="wechat",n.BROWSER_TYPE_WECHAT_GAME="wechatgame",n.BROWSER_TYPE_ANDROID="androidbrowser",n.BROWSER_TYPE_IE="ie",n.BROWSER_TYPE_QQ="qqbrowser",n.BROWSER_TYPE_MOBILE_QQ="mqqbrowser",n.BROWSER_TYPE_UC="ucbrowser",n.BROWSER_TYPE_360="360browser",n.BROWSER_TYPE_BAIDU_APP="baiduboxapp",n.BROWSER_TYPE_BAIDU="baidubrowser",n.BROWSER_TYPE_MAXTHON="maxthon",n.BROWSER_TYPE_OPERA="opera",n.BROWSER_TYPE_OUPENG="oupeng",n.BROWSER_TYPE_MIUI="miuibrowser",n.BROWSER_TYPE_FIREFOX="firefox",n.BROWSER_TYPE_SAFARI="safari",n.BROWSER_TYPE_CHROME="chrome",n.BROWSER_TYPE_LIEBAO="liebao",n.BROWSER_TYPE_QZONE="qzone",n.BROWSER_TYPE_SOUGOU="sogou",n.BROWSER_TYPE_UNKNOWN="unknown",n.isNative=!1,n.isBrowser="object"==typeof window&&"object"==typeof document;var r=window,o=r.navigator,s=document,a=s.documentElement,c=o.userAgent.toLowerCase();n.isMobile=/mobile|android|iphone|ipad/.test(c),n.platform=n.isMobile?n.MOBILE_BROWSER:n.DESKTOP_BROWSER;var h=o.language;h=(h=h||o.browserLanguage)?h.split("-")[0]:n.LANGUAGE_ENGLISH,n.language=h;var l=!1,u=!1,d="",_=0,f=/android (\d+(?:\.\d+)+)/i.exec(c)||/android (\d+(?:\.\d+)+)/i.exec(o.platform);f&&(l=!0,d=f[1]||"",_=parseInt(d)||0),(f=/(iPad|iPhone|iPod).*OS ((\d+_?){2,3})/i.exec(c))?(u=!0,d=f[2]||"",_=parseInt(d)||0):/(iPhone|iPad|iPod)/.exec(o.platform)&&(u=!0,d="",_=0);var p=n.OS_UNKNOWN;-1!==o.appVersion.indexOf("Win")?p=n.OS_WINDOWS:u?p=n.OS_IOS:-1!==o.appVersion.indexOf("Mac")?p=n.OS_OSX:-1!==o.appVersion.indexOf("X11")&&-1===o.appVersion.indexOf("Linux")?p=n.OS_UNIX:l?p=n.OS_ANDROID:-1===o.appVersion.indexOf("Linux")&&-1===c.indexOf("ubuntu")||(p=n.OS_LINUX),n.os=p,n.osVersion=d,n.osMainVersion=_,n.browserType=n.BROWSER_TYPE_UNKNOWN,(function(){var t=/qqbrowser|chrome|safari|firefox|trident|opera|opr|oupeng/i,e=/mqqbrowser|micromessenger|qq|sogou|qzone|liebao|maxthon|ucbrowser|360 aphone|360browser|baiduboxapp|baidubrowser|maxthon|mxbrowser|miuibrowser/i.exec(c);e||(e=t.exec(c));var i=e?e[0].toLowerCase():n.BROWSER_TYPE_UNKNOWN;"micromessenger"===i?i=n.BROWSER_TYPE_WECHAT:"safari"===i&&l?i=n.BROWSER_TYPE_ANDROID:"qq"===i&&c.match(/android.*applewebkit/i)?brwoserType=n.BROWSER_TYPE_ANDROID:"trident"===i?i=n.BROWSER_TYPE_IE:"360 aphone"===i?i=n.BROWSER_TYPE_360:"mxbrowser"===i?i=n.BROWSER_TYPE_MAXTHON:"opr"===i&&(i=n.BROWSER_TYPE_OPERA),cc._isWechatGame()&&(i=n.BROWSER_TYPE_WECHAT_GAME),n.browserType=i})(),n.browserVersion="",(function(){var t=/(mqqbrowser|micromessenger|qq|sogou|qzone|liebao|maxthon|uc|360 aphone|360|baiduboxapp|baidu|maxthon|mxbrowser|miui)(mobile)?(browser)?\/?([\d.]+)/i,e=/(qqbrowser|chrome|safari|firefox|trident|opera|opr|oupeng)(mobile)?(browser)?\/?([\d.]+)/i,i=c.match(t);i||(i=c.match(e)),n.browserVersion=i?i[4]:""})();var g=window.innerWidth||document.documentElement.clientWidth,v=window.innerHeight||document.documentElement.clientHeight,m=window.devicePixelRatio||1;n.windowPixelResolution={width:m*g,height:m*v},n._checkWebGLRenderMode=function(){if(cc._renderType!==cc.game.RENDER_TYPE_WEBGL)throw new Error("This feature supports WebGL render mode only.")};var y=document.createElement("canvas"),T=document.createElement("canvas");if(cc.create3DContext=function(t,e,i){if(!i)return cc.create3DContext(t,e,"webgl")||cc.create3DContext(t,e,"experimental-webgl")||cc.create3DContext(t,e,"webkit-3d")||cc.create3DContext(t,e,"moz-webgl")||null;try{return t.getContext(i,e)}catch(t){return null}},n._supportCanvasNewBlendModes=(function(){var t=y;t.width=1,t.height=1;var e=t.getContext("2d");e.fillStyle="#000",e.fillRect(0,0,1,1),e.globalCompositeOperation="multiply";var i=T;i.width=1,i.height=1;var n=i.getContext("2d");return n.fillStyle="#fff",n.fillRect(0,0,1,1),e.drawImage(i,0,0,1,1),0===e.getImageData(0,0,1,1).data[0]})(),cc.sys.isMobile){var C=document.createElement("style");C.type="text/css",document.body.appendChild(C),C.textContent="body,canvas,div{ -moz-user-select: none;-webkit-user-select: none;-ms-user-select: none;-khtml-user-select: none;-webkit-tap-highlight-color:rgba(0,0,0,0);}"}try{var x=n.localStorage=r.localStorage;x.setItem("storage",""),x.removeItem("storage"),x=null}catch(t){var E=function(){cc.warnID(5200)};n.localStorage={getItem:E,setItem:E,removeItem:E,clear:E}}var S=!!y.getContext("2d"),b=!1;if(r.WebGLRenderingContext&&(cc.create3DContext(document.createElement("CANVAS"))&&(b=!0),b&&n.os===n.OS_IOS&&9===n.osMainVersion&&(r.indexedDB||(b=!1)),b&&n.os===n.OS_ANDROID)){var A=parseFloat(n.browserVersion);switch(n.browserType){case n.BROWSER_TYPE_MOBILE_QQ:case n.BROWSER_TYPE_BAIDU:case n.BROWSER_TYPE_BAIDU_APP:b=A>=6.2;break;case n.BROWSER_TYPE_ANDROID:n.osMainVersion&&n.osMainVersion>=5&&(b=!0);break;case n.BROWSER_TYPE_CHROME:b=A>=30;break;case n.BROWSER_TYPE_UC:b=A>11;case n.BROWSER_TYPE_360:b=!1}}cc._isWechatGame()&&(b=!0);var R=n.capabilities={canvas:S,opengl:b,webp:!1};(void 0!==a.ontouchstart||void 0!==s.ontouchstart||o.msPointerEnabled)&&(R.touches=!0),void 0!==a.onmouseup&&(R.mouse=!0),void 0!==a.onkeyup&&(R.keyboard=!0),(r.DeviceMotionEvent||r.DeviceOrientationEvent)&&(R.accelerometer=!0);var I;!(function(){n.browserVersion;var t=!cc._isWechatGame()&&!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext);I={ONLY_ONE:!1,WEB_AUDIO:t,DELAY_CREATE_CTX:!1},n.os===n.OS_IOS&&(I.USE_LOADER_EVENT="loadedmetadata"),n.browserType===n.BROWSER_TYPE_FIREFOX&&(I.DELAY_CREATE_CTX=!0,I.USE_LOADER_EVENT="canplay"),n.os===n.OS_ANDROID&&n.browserType===n.BROWSER_TYPE_UC&&(I.ONE_SOURCE=!0)})();try{I.WEB_AUDIO&&(I.context=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext),I.DELAY_CREATE_CTX&&setTimeout((function(){I.context=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext)}),0))}catch(t){I.WEB_AUDIO=!1,cc.logID(5201)}var w=[];!(function(){var t=document.createElement("audio");t.canPlayType&&(t.canPlayType('audio/ogg; codecs="vorbis"')&&w.push(".ogg"),t.canPlayType("audio/mpeg")&&w.push(".mp3"),t.canPlayType('audio/wav; codecs="1"')&&w.push(".wav"),t.canPlayType("audio/mp4")&&w.push(".mp4"),t.canPlayType("audio/x-m4a")&&w.push(".m4a"))})(),I.format=w,n.__audioSupport=I,n.garbageCollect=function(){},n.dumpRoot=function(){},n.restartVM=function(){},n.cleanScript=function(t){},n.isObjectValid=function(t){return!!t},n.dump=function(){var t=this,e="";e+="isMobile : "+t.isMobile+"\r\n",e+="language : "+t.language+"\r\n",e+="browserType : "+t.browserType+"\r\n",e+="browserVersion : "+t.browserVersion+"\r\n",e+="capabilities : "+JSON.stringify(t.capabilities)+"\r\n",e+="os : "+t.os+"\r\n",e+="osVersion : "+t.osVersion+"\r\n",e+="platform : "+t.platform+"\r\n",e+="Using "+(cc._renderType===cc.game.RENDER_TYPE_WEBGL?"WEBGL":"CANVAS")+" renderer.\r\n",cc.log(e)},n.openURL=function(t){window.open(t)},n.now=function(){return Date.now?Date.now():+new Date},e.exports=n}}),{}],156:[(function(t,e,i){var n={init:function(){cc._isWechatGame()||(this.html=document.getElementsByTagName("html")[0]),this.html=document.getElementsByTagName("html")[0]},availWidth:function(t){return cc._isWechatGame()?window.innerWidth:t&&t!==this.html?t.clientWidth:window.innerWidth},availHeight:function(t){return cc._isWechatGame()?window.innerHeight:t&&t!==this.html?t.clientHeight:window.innerHeight},meta:{width:"device-width"},adaptationType:cc.sys.browserType};switch(window.navigator.userAgent.indexOf("OS 8_1_")>-1&&(n.adaptationType=cc.sys.BROWSER_TYPE_MIUI),cc.sys.os===cc.sys.OS_IOS&&(n.adaptationType=cc.sys.BROWSER_TYPE_SAFARI),n.adaptationType){case cc.sys.BROWSER_TYPE_SAFARI:n.meta["minimal-ui"]="true",n.availWidth=function(t){return cc._isWechatGame()?window.innerWidth:t.clientWidth},n.availHeight=function(t){return cc._isWechatGame()?window.innerHeight:t.clientHeight};break;case cc.sys.BROWSER_TYPE_CHROME:n.__defineGetter__("target-densitydpi",(function(){return cc.view._targetDensityDPI}));break;case cc.sys.BROWSER_TYPE_SOUGOU:case cc.sys.BROWSER_TYPE_UC:n.availWidth=function(t){return t.clientWidth},n.availHeight=function(t){return t.clientHeight};break;case cc.sys.BROWSER_TYPE_MIUI:n.init=function(t){if(!t.__resizeWithBrowserSize){var e=function(){t.setDesignResolutionSize(t._designResolutionSize.width,t._designResolutionSize.height,t._resolutionPolicy),window.removeEventListener("resize",e,!1)};window.addEventListener("resize",e,!1)}}}var r=null,o=cc._Class.extend({ctor:function(){var t=this,e=cc.ContainerStrategy,i=cc.ContentStrategy;n.init(this),t._frameSize=cc.size(0,0),t._initFrameSize();var r=cc.game.canvas.width,o=cc.game.canvas.height;t._designResolutionSize=cc.size(r,o),t._originalDesignResolutionSize=cc.size(r,o),t._viewPortRect=cc.rect(0,0,r,o),t._visibleRect=cc.rect(0,0,r,o),t._contentTranslateLeftTop={left:0,top:0},t._autoFullScreen=!1,t._devicePixelRatio=1,t._viewName="Cocos2dHTML5",t._resizeCallback=null,t._orientationChanging=!0,t._resizing=!1,t._scaleX=1,t._originalScaleX=1,t._scaleY=1,t._originalScaleY=1,t._isRotated=!1,t._orientation=3;var s=cc.sys;t.enableRetina(s.os===s.OS_IOS||s.os===s.OS_OSX),cc.visibleRect&&cc.visibleRect.init(t._visibleRect),t._resolutionPolicy=null,t._rpExactFit=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,i.EXACT_FIT),t._rpShowAll=new cc.ResolutionPolicy(e.PROPORTION_TO_FRAME,i.SHOW_ALL),t._rpNoBorder=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,i.NO_BORDER),t._rpFixedHeight=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,i.FIXED_HEIGHT),t._rpFixedWidth=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,i.FIXED_WIDTH),t._initialized=!1,t._contentTranslateLeftTop=null,t._frameZoomFactor=1,t.__resizeWithBrowserSize=!1,t._isAdjustViewPort=!0,t._targetDensityDPI=cc.macro.DENSITYDPI_HIGH,t.enableAntiAlias(!0)},_resizeEvent:function(){var t,e=(t=this.setDesignResolutionSize?this:cc.view)._frameSize.width,i=t._frameSize.height,n=t._isRotated;if(cc.sys.isMobile){var r=cc.game.container.style,o=r.margin;r.margin="0",r.display="none",t._initFrameSize(),r.margin=o,r.display="block"}else t._initFrameSize();if(t._isRotated!==n||t._frameSize.width!==e||t._frameSize.height!==i){var s=t._originalDesignResolutionSize.width,a=t._originalDesignResolutionSize.height;t._resizing=!0,s>0&&t.setDesignResolutionSize(s,a,t._resolutionPolicy),t._resizing=!1,cc.eventManager.dispatchCustomEvent("canvas-resize"),t._resizeCallback&&t._resizeCallback.call()}},_orientationChange:function(){cc.view._orientationChanging=!0,cc.view._resizeEvent()},setTargetDensityDPI:function(t){this._targetDensityDPI=t,this._adjustViewportMeta()},getTargetDensityDPI:function(){return this._targetDensityDPI},resizeWithBrowserSize:function(t){t?this.__resizeWithBrowserSize||(this.__resizeWithBrowserSize=!0,window.addEventListener("resize",this._resizeEvent),window.addEventListener("orientationchange",this._orientationChange)):this.__resizeWithBrowserSize&&(this.__resizeWithBrowserSize=!1,window.removeEventListener("resize",this._resizeEvent),window.removeEventListener("orientationchange",this._orientationChange))},setResizeCallback:function(t){"function"!=typeof t&&null!=t||(this._resizeCallback=t)},setOrientation:function(t){if((t&=cc.macro.ORIENTATION_AUTO)&&this._orientation!==t){this._orientation=t;var e=this._originalDesignResolutionSize.width,i=this._originalDesignResolutionSize.height;this.setDesignResolutionSize(e,i,this._resolutionPolicy)}},_initFrameSize:function(){var t=this._frameSize,e=n.availWidth(cc.game.frame),i=n.availHeight(cc.game.frame),r=e>=i;!cc.sys.isMobile||r&&this._orientation&cc.macro.ORIENTATION_LANDSCAPE||!r&&this._orientation&cc.macro.ORIENTATION_PORTRAIT?(t.width=e,t.height=i,cc.container.style["-webkit-transform"]="rotate(0deg)",cc.container.style.transform="rotate(0deg)",this._isRotated=!1):(t.width=i,t.height=e,cc.container.style["-webkit-transform"]="rotate(90deg)",cc.container.style.transform="rotate(90deg)",cc.container.style["-webkit-transform-origin"]="0px 0px 0px",cc.container.style.transformOrigin="0px 0px 0px",this._isRotated=!0),this._orientationChanging&&setTimeout((function(){cc.view._orientationChanging=!1}),1e3)},_adjustSizeKeepCanvasSize:function(){var t=this._originalDesignResolutionSize.width,e=this._originalDesignResolutionSize.height;t>0&&this.setDesignResolutionSize(t,e,this._resolutionPolicy)},_setViewportMeta:function(t,e){var i=document.getElementById("cocosMetaElement");i&&e&&document.head.removeChild(i);var n,r,o,s=document.getElementsByName("viewport"),a=s?s[0]:null;n=a?a.content:"",(i=i||document.createElement("meta")).id="cocosMetaElement",i.name="viewport",i.content="";for(r in t)-1==n.indexOf(r)?n+=","+r+"="+t[r]:e&&(o=new RegExp(r+"s*=s*[^,]+"),n.replace(o,r+"="+t[r]));/^,/.test(n)&&(n=n.substr(1)),i.content=n,a&&(a.content=n),document.head.appendChild(i)},_adjustViewportMeta:function(){this._isAdjustViewPort&&(cc._isWechatGame()||this._setViewportMeta(n.meta,!1),this._isAdjustViewPort=!1)},_resetScale:function(){this._scaleX=this._originalScaleX,this._scaleY=this._originalScaleY},_adjustSizeToBrowser:function(){},initialize:function(){this._initialized=!0},adjustViewPort:function(t){this._isAdjustViewPort=t},enableRetina:function(t){this._retinaEnabled=!!t},isRetinaEnabled:function(){return this._retinaEnabled},enableAntiAlias:function(t){if(this._antiAliasEnabled!==t)if(this._antiAliasEnabled=t,cc._renderType===cc.game.RENDER_TYPE_WEBGL){var e=cc.loader._cache;for(var i in e){var n=e[i],r=n&&n.content instanceof cc.Texture2D?n.content:null;r&&(t?r.setAntiAliasTexParameters():r.setAliasTexParameters())}}else if(cc._renderType===cc.game.RENDER_TYPE_CANVAS){var o=cc._canvas.getContext("2d");o.imageSmoothingEnabled=t,o.mozImageSmoothingEnabled=t;var s=cc.rendererCanvas._dirtyRegion;if(s){var a=new cc.Region;a.setTo(0,0,cc.visibleRect.width,cc.visibleRect.height),s.addRegion(a)}}},isAntiAliasEnabled:function(){return this._antiAliasEnabled},enableAutoFullScreen:function(t){t&&t!==this._autoFullScreen&&cc.sys.isMobile&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_WECHAT&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_WECHAT_GAME?(this._autoFullScreen=!0,cc.screen.autoFullScreen(cc.game.frame)):this._autoFullScreen=!1},isAutoFullScreenEnabled:function(){return this._autoFullScreen},isViewReady:function(){return cc.game.canvas&&cc._renderContext},setFrameZoomFactor:function(t){this._frameZoomFactor=t,cc.director.setProjection(cc.director.getProjection())},setContentTranslateLeftTop:function(t,e){this._contentTranslateLeftTop={left:t,top:e}},getContentTranslateLeftTop:function(){return this._contentTranslateLeftTop},setCanvasSize:function(t,e){var i=cc.game.canvas,n=cc.game.container;i.width=t*this._devicePixelRatio,i.height=e*this._devicePixelRatio,i.style.width=t+"px",i.style.height=e+"px",n.style.width=t+"px",n.style.height=e+"px",this._resizeEvent()},getCanvasSize:function(){return cc.size(cc.game.canvas.width,cc.game.canvas.height)},getFrameSize:function(){return cc.size(this._frameSize.width,this._frameSize.height)},setFrameSize:function(t,e){this._frameSize.width=t,this._frameSize.height=e,cc.game.frame&&(cc.game.frame.style.width=t+"px",cc.game.frame.style.height=e+"px"),this._resizeEvent(),cc.director.setProjection(cc.director.getProjection())},getVisibleSize:function(){return cc.size(this._visibleRect.width,this._visibleRect.height)},getVisibleSizeInPixel:function(){return cc.size(this._visibleRect.width*this._scaleX,this._visibleRect.height*this._scaleY)},getVisibleOrigin:function(){return cc.p(this._visibleRect.x,this._visibleRect.y)},getVisibleOriginInPixel:function(){return cc.p(this._visibleRect.x*this._scaleX,this._visibleRect.y*this._scaleY)},canSetContentScaleFactor:function(){return!0},getResolutionPolicy:function(){return this._resolutionPolicy},setResolutionPolicy:function(t){var e=this;if(t instanceof cc.ResolutionPolicy)e._resolutionPolicy=t;else{var i=cc.ResolutionPolicy;t===i.EXACT_FIT&&(e._resolutionPolicy=e._rpExactFit),t===i.SHOW_ALL&&(e._resolutionPolicy=e._rpShowAll),t===i.NO_BORDER&&(e._resolutionPolicy=e._rpNoBorder),t===i.FIXED_HEIGHT&&(e._resolutionPolicy=e._rpFixedHeight),t===i.FIXED_WIDTH&&(e._resolutionPolicy=e._rpFixedWidth)}},setDesignResolutionSize:function(t,e,i){if(t>0||e>0){this.setResolutionPolicy(i);var n=this._resolutionPolicy;if(n&&n.preApply(this),cc.sys.isMobile&&this._adjustViewportMeta(),this._orientationChanging=!0,this._resizing||this._initFrameSize(),n){this._originalDesignResolutionSize.width=this._designResolutionSize.width=t,this._originalDesignResolutionSize.height=this._designResolutionSize.height=e;var r=n.apply(this,this._designResolutionSize);if(r.scale&&2===r.scale.length&&(this._scaleX=r.scale[0],this._scaleY=r.scale[1]),r.viewport){var o=this._viewPortRect,s=this._visibleRect,a=r.viewport;o.x=a.x,o.y=a.y,o.width=a.width,o.height=a.height,s.x=-o.x/this._scaleX,s.y=-o.y/this._scaleY,s.width=cc.game.canvas.width/this._scaleX,s.height=cc.game.canvas.height/this._scaleY,cc._renderContext.setOffset&&cc._renderContext.setOffset(o.x,-o.y)}var c=cc.director;c._winSizeInPoints.width=this._designResolutionSize.width,c._winSizeInPoints.height=this._designResolutionSize.height,n.postApply(this),cc.winSize.width=c._winSizeInPoints.width,cc.winSize.height=c._winSizeInPoints.height,cc._renderType===cc.game.RENDER_TYPE_WEBGL?c.setGLDefaultValues():cc._renderType===cc.game.RENDER_TYPE_CANVAS&&(cc.renderer._allNeedDraw=!0),this._originalScaleX=this._scaleX,this._originalScaleY=this._scaleY,cc.visibleRect&&cc.visibleRect.init(this._visibleRect)}else cc.logID(2201)}else cc.logID(2200)},getDesignResolutionSize:function(){return cc.size(this._designResolutionSize.width,this._designResolutionSize.height)},setRealPixelResolution:function(t,e,i){cc._isWechatGame()||(this._setViewportMeta({width:t},!0),document.documentElement.style.width=t+"px",document.body.style.width=t+"px",document.body.style.left="0px",document.body.style.top="0px"),this.setDesignResolutionSize(t,e,i)},setViewPortInPoints:function(t,e,i,n){var r=this._frameZoomFactor,o=this._scaleX,s=this._scaleY;cc._renderContext.viewport(t*o*r+this._viewPortRect.x*r,e*s*r+this._viewPortRect.y*r,i*o*r,n*s*r)},setScissorInPoints:function(t,e,i,n){var o=this._frameZoomFactor,s=this._scaleX,a=this._scaleY,c=Math.ceil(t*s*o+this._viewPortRect.x*o),h=Math.ceil(e*a*o+this._viewPortRect.y*o),l=Math.ceil(i*s*o),u=Math.ceil(n*a*o);if(!r){var d=gl.getParameter(gl.SCISSOR_BOX);r=cc.rect(d[0],d[1],d[2],d[3])}r.x===c&&r.y===h&&r.width===l&&r.height===u||(r.x=c,r.y=h,r.width=l,r.height=u,cc._renderContext.scissor(c,h,l,u))},isScissorEnabled:function(){return cc._renderContext.isEnabled(gl.SCISSOR_TEST)},getScissorRect:function(){if(!r){var t=gl.getParameter(gl.SCISSOR_BOX);r=cc.rect(t[0],t[1],t[2],t[3])}var e=1/this._scaleX,i=1/this._scaleY;return cc.rect((r.x-this._viewPortRect.x)*e,(r.y-this._viewPortRect.y)*i,r.width*e,r.height*i)},setViewName:function(t){null!=t&&t.length>0&&(this._viewName=t)},getViewName:function(){return this._viewName},getViewPortRect:function(){return this._viewPortRect},getScaleX:function(){return this._scaleX},getScaleY:function(){return this._scaleY},getDevicePixelRatio:function(){return this._devicePixelRatio},convertToLocationInView:function(t,e,i){var n=this._devicePixelRatio*(t-i.left),r=this._devicePixelRatio*(i.top+i.height-e);return this._isRotated?{x:this._viewPortRect.width-r,y:n}:{x:n,y:r}},_convertMouseToLocationInView:function(t,e){var i=this._viewPortRect,n=this;t.x=(n._devicePixelRatio*(t.x-e.left)-i.x)/n._scaleX,t.y=(n._devicePixelRatio*(e.top+e.height-t.y)-i.y)/n._scaleY},_convertPointWithScale:function(t){var e=this._viewPortRect;t.x=(t.x-e.x)/this._scaleX,t.y=(t.y-e.y)/this._scaleY},_convertTouchesWithScale:function(t){for(var e,i,n,r=this._viewPortRect,o=this._scaleX,s=this._scaleY,a=0;a<t.length;a++)i=(e=t[a])._point,n=e._prevPoint,i.x=(i.x-r.x)/o,i.y=(i.y-r.y)/s,n.x=(n.x-r.x)/o,n.y=(n.y-r.y)/s}});o._getInstance=function(){return this._instance||(this._instance=this._instance||new o,this._instance.initialize()),this._instance},cc.ContainerStrategy=cc._Class.extend({preApply:function(t){},apply:function(t,e){},postApply:function(t){},_setupContainer:function(t,e,i){var n=cc.game.canvas,r=cc.game.container;cc.sys.os===cc.sys.OS_ANDROID&&(document.body.style.width=(t._isRotated?i:e)+"px",document.body.style.height=(t._isRotated?e:i)+"px"),cc._isWechatGame()||(r.style.width=n.style.width=e+"px",r.style.height=n.style.height=i+"px");var o=t._devicePixelRatio=1;t.isRetinaEnabled()&&(o=t._devicePixelRatio=Math.min(2,window.devicePixelRatio||1)),n.width=e*o,n.height=i*o,cc._isWechatGame()&&(n.style.width=window.innerWidth+"px",n.style.height=window.innerHeight+"px"),cc._renderContext.resetCache&&cc._renderContext.resetCache()},_fixContainer:function(){document.body.insertBefore(cc.container,document.body.firstChild);var t=document.body.style;t.width=window.innerWidth+"px",t.height=window.innerHeight+"px",t.overflow="hidden";var e=cc.container.style;e.position="fixed",e.left=e.top="0px",document.body.scrollTop=0}}),cc.ContentStrategy=cc._Class.extend({_result:{scale:[1,1],viewport:null},_buildResult:function(t,e,i,n,r,o){Math.abs(t-i)<2&&(i=t),Math.abs(e-n)<2&&(n=e);var s=cc.rect(Math.round((t-i)/2),Math.round((e-n)/2),i,n);return cc._renderType,cc.game.RENDER_TYPE_CANVAS,this._result.scale=[r,o],this._result.viewport=s,this._result},preApply:function(t){},apply:function(t,e){return{scale:[1,1]}},postApply:function(t){}}),(function(){var t=cc.ContainerStrategy.extend({apply:function(t){var e=t._frameSize.height,i=cc.container.style;this._setupContainer(t,t._frameSize.width,t._frameSize.height),t._isRotated?i.margin="0 0 0 "+e+"px":i.margin="0px"}}),e=cc.ContainerStrategy.extend({apply:function(t,e){var i,n,r=t._frameSize.width,o=t._frameSize.height,s=cc.container.style,a=e.width,c=e.height,h=r/a,l=o/c;h<l?(i=r,n=c*h):(i=a*l,n=o);var u=Math.round((r-i)/2),d=Math.round((o-n)/2);i=r-2*u,n=o-2*d,this._setupContainer(t,i,n),t._isRotated?s.margin="0 0 0 "+o+"px":s.margin="0px",s.paddingLeft=u+"px",s.paddingRight=u+"px",s.paddingTop=d+"px",s.paddingBottom=d+"px"}}),i=(t.extend({preApply:function(t){this._super(t),cc.game.frame=document.documentElement},apply:function(t){this._super(t),this._fixContainer()}}),e.extend({preApply:function(t){this._super(t),cc.game.frame=document.documentElement},apply:function(t,e){this._super(t,e),this._fixContainer()}}),cc.ContainerStrategy.extend({apply:function(t){this._setupContainer(t,cc.game.canvas.width,cc.game.canvas.height)}}));cc.ContainerStrategy.EQUAL_TO_FRAME=new t,cc.ContainerStrategy.PROPORTION_TO_FRAME=new e,cc.ContainerStrategy.ORIGINAL_CONTAINER=new i;var n=cc.ContentStrategy.extend({apply:function(t,e){var i=cc.game.canvas.width,n=cc.game.canvas.height,r=i/e.width,o=n/e.height;return this._buildResult(i,n,i,n,r,o)}}),r=cc.ContentStrategy.extend({apply:function(t,e){var i,n,r=cc.game.canvas.width,o=cc.game.canvas.height,s=e.width,a=e.height,c=r/s,h=o/a,l=0;return c<h?(l=c,i=r,n=a*l):(l=h,i=s*l,n=o),this._buildResult(r,o,i,n,l,l)}}),o=cc.ContentStrategy.extend({apply:function(t,e){var i,n,r,o=cc.game.canvas.width,s=cc.game.canvas.height,a=e.width,c=e.height,h=o/a,l=s/c;return h<l?(i=l,n=a*i,r=s):(i=h,n=o,r=c*i),this._buildResult(o,s,n,r,i,i)}}),s=cc.ContentStrategy.extend({apply:function(t,e){var i=cc.game.canvas.width,n=cc.game.canvas.height,r=n/e.height,o=i,s=n;return this._buildResult(i,n,o,s,r,r)},postApply:function(t){cc.director._winSizeInPoints=t.getVisibleSize()}}),a=cc.ContentStrategy.extend({apply:function(t,e){var i=cc.game.canvas.width,n=cc.game.canvas.height,r=i/e.width,o=i,s=n;return this._buildResult(i,n,o,s,r,r)},postApply:function(t){cc.director._winSizeInPoints=t.getVisibleSize()}});cc.ContentStrategy.EXACT_FIT=new n,cc.ContentStrategy.SHOW_ALL=new r,cc.ContentStrategy.NO_BORDER=new o,cc.ContentStrategy.FIXED_HEIGHT=new s,cc.ContentStrategy.FIXED_WIDTH=new a})(),cc.ResolutionPolicy=cc._Class.extend({_containerStrategy:null,_contentStrategy:null,ctor:function(t,e){this.setContainerStrategy(t),this.setContentStrategy(e)},preApply:function(t){this._containerStrategy.preApply(t),this._contentStrategy.preApply(t)},apply:function(t,e){return this._containerStrategy.apply(t,e),this._contentStrategy.apply(t,e)},postApply:function(t){this._containerStrategy.postApply(t),this._contentStrategy.postApply(t)},setContainerStrategy:function(t){t instanceof cc.ContainerStrategy&&(this._containerStrategy=t)},setContentStrategy:function(t){t instanceof cc.ContentStrategy&&(this._contentStrategy=t)}}),cc.js.get(cc.ResolutionPolicy.prototype,"canvasSize",(function(){return cc.v2(cc.game.canvas.width,cc.game.canvas.height)})),cc.ResolutionPolicy.EXACT_FIT=0,cc.ResolutionPolicy.NO_BORDER=1,cc.ResolutionPolicy.SHOW_ALL=2,cc.ResolutionPolicy.FIXED_HEIGHT=3,cc.ResolutionPolicy.FIXED_WIDTH=4,cc.ResolutionPolicy.UNKNOWN=5,e.exports=o}),{}],157:[(function(t,e,i){cc.visibleRect={topLeft:cc.p(0,0),topRight:cc.p(0,0),top:cc.p(0,0),bottomLeft:cc.p(0,0),bottomRight:cc.p(0,0),bottom:cc.p(0,0),center:cc.p(0,0),left:cc.p(0,0),right:cc.p(0,0),width:0,height:0,init:function(t){var e=this.width=t.width,i=this.height=t.height,n=t.x,r=t.y,o=r+i,s=n+e;this.topLeft.x=n,this.topLeft.y=o,this.topRight.x=s,this.topRight.y=o,this.top.x=n+e/2,this.top.y=o,this.bottomLeft.x=n,this.bottomLeft.y=r,this.bottomRight.x=s,this.bottomRight.y=r,this.bottom.x=n+e/2,this.bottom.y=r,this.center.x=n+e/2,this.center.y=r+i/2,this.left.x=n,this.left.y=r+i/2,this.right.x=s,this.right.y=r+i/2}}}),{}],158:[(function(t,e,i){var n=cc.ClassManager={instanceId:0|998*Math.random(),getNewInstanceId:function(){return this.instanceId++}},r=/\b_super\b/,o=function(){};o.extend=function(t){var e,i=this.prototype,s=Object.create(i),a={writable:!0,enumerable:!1,configurable:!0};if(cc.supportJit&&cc.game&&cc.game.config&&cc.game.config[cc.game.CONFIG_KEY.exposeClassName]){var c="return (function "+(t._className||"Class")+"(arg0,arg1,arg2,arg3,arg4) {\nthis.__instanceId = cc.ClassManager.getNewInstanceId();\nif (this.ctor) {\nswitch (arguments.length) {\ncase 0: this.ctor(); break;\ncase 1: this.ctor(arg0); break;\ncase 2: this.ctor(arg0,arg1); break;\ncase 3: this.ctor(arg0,arg1,arg2); break;\ncase 4: this.ctor(arg0,arg1,arg2,arg3); break;\ncase 5: this.ctor(arg0,arg1,arg2,arg3,arg4); break;\ndefault: this.ctor.apply(this, arguments);\n}\n}\n});";e=Function(c)()}else e=function(t,e,i,r,o){if(this.__instanceId=n.getNewInstanceId(),this.ctor)switch(arguments.length){case 0:this.ctor();break;case 1:this.ctor(t);break;case 2:this.ctor(t,e);break;case 3:this.ctor(t,e,i);break;case 4:this.ctor(t,e,i,r);break;case 5:this.ctor(t,e,i,r,o);break;default:this.ctor.apply(this,arguments)}};e.prototype=s,a.value=e,Object.defineProperty(s,"constructor",a);for(var h in t){var l="function"==typeof t[h];l&&"function"==typeof i[h]&&r.test(t[h])?(a.value=(function(t,e){return function(){var n=this._super;this._super=i[t];var r=e.apply(this,arguments);return this._super=n,r}})(h,t[h]),Object.defineProperty(s,h,a)):l?(a.value=t[h],Object.defineProperty(s,h,a)):s[h]=t[h]}return e.extend=o.extend,e.implement=function(t){for(var e in t)s[e]=t[e]},e},cc.defineGetterSetter=function(t,e,i,n,r,o){if(t.__defineGetter__)i&&t.__defineGetter__(e,i),n&&t.__defineSetter__(e,n);else{if(!Object.defineProperty)throw new Error("browser does not support getters");var s={configurable:!0};i&&(s.get=i),n&&(s.set=n),Object.defineProperty(t,e,s)}},cc.clone=function(t){var e=t.constructor?new t.constructor:{};for(var i in t){var n=t[i];"object"!=typeof n||!n||n instanceof _ccsg.Node||n instanceof HTMLElement?e[i]=n:e[i]=cc.clone(n)}return e},cc._Class=e.exports=o}),{}],159:[(function(t,e,i){function n(t,e,i){var n;n=function(){},i&&h.extend(n,i.constructor);var r=new n;return h.value(t,"__attrs__",r),r}function r(t){for(var e,i=cc.Class.getInheritanceChain(t),r=i.length-1;r>=0;r--){var o=i[r];o.hasOwnProperty("__attrs__")&&o.__attrs__||n(o,o,(e=i[r+1])&&e.__attrs__)}return e=i[0],n(t,t,e&&e.__attrs__),t.__attrs__}function o(t,e,i){var r,o,a;if("function"==typeof t)o=(r=s(t)).constructor.prototype;else{var c=t;(r=c.__attrs__)||(r=n(c,t=c.constructor,s(t))),o=r}if(void 0===i){var h=e+l,u={};for(a in r)a.startsWith(h)&&(u[a.slice(h.length)]=r[a]);return u}if("object"==typeof i)for(a in i)95!==a.charCodeAt(0)&&(o[e+l+a]=i[a])}function s(t){return t.hasOwnProperty("__attrs__")&&t.__attrs__||r(t)}function a(t){return s(t).constructor.prototype}function c(t,e){}var h=t("./js"),l=(t("./utils").isPlainEmptyObj_DEV,"$_$");cc.Integer="Integer",cc.Float="Float",cc.Boolean="Boolean",cc.String="String",e.exports={attr:o,getClassAttrs:s,getClassAttrsProto:a,setClassAttr:function(t,e,i,n){a(t)[e+l+i]=n},DELIMETER:l,getTypeChecker:c,ObjectType:function(t){return{type:"Object",ctor:t,_onAfterProp:!1}},ScriptUuid:{}}}),{"./CCClass":146,"./js":167,"./utils":171}],160:[(function(t,e,i){function n(){this.callbacks=[],this.targets=[],this.isInvoking=!1,this.containCanceled=!1}function r(){this._callbackTable=o.createMap(!0)}var o=t("./js"),s=o.array.fastRemoveAt,a=n.prototype;a.removeBy=function(t,e){for(var i=this.callbacks,n=this.targets,r=0;r<t.length;++r)t[r]===e&&(s(i,r),s(n,r),--r)},a.cancel=function(t){this.callbacks[t]=this.targets[t]=null,this.containCanceled=!0},a.cancelAll=function(){for(var t=this.callbacks,e=this.targets,i=0;i<t.length;i++)t[i]=e[i]=null;this.containCanceled=!0},a.purgeCanceled=function(){this.removeBy(this.callbacks,null),this.containCanceled=!1};var c=new o.Pool(function(t){t.callbacks.length=0,t.targets.length=0,t.isInvoking=!1,t.containCanceled=!1},16);c.get=function(){return this._get()||new n},(a=r.prototype).add=function(t,e,i){var n=this._callbackTable[t];n||(n=this._callbackTable[t]=c.get()),n.callbacks.push(e),n.targets.push(i||null)},a.has=function(t,e,i){var n=this._callbackTable[t];if(!n)return!1;var r=n.callbacks;if(!e){for(var o=0;o<r.length;o++)if(r[o])return!0;return!1}i=i||null;for(var s=n.targets,a=0;a<r.length;++a)if(r[a]===e&&s[a]===i)return!0;return!1},a.removeAll=function(t){if("string"==typeof t){var e=this._callbackTable[t];e&&(e.isInvoking?e.cancelAll():(c.put(e),delete this._callbackTable[t]))}else if(t)for(var i in this._callbackTable){var n=this._callbackTable[i];if(n.isInvoking)for(var r=n.targets,o=0;o<r.length;++o)r[o]===t&&n.cancel(o);else n.removeBy(n.targets,t)}},a.remove=function(t,e,i){var n=this._callbackTable[t];if(n){i=i||null;for(var r=n.callbacks,o=n.targets,a=0;a<r.length;++a)if(r[a]===e&&o[a]===i){n.isInvoking?n.cancel(a):(s(r,a),s(o,a));break}}};var h=function(){r.call(this)};o.extend(h,r),h.prototype.invoke=function(t,e,i,n,r,o){var s=this._callbackTable[t];if(s){var a=!s.isInvoking;s.isInvoking=!0;for(var c=s.callbacks,h=s.targets,l=0,u=c.length;l<u;++l){var d=c[l];if(d){var _=h[l];_?d.call(_,e,i,n,r,o):d(e,i,n,r,o)}}a&&(s.isInvoking=!1,s.containCanceled&&s.purgeCanceled())}},h.CallbacksHandler=r,e.exports=h}),{"./js":167}],161:[(function(t,e,i){function n(t,e){for(var i=0;i<e.length;i++){var r=e[i];Array.isArray(r)?n(t,r):t.push(r)}}e.exports={flattenCodeArray:function(t){var e=[];return n(e,t),e.join("")}}}),{}],162:[(function(t,e,i){var n=t("./js"),r=(t("./CCObject"),t("./attribute")),o=t("./CCClass"),s=t("../utils/misc"),a=function(){this.uuidList=[],this.uuidObjList=[],this.uuidPropList=[],this.rawProp=""};a.prototype.reset=function(){this.uuidList.length=0,this.uuidObjList.length=0,this.uuidPropList.length=0,this.rawProp=""},a.prototype.getUuidOf=function(t,e){for(var i=0;i<this.uuidObjList.length;i++)if(this.uuidObjList[i]===t&&this.uuidPropList[i]===e)return this.uuidList[i];return""},a.prototype.push=function(t,e,i){this.uuidList.push(i),this.uuidObjList.push(t),this.uuidPropList.push(e)},(a.pool=new n.Pool(function(t){t.reset()},10)).get=function(){return this._get()||new a};var c=(function(){function t(t,e,i,n,r){this.result=t,this.customEnv=n,this.deserializedList=[],this.deserializedData=null,this._classFinder=i,this._idList=[],this._idObjList=[],this._idPropList=[]}function e(t){var e,i,n,r=t.deserializedList,o=t._idPropList,s=t._idList,a=t._idObjList;t._classFinder&&t._classFinder.onDereferenced;for(e=0;e<s.length;e++)i=o[e],n=s[e],a[e][i]=r[n]}function i(t,e,i,r,o){var s;r.hasOwnProperty("__deserialize__")?s=r.__deserialize__:(s=h(t,r),n.value(r,"__deserialize__",s,!0)),s(t,e,i,r,o)}var a=t.prototype;a.deserialize=function(t){if(Array.isArray(t)){var i=t,n=i.length;this.deserializedList.length=n;for(var r=0;r<n;r++)if(i[r]){this.deserializedList[r]=this._deserializeObject(i[r])}this.deserializedData=n>0?this.deserializedList[0]:[]}else this.deserializedList.length=1,this.deserializedData=t?this._deserializeObject(t):null,this.deserializedList[0]=this.deserializedData;return e(this),this.deserializedData},a._deserializeObject=function(t,e,r,o){var s,a=null,c=null,h=t.__type__;if(h){if(!(c=this._classFinder(h,t,r,o)))return this._classFinder===n._getClassById&&cc.deserialize.reportMissingClass(h),null;if((a=new c)._deserialize)return a._deserialize(t.content,this),a;cc.Class._isCCClass(c)?i(this,a,t,c,e):this._deserializeTypedObject(a,t,c)}else if(Array.isArray(t)){a=new Array(t.length);for(var l=0;l<t.length;l++)"object"==typeof(s=t[l])&&s?this._deserializeObjField(a,s,""+l):a[l]=s}else a={},this._deserializePrimitiveObject(a,t);return a},a._deserializeObjField=function(t,e,i,n){var r=e.__id__;if(void 0===r){var o=e.__uuid__;o?(this.result.uuidList.push(o),this.result.uuidObjList.push(t),this.result.uuidPropList.push(i)):t[i]=this._deserializeObject(e)}else{var s=this.deserializedList[r];s?t[i]=s:(this._idList.push(r),this._idObjList.push(t),this._idPropList.push(i))}},a._deserializePrimitiveObject=function(t,e){var i=this;for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];"object"!=typeof r?"__type__"!==n&&(t[n]=r):r?i._deserializeObjField(t,r,n):t[n]=null}},a._deserializeTypedObject=function(t,e,i){if(i===cc.Vec2)return t.x=e.x||0,void(t.y=e.y||0);if(i!==cc.Color){if(i===cc.Size)return t.width=e.width||0,void(t.height=e.height||0);var n=i.__props__;n||(n=Object.keys(t));for(var r=0;r<n.length;r++){var o=n[r],s=e[o];void 0!==s&&e.hasOwnProperty(o)&&("object"!=typeof s?t[o]=s:s?this._deserializeObjField(t,s,o):t[o]=null)}}else{t.r=e.r||0,t.g=e.g||0,t.b=e.b||0;var a=e.a;t.a=void 0===a?255:a}};var c=cc.supportJit?function(t,e,i,r,o){if(e instanceof cc.ValueType){o||t.push("if(prop){");var s=n.getClassName(e);t.push("s._deserializeTypedObject(o"+i+",prop,"+s+");"),o||t.push("}else o"+i+"=null;")}else t.push("if(prop){"),t.push("s._deserializeObjField(o,prop,"+r+");"),t.push("}else o"+i+"=null;")}:function(t,e,i,n,r,o,s){if(r instanceof cc.ValueType){var a=r.constructor;s?t._deserializeTypedObject(e[o],n,a):n?t._deserializeTypedObject(e[o],n,a):e[o]=null}else n?t._deserializeObjField(e,n,o):e[o]=null},h=cc.supportJit?function(t,e){for(var i=r.DELIMETER+"rawType",a=(r.DELIMETER,r.DELIMETER+"serializable"),h=r.DELIMETER+"default",l=r.DELIMETER+"saveUrlAsAsset",u=r.DELIMETER+"formerlySerializedAs",d=r.getClassAttrs(e),_=e.__props__,f=["var prop;"],p=s.BUILTIN_CLASSID_RE.test(n._getClassId(e)),g=0;g<_.length;g++){var v,m=_[g];if(d[m+i])v=o.IDENTIFIER_RE.test(m)?'"'+m+'"':o.escapeForJS(m),f.push('if(s.result.rawProp)\ncc.error("not support multi raw object in a file");'),f.push("s.result.rawProp="+v+";");else{if(!1===d[m+a])continue;var y;o.IDENTIFIER_RE.test(m)?(v='"'+m+'"',y="."+m):y="["+(v=o.escapeForJS(m))+"]";var T=y;if(d[m+u]){var C=d[m+u];T=o.IDENTIFIER_RE.test(C)?"."+C:"["+o.escapeForJS(C)+"]"}f.push("prop=d"+T+";"),f.push('if(typeof prop!=="undefined"){');var x=o.getDefault(d[m+h]);if(p){var E=typeof x;"string"===E&&!d[m+l]||"number"===E||"boolean"===E?f.push("o"+y+"=prop;"):c(f,x,y,v,!0)}else f.push('if(typeof prop!=="object"){o'+y+"=prop;}else{"),c(f,x,y,v,!1),f.push("}");f.push("}")}}return"_$erialized"===_[_.length-1]&&(f.push("o._$erialized=JSON.parse(JSON.stringify(d));"),f.push("s._deserializePrimitiveObject(o._$erialized,d);")),Function("s","o","d","k","t",f.join(""))}:function(t,e){var i=r.DELIMETER+"rawType",a=(r.DELIMETER,r.DELIMETER+"serializable"),h=r.DELIMETER+"default",l=r.DELIMETER+"saveUrlAsAsset",u=r.DELIMETER+"formerlySerializedAs",d=r.getClassAttrs(e),_=e.__props__,f=s.BUILTIN_CLASSID_RE.test(n._getClassId(e));return function(t,e,n,r,s){for(var p,g=0;g<_.length;g++){var v=_[g];if(d[v+i])t.result.rawProp&&cc.error("not support multi raw object in a file"),t.result.rawProp=v;else{if(!1===d[v+a])continue;var m=v;if(d[v+u]&&(m=d[v+u]),void 0!==(p=n[m])){var y=o.getDefault(d[v+h]);if(f){var T=typeof y;"string"===T&&!d[v+l]||"number"===T||"boolean"===T?e[v]=p:c(t,e,s,p,y,v,!0)}else"object"!=typeof p?e[v]=p:c(t,e,s,p,y,v,!1)}}}"_$erialized"===_[_.length-1]&&(e._$erialized=JSON.parse(JSON.stringify(n)),t._deserializePrimitiveObject(e._$erialized,n))}};return t.pool=new n.Pool(function(t){t.result=null,t.customEnv=null,t.deserializedList.length=0,t.deserializedData=null,t._classFinder=null,t._idList.length=0,t._idObjList.length=0,t._idPropList.length=0},1),t.pool.get=function(e,i,n,r,o){var s=this._get();return s?(s.result=e,s.customEnv=r,s._classFinder=n,s):new t(e,i,n,r,o)},t})();cc.deserialize=function(t,e,i){var r=(i=i||{}).classFinder||n._getClassById,o=i.createAssetRefs||cc.sys.platform===cc.sys.EDITOR_CORE,s=i.customEnv,h=i.ignoreEditorOnly;"string"==typeof t&&(t=JSON.parse(t));var l=!e;e=e||a.pool.get();var u=c.pool.get(e,!1,r,s,h);cc.game._isCloning=!0;var d=u.deserialize(t);return cc.game._isCloning=!1,c.pool.put(u),o&&e.assignAssetsBy(Editor.serialize.asAsset),l&&a.pool.put(e),d},cc.deserialize.Details=a,cc.deserialize.reportMissingClass=function(t){cc.warnID(5302,t)}}),{"../utils/misc":196,"./CCClass":146,"./CCObject":152,"./attribute":159,"./js":167}],163:[(function(t,e,i){function n(t){this.id=0|998*Math.random(),this.prefix=t?t+r:""}var r=".";n.prototype.getNewId=function(){return this.prefix+ ++this.id},n.global=new n("global"),e.exports=n}),{}],164:[(function(t,e,i){t("./js"),t("./CCClass"),t("./CCClassDecorator"),t("./CCEnum"),t("./CCObject"),t("./callbacks-invoker"),t("./url"),t("./deserialize"),t("./instantiate"),t("./instantiate-jit"),t("./requiring-frame"),t("./CCSys"),t("./CCMacro"),cc.sys.isBrowser&&t("./CCAssetLibrary"),t("./CCVisibleRect")}),{"./CCAssetLibrary":145,"./CCClass":146,"./CCClassDecorator":147,"./CCEnum":148,"./CCMacro":151,"./CCObject":152,"./CCSys":155,"./CCVisibleRect":157,"./callbacks-invoker":160,"./deserialize":162,"./instantiate":166,"./instantiate-jit":165,"./js":167,"./requiring-frame":169,"./url":170}],165:[(function(t,e,i){function n(t,e){this.varName=t,this.expression=e}function r(t,e){return e instanceof n?new n(e.varName,t+e.expression):t+e}function o(t,e,i){Array.isArray(i)?(i[0]=r(e,i[0]),t.push(i)):t.push(r(e,i)+";")}function s(t){this._exps=[],this._targetExp=t}function a(t,e){if("function"==typeof t)try{t=t()}catch(t){return!1}if(t===e)return!0;if(t&&e){if(t instanceof cc.ValueType&&t.equals(e))return!0;if(Array.isArray(t)&&Array.isArray(e)||t.constructor===Object&&e.constructor===Object)try{return JSON.stringify(t)===JSON.stringify(e)}catch(t){}}return!1}function c(t){return y.test(t)?"."+t:"["+T(t)+"]"}function h(t,e){this.parent=e,this.objsToClear_iN$t=[],this.codeArray=[],this.objs=[],this.funcs=[],this.funcModuleCache=f.createMap(),f.mixin(this.funcModuleCache,S),this.globalVariables=[],this.globalVariableId=0,this.localVariableId=0,this.codeArray.push(C+x+","+E+";","if(R){",x+"=R;","}else{",x+"=R=new "+this.getFuncModule(t.constructor,!0)+"();","}"),t._iN$t={globalVar:"R"},this.objsToClear_iN$t.push(t),this.enumerateObject(this.codeArray,t);var i;this.globalVariables.length>0&&(i=C+this.globalVariables.join(",")+";");var n=g.flattenCodeArray(["return (function(R){",i||[],this.codeArray,"return o;","})"]);this.result=Function("O","F",n)(this.objs,this.funcs);for(var r=0,o=this.objsToClear_iN$t.length;r<o;++r)this.objsToClear_iN$t[r]._iN$t=null;this.objsToClear_iN$t.length=0}var l=t("./CCObject"),u=l.Flags.Destroyed,d=l.Flags.PersistentMask,_=t("./attribute"),f=t("./js"),p=t("./CCClass"),g=t("./compiler"),v=_.DELIMETER+"serializable",m=_.DELIMETER+"default",y=p.IDENTIFIER_RE,T=p.escapeForJS,C="var ",x="o",E="t",S={"cc.Node":"cc.Node","cc.Sprite":"cc.Sprite","cc.Label":"cc.Label","cc.Button":"cc.Button","cc.Widget":"cc.Widget","cc.Animation":"cc.Animation","cc.ClickEvent":!1,"cc.PrefabInfo":!1};n.prototype.toString=function(){return C+this.varName+"="+this.expression+";"},s.prototype.append=function(t,e){this._exps.push([t,e])},s.prototype.writeCode=function(t){var e;if(this._exps.length>1)t.push(E+"="+this._targetExp+";"),e=E;else{if(1!==this._exps.length)return;e=this._targetExp}for(var i=0;i<this._exps.length;i++){var n=this._exps[i];o(t,e+c(n[0])+"=",n[1])}},(s.pool=new f.Pool(function(t){t._exps.length=0,t._targetExp=null},1)).get=function(t){var e=this._get()||new s;return e._targetExp=t,e};var b=h.prototype;b.getFuncModule=function(t,e){var i=f.getClassName(t);if(i){var n=this.funcModuleCache[i];if(n)return n;if(void 0===n){var r=-1!==i.indexOf(".");if(r)try{if(r=t===Function("return "+i)())return this.funcModuleCache[i]=i,i}catch(t){}}}var o=this.funcs.indexOf(t);o<0&&(o=this.funcs.length,this.funcs.push(t));var s="F["+o+"]";return e&&(s="("+s+")"),this.funcModuleCache[i]=s,s},b.getObjRef=function(t){var e=this.objs.indexOf(t);return e<0&&(e=this.objs.length,this.objs.push(t)),"O["+e+"]"},b.setValueType=function(t,e,i,n){var r=s.pool.get(n),o=e.constructor.__props__;o||(o=Object.keys(e));for(var a=0;a<o.length;a++){var c=o[a],h=i[c];if(e[c]!==h){var l=this.enumerateField(i,c,h);r.append(c,l)}}r.writeCode(t),s.pool.put(r)},b.enumerateCCClass=function(t,e,i){for(var n=i.__props__,r=_.getClassAttrs(i),o=0;o<n.length;o++){var s=n[o];if(!1!==r[s+v]){var h=e[s],l=r[s+m];if(a(l,h))continue;if("object"==typeof h&&h instanceof cc.ValueType&&((l=p.getDefault(l))&&l.constructor)===h.constructor){var u=x+c(s);this.setValueType(t,l,h,u);continue}this.setObjProp(t,e,s,h)}}},b.instantiateArray=function(t){if(0===t.length)return"[]";var e="a"+ ++this.localVariableId,i=[new n(e,"new Array("+t.length+")")];t._iN$t={globalVar:"",source:i},this.objsToClear_iN$t.push(t);for(var r=0;r<t.length;++r)o(i,e+"["+r+"]=",this.enumerateField(t,r,t[r]));return i},b.enumerateField=function(t,e,i){if("object"==typeof i&&i){var n=i._iN$t;if(n){var o=n.globalVar;if(!o){o=n.globalVar="v"+ ++this.globalVariableId,this.globalVariables.push(o);var s=n.source[0];n.source[0]=r(o+"=",s)}return o}return Array.isArray(i)?this.instantiateArray(i):this.instantiateObj(i)}return"function"==typeof i?this.getFuncModule(i):"string"==typeof i?T(i):("_objFlags"===e&&t instanceof l&&(i&=d),i)},b.setObjProp=function(t,e,i,n){o(t,x+c(i)+"=",this.enumerateField(e,i,n))},b.enumerateObject=function(t,e){var i=e.constructor;if(cc.Class._isCCClass(i))this.enumerateCCClass(t,e,i);else for(var n in e)if(e.hasOwnProperty(n)&&(95!==n.charCodeAt(0)||95!==n.charCodeAt(1)||"__type__"===n)){var r=e[n];"object"==typeof r&&r&&r===e._iN$t||this.setObjProp(t,e,n,r)}},b.instantiateObj=function(t){if(t instanceof cc.ValueType)return p.getNewValueTypeCode(t);if(t instanceof cc.Asset)return this.getObjRef(t);if(t._objFlags&u)return null;var e,i=t.constructor;if(cc.Class._isCCClass(i)){if(this.parent)if(this.parent instanceof cc.Component){if(t instanceof cc._BaseNode||t instanceof cc.Component)return this.getObjRef(t)}else if(this.parent instanceof cc._BaseNode)if(t instanceof cc._BaseNode){if(!t.isChildOf(this.parent))return this.getObjRef(t)}else if(t instanceof cc.Component&&!t.node.isChildOf(this.parent))return this.getObjRef(t);e=new n(x,"new "+this.getFuncModule(i,!0)+"()")}else if(i===Object)e=new n(x,"{}");else{if(i)return this.getObjRef(t);e=new n(x,"Object.create(null)")}var r=[e];return t._iN$t={globalVar:"",source:r},this.objsToClear_iN$t.push(t),this.enumerateObject(r,t),["(function(){",r,"return o;})();"]},e.exports={compile:function(t){return new h(t,t instanceof cc._BaseNode&&t).result},equalsToDefault:a}}),{"./CCClass":146,"./CCObject":152,"./attribute":159,"./compiler":161,"./js":167}],166:[(function(t,e,i){function n(t,e){if(!e){if("object"!=typeof t||Array.isArray(t))return null;if(!t)return null;if(!cc.isValid(t))return null}var i;if(t instanceof c){if(t._instantiate)return cc.game._isCloning=!0,i=t._instantiate(),cc.game._isCloning=!1,i;if(t instanceof cc.Asset)return null}return cc.game._isCloning=!0,i=r(t),cc.game._isCloning=!1,i}function r(t,e){if(Array.isArray(t))return null;if(d&&d(t))return null;var i;s(t,i=t._iN$t?t._iN$t:t.constructor?new(0,t.constructor):Object.create(null),e);for(var n=0,r=_.length;n<r;++n)_[n]._iN$t=null;return _.length=0,i}function o(t,e,i,n){for(var r=t.__props__,o=u.getClassAttrs(t),s=0;s<r.length;s++){var c=r[s];if(!1!==o[c+f]){var h=e[c];i[c]="object"==typeof h&&h?h._iN$t||a(h,n):h}}}function s(t,e,i){t._iN$t=e,_.push(t);var n=t.constructor;if(cc.Class._isCCClass(n))o(n,t,e,i);else for(var r in t)if(t.hasOwnProperty(r)&&(95!==r.charCodeAt(0)||95!==r.charCodeAt(1)||"__type__"===r)){var s=t[r];if("object"==typeof s&&s){if(s===e)continue;e[r]=s._iN$t||a(s,i)}else e[r]=s}t instanceof c&&(e._objFlags&=l)}function a(t,e){if(t instanceof cc.ValueType)return t.clone();if(t instanceof cc.Asset)return t;var i;if(Array.isArray(t)){var n=t.length;i=new Array(n),t._iN$t=i;for(var r=0;r<n;++r){var o=t[r];i[r]="object"==typeof o&&o?o._iN$t||a(o,e):o}return _.push(t),i}if(t._objFlags&h)return null;var c=t.constructor;if(cc.Class._isCCClass(c)){if(e)if(e instanceof cc.Component){if(t instanceof cc._BaseNode||t instanceof cc.Component)return t}else if(e instanceof cc._BaseNode)if(t instanceof cc._BaseNode){if(!t.isChildOf(e))return t}else if(t instanceof cc.Component&&!t.node.isChildOf(e))return t;i=new c}else if(c===Object)i={};else{if(c)return t;i=Object.create(null)}return s(t,i,e),i}var c=t("./CCObject"),h=c.Flags.Destroyed,l=c.Flags.PersistentMask,u=t("./attribute"),d=t("./utils").isDomNode,_=[],f=u.DELIMETER+"serializable";n._clone=r,cc.instantiate=n,e.exports=n}),{"./CCObject":152,"./attribute":159,"./utils":171}],167:[(function(t,e,i){function n(t,e){for(;t;){var i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=Object.getPrototypeOf(t)}return null}function r(t,e,i){var r=n(e,t);Object.defineProperty(i,t,r)}function o(t,e){t.splice(e,1)}function s(t,e){var i=t.indexOf(e);return i>=0&&(o(t,i),!0)}function a(t,e){"number"==typeof t&&(e=t,t=null),this.get=null,this.count=0,this._pool=new Array(e),this._cleanup=t}var c=new(t("./id-generater"))("TmpCId."),h={isNumber:function(t){return"number"==typeof t||t instanceof Number},isString:function(t){return"string"==typeof t||t instanceof String},addon:function(t){"use strict";t=t||{};for(var e=1,i=arguments.length;e<i;e++){var n=arguments[e];if(n){if("object"!=typeof n){cc.errorID(5402,n);continue}for(var o in n)o in t||r(o,n,t)}}return t},mixin:function(t){"use strict";t=t||{};for(var e=1,i=arguments.length;e<i;e++){var n=arguments[e];if(n){if("object"!=typeof n){cc.errorID(5403,n);continue}for(var o in n)r(o,n,t)}}return t},extend:function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),t},getSuper:function(t){var e=t.prototype,i=e&&Object.getPrototypeOf(e);return i&&i.constructor},clear:function(t){for(var e=Object.keys(t),i=0;i<e.length;i++)delete t[e[i]]},getPropertyDescriptor:n},l={value:void 0,enumerable:!1,writable:!1,configurable:!0};h.value=function(t,e,i,n,r){l.value=i,l.writable=n,l.enumerable=r,Object.defineProperty(t,e,l),l.value=void 0};var u={get:null,set:null,enumerable:!1};h.getset=function(t,e,i,n,r){"function"!=typeof n&&(r=n,n=void 0),u.get=i,u.set=n,u.enumerable=r,Object.defineProperty(t,e,u),u.get=null,u.set=null};var d={get:null,enumerable:!1,configurable:!1};h.get=function(t,e,i,n,r){d.get=i,d.enumerable=n,d.configurable=r,Object.defineProperty(t,e,d),d.get=null};var _={set:null,enumerable:!1,configurable:!1};h.set=function(t,e,i,n,r){_.set=i,_.enumerable=n,_.configurable=r,Object.defineProperty(t,e,_),_.set=null},h.getClassName=function(t){if("function"==typeof t){var e=t.prototype;if(e&&e.hasOwnProperty("__classname__")&&e.__classname__)return e.__classname__;var i="";if(t.name&&(i=t.name),t.toString){var n,r=t.toString();(n="["===r.charAt(0)?r.match(/\[\w+\s*(\w+)\]/):r.match(/function\s*(\w+)/))&&2===n.length&&(i=n[1])}return"Object"!==i?i:""}return t&&t.constructor?h.getClassName(t.constructor):""},(function(){function t(t,e){return function(i,n){if(n.prototype.hasOwnProperty(t)&&delete e[n.prototype[t]],h.value(n.prototype,t,i),i){var r=e[i];if(r&&r!==n){var o="A Class already exists with the same "+t+' : "'+i+'".';cc.error(o)}else e[i]=n}}}var e={},i={};h._setClassId=t("__cid__",e);var n=t("__classname__",i);h.setClassName=function(t,e){if(n(t,e),!e.prototype.hasOwnProperty("__cid__")){var i=t||c.getNewId();i&&h._setClassId(i,e)}},h.unregisterClass=function(){for(var t=0;t<arguments.length;t++){var n=arguments[t].prototype,r=n.__cid__;r&&delete e[r];var o=n.__classname__;o&&delete i[o]}},h._getClassById=function(t){return e[t]},h.getClassByName=function(t){return i[t]},h._getClassId=function(t,e){e=void 0===e||e;if("function"==typeof t&&t.prototype.hasOwnProperty("__cid__"))return t.prototype.__cid__;if(t&&t.constructor){var i=t.constructor.prototype;if(i&&i.hasOwnProperty("__cid__"))return t.__cid__}return""}})(),h.obsolete=function(t,e,i,n){function r(){return this[i]}var o=/([^.]+)$/.exec(e)[0];n?h.getset(t,o,r,(function(t){this[i]=t})):h.get(t,o,r)},h.obsoletes=function(t,e,i,n){for(var r in i){var o=i[r];h.obsolete(t,e+"."+r,o,n)}};var f=/(%d)|(%s)/,p=/%s/;h.formatStr=function(){var t=arguments.length;if(0===t)return"";var e=arguments[0];if(1===t)return""+e;if("string"==typeof e&&f.test(e))for(var i=1;i<t;++i){var n=arguments[i],r="number"==typeof n?f:p;r.test(e)?e=e.replace(r,n):e+=" "+n}else for(var o=1;o<t;++o)e+=" "+arguments[o];return e},h.shiftArguments=function(){for(var t=arguments.length-1,e=new Array(t),i=0;i<t;++i)e[i]=arguments[i+1];return e},h.createMap=function(t){var e=Object.create(null);if(t){e["."]=!0,e["/"]=!0,delete e["."],delete e["/"]}return e};var g=Array.prototype.indexOf;h.array={remove:s,fastRemove:function(t,e){var i=t.indexOf(e);i>=0&&(t[i]=t[t.length-1],--t.length)},removeAt:o,fastRemoveAt:function(t,e){var i=t.length;e<0||e>=i||(t[e]=t[i-1],t.length=i-1)},contains:function(t,e){return t.indexOf(e)>=0},verifyType:function(t,e){if(t&&t.length>0)for(var i=0;i<t.length;i++)if(!(t[i]instanceof e))return cc.logID(1300),!1;return!0},removeArray:function(t,e){for(var i=0,n=e.length;i<n;i++)s(t,e[i])},appendObjectsAt:function(t,e,i){return t.splice.apply(t,[i,0].concat(e)),t},copy:function(t){var e,i=t.length,n=new Array(i);for(e=0;e<i;e+=1)n[e]=t[e];return n},indexOf:g,MutableForwardIterator:t("../utils/mutable-forward-iterator")},a.prototype._get=function(){if(this.count>0){--this.count;var t=this._pool[this.count];return this._pool[this.count]=null,t}return null},a.prototype.put=function(t){var e=this._pool;if(this.count<e.length){if(this._cleanup&&!1===this._cleanup(t))return;e[this.count]=t,++this.count}},a.prototype.resize=function(t){t>=0&&(this._pool.length=t,this.count>t&&(this.count=t))},h.Pool=a,cc.js=h,e.exports=h}),{"../utils/mutable-forward-iterator":197,"./id-generater":163}],168:[(function(t,e,i){function n(t,e,i,n){if(!t.get&&!t.set&&t.hasOwnProperty("default")){var r="_N$"+e;t.get=function(){return this[r]},t.set=function(t){var e=this[r];this[r]=t,i.call(this,e)};var o={};n[r]=o;for(var s in a){var c=a[s];t.hasOwnProperty(s)&&(o[s]=t[s],c.canUsedInGet||delete t[s])}}}function r(t,e,i,n){Array.isArray(n)&&n.length>0&&(n=n[0]),t.type=n}function o(t,e,i,n){if(Array.isArray(e)){if(!(e.length>0))return cc.errorID(5508,i,n);if(cc.RawAsset.isRawAssetType(e[0]))return t.url=e[0],void delete t.type;t.type=e=e[0]}}function s(t,e,i,n){}var a={url:{canUsedInGet:!0},default:{},serializable:{},editorOnly:{},rawType:{}};i.getFullFormOfProperty=function(t){if(!(t&&t.constructor===Object)){if(Array.isArray(t)&&t.length>0)return{default:[],type:t,_short:!0};if("function"==typeof t){var e=t;return cc.RawAsset.isRawAssetType(e)?{default:"",url:e,_short:!0}:{default:cc.isChildClassOf(e,cc.ValueType)?new e:null,type:e,_short:!0}}return{default:t,_short:!0}}return null},i.preprocessAttrs=function(t,e,a,c){for(var h in t){var l=t[h],u=i.getFullFormOfProperty(l);if(u&&(l=t[h]=u),l){var d=l.notify;d&&n(l,h,d,t),"type"in l&&o(l,l.type,e,h),"url"in l&&r(l,0,0,l.url),"type"in l&&s(0,l.type)}}},i.validateMethodWithProps=function(t,e,i,n,r){if("function"!=typeof t&&null!==t){return!1}return!0}}),{"./CCClass":146}],169:[(function(t,e,i){var n=[];cc._RF={push:function(t,e,i){void 0===i&&(i=e,e=""),n.push({uuid:e,script:i,module:t,exports:t.exports,beh:null})},pop:function(){var t=n.pop(),e=t.module,i=e.exports;if(i===t.exports){for(var r in i)return;e.exports=i=t.cls}},peek:function(){return n[n.length-1]}}}),{}],170:[(function(t,e,i){var n={};cc.url={_rawAssets:"",_builtinRawAssets:"",normalize:function(t){return 46===t.charCodeAt(0)&&47===t.charCodeAt(1)?t=t.slice(2):47===t.charCodeAt(0)&&(t=t.slice(1)),t},raw:function(t){return(t=this.normalize(t)).startsWith("resources/")||cc.errorID(7002,t),this._rawAssets+t},builtinRaw:!1,_init:function(t){for(var e in t){var i=t[e];i=cc.path.stripSep(i)+"/",n[e]=i}this._rawAssets=n.assets,this._builtinRawAssets=n.internal}},e.exports=cc.url}),{}],171:[(function(t,e,i){e.exports={contains:function(t,e){if("function"==typeof t.contains)return t.contains(e);if("function"==typeof t.compareDocumentPosition)return!!(16&t.compareDocumentPosition(e));var i=e.parentNode;do{if(i===t)return!0;i=i.parentNode}while(null!==i);return!1},isDomNode:"object"==typeof window&&("function"==typeof Node?function(t){return t instanceof Node}:function(t){return t&&"object"==typeof t&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName}),callInNextTick:function(t,e,i){t&&setTimeout((function(){t(e,i)}),0)}}}),{}],172:[(function(t,e,i){t("./platform/js"),t("./value-types/index.js"),t("./utils/index.js"),t("./platform/CCInputManager"),t("./platform/CCInputExtension"),t("./event/index.js"),t("./platform/CCSys"),t("./platform/CCMacro"),t("./load-pipeline/index.js"),t("./textures/index.js"),t("./CCDirector"),t("./CCDirectorWebGL"),t("./CCDirectorCanvas"),t("./platform/CCSAXParser"),t("./platform/CCView"),t("./platform/CCScreen"),t("./CCScheduler"),t("./event-manager/index.js"),t("./renderer/index.js")}),{"./CCDirector":35,"./CCDirectorCanvas":36,"./CCDirectorWebGL":37,"./CCScheduler":43,"./event-manager/index.js":108,"./event/index.js":112,"./load-pipeline/index.js":133,"./platform/CCInputExtension":149,"./platform/CCInputManager":150,"./platform/CCMacro":151,"./platform/CCSAXParser":153,"./platform/CCScreen":154,"./platform/CCSys":155,"./platform/CCView":156,"./platform/js":167,"./renderer/index.js":176,"./textures/index.js":189,"./utils/index.js":195,"./value-types/index.js":209}],173:[(function(t,e,i){function n(){var t=c.pop();return t||(t=new s),t}function r(t){c.push(t)}function o(t,e){var i=t._minX<e._minX?t._minX:e._minX,n=t._minY<e._minY?t._minY:e._minY;return((t._maxX>e._maxX?t._maxX:e._maxX)-i)*((t._maxY>e._maxY?t._maxY:e._maxY)-n)}var s=function(){this._minX=0,this._minY=0,this._maxX=0,this._maxY=0,this._width=0,this._height=0,this._area=0},a=s.prototype,c=[];a.setTo=function(t,e,i,n){return this._minX=t,this._minY=e,this._maxX=i,this._maxY=n,this.updateArea(),this},a.intValues=function(){this._minX=Math.floor(this._minX),this._minY=Math.floor(this._minY),this._maxX=Math.ceil(this._maxX),this._maxY=Math.ceil(this._maxY),this.updateArea()},a.updateArea=function(){this._width=this._maxX-this._minX,this._height=this._maxY-this._minY,this._area=this._width*this._height},a.union=function(t){this.isEmpty()?this.setTo(t._minX,t._minY,t._maxX,t._maxY):(this._minX>t._minX&&(this._minX=t._minX),this._minY>t._minY&&(this._minY=t._minY),this._maxX<t._maxX&&(this._maxX=t._maxX),this._maxY<t._maxY&&(this._maxY=t._maxY),this.updateArea())},a.setEmpty=function(){this._minX=0,this._minY=0,this._maxX=0,this._maxY=0,this._width=0,this._height=0,this._area=0},a.isEmpty=function(){return this._width<=0||this._height<=0},a.intersects=function(t){if(this.isEmpty()||t.isEmpty())return!1;var e=this._minX>t._minX?this._minX:t._minX,i=this._maxX<t._maxX?this._maxX:t._maxX;return!(e>i)&&(e=this._minY>t._minY?this._minY:t._minY,i=this._maxY<t._maxY?this._maxY:t._maxY,e<=i)},a.updateRegion=function(t,e){if(0!==t.width&&0!==t.height){var i,n,r,o,s=e,a=s.a,c=s.b,h=s.c,l=s.d,u=s.tx,d=s.ty,_=t.x,f=t.y,p=_+t.width,g=f+t.height;if(1===a&&0===c&&0===h&&1===l)i=_+u-1,n=f+d-1,r=p+u+1,o=g+d+1;else{var v=a*_+h*f+u,m=c*_+l*f+d,y=a*p+h*f+u,T=c*p+l*f+d,C=a*p+h*g+u,x=c*p+l*g+d,E=a*_+h*g+u,S=c*_+l*g+d,b=0;v>y&&(b=v,v=y,y=b),C>E&&(b=C,C=E,E=b),i=(v<C?v:C)-1,r=(y>E?y:E)+1,m>T&&(b=m,m=T,T=b),x>S&&(b=x,x=S,S=b),n=(m<x?m:x)-1,o=(T>S?T:S)+1}this._minX=i,this._minY=n,this._maxX=r,this._maxY=o,this._width=r-i,this._height=o-n,this._area=this._width*this._height}else this.setEmpty()};var h=function(){this.dirtyList=[],this.hasClipRect=!1,this.clipWidth=0,this.clipHeight=0,this.clipArea=0,this.clipRectChanged=!1},l=h.prototype;l.setClipRect=function(t,e){this.hasClipRect=!0,this.clipRectChanged=!0,this.clipWidth=Math.ceil(t),this.clipHeight=Math.ceil(e),this.clipArea=this.clipWidth*this.clipHeight},l.addRegion=function(t){var e=t._minX,i=t._minY,r=t._maxX,o=t._maxY;if(this.hasClipRect&&(e<0&&(e=0),i<0&&(i=0),r>this.clipWidth&&(r=this.clipWidth),o>this.clipHeight&&(o=this.clipHeight)),e>=r||i>=o)return!1;if(this.clipRectChanged)return!0;var s=this.dirtyList,a=n();return s.push(a.setTo(e,i,r,o)),this.mergeDirtyList(s),!0},l.clear=function(){for(var t=this.dirtyList,e=t.length,i=0;i<e;i++)r(t[i]);t.length=0},l.getDirtyRegions=function(){var t=this.dirtyList;if(this.clipRectChanged){this.clipRectChanged=!1,this.clear();var e=n();t.push(e.setTo(0,0,this.clipWidth,this.clipHeight))}else for(;this.mergeDirtyList(t););var i=this.dirtyList.length;if(i>0)for(var r=0;r<i;r++)this.dirtyList[r].intValues();return this.dirtyList},l.mergeDirtyList=function(t){var e=t.length;if(e<2)return!1;for(var i=this.hasClipRect,n=e>3?Number.POSITIVE_INFINITY:0,s=0,a=0,c=0,h=0;h<e-1;h++){var l=t[h];i&&(c+=l.area);for(var u=h+1;u<e;u++){var d=t[u],_=o(l,d)-l.area-d.area;n>_&&(s=h,a=u,n=_)}}if(i&&c/this.clipArea>.95&&(this.clipRectChanged=!0),s!==a){var f=t[a];return t[s].union(f),r(f),t.splice(a,1),!0}return!1},cc.Region=s,cc.DirtyRegion=h}),{}],174:[(function(t,e,i){cc.rendererCanvas={childrenOrderDirty:!0,assignedZ:0,assignedZStep:1e-4,_transformNodePool:[],_renderCmds:[],_isCacheToCanvasOn:!1,_cacheToCanvasCmds:{},_cacheInstanceIds:[],_currentID:0,_clearColor:cc.color(),_clearFillStyle:"rgb(0, 0, 0)",_dirtyRegion:null,_allNeedDraw:!0,_enableDirtyRegion:!1,_debugDirtyRegion:!1,_dirtyRegionCountThreshold:10,init:function(){cc.sys.browserType!==cc.sys.BROWSER_TYPE_IE&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_UC||this.enableDirtyRegion(!1)},getRenderCmd:function(t){return t._createRenderCmd()},enableDirtyRegion:function(t){this._enableDirtyRegion=t},isDirtyRegionEnabled:function(){return this._enableDirtyRegion},setDirtyRegionCountThreshold:function(t){this._dirtyRegionCountThreshold=t},_collectDirtyRegion:function(){var t,e,i=this._renderCmds,n=this._dirtyRegion,r=_ccsg.Node.CanvasRenderCmd.RegionStatus,o=0,s=!0;for(t=0,e=i.length;t<e;t++){var a=i[t],c=a._regionFlag,h=a._oldRegion,l=a._currentRegion;c>r.NotDirty&&(++o>this._dirtyRegionCountThreshold&&(s=!1),s&&(!l.isEmpty()&&n.addRegion(l),a._regionFlag>r.Dirty&&!h.isEmpty()&&n.addRegion(h)),a._regionFlag=r.NotDirty)}return s},_beginDrawDirtyRegion:function(t){var e=t.getContext(),i=this._dirtyRegion.getDirtyRegions();e.save(),t.setTransform({a:1,b:0,c:0,d:1,tx:0,ty:0},1,1),e.beginPath();for(var n=0,r=0,o=0,s=0,a=t._scaleX,c=t._scaleY,h=0,l=i.length;h<l;++h){var u=i[h];n=(u._minX*a|0)-1,r=(-u._maxY*a|0)-1,o=2+(u._width*a|0),s=2+(u._height*c|0),e.rect(n,r,o,s)}e.clip()},_endDrawDirtyRegion:function(t){t.restore()},_debugDrawDirtyRegion:function(t){if(this._debugDirtyRegion){var e=t.getContext(),i=this._dirtyRegion.getDirtyRegions();t.setTransform({a:1,b:0,c:0,d:1,tx:0,ty:0},1,1),e.beginPath();for(var n=0,r=0,o=0,s=0,a=t._scaleX,c=t._scaleY,h=0,l=i.length;h<l;++h){var u=i[h];n=(u._minX*a|0)-1,r=(-u._maxY*a|0)-1,o=2+(u._width*a|0),s=2+(u._height*c|0),e.rect(n,r,o,s)}var d=e.fillStyle;e.fillStyle="green",e.fill(),e.fillStyle=d}},rendering:function(t){var e=this._dirtyRegion=this._dirtyRegion||new cc.DirtyRegion,i=cc._canvas,n=t||cc._renderContext,r=n.getContext(),o=cc.view.getScaleX(),s=cc.view.getScaleY();n.setViewScale(o,s),n.computeRealOffsetY();var a,c,h=this._dirtyRegion.getDirtyRegions(),l=this._renderCmds,u=this._allNeedDraw||!this._enableDirtyRegion;for(u||(u=u||!this._collectDirtyRegion()),u||this._beginDrawDirtyRegion(n),r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,i.width,i.height),0===this._clearColor.r&&0===this._clearColor.g&&0===this._clearColor.b||(n.setFillStyle(this._clearFillStyle),n.setGlobalAlpha(this._clearColor.a),r.fillRect(0,0,i.width,i.height)),a=0,c=l.length;a<c;a++){var d=l[a];if(d._needDraw){var _=!1,f=d._currentRegion;if(!f||u)_=!0;else for(var p=0,g=h.length;p<g;++p)if(h[p].intersects(f)){_=!0;break}_&&d.rendering(n,o,s)}}u||(this._debugDrawDirtyRegion(n),this._endDrawDirtyRegion(r)),e.clear(),this._allNeedDraw=!1},_renderingToCacheCanvas:function(t,e,i,n){t||cc.logID(7600),i=void 0===i?1:i,n=void 0===n?1:n,e=e||this._currentID;var r,o,s=this._cacheToCanvasCmds[e];for(t.computeRealOffsetY(),r=0,o=s.length;r<o;r++)s[r].rendering(t,i,n);this._removeCache(e);var a=this._cacheInstanceIds;0===a.length?this._isCacheToCanvasOn=!1:this._currentID=a[a.length-1]},_turnToCacheMode:function(t){this._isCacheToCanvasOn=!0,t=t||0,this._cacheToCanvasCmds[t]=[],-1===this._cacheInstanceIds.indexOf(t)&&this._cacheInstanceIds.push(t),this._currentID=t},_turnToNormalMode:function(){this._isCacheToCanvasOn=!1},_removeCache:function(t){t=t||this._currentID;var e=this._cacheToCanvasCmds[t];e&&(e.length=0,delete this._cacheToCanvasCmds[t]);var i=this._cacheInstanceIds;cc.js.array.remove(i,t)},resetFlag:function(){this.childrenOrderDirty=!1,this._transformNodePool.length=0},transform:function(){var t=this._transformNodePool;t.sort(this._sortNodeByLevelAsc);for(var e=0,i=t.length;e<i;e++)t[e].updateStatus();t.length=0},transformDirty:function(){return this._transformNodePool.length>0},_sortNodeByLevelAsc:function(t,e){return t._curLevel-e._curLevel},pushDirtyNode:function(t){this._transformNodePool.push(t)},clear:function(){},clearRenderCommands:function(){this._renderCmds.length=0,this._cacheInstanceIds.length=0,this._isCacheToCanvasOn=!1,this._allNeedDraw=!0},pushRenderCommand:function(t){if(t.rendering)if(this._isCacheToCanvasOn){var e=this._currentID,i=this._cacheToCanvasCmds[e];-1===i.indexOf(t)&&i.push(t)}else-1===this._renderCmds.indexOf(t)&&this._renderCmds.push(t)}},(function(){cc.CanvasContextWrapper=function(t){this._context=t,this._saveCount=0,this._currentAlpha=t.globalAlpha,this._currentCompositeOperation=t.globalCompositeOperation,this._currentFillStyle=t.fillStyle,this._currentStrokeStyle=t.strokeStyle,this._offsetX=0,this._offsetY=0,this._realOffsetY=this.height,this._armatureMode=0};var t=cc.CanvasContextWrapper.prototype;t.resetCache=function(){var t=this._context;this._currentAlpha=t.globalAlpha,this._currentCompositeOperation=t.globalCompositeOperation,this._currentFillStyle=t.fillStyle,this._currentStrokeStyle=t.strokeStyle,this._realOffsetY=this._context.canvas.height+this._offsetY},t.setOffset=function(t,e){this._offsetX=t,this._offsetY=e,this._realOffsetY=this._context.canvas.height+this._offsetY},t.computeRealOffsetY=function(){this._realOffsetY=this._context.canvas.height+this._offsetY},t.setViewScale=function(t,e){this._scaleX=t,this._scaleY=e},t.getContext=function(){return this._context},t.save=function(){this._context.save(),this._saveCount++},t.restore=function(){this._context.restore(),this._currentAlpha=this._context.globalAlpha,this._saveCount--},t.setGlobalAlpha=function(t){this._saveCount>0?this._context.globalAlpha=t:this._currentAlpha!==t&&(this._currentAlpha=t,this._context.globalAlpha=t)},t.setCompositeOperation=function(t){this._saveCount>0?this._context.globalCompositeOperation=t:this._currentCompositeOperation!==t&&(this._currentCompositeOperation=t,this._context.globalCompositeOperation=t)},t.setFillStyle=function(t){this._context.fillStyle=t},t.setStrokeStyle=function(t){this._saveCount>0?this._context.strokeStyle=t:this._currentStrokeStyle!==t&&(this._currentStrokeStyle=t,this._context.strokeStyle=t)},t.setTransform=function(t,e,i){this._armatureMode>0?(this.restore(),this.save(),this._context.transform(t.a,-t.b,-t.c,t.d,t.tx*e,-t.ty*i)):this._context.setTransform(t.a*e,-t.b*i,-t.c*e,t.d*i,this._offsetX+t.tx*e,this._realOffsetY-t.ty*i)},t._switchToArmatureMode=function(t,e,i,n){t?(this._armatureMode++,this._context.setTransform(e.a,e.c,e.b,e.d,this._offsetX+e.tx*i,this._realOffsetY-e.ty*n),this.save()):(this._armatureMode--,this.restore())}})()}),{}],175:[(function(t,e,i){function n(t){var e=cc._renderContext;if(a){var i=6*Math.ceil(t/4);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,a),v=new Uint16Array(i);for(var n=0,r=0,o=i;r<o;r+=6)v[r]=n+0,v[r+1]=n+1,v[r+2]=n+2,v[r+3]=n+1,v[r+4]=n+2,v[r+5]=n+3,n+=4;e.bufferData(e.ELEMENT_ARRAY_BUFFER,v,e.DYNAMIC_DRAW)}if(c){var s=4*(f=t*d);_=new ArrayBuffer(s),p=new Float32Array(_),g=new Uint32Array(_),e.bindBuffer(e.ARRAY_BUFFER,c),e.bufferData(e.ARRAY_BUFFER,p,e.DYNAMIC_DRAW)}h=t-200}function r(t){var e=cc._renderContext;null===a&&(c=e.createBuffer(),a=e.createBuffer()),n(t)}var o={texture:null,blendSrc:null,blendDst:null,shader:null},s=!1,a=null,c=null,h=0,l=0,u=0,d=6,_=null,f=0,p=null,g=null,v=null,m=0,y=!0,T=!1,C=cc.Enum({QUAD:0,TRIANGLE:1,CUSTOM:2});cc.rendererWebGL={mat4Identity:null,childrenOrderDirty:!0,assignedZ:0,assignedZStep:.01,VertexType:C,_transformNodePool:[],_renderCmds:[],_isCacheToBufferOn:!1,_cacheToBufferCmds:{},_cacheInstanceIds:[],_currentID:0,_clearColor:{r:0,g:0,b:0,a:1},init:function(){var t=cc._renderContext;t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),this.mat4Identity=new cc.math.Matrix4,this.mat4Identity.identity(),r(cc.macro.BATCH_VERTEX_COUNT),cc.sys.os===cc.sys.OS_IOS&&(T=!0)},getVertexSize:function(){return h},getRenderCmd:function(t){return t._createRenderCmd()},_turnToCacheMode:function(t){this._isCacheToBufferOn=!0,t=t||0,this._cacheToBufferCmds[t]?this._cacheToBufferCmds[t].length=0:this._cacheToBufferCmds[t]=[],-1===this._cacheInstanceIds.indexOf(t)&&this._cacheInstanceIds.push(t),this._currentID=t},_turnToNormalMode:function(){this._isCacheToBufferOn=!1},_removeCache:function(t){t=t||this._currentID;var e=this._cacheToBufferCmds[t];e&&(e.length=0,delete this._cacheToBufferCmds[t]);var i=this._cacheInstanceIds;cc.js.array.remove(i,t)},_renderingToBuffer:function(t){t=t||this._currentID;var e=this._cacheToBufferCmds[t],i=cc._renderContext;this.rendering(i,e),this._removeCache(t);var n=this._cacheInstanceIds;0===n.length?this._isCacheToBufferOn=!1:this._currentID=n[n.length-1]},resetFlag:function(){this.childrenOrderDirty&&(this.childrenOrderDirty=!1),this._transformNodePool.length=0},transform:function(){var t=this._transformNodePool;t.sort(this._sortNodeByLevelAsc);var e,i;for(e=0,i=t.length;e<i;e++)t[e].updateStatus();t.length=0},transformDirty:function(){return this._transformNodePool.length>0},_sortNodeByLevelAsc:function(t,e){return t._curLevel-e._curLevel},pushDirtyNode:function(t){this._transformNodePool.push(t)},clearRenderCommands:function(){this._renderCmds.length=0},clear:function(){var t=cc._renderContext;t.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)},setDepthTest:function(t){var e=cc._renderContext;t?(e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL)):e.disable(e.DEPTH_TEST)},pushRenderCommand:function(t){if(t.rendering||t.uploadData)if(this._isCacheToBufferOn){var e=this._currentID,i=this._cacheToBufferCmds[e];-1===i.indexOf(t)&&i.push(t)}else this._renderCmds.push(t)},_increaseBatchingSize:function(t,e,i){var n,r;switch(e=e||C.QUAD){case C.QUAD:for(n=0;n<t;n+=4)r=l+n,v[u++]=r+0,v[u++]=r+1,v[u++]=r+2,v[u++]=r+1,v[u++]=r+2,v[u++]=r+3;break;case C.TRIANGLE:for(y=!1,n=0;n<t;n+=3)r=l+n,v[u++]=r+0,v[u++]=r+1,v[u++]=r+2;break;case C.CUSTOM:y=!1;var o=i.length;for(n=0;n<o;n++)v[u++]=l+i[n];break;default:return}l+=t},_updateBatchedInfo:function(t,e,i){return(t!==o.texture||e.src!==o.blendSrc||e.dst!==o.blendDst||i!==o.shader)&&(this._batchRendering(),o.texture=t,o.blendSrc=e.src,o.blendDst=e.dst,o.shader=i,!0)},_breakBatch:function(){s=!0},_uploadBufferData:function(t){l>=h&&this._batchRendering();var e=t._node,i=t._texture||e._texture||e._spriteFrame&&e._spriteFrame._texture,n=e._blendFunc.src,r=e._blendFunc.dst,a=t._shaderProgram;(s||o.texture!==i||o.blendSrc!==n||o.blendDst!==r||o.shader!==a)&&(this._batchRendering(),o.texture=i,o.blendSrc=n,o.blendDst=r,o.shader=a,s=!1);var c=t.uploadData(p,g,l*d);if(c>0){var _,f;switch(t.vertexType||C.QUAD){case C.QUAD:for(_=0;_<c;_+=4)f=l+_,v[u++]=f+0,v[u++]=f+1,v[u++]=f+2,v[u++]=f+1,v[u++]=f+2,v[u++]=f+3;break;case C.TRIANGLE:for(y=!1,_=0;_<c;_+=3)f=l+_,v[u++]=f+0,v[u++]=f+1,v[u++]=f+2;break;case C.CUSTOM:y=!1,t.uploadIndexData&&(u+=t.uploadIndexData(v,u,l));break;default:return}l+=c}},_batchRendering:function(){if(0!==l&&o.texture){var t=cc._renderContext,e=o.texture,i=o.shader,n=l>.5*h;if(i&&(i.use(),i._updateProjectionUniform()),cc.gl.blendFunc(o.blendSrc,o.blendDst),cc.gl.bindTexture2DN(0,e),t.bindBuffer(t.ARRAY_BUFFER,c),n)t.bufferData(t.ARRAY_BUFFER,p,t.DYNAMIC_DRAW);else{var r=p.subarray(0,l*d);t.bufferData(t.ARRAY_BUFFER,r,t.DYNAMIC_DRAW)}t.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_POSITION),t.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_COLOR),t.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_TEX_COORDS),t.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_POSITION,3,t.FLOAT,!1,24,0),t.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_COLOR,4,t.UNSIGNED_BYTE,!0,24,12),t.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_TEX_COORDS,2,t.FLOAT,!1,24,16),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,a),(!m||!y||u>m)&&(n?t.bufferData(t.ELEMENT_ARRAY_BUFFER,v,t.DYNAMIC_DRAW):t.bufferData(t.ELEMENT_ARRAY_BUFFER,v.subarray(0,u),t.DYNAMIC_DRAW)),t.drawElements(t.TRIANGLES,u,t.UNSIGNED_SHORT,0),cc.g_NumberOfDraws++,y?m=u:(m=0,y=!0),l=0,u=0}},rendering:function(t,e){var i,n,r,s=e||this._renderCmds,a=t||cc._renderContext;for(a.bindBuffer(a.ARRAY_BUFFER,null),i=0,n=s.length;i<n;++i)(r=s[i])._needDraw&&(r.uploadData?this._uploadBufferData(r):(l>0&&this._batchRendering(),r.rendering(a)));this._batchRendering(),o.texture=null}}}),{}],176:[(function(t,e,i){t("./RendererCanvas"),t("./RendererWebGL"),t("./DirtyRegion")}),{"./DirtyRegion":173,"./RendererCanvas":174,"./RendererWebGL":175}],177:[(function(t,e,i){_ccsg.Scene=_ccsg.Node.extend({_className:"Scene",ctor:function(){_ccsg.Node.prototype.ctor.call(this),this._ignoreAnchorPointForPosition=!0,this.setAnchorPoint(.5,.5),this.setContentSize(cc.director.getWinSize())}})}),{}],178:[(function(t,e,i){var n=t("../event/event-target"),r=t("../utils/misc");_ccsg.Sprite=_ccsg.Node.extend({dirty:!1,atlasIndex:0,textureAtlas:null,_recursiveDirty:null,_shouldBeHidden:!1,_transformToBatch:null,_blendFunc:null,_texture:null,_rect:null,_rectRotated:!1,_offsetPosition:null,_unflippedOffsetPositionFromCenter:null,_opacityModifyRGB:!1,_flippedX:!1,_flippedY:!1,_textureLoaded:!1,_className:"Sprite",ctor:function(t,e,i){var r=this;_ccsg.Node.prototype.ctor.call(r),n.call(r),r._shouldBeHidden=!1,r._offsetPosition=cc.p(0,0),r._unflippedOffsetPositionFromCenter=cc.p(0,0),r._blendFunc={src:cc.macro.BLEND_SRC,dst:cc.macro.BLEND_DST},r._rect=cc.rect(0,0,0,0),r._softInit(t,e,i)},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(t,e){this.once("load",t,e)},isDirty:function(){return this.dirty},setDirty:function(t){this.dirty=t},isTextureRectRotated:function(){return this._rectRotated},getAtlasIndex:function(){return this.atlasIndex},setAtlasIndex:function(t){this.atlasIndex=t},getTextureRect:function(){return cc.rect(this._rect)},getTextureAtlas:function(){return this.textureAtlas},setTextureAtlas:function(t){this.textureAtlas=t},getOffsetPosition:function(){return cc.p(this._offsetPosition)},_getOffsetX:function(){return this._offsetPosition.x},_getOffsetY:function(){return this._offsetPosition.y},getBlendFunc:function(){return this._blendFunc},initWithSpriteFrame:function(t){cc.assertID(t,2606),t.textureLoaded()||(this._textureLoaded=!1,t.once("load",this._renderCmd._spriteFrameLoadedCallback,this._renderCmd));var e=cc._renderType!==cc.game.RENDER_TYPE_CANVAS&&t._rotated,i=this.initWithTexture(t.getTexture(),t.getRect(),e);return this.setSpriteFrame(t),i},initWithSpriteFrameName:function(){cc.warnID(2608)},useBatchNode:function(t){this.textureAtlas=t.getTextureAtlas(),this._batchNode=t},setVertexRect:function(t){var e=this._rect;e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height},setFlippedX:function(t){this._flippedX!==t&&(this._flippedX=t,this.setTextureRect(this._rect,this._rectRotated,this._contentSize),this.setNodeDirty(!0))},setFlippedY:function(t){this._flippedY!==t&&(this._flippedY=t,this.setTextureRect(this._rect,this._rectRotated,this._contentSize),this.setNodeDirty(!0))},isFlippedX:function(){return this._flippedX},isFlippedY:function(){return this._flippedY},setOpacityModifyRGB:function(t){this._opacityModifyRGB!==t&&(this._opacityModifyRGB=t,this._renderCmd._setColorDirty())},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setDisplayFrameWithAnimationName:function(t,e){cc.assertID(t,2610);var i=cc.spriteFrameAnimationCache.getAnimation(t);if(i){var n=i.getFrames()[e];n?this.setSpriteFrame(n.getSpriteFrame()):cc.logID(2603)}else cc.logID(2602)},getTexture:function(){return this._texture},_softInit:function(t,e,i){if(void 0===t)_ccsg.Sprite.prototype.init.call(this);else if(cc.js.isString(t))"#"===t[0]?cc.logID(2728,t):_ccsg.Sprite.prototype.init.call(this,t,e);else if("object"==typeof t)if(t instanceof cc.Texture2D)this.initWithTexture(t,e,i);else if(t instanceof cc.SpriteFrame)this.initWithSpriteFrame(t);else if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement){var n=new cc.Texture2D;n.initWithElement(t),n.handleLoadedTexture(),this.initWithTexture(n)}},getQuad:function(){return null},setBlendFunc:function(t,e){var i=this._blendFunc;void 0===e?(i.src=t.src,i.dst=t.dst):(i.src=t,i.dst=e),this._renderCmd.updateBlendFunc(i)},init:function(){var t=this;return arguments.length>0?t.initWithFile(arguments[0],arguments[1]):(t.dirty=t._recursiveDirty=!1,t._blendFunc.src=cc.macro.BLEND_SRC,t._blendFunc.dst=cc.macro.BLEND_DST,t.texture=null,t._flippedX=t._flippedY=!1,t.anchorX=.5,t.anchorY=.5,t._offsetPosition.x=0,t._offsetPosition.y=0,t.setTextureRect(cc.rect(0,0,0,0),!1,cc.size(0,0)),!0)},initWithFile:function(t,e){cc.assertID(t,2609);var i=cc.textureCache.getTextureForKey(t);if(i){if(!e){var n=i.getContentSize();e=cc.rect(0,0,n.width,n.height)}return this.initWithTexture(i,e)}return i=cc.textureCache.addImage(t),this.initWithTexture(i,e||cc.rect(0,0,i._contentSize.width,i._contentSize.height))},initWithTexture:function(t,e,i,n){var r=this;cc.assertID(0!==arguments.length,2710),i=i||!1,t=this._renderCmd._handleTextureForRotatedTexture(t,e,i,n),r._recursiveDirty=!1,r.dirty=!1,r._opacityModifyRGB=!0,r._blendFunc.src=cc.macro.BLEND_SRC,r._blendFunc.dst=cc.macro.BLEND_DST,r._flippedX=r._flippedY=!1,r.setAnchorPoint(.5,.5),r._offsetPosition.x=0,r._offsetPosition.y=0;var o=t.isLoaded();return r._textureLoaded=o,o?(e||(e=cc.rect(0,0,t.width,t.height)),this._renderCmd._checkTextureBoundary(t,e,i),r.setTexture(t),r.setTextureRect(e,i),this.emit("load"),!0):(r._rectRotated=i,e&&(r._rect.x=e.x,r._rect.y=e.y,r._rect.width=e.width,r._rect.height=e.height),r.texture&&r.texture.off("load",r._renderCmd._textureLoadedCallback,r._renderCmd),t.once("load",r._renderCmd._textureLoadedCallback,r._renderCmd),r.setTexture(t),!0)},setTextureRect:function(t,e,i,n){var r=this;r._rectRotated=e||!1,r.setContentSize(i||t),r.setVertexRect(t),r._renderCmd._setTextureCoords(t,n);var o=r._unflippedOffsetPositionFromCenter.x,s=r._unflippedOffsetPositionFromCenter.y;r._flippedX&&(o=-o),r._flippedY&&(s=-s);var a=r._rect;r._offsetPosition.x=o+(r._contentSize.width-a.width)/2,r._offsetPosition.y=s+(r._contentSize.height-a.height)/2},setSpriteFrame:function(t){var e=this;cc.assertID(t,2712),this.setNodeDirty(!0);var i=t.getOffset();e._unflippedOffsetPositionFromCenter.x=i.x,e._unflippedOffsetPositionFromCenter.y=i.y;var n=t.getTexture();t.textureLoaded()?(e._textureLoaded=!0,n!==e._texture&&(e._setTexture(n),e.setColor(e._realColor)),e.setTextureRect(t.getRect(),t.isRotated(),t.getOriginalSize())):(e._textureLoaded=!1,t.once("load",(function(t){var i=t.currentTarget;e._textureLoaded=!0;var n=i.getTexture();n!==e._texture&&e._setTexture(n),e.setTextureRect(i.getRect(),i.isRotated(),i.getOriginalSize()),e.emit("load"),e.setColor(e._realColor)}),e)),this._renderCmd._updateForSetSpriteFrame(n)},setDisplayFrame:function(t){cc.logID(2604),this.setSpriteFrame(t)},isFrameDisplayed:function(t){return this._renderCmd.isFrameDisplayed(t)},displayFrame:function(){return this.getSpriteFrame()},getSpriteFrame:function(){return new cc.SpriteFrame(this._texture,this._rect,this._rectRotated,this._unflippedOffsetPositionFromCenter,this._contentSize)},setTexture:function(t){if(!t)return this._renderCmd._setTexture(null);var e=cc.js.isString(t);e&&(t=cc.textureCache.addImage(t)),t._textureLoaded?(this._setTexture(t,e),this.setColor(this._realColor),this._textureLoaded=!0,this.emit("load")):(this._renderCmd._setTexture(t),t.once("load",(function(i){this._setTexture(t,e),this.setColor(this._realColor),this._textureLoaded=!0,this.emit("load")}),this))},_setTexture:function(t,e){this._renderCmd._setTexture(t),e&&this._changeRectWithTexture(t)},_changeRectWithTexture:function(t){var e=t._contentSize,i=cc.rect(0,0,e.width,e.height);this.setTextureRect(i)},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new _ccsg.Sprite.CanvasRenderCmd(this):new _ccsg.Sprite.WebGLRenderCmd(this)}}),cc.js.addon(_ccsg.Sprite.prototype,n.prototype);var o=["opacity","color","texture","quad"],s={opacityModifyRGB:["isOpacityModifyRGB","setOpacityModifyRGB"],flippedX:["isFlippedX","setFlippedX"],flippedY:["isFlippedY","setFlippedY"],offsetX:["_getOffsetX"],offsetY:["_getOffsetY"],textureRectRotated:["isTextureRectRotated"]};r.propertyDefine(_ccsg.Sprite,o,s)}),{"../event/event-target":110,"../utils/misc":196}],179:[(function(t,e,i){_ccsg.Sprite.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._textureCoord={renderX:0,renderY:0,x:0,y:0,width:0,height:0,validRect:!1},this._blendFuncStr="source-over",this._colorized=!1,this._textureToRender=null};var n=_ccsg.Sprite.CanvasRenderCmd.prototype=Object.create(_ccsg.Node.CanvasRenderCmd.prototype);n.constructor=_ccsg.Sprite.CanvasRenderCmd,n.setDirtyRecursively=function(t){},n._setTexture=function(t){var e=this._node;if(e._texture!==t){e._textureLoaded=!!t&&t._textureLoaded,e._texture=t;var i=t._contentSize,n=cc.rect(0,0,i.width,i.height);e.setTextureRect(n),this._updateColor()}},n._setColorDirty=function(){this.setDirtyFlag(_ccsg.Node._dirtyFlags.colorDirty|_ccsg.Node._dirtyFlags.opacityDirty)},n.isFrameDisplayed=function(t){var e=this._node;return t.getTexture()===e._texture&&cc.rectEqualToRect(t.getRect(),e._rect)},n.updateBlendFunc=function(t){this._blendFuncStr=_ccsg.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(t)},n._handleTextureForRotatedTexture=function(t,e,i,n){if(i&&t.isLoaded()){var r=t.getHtmlElementObj();r=_ccsg.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(r,e,n);var o=new cc.Texture2D;o.initWithElement(r),o.handleLoadedTexture(),t=o,e.x=e.y=0,this._node._rect=cc.rect(0,0,e.width,e.height)}return t},n._checkTextureBoundary=function(t,e,i){if(t&&t.url){var n=e.x+e.width,r=e.y+e.height;n>t.width&&cc.errorID(3300,t.url),r>t.height&&cc.errorID(3400,t.url)}},n.rendering=function(t,e,i){var n=this._node,r=this._textureCoord,o=this._displayedOpacity/255,s=this._textureToRender||n._texture;if((!s||0!==r.width&&0!==r.height&&s._textureLoaded)&&0!==o){var a,c=t||cc._renderContext,h=c.getContext(),l=n._offsetPosition.x,u=n._rect.height,d=n._rect.width,_=-n._offsetPosition.y-u;c.setTransform(this._worldTransform,e,i),c.setCompositeOperation(this._blendFuncStr),c.setGlobalAlpha(o),(n._flippedX||n._flippedY)&&c.save(),n._flippedX&&(l=-l-d,h.scale(-1,1)),n._flippedY&&(_=n._offsetPosition.y,h.scale(1,-1));var f,p,g,v,m,y,T,C;if(this._colorized?(f=0,p=0):(f=r.renderX,p=r.renderY),g=r.width,v=r.height,m=l,y=_,T=d,C=u,s&&s._htmlElementObj)a=s._htmlElementObj,""!==s._pattern?(c.setFillStyle(h.createPattern(a,s._pattern)),h.fillRect(m,y,T,C)):h.drawImage(a,f,p,g,v,m,y,T,C);else{var x=n._contentSize;if(r.validRect){var E=this._displayedColor;c.setFillStyle("rgba("+E.r+","+E.g+","+E.b+",1)"),h.fillRect(m,y,x.width,x.height)}}(n._flippedX||n._flippedY)&&c.restore(),cc.g_NumberOfDraws++}},n._updateColor=function(){var t=this._node._texture,e=this._textureCoord,i=this._displayedColor;t&&(255!==i.r||255!==i.g||255!==i.b?(this._textureToRender=t._generateColorTexture(i.r,i.g,i.b,e),this._colorized=!0):t&&(this._textureToRender=t,this._colorized=!1))},n._updateForSetSpriteFrame=function(t,e){if(this._colorized=!1,this._textureCoord.renderX=this._textureCoord.x,this._textureCoord.renderY=this._textureCoord.y,e=e||t._textureLoaded){var i=this._node.getColor();255===i.r&&255===i.g&&255===i.b||this._updateColor()}},n._spriteFrameLoadedCallback=function(t){var e=this._node,i=t.currentTarget;e.setTextureRect(i.getRect(),i.isRotated(),i.getOriginalSize()),this._updateColor(),e.emit("load")},n._textureLoadedCallback=function(t){var e=this._node,i=t.currentTarget;if(!e._textureLoaded){e._textureLoaded=!0;var n=e._rect;n?cc._rectEqualToZero(n)&&(n.width=i.width,n.height=i.height):n=cc.rect(0,0,i.width,i.height),e.texture=i,e.setTextureRect(n,e._rectRotated);var r=this._displayedColor;255===r.r&&255===r.g&&255===r.b||this._updateColor(),e.emit("load")}},n._setTextureCoords=function(t){var e=this._textureCoord;e.renderX=e.x=0|t.x,e.renderY=e.y=0|t.y,e.width=0|t.width,e.height=0|t.height,e.validRect=!(0===e.width||0===e.height||e.x<0||e.y<0)},_ccsg.Sprite.CanvasRenderCmd._cutRotateImageToCanvas=function(t,e,i){if(!t)return null;if(!e)return t;i=null==i||i;var n=document.createElement("canvas");n.width=e.width,n.height=e.height;var r=n.getContext("2d");return r.translate(n.width/2,n.height/2),i?r.rotate(-1.5707963267948966):r.rotate(1.5707963267948966),r.drawImage(t,e.x,e.y,e.height,e.width,-e.height/2,-e.width/2,e.height,e.width),n}}),{}],180:[(function(t,e,i){var n=cc.macro;_ccsg.Sprite.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._vertices=[{x:0,y:0,u:0,v:0},{x:0,y:0,u:0,v:0},{x:0,y:0,u:0,v:0},{x:0,y:0,u:0,v:0}],this._dirty=!1,this._recursiveDirty=!1,this._shaderProgram=cc.shaderCache.programForKey(n.SHADER_SPRITE_POSITION_TEXTURECOLOR)};var r=_ccsg.Sprite.WebGLRenderCmd.prototype=Object.create(_ccsg.Node.WebGLRenderCmd.prototype);r.constructor=_ccsg.Sprite.WebGLRenderCmd,r.updateBlendFunc=function(t){},r.setDirtyFlag=function(t){_ccsg.Node.WebGLRenderCmd.prototype.setDirtyFlag.call(this,t),this._dirty=!0},r.setDirtyRecursively=function(t){this._recursiveDirty=t,this._dirty=t;for(var e,i=this._node._children,n=i?i.length:0,r=0;r<n;r++)(e=i[r])instanceof _ccsg.Sprite&&e._renderCmd.setDirtyRecursively(t)},r._handleTextureForRotatedTexture=function(t){return t},r.isFrameDisplayed=function(t){var e=this._node;return cc.rectEqualToRect(t.getRect(),e._rect)&&t.getTexture().getName()===e._texture.getName()&&cc.pointEqualToPoint(t.getOffset(),e._unflippedOffsetPositionFromCenter)},r._updateForSetSpriteFrame=function(){},r._spriteFrameLoadedCallback=function(t){var e=t.currentTarget;this._node.setTextureRect(e.getRect(),e.isRotated(),e.getOriginalSize()),this._node.emit("load")},r._textureLoadedCallback=function(t){var e=this._node,i=t.currentTarget;if(!e._textureLoaded){e._textureLoaded=!0;var n=e._rect;n?cc._rectEqualToZero(n)&&(n.width=i.width,n.height=i.height):n=cc.rect(0,0,i.width,i.height),e.texture=i,e.setTextureRect(n,e._rectRotated),e.emit("load"),cc.renderer.childrenOrderDirty=!0}},r._setTextureCoords=function(t){var e=this._node,i=e._texture,r=this._vertices;if(i){var o,s,a,c,h,l=i.pixelWidth,u=i.pixelHeight;e._rectRotated?(n.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(s=(o=(2*t.x+1)/(2*l))+(2*t.height-2)/(2*l),c=(a=(2*t.y+1)/(2*u))+(2*t.width-2)/(2*u)):(o=t.x/l,s=(t.x+t.height)/l,a=t.y/u,c=(t.y+t.width)/u),e._flippedX&&(h=a,a=c,c=h),e._flippedY&&(h=o,o=s,s=h),r[0].u=s,r[0].v=a,r[1].u=o,r[1].v=a,r[2].u=s,r[2].v=c,r[3].u=o,r[3].v=c):(n.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(s=(o=(2*t.x+1)/(2*l))+(2*t.width-2)/(2*l),c=(a=(2*t.y+1)/(2*u))+(2*t.height-2)/(2*u)):(o=t.x/l,s=(t.x+t.width)/l,a=t.y/u,c=(t.y+t.height)/u),e._flippedX&&(h=o,o=s,s=h),e._flippedY&&(h=a,a=c,c=h),r[0].u=o,r[0].v=a,r[1].u=o,r[1].v=c,r[2].u=s,r[2].v=a,r[3].u=s,r[3].v=c)}},r._setColorDirty=function(){},r._updateBlendFunc=function(){var t=this._node;t._texture&&t._texture.hasPremultipliedAlpha()?(t._blendFunc.src=n.BLEND_SRC,t._blendFunc.dst=n.BLEND_DST,t.opacityModifyRGB=!0):(t._blendFunc.src=n.SRC_ALPHA,t._blendFunc.dst=n.ONE_MINUS_SRC_ALPHA,t.opacityModifyRGB=!1)},r._setTexture=function(t){var e=this._node;e._texture!==t&&(e._textureLoaded=!!t&&t._textureLoaded,e._texture=t,this._updateBlendFunc(),e._textureLoaded&&(cc.renderer.childrenOrderDirty=!0))},r._checkTextureBoundary=function(t,e,i){if(t&&t.url){var n,r;i?(n=e.x+e.height,r=e.y+e.width):(n=e.x+e.width,r=e.y+e.height),n>t.width&&cc.errorID(3300,t.url),r>t.height&&cc.errorID(3400,t.url)}},r.transform=function(t,e){this.originTransform(t,e);var i=this._node,n=i._offsetPosition.x,r=n+i._rect.width,o=i._offsetPosition.y,s=o+i._rect.height,a=this._worldTransform,c=this._vertices;c[0].x=n*a.a+s*a.c+a.tx,c[0].y=n*a.b+s*a.d+a.ty,c[1].x=n*a.a+o*a.c+a.tx,c[1].y=n*a.b+o*a.d+a.ty,c[2].x=r*a.a+s*a.c+a.tx,c[2].y=r*a.b+s*a.d+a.ty,c[3].x=r*a.a+o*a.c+a.tx,c[3].y=r*a.b+o*a.d+a.ty},r.needDraw=function(){var t=this._node._texture;return this._needDraw&&t},r.uploadData=function(t,e,i){var n=this._node,r=n._texture;if(!(r&&r._textureLoaded&&n._rect.width&&n._rect.height&&this._displayedOpacity))return 0;var o,s=this._displayedOpacity,a=this._displayedColor._val;if(n._opacityModifyRGB){var c=s/255,h=this._displayedColor.r*c,l=this._displayedColor.g*c;o=(s<<24>>>0)+(this._displayedColor.b*c<<16)+(l<<8)+h}else o=(s<<24>>>0)+((65280&a)<<8)+((16711680&a)>>8)+(a>>>24);var u,d,_=n._vertexZ,f=this._vertices,p=f.length,g=i;for(u=0;u<p;++u)d=f[u],t[g]=d.x,t[g+1]=d.y,t[g+2]=_,e[g+3]=o,t[g+4]=d.u,t[g+5]=d.v,g+=6;return p}}),{}],181:[(function(t,e,i){function n(t,e){return t-e}var r,o=t("../event/event-target"),s={_pool:{},_lengths:[],put:function(t){var e=t.length;this._pool[e]?this._pool[e].push(t):(this._pool[e]=[t],this._lengths.push(e),this._lengths.sort(n))},get:function(t){for(var e,i=0;i<this._lengths.length;i++)if(this._lengths[i]>=t){e=this._lengths[i];break}return e?this._pool[e].pop():void 0}},a=cc.macro,c={_rebuildQuads_base:function(t){var e,i,n,o,a=t._spriteFrame,c=t._contentSize,h=t._isTrimmedContentSize,l=t._vertices,u=t._corner;if(h)e=0,i=0,n=c.width,o=c.height;else{var d=a._originalSize,_=a._rect,f=a._offset,p=c.width,g=c.height,v=d.width,m=d.height,y=_.width,T=_.height,C=p/v,x=g/m,E=f.x+(v-y)/2,S=f.x-(v-y)/2;e=E*C,i=(f.y+(m-T)/2)*x,n=p+S*C,o=g+(f.y-(m-T)/2)*x}if(l.length<8&&(s.put(l),l=s.get(8)||new Float32Array(8),t._vertices=l),r){var b=t._renderCmd._worldTransform,A=b.a,R=b.b,I=b.c,w=b.d,O=b.tx,L=b.ty,P=e*A,D=e*R,N=n*A,F=n*R,M=o*I+O,B=o*w+L,z=i*I+O,V=i*w+L;l[0]=P+z,l[1]=D+V,l[2]=N+z,l[3]=F+V,l[4]=P+M,l[5]=D+B,l[6]=N+M,l[7]=F+B}else l[0]=e,l[1]=i,l[2]=n,l[3]=i,l[4]=e,l[5]=o,l[6]=n,l[7]=o;u[0]=0,u[1]=2,u[2]=4,u[3]=6,t._uvsDirty&&this._calculateUVs(t,a),t._vertCount=4},_calculateUVs:function(t,e){var i=t._uvs,n=e._texture._pixelWidth,r=e._texture._pixelHeight,o=e._rect;i.length<8&&(s.put(i),i=s.get(8)||new Float32Array(8),t._uvs=i);var c,h,l,u,d=a.FIX_ARTIFACTS_BY_STRECHING_TEXEL?.5:0;e._rotated?(c=(o.x+d)/n,h=(o.y+o.width-d)/r,l=(o.x+o.height-d)/n,u=(o.y+d)/r,i[0]=c,i[1]=u,i[2]=c,i[3]=h,i[4]=l,i[5]=u,i[6]=l,i[7]=h):(c=(o.x+d)/n,h=(o.y+o.height-d)/r,l=(o.x+o.width-d)/n,u=(o.y+d)/r,i[0]=c,i[1]=h,i[2]=l,i[3]=h,i[4]=c,i[5]=u,i[6]=l,i[7]=u)}},h={x:new Array(4),y:new Array(4),_rebuildQuads_base:function(t){var e,i,n,o,a=t._spriteFrame,c=t._contentSize,h=t._insetLeft,l=t._insetRight,u=t._insetTop,d=t._insetBottom,_=t._vertices,f=t._renderCmd._worldTransform,p=a._rect,g=t._corner;e=h,i=l,p.width,n=u,o=d,p.height;var v=c,m=v.width-e-i,y=v.height-n-o,T=v.width/(e+i),C=v.height/(n+o);T=isNaN(T)||T>1?1:T,C=isNaN(C)||C>1?1:C,m=m<0?0:m,y=y<0?0:y;var x=this.x,E=this.y;x[0]=0,x[1]=e*T,x[2]=x[1]+m,x[3]=v.width,E[0]=0,E[1]=o*C,E[2]=E[1]+y,E[3]=v.height,_.length<32&&(s.put(_),_=s.get(32)||new Float32Array(32),t._vertices=_);var S,b,A=0;if(r)for(S=0;S<4;S++)for(b=0;b<4;b++)_[A]=x[b]*f.a+E[S]*f.c+f.tx,_[A+1]=x[b]*f.b+E[S]*f.d+f.ty,A+=2;else for(S=0;S<4;S++)for(b=0;b<4;b++)_[A]=x[b],_[A+1]=E[S],A+=2;g[0]=0,g[1]=6,g[2]=24,g[3]=30,t._uvsDirty&&this._calculateUVs(t,a,h,l,u,d)},_calculateUVs:function(t,e,i,n,r,o){var c,h,l,u,d,_,f=t._uvs,p=e._rect,g=e._texture._pixelWidth,v=e._texture._pixelHeight,m=e._rect;c=i,l=n,h=p.width-c-l,u=r,_=o,d=p.height-u-_,f.length<32&&(s.put(f),f=s.get(32)||new Float32Array(32),t._uvs=f);var y,T,C=this.x,x=this.y,E=a.FIX_ARTIFACTS_BY_STRECHING_TEXEL?.5:0,S=0;if(e._rotated)for(C[0]=(m.x+E)/g,C[1]=(_+m.x)/g,C[2]=(_+d+m.x)/g,C[3]=(m.x+m.height-E)/g,x[3]=(m.y+E)/v,x[2]=(c+m.y)/v,x[1]=(c+h+m.y)/v,x[0]=(m.y+m.width-E)/v,y=0;y<4;y++)for(T=0;T<4;T++)f[S]=C[y],f[S+1]=x[3-T],S+=2;else for(C[0]=(m.x+E)/g,C[1]=(c+m.x)/g,C[2]=(c+h+m.x)/g,C[3]=(m.x+m.width-E)/g,x[3]=(m.y+E)/v,x[2]=(u+m.y)/v,x[1]=(u+d+m.y)/v,x[0]=(m.y+m.height-E)/v,y=0;y<4;y++)for(T=0;T<4;T++)f[S]=C[T],f[S+1]=x[y],S+=2}},l={_rebuildQuads_base:function(t,e,i){var n,o,c,h,e=t._spriteFrame,i=t._contentSize,l=t._vertices,u=t._corner,d=t._renderCmd._worldTransform,_=t._uvs,f=e._texture._pixelWidth,p=e._texture._pixelHeight,g=e._rect,v=a.FIX_ARTIFACTS_BY_STRECHING_TEXEL?.5:0;e._rotated?(n=(g.x+v)/f,c=(g.x+g.height-v)/f,o=(g.y+g.width-v)/p,h=(g.y+v)/p):(n=(g.x+v)/f,c=(g.x+g.width-v)/f,o=(g.y+g.height-v)/p,h=(g.y+v)/p);var m=g.width,y=g.height,T=i.width/m,C=i.height/y,x=Math.ceil(C),E=Math.ceil(T);x*E>16384&&cc.errorID(2625);var S=x*E*4*2;l.length<S&&(s.put(l),l=s.get(S)||new Float32Array(S),t._vertices=l),_.length<S&&(s.put(_),_=s.get(S)||new Float32Array(S),t._uvs=_);var b,A,R,I,w=0;t._vertCount=0;for(var O=0;O<x;++O)for(var L=0;L<E;++L){if(b=m*L,A=y*O,R=m*Math.min(L+1,T),I=y*Math.min(O+1,C),r){var P=b*d.a,D=b*d.b,N=R*d.a,F=R*d.b,M=I*d.c+d.tx,B=I*d.d+d.ty,z=A*d.c+d.tx,V=A*d.d+d.ty;l[w]=P+z,l[w+1]=D+V,l[w+2]=N+z,l[w+3]=F+V,l[w+4]=P+M,l[w+5]=D+B,l[w+6]=N+M,l[w+7]=F+B}else l[w]=b,l[w+1]=A,l[w+2]=R,l[w+3]=A,l[w+4]=b,l[w+5]=I,l[w+6]=R,l[w+7]=I;if(e._rotated?(_[w]=n,_[w+1]=h,_[w+2]=n,_[w+3]=I=h+(o-h)*Math.min(1,T-L),_[w+4]=R=n+(c-n)*Math.min(1,C-O),_[w+5]=h,_[w+6]=R,_[w+7]=I):(_[w]=n,_[w+1]=o,_[w+2]=R=n+(c-n)*Math.min(1,T-L),_[w+3]=o,_[w+4]=n,_[w+5]=I=o+(h-o)*Math.min(1,C-O),_[w+6]=R,_[w+7]=I),w+=8,t._vertCount+=4,w>S)return}u[0]=0,u[1]=8*(E-1)+2,u[2]=(x-1)*E*8+4,u[3]=S-2}},u={_rebuildQuads_base:function(t){var e=t._spriteFrame,i=t._contentSize,n=t._fillStart,o=t._fillRange;o<0&&(n+=o,o=-o),o=n+o,n=(n=n>1?1:n)<0?0:n,o=(o=o>1?1:o)<0?0:o,o-=n;var c,h,l,u,d,_=t._fillType,f=t._vertices,p=t._corner,v=t._renderCmd._worldTransform,m=t._uvs,y=0,T=0,C=i.width,x=i.height,E=e._texture._pixelWidth,S=e._texture._pixelHeight,b=e._rect,A=a.FIX_ARTIFACTS_BY_STRECHING_TEXEL?.5:0;e._rotated?(h=(b.x+A)/E,l=(b.y+b.width-A)/S,u=(b.x+b.height-A)/E,d=(b.y+A)/S):(h=(b.x+A)/E,l=(b.y+b.height-A)/S,u=(b.x+b.width-A)/E,d=(b.y+A)/S),f.length<8&&(s.put(f),f=s.get(8)||new Float32Array(8),t._vertices=f),m.length<8&&(s.put(m),m=s.get(8)||new Float32Array(8),t._uvs=m);var R=new Array(8);e._rotated?(R[0]=R[2]=h,R[4]=R[6]=u,R[3]=R[7]=l,R[1]=R[5]=d):(R[0]=R[4]=h,R[2]=R[6]=u,R[1]=R[3]=l,R[5]=R[7]=d),c=(c=(n=(n=n>1?1:n)<0?0:n)+(o=o<0?0:o))>1?1:c;var I;switch(_){case g.HORIZONTAL:I=y+(C-y)*c,y=y+(C-y)*n,C=I,m[0]=R[0]+(R[2]-R[0])*n,m[1]=R[1],m[2]=R[0]+(R[2]-R[0])*c,m[3]=R[3],m[4]=R[4]+(R[6]-R[4])*n,m[5]=R[5],m[6]=R[4]+(R[6]-R[4])*c,m[7]=R[7];break;case g.VERTICAL:I=T+(x-T)*c,T=T+(x-T)*n,x=I,m[0]=R[0],m[1]=R[1]+(R[5]-R[1])*n,m[2]=R[2],m[3]=R[3]+(R[7]-R[3])*n,m[4]=R[4],m[5]=R[1]+(R[5]-R[1])*c,m[6]=R[6],m[7]=R[3]+(R[7]-R[3])*c;break;default:cc.errorID(2626)}if(r){var w=y*v.a,O=y*v.b,L=C*v.a,P=C*v.b,D=x*v.c+v.tx,N=x*v.d+v.ty,F=T*v.c+v.tx,M=T*v.d+v.ty;f[0]=w+F,f[1]=O+M,f[2]=L+F,f[3]=P+M,f[4]=w+D,f[5]=O+N,f[6]=L+D,f[7]=P+N}else f[0]=y,f[1]=T,f[2]=C,f[3]=T,f[4]=y,f[5]=x,f[6]=C,f[7]=x;t._vertCount=4,p[0]=0,p[1]=2,p[2]=4,p[3]=6}},d={_vertPos:[cc.v2(0,0),cc.v2(0,0),cc.v2(0,0),cc.v2(0,0)],_vertices:[cc.v2(0,0),cc.v2(0,0)],_uvs:[cc.v2(0,0),cc.v2(0,0)],_intersectPoint_1:[cc.v2(0,0),cc.v2(0,0),cc.v2(0,0),cc.v2(0,0)],_intersectPoint_2:[cc.v2(0,0),cc.v2(0,0),cc.v2(0,0),cc.v2(0,0)],outVerts:null,outUvs:null,rawVerts:null,rawUvs:null,_rebuildQuads_base:function(t){var e=t._spriteFrame,i=t._contentSize,n=t._fillStart,r=t._fillRange;r<0&&(n+=r,r=-r),t._isTriangle=!0,t._rawVerts||(t._rawVerts=s.get(8)||new Float32Array(8),t._rawUvs=s.get(8)||new Float32Array(8));for(var o=t._fillCenter,a=t._vertices,c=t._corner,h=t._uvs,l=t._rawVerts,u=t._rawUvs,d=t._renderCmd._worldTransform;n>=1;)n-=1;for(;n<0;)n+=1;var _=o.x*i.width,f=o.y*i.height,p=cc.v2(_,f),g=(n*=2*Math.PI)+(r*=2*Math.PI);this.outVerts=a,this.outUvs=h,this.rawVerts=l,this.rawUvs=u,this._calculateVertices(d,e,i),this._calculateUVs(e);var v=this._vertPos,m=this._vertices;v[0].x=v[3].x=m[0].x,v[1].x=v[2].x=m[1].x,v[0].y=v[1].y=m[0].y,v[2].y=v[3].y=m[1].y,p.x>m[1].x&&(p.x=m[1].x),p.x<m[0].x&&(p.x=m[0].x),p.y<m[0].y&&(p.y=m[0].y),p.y>m[1].y&&(p.y=m[1].y),l[0]=l[4]=this._vertices[0].x,l[2]=l[6]=this._vertices[1].x,l[1]=l[3]=this._vertices[0].y,l[5]=l[7]=this._vertices[1].y,e._rotated?(u[0]=u[2]=this._uvs[0].x,u[4]=u[6]=this._uvs[1].x,u[3]=u[7]=this._uvs[0].y,u[1]=u[5]=this._uvs[1].y):(u[0]=u[4]=this._uvs[0].x,u[2]=u[6]=this._uvs[1].x,u[1]=u[3]=this._uvs[0].y,u[5]=u[7]=this._uvs[1].y);var y=[null,null,null,null];p.x!==this._vertices[0].x&&(y[0]=[3,0]),p.x!==this._vertices[1].x&&(y[2]=[1,2]),p.y!==this._vertices[0].y&&(y[1]=[0,1]),p.y!==this._vertices[1].y&&(y[3]=[2,3]),this._getInsectedPoints(this._vertices[0].x,this._vertices[1].x,this._vertices[0].y,this._vertices[1].y,p,n,this._intersectPoint_1),this._getInsectedPoints(this._vertices[0].x,this._vertices[1].x,this._vertices[0].y,this._vertices[1].y,p,n+r,this._intersectPoint_2);a.length<30&&(s.put(a),a=s.get(30)||new Float32Array(30),this.outVerts=t._vertices=a),h.length<30&&(s.put(h),h=s.get(30)||new Float32Array(30),this.outUvs=t._uvs=h);for(var T=0,C=0,x=0;x<4;++x){var E=y[x];if(null!==E)if(r>=2*Math.PI)this._generateTriangle(d,T,p,this._vertPos[E[0]],this._vertPos[E[1]]),T+=6,C+=3;else{var S=this._getVertAngle(p,this._vertPos[E[0]]),b=this._getVertAngle(p,this._vertPos[E[1]]);b<S&&(b+=2*Math.PI),S-=2*Math.PI,b-=2*Math.PI;for(var A=0;A<3;++A)S>=g||(S>=n?(b>=g?this._generateTriangle(d,T,p,this._vertPos[E[0]],this._intersectPoint_2[x]):this._generateTriangle(d,T,p,this._vertPos[E[0]],this._vertPos[E[1]]),T+=6,C+=3):b<=n||(b<=g?(this._generateTriangle(d,T,p,this._intersectPoint_1[x],this._vertPos[E[1]]),T+=6,C+=3):(this._generateTriangle(d,T,p,this._intersectPoint_1[x],this._intersectPoint_2[x]),T+=6,C+=3))),S+=2*Math.PI,b+=2*Math.PI}}t._vertCount=C,c[0]=0,c[1]=2,c[2]=4,c[3]=6},_generateTriangle:function(t,e,i,n,o){var s,a,c=this.rawVerts,h=this.rawUvs,l=this.outVerts,u=c[0],d=c[1],_=c[6],f=c[7];r?(l[e]=i.x*t.a+i.y*t.c+t.tx,l[e+1]=i.x*t.b+i.y*t.d+t.ty,l[e+2]=n.x*t.a+n.y*t.c+t.tx,l[e+3]=n.x*t.b+n.y*t.d+t.ty,l[e+4]=o.x*t.a+o.y*t.c+t.tx,l[e+5]=o.x*t.b+o.y*t.d+t.ty):(l[e]=i.x,l[e+1]=i.y,l[e+2]=n.x,l[e+3]=n.y,l[e+4]=o.x,l[e+5]=o.y),s=(i.x-u)/(_-u),a=(i.y-d)/(f-d),this._generateUV(s,a,h,e),s=(n.x-u)/(_-u),a=(n.y-d)/(f-d),this._generateUV(s,a,h,e+2),s=(o.x-u)/(_-u),a=(o.y-d)/(f-d),this._generateUV(s,a,h,e+4)},_generateUV:function(t,e,i,n){var r=this.outUvs,o=i[0]+(i[2]-i[0])*t,s=i[4]+(i[6]-i[4])*t,a=i[1]+(i[3]-i[1])*t,c=i[5]+(i[7]-i[5])*t;r[n]=o+(s-o)*e,r[n+1]=a+(c-a)*e},_isAngleIn:function(t,e,i){for(var n=2*Math.PI;t<e||t>=e+n;)t<e&&(t+=n),t>=e+n&&(t-=n);return t<=e+i},_getVertAngle:function(t,e){var i,n;if(i=e.x-t.x,n=e.y-t.y,0!==i||0!==n){if(0===i)return n>0?.5*Math.PI:1.5*Math.PI;var r=Math.atan(n/i);return i<0&&(r+=Math.PI),r}},_getInsectedPoints:function(t,e,i,n,r,o,s){var a,c,h=[null,null,null,null],l=Math.sin(o),u=Math.cos(o);if(0!==Math.cos(o)){if(a=l/u,(t-r.x)*u>0){var d=r.y+a*(t-r.x);s[0].x=t,s[0].y=d}if((e-r.x)*u>0){var _=r.y+a*(e-r.x);s[2].x=e,s[2].y=_}}if(0!==Math.sin(o)){if(c=u/l,(n-r.y)*l>0){var f=r.x+c*(n-r.y);s[3].x=f,s[3].y=n}if((i-r.y)*l>0){var p=r.x+c*(i-r.y);s[1].x=p,s[1].y=i}}return h},_calculateVertices:function(t,e,i){var n,r;n=i.width,r=i.height,this._vertices[0].x=0,this._vertices[0].y=0,this._vertices[1].x=n,this._vertices[1].y=r},_calculateUVs:function(t){var e,i,n,r,o=t._texture._pixelWidth,s=t._texture._pixelHeight,c=t._rect,h=a.FIX_ARTIFACTS_BY_STRECHING_TEXEL?.5:0;t._rotated?(e=(c.x+h)/o,i=(c.x+c.height-h)/o,n=(c.y+h)/s,r=(c.y+c.width-h)/s):(e=(c.x+h)/o,i=(c.x+c.width-h)/o,n=(c.y+h)/s,r=(c.y+c.height-h)/s),this._uvs[0].x=e,this._uvs[0].y=r,this._uvs[1].x=i,this._uvs[1].y=n}},_={_rebuildQuads_base:function(t,e,i){if(cc._renderType!==cc.game.RENDER_TYPE_CANVAS){t._spriteFrame;if(i=t._meshPolygonInfo){var n=t._renderCmd._worldTransform,r=i.triangles.verts,o=t._vertices,a=t._uvs,c=r.length,h=t._corner,l=2*c;o.length<l&&(s.put(o),o=s.get(l)||new Float32Array(l),t._vertices=o),a.length<l&&(s.put(a),a=s.get(l)||new Float32Array(l),t._uvs=a);for(var u=1/0,d=1/0,_=-1/0,f=-1/0,p=0;p<c;p++){var g=r[p].x*n.a+r[p].y*n.c+n.tx,v=r[p].x*n.b+r[p].y*n.d+n.ty;o[2*p]=g,o[2*p+1]=v,a[2*p]=r[p].u,a[2*p+1]=r[p].v,g<u&&(u=g,h[0]=2*p),g>_&&(_=g,h[1]=2*p),v<d&&(d=v,h[2]=2*p),v>f&&(f=v,h[3]=2*p)}t._vertCount=c}}}};cc.Scale9Sprite=_ccsg.Node.extend({_spriteFrame:null,_insetLeft:0,_insetRight:0,_insetTop:0,_insetBottom:0,_blendFunc:null,_renderingType:1,_brightState:0,_rawVerts:null,_rawUvs:null,_vertices:null,_uvs:null,_vertCount:0,_quadsDirty:!0,_uvsDirty:!0,_isTriangle:!1,_isTrimmedContentSize:!0,_fillType:0,_fillCenter:null,_fillStart:0,_fillRange:2*Math.PI,_distortionOffset:null,_distortionTiling:null,_meshPolygonInfo:null,ctor:function(t){_ccsg.Node.prototype.ctor.call(this),this._renderCmd.setState(this._brightState),this._blendFunc=cc.BlendFunc._alphaNonPremultiplied(),this._fillCenter=cc.v2(0,0),this.setAnchorPoint(cc.p(.5,.5)),this._rawVerts=null,this._rawUvs=null,this._vertices=s.get(8)||new Float32Array(8),this._uvs=s.get(8)||new Float32Array(8),"string"==typeof t||t instanceof cc.Texture2D?this.initWithTexture(t):t instanceof cc.SpriteFrame&&this.initWithSpriteFrame(t),void 0===r&&(r=cc._renderType===cc.game.RENDER_TYPE_WEBGL),this._corner=[]},loaded:function(){return null!==this._spriteFrame&&this._spriteFrame.textureLoaded()},initWithTexture:function(t){this.setTexture(t)},initWithSpriteFrame:function(t){this.setSpriteFrame(t)},setTexture:function(t){var e=new cc.SpriteFrame(t);this.setSpriteFrame(e)},setSpriteFrame:function(t){if(t){this._spriteFrame=t,this._quadsDirty=!0,this._uvsDirty=!0,this._renderCmd._needDraw=!1;var e=this,i=function(){cc.sizeEqualToSize(e._contentSize,cc.size(0,0))&&e.setContentSize(e._spriteFrame._rect),e._renderCmd._needDraw=!0,e._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)};t.textureLoaded()?i():t.once("load",i,this)}},setBlendFunc:function(t,e){void 0===e?(this._blendFunc.src=t.src||cc.macro.BLEND_SRC,this._blendFunc.dst=t.dst||cc.macro.BLEND_DST):(this._blendFunc.src=t||cc.macro.BLEND_SRC,this._blendFunc.dst=e||cc.macro.BLEND_DST),this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},getBlendFunc:function(){return new cc.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},setContentSize:function(t,e){void 0===e&&(e=t.height,t=t.width),t===this._contentSize.width&&e===this._contentSize.height||(_ccsg.Node.prototype.setContentSize.call(this,t,e),this._quadsDirty=!0)},enableTrimmedContentSize:function(t){this._isTrimmedContentSize!==t&&(this._isTrimmedContentSize=t,this._quadsDirty=!0,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty))},isTrimmedContentSizeEnabled:function(){return this._isTrimmedContentSize},setState:function(t){this._brightState=t,this._renderCmd.setState(t),this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},getState:function(){return this._brightState},setRenderingType:function(t){this._renderingType!==t&&(this._renderingType=t,this._quadsDirty=!0,this._uvsDirty=!0,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty))},getRenderingType:function(){return this._renderingType},setInsetLeft:function(t){this._insetLeft=t,this._quadsDirty=!0,this._uvsDirty=!0,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},getInsetLeft:function(){return this._insetLeft},setInsetTop:function(t){this._insetTop=t,this._quadsDirty=!0,this._uvsDirty=!0,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},getInsetTop:function(){return this._insetTop},setInsetRight:function(t){this._insetRight=t,this._quadsDirty=!0,this._uvsDirty=!0,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},getInsetRight:function(){return this._insetRight},setInsetBottom:function(t){this._insetBottom=t,this._quadsDirty=!0,this._uvsDirty=!0,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},getInsetBottom:function(){return this._insetBottom},setFillType:function(t){this._fillType!==t&&(this._fillType=t,this._renderingType===p.FILLED&&(this._quadsDirty=!0,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)))},getFillType:function(){return this._fillType},setFillCenter:function(t,e){this._fillCenter=cc.v2(t,e),this._renderingType===p.FILLED&&this._fillType===g.RADIAL&&(this._quadsDirty=!0,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty))},setDistortionTiling:function(t,e){void 0===e&&(e=t.y,t=t.x),this._distortionTiling=this._distortionTiling||cc.v2(0,0),this._distortionTiling.x=t,this._distortionTiling.y=e},setDistortionOffset:function(t,e){void 0===e&&(e=t.y,t=t.x),this._distortionOffset=this._distortionOffset||cc.v2(0,0),this._distortionOffset.x=t,this._distortionOffset.y=e},getFillCenter:function(){return cc.v2(this._fillCenter)},setFillStart:function(t){this._fillStart!==t&&(this._fillStart=t,this._renderingType===p.FILLED&&(this._quadsDirty=!0,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)))},getFillStart:function(){return this._fillStart},setFillRange:function(t){this._fillRange!==t&&(this._fillRange=t,this._renderingType===p.FILLED&&(this._quadsDirty=!0,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)))},getFillRange:function(){return this._fillRange},_rebuildQuads:function(){if(this._spriteFrame&&this._spriteFrame._textureLoaded){this._isTriangle=!1;var t;switch(this._renderingType){case p.SIMPLE:t=c;break;case p.SLICED:t=h;break;case p.TILED:t=l;break;case p.FILLED:t=this._fillType===g.RADIAL?d:u;break;case p.MESH:t=_}t?t._rebuildQuads_base(this):(this._quadsDirty=!1,this._uvsDirty=!1,this._renderCmd._needDraw=!1,cc.errorID(2627)),this._quadsDirty=!1,this._uvsDirty=!1}else this._renderCmd._needDraw=!1},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.Scale9Sprite.CanvasRenderCmd(this):new cc.Scale9Sprite.WebGLRenderCmd(this)},setMeshPolygonInfo:function(t){this.setRenderingType(p.MESH),this._meshPolygonInfo=t,this._quadsDirty=!0,this._uvsDirty=!0},getMeshPolygonInfo:function(){return this._meshPolygonInfo}});var f=cc.Scale9Sprite.prototype;cc.js.addon(f,o.prototype),cc.defineGetterSetter(f,"insetLeft",f.getInsetLeft,f.setInsetLeft),cc.defineGetterSetter(f,"insetTop",f.getInsetTop,f.setInsetTop),cc.defineGetterSetter(f,"insetRight",f.getInsetRight,f.setInsetRight),cc.defineGetterSetter(f,"insetBottom",f.getInsetBottom,f.setInsetBottom),cc.Scale9Sprite.state={NORMAL:0,GRAY:1,DISTORTION:2};var p=cc.Scale9Sprite.RenderingType=cc.Enum({SIMPLE:0,SLICED:1,TILED:2,FILLED:3,MESH:4}),g=cc.Scale9Sprite.FillType=cc.Enum({HORIZONTAL:0,VERTICAL:1,RADIAL:2})}),{"../event/event-target":110}],182:[(function(t,e,i){cc.Scale9Sprite.CanvasRenderCmd=function(t){this._rootCtor(t),this._node.loaded()?this._needDraw=!0:this._needDraw=!1,this._state=cc.Scale9Sprite.state.NORMAL,this._originalTexture=this._textureToRender=null};var n=cc.Scale9Sprite.CanvasRenderCmd.prototype=Object.create(_ccsg.Node.CanvasRenderCmd.prototype);n.constructor=cc.Scale9Sprite.CanvasRenderCmd,n.updateTransform=function(t){this.originUpdateTransform(t),this._node._rebuildQuads()},n._doCulling=function(){var t=cc.visibleRect,e=this._currentRegion,i=e._minX,n=e._maxX,r=e._minY,o=e._maxY,s=t.left.x,a=t.right.x,c=t.top.y,h=t.bottom.y;this._needDraw=!(n<s||i>a||o<h||r>c)},n._updateDisplayColor=function(t){_ccsg.Node.WebGLRenderCmd.prototype._updateDisplayColor.call(this,t),this._originalTexture=this._textureToRender=null},n._syncDisplayColor=function(t){_ccsg.Node.WebGLRenderCmd.prototype._syncDisplayColor.call(this,t),this._originalTexture=this._textureToRender=null},n.setState=function(t){this._state!==t&&(this._state=t,this._originalTexture=this._textureToRender=null)},n.rendering=function(t,e,i){var n=this._node,r=this._displayedOpacity,o=r/255,s=null;if(n._spriteFrame&&(s=n._spriteFrame._texture),n.loaded()&&0!==r){if(null===this._textureToRender||this._originalTexture!==s){this._textureToRender=this._originalTexture=s,cc.Scale9Sprite.state.GRAY===this._state&&(this._textureToRender=this._textureToRender._generateGrayTexture());var a=n.getDisplayedColor();!s||255===a.r&&255===a.g&&255===a.b||(this._textureToRender=this._textureToRender._generateColorTexture(a.r,a.g,a.b))}var c=t||cc._renderContext,h=c.getContext();if(c.setTransform(this._worldTransform,e,i),c.setCompositeOperation(_ccsg.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(n._blendFunc)),c.setGlobalAlpha(o),this._textureToRender){n._quadsDirty&&n._rebuildQuads();var l,u,d,_,f,p,g,v,m=this._textureToRender._pixelWidth,y=this._textureToRender._pixelHeight,T=this._textureToRender._htmlElementObj,C=n._vertices,x=n._uvs,E=0,S=0;if(n._isTriangle){var b=n._rawVerts,A=n._rawUvs;f=b[0],p=b[1],g=b[6]-f,p=-p-(v=b[7]-p),l=A[4]*m,u=A[5]*y,d=(A[6]-A[0])*m,_=(A[1]-A[7])*y,c.save(),h.beginPath();var R=Math.floor(n._vertCount/3);for(E=0,S=0;E<R;E++)h.moveTo(C[S++],-C[S++]),h.lineTo(C[S++],-C[S++]),h.lineTo(C[S++],-C[S++]);h.clip(),""!==this._textureToRender._pattern?(c.setFillStyle(h.createPattern(T,this._textureToRender._pattern)),h.fillRect(f,p,g,v)):d>0&&_>0&&g>0&&v>0&&h.drawImage(T,l,u,d,_,f,p,g,v),c.restore(),cc.g_NumberOfDraws+=R}else if(n._renderingType===cc.Scale9Sprite.RenderingType.SLICED){for(var I=0;I<3;++I)for(var w=0;w<3;++w)f=C[S=8*I+2*w],p=C[S+1],g=C[S+10]-f,p=-p-(v=C[S+11]-p),l=x[S]*m,u=x[S+11]*y,d=(x[S+10]-x[S])*m,_=(x[S+1]-x[S+11])*y,d>0&&_>0&&g>0&&v>0&&h.drawImage(T,l,u,d,_,f,p,g,v);cc.g_NumberOfDraws+=9}else{var O=Math.floor(n._vertCount/4);for(E=0,S=0;E<O;E++)f=C[S],p=C[S+1],g=C[S+6]-f,p=-p-(v=C[S+7]-p),l=x[S]*m,u=x[S+7]*y,d=(x[S+6]-x[S])*m,_=(x[S+1]-x[S+7])*y,""!==this._textureToRender._pattern?(c.setFillStyle(h.createPattern(T,this._textureToRender._pattern)),h.fillRect(f,p,g,v)):d>0&&_>0&&g>0&&v>0&&h.drawImage(T,l,u,d,_,f,p,g,v),S+=8;cc.g_NumberOfDraws+=O}}}}}),{}],183:[(function(t,e,i){cc.gl;cc.Scale9Sprite.WebGLRenderCmd=function(t){this._rootCtor(t),this._node.loaded()?this._needDraw=!0:this._needDraw=!1,this.vertexType=cc.renderer.VertexType.QUAD,this._dirty=!1,this._shaderProgram=cc.shaderCache.programForKey(cc.macro.SHADER_SPRITE_POSITION_TEXTURECOLOR)};var n=cc.Scale9Sprite,r=n.WebGLRenderCmd.prototype=Object.create(_ccsg.Node.WebGLRenderCmd.prototype);r.constructor=n.WebGLRenderCmd,r._uploadSliced=function(t,e,i,n,r,o,s){for(var a,c=0;c<3;++c)for(var h=0;h<3;++h)a=8*c+2*h,r[s]=t[a],r[s+1]=t[a+1],r[s+2]=n,o[s+3]=i,r[s+4]=e[a],r[s+5]=e[a+1],r[s+=6]=t[a+2],r[s+1]=t[a+3],r[s+2]=n,o[s+3]=i,r[s+4]=e[a+2],r[s+5]=e[a+3],r[s+=6]=t[a+8],r[s+1]=t[a+9],r[s+2]=n,o[s+3]=i,r[s+4]=e[a+8],r[s+5]=e[a+9],r[s+=6]=t[a+10],r[s+1]=t[a+11],r[s+2]=n,o[s+3]=i,r[s+4]=e[a+10],r[s+5]=e[a+11],s+=6;return 36},r.updateTransform=function(t){this.originUpdateTransform(t),this._node._rebuildQuads()},r._doCulling=function(){var t=this._node,e=cc.visibleRect;this._cameraFlag>0&&(e=cc.Camera.main.visibleRect),vl=e.left.x,vr=e.right.x,vt=e.top.y,vb=e.bottom.y;var i=t._isTriangle?t._rawVerts:t._vertices,n=t._corner,r=n[0],o=n[1],s=n[2],a=n[3],c=i[r],h=i[o],l=i[s],u=i[a],d=i[r+1],_=i[o+1],f=i[s+1],p=i[a+1];(c-vl&h-vl&l-vl&u-vl)>>31||(vr-c&vr-h&vr-l&vr-u)>>31||(d-vb&_-vb&f-vb&p-vb)>>31||(vt-d&vt-_&vt-f&vt-p)>>31?this._needDraw=!1:this._needDraw=!0},r.uploadData=function(t,e,i){var r=this._node;if(0===this._displayedOpacity)return 0;r._quadsDirty&&r._rebuildQuads(),r._distortionOffset&&this._shaderProgram===n.WebGLRenderCmd._distortionProgram&&(this._shaderProgram.use(),this._shaderProgram.setUniformLocationWith2f(n.WebGLRenderCmd._distortionOffset,r._distortionOffset.x,r._distortionOffset.y),this._shaderProgram.setUniformLocationWith2f(n.WebGLRenderCmd._distortionTiling,r._distortionTiling.x,r._distortionTiling.y),cc.renderer._breakBatch());var o,s=this._displayedOpacity,a=this._displayedColor._val;if(r._opacityModifyRGB){var c=s/255,h=this._displayedColor.r*c,l=this._displayedColor.g*c;o=(s<<24>>>0)+(this._displayedColor.b*c<<16)+(l<<8)+h}else o=(s<<24>>>0)+((65280&a)<<8)+((16711680&a)>>8)+(a>>>24);var u=r._vertexZ,d=r._vertices,_=r._uvs,f=n.RenderingType,p=i,g=0;switch(r._renderingType){case f.SIMPLE:case f.TILED:case f.FILLED:case f.MESH:g=this._node._vertCount;for(var v=0,m=0;v<g;v++,m+=2)t[p]=d[m],t[p+1]=d[m+1],t[p+2]=u,e[p+3]=o,t[p+4]=_[m],t[p+5]=_[m+1],p+=6;break;case f.SLICED:g=this._uploadSliced(d,_,o,u,t,e,p)}return r._renderingType===f.MESH?this.vertexType=cc.renderer.VertexType.CUSTOM:r._renderingType===f.FILLED&&r._fillType===n.FillType.RADIAL?this.vertexType=cc.renderer.VertexType.TRIANGLE:this.vertexType=cc.renderer.VertexType.QUAD,g},r.uploadIndexData=function(t,e,i){var n=this._node._meshPolygonInfo;if(!n)return 0;for(var r=n.triangles.indices,o=r.length,s=0;s<o;s++)t[e+s]=i+r[s];return o},r.setState=function(t){t===n.state.NORMAL?this._shaderProgram=cc.shaderCache.programForKey(cc.macro.SHADER_SPRITE_POSITION_TEXTURECOLOR):t===n.state.GRAY?this._shaderProgram=cc.Scale9Sprite.WebGLRenderCmd._getGrayShaderProgram():t===n.state.DISTORTION&&(this._shaderProgram=cc.Scale9Sprite.WebGLRenderCmd._getDistortionProgram())},n.WebGLRenderCmd._grayShaderProgram=null,n.WebGLRenderCmd._getGrayShaderProgram=function(){var t=n.WebGLRenderCmd._grayShaderProgram;return t||((t=new cc.GLProgram).initWithVertexShaderByteArray(cc.PresetShaders.SPRITE_POSITION_TEXTURE_COLOR_VERT,cc.Scale9Sprite.WebGLRenderCmd._grayShaderFragment),t.addAttribute(cc.macro.ATTRIBUTE_NAME_POSITION,cc.macro.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.macro.ATTRIBUTE_NAME_COLOR,cc.macro.VERTEX_ATTRIB_COLOR),t.addAttribute(cc.macro.ATTRIBUTE_NAME_TEX_COORD,cc.macro.VERTEX_ATTRIB_TEX_COORDS),t.link(),t.updateUniforms(),n.WebGLRenderCmd._grayShaderProgram=t,t)},n.WebGLRenderCmd._grayShaderFragment="precision lowp float;\nvarying vec4 v_fragmentColor;\nvarying vec2 v_texCoord;\nvoid main()\n{\nvec4 c = v_fragmentColor * texture2D(CC_Texture0, v_texCoord);\nfloat gray = 0.2126*c.r + 0.7152*c.g + 0.0722*c.b;\ngl_FragColor = vec4(gray, gray, gray, c.a);\n}",n.WebGLRenderCmd._distortionProgram=null,n.WebGLRenderCmd._getDistortionProgram=function(){var t=n.WebGLRenderCmd._distortionProgram;return t||((t=new cc.GLProgram).initWithVertexShaderByteArray(cc.PresetShaders.SPRITE_POSITION_TEXTURE_COLOR_VERT,o.fShader),t.addAttribute(cc.macro.ATTRIBUTE_NAME_POSITION,cc.macro.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.macro.ATTRIBUTE_NAME_COLOR,cc.macro.VERTEX_ATTRIB_COLOR),t.addAttribute(cc.macro.ATTRIBUTE_NAME_TEX_COORD,cc.macro.VERTEX_ATTRIB_TEX_COORDS),t.link(),t.updateUniforms(),n.WebGLRenderCmd._distortionProgram=t,n.WebGLRenderCmd._distortionOffset=t.getUniformLocationForName("u_offset"),n.WebGLRenderCmd._distortionTiling=t.getUniformLocationForName("u_offset_tiling"),t)};var o={shaderKey:"cc.Sprite.Shader.Distortion",fShader:"precision lowp float;\nvarying vec4 v_fragmentColor;\nvarying vec2 v_texCoord;\nuniform vec2 u_offset;\nuniform vec2 u_offset_tiling;\nconst float PI = 3.14159265359;\nvoid main()\n{\nfloat halfPI = 0.5 * PI;\nfloat maxFactor = sin(halfPI);\nvec2 uv = v_texCoord;\nvec2 xy = 2.0 * uv.xy - 1.0;\nfloat d = length(xy);\nif (d < (2.0-maxFactor)) {\nd = length(xy * maxFactor);\nfloat z = sqrt(1.0 - d * d);\nfloat r = atan(d, z) / PI;\nfloat phi = atan(xy.y, xy.x);\nuv.x = r * cos(phi) + 0.5;\nuv.y = r * sin(phi) + 0.5;\n} else {\ndiscard;\n}\nuv = uv * u_offset_tiling + u_offset;\nuv = fract(uv);\ngl_FragColor = v_fragmentColor * texture2D(CC_Texture0, uv);\n}"}}),{}],184:[(function(t,e,i){cc.SpriteBatchNode=_ccsg.Node.extend({_blendFunc:null,_texture:null,_className:"SpriteBatchNode",ctor:function(t){_ccsg.Node.prototype.ctor.call(this),this._blendFunc=new cc.BlendFunc(cc.macro.BLEND_SRC,cc.macro.BLEND_DST);var e;cc.js.isString(t)?(e=cc.textureCache.getTextureForKey(t))||(e=cc.textureCache.addImage(t)):t instanceof cc.Texture2D&&(e=t),e&&this.initWithTexture(e)},addSpriteWithoutQuad:function(t,e,i){return this.addChild(t,e,i),this},getTextureAtlas:function(){return null},setTextureAtlas:function(t){},getDescendants:function(){return this._children},initWithFile:function(t,e){var i=cc.textureCache.getTextureForKey(t);return i||(i=cc.textureCache.addImage(t)),this.initWithTexture(i,e)},init:function(t,e){var i=cc.textureCache.getTextureForKey(t);return i||(i=cc.textureCache.addImage(t)),this.initWithTexture(i,e)},increaseAtlasCapacity:function(){},removeChildAtIndex:function(t,e){this.removeChild(this._children[t],e)},rebuildIndexInOrder:function(t,e){return e},highestAtlasIndexInChild:function(t){var e=t.children;return e&&0!==e.length?this.highestAtlasIndexInChild(e[e.length-1]):t.zIndex},lowestAtlasIndexInChild:function(t){var e=t.children;return e&&0!==e.length?this.lowestAtlasIndexInChild(e[e.length-1]):t.zIndex},atlasIndexForChild:function(t){return t.zIndex},reorderBatch:function(t){this._reorderChildDirty=t},setBlendFunc:function(t,e){this._blendFunc=void 0===e?t:{src:t,dst:e}},getBlendFunc:function(){return new cc.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},updateQuadFromSprite:function(t,e){cc.assertID(t,2623),t instanceof _ccsg.Sprite?(t.dirty=!0,t._renderCmd.transform(this._renderCmd,!0)):cc.log(2616)},insertQuadFromSprite:function(t,e){this.addChild(t,e)},insertChild:function(t,e){this.addChild(t,e)},appendChild:function(t){this.sortAllChildren();this._children[this._children.length-1]._localZOrder;this.addChild(t.lastLocalZOrder+1)},removeSpriteFromAtlas:function(t,e){this.removeChild(t,e)},initWithTexture:function(t){return this.setTexture(t),!0},getTexture:function(){return this._texture},setTexture:function(t){if(this._texture=t,t._textureLoaded){var e,i=this._children,n=i.length;for(e=0;e<n;++e)i[e].setTexture(t)}else t.addEventListener("load",(function(){var e,i=this._children,n=i.length;for(e=0;e<n;++e)i[e].setTexture(t)}),this)},setShaderProgram:function(t){this._renderCmd.setShaderProgram(t);var e,i=this._children,n=i.length;for(e=0;e<n;++e)i[e].setShaderProgram(t)},addChild:function(t,e,i){cc.assertID(void 0!==t,2614),this._isValidChild(t)&&(e=void 0===e?t.zIndex:e,i=void 0===i?t.tag:i,_ccsg.Node.prototype.addChild.call(this,t,e,i),this._renderCmd._shaderProgram&&(t.shaderProgram=this._renderCmd._shaderProgram))},_isValidChild:function(t){return t instanceof _ccsg.Sprite?t.texture===this._texture||(cc.logID(2619),!1):(cc.logID(2618),!1)}});var n=cc.SpriteBatchNode.prototype;cc.defineGetterSetter(n,"texture",n.getTexture,n.setTexture),cc.defineGetterSetter(n,"shaderProgram",n.getShaderProgram,n.setShaderProgram)}),{}],185:[(function(t,e,i){var n=t("../event/event-target");cc.SpriteFrame=cc.Class({name:"cc.SpriteFrame",extends:t("../assets/CCAsset"),mixins:[n],properties:{_textureFilenameSetter:{set:function(t){this._textureFilename=t,t&&this._loadTexture()}}},ctor:function(){var t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3],r=arguments[4];this._rect=null,this._offset=null,this._originalSize=null,this._rotated=!1,this.insetTop=0,this.insetBottom=0,this.insetLeft=0,this.insetRight=0,this._texture=null,this._textureFilename="",this._textureLoaded=!1,void 0!==t&&this.initWithTexture(t,e,i,n,r)},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(t,e){this.once("load",t,e)},isRotated:function(){return this._rotated},setRotated:function(t){this._rotated=t},getRect:function(){return cc.rect(this._rect)},setRect:function(t){this._rect=t},getOriginalSize:function(){return cc.size(this._originalSize)},setOriginalSize:function(t){this._originalSize?(this._originalSize.width=t.width,this._originalSize.height=t.height):this._originalSize=cc.size(t)},getTexture:function(){return this._texture},_refreshTexture:function(t){var e=this;if(e._texture!==t){var i=t.isLoaded();this._textureLoaded=i,this._texture=t;function n(){if(e._texture){e._textureLoaded=!0;var i=t.width,n=t.height;if(e._rotated&&cc._renderType===cc.game.RENDER_TYPE_CANVAS){var r=t.getHtmlElementObj();r=_ccsg.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(r,e.getRect());var o=new cc.Texture2D;o.initWithElement(r),o.handleLoadedTexture(),e._texture=o,e._rotated=!1,i=e._texture.width,n=e._texture.height,e.setRect(cc.rect(0,0,i,n))}e._rect?e._checkRect(e._texture):e.setRect(cc.rect(0,0,i,n)),e._originalSize||e.setOriginalSize(cc.size(i,n)),e._offset||e.setOffset(cc.v2(0,0)),e.emit("load")}}i?n():t.once("load",n)}},getOffset:function(){return cc.v2(this._offset)},setOffset:function(t){this._offset=cc.v2(t)},clone:function(){return new cc.SpriteFrame(this._texture||this._textureFilename,this._rect,this._rotated,this._offset,this._originalSize)},setTexture:function(t,e,i,n,r){e?this.setRect(e):this._rect=null,n?this.setOffset(n):this._offset=null,r?this.setOriginalSize(r):this._originalSize=null,this._rotated=i||!1;var o=t;return cc.js.isString(o)?(this._textureFilename=o,this._loadTexture()):o instanceof cc.Texture2D&&this._refreshTexture(o),!0},_loadTexture:function(){if(this._textureFilename){var t=cc.textureCache.addImage(this._textureFilename);this._refreshTexture(t)}},ensureLoadTexture:function(){this._texture||this._loadTexture()},clearTexture:function(){this._textureLoaded=!1,this._texture=null},_checkRect:function(t){var e=this._rect,i=e.x,n=e.y;this._rotated?(i+=e.height,n+=e.width):(i+=e.width,n+=e.height),i>t.getPixelWidth()&&cc.errorID(3300,t.url+"/"+this.name),n>t.getPixelHeight()&&cc.errorID(3400,t.url+"/"+this.name)},_serialize:!1,_deserialize:function(t,e){var i=t.rect;i&&this.setRect(new cc.Rect(i[0],i[1],i[2],i[3])),t.offset&&this.setOffset(new cc.Vec2(t.offset[0],t.offset[1])),t.originalSize&&this.setOriginalSize(new cc.Size(t.originalSize[0],t.originalSize[1])),this._rotated=1===t.rotated,this._name=t.name;var n=t.capInsets;n&&(this.insetLeft=n[0],this.insetTop=n[1],this.insetRight=n[2],this.insetBottom=n[3]);var r=t.texture;if(r){var o=e.customEnv&&e.customEnv.deferredLoadRaw?"_textureFilename":"_textureFilenameSetter";e.result.push(this,o,r)}}});var r=cc.SpriteFrame.prototype;r.copyWithZone=r.clone,r.copy=r.clone,r.initWithTexture=r.setTexture}),{"../assets/CCAsset":44,"../event/event-target":110}],186:[(function(t,e,i){var n=t("../event/event-target"),r=t("../platform/CCSys"),o=(t("../platform/js"),t("../utils/misc")),s=t("../CCGame");t("../platform/_CCClass"),t("../platform/CCClass");var a=cc.Enum({REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648}),c=cc.Class({name:"cc.Texture2D",extends:t("../assets/CCRawAsset"),mixins:[n],statics:{WrapMode:a},ctor:function(){this.url=null,this._textureLoaded=!1,this._htmlElementObj=null,this._contentSize=cc.size(0,0),this._pixelWidth=0,this._pixelHeight=0,cc._renderType===s.RENDER_TYPE_CANVAS?(this._pattern="",this._grayElementObj=null,this._backupElement=null,this._isGray=!1):cc._renderType===s.RENDER_TYPE_WEBGL&&(this._pixelFormat=c.defaultPixelFormat,this._hasPremultipliedAlpha=!1,this._hasMipmaps=!1,this._webTextureObj=null)},getPixelWidth:function(){return this._pixelWidth},getPixelHeight:function(){return this._pixelHeight},getContentSize:function(){return cc.size(this._contentSize.width,this._contentSize.height)},_getWidth:function(){return this._contentSize.width},_getHeight:function(){return this._contentSize.height},getContentSizeInPixels:function(){return this._contentSize},initWithElement:function(t){t&&(this._htmlElementObj=t,this._pixelWidth=this._contentSize.width=t.width,this._pixelHeight=this._contentSize.height=t.height,this._textureLoaded=!0)},initWithData:function(t,e,i,n,r){return!1},initWithImage:function(t){return!1},getHtmlElementObj:function(){return this._htmlElementObj},isLoaded:function(){return this._textureLoaded},handleLoadedTexture:function(){var t=this;if(t._htmlElementObj&&t._htmlElementObj.width&&t._htmlElementObj.height){var e=t._htmlElementObj;t._pixelWidth=t._contentSize.width=e.width,t._pixelHeight=t._contentSize.height=e.height,t._textureLoaded=!0,t.emit("load")}},description:function(){return"<cc.Texture2D | Name = "+this.getName()+" | Dimensions = "+this.getPixelWidth()+" x "+this.getPixelHeight()+">"},releaseTexture:function(){this._webTextureObj&&cc._renderContext.deleteTexture(this._webTextureObj)},getName:function(){return this._webTextureObj||null},getPixelFormat:function(){return this._pixelFormat||null},hasPremultipliedAlpha:function(){return this._hasPremultipliedAlpha||!1},hasMipmaps:function(){return this._hasMipmaps||!1},setTexParameters:function(t,e,i,n){void 0!==e&&(t={minFilter:t,magFilter:e,wrapS:i,wrapT:n}),t.wrapS!==a.REPEAT||t.wrapT!==a.REPEAT?t.wrapS!==a.REPEAT?t.wrapT!==a.REPEAT?this._pattern="":this._pattern="repeat-y":this._pattern="repeat-x":this._pattern="repeat"},setAntiAliasTexParameters:function(){},setAliasTexParameters:function(){},generateMipmap:function(){},stringForFormat:function(){return""},bitsPerPixelForFormat:function(t){return-1}});c.WrapMode=a;var h=c;h.PIXEL_FORMAT_RGBA8888=2,h.PIXEL_FORMAT_RGB888=3,h.PIXEL_FORMAT_RGB565=4,h.PIXEL_FORMAT_A8=5,h.PIXEL_FORMAT_I8=6,h.PIXEL_FORMAT_AI88=7,h.PIXEL_FORMAT_RGBA4444=8,h.PIXEL_FORMAT_RGB5A1=7,h.PIXEL_FORMAT_PVRTC4=9,h.PIXEL_FORMAT_PVRTC2=10,h.PIXEL_FORMAT_DEFAULT=h.PIXEL_FORMAT_RGBA8888,h.defaultPixelFormat=h.PIXEL_FORMAT_DEFAULT;var l=c._M={};l[h.PIXEL_FORMAT_RGBA8888]="RGBA8888",l[h.PIXEL_FORMAT_RGB888]="RGB888",l[h.PIXEL_FORMAT_RGB565]="RGB565",l[h.PIXEL_FORMAT_A8]="A8",l[h.PIXEL_FORMAT_I8]="I8",l[h.PIXEL_FORMAT_AI88]="AI88",l[h.PIXEL_FORMAT_RGBA4444]="RGBA4444",l[h.PIXEL_FORMAT_RGB5A1]="RGB5A1",l[h.PIXEL_FORMAT_PVRTC4]="PVRTC4",l[h.PIXEL_FORMAT_PVRTC2]="PVRTC2";var u=c._B={};u[h.PIXEL_FORMAT_RGBA8888]=32,u[h.PIXEL_FORMAT_RGB888]=24,u[h.PIXEL_FORMAT_RGB565]=16,u[h.PIXEL_FORMAT_A8]=8,u[h.PIXEL_FORMAT_I8]=8,u[h.PIXEL_FORMAT_AI88]=16,u[h.PIXEL_FORMAT_RGBA4444]=16,u[h.PIXEL_FORMAT_RGB5A1]=16,u[h.PIXEL_FORMAT_PVRTC4]=4,u[h.PIXEL_FORMAT_PVRTC2]=3;var d=c.prototype;d.name,cc.defineGetterSetter(d,"name",d.getName),d.pixelFormat,cc.defineGetterSetter(d,"pixelFormat",d.getPixelFormat),d.pixelWidth,cc.defineGetterSetter(d,"pixelWidth",d.getPixelWidth),d.pixelHeight,cc.defineGetterSetter(d,"pixelHeight",d.getPixelHeight),d.width,cc.defineGetterSetter(d,"width",d._getWidth),d.height,cc.defineGetterSetter(d,"height",d._getHeight),s.once(s.EVENT_RENDERER_INITED,(function(){if(cc._renderType===s.RENDER_TYPE_CANVAS){var t=function(t,e){var i=t.width,n=t.height;e[0].width=i,e[0].height=n,e[1].width=i,e[1].height=n,e[2].width=i,e[2].height=n,e[3].width=i,e[3].height=n;var r=e[3].getContext("2d");r.drawImage(t,0,0);for(var o,s=r.getImageData(0,0,i,n).data,a=0;a<4;a++){for(var c=(o=e[a].getContext("2d")).getImageData(0,0,i,n),h=c.data,l=0;l<s.length;l+=4)h[l]=0===a?s[l]:0,h[l+1]=1===a?s[l+1]:0,h[l+2]=2===a?s[l+2]:0,h[l+3]=s[l+3];o.putImageData(c,0,0)}t.onload=null},e=function(t,e,i){if(null===t)return null;i=i||document.createElement("canvas"),e=e||cc.rect(0,0,t.width,t.height),i.width=e.width,i.height=e.height;var n=i.getContext("2d");n.drawImage(t,e.x,e.y,e.width,e.height,0,0,e.width,e.height);for(var r=n.getImageData(0,0,e.width,e.height),o=r.data,s=0,a=o.length;s<a;s+=4)o[s]=o[s+1]=o[s+2]=.34*o[s]+.5*o[s+1]+.16*o[s+2];return n.putImageData(r,0,0),i};d._generateTextureCacheForColor=function(){if(this.channelCache)return this.channelCache;var e=[document.createElement("canvas"),document.createElement("canvas"),document.createElement("canvas"),document.createElement("canvas")];return t(this._htmlElementObj,e),this.channelCache=e},d._switchToGray=function(t){this._textureLoaded&&this._isGray!==t&&(this._isGray=t,this._isGray?(this._backupElement=this._htmlElementObj,this._grayElementObj||(this._grayElementObj=e(this._htmlElementObj)),this._htmlElementObj=this._grayElementObj):null!==this._backupElement&&(this._htmlElementObj=this._backupElement))},d._generateGrayTexture=function(){if(!this._textureLoaded)return null;var t=e(this._htmlElementObj),i=new c;return i.initWithElement(t),i.handleLoadedTexture(),i},d._generateColorTexture=r._supportCanvasNewBlendModes?function(t,e,i,n,r){var o=!1;r?o=!0:r=document.createElement("canvas");var s=this._htmlElementObj;if(n||(n=cc.rect(0,0,s.width,s.height)),r.width=n.width,r.height=n.height,n.width&&n.height){var a=r.getContext("2d");a.globalCompositeOperation="source-over",a.fillStyle="rgb("+(0|t)+","+(0|e)+","+(0|i)+")",a.fillRect(0,0,n.width,n.height),a.globalCompositeOperation="multiply",a.drawImage(s,n.x,n.y,n.width,n.height,0,0,n.width,n.height),a.globalCompositeOperation="destination-atop",a.drawImage(s,n.x,n.y,n.width,n.height,0,0,n.width,n.height)}if(o)return r;var h=new c;return h.initWithElement(r),h.handleLoadedTexture(),h}:function(t,e,i,n,r){var o=!1;r?o=!0:r=document.createElement("canvas");var s=this._htmlElementObj;if(n||(n=cc.rect(0,0,s.width,s.height)),r.width=n.width,r.height=n.height,n.width&&n.height){var a=r.getContext("2d");a.drawImage(s,n.x,n.y,n.width,n.height,0,0,n.width,n.height);var h=a.getImageData(0,0,r.width,r.height),l=h.data;t/=255,e/=255,i/=255;for(var u=0;u<l.length;u+=4)l[u]=l[u]*t,l[u+1]=l[u+1]*e,l[u+2]=l[u+2]*i;a.putImageData(h,0,0)}if(o)return r;var d=new c;return d.initWithElement(r),d.handleLoadedTexture(),d}}else cc._renderType===s.RENDER_TYPE_WEBGL&&(d.initWithData=function(t,e,i,n,r){var o=this,s=c,a=cc._renderContext,h=a.RGBA,l=a.UNSIGNED_BYTE,u=i*c._B[e]/8;switch(u%8==0?a.pixelStorei(a.UNPACK_ALIGNMENT,8):u%4==0?a.pixelStorei(a.UNPACK_ALIGNMENT,4):u%2==0?a.pixelStorei(a.UNPACK_ALIGNMENT,2):a.pixelStorei(a.UNPACK_ALIGNMENT,1),o._webTextureObj=a.createTexture(),cc.gl.bindTexture2D(o),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),e){case s.PIXEL_FORMAT_RGBA8888:h=a.RGBA;break;case s.PIXEL_FORMAT_RGB888:h=a.RGB;break;case s.PIXEL_FORMAT_RGBA4444:l=a.UNSIGNED_SHORT_4_4_4_4;break;case s.PIXEL_FORMAT_RGB5A1:l=a.UNSIGNED_SHORT_5_5_5_1;break;case s.PIXEL_FORMAT_RGB565:l=a.UNSIGNED_SHORT_5_6_5;break;case s.PIXEL_FORMAT_AI88:h=a.LUMINANCE_ALPHA;break;case s.PIXEL_FORMAT_A8:h=a.ALPHA;break;case s.PIXEL_FORMAT_I8:h=a.LUMINANCE;break;default:cc.assertID(0,3113)}return a.texImage2D(a.TEXTURE_2D,0,h,i,n,0,h,l,t),o._contentSize.width=r.width,o._contentSize.height=r.height,o._pixelWidth=i,o._pixelHeight=n,o._pixelFormat=e,o._hasPremultipliedAlpha=!1,o._hasMipmaps=!1,o._textureLoaded=!0,!0},d.initWithImage=function(t){if(null==t)return cc.logID(3104),!1;var e=t.getWidth(),i=t.getHeight(),n=cc.configuration.getMaxTextureSize();return e>n||i>n?(cc.logID(3105,e,i,n,n),!1):(this._textureLoaded=!0,this._initPremultipliedATextureWithImage(t,e,i))},d.initWithElement=function(t){t&&(this._webTextureObj=cc._renderContext.createTexture(),this._htmlElementObj=t,this._textureLoaded=!0)},d.handleLoadedTexture=function(t){t=!!t;var e=this;if(s._rendererInitialized&&e._htmlElementObj&&e._htmlElementObj.width&&e._htmlElementObj.height){var i=cc._renderContext;cc.gl.bindTexture2D(e),i.pixelStorei(i.UNPACK_ALIGNMENT,4),t&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e._htmlElementObj),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),cc.gl.bindTexture2D(null),t&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0);var n=e._htmlElementObj.width,r=e._htmlElementObj.height;e._pixelWidth=e._contentSize.width=n,e._pixelHeight=e._contentSize.height=r,e._pixelFormat=c.PIXEL_FORMAT_RGBA8888,e._hasPremultipliedAlpha=t,e._hasMipmaps=!1,e._textureLoaded=!0,cc.view._antiAliasEnabled?e.setAntiAliasTexParameters():e.setAliasTexParameters(),e._htmlElementObj=null,e.emit("load")}},d.setTexParameters=function(t,e,i,n){var r=this,s=cc._renderContext;void 0!==e&&(t={minFilter:t,magFilter:e,wrapS:i,wrapT:n}),cc.assertID(r._pixelWidth===o.NextPOT(r._pixelWidth)&&r._pixelHeight===o.NextPOT(r._pixelHeight)||t.wrapS===s.CLAMP_TO_EDGE&&t.wrapT===s.CLAMP_TO_EDGE,3116),cc.gl.bindTexture2D(r),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,t.minFilter),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,t.magFilter),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,t.wrapS),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,t.wrapT)},d.setAntiAliasTexParameters=function(){var t=cc._renderContext;cc.gl.bindTexture2D(this),this._hasMipmaps?t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_NEAREST):t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)},d.setAliasTexParameters=function(){var t=cc._renderContext;cc.gl.bindTexture2D(this),this._hasMipmaps?t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST_MIPMAP_NEAREST):t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)},d.generateMipmap=function(){var t=this;cc.assertID(t._pixelWidth===o.NextPOT(t._pixelWidth)&&t._pixelHeight===o.NextPOT(t._pixelHeight),3117),cc.gl.bindTexture2D(t),cc._renderContext.generateMipmap(cc._renderContext.TEXTURE_2D),t._hasMipmaps=!0},d.stringForFormat=function(){return c._M[this._pixelFormat]},d.bitsPerPixelForFormat=function(t){t=t||this._pixelFormat;var e=c._B[t];return null!=e?e:(cc.logID(3110,t),-1)},d._initPremultipliedATextureWithImage=function(t,e,i){var n,r=c,o=t.getData(),s=null,a=null,h=t.hasAlpha(),l=cc.size(t.getWidth(),t.getHeight()),u=r.defaultPixelFormat,d=t.getBitsPerComponent();h||(d>=8?u=r.PIXEL_FORMAT_RGB888:(cc.logID(3111),u=r.PIXEL_FORMAT_RGB565));var _=e*i;if(u===r.PIXEL_FORMAT_RGB565)if(h)for(o=new Uint16Array(e*i),s=t.getData(),n=0;n<_;++n)o[n]=(s[n]>>0&255)>>3<<11|(s[n]>>8&255)>>2<<5|(s[n]>>16&255)>>3<<0;else for(o=new Uint16Array(e*i),a=t.getData(),n=0;n<_;++n)o[n]=(255&a[n])>>3<<11|(255&a[n])>>2<<5|(255&a[n])>>3<<0;else if(u===r.PIXEL_FORMAT_RGBA4444)for(o=new Uint16Array(e*i),s=t.getData(),n=0;n<_;++n)o[n]=(s[n]>>0&255)>>4<<12|(s[n]>>8&255)>>4<<8|(s[n]>>16&255)>>4<<4|(s[n]>>24&255)>>4<<0;else if(u===r.PIXEL_FORMAT_RGB5A1)for(o=new Uint16Array(e*i),s=t.getData(),n=0;n<_;++n)o[n]=(s[n]>>0&255)>>3<<11|(s[n]>>8&255)>>3<<6|(s[n]>>16&255)>>3<<1|(s[n]>>24&255)>>7<<0;else if(u===r.PIXEL_FORMAT_A8)for(o=new Uint8Array(e*i),s=t.getData(),n=0;n<_;++n)o[n]=s>>24&255;if(h&&u===r.PIXEL_FORMAT_RGB888)for(s=t.getData(),o=new Uint8Array(e*i*3),n=0;n<_;++n)o[3*n]=s>>0&255,o[3*n+1]=s>>8&255,o[3*n+2]=s>>16&255;return this.initWithData(o,u,e,i,l),o!=t.getData()&&(o=null),this._hasPremultipliedAlpha=t.isPremultipliedAlpha(),!0})})),cc.Texture2D=e.exports=c}),{"../CCGame":40,"../assets/CCRawAsset":50,"../event/event-target":110,"../platform/CCClass":146,"../platform/CCSys":155,"../platform/_CCClass":158,"../platform/js":167,"../utils/misc":196}],187:[(function(t,e,i){var n=t("../platform/_CCClass"),r=(t("../platform/js"),t("../CCGame")),o=n.extend({ctor:function(t,e){this.dirty=!1,this.texture=null,this._indices=null,this._buffersVBO=[],this._capacity=0,this._quads=null,this._quadsArrayBuffer=null,this._quadsWebBuffer=null,this._quadsReader=null,cc.js.isString(t)?this.initWithFile(t,e):t instanceof cc.Texture2D&&this.initWithTexture(t,e)},getTotalQuads:function(){return this._totalQuads},getCapacity:function(){return this._capacity},getTexture:function(){return this.texture},setTexture:function(t){this.texture=t},setDirty:function(t){this.dirty=t},isDirty:function(){return this.dirty},getQuads:function(){return this._quads},setQuads:function(t){this._quads=t},_copyQuadsToTextureAtlas:function(t,e){if(t)for(var i=0;i<t.length;i++)this._setQuadToArray(t[i],e+i)},_setQuadToArray:function(t,e){var i=this._quads;i[e]?(i[e].bl=t.bl,i[e].br=t.br,i[e].tl=t.tl,i[e].tr=t.tr):i[e]=new cc.V3F_C4B_T2F_Quad(t.tl,t.bl,t.tr,t.br,this._quadsArrayBuffer,e*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT)},description:function(){return"<cc.TextureAtlas | totalQuads ="+this._totalQuads+">"},_setupIndices:function(){if(0!==this._capacity)for(var t=this._indices,e=this._capacity,i=0;i<e;i++)cc.macro.TEXTURE_ATLAS_USE_TRIANGLE_STRIP?(t[6*i+0]=4*i+0,t[6*i+1]=4*i+0,t[6*i+2]=4*i+2,t[6*i+3]=4*i+1,t[6*i+4]=4*i+3,t[6*i+5]=4*i+3):(t[6*i+0]=4*i+0,t[6*i+1]=4*i+1,t[6*i+2]=4*i+2,t[6*i+3]=4*i+3,t[6*i+4]=4*i+2,t[6*i+5]=4*i+1)},initWithFile:function(t,e){var i=cc.textureCache.addImage(t);return i?this.initWithTexture(i,e):(cc.logID(2900,t),!1)},initWithTexture:function(t,e){cc.assertID(t,2902),e|=0,this._capacity=e,this._totalQuads=0,this.texture=t,this._quads=[],this._indices=new Uint16Array(6*e);var i=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._quadsArrayBuffer=new ArrayBuffer(i*e),this._quadsReader=new Uint8Array(this._quadsArrayBuffer),(!this._quads||!this._indices)&&e>0)return!1;for(var n=this._quads,r=0;r<e;r++)n[r]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,r*i);return this._setupIndices(),this._setupVBO(),this.dirty=!0,!0},updateQuad:function(t,e){cc.assertID(t,2903),cc.assertID(e>=0&&e<this._capacity,2904),this._totalQuads=Math.max(e+1,this._totalQuads),this._setQuadToArray(t,e),this.dirty=!0},insertQuad:function(t,e){if(cc.assertID(e<this._capacity,2905),++this._totalQuads>this._capacity)cc.logID(2901);else{var i=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,n=e*i,r=(this._totalQuads-1-e)*i;this._quads[this._totalQuads-1]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,(this._totalQuads-1)*i),this._quadsReader.set(this._quadsReader.subarray(n,n+r),n+i),this._setQuadToArray(t,e),this.dirty=!0}},insertQuads:function(t,e,i){i=i||t.length,cc.assertID(e+i<=this._capacity,2906);var n=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._totalQuads+=i,this._totalQuads>this._capacity)cc.logID(2901);else{var r,o=e*n,s=(this._totalQuads-1-e-i)*n,a=this._totalQuads-1-i;for(r=0;r<i;r++)this._quads[a+r]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,(this._totalQuads-1)*n);for(this._quadsReader.set(this._quadsReader.subarray(o,o+s),o+n*i),r=0;r<i;r++)this._setQuadToArray(t[r],e+r);this.dirty=!0}},insertQuadFromIndex:function(t,e){if(t!==e){cc.assertID(e>=0||e<this._totalQuads,2907),cc.assertID(t>=0||t<this._totalQuads,2908);var i,n,r=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,o=this._quadsReader,s=o.subarray(t*r,r);t>e?(i=e*r,n=(t-e)*r,o.set(o.subarray(i,i+n),i+r),o.set(s,i)):(i=(t+1)*r,n=(e-t)*r,o.set(o.subarray(i,i+n),i-r),o.set(s,e*r)),this.dirty=!0}},removeQuadAtIndex:function(t){cc.assertID(t<this._totalQuads,2909);var e=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._totalQuads--,this._quads.length=this._totalQuads,t!==this._totalQuads){var i=(t+1)*e,n=(this._totalQuads-t)*e;this._quadsReader.set(this._quadsReader.subarray(i,i+n),i-e)}this.dirty=!0},removeQuadsAtIndex:function(t,e){if(cc.assertID(t+e<=this._totalQuads,2910),this._totalQuads-=e,t!==this._totalQuads){var i=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,n=(t+e)*i,r=(this._totalQuads-t)*i,o=t*i;this._quadsReader.set(this._quadsReader.subarray(n,n+r),o)}this.dirty=!0},removeAllQuads:function(){this._quads.length=0,this._totalQuads=0},_setDirty:function(t){this.dirty=t},resizeCapacity:function(t){if(t===this._capacity)return!0;var e=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,i=this._capacity;this._totalQuads=Math.min(this._totalQuads,t),this._capacity=0|t;var n,r=this._capacity,o=this._totalQuads;if(null===this._quads)for(this._quads=[],this._quadsArrayBuffer=new ArrayBuffer(e*r),this._quadsReader=new Uint8Array(this._quadsArrayBuffer),n=0;n<r;n++)this._quads=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,n*e);else{var s,a,c=this._quads;if(r>i){for(s=[],a=new ArrayBuffer(e*r),n=0;n<o;n++)s[n]=new cc.V3F_C4B_T2F_Quad(c[n].tl,c[n].bl,c[n].tr,c[n].br,a,n*e);for(;n<r;n++)s[n]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,a,n*e);this._quadsReader=new Uint8Array(a),this._quads=s,this._quadsArrayBuffer=a}else{var h=Math.max(o,r);for(s=[],a=new ArrayBuffer(e*r),n=0;n<h;n++)s[n]=new cc.V3F_C4B_T2F_Quad(c[n].tl,c[n].bl,c[n].tr,c[n].br,a,n*e);this._quadsReader=new Uint8Array(a),this._quads=s,this._quadsArrayBuffer=a}}if(null===this._indices)this._indices=new Uint16Array(6*r);else if(r>i){var l=new Uint16Array(6*r);l.set(this._indices,0),this._indices=l}else this._indices=this._indices.subarray(0,6*r);return this._setupIndices(),this._mapBuffers(),this.dirty=!0,!0},increaseTotalQuadsWith:function(t){this._totalQuads+=t},moveQuadsFromIndex:function(t,e,i){if(void 0===i){if(i=e,e=this._totalQuads-t,cc.assertID(i+(this._totalQuads-t)<=this._capacity,2911),0===e)return}else if(cc.assertID(i+e<=this._totalQuads,2912),cc.assertID(t<this._totalQuads,2913),t===i)return;var n,r,o=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,s=t*o,a=e*o,c=this._quadsReader,h=c.subarray(s,s+a),l=i*o;i<t?(n=(t-i)*o,r=i*o,c.set(c.subarray(r,r+n),r+a)):(n=(i-t)*o,r=(t+e)*o,c.set(c.subarray(r,r+n),s)),c.set(h,l),this.dirty=!0},fillWithEmptyQuadsFromIndex:function(t,e){for(var i=e*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,n=new Uint8Array(this._quadsArrayBuffer,t*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,i),r=0;r<i;r++)n[r]=0},_setupVBO:function(){},_mapBuffers:function(){},drawQuads:function(){},drawNumberOfQuads:null,_releaseBuffer:function(){var t=cc._renderContext;this._buffersVBO&&(this._buffersVBO[0]&&t.deleteBuffer(this._buffersVBO[0]),this._buffersVBO[1]&&t.deleteBuffer(this._buffersVBO[1])),this._quadsWebBuffer&&t.deleteBuffer(this._quadsWebBuffer)}}),s=o.prototype;s.totalQuads,cc.defineGetterSetter(s,"totalQuads",s.getTotalQuads),s.capacity,cc.defineGetterSetter(s,"capacity",s.getCapacity),s.quads,cc.defineGetterSetter(s,"quads",s.getQuads,s.setQuads),r.once(r.EVENT_RENDERER_INITED,(function(){cc._renderType===r.RENDER_TYPE_WEBGL&&(o.prototype._setupVBO=function(){var t=this,e=cc._renderContext;t._buffersVBO[0]=e.createBuffer(),t._buffersVBO[1]=e.createBuffer(),t._quadsWebBuffer=e.createBuffer(),t._mapBuffers()},o.prototype._mapBuffers=function(){var t=this,e=cc._renderContext;e.bindBuffer(e.ARRAY_BUFFER,t._quadsWebBuffer),e.bufferData(e.ARRAY_BUFFER,t._quadsArrayBuffer,e.DYNAMIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._buffersVBO[1]),e.bufferData(e.ELEMENT_ARRAY_BUFFER,t._indices,e.STATIC_DRAW)},o.prototype.drawQuads=function(){this.drawNumberOfQuads(this._totalQuads,0)},o.prototype.drawNumberOfQuads=function(t,e){var i=this;if(e=e||0,0!==t&&i.texture&&i.texture.isLoaded()){var n=cc._renderContext;cc.gl.bindTexture2D(i.texture),n.bindBuffer(n.ARRAY_BUFFER,i._quadsWebBuffer),n.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_POSITION),n.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_COLOR),n.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_TEX_COORDS),i.dirty&&(n.bufferData(n.ARRAY_BUFFER,i._quadsArrayBuffer,n.DYNAMIC_DRAW),i.dirty=!1),n.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_POSITION,3,n.FLOAT,!1,24,0),n.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_COLOR,4,n.UNSIGNED_BYTE,!0,24,12),n.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_TEX_COORDS,2,n.FLOAT,!1,24,16),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,i._buffersVBO[1]),cc.macro.TEXTURE_ATLAS_USE_TRIANGLE_STRIP?n.drawElements(n.TRIANGLE_STRIP,6*t,n.UNSIGNED_SHORT,6*e*i._indices.BYTES_PER_ELEMENT):n.drawElements(n.TRIANGLES,6*t,n.UNSIGNED_SHORT,6*e*i._indices.BYTES_PER_ELEMENT),cc.g_NumberOfDraws++}})})),cc.TextureAtlas=e.exports=o}),{"../CCGame":40,"../platform/_CCClass":158,"../platform/js":167}],188:[(function(t,e,i){var n=t("../CCGame"),r=t("./CCTexture2D"),o={_textures:{},_textureColorsCache:{},_textureKeySeq:0|1e3*Math.random(),_loadedTexturesBefore:{},handleLoadedTexture:null,_initializingRenderer:function(){var t,e=this._loadedTexturesBefore,i=this._textures;for(t in e){var n=e[t];n.handleLoadedTexture(),i[t]=n}this._loadedTexturesBefore={}},description:function(){return"<TextureCache | Number of textures = "+this._textures.length+">"},textureForKey:function(t){return cc.logID(3002),this.getTextureForKey(t)},getTextureForKey:function(t){return this._textures[t]},getKeyByTexture:function(t){for(var e in this._textures)if(this._textures[e]===t)return e;return null},_generalTextureKey:function(t){return"_textureKey_"+t},getTextureColors:function(t){var e=t._htmlElementObj,i=this.getKeyByTexture(e);return i||(i=e instanceof HTMLImageElement?e.src:this._generalTextureKey(t.__instanceId)),this._textureColorsCache[i]||(this._textureColorsCache[i]=t._generateTextureCacheForColor()),this._textureColorsCache[i]},getAllTextures:function(){var t=[];for(var e in this._textures){var i=this._textures[e];t.push(i)}return t},removeAllTextures:function(){var t=this._textures;for(var e in t)t[e]&&t[e].releaseTexture();this._textures={}},removeTexture:function(t){if(t){var e=this._textures;for(var i in e)e[i]===t&&(e[i].releaseTexture(),delete e[i])}},removeTextureForKey:function(t){if("string"==typeof t){var e=this._textures;e[t]&&(e[t].releaseTexture(),delete e[t])}},addImage:null,addImageAsync:null,cacheImage:function(t,e){if(cc.assertID(t,3009),e instanceof r)this._textures[t]=e;else{var i=new r;i.initWithElement(e),i.handleLoadedTexture(),this._textures[t]=i}},addUIImage:function(t,e){if(cc.assertID(t,3008),e&&this._textures[e])return this._textures[e];var i=new r;return i.initWithImage(t),null!=e?this._textures[e]=i:cc.logID(3004),i},dumpCachedTextureInfo:function(){var t=0,e=0,i=this._textures;for(var n in i){var r=i[n];t++,r.getHtmlElementObj()instanceof HTMLImageElement?cc.logID(3005,n,r.getHtmlElementObj().src,r.getPixelWidth(),r.getPixelHeight()):cc.logID(3006,n,r.getPixelWidth(),r.getPixelHeight()),e+=r.getPixelWidth()*r.getPixelHeight()*4}var o=this._textureColorsCache;for(n in o){var s=o[n];for(var a in s){var c=s[a];t++,cc.logID(3006,n,c.width,c.height),e+=c.width*c.height*4}}cc.logID(3007,t,e/1024,(e/1048576).toFixed(2))},_clear:function(){this._textures={},this._textureColorsCache={},this._textureKeySeq=0|1e3*Math.random(),this._loadedTexturesBefore={}}};n.once(n.EVENT_RENDERER_INITED,(function(){var t=o;cc._renderType===n.RENDER_TYPE_CANVAS?(t.handleLoadedTexture=function(t){var e=this._textures,i=e[t];i||(cc.assertID(t,3009),(i=e[t]=new r).url=t),i.handleLoadedTexture()},t.addImage=function(t,e,i){cc.assertID(t,3103);var n=this._textures,s=n[t];return s?s.isLoaded()?(e&&e.call(i,s),s):(s.once("load",(function(){e&&e.call(i,s)}),i),s):(s=n[t]=new r,s.url=t,cc.loader.load(t,(function(n,r){if(n)return e&&e.call(i,n||new Error("Unknown error"));o.handleLoadedTexture(t),e&&e.call(i,s)})),s)},t.addImageAsync=t.addImage):cc._renderType===n.RENDER_TYPE_WEBGL&&(t.handleLoadedTexture=function(t){var e,i,n=this._textures;cc.game._rendererInitialized||(n=this._loadedTexturesBefore),(e=n[t])||(cc.assertID(t,3009),(e=n[t]=new r).url=t),i=cc.macro.AUTO_PREMULTIPLIED_ALPHA_FOR_PNG&&".png"===cc.path.extname(t),e.handleLoadedTexture(i)},t.addImage=function(t,e,i){cc.assertID(t,3112);var n=this._textures;cc.game._rendererInitialized||(n=this._loadedTexturesBefore);var s=n[t];return s?s.isLoaded()?(e&&e.call(i,s),s):(s.once("load",(function(){e&&e.call(i,s)}),i),s):(s=n[t]=new r,s.url=t,cc.loader.load(t,(function(n,r){if(n)return e&&e.call(i,n||new Error("Unknown error"));o.handleLoadedTexture(t),e&&e.call(i,s)})),s)},t.addImageAsync=t.addImage)})),cc.textureCache=e.exports=o}),{"../CCGame":40,"./CCTexture2D":186}],189:[(function(t,e,i){t("./CCTexture2D"),t("./CCTextureAtlas"),t("./CCTextureCache")}),{"./CCTexture2D":186,"./CCTextureAtlas":187,"./CCTextureCache":188}],190:[(function(t,e,i){t("../platform/CCSys");var n=/(\.[^\.\/\?\\]*)(\?.*)?$/,r=/[^\.\/]+\/\.\.\//;cc.path={join:function(){for(var t=arguments.length,e="",i=0;i<t;i++)e=(e+(""===e?"":"/")+arguments[i]).replace(/(\/|\\\\)$/,"");return e},extname:function(t){var e=n.exec(t);return e?e[1]:""},mainFileName:function(t){if(t){var e=t.lastIndexOf(".");if(-1!==e)return t.substring(0,e)}return t},basename:function(t,e){var i=t.indexOf("?");i>0&&(t=t.substring(0,i));var n=/(\/|\\\\)([^(\/|\\\\)]+)$/g.exec(t.replace(/(\/|\\\\)$/,""));if(!n)return null;var r=n[2];return e&&t.substring(t.length-e.length).toLowerCase()===e.toLowerCase()?r.substring(0,r.length-e.length):r},dirname:function(t){return t.replace(/((.*)(\/|\\|\\\\))?(.*?\..*$)?/,"$2")},changeExtname:function(t,e){e=e||"";var i=t.indexOf("?"),n="";return i>0&&(n=t.substring(i),t=t.substring(0,i)),(i=t.lastIndexOf("."))<0?t+e+n:t.substring(0,i)+e+n},changeBasename:function(t,e,i){if(0===e.indexOf("."))return this.changeExtname(t,e);var n=t.indexOf("?"),r="",o=i?this.extname(t):"";return n>0&&(r=t.substring(n),t=t.substring(0,n)),n=t.lastIndexOf("/"),n=n<=0?0:n+1,t.substring(0,n)+e+o+r},_normalize:function(t){var e=t=String(t);do{e=t,t=t.replace(r,"")}while(e.length!==t.length);return t},sep:cc.sys.os===cc.sys.OS_WINDOWS?"\\":"/",stripSep:function(t){return t.replace(/[\/\\]$/,"")}},e.exports=cc.path}),{"../platform/CCSys":155}],191:[(function(t,e,i){function n(t){return t?"string"==typeof t?u.getClassByName(t):t:(cc.errorID(3804),null)}function r(t,e){for(var i=0;i<t._components.length;++i){var n=t._components[i];if(n instanceof e)return n}return null}function o(t,e,i){for(var n=0;n<t._components.length;++n){var r=t._components[n];r instanceof e&&i.push(r)}}function s(t,e){for(var i=0;i<t.length;++i){var n=t[i],o=r(n,e);if(o)return o;if(n._children.length>0&&(o=s(n._children,e)))return o}return null}function a(t,e,i){for(var n=0;n<t.length;++n){var r=t[n];o(r,e,i),r._children.length>0&&a(r._children,e,i)}}var c=t("../platform/CCObject").Flags,h=t("./misc"),l=t("../platform/id-generater"),u=cc.js,d=c.Destroying,_=c.DontDestroy,f=new l("Node"),p=cc.Class({name:"cc._BaseNode",extends:cc.Object,mixins:[cc.EventTarget],properties:{_parent:null,_children:[],_tag:cc.macro.NODE_TAG_INVALID,_active:!0,_components:[],_prefab:null,_persistNode:{get:function(){return(this._objFlags&_)>0},set:function(t){t?this._objFlags|=_:this._objFlags&=~_}},name:{get:function(){return this._name},set:function(t){this._name=t}},_id:{default:"",editorOnly:!0},uuid:{get:function(){var t=this._id;return t||(t=this._id=f.getNewId()),t}},children:{get:function(){return this._children}},childrenCount:{get:function(){return this._children.length}},active:{get:function(){return this._active},set:function(t){if(t=!!t,this._active!==t){this._active=t;var e=this._parent;e&&e._activeInHierarchy&&cc.director._nodeActivator.activateNode(this,t)}}},activeInHierarchy:{get:function(){return this._activeInHierarchy}}},ctor:function(t){this._name=void 0!==t?t:"New Node",this._activeInHierarchy=!1,this.__instanceId=this._id||cc.ClassManager.getNewInstanceId(),this.__eventTargets=[]},getTag:function(){return this._tag},setTag:function(t){this._tag=t},getParent:function(){return this._parent},setParent:function(t){if(this._parent!==t){var e=this._parent;if(this._parent=t||null,this._onSetParent(t),t&&(cc.eventManager._setDirtyForNode(this),t._children.push(this),t.emit("child-added",this)),e){if(!(e._objFlags&d)){var i=e._children.indexOf(this);e._children.splice(i,1),e.emit("child-removed",this),this._onHierarchyChanged(e)}}else t&&this._onHierarchyChanged(null)}},init:function(){return!0},attr:function(t){u.mixin(this,t)},getChildByTag:function(t){var e=this._children;if(null!==e)for(var i=0;i<e.length;i++){var n=e[i];if(n&&n._tag===t)return n}return null},getChildByUuid:function(t){if(!t)return cc.log("Invalid uuid"),null;for(var e=this._children,i=0,n=e.length;i<n;i++)if(e[i]._id===t)return e[i];return null},getChildByName:function(t){if(!t)return cc.log("Invalid name"),null;for(var e=this._children,i=0,n=e.length;i<n;i++)if(e[i]._name===t)return e[i];return null},addChild:function(t){cc.assertID(t,1606),cc.assertID(null===t._parent,1605),t.setParent(this)},insertChild:function(t,e){t.parent=this,t.setSiblingIndex(e)},getSiblingIndex:function(){return this._parent?this._parent._children.indexOf(this):0},setSiblingIndex:function(t){if(this._parent){var e=this._parent._children;t=-1!==t?t:e.length-1;var i=e.indexOf(this);t!==i&&(e.splice(i,1),t<e.length?e.splice(t,0,this):e.push(this),this._onSiblingIndexChanged&&this._onSiblingIndexChanged(t))}},cleanup:function(){},removeFromParent:function(t){this._parent&&(void 0===t&&(t=!0),this._parent.removeChild(this,t))},removeChild:function(t,e){this._children.indexOf(t)>-1&&((e||void 0===e)&&t.cleanup(),t.parent=null)},removeChildByTag:function(t,e){t===cc.macro.NODE_TAG_INVALID&&cc.logID(1609);var i=this.getChildByTag(t);i?this.removeChild(i,e):cc.logID(1610,t)},removeAllChildren:function(t){var e=this._children;void 0===t&&(t=!0);for(var i=e.length-1;i>=0;i--){var n=e[i];n&&(t&&n.cleanup(),n.parent=null)}this._children.length=0},isChildOf:function(t){var e=this;do{if(e===t)return!0;e=e._parent}while(e);return!1},getComponent:function(t){var e=n(t);return e?r(this,e):null},getComponents:function(t){var e=n(t),i=[];return e&&o(this,e,i),i},getComponentInChildren:function(t){var e=n(t);return e?s(this._children,e):null},getComponentsInChildren:function(t){var e=n(t),i=[];return e&&(o(this,e,i),a(this._children,e,i)),i},_checkMultipleComp:!1,addComponent:function(t){var e;if("string"==typeof t){if(!(e=u.getClassByName(t)))return cc.errorID(3807,t),cc._RFpeek()&&cc.errorID(3808,t),null}else{if(!t)return cc.errorID(3804),null;e=t}if("function"!=typeof e)return cc.errorID(3809),null;if(!cc.isChildClassOf(e,cc.Component))return cc.errorID(3810),null;var i=e._requireComponent;if(i&&!this.getComponent(i)&&!this.addComponent(i))return null;var n=new e;return n.node=this,this._components.push(n),this._activeInHierarchy&&cc.director._nodeActivator.activateComp(n),n},_addComponentAt:!1,removeComponent:function(t){t?(t instanceof cc.Component||(t=this.getComponent(t)),t&&t.destroy()):cc.errorID(3813)},_getDependComponent:!1,_removeComponent:function(t){if(t){if(!(this._objFlags&d)){var e=this._components.indexOf(t);-1!==e?this._components.splice(e,1):t.node!==this&&cc.errorID(3815)}}else cc.errorID(3814)},_disableChildComps:function(){var t,e=this._components.length;for(t=0;t<e;++t){var i=this._components[t];i._enabled&&cc.director._compScheduler.disableComp(i)}for(t=0,e=this._children.length;t<e;++t){var n=this._children[t];n._active&&n._disableChildComps()}},destroy:function(){cc.Object.prototype.destroy.call(this)&&this._activeInHierarchy&&this._disableChildComps()},destroyAllChildren:function(){for(var t=this._children,e=0;e<t.length;++e)t[e].destroy()},_onSetParent:function(t){},_onPostActivated:function(){},_onHierarchyChanged:function(t){var e=this._parent;!this._persistNode||e instanceof cc.Scene||cc.game.removePersistRootNode(this);var i=this._active&&!(!e||!e._activeInHierarchy);this._activeInHierarchy!==i&&cc.director._nodeActivator.activateNode(this,i)},_onBatchCreated:function(){var t=this._prefab;t&&t.sync&&!t._synced&&t.root===this&&PrefabHelper.syncWithPrefab(this);for(var e=this._children,i=0,n=e.length;i<n;i++)e[i]._onBatchCreated()},_instantiate:function(t){t||(t=cc.instantiate._clone(this,this));var e=this._prefab;return e&&this===e.root&&e.sync&&(t._prefab._synced=e._synced),t._parent=null,t._onBatchCreated(),t},_registerIfAttached:!1,_onPreDestroy:function(){var t,e;this._objFlags|=d;var i=this._parent,n=i&&i._objFlags&d,r=this._children;for(t=0,e=r.length;t<e;++t)r[t]._destroyImmediate();for(t=0,e=this._components.length;t<e;++t)this._components[t]._destroyImmediate();var o=this.__eventTargets;for(t=0,e=o.length;t<e;++t){var s=o[t];s&&s.targetOff(this)}if(o.length=0,this._persistNode&&cc.game.removePersistRootNode(this),!n&&i){var a=i._children.indexOf(this);i._children.splice(a,1),i.emit("child-removed",this)}return n},onRestore:!1});p.prototype._onPreDestroyBase=p.prototype._onPreDestroy,p.prototype._onHierarchyChangedBase=p.prototype._onHierarchyChanged;var g=["name","children","childrenCount"];h.propertyDefine(p,g,{}),cc._BaseNode=e.exports=p}),{"../platform/CCObject":152,"../platform/id-generater":163,"./misc":196}],192:[(function(t,e,i){var n=1e-6;e.exports={binarySearchEpsilon:function(t,e){for(var i=0,r=t.length-1,o=r>>>1;i<=r;o=i+r>>>1){var s=t[o];if(s>e+n)r=o-1;else{if(!(s<e-n))return o;i=o+1}}return~i}}}),{}],193:[(function(t,e,i){var n=t("./misc").BASE64_VALUES,r="0123456789abcdef".split(""),o=["","","",""],s=o.concat(o,"-",o,"-",o,"-",o,"-",o,o,o),a=s.map((function(t,e){return"-"===t?NaN:e})).filter(isFinite);e.exports=function(t){if(22!==t.length)return t;s[0]=t[0],s[1]=t[1];for(var e=2,i=2;e<22;e+=2){var o=n[t.charCodeAt(e)],c=n[t.charCodeAt(e+1)];s[a[i++]]=r[o>>2],s[a[i++]]=r[(3&o)<<2|c>>4],s[a[i++]]=r[15&c]}return s.join("")}}),{"./misc":196}],194:[(function(t,e,i){cc.find=e.exports=function(t,e){if(null==t)return cc.errorID(5600),null;if(!e){var i=cc.director.getScene();if(!i)return null;e=i}for(var n=e,r="/"!==t[0]?0:1,o=t.split("/"),s=r;s<o.length;s++){var a=o[s],c=n._children;n=null;for(var h=0,l=c.length;h<l;++h){var u=c[h];if(u.name===a){n=u;break}}if(!n)return null}return n}}),{}],195:[(function(t,e,i){t("./CCPath"),t("./find"),t("./mutable-forward-iterator")}),{"./CCPath":190,"./find":194,"./mutable-forward-iterator":197}],196:[(function(t,e,i){var n=t("../platform/js"),r=t("../platform/CCSys"),o=i;o.propertyDefine=function(t,e,i){function n(t,e,i,n){var r=Object.getOwnPropertyDescriptor(t,e);if(r)r.get&&(t[i]=r.get),r.set&&n&&(t[n]=r.set);else{var o=t[i];cc.js.getset(t,e,o,t[n])}}for(var r,o=t.prototype,s=0;s<e.length;s++){var a=(r=e[s])[0].toUpperCase()+r.slice(1);n(o,r,"get"+a,"set"+a)}for(r in i){var c=i[r];n(o,r,c[0],c[1])}},o.NextPOT=function(t){return t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1},o.imagePool=new n.Pool(function(t){return t instanceof HTMLImageElement&&(t.src=this._smallImg,!0)},10),o.imagePool.get=function(){return this._get()||new Image},o.imagePool._smallImg="data:image/gif;base64,R0lGODlhAQABAAAAACwAAAAAAQABAAA=",r.os!==r.OS_WINDOWS&&r.os!==r.OS_LINUX||r.browser===r.BROWSER_TYPE_CHROME||o.imagePool.resize(0),o.BUILTIN_CLASSID_RE=/^(?:cc|dragonBones|sp|ccsg)\..+/;for(var s=new Array(123),a=0;a<123;++a)s[a]=64;for(var c=0;c<64;++c)s["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charCodeAt(c)]=c;o.BASE64_VALUES=s,o.pushToMap=function(t,e,i,n){var r=t[e];r?Array.isArray(r)?n?(r.push(r[0]),r[0]=i):r.push(i):t[e]=n?[i,r]:[r,i]:t[e]=i}}),{"../platform/CCSys":155,"../platform/js":167}],197:[(function(t,e,i){function n(t){this.i=0,this.array=t}var r=n.prototype;r.remove=function(t){var e=this.array.indexOf(t);e>=0&&this.removeAt(e)},r.removeAt=function(t){this.array.splice(t,1),t<=this.i&&--this.i},r.fastRemove=function(t){var e=this.array.indexOf(t);e>=0&&this.fastRemoveAt(e)},r.fastRemoveAt=function(t){var e=this.array;e[t]=e[e.length-1],--e.length,t<=this.i&&--this.i},r.push=function(t){this.array.push(t)},e.exports=n}),{}],198:[(function(t,e,i){cc._PrefabInfo=cc.Class({name:"cc.PrefabInfo",properties:{root:null,asset:null,fileId:"",sync:!1,_synced:{default:!1,serializable:!1}}}),e.exports={syncWithPrefab:function(t){var e=t._prefab;if(e._synced=!0,!e.asset)return cc.errorID(3701,t.name),void(t._prefab=null);var i=t._objFlags,n=t._parent,r=t._id,o=t._name,s=t._active,a=t._position.x,c=t._position.y,h=t._rotationX,l=t._rotationY,u=t._localZOrder,d=t._globalZOrder;cc.game._isCloning=!0,e.asset._doInstantiate(t),cc.game._isCloning=!1,t._objFlags=i,t._parent=n,t._id=r,t._prefab=e,t._name=o,t._active=s,t._position.x=a,t._position.y=c,t._rotationX=h,t._rotationY=l,t._localZOrder=u,t._globalZOrder=d}}}),{}],199:[(function(t,e,i){var n={removeSgNode:function(){var t=this._sgNode;if(t){var e=t._parent;e&&e.removeChild(t),t.release(),this._sgNode._entity&&(this._sgNode._entity=null)}}};e.exports=n}),{}],200:[(function(t,e,i){cc.AffineTransform=function(t,e,i,n,r,o){this.a=t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=o},cc.affineTransformMake=function(t,e,i,n,r,o){return{a:t,b:e,c:i,d:n,tx:r,ty:o}},cc.affineTransformClone=function(t){return{a:t.a,b:t.b,c:t.c,d:t.d,tx:t.tx,ty:t.ty}},cc.pointApplyAffineTransform=function(t,e,i){var n,r;return void 0===i?(i=e,n=t.x,r=t.y):(n=t,r=e),{x:i.a*n+i.c*r+i.tx,y:i.b*n+i.d*r+i.ty}},cc._pointApplyAffineTransformIn=function(t,e,i,n){var r,o,s;void 0===n?(s=e,r=t.x,o=t.y,n=i):(r=t,o=e,s=i),n.x=s.a*r+s.c*o+s.tx,n.y=s.b*r+s.d*o+s.ty},cc._pointApplyAffineTransform=function(t,e,i){return cc.pointApplyAffineTransform(t,e,i)},cc.sizeApplyAffineTransform=function(t,e){return{width:e.a*t.width+e.c*t.height,height:e.b*t.width+e.d*t.height}},cc.affineTransformMakeIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},cc.affineTransformIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},cc.rectApplyAffineTransform=function(t,e){var i=t.x,n=t.y,r=i+t.width,o=n+t.height,s=e.a*i+e.c*n+e.tx,a=e.b*i+e.d*n+e.ty,c=e.a*r+e.c*n+e.tx,h=e.b*r+e.d*n+e.ty,l=e.a*i+e.c*o+e.tx,u=e.b*i+e.d*o+e.ty,d=e.a*r+e.c*o+e.tx,_=e.b*r+e.d*o+e.ty,f=Math.min(s,c,l,d),p=Math.max(s,c,l,d),g=Math.min(a,h,u,_),v=Math.max(a,h,u,_);return cc.rect(f,g,p-f,v-g)},cc._rectApplyAffineTransformIn=function(t,e){var i=t.x,n=t.y,r=i+t.width,o=n+t.height,s=e.a*i+e.c*n+e.tx,a=e.b*i+e.d*n+e.ty,c=e.a*r+e.c*n+e.tx,h=e.b*r+e.d*n+e.ty,l=e.a*i+e.c*o+e.tx,u=e.b*i+e.d*o+e.ty,d=e.a*r+e.c*o+e.tx,_=e.b*r+e.d*o+e.ty,f=Math.min(s,c,l,d),p=Math.max(s,c,l,d),g=Math.min(a,h,u,_),v=Math.max(a,h,u,_);return t.x=f,t.y=g,t.width=p-f,t.height=v-g,t},cc.obbApplyAffineTransform=function(t,e,i,n,r,o){var s=t.x,a=t.y,c=t.width,h=t.height,l=e.a*s+e.c*a+e.tx,u=e.b*s+e.d*a+e.ty,d=e.a*c,_=e.b*c,f=e.c*h,p=e.d*h;n.x=l,n.y=u,r.x=d+l,r.y=_+u,i.x=f+l,i.y=p+u,o.x=d+f+l,o.y=_+p+u},cc.affineTransformTranslate=function(t,e,i){return{a:t.a,b:t.b,c:t.c,d:t.d,tx:t.tx+t.a*e+t.c*i,ty:t.ty+t.b*e+t.d*i}},cc.affineTransformScale=function(t,e,i){return{a:t.a*e,b:t.b*e,c:t.c*i,d:t.d*i,tx:t.tx,ty:t.ty}},cc.affineTransformRotate=function(t,e){var i=Math.sin(e),n=Math.cos(e);return{a:t.a*n+t.c*i,b:t.b*n+t.d*i,c:t.c*n-t.a*i,d:t.d*n-t.b*i,tx:t.tx,ty:t.ty}},cc.affineTransformConcat=function(t,e){return{a:t.a*e.a+t.b*e.c,b:t.a*e.b+t.b*e.d,c:t.c*e.a+t.d*e.c,d:t.c*e.b+t.d*e.d,tx:t.tx*e.a+t.ty*e.c+e.tx,ty:t.tx*e.b+t.ty*e.d+e.ty}},cc.affineTransformConcatIn=function(t,e){var i=t.a,n=t.b,r=t.c,o=t.d,s=t.tx,a=t.ty;return t.a=i*e.a+n*e.c,t.b=i*e.b+n*e.d,t.c=r*e.a+o*e.c,t.d=r*e.b+o*e.d,t.tx=s*e.a+a*e.c+e.tx,t.ty=s*e.b+a*e.d+e.ty,t},cc.affineTransformEqualToTransform=function(t,e){return t.a===e.a&&t.b===e.b&&t.c===e.c&&t.d===e.d&&t.tx===e.tx&&t.ty===e.ty},cc.affineTransformInvert=function(t){var e=1/(t.a*t.d-t.b*t.c);return{a:e*t.d,b:-e*t.b,c:-e*t.c,d:e*t.a,tx:e*(t.c*t.ty-t.d*t.tx),ty:e*(t.b*t.tx-t.a*t.ty)}},cc.affineTransformInvertOut=function(t,e){var i=t.a,n=t.b,r=t.c,o=t.d,s=1/(i*o-n*r);e.a=s*o,e.b=-s*n,e.c=-s*r,e.d=s*i,e.tx=s*(r*t.ty-o*t.tx),e.ty=s*(n*t.tx-i*t.ty)}}),{}],201:[(function(t,e,i){var n=t("./CCValueType"),r=t("../platform/js"),o=(function(){function e(t,e,i,n){"object"==typeof t&&(e=t.g,i=t.b,n=t.a,t=t.r),t=t||0,e=e||0,i=i||0,n="number"==typeof n?n:255,this._val=(~~t<<24>>>0)+(~~e<<16)+(~~i<<8)+~~n}r.extend(e,n),t("../platform/CCClass").fastDefine("cc.Color",e,{r:0,g:0,b:0,a:255});var i={WHITE:[255,255,255,255],BLACK:[0,0,0,255],TRANSPARENT:[0,0,0,0],GRAY:[127.5,127.5,127.5],RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,235,4],ORANGE:[255,127,0],CYAN:[0,255,255],MAGENTA:[255,0,255]};for(var o in i)r.get(e,o,(function(t){return function(){return new e(t[0],t[1],t[2],t[3])}})(i[o]));var s=e.prototype;return s.clone=function(){var t=new e;return t._val=this._val,t},s.equals=function(t){return t&&this._val===t._val},s.lerp=function(t,i,n){n=n||new e;var r=this.r,o=this.g,s=this.b,a=this.a;return n.r=r+(t.r-r)*i,n.g=o+(t.g-o)*i,n.b=s+(t.b-s)*i,n.a=a+(t.a-a)*i,n},s.toString=function(){return"rgba("+this.r.toFixed()+", "+this.g.toFixed()+", "+this.b.toFixed()+", "+this.a.toFixed()+")"},s.getR=function(){return(4278190080&this._val)>>>24},s.setR=function(t){return this._val=(16777215&this._val|~~t<<24>>>0)>>>0,this},s.getG=function(){return(16711680&this._val)>>16},s.setG=function(t){return this._val=(4278255615&this._val|~~t<<16)>>>0,this},s.getB=function(){return(65280&this._val)>>8},s.setB=function(t){return this._val=(4294902015&this._val|~~t<<8)>>>0,this},s.getA=function(){return 255&this._val},s.setA=function(t){return this._val=(4294967040&this._val|~~t)>>>0,this},r.getset(s,"r",s.getR,s.setR,!0),r.getset(s,"g",s.getG,s.setG,!0),r.getset(s,"b",s.getB,s.setB,!0),r.getset(s,"a",s.getA,s.setA,!0),s.toCSS=function(t){return"rgba"===t?"rgba("+(0|this.r)+","+(0|this.g)+","+(0|this.b)+","+(this.a/255).toFixed(2)+")":"rgb"===t?"rgb("+(0|this.r)+","+(0|this.g)+","+(0|this.b)+")":"#"+this.toHEX(t)},s.clamp=function(){},s.fromHEX=function(t){t.length<8&&(t+="FF");var e=parseInt(t.indexOf("#")>-1?t.substring(1):t,16);return this._val=(0&this._val|e)>>>0,this},s.toHEX=function(t){var e=[(0|this.r).toString(16),(0|this.g).toString(16),(0|this.b).toString(16)],i=-1;if("#rgb"===t)for(i=0;i<e.length;++i)e[i].length>1&&(e[i]=e[i][0]);else if("#rrggbb"===t)for(i=0;i<e.length;++i)1===e[i].length&&(e[i]="0"+e[i]);return e.join("")},s.toRGBValue=function(){return 16777215&this._val},s.fromHSV=function(t,i,n){var r=e.hsv2rgb(t,i,n);return this._val=(r.r<<24>>>0)+(r.g<<16)+(r.b<<8)+this.a,this},s.toHSV=function(){return e.rgb2hsv(this.r,this.g,this.b)},s.fromColor=function(t){t._val?this._val=t._val:(this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a)},e})();o.rgb2hsv=function(t,e,i){t/=255,e/=255,i/=255;var n={h:0,s:0,v:0},r=Math.max(t,e,i),o=Math.min(t,e,i),s=0;return n.v=r,n.s=r?(r-o)/r:0,n.s?(s=r-o,n.h=t===r?(e-i)/s:e===r?2+(i-t)/s:4+(t-e)/s,n.h/=6,n.h<0&&(n.h+=1)):n.h=0,n},o.hsv2rgb=function(t,e,i){var n={r:0,g:0,b:0};if(0===e)n.r=n.g=n.b=i;else if(0===i)n.r=n.g=n.b=0;else{1===t&&(t=0),t*=6,e=e,i=i;var r=Math.floor(t),o=t-r,s=i*(1-e),a=i*(1-e*o),c=i*(1-e*(1-o));switch(r){case 0:n.r=i,n.g=c,n.b=s;break;case 1:n.r=a,n.g=i,n.b=s;break;case 2:n.r=s,n.g=i,n.b=c;break;case 3:n.r=s,n.g=a,n.b=i;break;case 4:n.r=c,n.g=s,n.b=i;break;case 5:n.r=i,n.g=s,n.b=a}}return n.r*=255,n.g*=255,n.b*=255,n},cc.Color=o,cc.color=function(t,e,i,n){return"string"==typeof t?(new cc.Color).fromHEX(t):"object"==typeof t?new cc.Color(t.r,t.g,t.b,t.a):new cc.Color(t,e,i,n)},cc.colorEqual=function(t,e){return void 0!==t._val&&void 0!==e._val?t._val===e._val:t.r===e.r&&t.g===e.g&&t.b===e.b},cc.hexToColor=function(t){t=t.replace(/^#?/,"0x");var e=parseInt(t),i=e>>16,n=(65280&e)>>8,r=255&e;return cc.color(i,n,r)},cc.colorToHex=function(t){var e=t.r.toString(16),i=t.g.toString(16),n=t.b.toString(16);return"#"+(t.r<16?"0"+e:e)+(t.g<16?"0"+i:i)+(t.b<16?"0"+n:n)},e.exports=cc.Color}),{"../platform/CCClass":146,"../platform/js":167,"./CCValueType":207}],202:[(function(t,e,i){var n=parseFloat("1.192092896e-07F");cc.pNeg=function(t){return cc.p(-t.x,-t.y)},cc.pAdd=function(t,e){return cc.p(t.x+e.x,t.y+e.y)},cc.pSub=function(t,e){return cc.p(t.x-e.x,t.y-e.y)},cc.pMult=function(t,e){return cc.p(t.x*e,t.y*e)},cc.pMidpoint=function(t,e){return cc.pMult(cc.pAdd(t,e),.5)},cc.pDot=function(t,e){return t.x*e.x+t.y*e.y},cc.pCross=function(t,e){return t.x*e.y-t.y*e.x},cc.pPerp=function(t){return cc.p(-t.y,t.x)},cc.pRPerp=function(t){return cc.p(t.y,-t.x)},cc.pProject=function(t,e){return cc.pMult(e,cc.pDot(t,e)/cc.pDot(e,e))},cc.pLengthSQ=function(t){return cc.pDot(t,t)},cc.pDistanceSQ=function(t,e){return cc.pLengthSQ(cc.pSub(t,e))},cc.pLength=function(t){return Math.sqrt(cc.pLengthSQ(t))},cc.pDistance=function(t,e){return cc.pLength(cc.pSub(t,e))},cc.pNormalize=function(t){var e=cc.pLength(t);return 0===e?cc.p(t):cc.pMult(t,1/e)},cc.pForAngle=function(t){return cc.p(Math.cos(t),Math.sin(t))},cc.pToAngle=function(t){return Math.atan2(t.y,t.x)},cc.clampf=function(t,e,i){if(e>i){var n=e;e=i,i=n}return t<e?e:t<i?t:i},cc.clamp01=function(t){return t<0?0:t<1?t:1},cc.pClamp=function(t,e,i){return cc.p(cc.clampf(t.x,e.x,i.x),cc.clampf(t.y,e.y,i.y))},cc.pFromSize=function(t){return cc.p(t.width,t.height)},cc.pCompOp=function(t,e){return cc.p(e(t.x),e(t.y))},cc.pLerp=function(t,e,i){return cc.pAdd(cc.pMult(t,1-i),cc.pMult(e,i))},cc.pFuzzyEqual=function(t,e,i){return t.x-i<=e.x&&e.x<=t.x+i&&t.y-i<=e.y&&e.y<=t.y+i},cc.pCompMult=function(t,e){return cc.p(t.x*e.x,t.y*e.y)},cc.pAngleSigned=function(t,e){var i=cc.pNormalize(t),r=cc.pNormalize(e),o=Math.atan2(i.x*r.y-i.y*r.x,cc.pDot(i,r));return Math.abs(o)<n?0:o},cc.pAngle=function(t,e){var i=Math.acos(cc.pDot(cc.pNormalize(t),cc.pNormalize(e)));return Math.abs(i)<n?0:i},cc.pRotateByAngle=function(t,e,i){var n=cc.pSub(t,e),r=Math.cos(i),o=Math.sin(i),s=n.x;return n.x=s*r-n.y*o+e.x,n.y=s*o+n.y*r+e.y,n},cc.pLineIntersect=function(t,e,i,n,r){if(t.x===e.x&&t.y===e.y||i.x===n.x&&i.y===n.y)return!1;var o=e.x-t.x,s=e.y-t.y,a=n.x-i.x,c=n.y-i.y,h=t.x-i.x,l=t.y-i.y,u=c*o-a*s;return r.x=a*l-c*h,r.y=o*l-s*h,0===u?0===r.x||0===r.y:(r.x=r.x/u,r.y=r.y/u,!0)},cc.pSegmentIntersect=function(t,e,i,n){var r=cc.p(0,0);return!!(cc.pLineIntersect(t,e,i,n,r)&&r.x>=0&&r.x<=1&&r.y>=0&&r.y<=1)},cc.pIntersectPoint=function(t,e,i,n){var r=cc.p(0,0);if(cc.pLineIntersect(t,e,i,n,r)){var o=cc.p(0,0);return o.x=t.x+r.x*(e.x-t.x),o.y=t.y+r.x*(e.y-t.y),o}return cc.p(0,0)},cc.pSameAs=function(t,e){return null!=t&&null!=e&&(t.x===e.x&&t.y===e.y)},cc.pZeroIn=function(t){t.x=0,t.y=0},cc.pIn=function(t,e){t.x=e.x,t.y=e.y},cc.pMultIn=function(t,e){t.x*=e,t.y*=e},cc.pSubIn=function(t,e){t.x-=e.x,t.y-=e.y},cc.pAddIn=function(t,e){t.x+=e.x,t.y+=e.y},cc.pNormalizeIn=function(t){cc.pMultIn(t,1/Math.sqrt(t.x*t.x+t.y*t.y))}}),{}],203:[(function(t,e,i){function n(t,e,i,n){t&&"object"==typeof t&&(e=t.y,i=t.width,n=t.height,t=t.x),this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0}var r=t("./CCValueType"),o=t("../platform/js");o.extend(n,r),t("../platform/CCClass").fastDefine("cc.Rect",n,{x:0,y:0,width:0,height:0}),n.fromMinMax=function(t,e){var i=Math.min(t.x,e.x),r=Math.min(t.y,e.y);return new n(i,r,Math.max(t.x,e.x)-i,Math.max(t.y,e.y)-r)},n.contain=function(t,e){return t.x<e.x&&t.x+t.width>e.x+e.width&&t.y<e.y&&t.y+t.height>e.y+e.height?1:e.x<t.x&&e.x+e.width>t.x+t.width&&e.y<t.y&&e.y+e.height>t.y+t.height?-1:0};var s=n.prototype;s.clone=function(){return new n(this.x,this.y,this.width,this.height)},s.equals=function(t){return t&&this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height},s.lerp=function(t,e,i){i=i||new n;var r=this.x,o=this.y,s=this.width,a=this.height;return i.x=r+(t.x-r)*e,i.y=o+(t.y-o)*e,i.width=s+(t.width-s)*e,i.height=a+(t.height-a)*e,i},s.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width.toFixed(2)+", "+this.height.toFixed(2)+")"},o.getset(s,"xMin",(function(){return this.x}),(function(t){this.width+=this.x-t,this.x=t})),o.getset(s,"yMin",(function(){return this.y}),(function(t){this.height+=this.y-t,this.y=t})),o.getset(s,"xMax",(function(){return this.x+this.width}),(function(t){this.width=t-this.x})),o.getset(s,"yMax",(function(){return this.y+this.height}),(function(t){this.height=t-this.y})),o.getset(s,"center",(function(){return new cc.Vec2(this.x+.5*this.width,this.y+.5*this.height)}),(function(t){this.x=t.x-.5*this.width,this.y=t.y-.5*this.height})),o.getset(s,"origin",(function(){return new cc.Vec2(this.x,this.y)}),(function(t){this.x=t.x,this.y=t.y})),o.getset(s,"size",(function(){return new cc.Size(this.width,this.height)}),(function(t){this.width=t.width,this.height=t.height})),s.intersects=function(t){return cc.rectIntersectsRect(this,t)},s.contains=function(t){return this.x<=t.x&&this.x+this.width>=t.x&&this.y<=t.y&&this.y+this.height>=t.y},s.containsRect=function(t){return this.x<=t.x&&this.x+this.width>=t.x+t.width&&this.y<=t.y&&this.y+this.height>=t.y+t.height},cc.Rect=n,cc.rect=function(t,e,i,r){return new n(t,e,i,r)},cc.rectEqualToRect=function(t,e){return t&&e&&t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height},cc._rectEqualToZero=function(t){return t&&0===t.x&&0===t.y&&0===t.width&&0===t.height},cc.rectContainsRect=function(t,e){return!(!t||!e)&&!(t.x>=e.x||t.y>=e.y||t.x+t.width<=e.x+e.width||t.y+t.height<=e.y+e.height)},cc.rectGetMaxX=function(t){return t.x+t.width},cc.rectGetMidX=function(t){return t.x+t.width/2},cc.rectGetMinX=function(t){return t.x},cc.rectGetMaxY=function(t){return t.y+t.height},cc.rectGetMidY=function(t){return t.y+t.height/2},cc.rectGetMinY=function(t){return t.y},cc.rectContainsPoint=function(t,e){return e.x>=cc.rectGetMinX(t)&&e.x<=cc.rectGetMaxX(t)&&e.y>=cc.rectGetMinY(t)&&e.y<=cc.rectGetMaxY(t)},cc.rectIntersectsRect=function(t,e){var i=t.x+t.width,n=t.y+t.height,r=e.x+e.width,o=e.y+e.height;return!(i<e.x||r<t.x||n<e.y||o<t.y)},cc.rectOverlapsRect=function(t,e){return!(t.x+t.width<e.x||e.x+e.width<t.x||t.y+t.height<e.y||e.y+e.height<t.y)},cc.rectUnion=function(t,e){var i=cc.rect(0,0,0,0);return i.x=Math.min(t.x,e.x),i.y=Math.min(t.y,e.y),i.width=Math.max(t.x+t.width,e.x+e.width)-i.x,i.height=Math.max(t.y+t.height,e.y+e.height)-i.y,i},cc.rectIntersection=function(t,e){var i=cc.rect(Math.max(cc.rectGetMinX(t),cc.rectGetMinX(e)),Math.max(cc.rectGetMinY(t),cc.rectGetMinY(e)),0,0);return i.width=Math.min(cc.rectGetMaxX(t),cc.rectGetMaxX(e))-cc.rectGetMinX(i),i.height=Math.min(cc.rectGetMaxY(t),cc.rectGetMaxY(e))-cc.rectGetMinY(i),i},e.exports=cc.Rect}),{"../platform/CCClass":146,"../platform/js":167,"./CCValueType":207}],204:[(function(t,e,i){function n(t,e){t&&"object"==typeof t&&(e=t.height,t=t.width),this.width=t||0,this.height=e||0}var r=t("./CCValueType"),o=t("../platform/js");o.extend(n,r),t("../platform/CCClass").fastDefine("cc.Size",n,{width:0,height:0}),o.get(n,"ZERO",(function(){return new n(0,0)}));var s=n.prototype;s.clone=function(){return new n(this.width,this.height)},s.equals=function(t){return t&&this.width===t.width&&this.height===t.height},s.lerp=function(t,e,i){i=i||new n;var r=this.width,o=this.height;return i.width=r+(t.width-r)*e,i.height=o+(t.height-o)*e,i},s.toString=function(){return"("+this.width.toFixed(2)+", "+this.height.toFixed(2)+")"},cc.size=function(t,e){return new n(t,e)},cc.sizeEqualToSize=function(t,e){return t&&e&&t.width===e.width&&t.height===e.height},cc.Size=e.exports=n}),{"../platform/CCClass":146,"../platform/js":167,"./CCValueType":207}],205:[(function(t,e,i){cc.Acceleration=function(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.timestamp=n||0},cc.BlendFunc=function(t,e){this.src=t,this.dst=e};var n=cc.Enum({ONE:1,ZERO:0,SRC_ALPHA:770,SRC_COLOR:768,DST_ALPHA:772,DST_COLOR:774,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775});cc.BlendFunc._disable=function(){return new cc.BlendFunc(n.ONE,n.ZERO)},cc.BlendFunc._alphaPremultiplied=function(){return new cc.BlendFunc(n.ONE,n.ONE_MINUS_SRC_ALPHA)},cc.BlendFunc._alphaNonPremultiplied=function(){return new cc.BlendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA)},cc.BlendFunc._additive=function(){return new cc.BlendFunc(n.SRC_ALPHA,n.ONE)},cc.BlendFunc.BlendFactor=n,cc.BlendFunc.DISABLE,cc.js.get(cc.BlendFunc,"DISABLE",cc.BlendFunc._disable),cc.BlendFunc.ALPHA_PREMULTIPLIED,cc.js.get(cc.BlendFunc,"ALPHA_PREMULTIPLIED",cc.BlendFunc._alphaPremultiplied),cc.BlendFunc.ALPHA_NON_PREMULTIPLIED,cc.js.get(cc.BlendFunc,"ALPHA_NON_PREMULTIPLIED",cc.BlendFunc._alphaNonPremultiplied),cc.BlendFunc.ADDITIVE,cc.js.get(cc.BlendFunc,"ADDITIVE",cc.BlendFunc._additive),cc.blendFuncDisable=cc.BlendFunc._disable,cc.FontDefinition=function(t){var e=this;if(e.fontName="Arial",e.fontSize=12,e.textAlign=cc.TextAlignment.CENTER,e.verticalAlign=cc.VerticalTextAlignment.TOP,e.fillStyle=cc.color(255,255,255,255),e.boundingWidth=0,e.boundingHeight=0,e.strokeEnabled=!1,e.strokeStyle=cc.color(255,255,255,255),e.lineWidth=1,e.lineHeight="normal",e.fontStyle="normal",e.fontWeight="normal",e.shadowEnabled=!1,e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=0,e.shadowOpacity=1,t&&t instanceof Object)for(var i in t)e[i]=t[i]},cc.FontDefinition.prototype._getCanvasFontStr=function(){var t=this.lineHeight.charAt?this.lineHeight:this.lineHeight+"px";return this.fontStyle+" "+this.fontWeight+" "+this.fontSize+"px/"+t+" '"+this.fontName+"'"},cc.TextAlignment=cc.Enum({LEFT:0,CENTER:1,RIGHT:2}),cc.VerticalTextAlignment=cc.Enum({TOP:0,CENTER:1,BOTTOM:2}),cc._Dictionary=cc.Class({ctor:function(){this._keyMapTb={},this._valueMapTb={},this.__currId=2<<(0|10*Math.random())},__getKey:function(){return"key_"+ ++this.__currId},setObject:function(t,e){if(null!=e){var i=this.__getKey();this._keyMapTb[i]=e,this._valueMapTb[i]=t}},objectForKey:function(t){if(null==t)return null;var e=this._keyMapTb;for(var i in e)if(e[i]===t)return this._valueMapTb[i];return null},valueForKey:function(t){return this.objectForKey(t)},removeObjectForKey:function(t){if(null!=t){var e=this._keyMapTb;for(var i in e)if(e[i]===t)return delete this._valueMapTb[i],void delete e[i]}},removeObjectsForKeys:function(t){if(null!=t)for(var e=0;e<t.length;e++)this.removeObjectForKey(t[e])},allKeys:function(){var t=[],e=this._keyMapTb;for(var i in e)t.push(e[i]);return t},removeAllObjects:function(){this._keyMapTb={},this._valueMapTb={}},count:function(){return this.allKeys().length}})}),{}],206:[(function(t,e,i){cc.WebGLColor=function(t,e,i,n,r,o){this._arrayBuffer=r||new ArrayBuffer(cc.WebGLColor.BYTES_PER_ELEMENT),this._offset=o||0;var s=this._arrayBuffer,a=this._offset;this._view=new Uint8Array(s,a,4),this._view[0]=t||0,this._view[1]=e||0,this._view[2]=i||0,"number"==typeof n?this._view[3]=n:(this._view[3]=255,this.a_undefined=!0)},cc.WebGLColor.BYTES_PER_ELEMENT=4;var n=cc.WebGLColor.prototype;n._getR=function(){return this._view[0]},n._setR=function(t){this._view[0]=t<0?0:t},n._getG=function(){return this._view[1]},n._setG=function(t){this._view[1]=t<0?0:t},n._getB=function(){return this._view[2]},n._setB=function(t){this._view[2]=t<0?0:t},n._getA=function(){return this._view[3]},n._setA=function(t){this._view[3]=t<0?0:t},n.r,cc.js.getset(n,"r",n._getR,n._setR),n.g,cc.js.getset(n,"g",n._getG,n._setG),n.b,cc.js.getset(n,"b",n._getB,n._setB),n.a,cc.js.getset(n,"a",n._getA,n._setA),cc.Vertex2F=function(t,e,i,n){this._arrayBuffer=i||new ArrayBuffer(cc.Vertex2F.BYTES_PER_ELEMENT),this._offset=n||0,this._view=new Float32Array(this._arrayBuffer,this._offset,2),this._view[0]=t||0,this._view[1]=e||0},cc.Vertex2F.BYTES_PER_ELEMENT=8,(n=cc.Vertex2F.prototype)._getX=function(){return this._view[0]},n._setX=function(t){this._view[0]=t},n._getY=function(){return this._view[1]},n._setY=function(t){this._view[1]=t},cc.js.getset(n,"x",n._getX,n._setX),cc.js.getset(n,"y",n._getY,n._setY),cc.Vertex3F=function(t,e,i,n,r){this._arrayBuffer=n||new ArrayBuffer(cc.Vertex3F.BYTES_PER_ELEMENT),this._offset=r||0;var o=this._arrayBuffer,s=this._offset;this._view=new Float32Array(o,s,3),this._view[0]=t||0,this._view[1]=e||0,this._view[2]=i||0},cc.Vertex3F.BYTES_PER_ELEMENT=12,(n=cc.Vertex3F.prototype)._getX=function(){return this._view[0]},n._setX=function(t){this._view[0]=t},n._getY=function(){return this._view[1]},n._setY=function(t){this._view[1]=t},n._getZ=function(){return this._view[2]},n._setZ=function(t){this._view[2]=t},cc.js.getset(n,"x",n._getX,n._setX),cc.js.getset(n,"y",n._getY,n._setY),cc.js.getset(n,"z",n._getZ,n._setZ),cc.Tex2F=function(t,e,i,n){this._arrayBuffer=i||new ArrayBuffer(cc.Tex2F.BYTES_PER_ELEMENT),this._offset=n||0,this._view=new Float32Array(this._arrayBuffer,this._offset,2),this._view[0]=t||0,this._view[1]=e||0},cc.Tex2F.BYTES_PER_ELEMENT=8,(n=cc.Tex2F.prototype)._getU=function(){return this._view[0]},n._setU=function(t){this._view[0]=t},n._getV=function(){return this._view[1]},n._setV=function(t){this._view[1]=t},cc.js.getset(n,"u",n._getU,n._setU),cc.js.getset(n,"v",n._getV,n._setV),cc.Quad2=function(t,e,i,n,r,o){this._arrayBuffer=r||new ArrayBuffer(cc.Quad2.BYTES_PER_ELEMENT),this._offset=o||0;var s=this._arrayBuffer,a=this._offset,c=cc.Vertex2F.BYTES_PER_ELEMENT;this._tl=t?new cc.Vertex2F(t.x,t.y,s,a):new cc.Vertex2F(0,0,s,a),a+=c,this._tr=e?new cc.Vertex2F(e.x,e.y,s,a):new cc.Vertex2F(0,0,s,a),a+=c,this._bl=i?new cc.Vertex2F(i.x,i.y,s,a):new cc.Vertex2F(0,0,s,a),a+=c,this._br=n?new cc.Vertex2F(n.x,n.y,s,a):new cc.Vertex2F(0,0,s,a)},cc.Quad2.BYTES_PER_ELEMENT=32,(n=cc.Quad2.prototype)._getTL=function(){return this._tl},n._setTL=function(t){this._tl._view[0]=t.x,this._tl._view[1]=t.y},n._getTR=function(){return this._tr},n._setTR=function(t){this._tr._view[0]=t.x,this._tr._view[1]=t.y},n._getBL=function(){return this._bl},n._setBL=function(t){this._bl._view[0]=t.x,this._bl._view[1]=t.y},n._getBR=function(){return this._br},n._setBR=function(t){this._br._view[0]=t.x,this._br._view[1]=t.y},cc.js.getset(n,"tl",n._getTL,n._setTL),cc.js.getset(n,"tr",n._getTR,n._setTR),cc.js.getset(n,"bl",n._getBL,n._setBL),cc.js.getset(n,"br",n._getBR,n._setBR),cc.Quad3=function(t,e,i,n,r,o){this._arrayBuffer=r||new ArrayBuffer(cc.Quad3.BYTES_PER_ELEMENT),this._offset=o||0;var s=this._arrayBuffer,a=this._offset,c=cc.Vertex3F.BYTES_PER_ELEMENT;this.bl=bl?new cc.Vertex3F(bl.x,bl.y,bl.z,s,a):new cc.Vertex3F(0,0,0,s,a),a+=c,this.br=br?new cc.Vertex3F(br.x,br.y,br.z,s,a):new cc.Vertex3F(0,0,0,s,a),a+=c,this.tl=tl?new cc.Vertex3F(tl.x,tl.y,tl.z,s,a):new cc.Vertex3F(0,0,0,s,a),a+=c,this.tr=tr?new cc.Vertex3F(tr.x,tr.y,tr.z,s,a):new cc.Vertex3F(0,0,0,s,a)},cc.Quad3.BYTES_PER_ELEMENT=48,cc.V3F_C4B_T2F=function(t,e,i,n,r){this._arrayBuffer=n||new ArrayBuffer(cc.V3F_C4B_T2F.BYTES_PER_ELEMENT),this._offset=r||0;var o=this._arrayBuffer,s=this._offset;this._vertices=t?new cc.Vertex3F(t.x,t.y,t.z,o,s):new cc.Vertex3F(0,0,0,o,s),s+=cc.Vertex3F.BYTES_PER_ELEMENT,this._colors=e?new cc.WebGLColor(e.r,e.g,e.b,e.a,o,s):new cc.WebGLColor(0,0,0,0,o,s),s+=cc.WebGLColor.BYTES_PER_ELEMENT,this._texCoords=i?new cc.Tex2F(i.u,i.v,o,s):new cc.Tex2F(0,0,o,s)},cc.V3F_C4B_T2F.BYTES_PER_ELEMENT=24,(n=cc.V3F_C4B_T2F.prototype)._getVertices=function(){return this._vertices},n._setVertices=function(t){var e=this._vertices;e._view[0]=t.x,e._view[1]=t.y,e._view[2]=t.z},n._getColor=function(){return this._colors},n._setColor=function(t){var e=this._colors;e._view[0]=t.r,e._view[1]=t.g,e._view[2]=t.b,e._view[3]=t.a},n._getTexCoords=function(){return this._texCoords},n._setTexCoords=function(t){this._texCoords._view[0]=t.u,this._texCoords._view[1]=t.v},cc.js.getset(n,"vertices",n._getVertices,n._setVertices),cc.js.getset(n,"colors",n._getColor,n._setColor),cc.js.getset(n,"texCoords",n._getTexCoords,n._setTexCoords),cc.V3F_C4B_T2F_Quad=function(t,e,i,n,r,o){this._arrayBuffer=r||new ArrayBuffer(cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT),this._offset=o||0;var s=this._arrayBuffer,a=this._offset,c=cc.V3F_C4B_T2F.BYTES_PER_ELEMENT;this._tl=t?new cc.V3F_C4B_T2F(t.vertices,t.colors,t.texCoords,s,a):new cc.V3F_C4B_T2F(null,null,null,s,a),a+=c,this._bl=e?new cc.V3F_C4B_T2F(e.vertices,e.colors,e.texCoords,s,a):new cc.V3F_C4B_T2F(null,null,null,s,a),a+=c,this._tr=i?new cc.V3F_C4B_T2F(i.vertices,i.colors,i.texCoords,s,a):new cc.V3F_C4B_T2F(null,null,null,s,a),a+=c,this._br=n?new cc.V3F_C4B_T2F(n.vertices,n.colors,n.texCoords,s,a):new cc.V3F_C4B_T2F(null,null,null,s,a)},cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT=96,(n=cc.V3F_C4B_T2F_Quad.prototype)._getTL=function(){return this._tl},n._setTL=function(t){var e=this._tl;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},n._getBL=function(){return this._bl},n._setBL=function(t){var e=this._bl;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},n._getTR=function(){return this._tr},n._setTR=function(t){var e=this._tr;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},n._getBR=function(){return this._br},n._setBR=function(t){var e=this._br;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},n._getArrayBuffer=function(){return this._arrayBuffer},cc.js.getset(n,"tl",n._getTL,n._setTL),cc.js.getset(n,"tr",n._getTR,n._setTR),cc.js.getset(n,"bl",n._getBL,n._setBL),cc.js.getset(n,"br",n._getBR,n._setBR),cc.js.get(n,"arrayBuffer",n._getArrayBuffer),cc.V3F_C4B_T2F_QuadZero=function(){return new cc.V3F_C4B_T2F_Quad},cc.V3F_C4B_T2F_QuadCopy=function(t){if(!t)return cc.V3F_C4B_T2F_QuadZero();var e=t.tl,i=t.bl,n=t.tr,r=t.br;return{tl:{vertices:{x:e.vertices.x,y:e.vertices.y,z:e.vertices.z},colors:{r:e.colors.r,g:e.colors.g,b:e.colors.b,a:e.colors.a},texCoords:{u:e.texCoords.u,v:e.texCoords.v}},bl:{vertices:{x:i.vertices.x,y:i.vertices.y,z:i.vertices.z},colors:{r:i.colors.r,g:i.colors.g,b:i.colors.b,a:i.colors.a},texCoords:{u:i.texCoords.u,v:i.texCoords.v}},tr:{vertices:{x:n.vertices.x,y:n.vertices.y,z:n.vertices.z},colors:{r:n.colors.r,g:n.colors.g,b:n.colors.b,a:n.colors.a},texCoords:{u:n.texCoords.u,v:n.texCoords.v}},br:{vertices:{x:r.vertices.x,y:r.vertices.y,z:r.vertices.z},colors:{r:r.colors.r,g:r.colors.g,b:r.colors.b,a:r.colors.a},texCoords:{u:r.texCoords.u,v:r.texCoords.v}}}},cc.V3F_C4B_T2F_QuadsCopy=function(t){if(!t)return[];for(var e=[],i=0;i<t.length;i++)e.push(cc.V3F_C4B_T2F_QuadCopy(t[i]));return e},cc.V2F_C4B_T2F=function(t,e,i,n,r){this._arrayBuffer=n||new ArrayBuffer(cc.V2F_C4B_T2F.BYTES_PER_ELEMENT),this._offset=r||0;var o=this._arrayBuffer,s=this._offset;this._vertices=t?new cc.Vertex2F(t.x,t.y,o,s):new cc.Vertex2F(0,0,o,s),s+=cc.Vertex2F.BYTES_PER_ELEMENT,this._colors=e?new cc.WebGLColor(e.r,e.g,e.b,e.a,o,s):new cc.WebGLColor(0,0,0,0,o,s),s+=cc.WebGLColor.BYTES_PER_ELEMENT,this._texCoords=i?new cc.Tex2F(i.u,i.v,o,s):new cc.Tex2F(0,0,o,s)},cc.V2F_C4B_T2F.BYTES_PER_ELEMENT=20,(n=cc.V2F_C4B_T2F.prototype)._getVertices=function(){return this._vertices},n._setVertices=function(t){this._vertices._view[0]=t.x,this._vertices._view[1]=t.y},n._getColor=function(){return this._colors},n._setColor=function(t){var e=this._colors;e._view[0]=t.r,e._view[1]=t.g,e._view[2]=t.b,e._view[3]=t.a},n._getTexCoords=function(){return this._texCoords},n._setTexCoords=function(t){this._texCoords._view[0]=t.u,this._texCoords._view[1]=t.v},cc.js.getset(n,"vertices",n._getVertices,n._setVertices),cc.js.getset(n,"colors",n._getColor,n._setColor),cc.js.getset(n,"texCoords",n._getTexCoords,n._setTexCoords),cc.V2F_C4B_T2F_Triangle=function(t,e,i,n,r){this._arrayBuffer=n||new ArrayBuffer(cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT),this._offset=r||0;var o=this._arrayBuffer,s=this._offset,a=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;this._a=t?new cc.V2F_C4B_T2F(t.vertices,t.colors,t.texCoords,o,s):new cc.V2F_C4B_T2F(null,null,null,o,s),s+=a,this._b=e?new cc.V2F_C4B_T2F(e.vertices,e.colors,e.texCoords,o,s):new cc.V2F_C4B_T2F(null,null,null,o,s),s+=a,this._c=i?new cc.V2F_C4B_T2F(i.vertices,i.colors,i.texCoords,o,s):new cc.V2F_C4B_T2F(null,null,null,o,s)},cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT=60,(n=cc.V2F_C4B_T2F_Triangle.prototype)._getA=function(){return this._a},n._setA=function(t){var e=this._a;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},n._getB=function(){return this._b},n._setB=function(t){var e=this._b;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},n._getC=function(){return this._c},n._setC=function(t){var e=this._c;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},cc.js.getset(n,"a",n._getA,n._setA),cc.js.getset(n,"b",n._getB,n._setB),cc.js.getset(n,"c",n._getC,n._setC)}),{}],207:[(function(t,e,i){function n(){}var r=t("../platform/js");r.setClassName("cc.ValueType",n);var o=n.prototype;o.toString=function(){return""+{}},cc.ValueType=n,e.exports=n}),{"../platform/js":167}],208:[(function(t,e,i){function n(t,e){t&&"object"==typeof t&&(e=t.y,t=t.x),this.x=t||0,this.y=e||0}var r=t("./CCValueType"),o=t("../platform/js"),s=t("../platform/CCClass");o.extend(n,r),s.fastDefine("cc.Vec2",n,{x:0,y:0});var a=n.prototype;a.clone=function(){return new n(this.x,this.y)},a.set=function(t){return this.x=t.x,this.y=t.y,this},a.equals=function(t){return t&&this.x===t.x&&this.y===t.y},a.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+")"},a.lerp=function(t,e,i){i=i||new n;var r=this.x,o=this.y;return i.x=r+(t.x-r)*e,i.y=o+(t.y-o)*e,i},a.addSelf=function(t){return this.x+=t.x,this.y+=t.y,this},a.add=function(t,e){return e=e||new n,e.x=this.x+t.x,e.y=this.y+t.y,e},a.subSelf=function(t){return this.x-=t.x,this.y-=t.y,this},a.sub=function(t,e){return e=e||new n,e.x=this.x-t.x,e.y=this.y-t.y,e},a.mulSelf=function(t){return this.x*=t,this.y*=t,this},a.mul=function(t,e){return e=e||new n,e.x=this.x*t,e.y=this.y*t,e},a.scaleSelf=function(t){return this.x*=t.x,this.y*=t.y,this},a.scale=function(t,e){return e=e||new n,e.x=this.x*t.x,e.y=this.y*t.y,e},a.divSelf=function(t){return this.x/=t,this.y/=t,this},a.div=function(t,e){return e=e||new n,e.x=this.x/t,e.y=this.y/t,e},a.negSelf=function(){return this.x=-this.x,this.y=-this.y,this},a.neg=function(t){return t=t||new n,t.x=-this.x,t.y=-this.y,t},a.dot=function(t){return this.x*t.x+this.y*t.y},a.cross=function(t){return this.y*t.x-this.x*t.y},a.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},a.magSqr=function(){return this.x*this.x+this.y*this.y},a.normalizeSelf=function(){var t=this.x*this.x+this.y*this.y;if(1===t)return this;if(0===t)return console.warn("Can't normalize zero vector"),this;var e=1/Math.sqrt(t);return this.x*=e,this.y*=e,this},a.normalize=function(t){return t=t||new n,t.x=this.x,t.y=this.y,t.normalizeSelf(),t},a.angle=function(t){var e=this.magSqr(),i=t.magSqr();if(0===e||0===i)return console.warn("Can't get angle between zero vector"),0;var n=this.dot(t)/Math.sqrt(e*i);return n=cc.clampf(n,-1,1),Math.acos(n)},a.signAngle=function(t){return Math.atan2(this.y,this.x)-Math.atan2(t.y,t.x)},a.rotate=function(t,e){return e=e||new n,e.x=this.x,e.y=this.y,e.rotateSelf(t)},a.rotateSelf=function(t){var e=Math.sin(t),i=Math.cos(t),n=this.x;return this.x=i*n-e*this.y,this.y=e*n+i*this.y,this},o.get(n,"ONE",(function(){return new n(1,1)})),o.get(n,"ZERO",(function(){return new n(0,0)})),o.get(n,"UP",(function(){return new n(0,1)})),o.get(n,"RIGHT",(function(){return new n(1,0)})),cc.Vec2=n,cc.v2=function(t,e){return new n(t,e)},cc.p=cc.v2,cc.pointEqualToPoint=function(t,e){return t&&e&&t.x===e.x&&t.y===e.y},e.exports=cc.Vec2}),{"../platform/CCClass":146,"../platform/js":167,"./CCValueType":207}],209:[(function(t,e,i){t("./CCValueType"),t("./CCVec2"),t("./CCPointExtension"),t("./CCSize"),t("./CCRect"),t("./CCColor"),t("./CCTypes"),t("./CCAffineTransform"),t("./CCTypesWebGL")}),{"./CCAffineTransform":200,"./CCColor":201,"./CCPointExtension":202,"./CCRect":203,"./CCSize":204,"./CCTypes":205,"./CCTypesWebGL":206,"./CCValueType":207,"./CCVec2":208}],210:[(function(t,e,i){cc.js}),{}],211:[(function(t,e,i){t("./core/CCGame"),t("./actions/index.js"),t("./core/base-nodes/CCSGNode"),t("./core/base-nodes/CCSGNodeBaseRenderCmd"),t("./core/base-nodes/CCSGNodeCanvasRenderCmd"),t("./core/base-nodes/CCSGNodeWebGLRenderCmd"),t("./core/scenes/CCSGScene"),t("./core/CCConfiguration"),t("./core/CCDrawingPrimitivesCanvas"),t("./core/CCDrawingPrimitivesWebGL"),t("./core/sprites/CCSGSprite"),t("./core/sprites/CCSGSpriteCanvasRenderCmd"),t("./core/sprites/CCSGSpriteWebGLRenderCmd"),t("./core/sprites/CCScale9Sprite"),t("./core/sprites/CCScale9SpriteCanvasRenderCmd"),t("./core/sprites/CCScale9SpriteWebGLRenderCmd"),t("./core/sprites/CCSpriteBatchNode"),t("./shape-nodes/CCDrawNode"),t("./shape-nodes/CCDrawNodeCanvasRenderCmd"),t("./shape-nodes/CCDrawNodeWebGLRenderCmd"),t("./render-texture/CCRenderTexture"),t("./render-texture/CCRenderTextureCanvasRenderCmd"),t("./render-texture/CCRenderTextureWebGLRenderCmd")}),{"./actions/index.js":11,"./core/CCConfiguration":34,"./core/CCDrawingPrimitivesCanvas":38,"./core/CCDrawingPrimitivesWebGL":39,"./core/CCGame":40,"./core/base-nodes/CCSGNode":56,"./core/base-nodes/CCSGNodeBaseRenderCmd":57,"./core/base-nodes/CCSGNodeCanvasRenderCmd":58,"./core/base-nodes/CCSGNodeWebGLRenderCmd":59,"./core/scenes/CCSGScene":177,"./core/sprites/CCSGSprite":178,"./core/sprites/CCSGSpriteCanvasRenderCmd":179,"./core/sprites/CCSGSpriteWebGLRenderCmd":180,"./core/sprites/CCScale9Sprite":181,"./core/sprites/CCScale9SpriteCanvasRenderCmd":182,"./core/sprites/CCScale9SpriteWebGLRenderCmd":183,"./core/sprites/CCSpriteBatchNode":184,"./render-texture/CCRenderTexture":1,"./render-texture/CCRenderTextureCanvasRenderCmd":1,"./render-texture/CCRenderTextureWebGLRenderCmd":1,"./shape-nodes/CCDrawNode":240,"./shape-nodes/CCDrawNodeCanvasRenderCmd":241,"./shape-nodes/CCDrawNodeWebGLRenderCmd":242}],212:[(function(t,e,i){cc.math.AABB=function(t,e){this.min=t||new cc.math.Vec3,this.max=e||new cc.math.Vec3},cc.math.AABB.prototype.containsPoint=function(t){return t.x>=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y&&t.z>=this.min.z&&t.z<=this.max.z},cc.math.AABB.containsPoint=function(t,e){return t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y&&t.z>=e.min.z&&t.z<=e.max.z},cc.math.AABB.prototype.assignFrom=function(t){this.min.assignFrom(t.min),this.max.assignFrom(t.max)},cc.math.AABB.assign=function(t,e){return t.min.assignFrom(e.min),t.max.assignFrom(e.max),t}}),{}],213:[(function(t,e,i){cc.math.Matrix4Stack=function(t,e){this.top=t,this.stack=e||[],this.lastUpdated=0};var n=cc.math.Matrix4Stack.prototype;n.initialize=function(){this.stack.length=0,this.top=null},n.push=function(t){t=t||this.top,this.stack.push(this.top),this.top=new cc.math.Matrix4(t),this.update()},n.pop=function(){this.top=this.stack.pop(),this.update()},n.update=function(){this.lastUpdated++},n.release=function(){this.stack=null,this.top=null,this._matrixPool=null},n._getFromPool=function(t){var e=this._matrixPool;if(0===e.length)return new cc.math.Matrix4(t);var i=e.pop();return i.assignFrom(t),i},n._putInPool=function(t){this._matrixPool.push(t)}}),{}],214:[(function(t,e,i){var n=cc.math;n.KM_GL_MODELVIEW=5888,n.KM_GL_PROJECTION=5889,n.KM_GL_TEXTURE=5890,n.modelview_matrix_stack=new n.Matrix4Stack,n.projection_matrix_stack=new n.Matrix4Stack,n.texture_matrix_stack=new n.Matrix4Stack,cc.current_stack=null;var r=!1;!(function(){if(!r){var t=new n.Matrix4;n.modelview_matrix_stack.initialize(),n.projection_matrix_stack.initialize(),n.texture_matrix_stack.initialize(),cc.current_stack=n.modelview_matrix_stack,r=!0,t.identity(),n.modelview_matrix_stack.push(t),n.projection_matrix_stack.push(t),n.texture_matrix_stack.push(t)}})(),n.glFreeAll=function(){n.modelview_matrix_stack.release(),n.modelview_matrix_stack=null,n.projection_matrix_stack.release(),n.projection_matrix_stack=null,n.texture_matrix_stack.release(),n.texture_matrix_stack=null,r=!1,cc.current_stack=null},n.glPushMatrix=function(){cc.current_stack.push(cc.current_stack.top)},n.glPushMatrixWitMat4=function(t){cc.current_stack.stack.push(cc.current_stack.top),t.assignFrom(cc.current_stack.top),cc.current_stack.top=t},n.glPopMatrix=function(){cc.current_stack.top=cc.current_stack.stack.pop()},n.glMatrixMode=function(t){switch(t){case n.KM_GL_MODELVIEW:cc.current_stack=n.modelview_matrix_stack;break;case n.KM_GL_PROJECTION:cc.current_stack=n.projection_matrix_stack;break;case n.KM_GL_TEXTURE:cc.current_stack=n.texture_matrix_stack;break;default:throw new Error("Invalid matrix mode specified")}},n.glLoadIdentity=function(){cc.current_stack.top.identity(),cc.current_stack.update()},n.glLoadMatrix=function(t){cc.current_stack.top.assignFrom(t),cc.current_stack.update()},n.glMultMatrix=function(t){cc.current_stack.top.multiply(t),cc.current_stack.update()};var o=new n.Matrix4;n.glTranslatef=function(t,e,i){var r=n.Matrix4.createByTranslation(t,e,i,o);cc.current_stack.top.multiply(r),cc.current_stack.update()};var s=new n.Vec3;n.glRotatef=function(t,e,i,r){s.fill(e,i,r);var a=n.Matrix4.createByAxisAndAngle(s,cc.degreesToRadians(t),o);cc.current_stack.top.multiply(a),cc.current_stack.update()},n.glScalef=function(t,e,i){var r=n.Matrix4.createByScale(t,e,i,o);cc.current_stack.top.multiply(r),cc.current_stack.update()},n.glGetMatrix=function(t,e){switch(t){case n.KM_GL_MODELVIEW:e.assignFrom(n.modelview_matrix_stack.top);break;case n.KM_GL_PROJECTION:e.assignFrom(n.projection_matrix_stack.top);break;case n.KM_GL_TEXTURE:e.assignFrom(n.texture_matrix_stack.top);break;default:throw new Error("Invalid matrix mode specified")}}}),{}],215:[(function(t,e,i){t("./utility"),t("./vec2"),t("./vec3"),t("./vec4"),t("./ray2"),t("./mat3"),t("./mat4"),t("./plane"),t("./quaternion"),t("./aabb"),t("./gl/mat4stack"),t("./gl/matrix")}),{"./aabb":212,"./gl/mat4stack":213,"./gl/matrix":214,"./mat3":216,"./mat4":217,"./plane":218,"./quaternion":219,"./ray2":220,"./utility":221,"./vec2":222,"./vec3":223,"./vec4":224}],216:[(function(t,e,i){window.Uint16Array=window.Uint16Array||window.Array,window.Float32Array=window.Float32Array||window.Array,cc.math.Matrix3=function(t){t&&t.mat?this.mat=new Float32Array(t.mat):this.mat=new Float32Array(9)};var n=cc.math.Matrix3.prototype;n.fill=function(t){var e=this.mat,i=t.mat;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this},n.adjugate=function(){var t=this.mat,e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],s=t[5],a=t[6],c=t[7],h=t[8];return t[0]=o*h-s*c,t[1]=n*c-i*h,t[2]=i*s-n*o,t[3]=s*a-r*h,t[4]=e*h-n*a,t[5]=n*r-e*s,t[6]=r*c-o*a,t[8]=e*o-i*r,this},n.identity=function(){var t=this.mat;return t[1]=t[2]=t[3]=t[5]=t[6]=t[7]=0,t[0]=t[4]=t[8]=1,this};var r=new cc.math.Matrix3;n.inverse=function(t){if(0===t)return this;r.assignFrom(this);var e=1/t;return this.adjugate(),this.multiplyScalar(e),this},n.isIdentity=function(){var t=this.mat;return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&1===t[4]&&0===t[5]&&0===t[6]&&0===t[7]&&1===t[8]},n.transpose=function(){var t=this.mat,e=t[1],i=t[2],n=t[3],r=t[5],o=t[6],s=t[7];return t[1]=n,t[2]=o,t[3]=e,t[5]=s,t[6]=i,t[7]=r,this},n.determinant=function(){var t=this.mat,e=t[0]*t[4]*t[8]+t[1]*t[5]*t[6]+t[2]*t[3]*t[7];return e-=t[2]*t[4]*t[6]+t[0]*t[5]*t[7]+t[1]*t[3]*t[8]},n.multiply=function(t){var e=this.mat,i=t.mat,n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],c=e[5],h=e[6],l=e[7],u=e[8],d=i[0],_=i[1],f=i[2],p=i[3],g=i[4],v=i[5],m=i[6],y=i[7],T=i[8];return e[0]=n*d+s*_+h*f,e[1]=r*d+a*_+l*f,e[2]=o*d+c*_+u*f,e[3]=o*d+c*_+u*f,e[4]=r*p+a*g+l*v,e[5]=o*p+c*g+u*v,e[6]=n*m+s*y+h*T,e[7]=r*m+a*y+l*T,e[8]=o*m+c*y+u*T,this},n.multiplyScalar=function(t){var e=this.mat;return e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e[4]*=t,e[5]*=t,e[6]*=t,e[7]*=t,e[8]*=t,this},cc.math.Matrix3.rotationAxisAngle=function(t,e){var i=Math.cos(e),n=Math.sin(e),r=new cc.math.Matrix3,o=r.mat;return o[0]=i+t.x*t.x*(1-i),o[1]=t.z*n+t.y*t.x*(1-i),o[2]=-t.y*n+t.z*t.x*(1-i),o[3]=-t.z*n+t.x*t.y*(1-i),o[4]=i+t.y*t.y*(1-i),o[5]=t.x*n+t.z*t.y*(1-i),o[6]=t.y*n+t.x*t.z*(1-i),o[7]=-t.x*n+t.y*t.z*(1-i),o[8]=i+t.z*t.z*(1-i),r},n.assignFrom=function(t){if(this===t)return cc.logID(7900),this;var e=this.mat,i=t.mat;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this},n.equals=function(t){if(this===t)return!0;for(var e=cc.math.EPSILON,i=this.mat,n=t.mat,r=0;r<9;++r)if(!(i[r]+e>n[r]&&i[r]-e<n[r]))return!1;return!0},cc.math.Matrix3.createByRotationX=function(t){var e=new cc.math.Matrix3,i=e.mat;return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=Math.cos(t),i[5]=Math.sin(t),i[6]=0,i[7]=-Math.sin(t),i[8]=Math.cos(t),e},cc.math.Matrix3.createByRotationY=function(t){var e=new cc.math.Matrix3,i=e.mat;return i[0]=Math.cos(t),i[1]=0,i[2]=-Math.sin(t),i[3]=0,i[4]=1,i[5]=0,i[6]=Math.sin(t),i[7]=0,i[8]=Math.cos(t),e},cc.math.Matrix3.createByRotationZ=function(t){var e=new cc.math.Matrix3,i=e.mat;return i[0]=Math.cos(t),i[1]=-Math.sin(t),i[2]=0,i[3]=Math.sin(t),i[4]=Math.cos(t),i[5]=0,i[6]=0,i[7]=0,i[8]=1,e},cc.math.Matrix3.createByRotation=function(t){var e=new cc.math.Matrix3,i=e.mat;return i[0]=Math.cos(t),i[1]=Math.sin(t),i[2]=0,i[3]=-Math.sin(t),i[4]=Math.cos(t),i[5]=0,i[6]=0,i[7]=0,i[8]=1,e},cc.math.Matrix3.createByScale=function(t,e){var i=new cc.math.Matrix3;return i.identity(),i.mat[0]=t,i.mat[4]=e,i},cc.math.Matrix3.createByTranslation=function(t,e){var i=new cc.math.Matrix3;return i.identity(),i.mat[6]=t,i.mat[7]=e,i},cc.math.Matrix3.createByQuaternion=function(t){if(!t)return null;var e=new cc.math.Matrix3,i=e.mat;return i[0]=1-2*(t.y*t.y+t.z*t.z),i[1]=2*(t.x*t.y-t.w*t.z),i[2]=2*(t.x*t.z+t.w*t.y),i[3]=2*(t.x*t.y+t.w*t.z),i[4]=1-2*(t.x*t.x+t.z*t.z),i[5]=2*(t.y*t.z-t.w*t.x),i[6]=2*(t.x*t.z-t.w*t.y),i[7]=2*(t.y*t.z+t.w*t.x),i[8]=1-2*(t.x*t.x+t.y*t.y),e},n.rotationToAxisAngle=function(){return cc.math.Quaternion.rotationMatrix(this).toAxisAndAngle()}}),{}],217:[(function(t,e,i){cc.math.Matrix4=function(t){t&&t.mat?this.mat=new Float32Array(t.mat):this.mat=new Float32Array(16)};var n=cc.math.Matrix4.prototype;n.fill=function(t){for(var e=this.mat,i=0;i<16;i++)e[i]=t[i];return this},cc.math.mat4Identity=function(t){var e=t.mat;return e[1]=e[2]=e[3]=e[4]=e[6]=e[7]=e[8]=e[9]=e[11]=e[12]=e[13]=e[14]=0,e[0]=e[5]=e[10]=e[15]=1,t},n.identity=function(){var t=this.mat;return t[1]=t[2]=t[3]=t[4]=t[6]=t[7]=t[8]=t[9]=t[11]=t[12]=t[13]=t[14]=0,t[0]=t[5]=t[10]=t[15]=1,this},n.get=function(t,e){return this.mat[t+4*e]},n.set=function(t,e,i){this.mat[t+4*e]=i},n.swap=function(t,e,i,n){var r=this.mat,o=r[t+4*e];r[t+4*e]=r[i+4*n],r[i+4*n]=o},cc.math.Matrix4._gaussj=function(t,e){var i,n,r,o,s,a,c,h,l,u=0,d=0,_=[0,0,0,0],f=[0,0,0,0],p=[0,0,0,0];for(i=0;i<4;i++){for(c=0,n=0;n<4;n++)if(1!==p[n])for(r=0;r<4;r++)0===p[r]&&(a=Math.abs(t.get(n,r)))>=c&&(c=a,d=n,u=r);if(++p[u],d!==u){for(o=0;o<4;o++)t.swap(d,o,u,o);for(o=0;o<4;o++)e.swap(d,o,u,o)}if(f[i]=d,_[i]=u,0===t.get(u,u))return!1;for(l=1/t.get(u,u),t.set(u,u,1),o=0;o<4;o++)t.set(u,o,t.get(u,o)*l);for(o=0;o<4;o++)e.set(u,o,e.get(u,o)*l);for(s=0;s<4;s++)if(s!==u){for(h=t.get(s,u),t.set(s,u,0),o=0;o<4;o++)t.set(s,o,t.get(s,o)-t.get(u,o)*h);for(o=0;o<4;o++)e.set(s,o,t.get(s,o)-e.get(u,o)*h)}}for(o=3;o>=0;o--)if(f[o]!==_[o])for(r=0;r<4;r++)t.swap(r,f[o],r,_[o]);return!0};var r=(new cc.math.Matrix4).identity();cc.math.mat4Inverse=function(t,e){var i=new cc.math.Matrix4(e),n=new cc.math.Matrix4(r);return!1===cc.math.Matrix4._gaussj(i,n)?null:(t.assignFrom(i),t)},n.inverse=function(){var t=new cc.math.Matrix4(this),e=new cc.math.Matrix4(r);return!1===cc.math.Matrix4._gaussj(t,e)?null:t},n.isIdentity=function(){var t=this.mat;return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]},n.transpose=function(){var t=this.mat,e=t[1],i=t[2],n=t[3],r=t[4],o=t[6],s=t[7],a=t[8],c=t[9],h=t[11],l=t[12],u=t[13],d=t[14];return t[1]=r,t[2]=a,t[3]=l,t[4]=e,t[6]=c,t[7]=u,t[8]=i,t[9]=o,t[11]=d,t[12]=n,t[13]=s,t[14]=h,this},cc.math.mat4Multiply=function(t,e,i){var n=t.mat,r=e.mat,o=i.mat,s=r[0],a=r[1],c=r[2],h=r[3],l=r[4],u=r[5],d=r[6],_=r[7],f=r[8],p=r[9],g=r[10],v=r[11],m=r[12],y=r[13],T=r[14],C=r[15],x=o[0],E=o[1],S=o[2],b=o[3],A=o[4],R=o[5],I=o[6],w=o[7],O=o[8],L=o[9],P=o[10],D=o[11],N=o[12],F=o[13],M=o[14],B=o[15];return n[0]=x*s+E*l+S*f+b*m,n[1]=x*a+E*u+S*p+b*y,n[2]=x*c+E*d+S*g+b*T,n[3]=x*h+E*_+S*v+b*C,n[4]=A*s+R*l+I*f+w*m,n[5]=A*a+R*u+I*p+w*y,n[6]=A*c+R*d+I*g+w*T,n[7]=A*h+R*_+I*v+w*C,n[8]=O*s+L*l+P*f+D*m,n[9]=O*a+L*u+P*p+D*y,n[10]=O*c+L*d+P*g+D*T,n[11]=O*h+L*_+P*v+D*C,n[12]=N*s+F*l+M*f+B*m,n[13]=N*a+F*u+M*p+B*y,n[14]=N*c+F*d+M*g+B*T,n[15]=N*h+F*_+M*v+B*C,t},n.multiply=function(t){var e=this.mat,i=t.mat,n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],c=e[5],h=e[6],l=e[7],u=e[8],d=e[9],_=e[10],f=e[11],p=e[12],g=e[13],v=e[14],m=e[15],y=i[0],T=i[1],C=i[2],x=i[3],E=i[4],S=i[5],b=i[6],A=i[7],R=i[8],I=i[9],w=i[10],O=i[11],L=i[12],P=i[13],D=i[14],N=i[15];return e[0]=y*n+T*a+C*u+x*p,e[1]=y*r+T*c+C*d+x*g,e[2]=y*o+T*h+C*_+x*v,e[3]=y*s+T*l+C*f+x*m,e[4]=E*n+S*a+b*u+A*p,e[5]=E*r+S*c+b*d+A*g,e[6]=E*o+S*h+b*_+A*v,e[7]=E*s+S*l+b*f+A*m,e[8]=R*n+I*a+w*u+O*p,e[9]=R*r+I*c+w*d+O*g,e[10]=R*o+I*h+w*_+O*v,e[11]=R*s+I*l+w*f+O*m,e[12]=L*n+P*a+D*u+N*p,e[13]=L*r+P*c+D*d+N*g,e[14]=L*o+P*h+D*_+N*v,e[15]=L*s+P*l+D*f+N*m,this},cc.math.getMat4MultiplyValue=function(t,e){var i=t.mat,n=e.mat,r=new Float32Array(16);return r[0]=i[0]*n[0]+i[4]*n[1]+i[8]*n[2]+i[12]*n[3],r[1]=i[1]*n[0]+i[5]*n[1]+i[9]*n[2]+i[13]*n[3],r[2]=i[2]*n[0]+i[6]*n[1]+i[10]*n[2]+i[14]*n[3],r[3]=i[3]*n[0]+i[7]*n[1]+i[11]*n[2]+i[15]*n[3],r[4]=i[0]*n[4]+i[4]*n[5]+i[8]*n[6]+i[12]*n[7],r[5]=i[1]*n[4]+i[5]*n[5]+i[9]*n[6]+i[13]*n[7],r[6]=i[2]*n[4]+i[6]*n[5]+i[10]*n[6]+i[14]*n[7],r[7]=i[3]*n[4]+i[7]*n[5]+i[11]*n[6]+i[15]*n[7],r[8]=i[0]*n[8]+i[4]*n[9]+i[8]*n[10]+i[12]*n[11],r[9]=i[1]*n[8]+i[5]*n[9]+i[9]*n[10]+i[13]*n[11],r[10]=i[2]*n[8]+i[6]*n[9]+i[10]*n[10]+i[14]*n[11],r[11]=i[3]*n[8]+i[7]*n[9]+i[11]*n[10]+i[15]*n[11],r[12]=i[0]*n[12]+i[4]*n[13]+i[8]*n[14]+i[12]*n[15],r[13]=i[1]*n[12]+i[5]*n[13]+i[9]*n[14]+i[13]*n[15],r[14]=i[2]*n[12]+i[6]*n[13]+i[10]*n[14]+i[14]*n[15],r[15]=i[3]*n[12]+i[7]*n[13]+i[11]*n[14]+i[15]*n[15],r},cc.math.mat4Assign=function(t,e){if(t===e)return cc.logID(7901),t;var i=t.mat,n=e.mat;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],t},n.assignFrom=function(t){if(this===t)return cc.logID(7902),this;var e=this.mat,i=t.mat;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this},n.equals=function(t){if(this===t)return cc.logID(7903),!0;for(var e=this.mat,i=t.mat,n=cc.math.EPSILON,r=0;r<16;r++)if(!(e[r]+n>i[r]&&e[r]-n<i[r]))return!1;return!0},cc.math.Matrix4.createByRotationX=function(t,e){var i=(e=e||new cc.math.Matrix4).mat;return i[0]=1,i[3]=i[2]=i[1]=0,i[4]=0,i[5]=Math.cos(t),i[6]=Math.sin(t),i[7]=0,i[8]=0,i[9]=-Math.sin(t),i[10]=Math.cos(t),i[11]=0,i[14]=i[13]=i[12]=0,i[15]=1,e},cc.math.Matrix4.createByRotationY=function(t,e){var i=(e=e||new cc.math.Matrix4).mat;return i[0]=Math.cos(t),i[1]=0,i[2]=-Math.sin(t),i[3]=0,i[7]=i[6]=i[4]=0,i[5]=1,i[8]=Math.sin(t),i[9]=0,i[10]=Math.cos(t),i[11]=0,i[14]=i[13]=i[12]=0,i[15]=1,e},cc.math.Matrix4.createByRotationZ=function(t,e){var i=(e=e||new cc.math.Matrix4).mat;return i[0]=Math.cos(t),i[1]=Math.sin(t),i[3]=i[2]=0,i[4]=-Math.sin(t),i[5]=Math.cos(t),i[7]=i[6]=0,i[11]=i[9]=i[8]=0,i[10]=1,i[14]=i[13]=i[12]=0,i[15]=1,e},cc.math.Matrix4.createByPitchYawRoll=function(t,e,i,n){n=n||new cc.math.Matrix4;var r=Math.cos(t),o=Math.sin(t),s=Math.cos(e),a=Math.sin(e),c=Math.cos(i),h=Math.sin(i),l=o*a,u=r*a,d=n.mat;return d[0]=s*c,d[4]=s*h,d[8]=-a,d[1]=l*c-r*h,d[5]=l*h+r*c,d[9]=o*s,d[2]=u*c+o*h,d[6]=u*h-o*c,d[10]=r*s,d[3]=d[7]=d[11]=0,d[15]=1,n},cc.math.Matrix4.createByQuaternion=function(t,e){var i=(e=e||new cc.math.Matrix4).mat;return i[0]=1-2*(t.y*t.y+t.z*t.z),i[1]=2*(t.x*t.y+t.z*t.w),i[2]=2*(t.x*t.z-t.y*t.w),i[3]=0,i[4]=2*(t.x*t.y-t.z*t.w),i[5]=1-2*(t.x*t.x+t.z*t.z),i[6]=2*(t.z*t.y+t.x*t.w),i[7]=0,i[8]=2*(t.x*t.z+t.y*t.w),i[9]=2*(t.y*t.z-t.x*t.w),i[10]=1-2*(t.x*t.x+t.y*t.y),i[11]=0,i[14]=i[13]=i[12]=0,i[15]=1,e},cc.math.Matrix4.createByRotationTranslation=function(t,e,i){var n=(i=i||new cc.math.Matrix4).mat,r=t.mat;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=0,n[4]=r[3],n[5]=r[4],n[6]=r[5],n[7]=0,n[8]=r[6],n[9]=r[7],n[10]=r[8],n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,i},cc.math.Matrix4.createByScale=function(t,e,i,n){var r=(n=n||new cc.math.Matrix4).mat;return r[0]=t,r[5]=e,r[10]=i,r[15]=1,r[1]=r[2]=r[3]=r[4]=r[6]=r[7]=r[8]=r[9]=r[11]=r[12]=r[13]=r[14]=0,n},cc.math.mat4Translation=function(t,e,i,n){return t.mat[0]=t.mat[5]=t.mat[10]=t.mat[15]=1,t.mat[1]=t.mat[2]=t.mat[3]=t.mat[4]=t.mat[6]=t.mat[7]=t.mat[8]=t.mat[9]=t.mat[11]=0,t.mat[12]=e,t.mat[13]=i,t.mat[14]=n,t},cc.math.Matrix4.createByTranslation=function(t,e,i,n){return(n=n||new cc.math.Matrix4).identity(),n.mat[12]=t,n.mat[13]=e,n.mat[14]=i,n},n.getUpVec3=function(){var t=this.mat;return new cc.math.Vec3(t[4],t[5],t[6]).normalize()},n.getRightVec3=function(){var t=this.mat;return new cc.math.Vec3(t[0],t[1],t[2]).normalize()},n.getForwardVec3=function(){var t=this.mat;return new cc.math.Vec3(t[8],t[9],t[10]).normalize()},cc.math.mat4PerspectiveProjection=function(t,e,i,n,r){var o=cc.degreesToRadians(e/2),s=r-n,a=Math.sin(o);if(0===s||0===a||0===i)return null;var c=Math.cos(o)/a;return t.identity(),t.mat[0]=c/i,t.mat[5]=c,t.mat[10]=-(r+n)/s,t.mat[11]=-1,t.mat[14]=-2*n*r/s,t.mat[15]=0,t},cc.math.Matrix4.createPerspectiveProjection=function(t,e,i,n){var r=cc.degreesToRadians(t/2),o=n-i,s=Math.sin(r);if(0===o||0===s||0===e)return null;var a=Math.cos(r)/s,c=new cc.math.Matrix4,h=c.mat;return c.identity(),h[0]=a/e,h[5]=a,h[10]=-(n+i)/o,h[11]=-1,h[14]=-2*i*n/o,h[15]=0,c},cc.math.mat4OrthographicProjection=function(t,e,i,n,r,o,s){return t.identity(),t.mat[0]=2/(i-e),t.mat[5]=2/(r-n),t.mat[10]=-2/(s-o),t.mat[12]=-(i+e)/(i-e),t.mat[13]=-(r+n)/(r-n),t.mat[14]=-(s+o)/(s-o),t},cc.math.Matrix4.createOrthographicProjection=function(t,e,i,n,r,o){var s=new cc.math.Matrix4,a=s.mat;return s.identity(),a[0]=2/(e-t),a[5]=2/(n-i),a[10]=-2/(o-r),a[12]=-(e+t)/(e-t),a[13]=-(n+i)/(n-i),a[14]=-(o+r)/(o-r),s},cc.math.mat4LookAt=function(t,e,i,n){var r=new cc.math.Vec3(i),o=new cc.math.Vec3(n);r.subtract(e),r.normalize(),o.normalize();var s=new cc.math.Vec3(r);s.cross(o),s.normalize();var a=new cc.math.Vec3(s);a.cross(r),s.normalize(),t.identity(),t.mat[0]=s.x,t.mat[4]=s.y,t.mat[8]=s.z,t.mat[1]=a.x,t.mat[5]=a.y,t.mat[9]=a.z,t.mat[2]=-r.x,t.mat[6]=-r.y,t.mat[10]=-r.z;var c=cc.math.Matrix4.createByTranslation(-e.x,-e.y,-e.z);return t.multiply(c),t};var o=new cc.math.Matrix4;n.lookAt=function(t,e,i){var n=new cc.math.Vec3(e),r=new cc.math.Vec3(i),s=this.mat;n.subtract(t),n.normalize(),r.normalize();var a=new cc.math.Vec3(n);a.cross(r),a.normalize();var c=new cc.math.Vec3(a);return c.cross(n),a.normalize(),this.identity(),s[0]=a.x,s[4]=a.y,s[8]=a.z,s[1]=c.x,s[5]=c.y,s[9]=c.z,s[2]=-n.x,s[6]=-n.y,s[10]=-n.z,o=cc.math.Matrix4.createByTranslation(-t.x,-t.y,-t.z,o),this.multiply(o),this},cc.math.mat4RotationAxisAngle=function(t,e,i){var n=Math.cos(i),r=Math.sin(i),o=new cc.math.Vec3(e);return o.normalize(),t.mat[0]=n+o.x*o.x*(1-n),t.mat[1]=o.z*r+o.y*o.x*(1-n),t.mat[2]=-o.y*r+o.z*o.x*(1-n),t.mat[3]=0,t.mat[4]=-o.z*r+o.x*o.y*(1-n),t.mat[5]=n+o.y*o.y*(1-n),t.mat[6]=o.x*r+o.z*o.y*(1-n),t.mat[7]=0,t.mat[8]=o.y*r+o.x*o.z*(1-n),t.mat[9]=-o.x*r+o.y*o.z*(1-n),t.mat[10]=n+o.z*o.z*(1-n),t.mat[11]=0,t.mat[12]=0,t.mat[13]=0,t.mat[14]=0,t.mat[15]=1,t},cc.math.Matrix4.createByAxisAndAngle=function(t,e,i){i=i||new cc.math.Matrix4;var n=this.mat,r=Math.cos(e),o=Math.sin(e),s=new cc.math.Vec3(t);return s.normalize(),n[0]=r+s.x*s.x*(1-r),n[1]=s.z*o+s.y*s.x*(1-r),n[2]=-s.y*o+s.z*s.x*(1-r),n[3]=0,n[4]=-s.z*o+s.x*s.y*(1-r),n[5]=r+s.y*s.y*(1-r),n[6]=s.x*o+s.z*s.y*(1-r),n[7]=0,n[8]=s.y*o+s.x*s.z*(1-r),n[9]=-s.x*o+s.y*s.z*(1-r),n[10]=r+s.z*s.z*(1-r),n[11]=0,n[12]=n[13]=n[14]=0,n[15]=1,i},n.extractRotation=function(){var t=new cc.math.Matrix3,e=this.mat,i=t.mat;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[4],i[4]=e[5],i[5]=e[6],i[6]=e[8],i[7]=e[9],i[8]=e[10],t},n.extractPlane=function(t){var e=new cc.math.Plane,i=this.mat;switch(t){case cc.math.Plane.RIGHT:e.a=i[3]-i[0],e.b=i[7]-i[4],e.c=i[11]-i[8],e.d=i[15]-i[12];break;case cc.math.Plane.LEFT:e.a=i[3]+i[0],e.b=i[7]+i[4],e.c=i[11]+i[8],e.d=i[15]+i[12];break;case cc.math.Plane.BOTTOM:e.a=i[3]+i[1],e.b=i[7]+i[5],e.c=i[11]+i[9],e.d=i[15]+i[13];break;case cc.math.Plane.TOP:e.a=i[3]-i[1],e.b=i[7]-i[5],e.c=i[11]-i[9],e.d=i[15]-i[13];break;case cc.math.Plane.FAR:e.a=i[3]-i[2],e.b=i[7]-i[6],e.c=i[11]-i[10],e.d=i[15]-i[14];break;case cc.math.Plane.NEAR:e.a=i[3]+i[2],e.b=i[7]+i[6],e.c=i[11]+i[10],e.d=i[15]+i[14];break;default:cc.logID(7904)}var n=Math.sqrt(e.a*e.a+e.b*e.b+e.c*e.c);return e.a/=n,e.b/=n,e.c/=n,e.d/=n,e},n.toAxisAndAngle=function(){var t=this.extractRotation();return cc.math.Quaternion.rotationMatrix(t).toAxisAndAngle()}}),{}],218:[(function(t,e,i){cc.math.Plane=function(t,e,i,n){t&&void 0===e?(this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d):(this.a=t||0,this.b=e||0,this.c=i||0,this.d=n||0)};var n=cc.math.Plane.prototype;cc.math.Plane.LEFT=0,cc.math.Plane.RIGHT=1,cc.math.Plane.BOTTOM=2,cc.math.Plane.TOP=3,cc.math.Plane.NEAR=4,cc.math.Plane.FAR=5,cc.math.Plane.POINT_INFRONT_OF_PLANE=0,cc.math.Plane.POINT_BEHIND_PLANE=1,cc.math.Plane.POINT_ON_PLANE=2,n.dot=function(t){return this.a*t.x+this.b*t.y+this.c*t.z+this.d*t.w},n.dotCoord=function(t){return this.a*t.x+this.b*t.y+this.c*t.z+this.d},n.dotNormal=function(t){return this.a*t.x+this.b*t.y+this.c*t.z},cc.math.Plane.fromPointNormal=function(t,e){return new cc.math.Plane(e.x,e.y,e.z,-e.dot(t))},cc.math.Plane.fromPoints=function(t,e,i){var n=new cc.math.Vec3(e),r=new cc.math.Vec3(i),o=new cc.math.Plane;return n.subtract(t),r.subtract(t),n.cross(r),n.normalize(),o.a=n.x,o.b=n.y,o.c=n.z,o.d=n.scale(-1).dot(t),o},n.normalize=function(){var t=new cc.math.Vec3(this.a,this.b,this.c),e=1/t.length();return t.normalize(),this.a=t.x,this.b=t.y,this.c=t.z,this.d=this.d*e,this},n.classifyPoint=function(t){var e=this.a*t.x+this.b*t.y+this.c*t.z+this.d;return e>.001?cc.math.Plane.POINT_INFRONT_OF_PLANE:e<-.001?cc.math.Plane.POINT_BEHIND_PLANE:cc.math.Plane.POINT_ON_PLANE}}),{}],219:[(function(t,e,i){cc.math.Quaternion=function(t,e,i,n){t&&void 0===e?(this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w):(this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0)};var n=cc.math.Quaternion.prototype;n.conjugate=function(t){return this.x=-t.x,this.y=-t.y,this.z=-t.z,this.w=t.w,this},n.dot=function(t){return this.w*t.w+this.x*t.x+this.y*t.y+this.z*t.z},n.exponential=function(){return this},n.identity=function(){return this.x=0,this.y=0,this.z=0,this.w=1,this},n.inverse=function(){var t=this.length();return Math.abs(t)>cc.math.EPSILON?(this.x=0,this.y=0,this.z=0,this.w=0,this):(this.conjugate(this).scale(1/t),this)},n.isIdentity=function(){return 0===this.x&&0===this.y&&0===this.z&&1===this.w},n.length=function(){return Math.sqrt(this.lengthSq())},n.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},n.multiply=function(t){var e=this.x,i=this.y,n=this.z,r=this.w;return this.w=r*t.w-e*t.x-i*t.y-n*t.z,this.x=r*t.x+e*t.w+i*t.z-n*t.y,this.y=r*t.y+i*t.w+n*t.x-e*t.z,this.z=r*t.z+n*t.w+e*t.y-i*t.x,this},n.normalize=function(){var t=this.length();if(Math.abs(t)<=cc.math.EPSILON)throw new Error("current quaternion is an invalid value");return this.scale(1/t),this},n.rotationAxis=function(t,e){var i=.5*e,n=Math.sin(i);return this.w=Math.cos(i),this.x=t.x*n,this.y=t.y*n,this.z=t.z*n,this},cc.math.Quaternion.rotationMatrix=function(t){if(!t)return null;var e,i,n,r,o=[],s=t.mat,a=0;o[0]=s[0],o[1]=s[3],o[2]=s[6],o[4]=s[1],o[5]=s[4],o[6]=s[7],o[8]=s[2],o[9]=s[5],o[10]=s[8],o[15]=1;var c=o[0],h=c[0]+c[5]+c[10]+1;return h>cc.math.EPSILON?(a=2*Math.sqrt(h),e=(c[9]-c[6])/a,i=(c[2]-c[8])/a,n=(c[4]-c[1])/a,r=.25*a):c[0]>c[5]&&c[0]>c[10]?(e=.25*(a=2*Math.sqrt(1+c[0]-c[5]-c[10])),i=(c[4]+c[1])/a,n=(c[2]+c[8])/a,r=(c[9]-c[6])/a):c[5]>c[10]?(a=2*Math.sqrt(1+c[5]-c[0]-c[10]),e=(c[4]+c[1])/a,i=.25*a,n=(c[9]+c[6])/a,r=(c[2]-c[8])/a):(a=2*Math.sqrt(1+c[10]-c[0]-c[5]),e=(c[2]+c[8])/a,i=(c[9]+c[6])/a,n=.25*a,r=(c[4]-c[1])/a),new cc.math.Quaternion(e,i,n,r)},cc.math.Quaternion.rotationYawPitchRoll=function(t,e,i){var n,r,o,s,a,c,h,l,u,d,_;n=cc.degreesToRadians(e)/2,r=cc.degreesToRadians(t)/2,o=cc.degreesToRadians(i)/2,s=Math.cos(n),a=Math.cos(r),c=Math.cos(o),h=Math.sin(n),d=a*c,_=(l=Math.sin(r))*(u=Math.sin(o));var f=new cc.math.Quaternion;return f.w=s*d+h*_,f.x=h*d-s*_,f.y=s*l*c+h*a*u,f.z=s*a*u-h*l*c,f.normalize(),f},n.slerp=function(t,e){if(this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w)return this;var i=this.dot(t),n=Math.acos(i),r=Math.sqrt(1-cc.math.square(i)),o=Math.sin(e*n)/r,s=Math.sin((1-e)*n)/r,a=new cc.math.Quaternion(t);return this.scale(s),a.scale(o),this.add(a),this},n.toAxisAndAngle=function(){var t,e,i,n=new cc.math.Vec3;return t=Math.acos(this.w),(e=Math.sqrt(cc.math.square(this.x)+cc.math.square(this.y)+cc.math.square(this.z)))>-cc.math.EPSILON&&e<cc.math.EPSILON||e<2*Math.PI+cc.math.EPSILON&&e>2*Math.PI-cc.math.EPSILON?(i=0,n.x=0,n.y=0,n.z=1):(i=2*t,n.x=this.x/e,n.y=this.y/e,n.z=this.z/e,n.normalize()),{axis:n,angle:i}},n.scale=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},n.assignFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},n.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},cc.math.Quaternion.rotationBetweenVec3=function(t,e,i){var n=new cc.math.Vec3(t),r=new cc.math.Vec3(e);n.normalize(),r.normalize();var o=n.dot(r),s=new cc.math.Quaternion;if(o>=1)return s.identity(),s;if(o<1e-6-1)if(Math.abs(i.lengthSq())<cc.math.EPSILON)s.rotationAxis(i,Math.PI);else{var a=new cc.math.Vec3(1,0,0);a.cross(t),Math.abs(a.lengthSq())<cc.math.EPSILON&&(a.fill(0,1,0),a.cross(t)),a.normalize(),s.rotationAxis(a,Math.PI)}else{var c=Math.sqrt(2*(1+o)),h=1/c;n.cross(r),s.x=n.x*h,s.y=n.y*h,s.z=n.z*h,s.w=.5*c,s.normalize()}return s},n.multiplyVec3=function(t){var e=this.x,i=this.y,n=this.z,r=new cc.math.Vec3(t),o=new cc.math.Vec3(e,i,n),s=new cc.math.Vec3(e,i,n);return o.cross(t),s.cross(o),o.scale(2*q.w),s.scale(2),r.add(o),r.add(s),r}}),{}],220:[(function(t,e,i){function n(t,e,i){var n=new cc.math.Vec2(e);n.subtract(t),i.x=-n.y,i.y=n.x,i.normalize()}cc.math.Ray2=function(t,e){this.start=t||new cc.math.Vec2,this.dir=e||new cc.math.Vec2},cc.math.Ray2.prototype.fill=function(t,e,i,n){this.start.x=t,this.start.y=e,this.dir.x=i,this.dir.y=n},cc.math.Ray2.prototype.intersectLineSegment=function(t,e,i){var n,r,o,s=this.start.x,a=this.start.y,c=this.start.x+this.dir.x,h=this.start.y+this.dir.y,l=t.x,u=t.y,d=e.x,_=e.y,f=(_-u)*(c-s)-(d-l)*(h-a);return!(f>-cc.math.EPSILON&&f<cc.math.EPSILON)&&(n=((d-l)*(a-u)-(_-u)*(s-l))/f,r=s+n*(c-s),o=a+n*(h-a),!(r<Math.min(t.x,e.x)-cc.math.EPSILON||r>Math.max(t.x,e.x)+cc.math.EPSILON||o<Math.min(t.y,e.y)-cc.math.EPSILON||o>Math.max(t.y,e.y)+cc.math.EPSILON)&&(!(r<Math.min(s,c)-cc.math.EPSILON||r>Math.max(s,c)+cc.math.EPSILON||o<Math.min(a,h)-cc.math.EPSILON||o>Math.max(a,h)+cc.math.EPSILON)&&(i.x=r,i.y=o,!0)))},cc.math.Ray2.prototype.intersectTriangle=function(t,e,i,r,o){var s,a=new cc.math.Vec2,c=new cc.math.Vec2,h=new cc.math.Vec2,l=1e4,u=!1;return this.intersectLineSegment(t,e,a)&&(u=!0,(s=a.subtract(this.start).length())<l&&(c.x=a.x,c.y=a.y,l=s,n(t,e,h))),this.intersectLineSegment(e,i,a)&&(u=!0,(s=a.subtract(this.start).length())<l&&(c.x=a.x,c.y=a.y,l=s,n(e,i,h))),this.intersectLineSegment(i,t,a)&&(u=!0,(s=a.subtract(this.start).length())<l&&(c.x=a.x,c.y=a.y,l=s,n(i,t,h))),u&&(r.x=c.x,r.y=c.y,o&&(o.x=h.x,o.y=h.y)),u}}),{}],221:[(function(t,e,i){cc.math=cc.math||{},cc.math.EPSILON=1/64,cc.math.square=function(t){return t*t},cc.math.almostEqual=function(t,e){return t+cc.math.EPSILON>e&&t-cc.math.EPSILON<e}}),{}],222:[(function(t,e,i){cc.math.Vec2=function(t,e){void 0===e?(this.x=t.x,this.y=t.y):(this.x=t||0,this.y=e||0)};var n=cc.math.Vec2.prototype;n.fill=function(t,e){this.x=t,this.y=e},n.length=function(){return Math.sqrt(cc.math.square(this.x)+cc.math.square(this.y))},n.lengthSq=function(){return cc.math.square(this.x)+cc.math.square(this.y)},n.normalize=function(){var t=1/this.length();return this.x*=t,this.y*=t,this},cc.math.Vec2.add=function(t,e,i){return t.x=e.x+i.x,t.y=e.y+i.y,t},n.add=function(t){return this.x+=t.x,this.y+=t.y,this},n.dot=function(t){return this.x*t.x+this.y*t.y},cc.math.Vec2.subtract=function(t,e,i){return t.x=e.x-i.x,t.y=e.y-i.y,t},n.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},n.transform=function(t){var e=this.x,i=this.y;return this.x=e*t.mat[0]+i*t.mat[3]+t.mat[6],this.y=e*t.mat[1]+i*t.mat[4]+t.mat[7],this},cc.math.Vec2.scale=function(t,e,i){return t.x=e.x*i,t.y=e.y*i,t},n.scale=function(t){return this.x*=t,this.y*=t,this},n.equals=function(t){return this.x<t.x+cc.math.EPSILON&&this.x>t.x-cc.math.EPSILON&&this.y<t.y+cc.math.EPSILON&&this.y>t.y-cc.math.EPSILON}}),{}],223:[(function(t,e,i){cc.math.Vec3=cc.math.Vec3=function(t,e,i){t&&void 0===e?(this.x=t.x,this.y=t.y,this.z=t.z):(this.x=t||0,this.y=e||0,this.z=i||0)},cc.math.vec3=function(t,e,i){return new cc.math.Vec3(t,e,i)};var n=cc.math.Vec3.prototype;n.fill=function(t,e,i){return t&&void 0===e?(this.x=t.x,this.y=t.y,this.z=t.z):(this.x=t,this.y=e,this.z=i),this},n.length=function(){return Math.sqrt(cc.math.square(this.x)+cc.math.square(this.y)+cc.math.square(this.z))},n.lengthSq=function(){return cc.math.square(this.x)+cc.math.square(this.y)+cc.math.square(this.z)},n.normalize=function(){var t=1/this.length();return this.x*=t,this.y*=t,this.z*=t,this},n.cross=function(t){var e=this.x,i=this.y,n=this.z;return this.x=i*t.z-n*t.y,this.y=n*t.x-e*t.z,this.z=e*t.y-i*t.x,this},n.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},n.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},n.subtract=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},n.transform=function(t){var e=this.x,i=this.y,n=this.z,r=t.mat;return this.x=e*r[0]+i*r[4]+n*r[8]+r[12],this.y=e*r[1]+i*r[5]+n*r[9]+r[13],this.z=e*r[2]+i*r[6]+n*r[10]+r[14],this},n.transformNormal=function(t){var e=this.x,i=this.y,n=this.z,r=t.mat;return this.x=e*r[0]+i*r[4]+n*r[8],this.y=e*r[1]+i*r[5]+n*r[9],this.z=e*r[2]+i*r[6]+n*r[10],this},n.transformCoord=function(t){var e=new cc.math.Vec4(this.x,this.y,this.z,1);return e.transform(t),this.x=e.x/e.w,this.y=e.y/e.w,this.z=e.z/e.w,this},n.scale=function(t){return this.x*=t,this.y*=t,this.z*=t,this},n.equals=function(t){var e=cc.math.EPSILON;return this.x<t.x+e&&this.x>t.x-e&&this.y<t.y+e&&this.y>t.y-e&&this.z<t.z+e&&this.z>t.z-e},n.inverseTransform=function(t){var e=t.mat,i=new cc.math.Vec3(this.x-e[12],this.y-e[13],this.z-e[14]);return this.x=i.x*e[0]+i.y*e[1]+i.z*e[2],this.y=i.x*e[4]+i.y*e[5]+i.z*e[6],this.z=i.x*e[8]+i.y*e[9]+i.z*e[10],this},n.inverseTransformNormal=function(t){var e=this.x,i=this.y,n=this.z,r=t.mat;return this.x=e*r[0]+i*r[1]+n*r[2],this.y=e*r[4]+i*r[5]+n*r[6],this.z=e*r[8]+i*r[9]+n*r[10],this},n.assignFrom=function(t){return t?(this.x=t.x,this.y=t.y,this.z=t.z,this):this},cc.math.Vec3.zero=function(t){return t.x=t.y=t.z=0,t},n.toTypeArray=function(){var t=new Float32Array(3);return t[0]=this.x,t[1]=this.y,t[2]=this.z,t}}),{}],224:[(function(t,e,i){cc.math.Vec4=function(t,e,i,n){t&&void 0===e?(this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w):(this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0)};var n=cc.math.Vec4.prototype;n.fill=function(t,e,i,n){t&&void 0===e?(this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w):(this.x=t,this.y=e,this.z=i,this.w=n)},n.add=function(t){return t?(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this):this},n.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},n.length=function(){return Math.sqrt(cc.math.square(this.x)+cc.math.square(this.y)+cc.math.square(this.z)+cc.math.square(this.w))},n.lengthSq=function(){return cc.math.square(this.x)+cc.math.square(this.y)+cc.math.square(this.z)+cc.math.square(this.w)},n.lerp=function(t,e){return this},n.normalize=function(){var t=1/this.length();return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},n.scale=function(t){return this.normalize(),this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},n.subtract=function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w},n.transform=function(t){var e=this.x,i=this.y,n=this.z,r=this.w,o=t.mat;return this.x=e*o[0]+i*o[4]+n*o[8]+r*o[12],this.y=e*o[1]+i*o[5]+n*o[9]+r*o[13],this.z=e*o[2]+i*o[6]+n*o[10]+r*o[14],this.w=e*o[3]+i*o[7]+n*o[11]+r*o[15],this},cc.math.Vec4.transformArray=function(t,e){for(var i=[],n=0;n<t.length;n++){var r=new cc.math.Vec4(t[n]);r.transform(e),i.push(r)}return i},n.equals=function(t){var e=cc.math.EPSILON;return this.x<t.x+e&&this.x>t.x-e&&this.y<t.y+e&&this.y>t.y-e&&this.z<t.z+e&&this.z>t.z-e&&this.w<t.w+e&&this.w>t.w-e},n.assignFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},n.toTypeArray=function(){var t=new Float32Array(4);return t[0]=this.x,t[1]=this.y,t[2]=this.z,t[3]=this.w,t}}),{}],225:[(function(t,e,i){t("./CCSGMotionStreak"),t("./CCSGMotionStreakWebGLRenderCmd");var n=cc.Class({name:"cc.MotionStreak",extends:cc.Component,editor:!1,ctor:function(){this._root=null,this._motionStreak=null},properties:{preview:{default:!1,editorOnly:!0,notify:!1,animatable:!1},_fadeTime:1,fadeTime:{get:function(){return this._fadeTime},set:function(t){this._fadeTime=t,this._motionStreak&&this._motionStreak.setFadeTime(t)},animatable:!1,tooltip:!1},_minSeg:1,minSeg:{get:function(){return this._minSeg},set:function(t){this._minSeg=t,this._motionStreak&&this._motionStreak.setMinSeg(t)},animatable:!1,tooltip:!1},_stroke:64,stroke:{get:function(){return this._stroke},set:function(t){this._stroke=t,this._motionStreak&&this._motionStreak.setStroke(t)},animatable:!1,tooltip:!1},_texture:{default:"",url:cc.Texture2D},texture:{get:function(){return this._texture},set:function(t){this._texture=t,this._motionStreak&&(t&&cc.js.isString(t)&&(t=cc.textureCache.addImage(t)),this._motionStreak.setTexture(t))},url:cc.Texture2D,animatable:!1,tooltip:!1},_color:cc.Color.WHITE,color:{get:function(){return this._color},set:function(t){this._color=t,this._motionStreak&&this._motionStreak.tintWithColor(t)},tooltip:!1},_fastMode:!1,fastMode:{get:function(){return this._fastMode},set:function(t){this._fastMode=t,this._motionStreak&&this._motionStreak.setFastMode(t)},animatable:!1,tooltip:!1}},onFocusInEditor:!1,onLostFocusInEditor:!1,reset:function(){this._motionStreak.reset()},__preload:function(){if(cc._renderType===cc.game.RENDER_TYPE_WEBGL){this._root=new _ccsg.Node;var t=new _ccsg.MotionStreak;t.initWithFade(this._fadeTime,this._minSeg,this._stroke,this.node.color,this._texture||null),t.setFastMode(this._fastMode),this._root.addChild(t);var e=this.node._sgNode;e&&e.addChild(this._root,-10),this._motionStreak=t}else cc.warnID(5900)},onEnable:function(){this.node.on("position-changed",this._onNodePositionChanged,this)},onDisable:function(){this.node.off("position-changed",this._onNodePositionChanged,this)},_onNodePositionChanged:function(){if(this._motionStreak){var t=this.node,e=t.getNodeToWorldTransform(),i=e.tx-(t.width/2+t.anchorX*t.width),n=e.ty-(t.height/2+t.anchorY*t.height);this._root.setPosition(-i,-n),this._motionStreak.setPosition(i,n)}}});cc.MotionStreak=e.exports=n}),{"./CCSGMotionStreak":226,"./CCSGMotionStreakWebGLRenderCmd":227}],226:[(function(t,e,i){function n(t,e,i,n,o){if(!((o+=n)<=1)){e*=.5;for(var s,a=o-1,c=n;c<o;c++){s=2*c;var h,l=cc.p(t[2*c],t[2*c+1]);if(0===c)h=cc.pPerp(cc.pNormalize(cc.pSub(l,cc.p(t[2*(c+1)],t[2*(c+1)+1]))));else if(c===a)h=cc.pPerp(cc.pNormalize(cc.pSub(cc.p(t[2*(c-1)],t[2*(c-1)+1]),l)));else{var u=cc.p(t[2*(c-1)],t[2*(c-1)+1]),d=cc.p(t[2*(c+1)],t[2*(c+1)+1]),_=cc.pNormalize(cc.pSub(d,l)),f=cc.pNormalize(cc.pSub(u,l)),p=Math.acos(cc.pDot(_,f));h=p<cc.degreesToRadians(70)?cc.pPerp(cc.pNormalize(cc.pMidpoint(_,f))):p<cc.degreesToRadians(170)?cc.pNormalize(cc.pMidpoint(_,f)):cc.pPerp(cc.pNormalize(cc.pSub(d,u)))}h=cc.pMult(h,e),i[2*s]=l.x+h.x,i[2*s+1]=l.y+h.y,i[2*(s+1)]=l.x-h.x,i[2*(s+1)+1]=l.y-h.y}for(c=n=0===n?0:n-1;c<a;c++){var g=(s=2*c)+2,v=cc.v2(i[2*s],i[2*s+1]),m=cc.v2(i[2*(s+1)],i[2*(s+1)+1]),y=cc.v2(i[2*g],i[2*g+1]),T=cc.v2(i[2*(g+1)],i[2*(g+1)+1]),C=r(v.x,v.y,T.x,T.y,m.x,m.y,y.x,y.y),x=!C.isSuccess;x||(C.value<0||C.value>1)&&(x=!0),x&&(i[2*g]=T.x,i[2*g+1]=T.y,i[2*(g+1)]=y.x,i[2*(g+1)+1]=y.y)}}}function r(t,e,i,n,r,o,s,a){var c,h,l,u;return t===i&&e===n||r===s&&o===a?{isSuccess:!1,value:0}:(i-=t,n-=e,r-=t,o-=e,s-=t,a-=e,c=Math.sqrt(i*i+n*n),h=i/c,l=n/c,u=r*h+o*l,o=o*h-r*l,r=u,u=s*h+a*l,a=a*h-s*l,s=u,o===a?{isSuccess:!1,value:0}:{isSuccess:!0,value:(s+(r-s)*a/(a-o))/c})}_ccsg.MotionStreak=_ccsg.Node.extend({texture:null,fastMode:!1,startingPositionInitialized:!1,_blendFunc:null,_stroke:0,_fadeDelta:0,_minSeg:0,_maxPoints:0,_nuPoints:0,_previousNuPoints:0,_pointVertexes:null,_pointState:null,_vertices:null,_colorPointer:null,_texCoords:null,_verticesBuffer:null,_colorPointerBuffer:null,_texCoordsBuffer:null,_className:"MotionStreak",ctor:function(t,e,i,n,r){_ccsg.Node.prototype.ctor.call(this),this._positionR=cc.p(0,0),this._blendFunc=new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE_MINUS_SRC_ALPHA),this.fastMode=!1,this.startingPositionInitialized=!1,this.texture=null,this._stroke=0,this._fadeDelta=0,this._minSeg=0,this._maxPoints=0,this._nuPoints=0,this._previousNuPoints=0,this._pointVertexes=null,this._pointState=null,this._vertices=null,this._colorPointer=null,this._texCoords=null,this._verticesBuffer=null,this._colorPointerBuffer=null,this._texCoordsBuffer=null,void 0!==r&&this.initWithFade(t,e,i,n,r)},initWithFade:function(t,e,i,n,r){return cc.js.isString(r)&&(r=cc.textureCache.addImage(r)),this.anchorX=0,this.anchorY=0,this.ignoreAnchor=!0,this.startingPositionInitialized=!1,this.fastMode=!0,this._stroke=i,this.setMinSeg(e),this.setFadeTime(t),this._blendFunc.src=gl.SRC_ALPHA,this._blendFunc.dst=gl.ONE_MINUS_SRC_ALPHA,this.setTexture(r),this.color=n,this.scheduleUpdate(),!0},getTexture:function(){return this.texture},setTexture:function(t){this.texture!==t&&(this.texture=t)},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(t,e){void 0===e?this._blendFunc=t:(this._blendFunc.src=t,this._blendFunc.dst=e)},getOpacity:function(){return cc.logID(5901),0},setOpacity:function(t){cc.logID(5902)},setOpacityModifyRGB:function(t){},isOpacityModifyRGB:function(){return!1},getFadeTime:function(){return 1/this._fadeDelta},setFadeTime:function(t){this._fadeDelta=1/t;var e=2+(0|60*t);this._maxPoints=e,this._nuPoints=0,this._pointState=new Float32Array(e),this._pointVertexes=new Float32Array(2*e),this._vertices=new Float32Array(4*e),this._texCoords=new Float32Array(4*e),this._colorPointer=new Uint8Array(8*e),this._verticesBuffer=gl.createBuffer(),this._texCoordsBuffer=gl.createBuffer(),this._colorPointerBuffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this._verticesBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._vertices,gl.DYNAMIC_DRAW),gl.bindBuffer(gl.ARRAY_BUFFER,this._texCoordsBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._texCoords,gl.DYNAMIC_DRAW),gl.bindBuffer(gl.ARRAY_BUFFER,this._colorPointerBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._colorPointer,gl.DYNAMIC_DRAW)},getMinSeg:function(){return this._minSeg},setMinSeg:function(t){this._minSeg=-1===t?this._stroke/5:t,this._minSeg*=this._minSeg},isFastMode:function(){return this.fastMode},setFastMode:function(t){this.fastMode=t},isStartingPositionInitialized:function(){return this.startingPositionInitialized},setStartingPositionInitialized:function(t){this.startingPositionInitialized=t},getStroke:function(){return this._stroke},setStroke:function(t){this._stroke=t},tintWithColor:function(t){this.color=t;for(var e=this._colorPointer,i=0,n=2*this._nuPoints;i<n;i++)e[4*i]=t.r,e[4*i+1]=t.g,e[4*i+2]=t.b},reset:function(){this._nuPoints=0},setPosition:function(t,e){this.startingPositionInitialized=!0,void 0===e?(this._positionR.x=t.x,this._positionR.y=t.y):(this._positionR.x=t,this._positionR.y=e)},getPositionX:function(){return this._positionR.x},setPositionX:function(t){this._positionR.x=t,this.startingPositionInitialized||(this.startingPositionInitialized=!0)},getPositionY:function(){return this._positionR.y},setPositionY:function(t){this._positionR.y=t,this.startingPositionInitialized||(this.startingPositionInitialized=!0)},update:function(t){if(this.startingPositionInitialized){t*=this._fadeDelta;var e,i,r,o,s=0,a=this._nuPoints,c=this._pointState,h=this._pointVertexes,l=this._vertices,u=this._colorPointer;for(r=0;r<a;r++)if(c[r]-=t,c[r]<=0)s++;else{e=r-s,s>0?(c[e]=c[r],h[2*e]=h[2*r],h[2*e+1]=h[2*r+1],o=2*r,l[2*(i=2*e)]=l[2*o],l[2*i+1]=l[2*o+1],l[2*(i+1)]=l[2*(o+1)],l[2*(i+1)+1]=l[2*(o+1)+1],o*=4,u[(i*=4)+0]=u[o+0],u[i+1]=u[o+1],u[i+2]=u[o+2],u[i+4]=u[o+4],u[i+5]=u[o+5],u[i+6]=u[o+6]):i=8*e;var d=255*c[e];u[i+3]=d,u[i+7]=d}var _=!0;if((a-=s)>=this._maxPoints)_=!1;else if(a>0){var f=cc.p(h[2*(a-1)],h[2*(a-1)+1]),p=cc.pDistanceSQ(f,this._positionR)<this._minSeg,g=cc.p(h[2*(a-2)],h[2*(a-2)+1]),v=1!==a&&cc.pDistanceSQ(g,this._positionR)<2*this._minSeg;(p||v)&&(_=!1)}if(_){h[2*a]=this._positionR.x,h[2*a+1]=this._positionR.y,c[a]=1;var m=8*a,y=this.getDisplayedColor();u[m]=y.r,u[m+1]=y.g,u[m+2]=y.b,u[m+4]=y.r,u[m+5]=y.g,u[m+6]=y.b,u[m+3]=255,u[m+7]=255,a>0&&this.fastMode&&(a>1?n(h,this._stroke,this._vertices,a,1):n(h,this._stroke,this._vertices,0,2)),a++}if(this.fastMode||n(h,this._stroke,this._vertices,0,a),a&&this._previousNuPoints!==a){var T=1/a,C=this._texCoords;for(r=0;r<a;r++)C[4*r]=0,C[4*r+1]=T*r,C[2*(2*r+1)]=1,C[2*(2*r+1)+1]=T*r;this._previousNuPoints=a}this._nuPoints=a}},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_WEBGL?new _ccsg.MotionStreak.WebGLRenderCmd(this):null}});var o=_ccsg.MotionStreak.prototype;Object.defineProperty(o,"x",{get:o.getPositionX,set:o.setPositionX}),Object.defineProperty(o,"y",{get:o.getPositionY,set:o.setPositionY})}),{}],227:[(function(t,e,i){_ccsg.MotionStreak.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._matrix=new cc.math.Matrix4,this._matrix.identity(),this._shaderProgram=cc.shaderCache.programForKey(cc.macro.SHADER_POSITION_TEXTURECOLOR)},_ccsg.MotionStreak.WebGLRenderCmd.prototype=Object.create(_ccsg.Node.WebGLRenderCmd.prototype),_ccsg.MotionStreak.WebGLRenderCmd.prototype.constructor=_ccsg.Sprite.WebGLRenderCmd,_ccsg.MotionStreak.WebGLRenderCmd.prototype.rendering=function(t){var e=this._node;if(!(e._nuPoints<=1)&&e.texture&&e.texture.isLoaded()){t=t||cc._renderContext,this._updateDisplayColor();var i=this._worldTransform,n=this._matrix.mat;n[0]=i.a,n[4]=i.c,n[12]=i.tx,n[1]=i.b,n[5]=i.d,n[13]=i.ty,this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix),cc.gl.blendFunc(e._blendFunc.src,e._blendFunc.dst),cc.gl.bindTexture2DN(0,e.texture),t.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_POSITION),t.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_COLOR),t.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_TEX_COORDS),t.bindBuffer(t.ARRAY_BUFFER,e._verticesBuffer),t.bufferData(t.ARRAY_BUFFER,e._vertices,t.DYNAMIC_DRAW),t.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_POSITION,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,e._texCoordsBuffer),t.bufferData(t.ARRAY_BUFFER,e._texCoords,t.DYNAMIC_DRAW),t.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_TEX_COORDS,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,e._colorPointerBuffer),t.bufferData(t.ARRAY_BUFFER,e._colorPointer,t.DYNAMIC_DRAW),t.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_COLOR,4,t.UNSIGNED_BYTE,!0,0,0),t.drawArrays(t.TRIANGLE_STRIP,0,2*e._nuPoints),cc.g_NumberOfDraws++}}}),{}],228:[(function(t,e,i){var n=t("../compression/zlib.min"),r=cc._Class.extend({ctor:function(t){var e,i,n,r,o,s,a,c,h,l,u,d,_,f;for(this.data=t,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},o=null;;){switch(e=this.readUInt32(),h=function(){var t,e;for(e=[],s=t=0;t<4;s=++t)e.push(String.fromCharCode(this.data[this.pos++]));return e}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(e);break;case"fcTL":o&&this.animation.frames.push(o),this.pos+=4,o={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},r=this.readUInt16(),n=this.readUInt16()||100,o.delay=1e3*r/n,o.disposeOp=this.data[this.pos++],o.blendOp=this.data[this.pos++],o.data=[];break;case"IDAT":case"fdAT":for("fdAT"===h&&(this.pos+=4,e-=4),t=(null!=o?o.data:void 0)||this.imgData,s=d=0;0<=e?d<e:d>e;s=0<=e?++d:--d)t.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(this.transparency.indexed=this.read(e),(l=255-this.transparency.indexed.length)>0)for(s=_=0;0<=l?_<l:_>l;s=0<=l?++_:--_)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(e)[0];break;case 2:this.transparency.rgb=this.read(e)}break;case"tEXt":a=(u=this.read(e)).indexOf(0),c=String.fromCharCode.apply(String,u.slice(0,a)),this.text[c]=String.fromCharCode.apply(String,u.slice(a+1));break;case"IEND":return o&&this.animation.frames.push(o),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(f=this.colorType)||6===f,i=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*i,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(Uint8Array!=Array&&(this.imgData=new Uint8Array(this.imgData)));default:this.pos+=e}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}},read:function(t){var e,i;for(i=[],e=0;0<=t?e<t:e>t;0<=t?++e:--e)i.push(this.data[this.pos++]);return i},readUInt32:function(){var t,e,i,n;return t=this.data[this.pos++]<<24,e=this.data[this.pos++]<<16,i=this.data[this.pos++]<<8,n=this.data[this.pos++],t|e|i|n},readUInt16:function(){var t,e;return t=this.data[this.pos++]<<8,e=this.data[this.pos++],t|e},decodePixels:function(t){var e,i,r,o,s,a,c,h,l,u,d,_,f,p,g,v,m,y,T,C,x,E,S;if(null==t&&(t=this.imgData),0===t.length)return new Uint8Array(0);for(t=new n.Inflate(t,{index:0,verify:!1}).decompress(),v=(_=this.pixelBitlength/8)*this.width,f=new Uint8Array(v*this.height),a=t.length,g=0,p=0,i=0;p<a;){switch(t[p++]){case 0:for(o=T=0;T<v;o=T+=1)f[i++]=t[p++];break;case 1:for(o=C=0;C<v;o=C+=1)e=t[p++],s=o<_?0:f[i-_],f[i++]=(e+s)%256;break;case 2:for(o=x=0;x<v;o=x+=1)e=t[p++],r=(o-o%_)/_,m=g&&f[(g-1)*v+r*_+o%_],f[i++]=(m+e)%256;break;case 3:for(o=E=0;E<v;o=E+=1)e=t[p++],r=(o-o%_)/_,s=o<_?0:f[i-_],m=g&&f[(g-1)*v+r*_+o%_],f[i++]=(e+Math.floor((s+m)/2))%256;break;case 4:for(o=S=0;S<v;o=S+=1)e=t[p++],r=(o-o%_)/_,s=o<_?0:f[i-_],0===g?m=y=0:(m=f[(g-1)*v+r*_+o%_],y=r&&f[(g-1)*v+(r-1)*_+o%_]),c=s+m-y,h=Math.abs(c-s),u=Math.abs(c-m),d=Math.abs(c-y),l=h<=u&&h<=d?s:u<=d?m:y,f[i++]=(e+l)%256;break;default:throw new Error("Invalid filter algorithm: "+t[p-1])}g++}return f},copyToImageData:function(t,e){var i,n,r,o,s,a,c,h,l,u,d;if(n=this.colors,l=null,i=this.hasAlphaChannel,this.palette.length&&(l=null!=(d=this._decodedPalette)?d:this._decodedPalette=this.decodePalette(),n=4,i=!0),r=t.data||t,h=r.length,s=l||e,o=a=0,1===n)for(;o<h;)c=l?4*e[o/4]:a,u=s[c++],r[o++]=u,r[o++]=u,r[o++]=u,r[o++]=i?s[c++]:255,a=c;else for(;o<h;)c=l?4*e[o/4]:a,r[o++]=s[c++],r[o++]=s[c++],r[o++]=s[c++],r[o++]=i?s[c++]:255,a=c},decodePalette:function(){var t,e,i,n,r,o,s,a,c;for(i=this.palette,o=this.transparency.indexed||[],r=new Uint8Array((o.length||0)+i.length),n=0,t=0,e=s=0,a=i.length;s<a;e=s+=3)r[n++]=i[e],r[n++]=i[e+1],r[n++]=i[e+2],r[n++]=null!=(c=o[t++])?c:255;return r},render:function(t){var e,i;return t.width=this.width,t.height=this.height,e=t.getContext("2d"),i=e.createImageData(this.width,this.height),this.copyToImageData(i,this.decodePixels()),e.putImageData(i,0,0)}});e.exports=r}),{"../compression/zlib.min":33}],229:[(function(t,e,i){var n=cc.Class({name:"cc.ParticleAsset",extends:cc.RawAsset});cc.ParticleAsset=e.exports=n}),{}],230:[(function(t,e,i){t("./CCParticleAsset"),t("./CCSGParticleSystem"),t("./CCSGParticleSystemCanvasRenderCmd"),t("./CCSGParticleSystemWebGLRenderCmd");var n=cc.BlendFunc.BlendFactor,r=cc.Enum({GRAVITY:0,RADIUS:1}),o=cc.Enum({FREE:0,RELATIVE:1,GROUPED:2}),s={preview:{default:!0,editorOnly:!0,notify:!1,animatable:!1,tooltip:!1},_custom:!1,custom:{get:function(){return this._custom},set:function(t){this._custom!==t&&(this._custom=t,t?this._applyCustoms():this._applyFile())},animatable:!1,tooltip:!1},_file:{default:"",url:cc.ParticleAsset},file:{get:function(){return this._file},set:function(t,e){this._file!==t&&(this._file=t,t?this._applyFile():this.custom=!0)},animatable:!1,url:cc.ParticleAsset,tooltip:!1},_texture:{default:"",url:cc.Texture2D},texture:{get:function(){return this._texture},set:function(t){this._texture=t,this._sgNode.texture=t?cc.textureCache.addImage(t):null,!t&&this._file&&this._applyFile()},url:cc.Texture2D,tooltip:!1},particleCount:{get:function(){return this._sgNode.particleCount},set:function(t){this._sgNode.particleCount=t},visible:!1,tooltip:!1},_srcBlendFactor:n.SRC_ALPHA,srcBlendFactor:{get:function(){return this._srcBlendFactor},set:function(t){this._srcBlendFactor=t,this._blendFunc.src=t,this._sgNode.setBlendFunc(this._blendFunc)},animatable:!1,type:n,tooltip:!1},_dstBlendFactor:n.ONE_MINUS_SRC_ALPHA,dstBlendFactor:{get:function(){return this._dstBlendFactor},set:function(t){this._dstBlendFactor=t,this._blendFunc.dst=t,this._sgNode.setBlendFunc(this._blendFunc)},animatable:!1,type:n,tooltip:!1},playOnLoad:!0,_autoRemoveOnFinish:!1,autoRemoveOnFinish:{get:function(){return this._autoRemoveOnFinish},set:function(t){this._autoRemoveOnFinish!==t&&(this._autoRemoveOnFinish=t,this._applyAutoRemove())},animatable:!1,tooltip:!1},active:{get:function(){return!!this._sgNode&&this._sgNode.isActive()},visible:!1}},a=(function(){for(var t={totalParticles:150,duration:-1,emissionRate:10,life:1,lifeVar:0,startColor:cc.Color.WHITE,startColorVar:cc.Color.BLACK,endColor:cc.color(255,255,255,0),endColorVar:cc.color(0,0,0,0),angle:90,angleVar:20,startSize:50,startSizeVar:0,endSize:0,endSizeVar:0,startSpin:0,startSpinVar:0,endSpin:0,endSpinVar:0,sourcePos:cc.p(0,0),posVar:cc.p(0,0),positionType:o.FREE,emitterMode:r.GRAVITY,gravity:cc.p(0,0),speed:180,speedVar:50,tangentialAccel:80,tangentialAccelVar:0,radialAccel:0,radialAccelVar:0,rotationIsDir:!1,startRadius:0,startRadiusVar:0,endRadius:0,endRadiusVar:0,rotatePerS:0,rotatePerSVar:0},e=Object.keys(t),i=0;i<e.length;++i){var n=e[i];!(function(t,e){var i="_"+t;s[i]=e;var n=e.constructor,r=s[t]={};cc.isChildClassOf(n,cc.ValueType)?(r.get=function(){return new n(this[i])},r.type=n):r.get=function(){return this[i]},cc.isChildClassOf(n,cc.ValueType)?r.set=function(e){this[i]=new n(e),this._sgNode[t]=e}:r.set=function(e){this[i]=e,this._sgNode[t]=e}})(n,t[n])}return e})();s.positionType.type=o,s.emitterMode.type=r;var c=cc.Class({name:"cc.ParticleSystem",extends:cc._RendererUnderSG,editor:!1,ctor:function(){this._previewTimer=null,this._focused=!1,this._willStart=!1,this._blendFunc=new cc.BlendFunc(0,0),this._originOnExit=null},properties:s,statics:{DURATION_INFINITY:-1,START_SIZE_EQUAL_TO_END_SIZE:-1,START_RADIUS_EQUAL_TO_END_RADIUS:-1,EmitterMode:r,PositionType:o},__preload:function(){this._super(),this.playOnLoad&&this.resetSystem(),this._applyAutoRemove()},onDestroy:function(){this._autoRemoveOnFinish&&(this.autoRemoveOnFinish=!1),this._super()},onFocusInEditor:!1,onLostFocusInEditor:!1,_createSgNode:function(){return new _ccsg.ParticleSystem},_initSgNode:function(){var t=this._sgNode;this._file?this._custom?!this._texture?this._applyFile():this._applyCustoms():this._applyFile():this._custom&&this._applyCustoms(),t.stopSystem()},addParticle:function(){return this._sgNode.addParticle()},stopSystem:function(){this._sgNode.stopSystem()},resetSystem:function(){this._sgNode.resetSystem()},isFull:function(){return this.particleCount>=this._totalParticles},setDisplayFrame:function(t){if(t){var e=t.getTexture();e&&(this._texture=e.url),this._sgNode.setDisplayFrame(t)}},setTextureWithRect:function(t,e){t instanceof cc.Texture2D&&(this._texture=t.url),this._sgNode.setTextureWithRect(t,e)},_applyFile:function(){var t=this._file;if(t){var e=this;cc.loader.load(t,(function(i,n){if(i||!n)throw i||new Error("Unkown error");if(e.isValid){var r=e._sgNode;r.particleCount=0;var o=r.isActive();r.initWithFile(t),n.textureUuid&&cc.AssetLibrary.queryAssetInfo(n.textureUuid,(function(t,i,n){t?cc.error(t):e.texture=i})),n.emissionRate&&(e.emissionRate=n.emissionRate),r.setPosition(0,0),o||r.stopSystem(),e._applyAutoRemove(),e._custom&&e._applyCustoms()}}))}},_applyCustoms:function(){for(var t=this._sgNode,e=t.isActive(),i=0;i<a.length;i++){var n=a[i];t[n]=this["_"+n]}this._blendFunc.src=this._srcBlendFactor,this._blendFunc.dst=this._dstBlendFactor,t.setBlendFunc(this._blendFunc),this._texture&&(t.texture=cc.textureCache.addImage(this._texture)),e||t.stopSystem(),this._applyAutoRemove()},_applyAutoRemove:function(){var t=this._sgNode,e=this._autoRemoveOnFinish;if(t.autoRemoveOnFinish=e,e){if(this._originOnExit)return;this._originOnExit=t.onExit;var i=this;t.onExit=function(){i._originOnExit.call(this),i.node.destroy()}}else this._originOnExit&&(t.onExit=this._originOnExit,this._originOnExit=null)}});cc.ParticleSystem=e.exports=c}),{"./CCParticleAsset":229,"./CCSGParticleSystem":231,"./CCSGParticleSystemCanvasRenderCmd":232,"./CCSGParticleSystemWebGLRenderCmd":233}],231:[(function(t,e,i){var n=t("./CCPNGReader"),r=t("./CCTIFFReader");t("../compression/ZipUtils"),cc.Particle=function(t,e,i,n,r,o,s,a,c,h,l,u){this.pos=t||cc.v2(0,0),this.startPos=e||cc.v2(0,0),this.color=i||cc.color(0,0,0,255),this.deltaColor=n||{r:0,g:0,b:0,a:255},this.size=r||0,this.deltaSize=o||0,this.rotation=s||0,this.deltaRotation=a||0,this.timeToLive=c||0,this.atlasIndex=h||0,this.modeA=l||new cc.Particle.ModeA,this.modeB=u||new cc.Particle.ModeB,this.isChangeColor=!1,this.drawPos=cc.p(0,0)},cc.Particle.ModeA=function(t,e,i){this.dir=t||cc.p(0,0),this.radialAccel=e||0,this.tangentialAccel=i||0},cc.Particle.ModeB=function(t,e,i,n){this.angle=t||0,this.degreesPerSecond=e||0,this.radius=i||0,this.deltaRadius=n||0},cc.Particle.TemporaryPoints=[cc.p(),cc.p(),cc.p(),cc.p()],_ccsg.ParticleSystem=_ccsg.Node.extend({_className:"ParticleSystem",_plistFile:"",_elapsed:0,_dontTint:!1,modeA:null,modeB:null,_pointZeroForParticle:cc.p(0,0),_particles:null,_emitCounter:0,_particleIdx:0,atlasIndex:0,_allocatedParticles:0,_isActive:!1,particleCount:0,duration:0,_sourcePosition:null,_posVar:null,life:0,lifeVar:0,angle:0,angleVar:0,startSize:0,startSizeVar:0,endSize:0,endSizeVar:0,_startColor:null,_startColorVar:null,_endColor:null,_endColorVar:null,startSpin:0,startSpinVar:0,endSpin:0,endSpinVar:0,emissionRate:0,_totalParticles:0,_texture:null,_blendFunc:null,_opacityModifyRGB:!1,positionType:null,autoRemoveOnFinish:!1,emitterMode:0,_textureLoaded:null,ctor:function(t){if(_ccsg.Node.prototype.ctor.call(this),this.emitterMode=_ccsg.ParticleSystem.Mode.GRAVITY,this.modeA=new _ccsg.ParticleSystem.ModeA,this.modeB=new _ccsg.ParticleSystem.ModeB,this._blendFunc={src:cc.macro.BLEND_SRC,dst:cc.macro.BLEND_DST},this._particles=[],this._sourcePosition=cc.p(0,0),this._posVar=cc.p(0,0),this._startColor=cc.color(255,255,255,255),this._startColorVar=cc.color(255,255,255,255),this._endColor=cc.color(255,255,255,255),this._endColorVar=cc.color(255,255,255,255),this._plistFile="",this._elapsed=0,this._dontTint=!1,this._pointZeroForParticle=cc.p(0,0),this._emitCounter=0,this._particleIdx=0,this.atlasIndex=0,this._allocatedParticles=0,this._isActive=!1,this.particleCount=0,this.duration=0,this.life=0,this.lifeVar=0,this.angle=0,this.angleVar=0,this.startSize=0,this.startSizeVar=0,this.endSize=0,this.endSizeVar=0,this.startSpin=0,this.startSpinVar=0,this.endSpin=0,this.endSpinVar=0,this.emissionRate=0,this._totalParticles=0,this._texture=null,this._opacityModifyRGB=!1,this.positionType=_ccsg.ParticleSystem.Type.FREE,this.autoRemoveOnFinish=!1,this._textureLoaded=!0,!t||cc.js.isNumber(t)){var e=t||100;this.setDrawMode(_ccsg.ParticleSystem.TEXTURE_MODE),this.initWithTotalParticles(e)}else"string"==typeof t?this.initWithFile(t):"object"==typeof t&&this.initWithDictionary(t,"")},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new _ccsg.ParticleSystem.CanvasRenderCmd(this):new _ccsg.ParticleSystem.WebGLRenderCmd(this)},ignoreColor:function(t){this._dontTint=t},initTexCoordsWithRect:function(t){this._renderCmd.initTexCoordsWithRect(t)},getAtlasIndex:function(){return this.atlasIndex},setAtlasIndex:function(t){this.atlasIndex=t},getDrawMode:function(){return this._renderCmd.getDrawMode()},setDrawMode:function(t){this._renderCmd.setDrawMode(t)},getShapeType:function(){return this._renderCmd.getShapeType()},setShapeType:function(t){this._renderCmd.setShapeType(t)},isActive:function(){return this._isActive},getParticleCount:function(){return this.particleCount},setParticleCount:function(t){this.particleCount=t},getDuration:function(){return this.duration},setDuration:function(t){this.duration=t},getSourcePosition:function(){return{x:this._sourcePosition.x,y:this._sourcePosition.y}},setSourcePosition:function(t){this._sourcePosition.x=t.x,this._sourcePosition.y=t.y},getPosVar:function(){return{x:this._posVar.x,y:this._posVar.y}},setPosVar:function(t){this._posVar.x=t.x,this._posVar.y=t.y},getLife:function(){return this.life},setLife:function(t){this.life=t},getLifeVar:function(){return this.lifeVar},setLifeVar:function(t){this.lifeVar=t},getAngle:function(){return this.angle},setAngle:function(t){this.angle=t},getAngleVar:function(){return this.angleVar},setAngleVar:function(t){this.angleVar=t},getGravity:function(){var t=this.modeA.gravity;return cc.p(t.x,t.y)},setGravity:function(t){this.modeA.gravity=t},getSpeed:function(){return this.modeA.speed},setSpeed:function(t){this.modeA.speed=t},getSpeedVar:function(){return this.modeA.speedVar},setSpeedVar:function(t){this.modeA.speedVar=t},getTangentialAccel:function(){return this.modeA.tangentialAccel},setTangentialAccel:function(t){this.modeA.tangentialAccel=t},getTangentialAccelVar:function(){return this.modeA.tangentialAccelVar},setTangentialAccelVar:function(t){this.modeA.tangentialAccelVar=t},getRadialAccel:function(){return this.modeA.radialAccel},setRadialAccel:function(t){this.modeA.radialAccel=t},getRadialAccelVar:function(){return this.modeA.radialAccelVar},setRadialAccelVar:function(t){this.modeA.radialAccelVar=t},getRotationIsDir:function(){return this.modeA.rotationIsDir},setRotationIsDir:function(t){this.modeA.rotationIsDir=t},getStartRadius:function(){return this.modeB.startRadius},setStartRadius:function(t){this.modeB.startRadius=t},getStartRadiusVar:function(){return this.modeB.startRadiusVar},setStartRadiusVar:function(t){this.modeB.startRadiusVar=t},getEndRadius:function(){return this.modeB.endRadius},setEndRadius:function(t){this.modeB.endRadius=t},getEndRadiusVar:function(){return this.modeB.endRadiusVar},setEndRadiusVar:function(t){this.modeB.endRadiusVar=t},getRotatePerSecond:function(){return this.modeB.rotatePerSecond},setRotatePerSecond:function(t){this.modeB.rotatePerSecond=t},getRotatePerSecondVar:function(){return this.modeB.rotatePerSecondVar},setRotatePerSecondVar:function(t){this.modeB.rotatePerSecondVar=t},getStartSize:function(){return this.startSize},setStartSize:function(t){this.startSize=t},getStartSizeVar:function(){return this.startSizeVar},setStartSizeVar:function(t){this.startSizeVar=t},getEndSize:function(){return this.endSize},setEndSize:function(t){this.endSize=t},getEndSizeVar:function(){return this.endSizeVar},setEndSizeVar:function(t){this.endSizeVar=t},getStartColor:function(){return cc.color(this._startColor.r,this._startColor.g,this._startColor.b,this._startColor.a)},setStartColor:function(t){this._startColor.fromColor(t)},getStartColorVar:function(){return cc.color(this._startColorVar.r,this._startColorVar.g,this._startColorVar.b,this._startColorVar.a)},setStartColorVar:function(t){this._startColorVar.fromColor(t)},getEndColor:function(){return cc.color(this._endColor.r,this._endColor.g,this._endColor.b,this._endColor.a)},setEndColor:function(t){this._endColor.fromColor(t)},getEndColorVar:function(){return cc.color(this._endColorVar.r,this._endColorVar.g,this._endColorVar.b,this._endColorVar.a)},setEndColorVar:function(t){this._endColorVar.fromColor(t)},getStartSpin:function(){return this.startSpin},setStartSpin:function(t){this.startSpin=t},getStartSpinVar:function(){return this.startSpinVar},setStartSpinVar:function(t){this.startSpinVar=t},getEndSpin:function(){return this.endSpin},setEndSpin:function(t){this.endSpin=t},getEndSpinVar:function(){return this.endSpinVar},setEndSpinVar:function(t){this.endSpinVar=t},getEmissionRate:function(){return this.emissionRate},setEmissionRate:function(t){this.emissionRate=t},getTotalParticles:function(){return this._totalParticles},setTotalParticles:function(t){this._renderCmd.setTotalParticles(t)},getTexture:function(){return this._texture},setTexture:function(t){t&&(t.isLoaded()?this.setTextureWithRect(t,cc.rect(0,0,t.width,t.height)):(this._textureLoaded=!1,t.once("load",(function(e){this._textureLoaded=!0,this.setTextureWithRect(t,cc.rect(0,0,t.width,t.height))}),this)))},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(t,e){void 0===e?this._blendFunc!==t&&(this._blendFunc=t,this._updateBlendFunc()):this._blendFunc.src===t&&this._blendFunc.dst===e||(this._blendFunc={src:t,dst:e},this._updateBlendFunc())},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setOpacityModifyRGB:function(t){this._opacityModifyRGB=t},isBlendAdditive:function(){return this._blendFunc.src===cc.macro.SRC_ALPHA&&this._blendFunc.dst===cc.macro.ONE||this._blendFunc.src===cc.macro.ONE&&this._blendFunc.dst===cc.macro.ONE},setBlendAdditive:function(t){var e=this._blendFunc;t?(e.src=cc.macro.SRC_ALPHA,e.dst=cc.macro.ONE):this._renderCmd._setBlendAdditive()},getPositionType:function(){return this.positionType},setPositionType:function(t){this.positionType=t},isAutoRemoveOnFinish:function(){return this.autoRemoveOnFinish},setAutoRemoveOnFinish:function(t){this.autoRemoveOnFinish=t},getEmitterMode:function(){return this.emitterMode},setEmitterMode:function(t){this.emitterMode=t},init:function(){return this.initWithTotalParticles(150)},initWithFile:function(t){this._plistFile=t;var e=cc.loader.getRes(t);return e?this.initWithDictionary(e,""):(cc.logID(6008),!1)},getBoundingBoxToWorld:function(){return cc.rect(0,0,cc._canvas.width,cc._canvas.height)},initWithDictionary:function(t,e){var i=!1,o=null,s=this._valueForKey,a=parseInt(s("maxParticles",t));if(this.initWithTotalParticles(a)){this.angle=parseFloat(s("angle",t)),this.angleVar=parseFloat(s("angleVariance",t)),this.duration=parseFloat(s("duration",t)),this._blendFunc.src=parseInt(s("blendFuncSource",t)),this._blendFunc.dst=parseInt(s("blendFuncDestination",t));var c=this._startColor;c.r=255*parseFloat(s("startColorRed",t)),c.g=255*parseFloat(s("startColorGreen",t)),c.b=255*parseFloat(s("startColorBlue",t)),c.a=255*parseFloat(s("startColorAlpha",t));var h=this._startColorVar;h.r=255*parseFloat(s("startColorVarianceRed",t)),h.g=255*parseFloat(s("startColorVarianceGreen",t)),h.b=255*parseFloat(s("startColorVarianceBlue",t)),h.a=255*parseFloat(s("startColorVarianceAlpha",t));var l=this._endColor;l.r=255*parseFloat(s("finishColorRed",t)),l.g=255*parseFloat(s("finishColorGreen",t)),l.b=255*parseFloat(s("finishColorBlue",t)),l.a=255*parseFloat(s("finishColorAlpha",t));var u=this._endColorVar;if(u.r=255*parseFloat(s("finishColorVarianceRed",t)),u.g=255*parseFloat(s("finishColorVarianceGreen",t)),u.b=255*parseFloat(s("finishColorVarianceBlue",t)),u.a=255*parseFloat(s("finishColorVarianceAlpha",t)),this.startSize=parseFloat(s("startParticleSize",t)),this.startSizeVar=parseFloat(s("startParticleSizeVariance",t)),this.endSize=parseFloat(s("finishParticleSize",t)),this.endSizeVar=parseFloat(s("finishParticleSizeVariance",t)),this.setPosition(parseFloat(s("sourcePositionx",t)),parseFloat(s("sourcePositiony",t))),this._posVar.x=parseFloat(s("sourcePositionVariancex",t)),this._posVar.y=parseFloat(s("sourcePositionVariancey",t)),this.startSpin=parseFloat(s("rotationStart",t)),this.startSpinVar=parseFloat(s("rotationStartVariance",t)),this.endSpin=parseFloat(s("rotationEnd",t)),this.endSpinVar=parseFloat(s("rotationEndVariance",t)),this.emitterMode=parseInt(s("emitterType",t)),this.emitterMode===_ccsg.ParticleSystem.Mode.GRAVITY){var d=this.modeA;d.gravity.x=parseFloat(s("gravityx",t)),d.gravity.y=parseFloat(s("gravityy",t)),d.speed=parseFloat(s("speed",t)),d.speedVar=parseFloat(s("speedVariance",t));var _=s("radialAcceleration",t);d.radialAccel=_?parseFloat(_):0,_=s("radialAccelVariance",t),d.radialAccelVar=_?parseFloat(_):0,_=s("tangentialAcceleration",t),d.tangentialAccel=_?parseFloat(_):0,_=s("tangentialAccelVariance",t),d.tangentialAccelVar=_?parseFloat(_):0;var f=s("rotationIsDir",t);null!==f?(f=f.toString().toLowerCase(),d.rotationIsDir="true"===f||"1"===f):d.rotationIsDir=!1}else{if(this.emitterMode!==_ccsg.ParticleSystem.Mode.RADIUS)return cc.logID(6009),!1;var p=this.modeB;p.startRadius=parseFloat(s("maxRadius",t)),p.startRadiusVar=parseFloat(s("maxRadiusVariance",t)),p.endRadius=parseFloat(s("minRadius",t)),p.endRadiusVar=0,p.rotatePerSecond=parseFloat(s("rotatePerSecond",t)),p.rotatePerSecondVar=parseFloat(s("rotatePerSecondVariance",t))}this.life=parseFloat(s("particleLifespan",t)),this.lifeVar=parseFloat(s("particleLifespanVariance",t)),this.emissionRate=this._totalParticles/this.life,this._opacityModifyRGB=!1;var g=s("textureFileName",t),v=cc.path.changeBasename(this._plistFile,g),m=cc.textureCache.getTextureForKey(v);if(m)this.setTexture(m);else{var y=s("textureImageData",t);if(y&&0!==y.length){if(!(o=cc.Codec.unzipBase64AsArray(y,1)))return cc.logID(6010),!1;var T=cc.getImageFormatByData(o);if(T!==cc.ImageFormat.TIFF&&T!==cc.ImageFormat.PNG)return cc.logID(6011),!1;var C=document.createElement("canvas");T===cc.ImageFormat.PNG?new n(o).render(C):r.parseTIFF(o,C),cc.textureCache.cacheImage(v,C);var x=cc.textureCache.getTextureForKey(v);x||cc.logID(6012),this.setTexture(x)}else{if(!(m=cc.textureCache.addImage(v)))return!1;this.setTexture(m)}}i=!0}return i},initWithTotalParticles:function(t){this._totalParticles=t;var e=this._particles;if(!e)return cc.logID(6013),!1;e.length=t;for(var i=0;i<t;i++)e[i]=new cc.Particle;return this._allocatedParticles=t,this._isActive=!0,this._blendFunc.src=cc.macro.BLEND_SRC,this._blendFunc.dst=cc.macro.BLEND_DST,this.positionType=_ccsg.ParticleSystem.Type.FREE,this.emitterMode=_ccsg.ParticleSystem.Mode.GRAVITY,this.autoRemoveOnFinish=!1,this.scheduleUpdateWithPriority(1),this._renderCmd._initWithTotalParticles(t),!0},addParticle:function(){if(this.isFull())return!1;var t=this._renderCmd.addParticle();return this.initParticle(t),++this.particleCount,!0},initParticle:function(t){var e=cc.randomMinus1To1;t.timeToLive=this.life+this.lifeVar*e(),t.timeToLive=Math.max(0,t.timeToLive),t.pos.x=this._sourcePosition.x+this._posVar.x*e(),t.pos.y=this._sourcePosition.y+this._posVar.y*e();var i,n,r=this._startColor,o=this._startColorVar,s=this._endColor,a=this._endColorVar;i={r:cc.clampf(r.r+o.r*e(),0,255),g:cc.clampf(r.g+o.g*e(),0,255),b:cc.clampf(r.b+o.b*e(),0,255),a:cc.clampf(r.a+o.a*e(),0,255)},n={r:cc.clampf(s.r+a.r*e(),0,255),g:cc.clampf(s.g+a.g*e(),0,255),b:cc.clampf(s.b+a.b*e(),0,255),a:cc.clampf(s.a+a.a*e(),0,255)},t.color=i;var c=t.deltaColor,h=t.timeToLive;c.r=(n.r-i.r)/h,c.g=(n.g-i.g)/h,c.b=(n.b-i.b)/h,c.a=(n.a-i.a)/h;var l=this.startSize+this.startSizeVar*e();if(l=Math.max(0,l),t.size=l,this.endSize===_ccsg.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE)t.deltaSize=0;else{var u=this.endSize+this.endSizeVar*e();u=Math.max(0,u),t.deltaSize=(u-l)/h}var d=this.startSpin+this.startSpinVar*e(),_=this.endSpin+this.endSpinVar*e();t.rotation=d,t.deltaRotation=(_-d)/h,this.positionType===_ccsg.ParticleSystem.Type.FREE?t.startPos=this.convertToWorldSpace(this._pointZeroForParticle):this.positionType===_ccsg.ParticleSystem.Type.RELATIVE&&(t.startPos.x=this._position.x,t.startPos.y=this._position.y);var f=cc.degreesToRadians(this.angle+this.angleVar*e());if(this.emitterMode===_ccsg.ParticleSystem.Mode.GRAVITY){var p=this.modeA,g=t.modeA,v=p.speed+p.speedVar*e();g.dir.x=Math.cos(f),g.dir.y=Math.sin(f),cc.pMultIn(g.dir,v),g.radialAccel=p.radialAccel+p.radialAccelVar*e(),g.tangentialAccel=p.tangentialAccel+p.tangentialAccelVar*e(),p.rotationIsDir&&(t.rotation=-cc.radiansToDegrees(cc.pToAngle(g.dir)))}else{var m=this.modeB,y=t.modeB,T=m.startRadius+m.startRadiusVar*e(),C=m.endRadius+m.endRadiusVar*e();y.radius=T,y.deltaRadius=m.endRadius===_ccsg.ParticleSystem.START_RADIUS_EQUAL_TO_END_RADIUS?0:(C-T)/h,y.angle=f,y.degreesPerSecond=cc.degreesToRadians(m.rotatePerSecond+m.rotatePerSecondVar*e())}},stopSystem:function(){this._isActive=!1,this._elapsed=this.duration,this._emitCounter=0},resetSystem:function(){this._isActive=!0,this._elapsed=0;var t=this._particles;for(this._particleIdx=0;this._particleIdx<this.particleCount;++this._particleIdx)t[this._particleIdx].timeToLive=0},isFull:function(){return this.particleCount>=this._totalParticles},updateQuadWithParticle:function(t,e){this._renderCmd.updateQuadWithParticle(t,e)},postStep:function(){this._renderCmd.postStep()},update:function(t){if(this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty),this._isActive&&this.emissionRate){var e=1/this.emissionRate;for(this.particleCount<this._totalParticles&&(this._emitCounter+=t);this.particleCount<this._totalParticles&&this._emitCounter>e;)this.addParticle(),this._emitCounter-=e;this._elapsed+=t,-1!==this.duration&&this.duration<this._elapsed&&this.stopSystem()}this._particleIdx=0;var i=this.getWorldToNodeTransform(),n=cc.Particle.TemporaryPoints[0];if(this.positionType===_ccsg.ParticleSystem.Type.FREE?cc.pIn(n,this.convertToWorldSpace(this._pointZeroForParticle)):this.positionType===_ccsg.ParticleSystem.Type.RELATIVE&&(n.x=this._position.x,n.y=this._position.y),this._visible){for(var r=cc.Particle.TemporaryPoints[1],o=cc.Particle.TemporaryPoints[2],s=cc.Particle.TemporaryPoints[3],a=this._particles;this._particleIdx<this.particleCount;){cc.pZeroIn(r),cc.pZeroIn(o),cc.pZeroIn(s);var c=a[this._particleIdx];if(c.timeToLive-=t,c.timeToLive>0){if(this.emitterMode===_ccsg.ParticleSystem.Mode.GRAVITY){var h=s,l=r,u=o;c.pos.x||c.pos.y?(cc.pIn(l,c.pos),cc.pNormalizeIn(l)):cc.pZeroIn(l),cc.pIn(u,l),cc.pMultIn(l,c.modeA.radialAccel);var d=u.x;u.x=-u.y,u.y=d,cc.pMultIn(u,c.modeA.tangentialAccel),cc.pIn(h,l),cc.pAddIn(h,u),cc.pAddIn(h,this.modeA.gravity),cc.pMultIn(h,t),cc.pAddIn(c.modeA.dir,h),cc.pIn(h,c.modeA.dir),cc.pMultIn(h,t),cc.pAddIn(c.pos,h)}else{var _=c.modeB;_.angle+=_.degreesPerSecond*t,_.radius+=_.deltaRadius*t,c.pos.x=-Math.cos(_.angle)*_.radius,c.pos.y=-Math.sin(_.angle)*_.radius}this._renderCmd._updateDeltaColor(c,t),c.size+=c.deltaSize*t,c.size=Math.max(0,c.size),c.rotation+=c.deltaRotation*t;var f=r;if(this.positionType===_ccsg.ParticleSystem.Type.FREE||this.positionType===_ccsg.ParticleSystem.Type.RELATIVE){var p=o,g=s;cc._pointApplyAffineTransformIn(n,i,p),cc._pointApplyAffineTransformIn(c.startPos,i,g),cc.pSubIn(p,g),cc.pIn(f,c.pos),cc.pSubIn(f,p)}else cc.pIn(f,c.pos);this._renderCmd.updateParticlePosition(c,f),++this._particleIdx}else{c.atlasIndex;if(this._particleIdx!==this.particleCount-1){var v=a[this._particleIdx];a[this._particleIdx]=a[this.particleCount-1],a[this.particleCount-1]=v}if(0===--this.particleCount&&this.autoRemoveOnFinish)return this.unscheduleUpdate(),this._parent.removeChild(this,!0),void(this._renderCmd.updateLocalBB&&this._renderCmd.updateLocalBB())}}this._renderCmd.updateLocalBB&&this._renderCmd.updateLocalBB()}this.postStep()},updateWithNoTime:function(){this.update(0)},_valueForKey:function(t,e){if(e){var i=e[t];return null!=i?i:""}return""},_updateBlendFunc:function(){var t=this._texture;if(t&&t instanceof cc.Texture2D){this._opacityModifyRGB=!1;var e=this._blendFunc;e.src===cc.macro.BLEND_SRC&&e.dst===cc.macro.BLEND_DST&&(t.hasPremultipliedAlpha()?this._opacityModifyRGB=!0:(e.src=cc.macro.SRC_ALPHA,e.dst=cc.macro.ONE_MINUS_SRC_ALPHA))}},clone:function(){var t=new _ccsg.ParticleSystem;if(t.initWithTotalParticles(this.getTotalParticles())){t.setAngle(this.getAngle()),t.setAngleVar(this.getAngleVar()),t.setDuration(this.getDuration());var e=this.getBlendFunc();if(t.setBlendFunc(e.src,e.dst),t.setStartColor(this.getStartColor()),t.setStartColorVar(this.getStartColorVar()),t.setEndColor(this.getEndColor()),t.setEndColorVar(this.getEndColorVar()),t.setStartSize(this.getStartSize()),t.setStartSizeVar(this.getStartSizeVar()),t.setEndSize(this.getEndSize()),t.setEndSizeVar(this.getEndSizeVar()),t.setPosition(cc.p(this.x,this.y)),t.setPosVar(cc.p(this.getPosVar().x,this.getPosVar().y)),t.setPositionType(this.getPositionType()),t.setStartSpin(this.getStartSpin()||0),t.setStartSpinVar(this.getStartSpinVar()||0),t.setEndSpin(this.getEndSpin()||0),t.setEndSpinVar(this.getEndSpinVar()||0),t.setEmitterMode(this.getEmitterMode()),this.getEmitterMode()===_ccsg.ParticleSystem.Mode.GRAVITY){var i=this.getGravity();t.setGravity(cc.p(i.x,i.y)),t.setSpeed(this.getSpeed()),t.setSpeedVar(this.getSpeedVar()),t.setRadialAccel(this.getRadialAccel()),t.setRadialAccelVar(this.getRadialAccelVar()),t.setTangentialAccel(this.getTangentialAccel()),t.setTangentialAccelVar(this.getTangentialAccelVar())}else this.getEmitterMode()===_ccsg.ParticleSystem.Mode.RADIUS&&(t.setStartRadius(this.getStartRadius()),t.setStartRadiusVar(this.getStartRadiusVar()),t.setEndRadius(this.getEndRadius()),t.setEndRadiusVar(this.getEndRadiusVar()),t.setRotatePerSecond(this.getRotatePerSecond()),t.setRotatePerSecondVar(this.getRotatePerSecondVar()));t.setLife(this.getLife()),t.setLifeVar(this.getLifeVar()),t.setEmissionRate(this.getEmissionRate()),t.setOpacityModifyRGB(this.isOpacityModifyRGB());var n=this.getTexture();if(n){var r=n.getContentSize();t.setTextureWithRect(n,cc.rect(0,0,r.width,r.height))}}return t},setDisplayFrame:function(t){if(t){var e=t.getOffset();0===e.x&&0===e.y||cc.logID(6015);var i=t.getTexture();this._texture!==i&&this.setTexture(i)}},setTextureWithRect:function(t,e){this._texture!==t&&(this._texture=t,this._updateBlendFunc()),this.initTexCoordsWithRect(e)},listenBackToForeground:function(t){}});var o=_ccsg.ParticleSystem.prototype;o.opacityModifyRGB,cc.defineGetterSetter(o,"opacityModifyRGB",o.isOpacityModifyRGB,o.setOpacityModifyRGB),o.drawMode,cc.defineGetterSetter(o,"drawMode",o.getDrawMode,o.setDrawMode),o.shapeType,cc.defineGetterSetter(o,"shapeType",o.getShapeType,o.setShapeType),o.active,cc.defineGetterSetter(o,"active",o.isActive),o.sourcePos,cc.defineGetterSetter(o,"sourcePos",o.getSourcePosition,o.setSourcePosition),o.posVar,cc.defineGetterSetter(o,"posVar",o.getPosVar,o.setPosVar),o.gravity,cc.defineGetterSetter(o,"gravity",o.getGravity,o.setGravity),o.speed,cc.defineGetterSetter(o,"speed",o.getSpeed,o.setSpeed),o.speedVar,cc.defineGetterSetter(o,"speedVar",o.getSpeedVar,o.setSpeedVar),o.tangentialAccel,cc.defineGetterSetter(o,"tangentialAccel",o.getTangentialAccel,o.setTangentialAccel),o.tangentialAccelVar,cc.defineGetterSetter(o,"tangentialAccelVar",o.getTangentialAccelVar,o.setTangentialAccelVar),o.radialAccel,cc.defineGetterSetter(o,"radialAccel",o.getRadialAccel,o.setRadialAccel),o.radialAccelVar,cc.defineGetterSetter(o,"radialAccelVar",o.getRadialAccelVar,o.setRadialAccelVar),o.rotationIsDir,cc.defineGetterSetter(o,"rotationIsDir",o.getRotationIsDir,o.setRotationIsDir),o.startRadius,cc.defineGetterSetter(o,"startRadius",o.getStartRadius,o.setStartRadius),o.startRadiusVar,cc.defineGetterSetter(o,"startRadiusVar",o.getStartRadiusVar,o.setStartRadiusVar),o.endRadius,cc.defineGetterSetter(o,"endRadius",o.getEndRadius,o.setEndRadius),o.endRadiusVar,cc.defineGetterSetter(o,"endRadiusVar",o.getEndRadiusVar,o.setEndRadiusVar),o.rotatePerS,cc.defineGetterSetter(o,"rotatePerS",o.getRotatePerSecond,o.setRotatePerSecond),o.rotatePerSVar,cc.defineGetterSetter(o,"rotatePerSVar",o.getRotatePerSecondVar,o.setRotatePerSecondVar),o.startColor,cc.defineGetterSetter(o,"startColor",o.getStartColor,o.setStartColor),o.startColorVar,cc.defineGetterSetter(o,"startColorVar",o.getStartColorVar,o.setStartColorVar),o.endColor,cc.defineGetterSetter(o,"endColor",o.getEndColor,o.setEndColor),o.endColorVar,cc.defineGetterSetter(o,"endColorVar",o.getEndColorVar,o.setEndColorVar),o.totalParticles,cc.defineGetterSetter(o,"totalParticles",o.getTotalParticles,o.setTotalParticles),o.texture,cc.defineGetterSetter(o,"texture",o.getTexture,o.setTexture),_ccsg.ParticleSystem.ModeA=function(t,e,i,n,r,o,s,a){this.gravity=t||cc.p(0,0),this.speed=e||0,this.speedVar=i||0,this.tangentialAccel=n||0,this.tangentialAccelVar=r||0,this.radialAccel=o||0,this.radialAccelVar=s||0,this.rotationIsDir=a||!1},_ccsg.ParticleSystem.ModeB=function(t,e,i,n,r,o){this.startRadius=t||0,this.startRadiusVar=e||0,this.endRadius=i||0,this.endRadiusVar=n||0,this.rotatePerSecond=r||0,this.rotatePerSecondVar=o||0},_ccsg.ParticleSystem.SHAPE_MODE=0,_ccsg.ParticleSystem.TEXTURE_MODE=1,_ccsg.ParticleSystem.STAR_SHAPE=0,_ccsg.ParticleSystem.BALL_SHAPE=1,_ccsg.ParticleSystem.DURATION_INFINITY=-1,_ccsg.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE=-1,_ccsg.ParticleSystem.START_RADIUS_EQUAL_TO_END_RADIUS=-1,_ccsg.ParticleSystem.Mode=cc.Enum({GRAVITY:0,RADIUS:1}),_ccsg.ParticleSystem.Type=cc.Enum({FREE:0,RELATIVE:1,GROUPED:2})}),{"../compression/ZipUtils":30,"./CCPNGReader":228,"./CCTIFFReader":234}],232:[(function(t,e,i){_ccsg.ParticleSystem.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._drawMode=_ccsg.ParticleSystem.TEXTURE_MODE,this._shapeType=_ccsg.ParticleSystem.BALL_SHAPE,this._pointRect=cc.rect(0,0,0,0),this._localRegion=new cc.Region,this._tintCache=null};var n=_ccsg.ParticleSystem.CanvasRenderCmd.prototype=Object.create(_ccsg.Node.CanvasRenderCmd.prototype);n.constructor=_ccsg.ParticleSystem.CanvasRenderCmd,n.getDrawMode=function(){return this._drawMode},n.setDrawMode=function(t){this._drawMode=t},n.getShapeType=function(){return this._shapeType},n.setShapeType=function(t){this._shapeType=t},n.updateQuadWithParticle=function(t,e){},n.updateParticlePosition=function(t,e){cc.pIn(t.drawPos,e)};var r=new cc.Region,o=new cc.Rect;n.updateLocalBB=function(){var t=this._localRegion,e=this._node._particles;t.setEmpty();for(var i=e.length-1;i>=0;--i){var n=e[i],s=n.drawPos,a=1.415*n.size;r.setTo(s.x-a,s.y-a,s.x+a,s.y+a),t.union(r)}o.x=t._minX,o.y=t._minY,o.width=t._maxX-t._minX,o.height=t._maxY-t._minY},n.getLocalBB=function(){return o},n.updateStatus=function(){this.originUpdateStatus(),this._updateCurrentRegions(),this._regionFlag=_ccsg.Node.CanvasRenderCmd.RegionStatus.DirtyDouble,this._dirtyFlag&=~_ccsg.Node._dirtyFlags.contentDirty},n.rendering=function(t,e,i){var n=t||cc._renderContext,r=n.getContext(),o=this._node,s=this._pointRect;n.setTransform(this._worldTransform,e,i),n.save(),o.isBlendAdditive()?r.globalCompositeOperation="lighter":r.globalCompositeOperation="source-over";var a,c,h,l,u=this._node.particleCount,d=this._node._particles;if(o.drawMode!==_ccsg.ParticleSystem.SHAPE_MODE&&o._texture){if(!o._texture._textureLoaded)return void n.restore();var _=o._texture.getHtmlElementObj();if(!_.width||!_.height)return void n.restore();var f=_;for(a=0;a<u;a++)if(c=d[a],h=0|.5*c.size,0!==(l=c.color.a/255)){r.globalAlpha=l,r.save(),r.translate(0|c.drawPos.x,-(0|c.drawPos.y));var p=4*Math.floor(c.size/4),g=s.width,v=s.height;r.scale(Math.max(1/g*p,1e-6),Math.max(1/v*p,1e-6)),c.rotation&&r.rotate(cc.degreesToRadians(c.rotation)),f=c.isChangeColor?this._changeTextureColor(o._texture,c.color,this._pointRect):_,r.drawImage(f,-(0|g/2),-(0|v/2)),r.restore()}}else{var m=cc._drawingUtil;for(a=0;a<u;a++)h=0|.5*(c=d[a]).size,0!==(l=c.color.a/255)&&(r.globalAlpha=l,r.save(),r.translate(0|c.drawPos.x,-(0|c.drawPos.y)),o.shapeType===_ccsg.ParticleSystem.STAR_SHAPE?(c.rotation&&r.rotate(cc.degreesToRadians(c.rotation)),m.drawStar(n,h,c.color)):m.drawColorBall(n,h,c.color),r.restore())}n.restore(),cc.g_NumberOfDraws++},n._changeTextureColor=function(t,e,i){this._tintCache||(this._tintCache=document.createElement("canvas"));var n=this._tintCache,r=t.getContentSize();return n.width=r.width,n.height=r.height,t._generateColorTexture(e.r,e.g,e.b,i,n)},n.initTexCoordsWithRect=function(t){this._pointRect=t},n.setTotalParticles=function(t){this._node._totalParticles=t<200?t:200},n.addParticle=function(){var t,e=this._node,i=e._particles;return e.particleCount<i.length?t=i[e.particleCount]:(t=new cc.Particle,i.push(t)),t},n._setupVBO=function(){},n._allocMemory=function(){return!0},n.postStep=function(){},n._setBlendAdditive=function(){var t=this._node._blendFunc;t.src=cc.macro.BLEND_SRC,t.dst=cc.macro.BLEND_DST},n._initWithTotalParticles=function(t){},n._updateDeltaColor=function(t,e){this._node._dontTint||(t.color.r+=t.deltaColor.r*e,t.color.g+=t.deltaColor.g*e,t.color.b+=t.deltaColor.b*e,t.color.a+=t.deltaColor.a*e,t.isChangeColor=!0)}}),{}],233:[(function(t,e,i){_ccsg.ParticleSystem.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._matrix=new cc.math.Matrix4,this._matrix.identity(),this._buffersVBO=[0,0],this._quads=[],this._indices=[],this._quadsArrayBuffer=null};var n=_ccsg.ParticleSystem.WebGLRenderCmd.prototype=Object.create(_ccsg.Node.WebGLRenderCmd.prototype);n.constructor=_ccsg.ParticleSystem.WebGLRenderCmd,n.getDrawMode=function(){},n.setDrawMode=function(t){},n.getShapeType=function(){},n.setShapeType=function(t){},n.initIndices=function(t){for(var e=this._indices,i=0,n=t;i<n;++i){var r=6*i,o=4*i;e[r+0]=o+0,e[r+1]=o+1,e[r+2]=o+2,e[r+5]=o+1,e[r+4]=o+2,e[r+3]=o+3}},n.isDifferentTexture=function(t,e){return t===e},n.updateParticlePosition=function(t,e){this.updateQuadWithParticle(t,e)},n.updateQuadWithParticle=function(t,e){var i=null,n=this._node;i=this._quads[n._particleIdx];var r,o,s,a;n._opacityModifyRGB?(r=0|t.color.r*t.color.a/255,o=0|t.color.g*t.color.a/255,s=0|t.color.b*t.color.a/255):(r=0|t.color.r,o=0|t.color.g,s=0|t.color.b),a=0|t.color.a;var c=i.bl.colors,h=i.br.colors,l=i.tl.colors,u=i.tr.colors;c.r=h.r=l.r=u.r=r,c.g=h.g=l.g=u.g=o,c.b=h.b=l.b=u.b=s,c.a=h.a=l.a=u.a=a;var d=t.size/2;if(t.rotation){var _=-d,f=-d,p=d,g=d,v=e.x,m=e.y,y=-cc.degreesToRadians(t.rotation),T=Math.cos(y),C=Math.sin(y),x=_*T-f*C+v,E=_*C+f*T+m,S=p*T-f*C+v,b=p*C+f*T+m,A=p*T-g*C+v,R=p*C+g*T+m,I=_*T-g*C+v,w=_*C+g*T+m;i.bl.vertices.x=x,i.bl.vertices.y=E,i.br.vertices.x=S,i.br.vertices.y=b,i.tl.vertices.x=I,i.tl.vertices.y=w,i.tr.vertices.x=A,i.tr.vertices.y=R}else i.bl.vertices.x=e.x-d,i.bl.vertices.y=e.y-d,i.br.vertices.x=e.x+d,i.br.vertices.y=e.y-d,i.tl.vertices.x=e.x-d,i.tl.vertices.y=e.y+d,i.tr.vertices.x=e.x+d,i.tr.vertices.y=e.y+d},n.rendering=function(t){var e=this._node;if(e._texture){var i=t||cc._renderContext,n=this._worldTransform,r=this._matrix.mat;r[0]=n.a,r[4]=n.c,r[12]=n.tx,r[1]=n.b,r[5]=n.d,r[13]=n.ty,this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix),cc.gl.bindTexture2DN(0,e._texture),cc.gl.blendFuncForParticle(e._blendFunc.src,e._blendFunc.dst),i.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_POSITION),i.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_COLOR),i.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_TEX_COORDS),i.bindBuffer(i.ARRAY_BUFFER,this._buffersVBO[0]),i.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_POSITION,3,i.FLOAT,!1,24,0),i.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_COLOR,4,i.UNSIGNED_BYTE,!0,24,12),i.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_TEX_COORDS,2,i.FLOAT,!1,24,16),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]),i.drawElements(i.TRIANGLES,6*e._particleIdx,i.UNSIGNED_SHORT,0)}},n.initTexCoordsWithRect=function(t){var e=this._node,i=e.texture,n=t.width,r=t.height;i&&(n=i.getPixelWidth(),r=i.getPixelHeight());var o,s,a,c;cc.macro.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(o=(2*t.x+1)/(2*n),s=(2*t.y+1)/(2*r),a=o+(2*t.width-2)/(2*n),c=s+(2*t.height-2)/(2*r)):(o=t.x/n,s=t.y/r,a=o+t.width/n,c=s+t.height/r);var h=c;c=s,s=h;for(var l=this._quads,u=e._totalParticles,d=0;d<u;d++){l[d]||(l[d]=cc.V3F_C4B_T2F_QuadZero());var _=l[d];_.bl.texCoords.u=o,_.bl.texCoords.v=s,_.br.texCoords.u=a,_.br.texCoords.v=s,_.tl.texCoords.u=o,_.tl.texCoords.v=c,_.tr.texCoords.u=a,_.tr.texCoords.v=c}},n.setTotalParticles=function(t){var e=this._node;if(t>e._allocatedParticles){var i=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;this._indices=new Uint16Array(6*t);var n=new ArrayBuffer(t*i),r=e._particles;r.length=0;var o=this._quads;o.length=0;for(var s=0;s<t;s++)r[s]=new cc.Particle,o[s]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,n,s*i);e._allocatedParticles=t,e._totalParticles=t,this._quadsArrayBuffer=n,this.initIndices(t),this._setupVBO(),e._texture&&this.initTexCoordsWithRect(cc.rect(0,0,e._texture.width,e._texture.height))}else e._totalParticles=t;e.resetSystem()},n.addParticle=function(){var t=this._node;return t._particles[t.particleCount]},n._setupVBO=function(){var t=cc._renderContext;this._buffersVBO[0]=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this._buffersVBO[0]),t.bufferData(t.ARRAY_BUFFER,this._quadsArrayBuffer,t.DYNAMIC_DRAW),this._buffersVBO[1]=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this._indices,t.STATIC_DRAW)},n._allocMemory=function(){var t=this._node,e=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,i=t._totalParticles,n=this._quads;n.length=0,this._indices=new Uint16Array(6*i);for(var r=new ArrayBuffer(e*i),o=0;o<i;o++)n[o]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,r,o*e);return n&&this._indices?(this._quadsArrayBuffer=r,!0):(cc.logID(6013),!1)},n.postStep=function(){var t=cc._renderContext;t.bindBuffer(t.ARRAY_BUFFER,this._buffersVBO[0]),t.bufferSubData(t.ARRAY_BUFFER,0,this._quadsArrayBuffer)},n._setBlendAdditive=function(){var t=this._node._blendFunc;this._texture&&!this._texture.hasPremultipliedAlpha()?(t.src=cc.macro.SRC_ALPHA,t.dst=cc.macro.ONE_MINUS_SRC_ALPHA):(t.src=cc.macro.BLEND_SRC,t.dst=cc.macro.BLEND_DST)},n._initWithTotalParticles=function(t){if(!this._allocMemory())return!1;this.initIndices(t),this._setupVBO(),this._shaderProgram=cc.shaderCache.programForKey(cc.macro.SHADER_POSITION_TEXTURECOLOR)},n._updateDeltaColor=function(t,e){t.color.r+=t.deltaColor.r*e,t.color.g+=t.deltaColor.g*e,t.color.b+=t.deltaColor.b*e,t.color.a+=t.deltaColor.a*e,t.isChangeColor=!0}}),{}],234:[(function(t,e,i){var n={_littleEndian:!1,_tiffData:null,_fileDirectories:[],getUint8:function(t){return this._tiffData[t]},getUint16:function(t){return this._littleEndian?this._tiffData[t+1]<<8|this._tiffData[t]:this._tiffData[t]<<8|this._tiffData[t+1]},getUint32:function(t){var e=this._tiffData;return this._littleEndian?e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]:e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]},checkLittleEndian:function(){var t=this.getUint16(0);if(18761===t)this.littleEndian=!0;else{if(19789!==t)throw console.log(t),TypeError("Invalid byte order value.");this.littleEndian=!1}return this.littleEndian},hasTowel:function(){if(42!==this.getUint16(2))throw RangeError("You forgot your towel!");return!0},getFieldTypeName:function(t){var e=this.fieldTypeNames;return t in e?e[t]:null},getFieldTagName:function(t){var e=this.fieldTagNames;return t in e?e[t]:(console.log("Unknown Field Tag:",t),"Tag"+t)},getFieldTypeLength:function(t){return-1!==["BYTE","ASCII","SBYTE","UNDEFINED"].indexOf(t)?1:-1!==["SHORT","SSHORT"].indexOf(t)?2:-1!==["LONG","SLONG","FLOAT"].indexOf(t)?4:-1!==["RATIONAL","SRATIONAL","DOUBLE"].indexOf(t)?8:null},getFieldValues:function(t,e,i,n){var r=[],o=this.getFieldTypeLength(e);if(o*i<=4)!1===this.littleEndian?r.push(n>>>8*(4-o)):r.push(n);else for(var s=0;s<i;s++){var a=o*s;o>=8?-1!==["RATIONAL","SRATIONAL"].indexOf(e)?(r.push(this.getUint32(n+a)),r.push(this.getUint32(n+a+4))):cc.logID(8e3):r.push(this.getBytes(o,n+a))}return"ASCII"===e&&r.forEach((function(t,e,i){i[e]=String.fromCharCode(t)})),r},getBytes:function(t,e){if(t<=0)cc.logID(8001);else{if(t<=1)return this.getUint8(e);if(t<=2)return this.getUint16(e);if(t<=3)return this.getUint32(e)>>>8;if(t<=4)return this.getUint32(e);cc.logID(8002)}},getBits:function(t,e,i){i=i||0;var n,r,o=e+Math.floor(i/8),s=i+t,a=32-t;return s<=0?console.log("No bits requested"):s<=8?(n=24+i,r=this.getUint8(o)):s<=16?(n=16+i,r=this.getUint16(o)):s<=32?(n=i,r=this.getUint32(o)):console.log("Too many bits requested"),{bits:r<<n>>>a,byteOffset:o+Math.floor(s/8),bitOffset:s%8}},parseFileDirectory:function(t){for(var e=this.getUint16(t),i=[],n=t+2,r=0;r<e;n+=12,r++){var o=this.getUint16(n),s=this.getUint16(n+2),a=this.getUint32(n+4),c=this.getUint32(n+8),h=this.getFieldTagName(o),l=this.getFieldTypeName(s),u=this.getFieldValues(h,l,a,c);i[h]={type:l,values:u}}this._fileDirectories.push(i);var d=this.getUint32(n);0!==d&&this.parseFileDirectory(d)},clampColorSample:function(t,e){var i=Math.pow(2,8-e);return Math.floor(t*i+(i-1))},parseTIFF:function(t,e){if(e=e||document.createElement("canvas"),this._tiffData=t,this.canvas=e,this.checkLittleEndian(),this.hasTowel()){var i=this.getUint32(4);this._fileDirectories.length=0,this.parseFileDirectory(i);var n=this._fileDirectories[0],r=n.ImageWidth.values[0],o=n.ImageLength.values[0];this.canvas.width=r,this.canvas.height=o;var s=[],a=n.Compression?n.Compression.values[0]:1,c=n.SamplesPerPixel.values[0],h=[],l=0,u=!1;if(n.BitsPerSample.values.forEach((function(t,e,i){h[e]={bitsPerSample:t,hasBytesPerSample:!1,bytesPerSample:void 0},t%8==0&&(h[e].hasBytesPerSample=!0,h[e].bytesPerSample=t/8),l+=t}),this),l%8==0){u=!0;var d=l/8}var _=n.StripOffsets.values,f=_.length;if(n.StripByteCounts)p=n.StripByteCounts.values;else{if(cc.logID(8003),1!==f)throw Error("Cannot recover from missing StripByteCounts");var p=[Math.ceil(r*o*l/8)]}for(X=0;X<f;X++){var g=_[X];s[X]=[];for(var v=p[X],m=0,y=0,T=1,C=!0,x=[],E=0,S=0,b=0;m<v;m+=T)switch(a){case 1:for(var A=0,x=[];A<c;A++){if(!h[A].hasBytesPerSample){var R=this.getBits(h[A].bitsPerSample,g+m,y);throw x.push(R.bits),m=R.byteOffset-g,y=R.bitOffset,RangeError("Cannot handle sub-byte bits per sample")}var I=h[A].bytesPerSample*A;x.push(this.getBytes(h[A].bytesPerSample,g+m+I))}if(s[X].push(x),!u)throw T=0,RangeError("Cannot handle sub-byte bits per pixel");T=d;break;case 2:case 3:case 4:case 5:case 6:case 7:break;case 32773:if(C){C=!1;var w=1,O=1,L=this.getInt8(g+m);L>=0&&L<=127?w=L+1:L>=-127&&L<=-1?O=1-L:C=!0}else{for(var P=this.getUint8(g+m),A=0;A<O;A++){if(!h[S].hasBytesPerSample)throw RangeError("Cannot handle sub-byte bits per sample");b=b<<8*E|P,++E===h[S].bytesPerSample&&(x.push(b),b=E=0,S++),S===c&&(s[X].push(x),x=[],S=0)}0===--w&&(C=!0)}T=1}}if(e.getContext){var D=this.canvas.getContext("2d");D.fillStyle="rgba(255, 255, 255, 0)";var N=n.RowsPerStrip?n.RowsPerStrip.values[0]:o,F=s.length,M=o%N,B=0===M?N:M,z=N,V=0,W=n.PhotometricInterpretation.values[0],U=[],k=0;if(n.ExtraSamples&&(k=(U=n.ExtraSamples.values).length),n.ColorMap)var G=n.ColorMap.values,H=Math.pow(2,h[0].bitsPerSample);for(var X=0;X<F;X++){X+1===F&&(z=B);for(var Y=s[X].length,j=V*X,q=0,Q=0;Q<Y;q++)for(var Z=0;Z<r;Z++,Q++){var K=s[X][Q],J=0,$=0,tt=0,et=1;if(k>0)for(var it=0;it<k;it++)if(1===U[it]||2===U[it]){et=K[3+it]/256;break}switch(W){case 0:if(h[0].hasBytesPerSample)var nt=Math.pow(16,2*h[0].bytesPerSample);K.forEach((function(t,e,i){i[e]=nt-t}));case 1:J=$=tt=this.clampColorSample(K[0],h[0].bitsPerSample);break;case 2:J=this.clampColorSample(K[0],h[0].bitsPerSample),$=this.clampColorSample(K[1],h[1].bitsPerSample),tt=this.clampColorSample(K[2],h[2].bitsPerSample);break;case 3:if(void 0===G)throw Error("Palette image missing color map");var rt=K[0];J=this.clampColorSample(G[rt],16),$=this.clampColorSample(G[H+rt],16),tt=this.clampColorSample(G[2*H+rt],16);break;default:throw RangeError("Unknown Photometric Interpretation:",W)}D.fillStyle="rgba("+J+", "+$+", "+tt+", "+et+")",D.fillRect(Z,j+q,1,1)}V=z}}return this.canvas}},fieldTagNames:{315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop"},fieldTypeNames:{1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE"}};e.exports=n}),{}],235:[(function(t,e,i){var n=cc.macro,r=cc.math;cc.GLProgram=cc._Class.extend({_updateUniformLocation:function(t){if(!t)return!1;var e,i=this._hashForUniforms[t];if(i){e=!1;for(var n=arguments.length-1,r=0;r<n;++r)arguments[r+1]!==i[r]&&(i[r]=arguments[r+1],e=!0)}else i=[arguments[1],arguments[2],arguments[3],arguments[4]],this._hashForUniforms[t]=i,e=!0;return e},_description:function(){return"<CCGLProgram = "+this.toString()+" | Program = "+this._programObj.toString()+", VertexShader = "+this._vertShader.toString()+", FragmentShader = "+this._fragShader.toString()+">"},_compileShader:function(t,e,i){if(!i||!t)return!1;i=(cc.GLProgram._isHighpSupported()?"precision highp float;\n":"precision mediump float;\n")+"uniform mat4 CC_PMatrix;\nuniform mat4 CC_MVMatrix;\nuniform mat4 CC_MVPMatrix;\nuniform vec4 CC_Time;\nuniform vec4 CC_SinTime;\nuniform vec4 CC_CosTime;\nuniform vec4 CC_Random01;\nuniform sampler2D CC_Texture0;\n//CC INCLUDES END\n"+i,this._glContext.shaderSource(t,i),this._glContext.compileShader(t);var n=this._glContext.getShaderParameter(t,this._glContext.COMPILE_STATUS);return n||(cc.logID(8100,this._glContext.getShaderSource(t)),e===this._glContext.VERTEX_SHADER?cc.log("cocos2d: \n"+this.vertexShaderLog()):cc.log("cocos2d: \n"+this.fragmentShaderLog())),!0===n},ctor:function(t,e,i){this._uniforms={},this._hashForUniforms={},this._glContext=i||cc._renderContext,this._programObj=null,this._vertShader=null,this._fragShader=null,this._usesTime=!1,this._projectionUpdated=-1,t&&e&&this.init(t,e)},destroyProgram:function(){this._vertShader=null,this._fragShader=null,this._uniforms=null,this._hashForUniforms=null,this._glContext.deleteProgram(this._programObj)},initWithVertexShaderByteArray:function(t,e){var i=this._glContext;this._programObj=i.createProgram(),this._projectionUpdated=-1,this._vertShader=null,this._fragShader=null,t&&(this._vertShader=i.createShader(i.VERTEX_SHADER),this._compileShader(this._vertShader,i.VERTEX_SHADER,t)||cc.logID(8101)),e&&(this._fragShader=i.createShader(i.FRAGMENT_SHADER),this._compileShader(this._fragShader,i.FRAGMENT_SHADER,e)||cc.logID(8102)),this._vertShader&&i.attachShader(this._programObj,this._vertShader),this._fragShader&&i.attachShader(this._programObj,this._fragShader);for(var n in this._hashForUniforms)delete this._hashForUniforms[n];return!0},initWithString:function(t,e){return this.initWithVertexShaderByteArray(t,e)},initWithVertexShaderFilename:function(t,e){var i=cc.loader.getRes(t);if(!i)throw new Error("Please load the resource firset : "+t);var n=cc.loader.getRes(e);if(!n)throw new Error("Please load the resource firset : "+e);return this.initWithVertexShaderByteArray(i,n)},init:function(t,e){return this.initWithVertexShaderFilename(t,e)},addAttribute:function(t,e){this._glContext.bindAttribLocation(this._programObj,e,t)},link:function(){return this._programObj?(this._glContext.linkProgram(this._programObj),this._vertShader&&this._glContext.deleteShader(this._vertShader),this._fragShader&&this._glContext.deleteShader(this._fragShader),this._vertShader=null,this._fragShader=null,!(cc.game.config[cc.game.CONFIG_KEY.debugMode]&&!this._glContext.getProgramParameter(this._programObj,this._glContext.LINK_STATUS))||(cc.logID(8104,this._glContext.getProgramInfoLog(this._programObj)),cc.gl.deleteProgram(this._programObj),this._programObj=null,!1)):(cc.logID(8103),!1)},use:function(){cc.gl.useProgram(this._programObj)},updateUniforms:function(){this._uniforms[n.UNIFORM_PMATRIX]=this._glContext.getUniformLocation(this._programObj,n.UNIFORM_PMATRIX_S),this._uniforms[n.UNIFORM_MVMATRIX]=this._glContext.getUniformLocation(this._programObj,n.UNIFORM_MVMATRIX_S),this._uniforms[n.UNIFORM_MVPMATRIX]=this._glContext.getUniformLocation(this._programObj,n.UNIFORM_MVPMATRIX_S),this._uniforms[n.UNIFORM_TIME]=this._glContext.getUniformLocation(this._programObj,n.UNIFORM_TIME_S),this._uniforms[n.UNIFORM_SINTIME]=this._glContext.getUniformLocation(this._programObj,n.UNIFORM_SINTIME_S),this._uniforms[n.UNIFORM_COSTIME]=this._glContext.getUniformLocation(this._programObj,n.UNIFORM_COSTIME_S),this._usesTime=null!=this._uniforms[n.UNIFORM_TIME]||null!=this._uniforms[n.UNIFORM_SINTIME]||null!=this._uniforms[n.UNIFORM_COSTIME],this._uniforms[n.UNIFORM_RANDOM01]=this._glContext.getUniformLocation(this._programObj,n.UNIFORM_RANDOM01_S),this._uniforms[n.UNIFORM_SAMPLER]=this._glContext.getUniformLocation(this._programObj,n.UNIFORM_SAMPLER_S),this.use(),this.setUniformLocationWith1i(this._uniforms[n.UNIFORM_SAMPLER],0)},_addUniformLocation:function(t){var e=this._glContext.getUniformLocation(this._programObj,t);this._uniforms[t]=e},getUniformLocationForName:function(t){if(!t)throw new Error("cc.GLProgram.getUniformLocationForName(): uniform name should be non-null");if(!this._programObj)throw new Error("cc.GLProgram.getUniformLocationForName(): Invalid operation. Cannot get uniform location when program is not initialized");return this._uniforms[t]||this._glContext.getUniformLocation(this._programObj,t)},getUniformMVPMatrix:function(){return this._uniforms[n.UNIFORM_MVPMATRIX]},getUniformSampler:function(){return this._uniforms[n.UNIFORM_SAMPLER]},setUniformLocationWith1i:function(t,e){var i=this._glContext;if("string"==typeof t){if(this._updateUniformLocation(t,e)){var n=this.getUniformLocationForName(t);i.uniform1i(n,e)}}else i.uniform1i(t,e)},setUniformLocationWith2i:function(t,e,i){var n=this._glContext;if("string"==typeof t){if(this._updateUniformLocation(t,e,i)){var r=this.getUniformLocationForName(t);n.uniform2i(r,e,i)}}else n.uniform2i(t,e,i)},setUniformLocationWith3i:function(t,e,i,n){var r=this._glContext;if("string"==typeof t){if(this._updateUniformLocation(t,e,i,n)){var o=this.getUniformLocationForName(t);r.uniform3i(o,e,i,n)}}else r.uniform3i(t,e,i,n)},setUniformLocationWith4i:function(t,e,i,n,r){var o=this._glContext;if("string"==typeof t){if(this._updateUniformLocation(t,e,i,n,r)){var s=this.getUniformLocationForName(t);o.uniform4i(s,e,i,n,r)}}else o.uniform4i(t,e,i,n,r)},setUniformLocationWith2iv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniform2iv(i,e)},setUniformLocationWith3iv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniform3iv(i,e)},setUniformLocationWith4iv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniform4iv(i,e)},setUniformLocationI32:function(t,e){this.setUniformLocationWith1i(t,e)},setUniformLocationWith1f:function(t,e){var i=this._glContext;if("string"==typeof t){if(this._updateUniformLocation(t,e)){var n=this.getUniformLocationForName(t);i.uniform1f(n,e)}}else i.uniform1f(t,e)},setUniformLocationWith2f:function(t,e,i){var n=this._glContext;if("string"==typeof t){if(this._updateUniformLocation(t,e,i)){var r=this.getUniformLocationForName(t);n.uniform2f(r,e,i)}}else n.uniform2f(t,e,i)},setUniformLocationWith3f:function(t,e,i,n){var r=this._glContext;if("string"==typeof t){if(this._updateUniformLocation(t,e,i,n)){var o=this.getUniformLocationForName(t);r.uniform3f(o,e,i,n)}}else r.uniform3f(t,e,i,n)},setUniformLocationWith4f:function(t,e,i,n,r){var o=this._glContext;if("string"==typeof t){if(this._updateUniformLocation(t,e,i,n,r)){var s=this.getUniformLocationForName(t);o.uniform4f(s,e,i,n,r)}}else o.uniform4f(t,e,i,n,r)},setUniformLocationWith2fv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniform2fv(i,e)},setUniformLocationWith3fv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniform3fv(i,e)},setUniformLocationWith4fv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniform4fv(i,e)},setUniformLocationWithMatrix3fv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniformMatrix3fv(i,!1,e)},setUniformLocationWithMatrix4fv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniformMatrix4fv(i,!1,e)},setUniformLocationF32:function(t,e,i,n,r){"use strict";switch(arguments.length){case 0:case 1:return;case 2:this.setUniformLocationWith1f(t,e);break;case 3:this.setUniformLocationWith2f(t,e,i);break;case 4:this.setUniformLocationWith3f(t,e,i,n);break;case 5:this.setUniformLocationWith4f(t,e,i,n,r)}},setUniformsForBuiltins:function(){var t=new r.Matrix4,e=new r.Matrix4,i=new r.Matrix4;if(r.glGetMatrix(r.KM_GL_PROJECTION,t),r.glGetMatrix(r.KM_GL_MODELVIEW,e),r.mat4Multiply(i,t,e),this.setUniformLocationWithMatrix4fv(this._uniforms[n.UNIFORM_PMATRIX],t.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[n.UNIFORM_MVMATRIX],e.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[n.UNIFORM_MVPMATRIX],i.mat,1),this._usesTime){var o=cc.director,s=o.getTotalFrames()*o.getAnimationInterval();this.setUniformLocationWith4f(this._uniforms[n.UNIFORM_TIME],s/10,s,2*s,4*s),this.setUniformLocationWith4f(this._uniforms[n.UNIFORM_SINTIME],s/8,s/4,s/2,Math.sin(s)),this.setUniformLocationWith4f(this._uniforms[n.UNIFORM_COSTIME],s/8,s/4,s/2,Math.cos(s))}-1!==this._uniforms[n.UNIFORM_RANDOM01]&&this.setUniformLocationWith4f(this._uniforms[n.UNIFORM_RANDOM01],Math.random(),Math.random(),Math.random(),Math.random())},_setUniformsForBuiltinsForRenderer:function(t){if(t&&t._renderCmd){var e=new r.Matrix4,i=new r.Matrix4;if(r.glGetMatrix(r.KM_GL_PROJECTION,e),r.mat4Multiply(i,e,t._renderCmd._stackMatrix),this.setUniformLocationWithMatrix4fv(this._uniforms[n.UNIFORM_PMATRIX],e.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[n.UNIFORM_MVMATRIX],t._renderCmd._stackMatrix.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[n.UNIFORM_MVPMATRIX],i.mat,1),this._usesTime){var o=cc.director,s=o.getTotalFrames()*o.getAnimationInterval();this.setUniformLocationWith4f(this._uniforms[n.UNIFORM_TIME],s/10,s,2*s,4*s),this.setUniformLocationWith4f(this._uniforms[n.UNIFORM_SINTIME],s/8,s/4,s/2,Math.sin(s)),this.setUniformLocationWith4f(this._uniforms[n.UNIFORM_COSTIME],s/8,s/4,s/2,Math.cos(s))}-1!==this._uniforms[n.UNIFORM_RANDOM01]&&this.setUniformLocationWith4f(this._uniforms[n.UNIFORM_RANDOM01],Math.random(),Math.random(),Math.random(),Math.random())}},setUniformForModelViewProjectionMatrix:function(){this._glContext.uniformMatrix4fv(this._uniforms[n.UNIFORM_MVPMATRIX],!1,r.getMat4MultiplyValue(r.projection_matrix_stack.top,r.modelview_matrix_stack.top))},setUniformForModelViewProjectionMatrixWithMat4:function(t){r.mat4Multiply(t,r.projection_matrix_stack.top,r.modelview_matrix_stack.top),this._glContext.uniformMatrix4fv(this._uniforms[n.UNIFORM_MVPMATRIX],!1,t.mat)},setUniformForModelViewAndProjectionMatrixWithMat4:function(){this._glContext.uniformMatrix4fv(this._uniforms[n.UNIFORM_MVMATRIX],!1,r.modelview_matrix_stack.top.mat),this._glContext.uniformMatrix4fv(this._uniforms[n.UNIFORM_PMATRIX],!1,r.projection_matrix_stack.top.mat)},_setUniformForMVPMatrixWithMat4:function(t){if(!t)throw new Error("modelView matrix is undefined.");this._glContext.uniformMatrix4fv(this._uniforms[n.UNIFORM_MVMATRIX],!1,t.mat),this._glContext.uniformMatrix4fv(this._uniforms[n.UNIFORM_PMATRIX],!1,r.projection_matrix_stack.top.mat)},_updateProjectionUniform:function(){var t=r.projection_matrix_stack;t.lastUpdated!==this._projectionUpdated&&(this._glContext.uniformMatrix4fv(this._uniforms[n.UNIFORM_PMATRIX],!1,t.top.mat),this._projectionUpdated=t.lastUpdated)},vertexShaderLog:function(){return this._glContext.getShaderInfoLog(this._vertShader)},getVertexShaderLog:function(){return this._glContext.getShaderInfoLog(this._vertShader)},getFragmentShaderLog:function(){return this._glContext.getShaderInfoLog(this._vertShader)},fragmentShaderLog:function(){return this._glContext.getShaderInfoLog(this._fragShader)},programLog:function(){return this._glContext.getProgramInfoLog(this._programObj)},getProgramLog:function(){return this._glContext.getProgramInfoLog(this._programObj)},reset:function(){this._vertShader=null,this._fragShader=null,this._uniforms.length=0,this._glContext.deleteProgram(this._programObj),this._programObj=null;for(var t in this._hashForUniforms)this._hashForUniforms[t].length=0,delete this._hashForUniforms[t]},getProgram:function(){return this._programObj},retain:function(){},release:function(){}}),cc.GLProgram._highpSupported=null,cc.GLProgram._isHighpSupported=function(){var t=cc._renderContext;if(t.getShaderPrecisionFormat&&null==cc.GLProgram._highpSupported){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);cc.GLProgram._highpSupported=0!==e.precision}return cc.GLProgram._highpSupported}}),{}],236:[(function(t,e,i){var n=-1,r=cc.macro,o=r.ENABLE_GL_STATE_CACHE,s=0,a=0,c=null,h=0,l=0,u=0,d=0;o&&(s=16,a=-1,c=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],h=-1,l=-1,u=0,r.TEXTURE_ATLAS_USE_VAO&&(d=0)),cc.gl={},cc.gl.invalidateStateCache=function(){if(cc.math.glFreeAll(),n=-1,o){a=-1;for(var t=0;t<s;t++)c[t]=-1;h=-1,l=-1,u=0}},cc.gl.useProgram=o?function(t){t!==a&&(a=t,cc._renderContext.useProgram(t))}:function(t){cc._renderContext.useProgram(t)},cc.gl.deleteProgram=function(t){o&&t===a&&(a=-1),gl.deleteProgram(t)},cc.gl.setBlending=function(t,e){var i=cc._renderContext;t===i.ONE&&e===i.ZERO?i.disable(i.BLEND):(i.enable(i.BLEND),i.blendFunc(t,e))},cc.gl.blendFunc=o?function(t,e){t===h&&e===l||(h=t,l=e,cc.gl.setBlending(t,e))}:cc.gl.setBlending,cc.gl.blendFuncForParticle=function(t,e){if(t!==h||e!==l){h=t,l=e;var i=cc._renderContext;t===i.ONE&&e===i.ZERO?i.disable(i.BLEND):(i.enable(i.BLEND),i.blendFuncSeparate(i.SRC_ALPHA,e,t,e))}},cc.gl.blendResetToCache=function(){var t=cc._renderContext;t.blendEquation(t.FUNC_ADD),o?cc.gl.setBlending(h,l):cc.gl.setBlending(t.BLEND_SRC,t.BLEND_DST)},cc.gl.setProjectionMatrixDirty=function(){n=-1},cc.gl.bindTexture2D=function(t){cc.gl.bindTexture2DN(0,t)},cc.gl.bindTexture2DN=o?function(t,e){if(c[t]!==e){c[t]=e;var i=cc._renderContext;i.activeTexture(i.TEXTURE0+t),e?i.bindTexture(i.TEXTURE_2D,e._webTextureObj):i.bindTexture(i.TEXTURE_2D,null)}}:function(t,e){var i=cc._renderContext;i.activeTexture(i.TEXTURE0+t),e?i.bindTexture(i.TEXTURE_2D,e._webTextureObj):i.bindTexture(i.TEXTURE_2D,null)},cc.gl.deleteTexture2D=function(t){cc.gl.deleteTexture2DN(0,t)},cc.gl.deleteTexture2DN=function(t,e){o&&e===c[t]&&(c[t]=-1),cc._renderContext.deleteTexture(e._webTextureObj)},cc.gl.bindVAO=function(t){r.TEXTURE_ATLAS_USE_VAO&&o&&d!==t&&(d=t)},cc.gl.enable=function(t){}}),{}],237:[(function(t,e,i){var n=cc.PresetShaders,r=cc.macro;cc.shaderCache={TYPE_POSITION_TEXTURECOLOR:0,TYPE_POSITION_TEXTURECOLOR_ALPHATEST:1,TYPE_POSITION_COLOR:2,TYPE_POSITION_TEXTURE:3,TYPE_POSITION_TEXTURE_UCOLOR:4,TYPE_POSITION_TEXTURE_A8COLOR:5,TYPE_POSITION_UCOLOR:6,TYPE_POSITION_LENGTH_TEXTURECOLOR:7,TYPE_SPRITE_POSITION_TEXTURECOLOR:8,TYPE_SPRITE_POSITION_TEXTURECOLOR_ALPHATEST:9,TYPE_SPRITE_POSITION_COLOR:10,TYPE_MAX:10,_programs:{},_init:function(){return this.loadDefaultShaders(),!0},_loadDefaultShader:function(t,e){switch(e){case r.SHADER_POSITION_TEXTURECOLOR:t.initWithVertexShaderByteArray(n.POSITION_TEXTURE_COLOR_VERT,n.POSITION_TEXTURE_COLOR_FRAG),t.addAttribute(r.ATTRIBUTE_NAME_POSITION,r.VERTEX_ATTRIB_POSITION),t.addAttribute(r.ATTRIBUTE_NAME_COLOR,r.VERTEX_ATTRIB_COLOR),t.addAttribute(r.ATTRIBUTE_NAME_TEX_COORD,r.VERTEX_ATTRIB_TEX_COORDS);break;case r.SHADER_SPRITE_POSITION_TEXTURECOLOR:t.initWithVertexShaderByteArray(n.SPRITE_POSITION_TEXTURE_COLOR_VERT,n.POSITION_TEXTURE_COLOR_FRAG),t.addAttribute(r.ATTRIBUTE_NAME_POSITION,r.VERTEX_ATTRIB_POSITION),t.addAttribute(r.ATTRIBUTE_NAME_COLOR,r.VERTEX_ATTRIB_COLOR),t.addAttribute(r.ATTRIBUTE_NAME_TEX_COORD,r.VERTEX_ATTRIB_TEX_COORDS);break;case r.SHADER_POSITION_TEXTURECOLORALPHATEST:t.initWithVertexShaderByteArray(n.POSITION_TEXTURE_COLOR_VERT,n.POSITION_TEXTURE_COLOR_ALPHATEST_FRAG),t.addAttribute(r.ATTRIBUTE_NAME_POSITION,r.VERTEX_ATTRIB_POSITION),t.addAttribute(r.ATTRIBUTE_NAME_COLOR,r.VERTEX_ATTRIB_COLOR),t.addAttribute(r.ATTRIBUTE_NAME_TEX_COORD,r.VERTEX_ATTRIB_TEX_COORDS);break;case r.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST:t.initWithVertexShaderByteArray(n.SPRITE_POSITION_TEXTURE_COLOR_VERT,n.POSITION_TEXTURE_COLOR_ALPHATEST_FRAG),t.addAttribute(r.ATTRIBUTE_NAME_POSITION,r.VERTEX_ATTRIB_POSITION),t.addAttribute(r.ATTRIBUTE_NAME_COLOR,r.VERTEX_ATTRIB_COLOR),t.addAttribute(r.ATTRIBUTE_NAME_TEX_COORD,r.VERTEX_ATTRIB_TEX_COORDS);break;case r.SHADER_POSITION_COLOR:t.initWithVertexShaderByteArray(n.POSITION_COLOR_VERT,n.POSITION_COLOR_FRAG),t.addAttribute(r.ATTRIBUTE_NAME_POSITION,r.VERTEX_ATTRIB_POSITION),t.addAttribute(r.ATTRIBUTE_NAME_COLOR,r.VERTEX_ATTRIB_COLOR);break;case r.SHADER_SPRITE_POSITION_COLOR:t.initWithVertexShaderByteArray(n.SPRITE_POSITION_COLOR_VERT,n.POSITION_COLOR_FRAG),t.addAttribute(r.ATTRIBUTE_NAME_POSITION,r.VERTEX_ATTRIB_POSITION),t.addAttribute(r.ATTRIBUTE_NAME_COLOR,r.VERTEX_ATTRIB_COLOR);break;case r.SHADER_POSITION_TEXTURE:t.initWithVertexShaderByteArray(n.POSITION_TEXTURE_VERT,n.POSITION_TEXTURE_FRAG),t.addAttribute(r.ATTRIBUTE_NAME_POSITION,r.VERTEX_ATTRIB_POSITION),t.addAttribute(r.ATTRIBUTE_NAME_TEX_COORD,r.VERTEX_ATTRIB_TEX_COORDS);break;case r.SHADER_POSITION_TEXTURE_UCOLOR:t.initWithVertexShaderByteArray(n.POSITION_TEXTURE_UCOLOR_VERT,n.POSITION_TEXTURE_UCOLOR_FRAG),t.addAttribute(r.ATTRIBUTE_NAME_POSITION,r.VERTEX_ATTRIB_POSITION),t.addAttribute(r.ATTRIBUTE_NAME_TEX_COORD,r.VERTEX_ATTRIB_TEX_COORDS);break;case r.SHADER_POSITION_TEXTUREA8COLOR:t.initWithVertexShaderByteArray(n.POSITION_TEXTURE_A8COLOR_VERT,n.POSITION_TEXTURE_A8COLOR_FRAG),t.addAttribute(r.ATTRIBUTE_NAME_POSITION,r.VERTEX_ATTRIB_POSITION),t.addAttribute(r.ATTRIBUTE_NAME_COLOR,r.VERTEX_ATTRIB_COLOR),t.addAttribute(r.ATTRIBUTE_NAME_TEX_COORD,r.VERTEX_ATTRIB_TEX_COORDS);break;case r.SHADER_POSITION_UCOLOR:t.initWithVertexShaderByteArray(n.POSITION_UCOLOR_VERT,n.POSITION_UCOLOR_FRAG),t.addAttribute("aVertex",r.VERTEX_ATTRIB_POSITION);break;case r.SHADER_POSITION_LENGTHTEXTURECOLOR:t.initWithVertexShaderByteArray(n.POSITION_COLOR_LENGTH_TEXTURE_VERT,n.POSITION_COLOR_LENGTH_TEXTURE_FRAG),t.addAttribute(r.ATTRIBUTE_NAME_POSITION,r.VERTEX_ATTRIB_POSITION),t.addAttribute(r.ATTRIBUTE_NAME_TEX_COORD,r.VERTEX_ATTRIB_TEX_COORDS),t.addAttribute(r.ATTRIBUTE_NAME_COLOR,r.VERTEX_ATTRIB_COLOR);break;default:return void cc.logID(8105)}t.link(),t.updateUniforms()},_reloadShader:function(t){var e=this.programForKey(t);e.reset(),this._loadDefaultShader(e,t)},loadDefaultShaders:function(){},reloadDefaultShaders:function(){this._reloadShader(r.SHADER_POSITION_TEXTURECOLOR),this._reloadShader(r.SHADER_SPRITE_POSITION_TEXTURECOLOR),this._reloadShader(r.SHADER_POSITION_TEXTURECOLORALPHATEST),this._reloadShader(r.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST),this._reloadShader(r.SHADER_POSITION_COLOR),this._reloadShader(r.SHADER_POSITION_TEXTURE),this._reloadShader(r.SHADER_POSITION_TEXTURE_UCOLOR),this._reloadShader(r.SHADER_POSITION_TEXTUREA8COLOR),this._reloadShader(r.SHADER_POSITION_UCOLOR)},programForKey:function(t){if(!this._programs[t]){var e=new cc.GLProgram;this._loadDefaultShader(e,t),this._programs[t]=e}return this._programs[t]},getProgram:function(t){return this.programForKey(t)},addProgram:function(t,e){this._programs[e]=t}}}),{}],238:[(function(t,e,i){cc.PresetShaders={POSITION_UCOLOR_FRAG:"precision lowp float;\nvarying vec4 v_fragmentColor;\nvoid main()\n{\ngl_FragColor = v_fragmentColor;\n}",POSITION_UCOLOR_VERT:"attribute vec4 a_position;\nuniform vec4 u_color;\nuniform float u_pointSize;\nvarying lowp vec4 v_fragmentColor;\nvoid main(void)\n{\ngl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;\ngl_PointSize = u_pointSize;\nv_fragmentColor = u_color;\n}",POSITION_COLOR_FRAG:"precision lowp float;\nvarying vec4 v_fragmentColor;\nvoid main()\n{\ngl_FragColor = v_fragmentColor;\n}",POSITION_COLOR_VERT:"attribute vec4 a_position;\nattribute vec4 a_color;\nvarying lowp vec4 v_fragmentColor;\nvoid main()\n{\ngl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;\nv_fragmentColor = a_color;\n}",SPRITE_POSITION_COLOR_VERT:"attribute vec4 a_position;\nattribute vec4 a_color;\nvarying lowp vec4 v_fragmentColor;\nvoid main()\n{\ngl_Position = CC_PMatrix * a_position;\nv_fragmentColor = a_color;\n}",POSITION_COLOR_LENGTH_TEXTURE_FRAG:"//#extension GL_OES_standard_derivatives : enable\nvarying mediump vec4 v_color;\nvarying mediump vec2 v_texcoord;\nvoid main()\n{\n//#if defined GL_OES_standard_derivatives\n//gl_FragColor=v_color*smoothstep(0.0, length(fwidth(v_texcoord)), 1.0-length(v_texcoord));\n//#else\ngl_FragColor = v_color * step(0.0, 1.0 - length(v_texcoord));\n//#endif\n}",POSITION_COLOR_LENGTH_TEXTURE_VERT:"attribute mediump vec4 a_position;\nattribute mediump vec2 a_texcoord;\nattribute mediump vec4 a_color;\nvarying mediump vec4 v_color;\nvarying mediump vec2 v_texcoord;\nvoid main()\n{\nv_color = a_color;\nv_texcoord = a_texcoord;\ngl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;\n}",POSITION_TEXTURE_FRAG:"precision lowp float;\nvarying vec2 v_texCoord;\nvoid main()\n{\ngl_FragColor = texture2D(CC_Texture0, v_texCoord);\n}",POSITION_TEXTURE_VERT:"attribute vec4 a_position;\nattribute vec2 a_texCoord;\nvarying mediump vec2 v_texCoord;\nvoid main()\n{\ngl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;\nv_texCoord = a_texCoord;\n}",POSITION_TEXTURE_UCOLOR_FRAG:"precision lowp float;\nuniform vec4 u_color;\nvarying vec2 v_texCoord;\nvoid main()\n{\ngl_FragColor=texture2D(CC_Texture0, v_texCoord) * u_color;\n}",POSITION_TEXTURE_UCOLOR_VERT:"attribute vec4 a_position;\nattribute vec2 a_texCoord;\nvarying mediump vec2 v_texCoord;\nvoid main()\n{\ngl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;\nv_texCoord = a_texCoord;\n}",POSITION_TEXTURE_A8COLOR_FRAG:"precision lowp float;\nvarying vec4 v_fragmentColor;\nvarying vec2 v_texCoord;\nvoid main()\n{\ngl_FragColor = vec4(v_fragmentColor.rgb,\nv_fragmentColor.a * texture2D(CC_Texture0, v_texCoord).a);\n}",POSITION_TEXTURE_A8COLOR_VERT:"attribute vec4 a_position;\nattribute vec2 a_texCoord;\nattribute vec4 a_color;\nvarying lowp vec4 v_fragmentColor;\nvarying mediump vec2 v_texCoord;\nvoid main()\n{\ngl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;\nv_fragmentColor = a_color;\nv_texCoord = a_texCoord;\n}",POSITION_TEXTURE_COLOR_FRAG:"precision lowp float;\nvarying vec4 v_fragmentColor;\nvarying vec2 v_texCoord;\nvoid main()\n{\ngl_FragColor = v_fragmentColor * texture2D(CC_Texture0, v_texCoord);\n}",POSITION_TEXTURE_COLOR_VERT:"attribute vec4 a_position;\nattribute vec2 a_texCoord;\nattribute vec4 a_color;\nvarying lowp vec4 v_fragmentColor;\nvarying mediump vec2 v_texCoord;\nvoid main()\n{\ngl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;\nv_fragmentColor = a_color;\nv_texCoord = a_texCoord;\n}",SPRITE_POSITION_TEXTURE_COLOR_VERT:"attribute vec4 a_position;\nattribute vec2 a_texCoord;\nattribute vec4 a_color;\nvarying lowp vec4 v_fragmentColor;\nvarying mediump vec2 v_texCoord;\nvoid main()\n{\ngl_Position = CC_PMatrix * a_position;\nv_fragmentColor = a_color;\nv_texCoord = a_texCoord;\n}",POSITION_TEXTURE_COLOR_ALPHATEST_FRAG:"precision lowp float;\nvarying vec4 v_fragmentColor;\nvarying vec2 v_texCoord;\nuniform float CC_alpha_value;\nvoid main()\n{\nvec4 texColor=texture2D(CC_Texture0, v_texCoord);\nif(texColor.a <= CC_alpha_value)\n discard; \ngl_FragColor=texColor*v_fragmentColor;\n}",EX_SWITCHMASK_FRAG:"precision lowp float;\nvarying vec4 v_fragmentColor;\nvarying vec2 v_texCoord;\nuniform sampler2D u_texture;\nuniform sampler2D u_mask;\nvoid main()\n{\nvec4 texColorc=texture2D(u_texture, v_texCoord);\nvec4 maskColor=texture2D(u_mask, v_texCoord);\nvec4 finalColor=vec4(texColor.r, texColor.g, texColor.b, maskColor.a*texColor.a);\ngl_FragColor=v_fragmentColor*finalColor;\n}"}}),{}],239:[(function(t,e,i){t("./CCShaders"),t("./CCShaderCache"),t("./CCGLProgram"),t("./CCGLStateCache")}),{"./CCGLProgram":235,"./CCGLStateCache":236,"./CCShaderCache":237,"./CCShaders":238}],240:[(function(t,e,i){var n=function(t){return{u:t.x,v:t.y}};cc.DrawNode=_ccsg.Node.extend({_buffer:null,_blendFunc:null,_lineWidth:1,_drawColor:null,getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(t,e){void 0===e?(this._blendFunc.src=t.src,this._blendFunc.dst=t.dst):(this._blendFunc.src=t,this._blendFunc.dst=e)},setLineWidth:function(t){this._lineWidth=t},getLineWidth:function(){return this._lineWidth},setDrawColor:function(t){var e=this._drawColor;e.r=t.r,e.g=t.g,e.b=t.b,e.a=null==t.a?255:t.a},getDrawColor:function(){return cc.color(this._drawColor.r,this._drawColor.g,this._drawColor.b,this._drawColor.a)}}),cc.DrawNode.TYPE_DOT=0,cc.DrawNode.TYPE_SEGMENT=1,cc.DrawNode.TYPE_POLY=2,cc.game.once(cc.game.EVENT_RENDERER_INITED,(function(){var t=cc.DrawNode.prototype;cc._renderType===cc.game.RENDER_TYPE_CANVAS?(cc._DrawNodeElement=function(t,e,i,n,r,o,s,a,c){var h=this;h.type=t,h.verts=e||null,h.fillColor=i||null,h.lineWidth=n||0,h.lineColor=r||null,h.lineCap=o||"butt",h.isClosePolygon=s||!1,h.isFill=a||!1,h.isStroke=c||!1},t._className="DrawNodeCanvas",t.ctor=function(){_ccsg.Node.prototype.ctor.call(this);var t=this._renderCmd;t._buffer=this._buffer=[],t._drawColor=this._drawColor=cc.color(255,255,255,255),t._blendFunc=this._blendFunc=new cc.BlendFunc(cc.macro.SRC_ALPHA,cc.macro.ONE_MINUS_SRC_ALPHA),this.init()},t.drawRect=function(t,e,i,n,r){n=null==n?this._lineWidth:n,null==(r=r||this.getDrawColor()).a&&(r.a=255);var o=[t,cc.p(e.x,t.y),e,cc.p(t.x,e.y)],s=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);s.verts=o,s.lineWidth=n,s.lineColor=r,s.isClosePolygon=!0,s.isStroke=!0,s.lineCap="butt",s.fillColor=i,i&&(null==i.a&&(i.a=255),s.isFill=!0),this._buffer.push(s)},t.drawCircle=function(t,e,i,n,r,o,s){o=o||this._lineWidth,null==(s=s||this.getDrawColor()).a&&(s.a=255);for(var a=2*Math.PI/n,c=[],h=0;h<=n;h++){var l=h*a,u=e*Math.cos(l+i)+t.x,d=e*Math.sin(l+i)+t.y;c.push(cc.p(u,d))}r&&c.push(cc.p(t.x,t.y));var _=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);_.verts=c,_.lineWidth=o,_.lineColor=s,_.isClosePolygon=!0,_.isStroke=!0,this._buffer.push(_)},t.drawQuadBezier=function(t,e,i,n,r,o){r=r||this._lineWidth,null==(o=o||this.getDrawColor()).a&&(o.a=255);for(var s=[],a=0,c=0;c<n;c++){var h=Math.pow(1-a,2)*t.x+2*(1-a)*a*e.x+a*a*i.x,l=Math.pow(1-a,2)*t.y+2*(1-a)*a*e.y+a*a*i.y;s.push(cc.p(h,l)),a+=1/n}s.push(cc.p(i.x,i.y));var u=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);u.verts=s,u.lineWidth=r,u.lineColor=o,u.isStroke=!0,u.lineCap="round",this._buffer.push(u)},t.drawCubicBezier=function(t,e,i,n,r,o,s){o=o||this._lineWidth,null==(s=s||this.getDrawColor()).a&&(s.a=255);for(var a=[],c=0,h=0;h<r;h++){var l=Math.pow(1-c,3)*t.x+3*Math.pow(1-c,2)*c*e.x+3*(1-c)*c*c*i.x+c*c*c*n.x,u=Math.pow(1-c,3)*t.y+3*Math.pow(1-c,2)*c*e.y+3*(1-c)*c*c*i.y+c*c*c*n.y;a.push(cc.p(l,u)),c+=1/r}a.push(cc.p(n.x,n.y));var d=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);d.verts=a,d.lineWidth=o,d.lineColor=s,d.isStroke=!0,d.lineCap="round",this._buffer.push(d)},t.drawCatmullRom=function(t,e,i,n){this.drawCardinalSpline(t,.5,e,i,n)},t.drawCardinalSpline=function(t,e,i,n,r){n=n||this._lineWidth,null==(r=r||this.getDrawColor()).a&&(r.a=255);for(var o,s,a=[],c=1/t.length,h=0;h<i+1;h++){var l=h/i;1===l?(o=t.length-1,s=1):s=(l-c*(o=0|l/c))/c;var u=cc.cardinalSplineAt(cc.getControlPointAt(t,o-1),cc.getControlPointAt(t,o-0),cc.getControlPointAt(t,o+1),cc.getControlPointAt(t,o+2),e,s);a.push(u)}var d=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);d.verts=a,d.lineWidth=n,d.lineColor=r,d.isStroke=!0,d.lineCap="round",this._buffer.push(d)},t.drawDot=function(t,e,i){null==(i=i||this.getDrawColor()).a&&(i.a=255);var n=new cc._DrawNodeElement(cc.DrawNode.TYPE_DOT);n.verts=[t],n.lineWidth=e,n.fillColor=i,this._buffer.push(n)},t.drawDots=function(t,e,i){if(t&&0!=t.length){null==(i=i||this.getDrawColor()).a&&(i.a=255);for(var n=0,r=t.length;n<r;n++)this.drawDot(t[n],e,i)}},t.drawSegment=function(t,e,i,n){i=i||this._lineWidth,null==(n=n||this.getDrawColor()).a&&(n.a=255);var r=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);r.verts=[t,e],r.lineWidth=2*i,r.lineColor=n,r.isStroke=!0,r.lineCap="round",this._buffer.push(r)},t.drawPoly_=function(t,e,i,n,r){i=null==i?this._lineWidth:i,null==(n=n||this.getDrawColor()).a&&(n.a=255);var o=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);o.verts=t,o.fillColor=e,o.lineWidth=i,o.lineColor=n,o.isClosePolygon=!r,o.isStroke=!0,o.lineCap="round",e&&(o.isFill=!0),this._buffer.push(o)},t.drawPoly=function(t,e,i,n,r){for(var o=[],s=0;s<t.length;s++)o.push(cc.p(t[s].x,t[s].y));return this.drawPoly_(o,e,i,n,r)},t.clear=function(){this._buffer.length=0},t._createRenderCmd=function(){return new cc.DrawNode.CanvasRenderCmd(this)}):cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(t._bufferCapacity=0,t._trianglesArrayBuffer=null,t._trianglesWebBuffer=null,t._trianglesReader=null,t._dirty=!1,t._className="DrawNodeWebGL",t.ctor=function(){_ccsg.Node.prototype.ctor.call(this),this._buffer=[],this._blendFunc=new cc.BlendFunc(cc.macro.SRC_ALPHA,cc.macro.ONE_MINUS_SRC_ALPHA),this._drawColor=cc.color(255,255,255,255),this.init()},t.init=function(){return!!_ccsg.Node.prototype.init.call(this)&&(this.shaderProgram=cc.shaderCache.programForKey(cc.macro.SHADER_POSITION_LENGTHTEXTURECOLOR),this._ensureCapacity(64),this._trianglesWebBuffer=cc._renderContext.createBuffer(),this._dirty=!0,!0)},t.drawRect=function(t,e,i,n,r){n=null==n?this._lineWidth:n,null==(r=r||this.getDrawColor()).a&&(r.a=255);var o=[t,cc.p(e.x,t.y),e,cc.p(t.x,e.y)];null==i?this._drawSegments(o,n,r,!0):this.drawPoly(o,i,n,r)},t.drawCircle=function(t,e,i,n,r,o,s){o=o||this._lineWidth,null==(s=s||this.getDrawColor()).a&&(s.a=255);var a,c,h=2*Math.PI/n,l=[];for(a=0;a<=n;a++){var u=a*h,d=e*Math.cos(u+i)+t.x,_=e*Math.sin(u+i)+t.y;l.push(cc.p(d,_))}for(r&&l.push(cc.p(t.x,t.y)),o*=.5,a=0,c=l.length;a<c-1;a++)this.drawSegment(l[a],l[a+1],o,s)},t.drawQuadBezier=function(t,e,i,n,r,o){r=r||this._lineWidth,null==(o=o||this.getDrawColor()).a&&(o.a=255);for(var s=[],a=0,c=0;c<n;c++){var h=Math.pow(1-a,2)*t.x+2*(1-a)*a*e.x+a*a*i.x,l=Math.pow(1-a,2)*t.y+2*(1-a)*a*e.y+a*a*i.y;s.push(cc.p(h,l)),a+=1/n}s.push(cc.p(i.x,i.y)),this._drawSegments(s,r,o,!1)},t.drawCubicBezier=function(t,e,i,n,r,o,s){o=o||this._lineWidth,null==(s=s||this.getDrawColor()).a&&(s.a=255);for(var a=[],c=0,h=0;h<r;h++){var l=Math.pow(1-c,3)*t.x+3*Math.pow(1-c,2)*c*e.x+3*(1-c)*c*c*i.x+c*c*c*n.x,u=Math.pow(1-c,3)*t.y+3*Math.pow(1-c,2)*c*e.y+3*(1-c)*c*c*i.y+c*c*c*n.y;a.push(cc.p(l,u)),c+=1/r}a.push(cc.p(n.x,n.y)),this._drawSegments(a,o,s,!1)},t.drawCatmullRom=function(t,e,i,n){this.drawCardinalSpline(t,.5,e,i,n)},t.drawCardinalSpline=function(t,e,i,n,r){n=n||this._lineWidth,null==(r=r||this.getDrawColor()).a&&(r.a=255);for(var o,s,a=[],c=1/t.length,h=0;h<i+1;h++){var l=h/i;1===l?(o=t.length-1,s=1):s=(l-c*(o=0|l/c))/c;var u=cc.cardinalSplineAt(cc.getControlPointAt(t,o-1),cc.getControlPointAt(t,o-0),cc.getControlPointAt(t,o+1),cc.getControlPointAt(t,o+2),e,s);a.push(u)}n*=.5;for(var d=0,_=a.length;d<_-1;d++)this.drawSegment(a[d],a[d+1],n,r)},t._render=function(){var t=cc._renderContext;t.bindBuffer(t.ARRAY_BUFFER,this._trianglesWebBuffer),this._dirty&&(t.bufferData(t.ARRAY_BUFFER,this._trianglesArrayBuffer,t.STREAM_DRAW),this._dirty=!1);var e=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;t.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_POSITION),t.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_COLOR),t.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_TEX_COORDS),t.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_POSITION,2,t.FLOAT,!1,e,0),t.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_COLOR,4,t.UNSIGNED_BYTE,!0,e,8),t.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_TEX_COORDS,2,t.FLOAT,!1,e,12),t.drawArrays(t.TRIANGLES,0,3*this._buffer.length),cc.incrementGLDraws(1)},t._ensureCapacity=function(t){var e=this,i=e._buffer;if(i.length+t>e._bufferCapacity){var n=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT;if(e._bufferCapacity+=Math.max(e._bufferCapacity,t),null==i||0===i.length)e._buffer=[],e._trianglesArrayBuffer=new ArrayBuffer(n*e._bufferCapacity),e._trianglesReader=new Uint8Array(e._trianglesArrayBuffer);else{for(var r=[],o=new ArrayBuffer(n*e._bufferCapacity),s=0;s<i.length;s++)r[s]=new cc.V2F_C4B_T2F_Triangle(i[s].a,i[s].b,i[s].c,o,s*n);e._trianglesReader=new Uint8Array(o),e._trianglesArrayBuffer=o,e._buffer=r}}},t.drawDot=function(t,e,i){null==(i=i||this.getDrawColor()).a&&(i.a=255);var n={r:0|i.r,g:0|i.g,b:0|i.b,a:0|i.a},r={vertices:{x:t.x-e,y:t.y-e},colors:n,texCoords:{u:-1,v:-1}},o={vertices:{x:t.x-e,y:t.y+e},colors:n,texCoords:{u:-1,v:1}},s={vertices:{x:t.x+e,y:t.y+e},colors:n,texCoords:{u:1,v:1}},a={vertices:{x:t.x+e,y:t.y-e},colors:n,texCoords:{u:1,v:-1}};this._ensureCapacity(6),this._buffer.push(new cc.V2F_C4B_T2F_Triangle(r,o,s,this._trianglesArrayBuffer,this._buffer.length*cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT)),this._buffer.push(new cc.V2F_C4B_T2F_Triangle(r,s,a,this._trianglesArrayBuffer,this._buffer.length*cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT)),this._dirty=!0},t.drawDots=function(t,e,i){if(t&&0!==t.length){null==(i=i||this.getDrawColor()).a&&(i.a=255);for(var n=0,r=t.length;n<r;n++)this.drawDot(t[n],e,i)}},t.drawSegment=function(t,e,i,r){null==(r=r||this.getDrawColor()).a&&(r.a=255),i=i||.5*this._lineWidth;this._ensureCapacity(18);var o={r:0|r.r,g:0|r.g,b:0|r.b,a:0|r.a},s=cc.v2(t),a=cc.v2(e),c=cc.pNormalize(cc.pPerp(cc.pSub(a,s))),h=cc.pPerp(c),l=cc.pMult(c,i),u=cc.pMult(h,i),d=cc.pSub(a,cc.pAdd(l,u)),_=cc.pAdd(a,cc.pSub(l,u)),f=cc.pSub(a,l),p=cc.pAdd(a,l),g=cc.pSub(s,l),v=cc.pAdd(s,l),m=cc.pSub(s,cc.pSub(l,u)),y=cc.pAdd(s,cc.pAdd(l,u)),T=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT,C=this._trianglesArrayBuffer,x=this._buffer;x.push(new cc.V2F_C4B_T2F_Triangle({vertices:d,colors:o,texCoords:n(cc.pNeg(cc.pAdd(c,h)))},{vertices:_,colors:o,texCoords:n(cc.pSub(c,h))},{vertices:f,colors:o,texCoords:n(cc.pNeg(c))},C,x.length*T)),x.push(new cc.V2F_C4B_T2F_Triangle({vertices:p,colors:o,texCoords:n(c)},{vertices:_,colors:o,texCoords:n(cc.pSub(c,h))},{vertices:f,colors:o,texCoords:n(cc.pNeg(c))},C,x.length*T)),x.push(new cc.V2F_C4B_T2F_Triangle({vertices:p,colors:o,texCoords:n(c)},{vertices:g,colors:o,texCoords:n(cc.pNeg(c))},{vertices:f,colors:o,texCoords:n(cc.pNeg(c))},C,x.length*T)),x.push(new cc.V2F_C4B_T2F_Triangle({vertices:p,colors:o,texCoords:n(c)},{vertices:g,colors:o,texCoords:n(cc.pNeg(c))},{vertices:v,colors:o,texCoords:n(c)},C,x.length*T)),x.push(new cc.V2F_C4B_T2F_Triangle({vertices:m,colors:o,texCoords:n(cc.pSub(h,c))},{vertices:g,colors:o,texCoords:n(cc.pNeg(c))},{vertices:v,colors:o,texCoords:n(c)},C,x.length*T)),x.push(new cc.V2F_C4B_T2F_Triangle({vertices:m,colors:o,texCoords:n(cc.pSub(h,c))},{vertices:y,colors:o,texCoords:n(cc.pAdd(c,h))},{vertices:v,colors:o,texCoords:n(c)},C,x.length*T)),this._dirty=!0},t.drawPoly=function(t,e,i,r,o){if(null!=e){null==e.a&&(e.a=255),null==r.a&&(r.a=255),i=null==i?this._lineWidth:i,i*=.5;var s,a,c,h,l={r:0|e.r,g:0|e.g,b:0|e.b,a:0|e.a},u={r:0|r.r,g:0|r.g,b:0|r.b,a:0|r.a},d=[],_=t.length;for(s=0;s<_;s++){a=cc.v2(t[(s-1+_)%_]),c=cc.v2(t[s]),h=cc.v2(t[(s+1)%_]);var f=cc.pNormalize(cc.pPerp(cc.pSub(c,a))),p=cc.pNormalize(cc.pPerp(cc.pSub(h,c))),g=cc.pMult(cc.pAdd(f,p),1/(cc.pDot(f,p)+1));d[s]={offset:g,n:p}}var v=i>0,m=3*(3*_-2);this._ensureCapacity(m);var y=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT,T=this._trianglesArrayBuffer,C=this._buffer,x=0==v?.5:0;for(s=0;s<_-2;s++)a=cc.pSub(cc.v2(t[0]),cc.pMult(d[0].offset,x)),c=cc.pSub(cc.v2(t[s+1]),cc.pMult(d[s+1].offset,x)),h=cc.pSub(cc.v2(t[s+2]),cc.pMult(d[s+2].offset,x)),C.push(new cc.V2F_C4B_T2F_Triangle({vertices:a,colors:l,texCoords:n(cc.v2())},{vertices:c,colors:l,texCoords:n(cc.v2())},{vertices:h,colors:l,texCoords:n(cc.v2())},T,C.length*y));for(s=0;s<_;s++){var E=(s+1)%_;a=cc.v2(t[s]),c=cc.v2(t[E]);var S=d[s].n,b=d[s].offset,A=d[E].offset,R=v?cc.pSub(a,cc.pMult(b,i)):cc.pSub(a,cc.pMult(b,.5)),I=v?cc.pSub(c,cc.pMult(A,i)):cc.pSub(c,cc.pMult(A,.5)),w=v?cc.pAdd(a,cc.pMult(b,i)):cc.pAdd(a,cc.pMult(b,.5)),O=v?cc.pAdd(c,cc.pMult(A,i)):cc.pAdd(c,cc.pMult(A,.5));v?(C.push(new cc.V2F_C4B_T2F_Triangle({vertices:R,colors:u,texCoords:n(cc.pNeg(S))},{vertices:I,colors:u,texCoords:n(cc.pNeg(S))},{vertices:O,colors:u,texCoords:n(S)},T,C.length*y)),C.push(new cc.V2F_C4B_T2F_Triangle({vertices:R,colors:u,texCoords:n(cc.pNeg(S))},{vertices:w,colors:u,texCoords:n(S)},{vertices:O,colors:u,texCoords:n(S)},T,C.length*y))):(C.push(new cc.V2F_C4B_T2F_Triangle({vertices:R,colors:l,texCoords:n(cc.v2())},{vertices:I,colors:l,texCoords:n(cc.v2())},{vertices:O,colors:l,texCoords:n(S)},T,C.length*y)),C.push(new cc.V2F_C4B_T2F_Triangle({vertices:R,colors:l,texCoords:n(cc.v2())},{vertices:w,colors:l,texCoords:n(S)},{vertices:O,colors:l,texCoords:n(S)},T,C.length*y)))}d=null,this._dirty=!0}else this._drawSegments(t,i,r,!o)},t._drawSegments=function(t,e,i,r){if(e=null==e?this._lineWidth:e,null==(i=i||this._drawColor).a&&(i.a=255),!((e*=.5)<=0)){var o,s,a,c,h={r:0|i.r,g:0|i.g,b:0|i.b,a:0|i.a},l=[],u=t.length;for(o=0;o<u;o++){s=cc.v2(t[(o-1+u)%u]),a=cc.v2(t[o]),c=cc.v2(t[(o+1)%u]);var d=cc.pNormalize(cc.pPerp(cc.pSub(a,s))),_=cc.pNormalize(cc.pPerp(cc.pSub(c,a))),f=cc.pMult(cc.pAdd(d,_),1/(cc.pDot(d,_)+1));l[o]={offset:f,n:_}}var p=3*(3*u-2);this._ensureCapacity(p);var g=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT,v=this._trianglesArrayBuffer,m=this._buffer,y=r?u:u-1;for(o=0;o<y;o++){var T=(o+1)%u;s=cc.v2(t[o]),a=cc.v2(t[T]);var C=l[o].n,x=l[o].offset,E=l[T].offset,S=cc.pSub(s,cc.pMult(x,e)),b=cc.pSub(a,cc.pMult(E,e)),A=cc.pAdd(s,cc.pMult(x,e)),R=cc.pAdd(a,cc.pMult(E,e));m.push(new cc.V2F_C4B_T2F_Triangle({vertices:S,colors:h,texCoords:n(cc.pNeg(C))},{vertices:b,colors:h,texCoords:n(cc.pNeg(C))},{vertices:R,colors:h,texCoords:n(C)},v,m.length*g)),m.push(new cc.V2F_C4B_T2F_Triangle({vertices:S,colors:h,texCoords:n(cc.pNeg(C))},{vertices:A,colors:h,texCoords:n(C)},{vertices:R,colors:h,texCoords:n(C)},v,m.length*g))}l=null,this._dirty=!0}},t.clear=function(){this._buffer.length=0,this._dirty=!0},t._createRenderCmd=function(){return new cc.DrawNode.WebGLRenderCmd(this)})}))}),{}],241:[(function(t,e,i){cc.DrawNode.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._buffer=null,this._drawColor=null,this._blendFunc=null};var n=cc.DrawNode.CanvasRenderCmd.prototype=Object.create(_ccsg.Node.CanvasRenderCmd.prototype);n.constructor=cc.DrawNode.CanvasRenderCmd,n.rendering=function(t,e,i){var n=t||cc._renderContext,r=(n.getContext(),this._node._displayedOpacity/255);if(0!==r){n.setTransform(this._worldTransform,e,i),n.setGlobalAlpha(r),this._blendFunc&&this._blendFunc.src===cc.macro.SRC_ALPHA&&this._blendFunc.dst===cc.macro.ONE&&n.setCompositeOperation("lighter");for(var o=this._buffer,s=0,a=o.length;s<a;s++){var c=o[s];switch(c.type){case cc.DrawNode.TYPE_DOT:this._drawDot(n,c,e,i);break;case cc.DrawNode.TYPE_SEGMENT:this._drawSegment(n,c,e,i);break;case cc.DrawNode.TYPE_POLY:this._drawPoly(n,c,e,i)}}}},n._drawDot=function(t,e,i,n){var r=e.fillColor,o=e.verts[0],s=e.lineWidth,a=t.getContext();t.setFillStyle("rgba("+(0|r.r)+","+(0|r.g)+","+(0|r.b)+","+r.a/255+")"),a.beginPath(),a.arc(o.x,-o.y,s,0,2*Math.PI,!1),a.closePath(),a.fill()},n._drawSegment=function(t,e,i,n){var r=e.lineColor,o=e.verts[0],s=e.verts[1],a=e.lineWidth,c=e.lineCap,h=t.getContext();t.setStrokeStyle("rgba("+(0|r.r)+","+(0|r.g)+","+(0|r.b)+","+r.a/255+")"),h.lineWidth=a*i,h.beginPath(),h.lineCap=c,h.moveTo(o.x,-o.y),h.lineTo(s.x,-s.y),h.stroke()},n._drawPoly=function(t,e,i,n){var r=e.verts,o=e.lineCap;if(null!=r){var s=e.fillColor,a=e.lineWidth,c=e.lineColor,h=e.isClosePolygon,l=e.isFill,u=e.isStroke,d=t.getContext(),_=r[0];d.lineCap=o,s&&t.setFillStyle("rgba("+(0|s.r)+","+(0|s.g)+","+(0|s.b)+","+s.a/255+")"),a&&(d.lineWidth=a*i),c&&t.setStrokeStyle("rgba("+(0|c.r)+","+(0|c.g)+","+(0|c.b)+","+c.a/255+")"),d.beginPath(),d.moveTo(_.x,-_.y);for(var f=1,p=r.length;f<p;f++)d.lineTo(r[f].x,-r[f].y);h&&d.closePath(),l&&d.fill(),u&&d.stroke()}}}),{}],242:[(function(t,e,i){cc.DrawNode.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._matrix=new cc.math.Matrix4,this._matrix.identity()},cc.DrawNode.WebGLRenderCmd.prototype=Object.create(_ccsg.Node.WebGLRenderCmd.prototype),cc.DrawNode.WebGLRenderCmd.prototype.constructor=cc.DrawNode.WebGLRenderCmd,cc.DrawNode.WebGLRenderCmd.prototype.rendering=function(t){var e=this._node;if(e._buffer.length>0){var i=this._worldTransform,n=this._matrix.mat;n[0]=i.a,n[4]=i.c,n[12]=i.tx,n[1]=i.b,n[5]=i.d,n[13]=i.ty,cc.gl.blendFunc(e._blendFunc.src,e._blendFunc.dst),this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix),e._render()}}}),{}],243:[(function(t,e,i){t("./cocos2d/core/index.js"),t("./cocos2d/animation/index.js"),t("./cocos2d/particle/CCParticleSystem"),t("./cocos2d/tilemap/CCTiledMap"),t("./cocos2d/motion-streak/CCMotionStreak"),t("./cocos2d/core/components/CCStudioComponent"),t("./extensions/ccpool/CCNodePool"),t("./extensions/ccpool/CCPool"),t("./cocos2d/actions/index.js"),t("./external/chipmunk/chipmunk"),t("./extensions/spine/index.js"),t("./extensions/dragonbones/index.js"),t("./cocos2d/deprecated")}),{"./cocos2d/actions/index.js":11,"./cocos2d/animation/index.js":20,"./cocos2d/core/components/CCStudioComponent":95,"./cocos2d/core/index.js":121,"./cocos2d/deprecated":210,"./cocos2d/motion-streak/CCMotionStreak":225,"./cocos2d/particle/CCParticleAsset":229,"./cocos2d/particle/CCParticleSystem":230,"./cocos2d/tilemap/CCTiledMap":1,"./cocos2d/tilemap/CCTiledMapAsset":1,"./extensions/ccpool/CCNodePool":244,"./extensions/ccpool/CCPool":245,"./extensions/dragonbones/index.js":1,"./extensions/spine/index.js":1,"./external/chipmunk/chipmunk":1}],244:[(function(t,e,i){cc.NodePool=function(t){this.poolHandlerComp=t,this._pool=[]},cc.NodePool.prototype={constructor:cc.NodePool,size:function(){return this._pool.length},clear:function(){for(var t=this._pool.length,e=0;e<t;++e)this._pool[e].destroy();this._pool.length=0},put:function(t){if(t&&-1===this._pool.indexOf(t)){t.removeFromParent(!1);var e=this.poolHandlerComp?t.getComponent(this.poolHandlerComp):null;e&&e.unuse&&e.unuse(),this._pool.push(t)}},get:function(){var t=this._pool.length-1;if(t<0)return null;var e=this._pool[t];this._pool.length=t;var i=this.poolHandlerComp?e.getComponent(this.poolHandlerComp):null;return i&&i.reuse&&i.reuse.apply(i,arguments),e}},e.exports=cc.NodePool}),{}],245:[(function(t,e,i){var n=[];cc.pool={_pool:{},_releaseCB:function(){this.release()},_autoRelease:function(t){var e=void 0!==t._running&&!t._running;cc.director.getScheduler().schedule(this._releaseCB,t,0,0,0,e)},putInPool:function(t){var e=cc.js._getClassId(t.constructor);e&&(this._pool[e]||(this._pool[e]=[]),t.unuse&&t.unuse(),this._pool[e].push(t))},hasObject:function(t){var e=cc.js._getClassId(t),i=this._pool[e];return!(!i||0===i.length)},removeObject:function(t){var e=cc.js._getClassId(t.constructor);if(e){var i=this._pool[e];if(i)for(var n=0;n<i.length;n++)t===i[n]&&i.splice(n,1)}},getFromPool:function(t){if(this.hasObject(t)){var e=cc.js._getClassId(t),i=this._pool[e];n.length=arguments.length-1;for(var r=0;r<n.length;r++)n[r]=arguments[r+1];var o=i.pop();return o.reuse&&o.reuse.apply(o,n),n.length=0,o}},drainAllPools:function(){this._pool={}}}}),{}],246:[(function(t,e,i){function n(t,e){void 0===o[t]&&(o[t]=e)}function r(t){return"object"==typeof o[t]}var o="undefined"==typeof window?global:window;n("CC_TEST",r("tap")||r("QUnit")),n("CC_EDITOR",r("Editor")&&r("process")&&"electron"in process.versions),n("CC_PREVIEW",!0),n("CC_DEV",!0),n("CC_DEBUG",!0),n("CC_JSB",r("jsb")),n("CC_BUILD",!1),cc={},cc._isWechatGame=function(){return window.wx},cc.supportJit="function"==typeof Function(""),cc.downLoadFiles={},cc._appendLocalUrlPrefix=function(t){var e=cc.path.extname(t),i=cc.path.basename(t,e)+e,n=cc.downLoadFiles[i];return void 0!==n&&""!==n?n:t},_ccsg={},t("./CCDebugger"),cc._initDebugSetting(cc.DebugMode.INFO),t("./polyfill/string"),t("./polyfill/misc"),t("./polyfill/array"),t("./polyfill/typescript"),t("./cocos2d/kazmath/index.js"),t("./cocos2d/core/predefine"),ccui={},ccs={},cp={},t("./cocos2d/shaders/index.js"),t("./CCBoot"),t("./cocos2d/index.js"),t("./extends"),e.exports=cc}),{"./CCBoot":2,"./CCDebugger":3,"./DebugInfos":4,"./cocos2d/core/predefine":172,"./cocos2d/index.js":211,"./cocos2d/kazmath/index.js":215,"./cocos2d/shaders/index.js":239,"./extends":243,"./package.json":void 0,"./polyfill/array":247,"./polyfill/misc":248,"./polyfill/string":249,"./polyfill/typescript":250}],247:[(function(t,e,i){Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)})}),{}],248:[(function(t,e,i){if(Math.sign||(Math.sign=function(t){return 0==(t=+t)||isNaN(t)?t:t>0?1:-1}),Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&(0|t)===t}),!console.time){var n=window.performance||Date,r=Object.create(null);console.time=function(t){r[t]=n.now()},console.timeEnd=function(t){var e=r[t],i=n.now()-e;console.log(t+": "+i+"ms")}}}),{}],249:[(function(t,e,i){String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return e=e||0,this.lastIndexOf(t,e)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){(void 0===e||e>this.length)&&(e=this.length),e-=t.length;var i=this.indexOf(t,e);return-1!==i&&i===e})}),{}],250:[(function(t,e,i){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};window.__extends=function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},window.__assign=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++){e=arguments[i];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},window.__rest=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&(i[n[r]]=t[n[r]]);return i},window.__decorate=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},window.__param=function(t,e){return function(i,n){e(i,n,t)}},window.__metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},window.__awaiter=function(t,e,i,n){return new(i||(i=Promise))(function(r,o){function s(t){try{c(n.next(t))}catch(t){o(t)}}function a(t){try{c(n.throw(t))}catch(t){o(t)}}function c(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(s,a)}c((n=n.apply(t,e||[])).next())})},window.__generator=function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,o&&(s=o[2&i[0]?"return":i[0]?"throw":"next"])&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[0,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(s=c.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){c.label=i[1];break}if(6===i[0]&&c.label<s[1]){c.label=s[1],s=i;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(i);break}s[2]&&c.ops.pop(),c.trys.pop();continue}i=e.call(t,c)}catch(t){i=[6,t],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},window.__exportStar=function(t,e){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])},window.__values=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],i=0;return e?e.call(t):{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}}},window.__read=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,r,o=i.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){r={error:t}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s},window.__spread=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(__read(arguments[e]));return t},window.__await=function(t){return this instanceof __await?(this.v=t,this):new __await(t)},window.__asyncGenerator=function(t,e,i){function n(t){l[t]&&(h[t]=function(e){return new Promise(function(i,n){u.push([t,e,i,n])>1||r(t,e)})})}function r(t,e){try{o(l[t](e))}catch(t){c(u[0][3],t)}}function o(t){t.value instanceof __await?Promise.resolve(t.value.v).then(s,a):c(u[0][2],t)}function s(t){r("next",t)}function a(t){r("throw",t)}function c(t,e){t(e),u.shift(),u.length&&r(u[0][0],u[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var h,l=i.apply(t,e||[]),u=[];return h={},n("next"),n("throw"),n("return"),h[Symbol.asyncIterator]=function(){return this},h},window.__asyncDelegator=function(t){function e(e,r){t[e]&&(i[e]=function(i){return(n=!n)?{value:__await(t[e](i)),done:"return"===e}:r?r(i):i})}var i,n;return i={},e("next"),e("throw",(function(t){throw t})),e("return"),i[Symbol.iterator]=function(){return this},i},window.__asyncValues=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator];return e?e.call(t):"function"==typeof __values?__values(t):t[Symbol.iterator]()}}),{}]},{},[246]); 
 			});
 		define("gamesettingconfig.js", function(require, module, exports){ 			
GameSettingConfig={"CDN_ENABLE" : true, "Public" : true, "ShowFPS" : false}; 
 			});
 		define("main.js", function(require, module, exports){ 			
(function () {

    'use strict';
    // Release版本屏蔽掉log和warn。
    if (!CC_DEBUG && !window._CCSettings.debug) {
        console.log = function() {};
        console.warn = function() {};
    }
    function boot () {

        var settings = window._CCSettings;
        window._CCSettings = undefined;

        if ( !settings.debug ) {
            var uuids = settings.uuids;

            var rawAssets = settings.rawAssets;
            var assetTypes = settings.assetTypes;
            var realRawAssets = settings.rawAssets = {};
            for (var mount in rawAssets) {
                var entries = rawAssets[mount];
                var realEntries = realRawAssets[mount] = {};
                for (var id in entries) {
                    var entry = entries[id];
                    var type = entry[1];
                    // retrieve minified raw asset
                    if (typeof type === 'number') {
                        entry[1] = assetTypes[type];
                    }
                    // retrieve uuid
                    realEntries[uuids[id] || id] = entry;
                }
            }

            var scenes = settings.scenes;
            for (var i = 0; i < scenes.length; ++i) {
                var scene = scenes[i];
                if (typeof scene.uuid === 'number') {
                    scene.uuid = uuids[scene.uuid];
                }
            }

            var packedAssets = settings.packedAssets;
            for (var packId in packedAssets) {
                var packedIds = packedAssets[packId];
                for (var j = 0; j < packedIds.length; ++j) {
                    if (typeof packedIds[j] === 'number') {
                        packedIds[j] = uuids[packedIds[j]];
                    }
                }
            }
        }

        // init engine
        var canvas;

        if (cc.sys.isBrowser) {
            canvas = document.getElementById('GameCanvas');
        }

        function setLoadingDisplay () {
            // Loading splash scene
            //var splash = document.getElementById('splash');
            //var progressBar = splash.querySelector('.progress-bar span');
            cc.loader.onProgress = function (completedCount, totalCount, item) {
                var percent = 100 * completedCount / totalCount;
                //if (progressBar) {
                    //progressBar.style.width = percent.toFixed(2) + '%';
                //}
            };
            //splash.style.display = 'block';
            //progressBar.style.width = '0%';

            cc.director.once(cc.Director.EVENT_AFTER_SCENE_LAUNCH, function () {
                //splash.style.display = 'none';
            });
        }

        var onStart = function () {
            cc.view.resizeWithBrowserSize(true);
            // UC browser on many android devices have performance issue with retina display
            if (cc.sys.os !== cc.sys.OS_ANDROID || cc.sys.browserType !== cc.sys.BROWSER_TYPE_UC) {
                cc.view.enableRetina(true);
            }
            //cc.view.setDesignResolutionSize(settings.designWidth, settings.designHeight, cc.ResolutionPolicy.SHOW_ALL);

            if (cc.sys.isBrowser) {
                setLoadingDisplay();
            }

            if (cc.sys.isMobile) {
                if (settings.orientation === 'landscape') {
                    cc.view.setOrientation(cc.macro.ORIENTATION_LANDSCAPE);
                }
                else if (settings.orientation === 'portrait') {
                    cc.view.setOrientation(cc.macro.ORIENTATION_PORTRAIT);
                }
                // qq, wechat, baidu
                cc.view.enableAutoFullScreen(
                    cc.sys.browserType !== cc.sys.BROWSER_TYPE_BAIDU &&
                    cc.sys.browserType !== cc.sys.BROWSER_TYPE_WECHAT &&
                    cc.sys.browserType !== cc.sys.BROWSER_TYPE_MOBILE_QQ
                );
            }

            // Limit downloading max concurrent task to 2,
            // more tasks simultaneously may cause performance draw back on some android system / brwosers.
            // You can adjust the number based on your own test result, you have to set it before any loading process to take effect.
            if (cc.sys.isBrowser && cc.sys.os === cc.sys.OS_ANDROID) {
                cc.macro.DOWNLOAD_MAX_CONCURRENT = 2;
            }


            // init assets
            cc.AssetLibrary.init({
                libraryPath: 'res/import',
                rawAssetsBase: 'res/raw-',
                rawAssets: settings.rawAssets,
                packedAssets: settings.packedAssets,
                md5AssetsMap: settings.md5AssetsMap
            });

            var launchScene = settings.launchScene;

            // load scene
            if (cc.runtime) {
                cc.director.setRuntimeLaunchScene(launchScene);
            }
            cc.director.loadScene(launchScene, null,
                function () {
                    if (cc.sys.isBrowser) {
                        // show canvas
                        //canvas.style.visibility = '';
                        var div = document.getElementById('GameDiv');
                        if (div) {
                            div.style.backgroundImage = '';
                        }
                    }
                    cc.loader.onProgress = null;

                    // play game
                    // cc.game.resume();

                    console.log('Success to load scene: ' + launchScene);
                }
            );
        };

        // jsList
        var jsList = settings.jsList;
        if (jsList) {
            jsList.push(bundledScript);
        }
        else {
            jsList = [];
        }

        jsList = jsList.map(function (x) { return 'src/' + x; });

        var option = {
            //width: width,
            //height: height,
            id: 'GameCanvas',
            scenes: settings.scenes,
            debugMode: settings.debug ? cc.DebugMode.INFO : cc.DebugMode.ERROR,
            showFPS: settings.debug,
            frameRate: 60,
            jsList: jsList,
            groupList: settings.groupList,
            collisionMatrix: settings.collisionMatrix,
            renderMode: 2
        };
        cc.game.run(option, onStart);
    }

    if (cc._isWechatGame()) {
      boot();
    }
    else if (window.document) {
        var splash = document.getElementById('splash');
        splash.style.display = 'block';

        var cocos2d = document.createElement('script');
        cocos2d.async = true;
        cocos2d.src = window._CCSettings.debug ? 'cocos2d-js.js' : 'cocos2d-js-min.js';

        var engineLoaded = function () {
            document.body.removeChild(cocos2d);
            cocos2d.removeEventListener('load', engineLoaded, false);
            window.eruda && eruda.init();
            boot();
        };
        cocos2d.addEventListener('load', engineLoaded, false);
        document.body.appendChild(cocos2d);
    }
    else if (window.jsb) {
        require('src/settings.js');
        require('src/jsb_polyfill.js');

        boot();
    }

})();
 
 			});
 		define("src/project.js", function(require, module, exports){ 			
require=function e(t,n,i){function a(r,s){if(!n[r]){if(!t[r]){var l="function"==typeof require&&require;if(!s&&l)return l(r,!0);if(o)return o(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[r]={exports:{}};t[r][0].call(u.exports,function(e){var n=t[r][1][e];return a(n||e)},u,u.exports,e,t,n,i)}return n[r].exports}for(var o="function"==typeof require&&require,r=0;r<i.length;r++)a(i[r]);return a}({AIComponent:[function(e,t,n){"use strict";cc._RF.push(t,"dd2ccHSJy9LDanjRovnZYKf","AIComponent");var i=e("SimpleBevTree"),a=(e("TaskStatus"),e("ResTableNames")),o=e("EntityTypeDefine"),r=(e("AIUtil"),e("Util")),s=cc.Class({extends:cc.Component,statics:{tickInterval:.3,lastAiTickTime:0},properties:{countDown:{default:0,serializable:!1,visible:!1},bevTree:{default:null,serializable:!1,visible:!1,type:i}},onLoad:function(){},Init:function(e,t,n){var s="bevtree_";s=t===o.EntityLineType.Left?s+"left_"+n:t===o.EntityLineType.Mid?s+"mid_"+n:s+"right_"+n,this.bevTree=new i;var l=window.GGameEntry.ResTableMgr.GetObjectByName(a[s]);r.AssertCheck(null!=l,"行为树配置读取失败："+s),this.bevTree.init(s,e,l)},Reset:function(){this.bevTree&&(this.bevTree.reset(),this.countDown=0)},Finit:function(){this.bevTree&&(this.bevTree.finit(),this.bevTree=null)},update:function(e){if(window.GGameEntry.BattleSystem.IsPlaying()&&null!=this.bevTree&&(this.countDown=this.countDown-e,!(this.countDown>0))){var t=Date.now()/1e3;t-s.lastAiTickTime<s.tickInterval/6?this.countDown=s.tickInterval/6:(s.lastAiTickTime=t,this.countDown=s.tickInterval,window.GGameEntry.PerformanceMgr.Config.EnableMonitor&&window.GGameEntry.PerformanceMgr.Config.DisableAI||(r.BeginSample("AIComponent::RunBevTree"),this.bevTree.RunBevTree(),r.EndSample("AIComponent::RunBevTree")))}}});cc._RF.pop()},{AIUtil:"AIUtil",EntityTypeDefine:"EntityTypeDefine",ResTableNames:"ResTableNames",SimpleBevTree:"SimpleBevTree",TaskStatus:"TaskStatus",Util:"Util"}],AIConfig:[function(e,t,n){"use strict";cc._RF.push(t,"6eaadHCZl1LOqSF5G/NPh1Q","AIConfig");var i=[{ID:1,blue:{basePos:[6,0],firstDefendGrids:[[5,0],[7,0]],secondDefendGrids:[[2,3],[10,3],[3,6],[6,6],[9,6]],steelDefendGrids:[[5,1],[6,1],[7,1],[5,4],[6,4],[7,4]],idiotRadomMoveGrids:[[1,14],[0,12],[0,9],[0,6],[1,4],[4,4],[8,4],[11,4],[12,6],[12,9],[12,12],[11,14],[8,14],[4,14],[3,10],[3,7],[9,7],[9,10],[6,9],[5,11],[7,11],[5,7],[7,7]],idiotAttackGrids:[[1,12],[1,6],[1,9],[3,8],[6,10],[6,8],[9,8],[11,9],[11,12],[11,6]],left:{BirthPos:[3,0],FirstOffenceGrids:[4,3],SecondOffenceGrids:[[4,6],[5,6]],GotoEnemyBase:[[2,18],[4,18],[3,17],[2,16],[4,16]]},mid:{BirthPos:[6,2],FirstOffenceGrids:[6,3],SecondOffenceGrids:[[0,5],[12,5]],GotoEnemyBase:[[3,18],[2,17],[3,16],[4,17],[9,18],[8,17],[9,16],[10,17]]},right:{BirthPos:[9,0],FirstOffenceGrids:[8,3],SecondOffenceGrids:[[7,6],[8,6]],GotoEnemyBase:[[8,18],[10,18],[9,17],[8,16],[10,16]]}},red:{basePos:[6,18],firstDefendGrids:[[5,18],[7,18]],secondDefendGrids:[[3,12],[6,12],[9,12]],steelDefendGrids:[[5,17],[6,17],[7,17],[5,14],[6,14],[7,14],[2,15],[3,15],[9,15],[10,15]],idiotRadomMoveGrids:[[1,14],[0,12],[0,9],[0,6],[1,4],[4,4],[8,4],[11,4],[12,6],[12,9],[12,12],[11,14],[8,14],[4,14],[3,10],[3,7],[9,7],[9,10],[6,9],[5,11],[7,11],[5,7],[7,7]],idiotAttackGrids:[[1,12],[1,6],[1,9],[3,8],[6,10],[6,8],[9,8],[11,9],[11,12],[11,6]],left:{BirthPos:[3,18],FirstOffenceGrids:[4,15],SecondOffenceGrids:[[4,12],[5,12]],GotoEnemyBase:[[2,2],[4,2],[3,1],[2,0],[4,0]]},mid:{BirthPos:[6,16],FirstOffenceGrids:[6,15],SecondOffenceGrids:[[0,13],[12,13]],GotoEnemyBase:[[3,2],[2,1],[3,0],[4,1],[9,2],[8,1],[9,0],[10,1]]},right:{BirthPos:[9,18],FirstOffenceGrids:[8,15],SecondOffenceGrids:[[7,12],[8,12]],GotoEnemyBase:[[8,2],[10,2],[9,1],[8,0],[10,0]]}}},{ID:1001,blue:{basePos:[6,0],firstDefendGrids:[[5,0],[7,0]],secondDefendGrids:[[2,3],[10,3],[5,5],[7,5]],steelDefendGrids:[[5,1],[6,1],[7,1],[4,4],[5,4],[6,4],[7,4],[8,4],[6,5]],idiotRadomMoveGrids:[[1,5],[1,6],[1,7],[1,9],[1,10],[1,11],[11,5],[11,6],[11,7],[11,9],[11,10],[11,11],[2,6],[2,7],[2,9],[2,10],[10,6],[10,7],[10,9],[10,10],[3,5],[4,5],[8,5],[9,5],[3,11],[4,11],[8,11],[9,11],[4,7],[8,7],[4,9],[8,9],[6,6],[6,10],[5,8],[6,8],[7,8]],idiotAttackGrids:[[3,7],[5,7],[6,7],[7,7],[9,7],[3,9],[5,9],[6,9],[7,9],[9,9],[0,8],[1,8],[11,8],[12,8]],left:{BirthPos:[3,0],FirstOffenceGrids:[[3,4]],SecondOffenceGrids:[[2,6],[3,6],[4,6]],GotoEnemyBase:[[2,14],[3,14],[4,14],[2,15],[3,15],[4,15],[2,16],[3,16],[4,16]]},mid:{BirthPos:[6,2],FirstOffenceGrids:[[6,3]],SecondOffenceGrids:[[0,5],[0,6],[1,5],[1,6],[11,5],[11,6],[12,5],[12,6]],GotoEnemyBase:[[2,14],[3,14],[4,14],[2,15],[3,15],[4,15],[2,16],[3,16],[4,16],[8,14],[9,14],[10,14],[8,15],[9,15],[10,15],[8,16],[9,16],[10,16]]},right:{BirthPos:[9,0],FirstOffenceGrids:[[9,4]],SecondOffenceGrids:[[8,7],[9,7],[10,7]],GotoEnemyBase:[[8,14],[9,14],[10,14],[8,15],[9,15],[10,15],[8,16],[9,16],[10,16]]}},red:{basePos:[6,16],firstDefendGrids:[[5,16],[7,16]],secondDefendGrids:[[2,13],[10,13],[5,11],[7,11]],steelDefendGrids:[[5,15],[6,15],[7,15],[4,12],[5,12],[6,12],[7,12],[8,12],[6,11]],idiotRadomMoveGrids:[[1,5],[1,6],[1,7],[1,9],[1,10],[1,11],[11,5],[11,6],[11,7],[11,9],[11,10],[11,11],[2,6],[2,7],[2,9],[2,10],[10,6],[10,7],[10,9],[10,10],[3,5],[4,5],[8,5],[9,5],[3,11],[4,11],[8,11],[9,11],[4,7],[8,7],[4,9],[8,9],[6,6],[6,10],[5,8],[6,8],[7,8]],idiotAttackGrids:[[3,7],[5,7],[6,7],[7,7],[9,7],[3,9],[5,9],[6,9],[7,9],[9,9],[0,8],[1,8],[11,8],[12,8]],left:{BirthPos:[3,16],FirstOffenceGrids:[[3,12]],SecondOffenceGrids:[[2,10],[3,10],[4,10]],GotoEnemyBase:[[2,0],[3,0],[4,0],[2,1],[3,1],[4,1],[2,2],[3,2],[4,2]]},mid:{BirthPos:[6,14],FirstOffenceGrids:[[6,15]],SecondOffenceGrids:[[0,12],[0,13],[1,12],[1,13],[11,12],[11,13],[12,12],[12,13]],GotoEnemyBase:[[2,0],[3,0],[4,0],[2,1],[3,1],[4,1],[2,2],[3,2],[4,2],[8,0],[9,0],[10,0],[8,1],[9,1],[10,1],[8,2],[9,2],[10,2]]},right:{BirthPos:[9,16],FirstOffenceGrids:[[9,12]],SecondOffenceGrids:[[8,10],[9,10],[10,10]],GotoEnemyBase:[[8,0],[9,0],[10,0],[8,1],[9,1],[10,1],[8,2],[9,2],[10,2]]}}}];t.exports={MapConfig:i},cc._RF.pop()},{}],AIEnumDef:[function(e,t,n){"use strict";cc._RF.push(t,"da865TJsLhJgaE3dXeK4sjv","AIEnumDef");var i=cc.Enum({My:0,Enemy:1}),a=cc.Enum({None:0,Left:1,Mid:2,Right:3}),o=cc.Enum({basePos:0,firstDefendGrids:1,secondDefendGrids:2,steelDefendGrids:3,idiotRadomMoveGrids:4}),r=cc.Enum({FirstOffenceGrids:0,SecondOffenceGrids:1,GotoEnemyBase:2,DefenceGrids:3}),s=cc.Enum({Target:0,MovingDir:1,TargetPosition:2}),l=cc.Enum({Equal:0,Greater:1,Less:2});t.exports={Camp_Select:i,Line_Select:a,CampGridsType:o,LineGridsType:r,RotationType:s,CmpType:l},cc._RF.pop()},{}],AIMapUtil:[function(e,t,n){"use strict";cc._RF.push(t,"91e0aAr8flKYZOV4vmxBAht","AIMapUtil");var i=e("AIConfig"),a=e("MapCfg"),o=e("EntityTypeDefine");cc.Class({statics:{curMapConfig:{},InitAiMapConfig:function(e){for(var t=0;t<i.MapConfig.length;++t)if(i.MapConfig[t].ID==e)return this.curMapConfig=i.MapConfig[t],!0;return!1},GetCampConfig:function(e){return this.curMapConfig?e===o.EntityCampType.RedTeam?this.curMapConfig.red:this.curMapConfig.blue:null},GetLineConfig:function(e,t){var n=this.GetCampConfig(e);return t===o.EntityLineType.Left?n.left:t===o.EntityLineType.Mid?n.mid:n.right},GetBirthPosByLine:function(e,t){if(!e)return null;var n=null,i=(n=t===o.EntityLineType.Left?e.left.BirthPos:t===o.EntityLineType.Mid?e.mid.BirthPos:e.right.BirthPos)[0],a=n[1];return this.GetCanBornPosition(i,a)},GetCanBornPosition:function(e,t){if(!window.GGameEntry.MapManager.BigGridCanWalk(e,t,!0))for(var n=[[-1,0],[0,-1],[1,0],[0,1],[1,1],[-1,-1],[-1,1],[1,-1]],i=!1,o=window.GGameEntry.MapManager.GridWidth*a.MapGlobalCfg.MapTileSize[0],r=window.GGameEntry.MapManager.GridWidth*a.MapGlobalCfg.MapTileSize[1],s=1;s<=4;s++){for(var l=0;l<n.length;l++){var c=e+s*n[l][0],u=t+s*n[l][1];if(!(c<0||u<0||c>=o||u>=r)&&window.GGameEntry.MapManager.BigGridCanWalk(c,u,!0)){e=c,t=u,i=!0;break}}if(i)break}var d=this.BigGrid2Grid(cc.v2(e,t)),h=window.GGameEntry.MapManager.GetWorldPos(d.x,d.y);return cc.v2(h[0],h[1])},GetCanWalkPositionFromLine:function(e,t,n,i,a){Math.floor(e/100),Math.floor(t/100);for(var o=[],r=Math.floor(a/100);r>=1;r--){var s=Math.floor((e+n*r*100)/100),l=Math.floor((t+i*r*100)/100);o[o.length]=[s,l]}for(var c,u,d=!1,h=window.GGameEntry.MapManager.GridWidth,f=window.GGameEntry.MapManager.GridWidth,m=0;m<o.length;m++){var y=o[m][0],p=o[m][1];if(!(y<0||p<0||y>=h||p>=f)&&window.GGameEntry.MapManager.BigGridCanWalk(y,p,!0)){c=y,u=p,d=!0;break}}if(d){var g=this.BigGrid2Grid(cc.v2(c,u)),C=window.GGameEntry.MapManager.GetWorldPos(g.x,g.y);return cc.v2(C[0],C[1])}return cc.v2(e,t)},GetBirthPos:function(e,t){return this.curMapConfig?e===o.EntityCampType.RedTeam?this.GetBirthPosByLine(this.curMapConfig.red,t):e===o.EntityCampType.BlueTeam?this.GetBirthPosByLine(this.curMapConfig.blue,t):null:null},GetBasePos:function(e){return this.curMapConfig?e===o.EntityCampType.RedTeam?cc.v2(this.curMapConfig.red.basePos[0],this.curMapConfig.red.basePos[1]):e===o.EntityCampType.BlueTeam?cc.v2(this.curMapConfig.blue.basePos[0],this.curMapConfig.blue.basePos[1]):null:null},BigGrid2Grid:function(e){return cc.v2(e.x*a.MapGlobalCfg.MapTileSize[0]+a.MapGlobalCfg.MapTileSize[0]/2,e.y*a.MapGlobalCfg.MapTileSize[1]+a.MapGlobalCfg.MapTileSize[1]/2)},GetGirdCenterPixelPos:function(e,t){var n=window.GGameEntry.MapManager.GetWorldPositionCenter(e,t);return cc.v2(n[0],n[1])},GetObstructInBigGrid:function(e,t){for(var n=cc.v2(a.MapGlobalCfg.MapTileSize[0],a.MapGlobalCfg.MapTileSize[1]),i=e.x*n.x,r=e.y*n.y,s=[],l=i;l<i+n.x;l++)for(var c=r;c<r+n.y;c++){var u=window.GGameEntry.MapManager.GetGridTitleType(l,c);u!==o.EntityType.EntityBase&&u!==o.EntityType.EntityAdobe||(s[s.length]=cc.v2(l,c)),t&&u===o.EntityType.EntitySteel&&(s[s.length]=cc.v2(l,c))}return s}}});cc._RF.pop()},{AIConfig:"AIConfig",EntityTypeDefine:"EntityTypeDefine",MapCfg:"MapCfg"}],AISettingCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"b94ec9fnQRDB5FDPUsLbT8c","AISettingCtrl");var i=e("UIManager");cc.Class({extends:cc.Component,properties:{enemyAILeft:{default:null,type:cc.ToggleGroup},enemyAIMid:{default:null,type:cc.ToggleGroup},enemyAIRight:{default:null,type:cc.ToggleGroup},teammateMid:{default:null,type:cc.ToggleGroup},teammateRight:{default:null,type:cc.ToggleGroup},confirmBtn:{default:null,type:cc.Button},cancleBtn:{default:null,type:cc.Button},resetBtn:{default:null,type:cc.Button}},onEnable:function(){this.confirmBtn.node.on("click",this.onConfirm,this),this.cancleBtn.node.on("click",this.onCancle,this),this.resetBtn.node.on("click",this.onReset,this)},onDisable:function(){this.confirmBtn.node.off("click",this.onConfirm,this),this.cancleBtn.node.off("click",this.onCancle,this),this.resetBtn.node.off("click",this.onReset,this)},onConfirm:function(){var e=new Array;this.setRules(this.enemyAILeft,e),this.setRules(this.enemyAIMid,e),this.setRules(this.enemyAIRight,e),this.setRules(this.teammateMid,e),this.setRules(this.teammateRight,e),window.GGameEntry.MonsterManager.MonsterAIRules=e,window.GGameEntry.UIManager.HideUI(i.UIType.AISettingUI)},onCancle:function(){window.GGameEntry.UIManager.HideUI(i.UIType.AISettingUI)},onReset:function(){this.resetToggles(this.enemyAILeft),this.resetToggles(this.enemyAIMid),this.resetToggles(this.enemyAIRight),this.resetToggles(this.teammateMid),this.resetToggles(this.teammateRight)},setRules:function(e,t){if(e)for(var n=0;n<e.toggleItems.length;n++)if(e.toggleItems[n].isChecked){t.push(n);break}},resetToggles:function(e){for(var t=0;t<e.toggleItems.length;t++)e.toggleItems[t].isChecked=0==t}}),cc._RF.pop()},{UIManager:"UIManager"}],AISystem:[function(e,t,n){"use strict";cc._RF.push(t,"20d7fvZX+JAqqE6pnBtF3gZ","AISystem"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){}}),cc._RF.pop()},{}],AIUtil:[function(e,t,n){"use strict";cc._RF.push(t,"671bdEYNApH3aMWGs9TRTPF","AIUtil");var i=e("MapCfg"),a=(i.MapTileType,i.MapGlobalCfg,i.MapTileCfg,e("TankBase")),o=e("ItemPowerUp"),r=e("EntityTypeDefine"),s=cc.Class({statics:{GetSceneItems:function(){var e=[];for(var t in window.GGameEntry.EntityManager.map)if(window.GGameEntry.EntityManager.map.hasOwnProperty(t)){var n=window.GGameEntry.EntityManager.map[t];n instanceof o&&e.push(n)}return e},GetSceneTanks:function(e){var t=[];for(var n in window.GGameEntry.EntityManager.map)if(window.GGameEntry.EntityManager.map.hasOwnProperty(n)){var i=window.GGameEntry.EntityManager.map[n];i instanceof a&&0==i.isDead&&(void 0!=e&&e!=i.EntityCampType||t.push(i))}return t},GetSceneBullts:function(e){for(var t=[],n=window.GGameEntry.BulletManager.MapBulletPlayer.children,i=0;i<n.length;++i){var a=n[i].getComponent("BulletBase");a&&a.EntitySource&&(!0!==a.DeadAni&&(void 0!=e&&e!=a.EntitySource.EntityCampType||t.push(a)))}return t},FindTargetObj:function(e,t){var n=Math.floor(t/1e5);if(n==r.EntityType.EntityBase)return window.GGameEntry.MapManager.GetMapBattleHome(e);if(n==r.EntityType.EntityAirDropBox)return window.GGameEntry.EntityManager.getEntity(t);for(var i=this.GetSceneTanks(e),a=0;a<i.length;a++)if(i[a].Guid==t)return i[a];return null},GetEnemyCamp:function(e){return e==r.EntityCampType.RedTeam?r.EntityCampType.BlueTeam:r.EntityCampType.RedTeam},GetEnemysInCircle:function(e,t){if(!e)return[];window.GGameEntry.MapManager;for(var n=s.GetSceneTanks(s.GetEnemyCamp(e.EntityCampType)),i=[],a=0;a<n.length;++a)n[a].Invincible||e.GetSmallGridPos().sub(n[a].GetSmallGridPos()).magSqr()<=t*t&&i.push(n[a]);return i},GetNearestEnemys:function(e){if(!e)return[];window.GGameEntry.MapManager;for(var t=s.GetSceneTanks(s.GetEnemyCamp(e.EntityCampType)),n=Number.MAX_SAFE_INTEGER,i=null,a=0;a<t.length;++a)if(!t[a].Invincible){var o=e.GetSmallGridPos().sub(t[a].GetSmallGridPos()).magSqr();o<=n&&(i=t[a],n=o)}return i},GetNearestEnemysAtPosition:function(e,t){window.GGameEntry.MapManager;for(var n=s.GetSceneTanks(s.GetEnemyCamp(t)),i=Number.MAX_SAFE_INTEGER,a=null,o=0;o<n.length;++o)if(!n[o].Invincible){var r=n[o].node.position,l=e.sub(r).magSqr();l<=i&&(a=n[o],i=l)}return a},GetTeammatesInCircle:function(e,t){if(!e)return[];window.GGameEntry.MapManager;for(var n=s.GetSceneTanks(e.EntityCampType),i=[],a=0;a<n.length;++a)e.GetSmallGridPos().sub(n[a].GetSmallGridPos()).magSqr()<=t*t&&i.push(n[a]);return i},GetNearestTeammate:function(e){if(!e)return[];window.GGameEntry.MapManager;for(var t=s.GetSceneTanks(e.EntityCampType),n=Number.MAX_SAFE_INTEGER,i=null,a=0;a<t.length;++a){var o=e.GetSmallGridPos().sub(t[a].GetSmallGridPos()).magSqr();o<=n&&(i=t[a],n=o)}return i},GetItemsInCircle:function(e,t){if(!e)return[];window.GGameEntry.MapManager;for(var n=s.GetSceneItems(),i=[],a=0;a<n.length;++a)e.node.position.sub(n[a].node.position).magSqr()<=t*t&&i.push(n[a]);return i},CanDirectAttack_Pixel:function(e,t,n){if(!this.IsTargetPosInRange(e,t,n))return!1;var i=window.GGameEntry.MapManager.GetGridPos(e.x,e.y),a=cc.v2(i[0],i[1]),i=window.GGameEntry.MapManager.GetGridPos(n.x,n.y),o=cc.v2(i[0],i[1]);return!!window.GGameEntry.MapManager.RaycastMapdata(a,o)},CanDirectAttack_Grid:function(e,t,n){return!!this.IsTargetPosInRange(e,t,n)&&!!window.GGameEntry.MapManager.RaycastMapdata(e,n)},IsTargetPosInRange:function(e,t,n){return!(n.sub(e).magSqr()>t*t)},GetBulletFlyMe:function(e){var t=[];if(!e)return t;for(var n=this.GetSceneBullts(),i=0;i<n.length;++i)if(n[i].EntitySource!=e&&!(e.node.position.sub(n[i].StartPos).magSqr()>n[i].MaxFlyDistance*n[i].MaxFlyDistance)){var a=n[i].node.position.sub(e.node.position);Math.atan2(a.y,a.x)*(180/Math.PI)+180-n[i].node.rotation<5&&(window.GGameEntry.MapManager.RaycastMapdata(n[i].GetSmallGridPos(),e.GetSmallGridPos())||t.push(n[i]))}return t}}});cc._RF.pop()},{EntityTypeDefine:"EntityTypeDefine",ItemPowerUp:"ItemPowerUp",MapCfg:"MapCfg",TankBase:"TankBase"}],A_Attack:[function(e,t,n){"use strict";cc._RF.push(t,"094ccy0WqxJsJfGlLan3IKz","A_Attack");var i=e("TaskStatus"),a=e("BevAction"),o=e("AiInterface"),r=e("AIUtil"),s=e("AIMapUtil"),l=e("Util");cc.Class({name:"A_Attack",extends:a,properties:{angle:{default:0,type:cc.Integer,serializable:!0}},OnExcute:function(){l.BeginSample("A_Attack::OnExcute");var e=this.bevTree.actor;if(!e||e.isDead)return i.Failure;var t=Math.round(cc.randomMinus1To1()*this.angle);if(null!=e.targetGuid){var n=r.FindTargetObj(r.GetEnemyCamp(e.EntityCampType),e.targetGuid);if(null!=n){var a=((u=e.CalRotation(n.GetPixelPos()))+t+360)%360;e.rotateAll(a)}}else{if(null==e.targetPosToFire)return cc.log("No Attack Target or TargetPos"),i.Failure;var c=s.GetGirdCenterPixelPos(e.targetPosToFire.x,e.targetPosToFire.y),u=e.CalRotation(c);e.rotateAll(u),this.bevTree.sharedVars.lastTargetPos=e.targetPosToFire}return o.SendMoveStopMsg(e),o.SendSkillMsg(e),l.EndSample("A_Attack::OnExcute"),i.Success}}),cc._RF.pop()},{AIMapUtil:"AIMapUtil",AIUtil:"AIUtil",AiInterface:"AiInterface",BevAction:"BevAction",TaskStatus:"TaskStatus",Util:"Util"}],A_Dodge:[function(e,t,n){"use strict";cc._RF.push(t,"c9d4dNILoNDHKysGUsonhGP","A_Dodge");e("TaskStatus"),e("BevAction");var i=e("AIUtil"),a=e("A_Move");cc.Class({name:"A_Dodge",extends:a,destination:null,findDestination:function(){for(var e=this.bevTree.actor,t=i.GetBulletFlyMe(e),n=cc.v2(0,0),a=0;a<t.length;a++){var o=t[a].getBulletSpeed();o.equals(cc.v2(0,0))||(o=o.normalize(),n.addSelf(cc.v2(-o.y,o.x)))}var r=n.mul(100).add(e.node.position),s=window.GGameEntry.MapManager.GetGridPos(r.x,r.y);return cc.v2(s[0],s[1])}}),cc._RF.pop()},{AIUtil:"AIUtil",A_Move:"A_Move",BevAction:"BevAction",TaskStatus:"TaskStatus"}],A_Idle:[function(e,t,n){"use strict";cc._RF.push(t,"9a4d1KNKWFC5Yg7AhCR1p9G","A_Idle");var i=e("TaskStatus"),a=e("BevAction");cc.Class({name:"A_Idle",extends:a,properties:{minTime:{default:1,type:cc.Integer},maxTime:{default:1,type:cc.Integer}},startTime:0,timeInterval:0,OnStart:function(){this.startTime=(new Date).getTime()-window.GGameEntry.BattleSystem.BattleData.StartTime,this.timeInterval=cc.random0To1()*(this.maxTime-this.minTime)+this.minTime},OnExcute:function(){var e=this.bevTree.actor;return!e||e.isDead?i.Success:(new Date).getTime()-window.GGameEntry.BattleSystem.BattleData.StartTime-this.startTime>this.timeInterval?i.Success:i.Running}}),cc._RF.pop()},{BevAction:"BevAction",TaskStatus:"TaskStatus"}],A_MoveToAreaWithTargetIn:[function(e,t,n){"use strict";cc._RF.push(t,"a2348DzxbZB+qeG9CZOab/z","A_MoveToAreaWithTargetIn");e("TaskStatus"),e("BevAction");var i=e("A_Move"),a=e("AIUtil"),o=(e("AIMapUtil"),e("Util"));e("MapCfg");cc.Class({name:"A_MoveToAreaWithTargetIn",extends:i,properties:{areaRadius:{default:2,type:cc.Integer}},findDestination:function(){o.BeginSample("A_MoveToAreaWithTargetIn::findDestination");var e=this.bevTree.actor;if(null==e.targetGuid)return null;var t=a.FindTargetObj(a.GetEnemyCamp(e.EntityCampType),e.targetGuid);if(null==t)return null;if(a.CanDirectAttack_Pixel(e.GetPixelPos(),e.GetShootDistancePixel(),t.GetPixelPos()))return null;for(var n=t.GetSmallGridPos(),i=[],r=1;r<=this.areaRadius;++r)this.CanHoldTank(n.x-r,n.y)&&i.push(cc.v2(n.x-r,n.y)),this.CanHoldTank(n.x,n.y+r)&&i.push(cc.v2(n.x,n.y+r)),this.CanHoldTank(n.x+r,n.y)&&i.push(cc.v2(n.x+r,n.y)),this.CanHoldTank(n.x,n.y-r)&&i.push(cc.v2(n.x,n.y-r));return 0==i.length?null:i[Math.floor(Math.random()*i.length)]}}),cc._RF.pop()},{AIMapUtil:"AIMapUtil",AIUtil:"AIUtil",A_Move:"A_Move",BevAction:"BevAction",MapCfg:"MapCfg",TaskStatus:"TaskStatus",Util:"Util"}],A_MoveToCampConfigPos:[function(e,t,n){"use strict";cc._RF.push(t,"0226cvb/+hCbogpv0Ci3XW5","A_MoveToCampConfigPos");e("TaskStatus"),e("BevAction");var i=e("A_Move"),a=(e("EntityTypeDefine"),e("AIMapUtil")),o=e("AIUtil"),r=e("Util"),s=e("AIEnumDef");cc.Class({name:"A_MoveToCampConfigPos",extends:i,properties:{camp_select:{default:s.Camp_Select.My,type:s.Camp_Select},grids_select:{default:s.CampGridsType.idiotRadomMoveGrids,type:s.CampGridsType}},findDestination:function(){if(r.BeginSample("A_MoveToCampConfigPos::findDestination"),!this.bevTree.actor)return null;var e=this.bevTree.actor.GetCamp();this.camp_select==s.Camp_Select.Enemy&&(e=o.GetEnemyCamp(this.bevTree.actor.GetCamp()));var t=a.GetCampConfig(e),n=null;return this.grids_select==s.CampGridsType.basePos&&t.basePos.length>0?n=t.basePos[Math.floor(Math.random()*t.basePos.length)]:this.grids_select==s.CampGridsType.firstDefendGrids&&t.firstDefendGrids.length>0?n=t.firstDefendGrids[Math.floor(Math.random()*t.firstDefendGrids.length)]:this.grids_select==s.CampGridsType.secondDefendGrids&&t.secondDefendGrids.length>0?n=t.secondDefendGrids[Math.floor(Math.random()*t.secondDefendGrids.length)]:this.grids_select==s.CampGridsType.steelDefendGrids&&t.steelDefendGrids.length>0?n=t.steelDefendGrids[Math.floor(Math.random()*t.steelDefendGrids.length)]:this.grids_select==s.CampGridsType.idiotRadomMoveGrids&&t.idiotRadomMoveGrids.length>0&&(n=t.idiotRadomMoveGrids[Math.floor(Math.random()*t.idiotRadomMoveGrids.length)]),r.AssertCheck(null!=n,"移动目标的配置点未指定或者配置点为空, grids="+this.grids_select),n?(r.EndSample("A_MoveToCampConfigPos::findDestination"),a.BigGrid2Grid(cc.v2(n[0],n[1]))):null}}),cc._RF.pop()},{AIEnumDef:"AIEnumDef",AIMapUtil:"AIMapUtil",AIUtil:"AIUtil",A_Move:"A_Move",BevAction:"BevAction",EntityTypeDefine:"EntityTypeDefine",TaskStatus:"TaskStatus",Util:"Util"}],A_MoveToEnemyBase:[function(e,t,n){"use strict";cc._RF.push(t,"95c1akNWMdAMrepZxnzb+Qf","A_MoveToEnemyBase");e("TaskStatus"),e("BevAction"),e("AiInterface");var i=e("AIMapUtil"),a=(e("EntityTypeDefine"),e("AIUtil"),e("A_Move")),o=e("Util");cc.Class({extends:a,name:"A_MoveToEnemyBase",findDestination:function(){if(o.BeginSample("A_MoveToEnemyBase::findDestination"),!this.bevTree.actor)return null;var e=null,t=i.GetLineConfig(this.bevTree.actor.GetCamp(),this.bevTree.actor.GetLine());return t&&t.GotoEnemyBase.length>0&&(e=t.GotoEnemyBase[Math.floor(Math.random()*t.GotoEnemyBase.length)]),o.AssertCheck(null!=e,"基地的目标移动配置点未设定"),e?(o.EndSample("A_MoveToEnemyBase::findDestination"),i.BigGrid2Grid(cc.v2(e[0],e[1]))):null}}),cc._RF.pop()},{AIMapUtil:"AIMapUtil",AIUtil:"AIUtil",A_Move:"A_Move",AiInterface:"AiInterface",BevAction:"BevAction",EntityTypeDefine:"EntityTypeDefine",TaskStatus:"TaskStatus",Util:"Util"}],A_MoveToInput:[function(e,t,n){"use strict";cc._RF.push(t,"3ce45taCXVK1aQHnoC52a0H","A_MoveToInput");e("TaskStatus"),e("BevAction");var i=e("A_Move"),a=(e("EntityTypeDefine"),e("AIMapUtil"));e("Util");cc.Class({name:"A_MoveToInput",extends:i,properties:{BigGrid_X:{default:0,type:cc.Integer},BigGrid_Y:{default:0,type:cc.Integer}},findDestination:function(){return a.BigGrid2Grid(cc.v2(BigGrid_X,BigGrid_Y))}}),cc._RF.pop()},{AIMapUtil:"AIMapUtil",A_Move:"A_Move",BevAction:"BevAction",EntityTypeDefine:"EntityTypeDefine",TaskStatus:"TaskStatus",Util:"Util"}],A_MoveToItem:[function(e,t,n){"use strict";cc._RF.push(t,"07165GEy7RM0oQILXLi0t1y","A_MoveToItem");e("TaskStatus"),e("BevAction");var i=e("A_Move");e("EntityTypeDefine"),e("AIMapUtil"),e("Util");cc.Class({name:"A_MoveToItem",extends:i,findDestination:function(){return this.bevTree.sharedVars.itemPos?this.bevTree.sharedVars.itemPos:null},OnEnd:function(){this.bevTree.sharedVars.itemPos=null}}),cc._RF.pop()},{AIMapUtil:"AIMapUtil",A_Move:"A_Move",BevAction:"BevAction",EntityTypeDefine:"EntityTypeDefine",TaskStatus:"TaskStatus",Util:"Util"}],A_MoveToLineConfigPos:[function(e,t,n){"use strict";cc._RF.push(t,"76ba10KfXJHmrqfR7gtZQty","A_MoveToLineConfigPos");e("TaskStatus"),e("BevAction");var i=e("A_Move"),a=e("EntityTypeDefine"),o=e("AIMapUtil"),r=e("AIUtil"),s=e("Util"),l=e("AIEnumDef");cc.Class({name:"A_MoveToLineConfigPos",extends:i,properties:{camp_select:{default:l.Camp_Select.My,type:l.Camp_Select},line_select:{default:a.EntityLineType.None,type:a.EntityLineType},grids_select:{default:l.LineGridsType.FirstOffenceGrids,type:l.LineGridsType}},findDestination:function(){if(s.BeginSample("A_MoveToLineConfigPos::findDestination"),!this.bevTree.actor)return null;var e=this.bevTree.actor.GetCamp();this.camp_select==l.Camp_Select.Enemy&&(e=r.GetEnemyCamp(this.bevTree.actor.GetCamp()));var t=this.bevTree.actor.GetLine();this.line_select!=a.EntityLineType.None&&(t=this.line_select);var n=o.GetLineConfig(e,t),i=null;return this.grids_select==l.LineGridsType.FirstOffenceGrids&&n.FirstOffenceGrids.length>0?i=n.FirstOffenceGrids[Math.floor(Math.random()*n.FirstOffenceGrids.length)]:this.grids_select==l.LineGridsType.SecondOffenceGrids&&n.SecondOffenceGrids.length>0?i=n.SecondOffenceGrids[Math.floor(Math.random()*n.SecondOffenceGrids.length)]:this.grids_select==l.LineGridsType.GotoEnemyBase&&n.GotoEnemyBase.length>0?i=n.GotoEnemyBase[Math.floor(Math.random()*n.GotoEnemyBase.length)]:this.grids_select==l.LineGridsType.DefenceGrids&&n.DefenceGrids.length>0&&(i=n.DefenceGrids[Math.floor(Math.random()*n.DefenceGrids.length)]),s.AssertCheck(null!=i,"线路的移动目标配置点未设定, line="+this.line_select+", grids="+this.grids_select),i?(s.EndSample("A_MoveToLineConfigPos::findDestination"),o.BigGrid2Grid(cc.v2(i[0],i[1]))):null}}),cc._RF.pop()},{AIEnumDef:"AIEnumDef",AIMapUtil:"AIMapUtil",AIUtil:"AIUtil",A_Move:"A_Move",BevAction:"BevAction",EntityTypeDefine:"EntityTypeDefine",TaskStatus:"TaskStatus",Util:"Util"}],A_MoveToRandPos:[function(e,t,n){"use strict";cc._RF.push(t,"24b7dq+1xdIJaXjDhcVPXg3","A_MoveToRandPos");e("TaskStatus"),e("BevAction");var i=e("A_Move");e("EntityTypeDefine"),e("AIMapUtil"),e("Util");cc.Class({name:"A_MoveToRandPos",extends:i,properties:{min_radius_smallgrid:{default:2,type:cc.Integer},max_radius_smallgrid:{default:6,type:cc.Integer}},findDestination:function(){if(!this.bevTree.sharedVars.actor)return null;for(var e=this.bevTree.sharedVars.actor.GetSmallGridPos(),t=[],n=this.min_radius_smallgrid;n<=this.max_radius_smallgrid;++n)this.CanHoldTank(e.x-n,e.y)&&t.push(cc.v2(e.x-n,e.y)),this.CanHoldTank(e.x,e.y+n)&&t.push(cc.v2(e.x,e.y+n)),this.CanHoldTank(e.x+n,e.y)&&t.push(cc.v2(e.x+n,e.y)),this.CanHoldTank(e.x,e.y-n)&&t.push(cc.v2(e.x,e.y-n));return 0==t.length?null:t[Math.floor(Math.random()*t.length)]}}),cc._RF.pop()},{AIMapUtil:"AIMapUtil",A_Move:"A_Move",BevAction:"BevAction",EntityTypeDefine:"EntityTypeDefine",TaskStatus:"TaskStatus",Util:"Util"}],A_Move:[function(e,t,n){"use strict";cc._RF.push(t,"c2808TB7KpCUYPjTQ/xkRjI","A_Move");var i=e("TaskStatus"),a=e("BevAction"),o=e("AiInterface");cc.Class({name:"A_Move",extends:a,destination:null,startMoveTimeMS:0,lastRunningCheckTime:0,lastRunningCheckPos:null,properties:{runningReachDest:{default:!1,type:cc.Boolean},minRunningTimeMS:{default:1e3,type:cc.Integer},runningCheckMS:{default:0,type:cc.Integer},runningCheckPixel:{default:0,type:cc.Integer}},OnStart:function(){this.destination=null,this.startMoveTimeMS=0},OnExcute:function(){var e=this.bevTree.actor;if(!e||e.isDead)return i.Success;if(null==this.destination){var t=this.findDestination();return t?(this.lastRunningCheckTime=Date.now(),this.lastRunningCheckPos=this.bevTree.actor.node.position,this.bevTree.sharedVars.lastTargetPos=null,o.SendMoveMsg(this.bevTree.actor,t),this.minRunningTimeMS>0||this.runningReachDest?(this.destination=t,this.startMoveTimeMS=Date.now(),i.Running):i.Success):i.Failure}if(this.runningCheckMS>0&&this.runningCheckPixel>0&&Date.now()-this.lastRunningCheckTime>this.runningCheckMS){if(this.lastRunningCheckPos.sub(this.bevTree.actor.node.position).magSqr()<this.runningCheckPixel*this.runningCheckPixel)return i.Success;this.lastRunningCheckTime=Date.now(),this.lastRunningCheckPos=this.bevTree.actor.node.position}if(this.runningReachDest||this.minRunningTimeMS>0){var n=e.GetSmallGridPos();if(this.destination.sub(n).magSqr()<=2)return i.Success;if(this.minRunningTimeMS>0&&Date.now()-this.startMoveTimeMS>this.minRunningTimeMS)return i.Success}return i.Running},findDestination:function(){return this.bevTree.actor.GetSmallGridPos()},CanHoldTank:function(e,t){return!!window.GGameEntry.MapManager.GridCanWalk(e-1,t)&&(!!window.GGameEntry.MapManager.GridCanWalk(e,t)&&(!!window.GGameEntry.MapManager.GridCanWalk(e-1,t-1)&&!!window.GGameEntry.MapManager.GridCanWalk(e,t-1)))}}),cc._RF.pop()},{AiInterface:"AiInterface",BevAction:"BevAction",TaskStatus:"TaskStatus"}],A_SetAttackTarget:[function(e,t,n){"use strict";cc._RF.push(t,"b8361SooF9LK7G25yIU67hA","A_SetAttackTarget");var i=e("TaskStatus"),a=e("BevAction");cc.Class({name:"A_SetAttackTarget",extends:a,OnExcute:function(){return this.bevTree.actor?(AiInterface.SendSkillMsg(this.bevTree.actor),i.Success):i.Failure}}),cc._RF.pop()},{BevAction:"BevAction",TaskStatus:"TaskStatus"}],A_SetUserVar:[function(e,t,n){"use strict";cc._RF.push(t,"cc8eeRS+b5EC6oBTzgO9541","A_SetUserVar");var i=e("TaskStatus"),a=e("BevAction");cc.Class({name:"A_SetUserVar",extends:a,properties:{varName:{default:"",type:cc.String},value:{default:0,type:cc.Integer}},OnExcute:function(){return null!=this.varName&&(this.bevTree.sharedVars.userVars[this.varName]=this.value),i.Success}}),cc._RF.pop()},{BevAction:"BevAction",TaskStatus:"TaskStatus"}],AbortType:[function(e,t,n){"use strict";cc._RF.push(t,"47a68wogltOTYvvxgRYcUes","AbortType");var i=cc.Enum({None:0,Down:1,Right:2,Both:3});t.exports=i,cc._RF.pop()},{}],ActiveDelay:[function(e,t,n){"use strict";cc._RF.push(t,"58d95nIZ4hBNZUKutIBxRNJ","ActiveDelay");cc.Class({extends:cc.Component,properties:{Time:0,Target:{default:null,type:cc.Node},Active:!0},onLoad:function(){this.node.runAction(cc.sequence(cc.delayTime(this.Time),cc.callFunc(this.onDo,this)))},onDisable:function(){this.node.stopAllActions()},onDo:function(){this.Target&&(this.Target.active=this.Active)}}),cc._RF.pop()},{}],ActivityItem:[function(e,t,n){"use strict";cc._RF.push(t,"ef6bfR9vVJPjJxE2jvuCYsO","ActivityItem");var i=e("loginComNotifyMsg"),a=e("loginServerMgr"),o=e("weixinmsgmgr"),r=e("GameMode"),s=e("EnterStateMgr"),l=e("PlatformUtil"),c=e("ActivityMsgMgr"),u=e("UIManager");cc.Class({extends:cc.Component,properties:{image:{default:null,type:cc.Sprite},nameImage:{default:null,type:cc.Sprite},modelName:{default:null,type:cc.Label},model:{default:null,type:cc.Label},detail:{default:null,type:cc.Label},lockState:{default:null,type:cc.Node},openState:{default:null,type:cc.Node},subMenu:{default:null,type:cc.Node},config:null,activityUI:null,auto:!1,map:null,colorNormal:{default:null,type:cc.Color},colorLock:{default:null,type:cc.Color},nodesColor:{default:[],type:cc.Node}},onLoad:function(){},onEnable:function(){window.GGameEntry.NotificationCenter.on("LoginSuccessEvent",this.LoginSuccessEvent,this),window.GGameEntry.NotificationCenter.on("OnReceivePlayerRole",this.OnReceivePlayerRole,this)},onDisable:function(){window.GGameEntry.NotificationCenter.off("LoginSuccessEvent",this.LoginSuccessEvent,this),window.GGameEntry.NotificationCenter.off("OnReceivePlayerRole",this.OnReceivePlayerRole,this)},LoginSuccessEvent:function(e){i.LoginSuccessEvent(e)},OnReceivePlayerRole:function(e){o.onHideLoadingState(),window.GGameEntry.UIManager.HideUI(u.UIType.ActivityUI),i.OnReceivePlayerRole(e)},onClickItem:function(){this.config&&(this.config.isOpen?this.auto?(this.activityUI.ResetAllChildToNormal(),this.subMenu.active=!0):this.onClickCreate():(window.GGameEntry.UIManager.ShowMsgBox(this.config.activity.CloseDesc),cc.log(this.config.activity.CloseDesc)))},setValue:function(e,t,n,i){if(e&&(this.activityUI=e),t&&(this.config=t),n&&(this.auto=n),i&&(this.map=i),t){if(this.detail.string=t.activity.Desc,t.isOpen){this.lockState.active=!1,this.openState.active=!0;for(a=0;a<this.nodesColor.length;a++)(o=this.nodesColor[a]).color=this.colorNormal}else{this.lockState.active=!0,this.openState.active=!1;for(var a=0;a<this.nodesColor.length;a++){var o=this.nodesColor[a];o.color=this.colorLock}}var r=t.activity.PicUrl;this.image.spriteFrame=this.map[r];var s=t.activity.NameUrl;this.nameImage.spriteFrame=this.map[s]}this.subMenu.active=!1},SetNormalState:function(){this.setValue()},onClickEnter:function(){if(cc.log("onClickEnter ID:"+this.config.activity.ID),window.GGameEntry.IsNetAvailable){o.onShowLoadingState("connecting...",1e4,"链接失败，请检查当前网络是否畅通。",this.OnConnectError,0),this.subMenu.active=!1,c.setActivityType(this.config.activity.ID),l.setBtnCheckEnter(1),s.setEnterState(s.globalEnterStateFlag.EnterState_AutoActivity),r.SetGameMode(r.GM.GameMode_PVPPlayer);var e=o.getUserInfo();null!==e?a.onSendUserInfo(e):a.onSendUserInfo(2)}else window.GGameEntry.UIManager.ShowMsgBox("没有可用网络，请检查当前网络是否畅通。")},onConnectError:function(e){return!0},onClickCreate:function(){if(cc.log("onClickCreate ID:"+this.config.activity.ID),window.GGameEntry.IsNetAvailable){o.onShowLoadingState("connecting...",1e4,"链接失败，请检查当前网络是否畅通。",this.OnConnectError,0),this.subMenu.active=!1,c.setActivityType(this.config.activity.ID),l.setBtnCheckEnter(1),s.setEnterState(s.globalEnterStateFlag.EnterState_Activity),r.SetGameMode(r.GM.GameMode_PVPPlayer);var e=o.getUserInfo();null!==e?a.onSendUserInfo(e):a.onSendUserInfo(2)}else window.GGameEntry.UIManager.ShowMsgBox("没有可用网络，请检查当前网络是否畅通。")}}),cc._RF.pop()},{ActivityMsgMgr:"ActivityMsgMgr",EnterStateMgr:"EnterStateMgr",GameMode:"GameMode",PlatformUtil:"PlatformUtil",UIManager:"UIManager",loginComNotifyMsg:"loginComNotifyMsg",loginServerMgr:"loginServerMgr",weixinmsgmgr:"weixinmsgmgr"}],ActivityMsgMgr:[function(e,t,n){"use strict";function i(){return g}function a(){p=[]}function o(e){return window.GGameEntry.ResTableMgr.GetConfigByID(y.star_game_model_cs,e)}function r(){return o(i())}function s(e){console.log("ActivityMsgMrg onReadActivityConfig"),a();var t=e.Num,n=e.List;if(t>0)for(var i=window.GGameEntry.ResTableMgr.GetTableByName(y.star_game_model_cs),o=i.length,r=0;r<t;++r){for(var s=0;s<o;++s)if(n[r].ID===parseInt(i[s].ID)){var l=new Object;l.activity=i[s],l.isOpen=0!==n[r].Open,p.push(l);break}s===o&&console.error("ActivityMsgMrg onReadActivityConfig not found.ID="+n[r].ID)}}function l(e){console.log("ActivityMsgMrg onRecvActivityMsgCallback:");var t=h.SafeParse(e);if(void 0!==t&&0!==t.E){if(t.C===d.CS_CMD_TYPE.CS_CMD_GET_WX_SESSION_INFO){var n=window.GGameEntry.ResTableMgr.GetConfigByID(y.star_client_c,63).Context,i=window.GGameEntry.StringFormat(n,t.E);return void window.GGameEntry.UIManager.ReturnLogoUI(i)}if(t.E===u.RET_CODE.RET_CODE_LOGIN_BAN_ON_SVR_AUTH){var n=window.GGameEntry.ResTableMgr.GetConfigByID(y.star_client_c,19).Context,i=window.GGameEntry.StringFormat(n,t.E);return void window.GGameEntry.UIManager.ShowMsgBox(i)}}0===t.E?t.C===d.CS_CMD_TYPE.CS_SUB_BATTLE_ACTIVITY_GAME_NOTIFY&&(s(t.SD.ActivityGame),window.GGameEntry.NotificationCenter.emit("onReceiveActivityMsgNotify")):f.onActivityServerErrorMsg(e)}cc._RF.push(t,"0269d6Yr9ZPJqQM74v1zhhg","ActivityMsgMgr");var c=e("NetworkProto"),u=(e("UIManager"),e("star_macro")),d=e("star_cs"),h=e("JsonUtils"),f=e("ServerMsgError"),m=e("loginConfig"),y=e("ResTableNames"),p=[],g=d.ROOM_TYPE.ROOM_COMMON;t.exports={setActivityType:function(e){g=e},getActivityType:i,clearActivityList:a,getActivityList:function(){return p},getActivityListCount:function(){return p.length},onRequestActiviryInfo:function(){console.log("ActivityMsgMrg onRequestActiviryInfo");var e=c.GetRequestByID(d.CS_CMD_TYPE.CS_SUB_BATTLE_ACTIVITY_GAME_NOTIFY),t=m.getShortSocketURL();c.PushGameSvrMsg(t,0,e,l)},getActivity:o,getCurModeInfo:r,isActivityMode:function(e){var t=r();return!!t&&parseInt(t.ID)===e}},cc._RF.pop()},{JsonUtils:"JsonUtils",NetworkProto:"NetworkProto",ResTableNames:"ResTableNames",ServerMsgError:"ServerMsgError",UIManager:"UIManager",loginConfig:"loginConfig",star_cs:"star_cs",star_macro:"star_macro"}],ActivityUI:[function(e,t,n){"use strict";cc._RF.push(t,"5e4fbbiCSdKBr4u8FhaOpUl","ActivityUI");var i=e("UIManager"),a=e("ActivityItem"),o=e("ActivityMsgMgr"),r=e("EnterStateMgr"),s=(e("TipsMsgBox"),e("PlatformUtil")),l=[],c={},u=new cc.EventTarget;cc.Class({extends:cc.Component,properties:{itemPrefab:{default:null,type:cc.Node},itemRoot:{default:null,type:cc.Node},spriteFrames:{default:[],type:cc.SpriteFrame},scrollView:{default:null,type:cc.ScrollView},Widget:{default:null,type:cc.Widget},texCoordOffset:1},fitiPhoneXScreen:function(){s.isTargetDevice("iPhone X")&&this.Widget&&(this.Widget.left=60,this.Widget.right=60,this.Widget.updateAlignment())},onLoad:function(){this.fitiPhoneXScreen(),u.on("loadFinish",this.SetupUI,this),cc.loader.loadResDir("Atlas/ActivityPic",cc.SpriteFrame,function(e,t){if(e)cc.error(e.message||e);else{for(var n=0;n<t.length;n++){var i=t[n];c[i.name]=i}u.emit("loadFinish")}})},SetupUI:function(){for(var e=r.getEnterStateShowAutoPVP(),t=o.getActivityList(),n=(t.sort(function(e,t){var n=e.activity.Weight;return t.activity.Weight-n}),0);n<t.length;n++){var i=t[n];if(0!==i.activity.IsDisplay){var s=cc.instantiate(this.itemPrefab);s.parent=this.itemRoot,s.setPositionY(0),s.active=!0;var u=s.getComponent(a);u.setValue(this,i,e,c),l.push(u)}}t.length<=3?(this.scrollView.enabled=!1,this.itemRoot.anchorX=.5,this.itemRoot.x=0):(this.scrollView.enabled=!0,this.itemRoot.anchorX=0)},init:function(){for(var e=0;e<this.spriteFrames.length;e++){var t=this.spriteFrames[e],n=t.getRect();n.x=n.x+this.texCoordOffset,n.width=n.width-2*this.texCoordOffset,t.setRect(n)}},onEnable:function(){this.ResetAllChildToNormal()},onBtnReturn:function(){window.GGameEntry.UIManager.HideUI(i.UIType.ActivityUI),window.GGameEntry.UIManager.ShowUI(i.UIType.LogoUI)},ResetAllChildToNormal:function(){for(var e=0;e<l.length;e++)l[e].SetNormalState()}}),cc._RF.pop()},{ActivityItem:"ActivityItem",ActivityMsgMgr:"ActivityMsgMgr",EnterStateMgr:"EnterStateMgr",PlatformUtil:"PlatformUtil",TipsMsgBox:"TipsMsgBox",UIManager:"UIManager"}],AiInterface:[function(e,t,n){"use strict";cc._RF.push(t,"73ca1Jd1Y5G548k/8mD08x+","AiInterface");var i=e("CmdMove"),a=e("CmdSkill"),o=e("CmdForward"),r=e("SkillDefine");cc.Class({statics:{SendMoveMsg:function(e,t){if(e){var n=new i;n.Init(e.GetGuid(),t),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(n)}},SendMoveStopMsg:function(e){if(e){var t=new i;t.Init(e.GetGuid(),cc.v2(-1,-1)),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(t)}},SendSkillMsg:function(e){if(e){var t=new a;t.Init(r.SkillType.SkillType_NormalAttack,e.GetGuid(),0),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(t)}},SendUseItemlMsg:function(e){if(e){var t=new a;t.Init(r.SkillType.SkillType_PickBuffItem,e.GetGuid(),0),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(t)}},SendForwardMsg:function(e,t){if(e){var n=new o;n.Init(e.GetGuid(),t),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(n)}}}}),cc._RF.pop()},{CmdForward:"CmdForward",CmdMove:"CmdMove",CmdSkill:"CmdSkill",SkillDefine:"SkillDefine"}],AirDropBox:[function(e,t,n){"use strict";cc._RF.push(t,"bed2a3yMnxLbbRf1xQnc9+P","AirDropBox");var i=e("Util"),a=e("MapItemBase"),o=(e("AnimationManager"),e("NetworkProto")),r=e("star_cs"),s=e("ResTableNames"),l=e("GlobalCfg"),c=e("EntityTypeDefine"),u=cc.Enum({AIRDROPSTATE_WARNING:1,AIRDROPSTATE_DROP:2,AIRDROPSTATE_GROUND:3});cc.Class({extends:a,properties:{TargetX:{default:0},TargetY:{default:0},NeedTime:{default:0},SelectItemId:{default:0},LeftHPnode:{default:null,type:cc.Node},HPnode:{default:null,type:cc.Node},SpriteBox:{default:null,type:cc.Sprite}},onLoad:function(){},Init:function(){this._super(),this.node.isStatic=!1,this.NeedTime=99999,this.boxState=u.AIRDROPSTATE_WARNING,this.EntityType=c.EntityType.EntityAirDropBox,this.DropStartTime=-parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(s.star_global_cs,25).Value)/1e3,this.DropEndTime=-parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(s.star_global_cs,26).Value)/1e3,window.GGameEntry.MapManager.AddStaticEntity(this,parseInt(this.TargetX/100),parseInt(this.TargetY/100));var e=window.GGameEntry.ResTableMgr.GetConfigByID(s.star_chest_cs,this.Configid);if(e||i.AssertCheck(!1,"空投箱子没找到 id："+this.Configid),this.SpriteBox&&(this.HP=parseInt(e.HP),this.SpriteBox.spriteFrame=this.SpAtlas.getSpriteFrame(e.Resource),window.GGameEntry.CurGamePlayType!==l.GamePlayType.GamePlayType_Network)){for(var t=0,n=0;n<e.ChestItems.length;n++){r=e.ChestItems[n];(d=parseInt(r.Weight))&&(t+=d)}for(var a=parseInt(Math.random()*t),o=0;o<e.ChestItems.length;o++){var r=e.ChestItems[o],d=parseInt(r.Weight);if(d&&d>=a){this.SelectItemId=parseInt(r.ItemID);break}}}},Reset:function(){this._super(),this.node.visible=!0},OnSetHp:function(e){this.Hp=e,this.LeftHPnode.scaleX=this.Hp/100},HitByBullet:function(e){this.DeadAni||this.HP&&(this.HP-=e,this.OnSetHp(this.HP),this.HP<=0&&this.OnDie())},ReInitOver:function(){this._super()},isCanHit:function(){return this.boxState!==u.AIRDROPSTATE_GROUND},updateTime:function(e){if(!this.DeadAni)return this.NeedTime=this.NeedTime-e,this.NeedTime<=0&&this.boxState===u.AIRDROPSTATE_WARNING?(this.boxState=u.AIRDROPSTATE_DROP,this.node.x=this.TargetX,this.node.y=this.TargetY,this.HPnode.scale=1,this.DropAnimation=this.node.getComponent(cc.Animation),this.DropAnimation&&this.DropAnimation.play(),this.scheduleOnce(function(){window.GGameEntry.SoundManager.PlayDropItem()},1),!0):(this.boxState===u.AIRDROPSTATE_DROP&&(this.CollisionWithPlayerTank(),this.NeedTime<this.DropEndTime&&(this.boxState=u.AIRDROPSTATE_GROUND)),!1)},CollisionWithPlayerTank:function(){if(this.boxState===u.AIRDROPSTATE_DROP){if(this.NeedTime>this.DropStartTime)return;var e=[];e[e.length]=window.GGameEntry.PlayerManager.Player;for(var t in window.GGameEntry.MonsterManager.monsterMap)e[e.length]=window.GGameEntry.MonsterManager.monsterMap[t];for(var n=0;n<e.length;n++){var i=e[n];if(i.MyCollider.world&&this.MyCollider.world){var a=i.MyCollider.world.aabb.clone(),s=this.MyCollider.world.aabb.clone();if(a.x=i.node.x-a.width/2,a.y=i.node.y-a.height/2,s.x=this.node.x-s.width/2,s.y=this.node.y-s.height/2,a.intersects(s))if(window.GGameEntry.CurGamePlayType!==l.GamePlayType.GamePlayType_Network)i.OnDie();else{var c=o.GetRequestByID(r.CS_CMD_TYPE.CS_SUB_BATTLE_BOX_HIT);c.BoxID=this.GetGuid(),c.TargetID=i.GetGuid(),o.SendBattleSvrRequest(0,c)}}}}},CollisionWithTank:function(e,t){if(this.boxState===u.AIRDROPSTATE_DROP&&this.NeedTime>this.DropStartTime)return!1;if(e.MyCollider&&this.MyCollider&&e.MyCollider.world&&this.MyCollider.world&&e.MyCollider.world.aabb&&this.MyCollider.world.aabb){var n=e.MyCollider.world.aabb.clone(),i=this.MyCollider.world.aabb.clone();if(n.x=t.x-n.width/2,n.y=t.y-n.height/2,i.x=this.node.x-i.width/2,i.y=this.node.y-i.height/2,n.intersects(i))return!0}return!1},OnDie:function(){this.DeadAni||(window.GGameEntry.CurGamePlayType!==l.GamePlayType.GamePlayType_Network&&window.GGameEntry.ItemManager.CreateItemAddEnity(this.SelectItemId,this.TargetX,this.TargetY),window.GGameEntry.MapManager.RemoveStaticEntity(this),window.GGameEntry.SoundManager.PlayHitBlock(this.node.position),this._super(),this.DeadAni=!0)},_DoDieAction:function(){this.node.setPosition(cc.p(1e6,1e6))}}),cc._RF.pop()},{AnimationManager:"AnimationManager",EntityTypeDefine:"EntityTypeDefine",GlobalCfg:"GlobalCfg",MapItemBase:"MapItemBase",NetworkProto:"NetworkProto",ResTableNames:"ResTableNames",Util:"Util",star_cs:"star_cs"}],AirDropSystem:[function(e,t,n){"use strict";cc._RF.push(t,"0683fNLnFxIkphQoyZILWcn","AirDropSystem");var i=e("EntityTypeDefine"),a=e("Util"),o=(e("assert"),e("GlobalCfg")),r=e("ResTableNames"),s=(e("BulletTypeDefine"),e("AirDropBox"),e("star_cs"),e("UIManager")),r=e("ResTableNames");cc.Class({extends:cc.Component,properties:{PlanePrefab:{default:null,type:cc.Prefab},PlanePrefabName:"",AirDropItemPrefab:{default:null,type:cc.Prefab},FlySpeed:{default:0},AirDropState:{default:0},StartPlanePos:{default:0},EndPlanePos:{default:0},CountIndex:{default:0},MapAirDropPlayer:{default:null,type:cc.Node},MapSkyPlayer:{default:null,type:cc.Node},hasRecMsg:{default:!1},perAirDropCount:{default:2},dTime:{default:0}},onLoad:function(){},Init:function(){this.InitPlane(),this.InitAirBox(),window.GGameEntry.NotificationCenter.on("OnOfflineDropItem10",this.OnOfflineDropItem10,this)},InitPlane:function(){var e=window.GGameEntry.ResManager.GetResPrefab(this.PlanePrefabName);e&&(this.Plane=cc.instantiate(e),this.Plane.x=1e4,this.Plane.y=1e4,this.MapSkyPlayer.addChild(this.Plane))},InitAirBox:function(){var e=10,t=window.GGameEntry.ResTableMgr.GetTableByName(r.star_item_buffer_c);if(t&&t.length>0)for(var n=0;n<t.length;n++){var o=t[n];if(!o)return cc.error("Item not found"),null;var s=window.GGameEntry.BattleSystem.MapID;if(s){var l=a.TableStr2Num(o.Map);if(l&&s!==l)continue}var c=a.TableStr2Num(o.Type),u=o.DataList.split(" ");c===i.CacheConfigType.CacheConfigType_AirDrop&&(e=a.TableStr2Num(u[1]))}for(var d=0;d<e;d++){var h=window.GGameEntry.ResManager.GetResPrefab("./Prefabs/Effect/xiangzi_H"),f=cc.instantiate(h);if(f){var m=f.getComponent("AirDropBox");m.node.x=-1e4,m.node.y=-1e4,this.MapAirDropPlayer.addChild(f),this.AirDropPrefabArray||(this.AirDropPrefabArray=[]),this.AirDropPrefabArray[this.AirDropPrefabArray.length]=f}else a.AssertCheck(!1,"箱子无法创建 name:"+h)}},OnOfflineDropItem10:function(e){window.GGameEntry.CurGamePlayType!==o.GamePlayType.GamePlayType_Network&&this.InitWithClientData(e.detail)},update:function(e){this.CheckOnBoxPos(e),this.hasRecMsg&&(this.hasRecMsg=!1,this.StartPlaneFly())},StartPlaneFly:function(){if(this.Plane)if(window.GGameEntry.SoundManager.PlayPlane(),this.AirDropBoxArray.length<this.perAirDropCount)a.AssertCheck(!1,"空投箱子数目不对。 数目：:"+this.AirDropBoxArray.length);else{var e=this.AirDropBoxArray[this.AirDropBoxArray.length-this.perAirDropCount].getComponent("AirDropBox"),t=this.AirDropBoxArray[this.AirDropBoxArray.length-this.perAirDropCount+1].getComponent("AirDropBox"),n=cc.v2(t.TargetX-e.TargetX,t.TargetY-e.TargetY);t.TargetX===e.TargetX&&t.TargetY===e.TargetY&&a.AssertCheck(!1,"飞机航线坐标点重合 x："+t.TargetX+" y："+t.TargetY),n.normalizeSelf();var i=cc.v2(e.TargetX,e.TargetY),o=cc.v2(t.TargetX,t.TargetY);this.StartPlanePos=i.clone(),this.StartPlanePos.addSelf(cc.v2(2e3*-n.x,2e3*-n.y)),this.FlySpeed=parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(r.star_global_cs,19).Value),this.EndPlanePos=o.clone(),this.EndPlanePos.addSelf(cc.v2(3e3*n.x,3e3*n.y)),this.Plane.x=this.StartPlanePos.x,this.Plane.y=this.StartPlanePos.y;var s=Math.atan2(n.y,n.x)*(180/Math.PI)-90;this.Plane.rotation=-s;var l=this.EndPlanePos.sub(this.StartPlanePos).mag()/this.FlySpeed,c=cc.moveTo(l,this.EndPlanePos);this.Plane.runAction(c);for(var u=0,d=this.AirDropBoxArray.length-this.perAirDropCount;d<this.AirDropBoxArray.length;d++){var h=this.AirDropBoxArray[d].getComponent("AirDropBox");u=cc.v2(h.TargetX,h.TargetY).sub(this.StartPlanePos).mag()/this.FlySpeed,h.NeedTime=u+1}}},IsCollisionWithTank:function(e,t){if(this.AirDropBoxArray)for(var n=0;n<this.AirDropBoxArray.length;n++){var i=this.AirDropBoxArray[n].getComponent("AirDropBox");if(i&&!i.DeadAni&&i.CollisionWithTank(e,t))return!0}return!1},CheckOnBoxPos:function(e){if(this.AirDropBoxArray)for(var t=0;t<this.AirDropBoxArray.length;t++){var n=this.AirDropBoxArray[t].getComponent("AirDropBox");n&&n.updateTime(e)}},InitWithClientData:function(e){if(e){var t=window.GGameEntry.ItemManager.GetAvailablePos(e.X1,e.Y1,e.X2,e.Y2),n=this.CreateItem(e.DropItems[0].ItemID,100*t[0]+50,100*t[1]+50);if(n){if(parseInt(e.Mark)){window.GGameEntry.UIManager.ShowUI(s.UIType.ItemArriveUI);var i=window.GGameEntry.UIManager.GetActiveUI(s.UIType.ItemArriveUI);if(i){var a=i.getComponent("ItemArriveUI");if(a){var o=window.GGameEntry.ResTableMgr.GetConfigByID(r.star_client_c,1).Context;a.setString(o)}}}n.Init(),window.GGameEntry.EntityManager.AddEntity(n)}else cc.error("create item failed:",e.ResID)}},InitWithServerData:function(e,t){if(!(t<2)&&e){this.perAirDropCount=t;var n=this.CreateItem(e.ResID,e.Pos.x+50,e.Pos.y+50);if(n){if(n.Guid=e.ObjID,n.EntityCampType=e.CampID,e.Mark){window.GGameEntry.UIManager.ShowUI(s.UIType.ItemArriveUI);var i=window.GGameEntry.UIManager.GetActiveUI(s.UIType.ItemArriveUI);if(i){var a=i.getComponent("ItemArriveUI");if(a){var o=window.GGameEntry.ResTableMgr.GetConfigByID(r.star_client_c,1).Context;a.setString(o)}}}n.Init(),window.GGameEntry.EntityManager.AddEntity(n)}else cc.error("create item failed:",e.ResID)}},CreateItem:function(e,t,n){if(!(this.CountIndex>=this.AirDropPrefabArray.length)){var i=this.AirDropPrefabArray[this.CountIndex],a=i.getComponent("AirDropBox");return a.Configid=e,a.TargetX=t,a.TargetY=n,window.GGameEntry.BattleSystem.IsInvertWorld()&&(a.node.rotation+=180),this.AirDropBoxArray||(this.AirDropBoxArray=[]),this.AirDropBoxArray[this.AirDropBoxArray.length]=i,this.AirDropBoxArray.length%this.perAirDropCount==0&&(this.hasRecMsg=!0),this.CountIndex++,a}},Release:function(){this.MapAirDropPlayer.destroyAllChildren(),this.MapSkyPlayer.destroyAllChildren(),this.AirDropBoxArray=[],this.AirDropPrefabArray=[],this.CountIndex=0,this.perAirDropCount=2,this.Plane=null,window.GGameEntry.NotificationCenter.off("OnOfflineDropItem10",this.OnOfflineDropItem10,this)},Pause:function(){},Resume:function(){}}),cc._RF.pop()},{AirDropBox:"AirDropBox",BulletTypeDefine:"BulletTypeDefine",EntityTypeDefine:"EntityTypeDefine",GlobalCfg:"GlobalCfg",ResTableNames:"ResTableNames",UIManager:"UIManager",Util:"Util",assert:1,star_cs:"star_cs"}],AniAdditive:[function(e,t,n){"use strict";cc._RF.push(t,"4d18eIvKH5KepPxrpkhBULC","AniAdditive"),cc.Class({extends:cc.Component,properties:{Animation:{default:null,type:cc.Animation},AnimationClipName1:"",AnimationClipName2:"",AnimationClipName3:""},onLoad:function(){""!=this.AnimationClipName1&&this.Animation.playAdditive(this.AnimationClipName1),""!=this.AnimationClipName2&&this.Animation.playAdditive(this.AnimationClipName2),""!=this.AnimationClipName3&&this.Animation.playAdditive(this.AnimationClipName3)}}),cc._RF.pop()},{}],AniHideMe:[function(e,t,n){"use strict";cc._RF.push(t,"ea544s8q9hNxqaLOtlub0rB","AniHideMe"),cc.Class({extends:cc.Component,properties:{},HideMe:function(){this.node.active=!1}}),cc._RF.pop()},{}],AnimationManager:[function(e,t,n){"use strict";cc._RF.push(t,"e6960yUY0JFbK4JLB3qOv9/","AnimationManager");var i=e("UIManager"),a=e("Util"),o=e("PlatformUtil");cc.Class({extends:cc.Component,properties:{map:{default:null,visible:!1},CannotDisabled:{default:[],type:cc.String,displayName:"持续性特效，不可裁剪"}},onLoad:function(){this.map=new Map},release:function(){this.map&&(this.map.forEach(function(e,t,n){for(var i=0;i<e.length;i++)e[i].destroy()}),this.map.clear())},getAnimationAtPosition:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:i.UIOrder.Animation;if(a.BeginSample("AnimationManager::getAnimationAtPosition"),""!=e){if(-1==this.CannotDisabled.indexOf(e)&&null!==window.GGameEntry.PlayerManager.Player&&!window.GGameEntry.PlayerManager.Player.IsInPlayerView(n))return null;var s=this.getAnimation(e);return s&&(s.setParent(t),s.zIndex=r,s.setPosition(n),s.rotation=o,s.active=!0),a.EndSample("AnimationManager::getAnimationAtPosition"),s}},getAnimation:function(e){if(window.GGameEntry.PerformanceMgr.Config.EnableMonitor&&window.GGameEntry.PerformanceMgr.Config.DisableAnimation)return null;var t=null,n=window.GGameEntry.ResManager.GetResName(e),i=this.getAnimationList(n);if(i.length>0)t=i.pop();else{var r=this.getAnimationPrefab(e);r&&(t=cc.instantiate(r),console.error("Animation is not preload: "+n),o.IsWeichatGame()||a.AssertCheck(!1,"特效没有预加载:"+n))}return t},returnAnimation:function(e,t){var n=this.getAnimationList(e);void 0!==n&&null!==t&&(t.setPosition(1e4,1e4),t.active=!1,n.push(t))},getAnimationList:function(e){null===this.map&&(this.map=new Map);var t=this.map.get(e);return void 0===t&&(this.map.set(e,[]),t=this.map.get(e)),t},preLoadAnimation:function(){for(var e=window.GGameEntry.ResManager.ResDefKey,t=window.GGameEntry.ResManager.ResDefMap,n=0;n<e.length;n++){var i=e[n],o=a.TableStr2Num(t[i].Cnt),r=window.GGameEntry.ResManager.GetResPrefab(i);if(r)for(var s=window.GGameEntry.ResManager.GetResName(i),l=this.getAnimationList(s),c=0;c<o;c++){var u=cc.instantiate(r);l.push(u)}}},getAnimationPrefab:function(e){return window.GGameEntry.ResManager.GetResPrefab(e)}}),cc._RF.pop()},{PlatformUtil:"PlatformUtil",UIManager:"UIManager",Util:"Util"}],AutoJoinCountDownUI:[function(e,t,n){"use strict";cc._RF.push(t,"3603bM0kJlK1ZlKuHuIF/XA","AutoJoinCountDownUI");var i=e("SimpleLabel"),a=e("Util"),o=e("UIManager");cc.Class({extends:cc.Component,properties:{TimeLabel:{default:null,type:i},CountDownTimeSeconds:{default:30,type:cc.Integer}},scheduleCallback:function(){if(this.startTime<this.CountDownTimeSeconds){if(!window.GGameEntry.IsNetAvailable)return window.GGameEntry.UIManager.HideUI(o.UIType.AutoJoinCountDownUI),void this.unschedule(this.scheduleCallback);this.startTime++,this.TimeLabel.SetString(a.GetTimeFormatStr(this.startTime)),this.startTime==this.CountDownTimeSeconds&&console.error("AutoJoinCountDown End ")}else this.TimeLabel.SetString("00:00")},startMakeTeamCountDown:function(){var e=this.CountDownTimeSeconds-1;this.unschedule(this.scheduleCallback),this.TimeLabel.SetString(a.GetTimeFormatStr(this.startTime)),this.schedule(this.scheduleCallback,1,e,1)},onEnable:function(){this.startTime=0,this.startMakeTeamCountDown(),window.GGameEntry.NotificationCenter.emit("onChangeBtnState",{bShow:!1})},onDisable:function(){this.unscheduleAllCallbacks(),this.startTime=0,window.GGameEntry.NotificationCenter.emit("onChangeBtnState",{bShow:!0})},onBtnReturn:function(){window.GGameEntry.UIManager.HideUI(o.UIType.AutoJoinCountDownUI)}}),cc._RF.pop()},{SimpleLabel:"SimpleLabel",UIManager:"UIManager",Util:"Util"}],BTDeserialization:[function(e,t,n){"use strict";cc._RF.push(t,"76a63+rJbRBW4J8hER5Ba4e","BTDeserialization");var i=e("Sequence"),a=e("Selector"),o=e("LRandomSelector"),r=e("C_BattleElapseTime"),s=e("C_CanFire"),l=e("C_CheckUserVar"),c=e("C_HasAnyGridAround"),u=e("C_HasBuf"),d=e("C_HasTarget"),h=e("C_IsAllyInRange"),f=e("C_IsBeingShooted"),m=e("C_IsItemInRange"),y=e("C_IsMyBaseInRange"),p=e("C_IsTargetInRange"),g=e("C_LockAirdropBox"),C=e("C_LockBase"),G=e("C_LockTarget"),S=e("C_LockTargetInArea"),E=e("C_LockTargetNearbyMyBase"),T=e("C_LockTargetOfAllies"),w=e("C_LockTargetWithBuf"),M=e("A_SetUserVar"),_=e("ClearTargets"),I=e("Return"),B=e("A_Attack"),v=e("A_Idle"),P=e("A_SetAttackTarget"),R=e("A_Dodge"),A=e("A_Move"),D=e("A_MoveToAreaWithTargetIn"),b=e("A_MoveToCampConfigPos"),U=e("A_MoveToEnemyBase"),L=e("A_MoveToInput"),N=e("A_MoveToItem"),k=e("A_MoveToLineConfigPos"),O=e("A_MoveToRandPos");cc.Class({CreateTaskByName:function(e){switch(e){case"Sequence":return new i;case"Selector":return new a;case"LRandomSelector":return new o;case"C_BattleElapseTime":return new r;case"C_CanFire":return new s;case"C_CheckUserVar":return new l;case"C_HasAnyGridAround":return new c;case"C_HasBuf":return new u;case"C_HasTarget":return new d;case"C_IsAllyInRange":return new h;case"C_IsBeingShooted":return new f;case"C_IsItemInRange":return new m;case"C_IsMyBaseInRange":return new y;case"C_IsTargetInRange":return new p;case"C_LockAirdropBox":return new g;case"C_LockBase":return new C;case"C_LockTarget":return new G;case"C_LockTargetInArea":return new S;case"C_LockTargetNearbyMyBase":return new E;case"C_LockTargetOfAllies":return new T;case"C_LockTargetWithBuf":return new w;case"A_SetUserVar":return new M;case"ClearTargets":return new _;case"Return":return new I;case"A_Attack":return new B;case"A_Idle":return new v;case"A_SetAttackTarget":return new P;case"A_Dodge":return new R;case"A_Move":return new A;case"A_MoveToAreaWithTargetIn":return new D;case"A_MoveToCampConfigPos":return new b;case"A_MoveToEnemyBase":return new U;case"A_MoveToInput":return new L;case"A_MoveToItem":return new N;case"A_MoveToLineConfigPos":return new k;case"A_MoveToRandPos":return new O}},DeserializeTask:function(e,t){var n=this.CreateTaskByName(t.Type);if(null==n)return cc.log("Unknown task type %s",t.Type),null;n.name=t.Type,n.Children=[],n.bevTree=e;var i=Object.getOwnPropertyNames(t);for(var a in i){var o=i[a];if("Type"!=o)if("Children"==o){var r=t.Children;for(var s in r)n.Children.push(this.DeserializeTask(e,r[s]))}else n[o]=t[o]}return n},Deserialize:function(e,t){return this.DeserializeTask(e,t.RootTask)}}),cc._RF.pop()},{A_Attack:"A_Attack",A_Dodge:"A_Dodge",A_Idle:"A_Idle",A_Move:"A_Move",A_MoveToAreaWithTargetIn:"A_MoveToAreaWithTargetIn",A_MoveToCampConfigPos:"A_MoveToCampConfigPos",A_MoveToEnemyBase:"A_MoveToEnemyBase",A_MoveToInput:"A_MoveToInput",A_MoveToItem:"A_MoveToItem",A_MoveToLineConfigPos:"A_MoveToLineConfigPos",A_MoveToRandPos:"A_MoveToRandPos",A_SetAttackTarget:"A_SetAttackTarget",A_SetUserVar:"A_SetUserVar",C_BattleElapseTime:"C_BattleElapseTime",C_CanFire:"C_CanFire",C_CheckUserVar:"C_CheckUserVar",C_HasAnyGridAround:"C_HasAnyGridAround",C_HasBuf:"C_HasBuf",C_HasTarget:"C_HasTarget",C_IsAllyInRange:"C_IsAllyInRange",C_IsBeingShooted:"C_IsBeingShooted",C_IsItemInRange:"C_IsItemInRange",C_IsMyBaseInRange:"C_IsMyBaseInRange",C_IsTargetInRange:"C_IsTargetInRange",C_LockAirdropBox:"C_LockAirdropBox",C_LockBase:"C_LockBase",C_LockTarget:"C_LockTarget",C_LockTargetInArea:"C_LockTargetInArea",C_LockTargetNearbyMyBase:"C_LockTargetNearbyMyBase",C_LockTargetOfAllies:"C_LockTargetOfAllies",C_LockTargetWithBuf:"C_LockTargetWithBuf",ClearTargets:"ClearTargets",LRandomSelector:"LRandomSelector",Return:"Return",Selector:"Selector",Sequence:"Sequence"}],BaseDangerCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"4f93dazbjJK8LDJb5mjJq6w","BaseDangerCtrl");var i=e("Util");cc.Class({extends:cc.Component,properties:{animation:{default:null,type:cc.Animation},originalPosY:{default:130,visible:!1},cameraHalfHeight:{default:0,visible:!1},animationPlaying:{default:!1,visible:!1}},onLoad:function(){this.originalPosY=this.node.position.y,this.cameraHalfHeight=cc.visibleRect.height/2},onEnable:function(){this.animation.on("finished",this.animationFinish,this)},onDisable:function(){this.animation.off("finished",this.animationFinish,this)},update:function(e){var t=i.BeginSample("BaseDangerCtrl::update"),n=window.GGameEntry.BattleRoot.node.convertToWorldSpace(window.GGameEntry.BattleRoot.BattleCamera.node.position),a=this.node.parent.convertToNodeSpace(n).y-this.originalPosY;if(Math.abs(a)<=this.cameraHalfHeight)this.node.position.y!=this.originalPosY&&this.node.setPosition(cc.p(this.node.position.x,this.originalPosY));else{var o=Math.abs(a)-this.cameraHalfHeight+this.originalPosY;o!=this.node.position.y&&this.node.setPosition(cc.p(this.node.position.x,o))}i.EndSample(t)},animationFinish:function(){this.animationPlaying=!1},onBaseDamage:function(){this.animationPlaying||(this.animation.play(),this.animationPlaying=!0,window.GGameEntry.SoundManager.PlayAlert())}}),cc._RF.pop()},{Util:"Util"}],BaseFollowTank:[function(e,t,n){"use strict";cc._RF.push(t,"24d20OPv1xGG5cuTMKabRFn","BaseFollowTank");var i=e("TankBase");cc.Class({extends:cc.Component,properties:{Target:{default:null,serializable:!1,visible:!1,type:i},OffsetX:{default:0,type:cc.Float},OffsetY:{default:0,type:cc.Float}},init:function(e){e&&(this.Target=e),window.GGameEntry.BattleSystem.IsInvertWorld()&&(this.node.rotation=180,this.OffsetX*=-1,this.OffsetY*=-1)},lateUpdate:function(){if(this.Target&&this.Target.node){var e=this.Target.node.getPosition();if(e.x+=this.OffsetX,e.y+=this.OffsetY,this.Target.isInvisible())return void this.node.setPosition(1e4,1e4);if(this.Target.isDead)return void this.node.setPosition(1e4,1e4);this.node.setPosition(e)}}}),cc._RF.pop()},{TankBase:"TankBase"}],BattleDef:[function(e,t,n){"use strict";cc._RF.push(t,"19b000CDeFMYZPDGTwQWfp8","BattleDef");var i=cc.Enum({None:0,Playing:1,Paused:2,Win:3,Lose:4,Draw:5});t.exports={BattleState:i},cc._RF.pop()},{}],BattleItemCacheManager:[function(e,t,n){"use strict";cc._RF.push(t,"4ed26/5pVNJrZdRnEZFGLHA","BattleItemCacheManager");e("MapCfg");var i=e("EntityTypeDefine"),a=e("EntityBase"),o=e("ResTableNames"),r=e("MapItemBase"),s=e("Util");cc.Class({extends:cc.Component,properties:{CacheRoot:{default:null,type:cc.Node},MapItemLayer:{default:null,type:cc.Node}},onLoad:function(){this.BattleItemTemplate={},this.BattleItemCacheMap={},this.TemplateLoaded=!1,this.TemplateLoading=!1,this.TemplateLoadingCount=!1},Release:function(){for(var e in this.BattleItemTemplate)this.BattleItemTemplate[e]&&this.BattleItemTemplate[e].node.destroy();this.BattleItemTemplate={},this.TemplateLoaded=!1,this.ReleaseCache()},ReleaseCache:function(){for(var e in this.BattleItemCacheMap){var t=this.BattleItemCacheMap[e];if(t&&t.length>0)for(var n=0;n<t.length;n++)t[n]&&t[n].node.destroy()}this.BattleItemCacheMap={}},PreLoadAllTemplate:function(e){if(this.TemplateLoaded)e&&e();else if(!this.TemplateLoading){this.TemplateLoading=!0;for(var t=[i.EntityType.EntityBase,i.EntityType.EntityGround,i.EntityType.EntityAdobe,i.EntityType.EntitySteel,i.EntityType.EntityWater,i.EntityType.EntityGrass,i.EntityType.EntityBorder,i.EntityType.EntityBigAdobe,i.EntityType.EntityMonster,i.EntityType.EntityPlayer,i.EntityType.EntityBullet,i.EntityType.EntityDecorate,i.EntityType.EntityMapBox,i.EntityType.EntityNoBroken],n=this,a=0;a<t.length;a++){var o=t[a],r=i.GetPrefabs(o);n.BattleItemTemplate[o]=null,n.TemplateLoadingCount++,cc.loader.loadRes(r,function(t,i){if(n.TemplateLoadingCount--,t)cc.error(t.message||t);else{if(i instanceof cc.Prefab){var o=cc.instantiate(i).getComponent("EntityBase");o?n.BattleItemTemplate[o.EntityType]=o:cc.error("Comonent EntityBase is not FOUND:",mapItemRes[a].Res)}else cc.error("Should be Prefab:",mapItemRes[a].Res);0===n.TemplateLoadingCount&&(n.TemplateLoaded=!0,e&&e())}})}}},GetMapItem:function(e,t){var n=this.GetBattleItem(e,t,i.GetEntityTypeFromMapTileType(window.GGameEntry.MapManager.GetMapTileType(e)));return n instanceof a&&n.Reset(),n instanceof r&&n.GenGUID(),n},GetBattleItem:function(e,t,n){this.BattleItemCacheMap[n]||(this.BattleItemCacheMap[n]=[]);for(var i=this.BattleItemCacheMap[n],a=0;a<i.length;a++)if(i[a].Resid===e&&i[a].SubItemIndex===t){var o=i[a];return this.BattleItemCacheMap[n].splice(a,1),o.Reset(),o}return this.CreateMapItem(n,e,t)},CreateMapItem:function(e,t,n){if(!this.BattleItemTemplate[e])return cc.error("Template is NULL:",e),null;var i=cc.instantiate(this.BattleItemTemplate[e].node).getComponent("EntityBase");return i.SetResID(t,n),i},CreateBufferItem:function(e){var t=window.GGameEntry.ResTableMgr.GetConfigByID(o.star_item_cs,e);if(t){var n=window.GGameEntry.ResManager.GetResPrefab(t.Resource);if(n){var i=cc.instantiate(n).getComponent("EntityBase");return i&&(i.node.parent=this.MapItemLayer),i}cc.error("item cfg prefab not found:",t.Resource)}else cc.error("item cfg not found:",e)},GetBufferItem:function(e){this.BattleItemCacheMap[e]||(this.BattleItemCacheMap[e]=[]);for(var t=this.BattleItemCacheMap[e],n=0;n<t.length;n++)if(t[n].Resid===e){var i=t[n];return this.BattleItemCacheMap[e].splice(n,1),i.Reset(),i}return this.CreateBufferItem(e)},CacheMe:function(e){e&&(e.EntityType==i.EntityType.EntityBuffItem?this.PutToCache(e):e.node.destroy())},PutToCache:function(e){if(e){e.node.active=!1;var t=e.EntityType===i.EntityType.EntityBuffItem?e.Resid:e.EntityType;this.BattleItemCacheMap[t]||(this.BattleItemCacheMap[t]=[]),this.BattleItemCacheMap[t][this.BattleItemCacheMap[t].length]=e}},GetCacheCount:function(e,t){var n=i.GetEntityTypeFromResID(e);n=n===i.EntityType.EntityBuffItem?e:n;var a=this.BattleItemCacheMap[n];if(!a)return 0;t=t||0;for(var o=0,r=0;r<a.length;r++)a[r].Resid===e&&a[r].SubItemIndex===t&&o++;return o},CacheSomeItem:function(){var e=window.GGameEntry.ResTableMgr.GetTableByName(o.star_item_cs);if(e&&e.length>0)for(var t=0;t<e.length;t++){var n=e[t];if(!n)return cc.error("Item not found"),null;for(var i=s.TableStr2Num(n.ID),a=this.GetCacheCount(i);a<5;a++){var r=this.CreateBufferItem(i);this.PutToCache(r)}}}}),cc._RF.pop()},{EntityBase:"EntityBase",EntityTypeDefine:"EntityTypeDefine",MapCfg:"MapCfg",MapItemBase:"MapItemBase",ResTableNames:"ResTableNames",Util:"Util"}],BattleLoadingUI:[function(e,t,n){"use strict";cc._RF.push(t,"40827/H6ElKApgNi2KPIGar","BattleLoadingUI");e("UIManager");var i=e("weixinmsgmgr"),a=e("star_comm"),o=(e("EntityTypeDefine"),e("CmdStartGame")),r=e("loginServerMgr"),s=e("HeadImageUtil"),l=e("ResTableNames"),c=e("PlatformUtil"),u=e("Util"),d=cc.Enum({StartLoad:0,PreloadRes:1,CreateCache:2,CreateMap:3,CreateObject:4,WaitToStart:5,Complete:6});cc.Class({extends:cc.Component,properties:{LoadProgress:{default:null,type:cc.ProgressBar},PlayerNode:{default:[],type:cc.Node},PlayerIcon:{default:[],type:cc.Sprite},PlayerName:{default:[],type:cc.Label},TipsIcon:{default:null,type:cc.Sprite},TipsContent:{default:null,type:cc.Label},SpAtlas:{default:null,type:cc.SpriteAtlas},SvrBattleObj:{default:null,visibility:!1,serializable:!1},CurLoadIndex:{default:0,visibility:!1,serializable:!1},CurLoadTime:{default:0,visibility:!1,serializable:!1},CurStartWaitTime:{default:0,visibility:!1,serializable:!1},CurLoadingStep:{default:d.StartLoad,visibility:!1,serializable:!1},CurStepProcesed:{default:!1,visibility:!1,serializable:!1},PVPRoomCountDownTime:{default:0,visibility:!1,serializable:!1}},onEnable:function(){this.LoadProgress.progress=0,this.CurLoadIndex=0,this.CurLoadTime=0,this.CurStartWaitTime=0,this.CurLoadingStep=d.StartLoad,this.CurStepProcesed=!1,this.SvrBattleObj=window.GGameEntry.BattleSystem.SvrBattleObj,window.GGameEntry.BattleSystem.SvrBattleObj=null,window.GGameEntry.BattleSystem.MapLoading=!0,this.PVPRoomCountDownTime=0===this.SvrBattleObj.TriggerTime?9:6,this.SetupPlayerInfo();var e=this.getRandomTipsInTable();if(e){var t=parseInt(e.Type),n=(parseInt(e.ID),e.Icon),i=e.Desc;2===t?this.TipsIcon.node.opacity=0:(this.TipsIcon.node.opacity=255,this.TipsIcon.spriteFrame=this.SpAtlas.getSpriteFrame(n)),this.TipsContent.string=i}},getRandomTipsInTable:function(){var e=window.GGameEntry.ResTableMgr.GetTableByName(l.star_tips_c);if(e){var t=e.length-1,n=(Math.random()*t).toFixed(0);return{ID:e[n].ID,Type:e[n].Type,Icon:e[n].Icon,Desc:e[n].Desc}}},update:function(e){switch(this.CurLoadTime+=e,this.CurLoadingStep){case d.StartLoad:this.OnStartLoad();break;case d.PreloadRes:this.OnPreloadRes();break;case d.CreateCache:this.OnCreateCache();break;case d.CreateMap:this.OnCreateMap();break;case d.CreateObject:this.OnCreateObject();break;case d.WaitToStart:this.OnWaitToStart();break;case d.Complete:this.OnComplete()}},OnStartLoad:function(){this.CurLoadingStep++,this.CurStepProcesed=!1,this.LoadProgress.progress=.05},OnPreloadRes:function(){if(!this.CurStepProcesed){if(window.GGameEntry.BattleItemCacheManager.TemplateLoaded&&window.GGameEntry.ResManager.ResTemplateLoaded)return this.CurLoadingStep++,this.CurStepProcesed=!1,void(this.LoadProgress.progress=.1);var e=this;window.GGameEntry.ResManager.PreLoadRes(function(){e.CurLoadingStep++,e.CurStepProcesed=!1,e.LoadProgress.progress=.1}.bind(this)),this.CurStepProcesed=!0}},OnCreateCache:function(){window.GGameEntry.BattleItemCacheManager.CacheSomeItem(),this.CurLoadingStep++,this.CurStepProcesed=!1,this.LoadProgress.progress=.15},OnCreateMap:function(){window.GGameEntry.BattleSystem.MapID=this.SvrBattleObj.MapID,window.GGameEntry.BattleSystem.EnterBattle(),this.CurLoadingStep++,this.CurStepProcesed=!1,this.LoadProgress.progress=.2},OnCreateObject:function(){if(this.CurLoadIndex>=0&&this.CurLoadIndex<this.SvrBattleObj.ObjCnt){for(var e=0;e<10&&this.CurLoadIndex<this.SvrBattleObj.ObjCnt;e++){var t=i.getOpenID(),n=this.SvrBattleObj.List[this.CurLoadIndex];if(n.Type==a.CsObjectType.CS_OBJ_PLAYER){var o=n.Object.PlayerObj;o.Type===a.ObjType.OBJ_TYPE_HIDE?window.GGameEntry.MapManager.CreateMapBattleHideItemByServer(o):o.OpenId===t?window.GGameEntry.PlayerManager.CreatePlayerFromServerData(o):window.GGameEntry.PlayerManager.CreateOtherPlayerFromServerData(o)}else if(n.Type==a.CsObjectType.CS_OBJ_OTHER){var r=n.Object.OtherObj;r&&(r.Type===a.ObjType.OBJ_TYPE_ITEM?window.GGameEntry.ItemManager.CreateItemByServer(r):r.Type===a.ObjType.OBJ_TYPE_BASE||r.Type===a.ObjType.OBJ_TYPE_BRICK||r.Type===a.ObjType.OBJ_TYPE_STEEL||r.Type===a.ObjType.OBJ_TYPE_RIVER||r.Type===a.ObjType.OBJ_TYPE_GRASS||r.Type===a.ObjType.OBJ_TYPE_ORNAMENT||r.Type===a.ObjType.OBJ_TYPE_MAP_BOX||r.Type===a.ObjType.OBJ_TYPE_NO_BROKEN?window.GGameEntry.MapManager.CreateMapBattleItemByServer(r):r.Type===a.ObjType.OBJ_TYPE_HIDE?window.GGameEntry.MapManager.CreateMapBattleHideItemByServer(r):r.Type===a.ObjType.OBJ_TYPE_BOX?window.GGameEntry.AirDropSystem.InitWithServerData(r):cc.error("not match:",r.ResID))}this.CurLoadIndex++}this.CurStepProcesed=!0}this.LoadProgress.progress=.2+this.CurLoadIndex/this.SvrBattleObj.ObjCnt*(this.SvrBattleObj.CountTime>0?.5:.8),this.CurLoadIndex>=this.SvrBattleObj.ObjCnt&&(this.CurStepProcesed=!1,this.CurLoadingStep++,this.CurStartWaitTime=this.CurLoadTime,0===this.SvrBattleObj.TriggerTime&&window.GGameEntry.BattleSystem.Pause())},OnWaitToStart:function(){this.CurLoadTime+this.PVPRoomCountDownTime>=this.SvrBattleObj.CountTime?this.CurLoadingStep++:this.LoadProgress.progress=.7+(this.CurLoadTime-this.CurStartWaitTime)/(this.SvrBattleObj.CountTime-this.CurStartWaitTime-this.PVPRoomCountDownTime)*.3},OnComplete:function(){if(!this.CurStepProcesed){window.GGameEntry.BattleSystem.MapLoading=!1;var e=new o;e.Init(),e.SyncTime=this.SvrBattleObj.SyncTime,e.BattleTime=this.SvrBattleObj.BattleTime,e.GameBeginTime=this.SvrBattleObj.GameBeginTime,e.Reconnected=0===this.SvrBattleObj.CountTime,window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(e),this.SvrBattleObj=null,c.IsWeichatGame()&&window.GGameEntry.IsReconnect?window.GGameEntry.SoundManager.PlayGameBg():window.GGameEntry.SoundManager.PlayPreGameBg()}},SetupPlayerInfo:function(){var e=r.onGetTeamInfo();if(null!==e){for(var t=0,n=0,i=e.SD.GetTeamInfo,a=0;a<3;a++)if(a<i.BlueCampRoleInfo.length){""!=i.BlueCampRoleInfo[a].OpenId?(this.PlayerNode[a].active=!0,n++):this.PlayerNode[a].active=!1;var o=i.BlueCampRoleInfo[a].Name;o&&0!==o.length||(o="Tmlja05hbWU=");var l=window.GGameEntry.GBase64.decode(o),d=""!==i.BlueCampRoleInfo[a].OpenId?l:"TankA";c.isTargetPlatform(2)&&(d=u.FliterEmojString(d)),this.PlayerName[a].string=d,""===i.BlueCampRoleInfo[a].Pic?s.loadImageFromNetUrl(this.PlayerIcon[a],"res/raw-assets/resources/Atlas/HeadIcon.png"):s.loadImageFromNetUrl(this.PlayerIcon[a],i.BlueCampRoleInfo[a].Pic)}else this.PlayerNode[a].active=!1;for(a=0;a<3;a++)if(a<i.RedCampRoleInfo.length){""!=i.RedCampRoleInfo[a].OpenId?(t++,this.PlayerNode[a+3].active=!0):this.PlayerNode[a+3].active=!1;var h=i.RedCampRoleInfo[a].Name;h&&0!==h.length||(h="Tmlja05hbWU=");var l=window.GGameEntry.GBase64.decode(h),f=""!==i.RedCampRoleInfo[a].OpenId?l:"TankA";c.isTargetPlatform(2)&&(f=u.FliterEmojString(f)),this.PlayerName[a+3].string=f,""===i.RedCampRoleInfo[a].Pic?s.loadImageFromNetUrl(this.PlayerIcon[a+3],"res/raw-assets/resources/Atlas/HeadIcon.png"):s.loadImageFromNetUrl(this.PlayerIcon[a+3],i.RedCampRoleInfo[a].Pic)}else this.PlayerNode[a+3].active=!1;var m=this.getActiveNode(!0);1===n&&1===m.length?m[0].setPosition(-57,89):2===n&&2===m.length?(m[0].setPosition(-55,97),m[1].setPosition(-108,-41)):3===n&&3===m.length&&(m[0].setPosition(-4,227),m[1].setPosition(-57,89),m[2].setPosition(-110,-47));var y=this.getActiveNode(!1);1===t&&1===y.length?y[0].setPosition(200,0):2===t&&2===y.length?(y[0].setPosition(234,97),y[1].setPosition(183,-44)):3===t&&3===y.length&&(y[0].setPosition(250,136),y[1].setPosition(200,0),y[2].setPosition(150,-136))}else cc.error("team info is null")},getActiveNode:function(e){var t=[];if(e)for(var n=0;n<3;n++)this.PlayerNode[n].active&&(t[t.length]=this.PlayerNode[n]);else for(var i=3;i<6;i++)this.PlayerNode[i].active&&(t[t.length]=this.PlayerNode[i]);return t}}),cc._RF.pop()},{CmdStartGame:"CmdStartGame",EntityTypeDefine:"EntityTypeDefine",HeadImageUtil:"HeadImageUtil",PlatformUtil:"PlatformUtil",ResTableNames:"ResTableNames",UIManager:"UIManager",Util:"Util",loginServerMgr:"loginServerMgr",star_comm:"star_comm",weixinmsgmgr:"weixinmsgmgr"}],BattleNetwork:[function(e,t,n){"use strict";cc._RF.push(t,"12da3BR8opAPYzK61LcvtCY","BattleNetwork");var i=e("Network"),a=e("NetworkConnector"),o=e("NetworkHeartbeat"),r=e("NetworkWatchdog"),s=e("NetworkUtils"),l=e("NetworkProto"),c=e("JsonUtils"),u=e("weixinmsgmgr"),d=e("GlobalCfg"),h=e("Util"),f=e("UIManager"),m=e("ResTableNames"),y=e("NetworkStatus");cc.Class({extends:i,ctor:function(){this.name="Battle",this.btnReconnect=0,this.isBadNetwork=!1,this.dicEvents={},this.connector=new a,this.heartbeat=new o,this.watchdog=new r,this.connector.init(this),this.heartbeat.init(this),this.watchdog.init(this),this.heartbeat_timeout=2e4,this.connector.canShowQueueTips=!0},resetBadNetworkFlag:function(){this.isBadNetwork=!1},clearSendBuf:function(){},Connect:function(e){s.IsValidUrl(e)?this.IsConnected(e)?console.warn("[BattleNetwork.Connect] failed: already connected."):this.connector?(this.connector.connect(e),console.log("[BattleNetwork.Connect] connecting: %s.",e)):console.warn("[BattleNetwork.Connect] failed: initialize network before connect."):console.warn("[BattleNetwork.Connect] failed: invalid url.")},Disconnect:function(){this.connector.close(),console.log("[BattleNetwork.Disconnect] disconnect.")},IsNotConnected:function(e){return!1},Reconnect:function(){if(window.GGameEntry.CurGamePlayType===d.GamePlayType.GamePlayType_Network){if(1!==this.btnReconnect){if(2===this.btnReconnect)this.watchdog.resetRetrycount(),console.log("[BattleNetwork.Reconnect] reconnecting sure button");else if(3===this.btnReconnect)return console.log("[BattleNetwork.Reconnect] reconnecting cancel button"),window.GGameEntry.BattleSystem.IsPlaying()||window.GGameEntry.BattleSystem.IsPause()||window.GGameEntry.BattleSystem.IsMapLoading()?window.GGameEntry.BattleSystem.ExitBattle():window.GGameEntry.BattleSystem.IsInRooming()&&(window.GGameEntry.UIManager.HideAllActiveUI(),window.GGameEntry.UIManager.ShowUI(f.UIType.LogoUI,f.UIOrder.Top)),void(this.btnReconnect=0);if(this.watchdog.getRetrycount()>1){console.log("[BattleNetwork.Reconnect] reconnecting reconnect has been exceed 1 times."),this.btnReconnect=1,u.onHideLoadingState();t=window.GGameEntry.ResTableMgr.GetConfigByID(m.star_client_c,55).Context;window.GGameEntry.UIManager.ShowMsgBox(t,199)}else{this.btnReconnect=0;var e=this.connector.getURL();if(s.IsValidUrl(e)){console.log("[BattleNetwork.Reconnect] reconnecting."),window.GGameEntry.BattleSystem.IsPlaying()&&window.GGameEntry.BattleSystem.Pause();var t=window.GGameEntry.ResTableMgr.GetConfigByID(m.star_client_c,56).Context;u.onShowLoadingState("reconnecting...",15e3,t,this.IsNotConnected,this),this.Connect(e)}}}}else console.log("[BattleNetwork.Reconnect] reconnecting return type:"+window.GGameEntry.CurGamePlayType)},Request:function(e){this.IsConnected()?this.connector.send(e):console.warn("[BattleNetwork.Request] failed: network not connected.")},ResponseArray:function(e){h.BeginSample("BattleNetwork::ResponseArray");for(var t=0;t<e.length;++t)if(e[t].C){var n=this.dicEvents[e[t].C];if(n)for(var i=0,a=n.length;i<a;++i){var o=n[i];o&&o(e[t])}else console.warn("[BattleNetwork.ResponseArray] can not find handler at index: %s.",t)}else console.warn("[BattleNetwork.ResponseArray] invalid msg at index: %d.",t);h.EndSample("BattleNetwork::ResponseArray")},Response:function(e){h.BeginSample("BattleNetwork::Response");var t=c.SafeParse(e);if(t){if(t instanceof Array)return this.ResponseArray(t);if(t.C){var n=this.dicEvents[t.C];if(n){for(var i=0,a=n.length;i<a;++i){var o=n[i];o&&o(t)}h.EndSample("BattleNetwork::Response")}else console.warn("[BattleNetwork.Response] can not find handler: %s.",e)}else console.warn("[BattleNetwork.Response] JSON parse failed: %s.",e)}else console.warn("[BattleNetwork.Response] JSON parse failed: %s.",e)},Register:function(e,t){var n=e;this.dicEvents[n]||(this.dicEvents[n]=[]);for(var i=this.dicEvents[n],a=0,o=i.length;a<o;++a)if(i[a]===t)return void console.warn("[BattleNetwork.Register] event handler already exised: [%d, %o].",n,t);i.push(t)},Unregister:function(e,t){var n=l.GetRequestByID(e).__msgid__;if(this.dicEvents[n])for(var i=this.dicEvents[n],a=i.length-1;a>=0;--a)i[a]===t&&i.splice(a,1)},SetHeartbeatTimeout:function(e){e>this.heartbeat_timeout&&(this.heartbeat_timeout=e)},Update:function(){if(this.watchdog.update(),this.IsConnected()&&(this.heartbeat.update(),this.connector.update(),!this.isBadNetwork&&(window.GGameEntry.BattleSystem.IsPlaying()||window.GGameEntry.BattleSystem.IsPause()||window.GGameEntry.BattleSystem.IsInRooming())&&window.GGameEntry.CurGamePlayType===d.GamePlayType.GamePlayType_Network&&Date.now()-this.heartbeat.recvTick>this.heartbeat_timeout&&(this.isBadNetwork=!0,this.heartbeat.onResetRecvTick(0),this.connector.status=y.Status.NotConnect),!this.pauseRecvMsg))for(var e=this.connector.recv();e&&(this.Response(e),!this.pauseRecvMsg);)e=this.connector.recv()}}),cc._RF.pop()},{GlobalCfg:"GlobalCfg",JsonUtils:"JsonUtils",Network:"Network",NetworkConnector:"NetworkConnector",NetworkHeartbeat:"NetworkHeartbeat",NetworkProto:"NetworkProto",NetworkStatus:"NetworkStatus",NetworkUtils:"NetworkUtils",NetworkWatchdog:"NetworkWatchdog",ResTableNames:"ResTableNames",UIManager:"UIManager",Util:"Util",weixinmsgmgr:"weixinmsgmgr"}],BattleRoot:[function(e,t,n){"use strict";cc._RF.push(t,"9fce0GZuHtFPKAjM4r7fXUi","BattleRoot");e("MapCfg");var i=e("EntityTypeDefine"),a=e("CameraShake"),o=e("Util");e("ResCfgDef");cc.Class({extends:cc.Component,properties:{BattleCamera:{default:null,type:cc.Camera},BattleAreaSize:{default:null,serializable:!1,visible:!1},BattleLayers:{default:null,serializable:!1,visible:!1},NodeTarget:{default:null,serializable:!1,visible:!1}},onLoad:function(){this.BattleAreaSize=cc.size(),this.BattleLayers=this.node.children,this.NodeTarget=null},EnableMe:function(){this.NodeTarget=null,this.node.active=!0,this.BattleCamera.zoomRatio=Math.floor(7.5/window.GGameEntry.GlobalCfg.ViewHeightGridCount*1e3)/1e3,this.initCameraPos()},initCameraPos:function(){var e=o.BeginSample("BattleRoot::initCameraPos"),t=cc.v2(600,1800),n=window.GGameEntry.MapManager.GetMapBattleHomePos(i.EntityCampType.RedTeam);n&&(t=new cc.Vec2(n.x,n.y)),this.SetCameraPosition(t),o.EndSample(e)},InitGuidePos:function(){window.GGameEntry.PlayerManager.Player?this.SetBattleViewTarget(window.GGameEntry.PlayerManager.Player.node):cc.error("player is not found")},DisableMe:function(){this.node.active=!1,this.NodeTarget=null},SetBattleViewTarget:function(e){this.NodeTarget=e,this.SetCameraPosition(e.position)},ClearBattleViewTarget:function(){this.LastTargetPos=this.BattleCamera.node.position,this.NodeTarget=null},moveBattleViewTargetInTime:function(e,t){this.RebornTime=t;this.BattleCamera.node.position;var n=cc.moveTo(t,e);this.NodeTarget=e,this.BattleCamera.node.runAction(n)},moveBattleCameraInTime:function(e,t,n){this.NodeTarget=null,this.SetCameraPosition(e),window.GGameEntry.GameConfig.cameraXFlow||(t=this.checkPositionInScreen(t));var i=cc.moveTo(n,t);this.BattleCamera.node.runAction(i)},moveBattleCameraToDestInTime:function(e,t){this.NodeTarget=null;var n=cc.moveTo(t,e);this.BattleCamera.node.runAction(n)},stopCameraAction:function(){this.BattleCamera.node.stopAllActions()},SetBattleAreaSize:function(e,t){if(this.BattleAreaSize.width!==e||this.BattleAreaSize.height!==t){this.BattleAreaSize.width=e,this.BattleAreaSize.height=t;for(var n=0;n<this.BattleLayers.length;n++){var i=this.BattleLayers[n];i.width=e,i.height=t,i.x=0,i.y=0}}},checkPositionInScreen:function(e){var t=window.GGameEntry.MapManager.MapBottomLayer;return e.x-cc.visibleRect.width/2<0&&(e.x=t.width/2),e.x+cc.visibleRect.width/2>t.width&&(e.x=t.width/2),e.y-cc.visibleRect.height/2<0&&(e.y=cc.visibleRect.height/2),e.y+cc.visibleRect.height/2>t.height&&(e.y=t.height-cc.visibleRect.height/2),e},ShakeFor:function(){this.cameraShake||(this.cameraShake=new a),this.cameraShake.ShakeFor()},lateUpdate:function(e){if(this.cameraShake&&this.cameraShake.started){if(null===this.NodeTarget)return void(this.cameraShake&&this.cameraShake.startShake&&this.LastTargetPos&&((n=this.cameraShake.getShakePosint(e)).addSelf(this.LastTargetPos),this.SetCameraPosition(n)));if(this.RebornTime>0)return void(this.RebornTime=this.RebornTime-e);var t=this.NodeTarget.getPosition();if(this.cameraShake&&this.cameraShake.startShake){var n=this.cameraShake.getShakePosint(e);t.addSelf(n)}this.SetCameraPosition(t)}},SetCameraPos:function(e){if(this.RebornTime>0)this.RebornTime=this.RebornTime-e;else if(this.NodeTarget){var t=this.NodeTarget.getPosition();this.SetCameraPosition(t)}},SetCameraPosition:function(e){window.GGameEntry.GameConfig.cameraXFlow||(e=this.checkPositionInScreen(e)),this.BattleCamera.node.setPosition(e)},GetCameraViewArea:function(){var e=this.BattleCamera.node.position,t=cc.visibleRect.width/this.BattleCamera.zoomRatio,n=cc.visibleRect.height/this.BattleCamera.zoomRatio;return[e.x-t/2,e.y-n/2,e.x+t/2,e.y+n/2]},GetInvertWorldPos:function(e,t){return[window.GGameEntry.MapManager.GridWidth*window.GGameEntry.MapManager.BigGridSize-e,window.GGameEntry.MapManager.GridHeight*window.GGameEntry.MapManager.BigGridSize-t]},ConvertBattlePosToUIPos:function(e,t){var n=this.GetCameraViewArea();return[(e-n[0])*cc.visibleRect.width/(n[2]-n[0]),(t-n[1])*cc.visibleRect.height/(n[3]-n[1])]},ConvertUIPosToBattlePos:function(e,t){var n=this.GetCameraViewArea();return[e*(n[2]-n[0])/cc.visibleRect.width+n[0],t*(n[3]-n[1])/cc.visibleRect.height+n[1]]},CheckInCameraViewArea:function(e,t){var n=this.GetCameraViewArea();return e>=n[0]&&t>=n[1]&&e<=n[2]&&t<=n[3]},SetCameraRotation:function(e){this.BattleCamera.node.rotation=e?180:0}}),cc._RF.pop()},{CameraShake:"CameraShake",EntityTypeDefine:"EntityTypeDefine",MapCfg:"MapCfg",ResCfgDef:"ResCfgDef",Util:"Util"}],BattleSystem:[function(e,t,n){"use strict";cc._RF.push(t,"6170cg4L/lMYoUVV6atOYWm","BattleSystem");var i=e("BattleDef"),a=e("UIManager"),o=e("EntityTypeDefine"),r=e("GlobalCfg"),s=e("TankBase"),l=e("weixinmsgmgr"),c=e("PlatformUtil"),u=e("Util"),d=e("loginServerMgr"),h=e("ServerLog"),f=e("ActivityMsgMgr"),m=e("ResTableNames");cc.Class({extends:cc.Component,properties:{BattleData:{default:null,visible:!1,serializable:!1},BattleKillData:{default:null,visible:!1,serializable:!1},BattleUIReady:{default:!1,visible:!1,serializable:!1},BattleMapReady:{default:!1,visible:!1,serializable:!1},GameReady:{default:!1,visible:!1,serializable:!1},JoysticUIReady:{default:!1,visible:!1,serializable:!1},MapID:{default:0,visible:!1,serializable:!1},SvrBattleObj:{default:null,visible:!1,serializable:!1}},Init:function(){this.BattleData={},this.ResetBattleData(),this.MapLoading=!1,this.InRooming=!1,c.IsWeichatGame()&&(l.onGameShow(),l.onGameHide(),l.audioInterruptEnd())},ResetBattleKillData:function(){this.BattleKillData=[];for(var e in window.GGameEntry.EntityManager.map)if(window.GGameEntry.EntityManager.map.hasOwnProperty(e)){var t=window.GGameEntry.EntityManager.map[e];if(t instanceof s){var n=t.GetTankName(),i={killCount:0,deadCount:0,multiKillCount:0,blockCount:0,guid:t.Guid,stringName:n,lineType:t.EntityLineType,campType:t.EntityCampType};this.BattleKillData[this.BattleKillData.length]=i}}},UpdateBattleBlockData:function(e,t){for(var n=0;n<this.BattleKillData.length;n++)this.BattleKillData[n].guid===t&&(this.BattleKillData[n].blockCount+=e,this.BattleKillData[n].blockCount>this.BattleData.BlockMaxCount&&(this.BattleData.BlockMaxCount=this.BattleKillData[n].blockCount))},UpdateBattleKillData:function(e,t,n,i,a,o){for(var r=u.BeginSample("BattleSystem::UpdateBattleKillData"),s=!1,l=0;l<this.BattleKillData.length;l++)this.BattleKillData[l].guid===n&&(this.BattleKillData[l].deadCount+=1,this.BattleKillData[l].multiKillCount>=5&&(s=!0),this.BattleKillData[l].multiKillCount=0),this.BattleKillData[l].guid===o&&(this.BattleKillData[l].killCount+=1,this.BattleKillData[l].multiKillCount+=1,this.BattleKillData[l].killCount>this.BattleData.KillMaxCount&&(this.BattleData.KillMaxCount=this.BattleKillData[l].killCount));e!==window.GGameEntry.PlayerManager.GetMyCamp()?this.BattleData.BlueKillCount+=1:this.BattleData.RedKillCount+=1,window.GGameEntry.NotificationCenter.emit("OnBattleUIUpdate",{campType:e,lineType:t,dieGuid:n,hitCampType:i,hitLineType:a,hitGuid:o,isShutDown:s}),window.GGameEntry.NotificationCenter.emit("OnBattleUIKillUpdate"),u.EndSample(r)},GetTankNameByGUID:function(e){var t=u.BeginSample("BattleSystem::GetTankNameByGUID"),n="",i=window.GGameEntry.EntityManager.getEntity(e);if(i){var a=i.getComponent("TankBase");a&&(n=a.GetTankName())}return u.EndSample(t),n},ParseBattleEndJsonDataFromServer:function(e){var t=u.BeginSample("BattleSystem::ParseBattleEndJsonDataFromServer"),n=e.SD.BattleEnd,i=n.EndReason,a=n.Winner,o=n.FirstBlood,r=n.Statistic.CampStatistic,s=void 0;f.setActivityType(n.RoomType),d.setBattleAgainInfo(n.RoomGuid,n.Port,n.RoomType),this.BattleKillData=[],this.BattleData.KillMaxCount=0,this.BattleData.BlockMaxCount=0;for(var l=0,c=0,h=window.GGameEntry.PlayerManager.PlayerCampType,y=0;y<r.length;y++)if(s=r[y].PlayerStatistic)for(var p=0;p<s.length;p++){var g="",C=0,G=window.GGameEntry.EntityManager.getEntity(s[p].ObjID);if(G){var S=G.getComponent("TankBase");S&&(g=S.GetTankName(),C=S.EntityLineType)}0===g.length&&(g="GUID"+s[p].ObjID.toString());var E={killCount:s[p].KillNum,deadCount:s[p].DieNum,blockCount:s[p].BrickNum,healthCount:s[p].AddHPToTeam,killContiMax:s[p].KillContiMax,attackTankDmg:s[p].AttackTankDmg,attackBaseDmg:s[p].AttackBaseDmg,guid:s[p].ObjID,stringName:g,campType:r[y].CampID,lineType:C};this.BattleKillData[this.BattleKillData.length]=E,E.killCount>this.BattleData.KillMaxCount&&(this.BattleData.KillMaxCount=E.killCount),E.blockCount>this.BattleData.BlockMaxCount&&(this.BattleData.BlockMaxCount=E.blockCount),E.healthCount>this.BattleData.HealthMaxCount&&(this.BattleData.HealthMaxCount=E.healthCount),r[y].CampID===h?c+=s[p].DieNum:l+=s[p].DieNum}if(1===i)if(a===h){T=window.GGameEntry.ResTableMgr.GetConfigByID(m.star_client_c,2).Context;this.Win(T,!1)}else{T=window.GGameEntry.ResTableMgr.GetConfigByID(m.star_client_c,3).Context;this.Lose(T,!1)}else if(2===i)if(l>c){T=window.GGameEntry.ResTableMgr.GetConfigByID(m.star_client_c,4).Context;this.Win(T,!0)}else if(l<c){T=window.GGameEntry.ResTableMgr.GetConfigByID(m.star_client_c,5).Context;this.Lose(T,!0)}else if(0===l){T=window.GGameEntry.ResTableMgr.GetConfigByID(m.star_client_c,6).Context;this.Lose(T,!0)}else if(o===h){T=window.GGameEntry.ResTableMgr.GetConfigByID(m.star_client_c,7).Context;this.Win(T,!0)}else{var T=window.GGameEntry.ResTableMgr.GetConfigByID(m.star_client_c,8).Context;this.Lose(T,!0)}u.EndSample(t)},ResetBattleData:function(){this.BattleData.KillMaxCount=0,this.BattleData.BlockMaxCount=0,this.BattleData.HealthMaxCount=0,this.BattleData.RedKillCount=0,this.BattleData.BlueKillCount=0,this.BattleData.StartTime=0,this.BattleData.PauseTime=0,this.BattleData.SvrTime=0,this.BattleData.BattleState=i.BattleState.None,this.BattleData.CurrentBattleTime=0,this.BattleData.FullBattleTime=60,this.BattleUIReady=!1,this.BattleMapReady=!1,this.JoysticUIReady=!1,this.GameReady=!1,this.IsBattleBeginCountDownEnd=!1,this.BattleData.isArriveTime=!1,this.BattleData.firstBloodCamp=o.EntityCampType.None},IsPause:function(){return this.BattleData.BattleState===i.BattleState.Paused},IsPlaying:function(){return this.BattleData.BattleState===i.BattleState.Playing},IsSettle:function(){return this.BattleData.BattleState===i.BattleState.Win||this.BattleData.BattleState===i.BattleState.Lose},IsMapLoading:function(){return this.MapLoading},IsInRooming:function(){return this.InRooming},Pause:function(e){this.BattleData.BattleState==i.BattleState.Playing&&(this.BattleData.BattleState=i.BattleState.Paused,this.BattleData.PauseTime=(new Date).getTime(),window.GGameEntry.PlayerManager.Pause(),window.GGameEntry.MonsterManager.Pause(),e||window.GGameEntry.SoundManager.Pause(),window.GGameEntry.BulletManager.Pause(),window.GGameEntry.AirDropSystem.Pause(),window.GGameEntry.CollisionObject.Pause(),window.GGameEntry.SoundManager.onPause())},Resume:function(e){if(this.BattleData.BattleState===i.BattleState.Paused){var t=u.BeginSample("BattleSystem::GetTankNameByGUID");this.BattleData.BattleState=i.BattleState.Playing,window.GGameEntry.CurGamePlayType===r.GamePlayType.GamePlayType_Single&&(this.BattleData.StartTime=Date.now()-(this.BattleData.PauseTime-this.BattleData.StartTime)),window.GGameEntry.PlayerManager.Resume(),window.GGameEntry.MonsterManager.Resume(),e||window.GGameEntry.SoundManager.Resume(),window.GGameEntry.BulletManager.Resume(),window.GGameEntry.CollisionObject.Resume(),window.GGameEntry.AirDropSystem.Resume(),window.GGameEntry.SoundManager.onResume(),u.EndSample(t)}},GameOver:function(){var e=u.BeginSample("BattleSystem::GameOver");window.GGameEntry.PlayerManager.Pause(),window.GGameEntry.MonsterManager.Pause(),window.GGameEntry.AirDropSystem.Pause(),window.GGameEntry.BulletManager.Pause(),window.GGameEntry.CollisionObject.Pause(),window.GGameEntry.NotificationCenter.emit("GameOver"),window.GGameEntry.ResManager.EndFPSCheck(),u.EndSample(e)},OnWinCameraMove:function(){var e=window.GGameEntry.MapManager.GetMapBattleHomePos(o.EntityCampType.RedTeam),t=window.GGameEntry.MapManager.GetMapBattleHomePos(o.EntityCampType.BlueTeam);e=new cc.Vec2(e.x,e.y),t=new cc.Vec2(t.x,t.y);var n=window.GGameEntry.PlayerManager.PlayerCampType;window.GGameEntry.CurGamePlayType===r.GamePlayType.GamePlayType_Single&&(n=o.EntityCampType.BlueTeam),n===o.EntityCampType.BlueTeam?window.GGameEntry.BattleRoot.moveBattleCameraToDestInTime(e,1.5):n===o.EntityCampType.RedTeam&&window.GGameEntry.BattleRoot.moveBattleCameraToDestInTime(t,1.5)},OnLoseCameraMove:function(){var e=window.GGameEntry.MapManager.GetMapBattleHomePos(o.EntityCampType.RedTeam),t=window.GGameEntry.MapManager.GetMapBattleHomePos(o.EntityCampType.BlueTeam);e=new cc.Vec2(e.x,e.y),t=new cc.Vec2(t.x,t.y);var n=window.GGameEntry.PlayerManager.PlayerCampType;window.GGameEntry.CurGamePlayType===r.GamePlayType.GamePlayType_Single&&(n=o.EntityCampType.BlueTeam),n===o.EntityCampType.BlueTeam?window.GGameEntry.BattleRoot.moveBattleCameraToDestInTime(t,1.5):n===o.EntityCampType.RedTeam&&window.GGameEntry.BattleRoot.moveBattleCameraToDestInTime(e,1.5)},Win:function(e,t){window.GGameEntry.GameConfig.winCount++,this.BattleData.isArriveTime=t,this.GameOver(),this.BattleData.BattleState=i.BattleState.Win,this.BattleData.WinReason=e,window.GGameEntry.UIManager.HideUI(a.UIType.BattleUI),window.GGameEntry.UIManager.HideUI(a.UIType.GuideUI),t||this.OnWinCameraMove(),this.scheduleOnce(function(){window.GGameEntry.UIManager.ShowUI(a.UIType.WinUI)},1.5)},Lose:function(e,t){window.GGameEntry.GameConfig.loseCount++,this.BattleData.isArriveTime=t,this.GameOver(),this.BattleData.BattleState=i.BattleState.Lose,this.BattleData.LoseReason=e,window.GGameEntry.UIManager.HideUI(a.UIType.BattleUI),window.GGameEntry.UIManager.HideUI(a.UIType.GuideUI),t||this.OnLoseCameraMove(),this.scheduleOnce(function(){window.GGameEntry.UIManager.ShowUI(a.UIType.LoseUI)},1.5)},Draw:function(){window.GGameEntry.UIManager.HideUI(a.UIType.BattleUI),window.GGameEntry.UIManager.HideUI(a.UIType.GuideUI),this.GameOver(),this.BattleData.BattleState=i.BattleState.Draw,window.GGameEntry.UIManager.ShowUI(a.UIType.PingJuUI)},EnterBattle:function(){var e=u.BeginSample("BattleSystem::EnterBattle");h.pushLog("EnterBattle"),h.sendBatchLog(),c.IsWeichatGame()&&"function"==typeof wx.triggerGC&&wx.triggerGC(),this.ResetBattleData(),window.GGameEntry.GameConfig.init(),window.GGameEntry.SoundManager.PlayStartGame(),this.BattleData.BattleState=i.BattleState.Playing,this.CreateBattle(),u.EndSample(e)},ClearBattle:function(e){var t=u.BeginSample("BattleSystem::ClearBattle");window.GGameEntry.ExitGuide(),window.GGameEntry.MapManager.RelaseMap(),window.GGameEntry.ItemManager.Release(),window.GGameEntry.MonsterManager.ReleaseMonster(),window.GGameEntry.PlayerManager.ReleasePlayer(),window.GGameEntry.BulletManager.ReleaseBullet(),window.GGameEntry.AirDropSystem.Release(),window.GGameEntry.GenerateId.Release(),window.GGameEntry.CollisionObject.Release(),window.GGameEntry.BlockMgr.Release(),window.GGameEntry.EntityManager.Release(),window.GGameEntry.CollisionObject.Release(),window.GGameEntry.BattleItemCacheManager.ReleaseCache(),window.GGameEntry.AnimationManager.release(),window.GGameEntry.SoundManager.GameOver(),e||window.GGameEntry.GCmdMgr.Release(),window.GGameEntry.ResManager.Release(),c.IsWeichatGame()&&"function"==typeof wx.triggerGC&&wx.triggerGC(),u.EndSample(t)},CreateBattle:function(){var e=u.BeginSample("BattleSystem::CreateBattle");window.GGameEntry.ResManager.BeginFPSCheck(),this.BattleData.StartTime=window.GGameEntry.TimeSystem.Now(),window.GGameEntry.CurGamePlayType===r.GamePlayType.GamePlayType_Single?(window.GGameEntry.BattleRoot.SetCameraRotation(this.IsInvertWorld()),window.GGameEntry.MapManager.CreateSinglePlayerMap(this.MapID),window.GGameEntry.PlayerManager.CreatePlayer(),window.GGameEntry.MonsterManager.CreateMonster()):(window.GGameEntry.BattleRoot.SetCameraRotation(this.IsInvertWorld()),window.GGameEntry.MapManager.CreateServerMap()),window.GGameEntry.UIManager.PreLoad(),window.GGameEntry.ItemManager.Init(),window.GGameEntry.BlockMgr.Init(),window.GGameEntry.CollisionObject.Init(),window.GGameEntry.CurGamePlayType===r.GamePlayType.GamePlayType_Single&&this.Pause(!0),u.EndSample(e)},ClearData:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.ClearBattle(),this.ResetBattleData(),window.GGameEntry.BattleRoot.ClearBattleViewTarget();var n=e("loginServerMgr");!0===t&&n.onSetInviteInfo({}),window.GGameEntry.GBattleNetwork.IsConnecting()&&window.GGameEntry.GBattleNetwork.Disconnect(),window.GGameEntry.GameConfig.saveGameConfig()},ExitBattle:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=u.BeginSample("BattleSystem::ExitBattle");this.ClearData(e),window.GGameEntry.UIManager.HideAllActiveUI(),window.GGameEntry.UIManager.ShowUI(a.UIType.LogoUI,a.UIOrder.Top),u.EndSample(t)},FindEntityByGUID:function(e){var t=u.BeginSample("BattleSystem::FindEntityByGUID");switch(Math.floor(e/1e5)){case o.EntityType.EntityBase:case o.EntityType.EntityGround:case o.EntityType.EntitySteel:case o.EntityType.EntityMapBox:case o.EntityType.EntityWater:case o.EntityType.EntityGrass:case o.EntityType.EntityBorder:case o.EntityType.EntityBigAdobe:window.GGameEntry.MapManager.FindEntityByGUID(e);break;case o.EntityType.EntityPlayer:window.GGameEntry.PlayerManager.FindEntityByGUID(e)}u.EndSample(t)},RemoveEntityByGUID:function(e){var t=u.BeginSample("BattleSystem::RemoveEntityByGUID");switch(e/1e5){case o.EntityType.EntityBase:case o.EntityType.EntityGround:case o.EntityType.EntitySteel:case o.EntityType.EntityMapBox:case o.EntityType.EntityWater:case o.EntityType.EntityGrass:case o.EntityType.EntityBorder:case o.EntityType.EntityBigAdobe:window.GGameEntry.MapManager.RemoveEntityByGUID(e);break;case o.EntityType.EntityPlayer:window.GGameEntry.PlayerManager.RemoveEntityByGUID(e)}u.EndSample(t)},update:function(e){window.GGameEntry.gameMobuleInited&&(window.GGameEntry.BattleSystem.IsPlaying()||window.GGameEntry.CurGamePlayType===r.GamePlayType.GamePlayType_Network&&window.GGameEntry.BattleSystem.IsPause())&&(this.updateBattleTime(),this.OfflineBattleUpdate(e))},OfflineBattleUpdate:function(e){if(window.GGameEntry.CurGamePlayType===r.GamePlayType.GamePlayType_Single&&!(this.BattleData.CurrentBattleTime<=this.BattleData.FullBattleTime))if(this.BattleData.BlueKillCount>this.BattleData.RedKillCount){t=window.GGameEntry.ResTableMgr.GetConfigByID(m.star_client_c,4).Context;this.Win(t,!0)}else if(this.BattleData.BlueKillCount<this.BattleData.RedKillCount){t=window.GGameEntry.ResTableMgr.GetConfigByID(m.star_client_c,5).Context;this.Lose(t,!0)}else if(0===this.BattleData.BlueKillCount){t=window.GGameEntry.ResTableMgr.GetConfigByID(m.star_client_c,6).Context;this.Lose(t,!0)}else if(this.BattleData.firstBloodCamp===window.GGameEntry.PlayerManager.Player.EntityCampType){t=window.GGameEntry.ResTableMgr.GetConfigByID(m.star_client_c,7).Context;this.Win(t,!0)}else{var t=window.GGameEntry.ResTableMgr.GetConfigByID(m.star_client_c,8).Context;this.Lose(t,!0)}},updateBattleTime:function(){var e=window.GGameEntry.TimeSystem.Now();this.BattleData.CurrentBattleTime=Math.floor((e-window.GGameEntry.BattleSystem.BattleData.StartTime)/1e3)},checkPositionInScreen:function(e){var t=u.BeginSample("BattleSystem::checkPositionInScreen"),n=window.GGameEntry.MapManager.MapBottomLayer;return e.x-cc.visibleRect.width/2<0&&(e.x=n.width/2),e.x+cc.visibleRect.width/2>n.width&&(e.x=n.width/2),e.y-cc.visibleRect.height/2<0&&(e.y=cc.visibleRect.height/2),e.y+cc.visibleRect.height/2>n.height&&(e.y=n.height-cc.visibleRect.height/2),u.EndSample(t),e},IsInvertWorld:function(){return window.GGameEntry.PlayerManager.PlayerCampType===o.EntityCampType.RedTeam},SetInvertedNode:function(e){if(e){var t=this.IsInvertWorld();e.rotation=t?180:0}},ExitGuideBattle:function(){this.BattleData.BattleState=i.BattleState.Win,window.GGameEntry.SetFinishGuide(),window.GGameEntry.UIManager.HideUI(a.UIType.GuideUI),this.ExitBattle()}}),cc._RF.pop()},{ActivityMsgMgr:"ActivityMsgMgr",BattleDef:"BattleDef",EntityTypeDefine:"EntityTypeDefine",GlobalCfg:"GlobalCfg",PlatformUtil:"PlatformUtil",ResTableNames:"ResTableNames",ServerLog:"ServerLog",TankBase:"TankBase",UIManager:"UIManager",Util:"Util",loginServerMgr:"loginServerMgr",weixinmsgmgr:"weixinmsgmgr"}],BattleUI:[function(e,t,n){"use strict";cc._RF.push(t,"48fc0SBtwRKVYLjZSSLeVkq","BattleUI");var i=e("Util"),a=e("UIManager"),o=e("SimpleLabel"),r=e("GlobalCfg"),s=e("ResTableNames"),l=e("star_table"),c=e("PlatformUtil"),u=new cc.Color(255,230,98);cc.Class({extends:cc.Component,properties:{GameTime:{default:null,type:o,serializable:!0},SelfKill:{default:null,type:o,serializable:!0},EnemyKill:{default:null,type:o,serializable:!0},JoystickSettingBtn:{default:null,type:cc.Button,serializable:!0},ShanHongAnimation:{default:null,type:cc.Animation},IsCountDown:{default:!1,visible:!1},IsShanHong:{default:!1,visible:!1},PVPShanHongAnimation:{default:null,type:cc.Animation},GameOverTime:{default:0,type:cc.Integer},HideAttackRing:{default:null,type:cc.Node},AttackRingBtnSprite:{type:cc.SpriteFrame,default:[]},CameraXFlow:{default:null,type:cc.Node},BackBtnNode:{default:null,type:cc.Node},animationTime:{default:0,visible:!1,serializable:!1},GMBtn:{default:null,type:cc.Node}},onLoad:function(){},onEnable:function(){var e=i.BeginSample("BattleUI::onEnable");this.GameOverTime=0,this.IsCountDown=!1,this.IsShanHong=!1,this.animationTime=0,this.callback=function(){this.UpdateSchedule()},this.schedule(this.callback,1),this.UpdateSchedule(),window.GGameEntry.CurGamePlayType===r.GamePlayType.GamePlayType_Single?(this.BackBtnNode.active=!window.GGameEntry.IsGuiding(),this.scheduleOnce(function(){window.GGameEntry.IsGuiding()?window.GGameEntry.SoundManager.PlayGameBg():window.GGameEntry.SoundManager.PlayPreGameBg()},.5)):this.BackBtnNode.active=!1;var t=window.GGameEntry.BattleSystem.BattleData.FullBattleTime-window.GGameEntry.BattleSystem.BattleData.CurrentBattleTime;t>window.GGameEntry.BattleSystem.BattleData.FullBattleTime&&(t=window.GGameEntry.BattleSystem.BattleData.FullBattleTime),this.GameTime.SetString(t.toString()),window.GGameEntry.NotificationCenter.on("onGameHideCallback",this.OnPause,this),window.GGameEntry.NotificationCenter.on("OnBattleUIKillUpdate",this.updateLabel,this),this.SelfKill.SetString("0"),this.EnemyKill.SetString("0"),this.GameTime.node.color=u,window.GGameEntry.CurGamePlayType===r.GamePlayType.GamePlayType_Single?window.GGameEntry.IsGuiding()||window.GGameEntry.UIManager.ShowUI(a.UIType.TargetDescriptionUI):window.GGameEntry.UIManager.ShowUI(a.UIType.EmoticonUI),window.GGameEntry.NotificationCenter.on("BlockDestory",this.OnBlockDestory,this),window.GGameEntry.NotificationCenter.on("ShowShanHong",this.setShanHong,this),this.HideAttackRing.on(cc.Node.EventType.TOUCH_START,this.onHideAttackRTouch,this),this.CameraXFlow.on(cc.Node.EventType.TOUCH_START,this.onCameraXFlowTouch,this),this.GMBtn.on(cc.Node.EventType.TOUCH_START,this.onGMBtnClick,this),window.GGameEntry.IsGuiding()?(this.HideAttackRing.active=!1,this.CameraXFlow.active=!1):(this.HideAttackRing.active=!0,this.CameraXFlow.active=!1,window.GGameEntry.GameConfig.hideAttackRing?this.HideAttackRing.getComponent(cc.Sprite).spriteFrame=this.AttackRingBtnSprite[1]:this.HideAttackRing.getComponent(cc.Sprite).spriteFrame=this.AttackRingBtnSprite[0],window.GGameEntry.GameConfig.cameraXFlow?this.CameraXFlow.getComponent(cc.Sprite).spriteFrame=this.AttackRingBtnSprite[0]:this.CameraXFlow.getComponent(cc.Sprite).spriteFrame=this.AttackRingBtnSprite[1]),window.GGameEntry.CurGamePlayType===r.GamePlayType.GamePlayType_Network?c.IsWeichatGame()&&!0===GameSettingConfig.Public?this.GMBtn.active=!1:this.GMBtn.active=!0:this.GMBtn.active=!1,i.EndSample(e)},OnPause:function(){255===this.ShanHongAnimation.node.opacity&&this.ShanHongAnimation.stop(),255===this.PVPShanHongAnimation.node.opacity&&this.PVPShanHongAnimation.stop()},updateAnimationTime:function(){var e=window.GGameEntry.TimeSystem.Now(),t=Math.floor((e-window.GGameEntry.BattleSystem.BattleData.StartTime)/1e3),n=window.GGameEntry.BattleSystem.BattleData.FullBattleTime-t;n<0&&(n=0),window.GGameEntry.CurGamePlayType===r.GamePlayType.GamePlayType_Single?this.animationTime=10-n:this.animationTime=30-n,this.animationTime<0&&(this.animationTime=0),this.animationTime>0&&(this.animationTime+=1)},OnResume:function(){this.updateAnimationTime(),255==this.ShanHongAnimation.node.opacity&&0!==this.animationTime&&(this.ShanHongAnimation.play(),this.ShanHongAnimation.setCurrentTime(this.animationTime,"10MiaoDaoJiShi")),255==this.PVPShanHongAnimation.node.opacity&&0!==this.animationTime&&(this.PVPShanHongAnimation.play(),this.PVPShanHongAnimation.setCurrentTime(this.animationTime,"30MDJS"))},OnBlockDestory:function(e){window.GGameEntry.BattleSystem.UpdateBattleBlockData(e.detail.blockCount,e.detail.tankGuid)},updateLabel:function(){this.SelfKill.SetString(window.GGameEntry.BattleSystem.BattleData.BlueKillCount.toString()),this.EnemyKill.SetString(window.GGameEntry.BattleSystem.BattleData.RedKillCount.toString())},onDisable:function(){var e=i.BeginSample("BattleUI::onDisable");this.GameOverTime=0,null!=this.callback&&(this.unschedule(this.callback),this.callback=null),255===this.ShanHongAnimation.node.opacity&&(this.ShanHongAnimation.stop(),this.ShanHongAnimation.node.opacity=0),255===this.PVPShanHongAnimation.node.opacity&&(this.PVPShanHongAnimation.stop(),this.PVPShanHongAnimation.node.opacity=0),0===this.GameTime.node.opacity&&(this.GameTime.node.opacity=255),window.GGameEntry.UIManager.HideUI(a.UIType.BeginCountDownUI),window.GGameEntry.UIManager.HideUI(a.UIType.JoyStickUI),window.GGameEntry.UIManager.HideUI(a.UIType.EmoticonUI),window.GGameEntry.NotificationCenter.off("BlockDestory",this.OnBlockDestory,this),window.GGameEntry.NotificationCenter.off("OnBattleUIKillUpdate",this.updateLabel,this),window.GGameEntry.NotificationCenter.off("ShowShanHong",this.setShanHong,this),window.GGameEntry.NotificationCenter.off("onGameHideCallback",this.OnPause,this),this.GMBtn.off(cc.Node.EventType.TOUCH_START,this.onGMBtnClick,this),this.HideAttackRing.off(cc.Node.EventType.TOUCH_START,this.onHideAttackRTouch,this),this.CameraXFlow.off(cc.Node.EventType.TOUCH_START,this.onCameraXFlowTouch,this),i.EndSample(e)},onHideAttackRTouch:function(){var e=i.BeginSample("BattleUI::onHideAttackRTouch");window.GGameEntry.GameConfig.hideAttackRing?(window.GGameEntry.GameConfig.hideAttackRing=0,this.HideAttackRing.getComponent(cc.Sprite).spriteFrame=this.AttackRingBtnSprite[0]):(window.GGameEntry.GameConfig.hideAttackRing=1,this.HideAttackRing.getComponent(cc.Sprite).spriteFrame=this.AttackRingBtnSprite[1]),window.GGameEntry.NotificationCenter.emit("OnAttackRingHide"),window.GGameEntry.GameConfig.saveGameConfig(),i.EndSample(e)},onCameraXFlowTouch:function(){var e=i.BeginSample("BattleUI::onCameraXFlowTouch");window.GGameEntry.GameConfig.cameraXFlow?(window.GGameEntry.GameConfig.cameraXFlow=0,this.CameraXFlow.getComponent(cc.Sprite).spriteFrame=this.AttackRingBtnSprite[1]):(window.GGameEntry.GameConfig.cameraXFlow=1,this.CameraXFlow.getComponent(cc.Sprite).spriteFrame=this.AttackRingBtnSprite[0]),window.GGameEntry.GameConfig.saveGameConfig(),i.EndSample(e)},onGMBtnClick:function(){window.GGameEntry.GMSystem.curCondition=l.GMConditionType.GM_CON_BATTLE,window.GGameEntry.UIManager.ShowUI(a.UIType.GMPanel,a.UIOrder.Top+100)},onDestroy:function(){},UpdateSchedule:function(e){if(window.GGameEntry.BattleSystem.IsPlaying()||window.GGameEntry.CurGamePlayType===r.GamePlayType.GamePlayType_Network&&window.GGameEntry.BattleSystem.IsPause()){var t=i.BeginSample("BattleUI::UpdateSchedule"),n=window.GGameEntry.BattleSystem.BattleData.FullBattleTime-window.GGameEntry.BattleSystem.BattleData.CurrentBattleTime;if(n<0?n=0:n>window.GGameEntry.BattleSystem.BattleData.FullBattleTime&&(n=window.GGameEntry.BattleSystem.BattleData.FullBattleTime),i.BeginSample("BattleUI:UpdateSchedule"),this.GameTime.SetString(n.toString()),i.EndSample("BattleUI:UpdateSchedule"),window.GGameEntry.BattleSystem.GameReady&&n<=30&&n>0&&0==this.IsShanHong&&window.GGameEntry.CurGamePlayType!==r.GamePlayType.GamePlayType_Single&&this.setShanHong(),n<=10&&n>0){if(this.IsCountDown)return void i.EndSample(t);this.IsCountDown=!0,window.GGameEntry.SoundManager.PlayTenCountDown(10-n),window.GGameEntry.CurGamePlayType===r.GamePlayType.GamePlayType_Single&&this.setShanHong()}if(0===n){var a=Date.now();if(0===this.GameOverTime&&(this.GameOverTime=a),a-this.GameOverTime>=5e3&&window.GGameEntry.CurGamePlayType===r.GamePlayType.GamePlayType_Network){null!=this.callback&&(this.unschedule(this.callback),this.callback=null);var o=window.GGameEntry.ResTableMgr.GetConfigByID(s.star_client_c,64).Context;window.GGameEntry.UIManager.ReturnLogoUI(o)}}i.EndSample(t)}},setShanHong:function(){this.updateAnimationTime();var e=i.BeginSample("BattleUI::setShanHong");this.IsShanHong||(this.IsShanHong=!0,this.GameTime.node.color=cc.Color.RED,window.GGameEntry.CurGamePlayType===r.GamePlayType.GamePlayType_Single?(this.ShanHongAnimation.node.opacity=255,this.ShanHongAnimation.play(),this.GameTime.node.opacity=0):(this.PVPShanHongAnimation.node.opacity=255,this.PVPShanHongAnimation.play(),this.GameTime.node.opacity=0,0!==this.animationTime&&this.PVPShanHongAnimation.setCurrentTime(this.animationTime,"30MDJS")),i.EndSample(e))},OnPauseBtn:function(){window.GGameEntry.BattleSystem.IsPause()?window.GGameEntry.BattleSystem.Resume():(window.GGameEntry.BattleSystem.Pause(),window.GGameEntry.UIManager.ShowUI(a.UIType.PauseUI))},OnShowJoystickSetting:function(){window.GGameEntry.BattleSystem.Pause(),window.GGameEntry.UIManager.ShowUI(a.UIType.JoystickSettingUI)},OnShowGlobalSetting:function(){window.GGameEntry.BattleSystem.Pause(),window.GGameEntry.UIManager.ShowUI(a.UIType.GobalSettingUI)},OnBackBtnClicked:function(){var e=window.GGameEntry.ResTableMgr.GetConfigByID(s.star_client_c,65).Context;window.GGameEntry.UIManager.ShowMsgBox(e,188)}}),cc._RF.pop()},{GlobalCfg:"GlobalCfg",PlatformUtil:"PlatformUtil",ResTableNames:"ResTableNames",SimpleLabel:"SimpleLabel",UIManager:"UIManager",Util:"Util",star_table:"star_table"}],BeginCountDownUI:[function(e,t,n){"use strict";cc._RF.push(t,"983e32DZFtFwrj5iDmQkf5b","BeginCountDownUI");var i=e("UIManager"),a=e("GlobalCfg");cc.Class({extends:cc.Component,properties:{Ani:{default:null,type:cc.Animation,serializable:!0},CountDownNode:{default:null,type:cc.Node},CountDownNumberSprite0:{default:null,type:cc.Sprite},CountDownNumberSprite1:{default:null,type:cc.Sprite},CountDownSpriteFrameList:{default:[],type:cc.SpriteFrame}},onDisable:function(){this.unscheduleAllCallbacks()},onEnable:function(){if(this.unscheduleAllCallbacks(),this.lastTime=-100005,window.GGameEntry.BattleSystem.BattleData.IsBattleBeginCountDownEnd=!1,this.reset(),this.Ani.setCurrentTime(0),this.Ani.play("daojishi_enter"),window.GGameEntry.SoundManager.PlayGameCountDown(),this.Count=3,this.CountDownNode.setPosition(0,0),this.changeCountDown(this.Count-1),window.GGameEntry.CurGamePlayType===a.GamePlayType.GamePlayType_Single){var e=this;this.schedule(function(){e.Count-=1,e.Count>=1?(e.changeCountDown(e.Count-1),window.GGameEntry.SoundManager.PlayGameCountDown()):(e.reset(),window.GGameEntry.BattleSystem.BattleData.IsBattleBeginCountDownEnd=!0,window.GGameEntry.BattleSystem.Resume(!0),window.GGameEntry.SoundManager.PlayGameBg(),window.GGameEntry.NotificationCenter.emit("onGameStart"),window.GGameEntry.UIManager.HideUI(i.UIType.BeginCountDownUI))},1,2,0)}else this.beginCountDownCallBack=function(){var e=window.GGameEntry.BattleSystem.BattleData.CurrentBattleTime;e>=0?this.startGame():this.Count>1&&e!==this.lastTime?(this.Count-=1,this.lastTime=e,this.changeCountDown(this.Count-1),window.GGameEntry.SoundManager.PlayGameCountDown()):this.startGame()},this.schedule(this.beginCountDownCallBack,1)},startGame:function(){this.reset(),window.GGameEntry.BattleSystem.BattleData.IsBattleBeginCountDownEnd=!0,window.GGameEntry.BattleSystem.Resume(!0),window.GGameEntry.SoundManager.PlayGameBg(),window.GGameEntry.NotificationCenter.emit("onGameStart"),window.GGameEntry.PlayerManager.Player&&window.GGameEntry.PlayerManager.Player.node&&window.GGameEntry.BattleRoot.SetBattleViewTarget(window.GGameEntry.PlayerManager.Player.node),this.unscheduleAllCallbacks(),window.GGameEntry.UIManager.HideUI(i.UIType.BeginCountDownUI)},reset:function(){this.CountDownNode.setPosition(-2e3,-2e3);var e=this.CountDownNode.getComponent(cc.Animation);e&&e.stop("DaoJiShiUI")},changeCountDown:function(e){this.CountDownNumberSprite0.node.setPosition(0,0),this.CountDownNumberSprite1.node.setPosition(0,0);var t=this.CountDownNode.getComponent(cc.Animation);t&&(t.stop("DaoJiShiUI"),this.CountDownNumberSprite0.spriteFrame=this.CountDownSpriteFrameList[e],this.CountDownNumberSprite1.spriteFrame=this.CountDownSpriteFrameList[e],t.play("DaoJiShiUI"),0==e&&(window.GGameEntry.NotificationCenter.emit("CountDownZero"),this.CountDownNumberSprite0.node.setPosition(-4,0),this.CountDownNumberSprite1.node.setPosition(-4,0)))}}),cc._RF.pop()},{GlobalCfg:"GlobalCfg",UIManager:"UIManager"}],BevAction:[function(e,t,n){"use strict";cc._RF.push(t,"5c3e2CGdXVBNYfe6KFBacHh","BevAction");var i=e("BevTask"),a=e("StatusReturn"),o=e("TaskStatus");cc.Class({name:"BevAction",extends:i,properties:{returnFlag:0},OnReturn:function(e){if(this.returnFlag==a.None||e==o.Running)return e;if(this.returnFlag==a.Failure)return o.Failure;if(this.returnFlag==a.Success)return o.Success;if(this.returnFlag==a.Invert){if(e==o.Failure)return o.Success;if(e==o.Success)return o.Failure}return e}}),cc._RF.pop()},{BevTask:"BevTask",StatusReturn:"StatusReturn",TaskStatus:"TaskStatus"}],BevComposite:[function(e,t,n){"use strict";cc._RF.push(t,"432e2jE695As7YI5X3e5eAU","BevComposite");var i=e("BevTask"),a=cc.Class({extends:i,name:"BevComposite",properties:{abortType:0,reevalueStack:{default:[],serializable:!1,visible:!1},tempStack:{default:[],serializable:!1,visible:!1}},ResetIndex:function(){this._super(),this.reevalueStack.length>0&&this.reevalueStack.splice(0,this.reevalueStack.length),this.tempStack.length>0&&this.tempStack.splice(0,this.tempStack.length)}});t.exports=a,cc._RF.pop()},{BevTask:"BevTask"}],BevCond:[function(e,t,n){"use strict";cc._RF.push(t,"a08cfwUVoFFo4KLAI0Lqnwc","BevCond");var i=e("BevTask"),a=e("StatusReturn"),o=e("TaskStatus");cc.Class({name:"BevCond",extends:i,properties:{returnFlag:0},OnReturn:function(e){if(e==o.Running)return console.error("condition node can not return running state"),e;if(this.returnFlag==a.None)return e;if(this.returnFlag==a.Failure)return o.Failure;if(this.returnFlag==a.Success)return o.Success;if(this.returnFlag==a.Invert){if(e==o.Failure)return o.Success;if(e==o.Success)return o.Failure}return e}}),cc._RF.pop()},{BevTask:"BevTask",StatusReturn:"StatusReturn",TaskStatus:"TaskStatus"}],BevTask:[function(e,t,n){"use strict";cc._RF.push(t,"b97f07beWVBY65bsUtsNF8q","BevTask");var i=e("TaskStatus");cc.Class({name:"BevTask",properties:{ID:0,Children:{default:[]},index:{default:0,serializable:!1,visible:!1},bevTree:{default:null,serializable:!1,visible:!1}},ResetIndex:function(){this.index=0},OnStart:function(){},OnExcute:function(){return i.Success},OnEnd:function(){},OnInterupt:function(){},OnReturn:function(e){return e},GetChildrenIndex:function(){return 0==this.Children.length||this.index>=this.Children.length?-1:this.index},OnChildrenExcuted:function(e){this.index++}}),cc._RF.pop()},{TaskStatus:"TaskStatus"}],BlockDisappear:[function(e,t,n){"use strict";cc._RF.push(t,"1f433tcpZFN+aXmFnnQVfxW","BlockDisappear");var i=e("Skill"),a=(e("BlockMgr"),e("EntityTypeDefine"),e("Util")),o=e("ResTableNames");cc.Class({extends:i,properties:{},onLoad:function(){},UseSkill:function(e){var t=a.BeginSample("BlockDisappear::UseSkill");if(this.EntitySource){var n=[],i=window.GGameEntry.ResTableMgr.GetTableByName(o.star_map_erase_s);if(i&&i.length>0)for(var r=0;r<i.length;r++)a.TableStr2Num(i[r].ID)===window.GGameEntry.BattleSystem.MapID&&(n[n.length]=cc.v2(a.TableStr2Num(i[r].X),a.TableStr2Num(i[r].Y)));for(var s=0;s<n.length;s++)for(var l=window.GGameEntry.BlockMgr.GetSmallGridPos(n[s].x,n[s].y),c=0;c<l.length;c++){var u=l[c];u&&u.OnDie()}}a.EndSample(t)}}),cc._RF.pop()},{BlockMgr:"BlockMgr",EntityTypeDefine:"EntityTypeDefine",ResTableNames:"ResTableNames",Skill:"Skill",Util:"Util"}],BlockMgr:[function(e,t,n){"use strict";cc._RF.push(t,"da8b9hPKs5DN5DJiC/QANc4","BlockMgr");e("BulletBase");var i=e("BulletThrough"),a=e("Bullet"),o=(e("MapManager"),e("EntityTypeDefine")),r=e("MapCfg"),s=e("GlobalCfg"),l=e("BulletAddHp"),c=e("Util");cc.Class({extends:cc.Component,properties:{currentIndex:{default:0,serializable:!1,visible:!1}},onLoad:function(){this.addIndex()},addIndex:function(){return this.currentIndex=this.currentIndex+1,this.currentIndex},getIndex:function(){var e=this.currentIndex;return this.addIndex(),e},Release:function(){this.currentIndex=0,this.addIndex(),this.map={}},getBlock:function(e){return this.map[e]},getBlockByPosition:function(e,t){var n=c.BeginSample("BlockMgr::getBlockByPosition"),i=1e4*(Math.floor(e/window.GGameEntry.MapManager.GridSize)*window.GGameEntry.MapManager.GridSize)+Math.floor(t/window.GGameEntry.MapManager.GridSize)*window.GGameEntry.MapManager.GridSize;return c.EndSample(n),this.map[i]},Init:function(){this.preMap()},isBlock:function(e,t){var n=c.BeginSample("BlockMgr::isBlock"),i=1e4*(Math.floor(e/window.GGameEntry.MapManager.GridSize)*window.GGameEntry.MapManager.GridSize)+Math.floor(t/window.GGameEntry.MapManager.GridSize)*window.GGameEntry.MapManager.GridSize;return c.EndSample(n),this.map[i]},RaycastMapdata:function(e,t){for(var n=c.BeginSample("BlockMgr::RaycastMapdata"),i=c.GetGridPos(e.x,e.y,t.x,t.y),a=this.GridWidth*r.MapGlobalCfg.MapTileSize[0],s=0;s<i.length;s++){var l=i[s],u=this.MapData[l[0]+l[1]*a],d=o.GetEntityTypeFromResID(u);if(d===o.EntityType.EntityAdobe||d===o.EntityType.EntitySteel)return c.EndSample(n),!1}return c.EndSample(n),!0},isInWaterAndBorder:function(e,t){var n=c.BeginSample("BlockMgr::isInWaterAndBorder"),i=Math.floor(e/window.GGameEntry.MapManager.GridSize),a=Math.floor(t/window.GGameEntry.MapManager.GridSize),s=window.GGameEntry.MapManager.GridWidth*r.MapGlobalCfg.MapTileSize[0],l=window.GGameEntry.MapManager.MapData[i+a*s],u=o.GetEntityTypeFromResID(l);return u===o.EntityType.EntityBase||u===o.EntityType.EntityWater||u===o.EntityType.EntityBorder?(c.EndSample(n),!0):(c.EndSample(n),!1)},isCanWalk:function(e,t){var n=c.BeginSample("BlockMgr::isCanWalk"),i=window.GGameEntry.MapManager.GetBattleFieldRect();if(e<i.xMin||e>i.xMax)return c.EndSample(n),!1;if(t<i.yMin||t>i.yMax)return c.EndSample(n),!1;var a=this.getBlockByPosition(e,t);if(a&&!a.DeadAni){if(cc.rect(a.node.x-a.node.width/2,a.node.y-a.node.height/2,a.node.width,a.node.height).contains(cc.v2(e,t)))return c.EndSample(n),!1;c.AssertCheck(!1,"土块不对 土块X"+a.node.x+"土块Y"+a.node.y)}var s=Math.floor(e/window.GGameEntry.MapManager.GridSize),l=Math.floor(t/window.GGameEntry.MapManager.GridSize),u=window.GGameEntry.MapManager.GridWidth*r.MapGlobalCfg.MapTileSize[0],d=window.GGameEntry.MapManager.MapData[s+l*u],h=o.GetEntityTypeFromResID(d);return h===o.EntityType.EntityBase||h===o.EntityType.EntityWater||h===o.EntityType.EntityNoBroken||h===o.EntityType.EntityMapBox||h===o.EntityType.EntityBorder?(c.EndSample(n),!1):(c.EndSample(n),!0)},removeEntity:function(e){this.getBlock(e)?(this.map[e]=null,window.GGameEntry.CollisionObject.addMsg("remove block id: "+e)):window.GGameEntry.CollisionObject.addMsg("not find block id: "+e)},GetSmallGridPos:function(e,t){var n=c.BeginSample("BlockMgr::GetSmallGridPos"),i=e*window.GGameEntry.MapManager.GridSize*2,a=t*window.GGameEntry.MapManager.GridSize*2,o=[],r=1e4*i+a,s=this.getBlock(r);return s&&(o[o.length]=s),r=1e4*(i+this.getSmallGirdWidth())+a,(s=this.getBlock(r))&&(o[o.length]=s),r=1e4*i+a+this.getSmallGirdWidth(),(s=this.getBlock(r))&&(o[o.length]=s),r=1e4*(i+this.getSmallGirdWidth())+a+this.getSmallGirdWidth(),(s=this.getBlock(r))&&(o[o.length]=s),c.EndSample(n),o},getBlockFromPosition:function(e){var t=c.BeginSample("BlockMgr::getBlockFromPosition"),n=1e4*(Math.floor(e.x/this.getSmallGirdWidth())*this.getSmallGirdWidth())+Math.floor(e.y/this.getSmallGirdWidth())*this.getSmallGirdWidth(),i=this.getBlock(n);if(i)return c.EndSample(t),i;c.EndSample(t)},getSmallGirdWidth:function(){return window.GGameEntry.MapManager.GridSize},getSmallAnchorOffset:function(){return window.GGameEntry.MapManager.GridSize/2},getBlockFromRect:function(e,t,n){var i=c.BeginSample("BlockMgr::getBlockFromPosition"),a=cc.v2(e.x-e.width/2,e.y-e.height/2),o=cc.v2(e.x-e.width/2,e.y+e.height/2),r=cc.v2(e.x+e.width/2,e.y+e.height/2),s=cc.v2(e.x+e.width/2,e.y-e.height/2);Math.abs(t)>Math.abs(n)?t>0?(this.pointArray[0]=o,this.pointArray[1]=r,this.pointArray[2]=a,this.pointArray[3]=s):(this.pointArray[0]=r,this.pointArray[1]=o,this.pointArray[2]=s,this.pointArray[3]=a):n>0?(this.pointArray[0]=a,this.pointArray[1]=o,this.pointArray[2]=r,this.pointArray[3]=s):(this.pointArray[0]=o,this.pointArray[1]=a,this.pointArray[2]=r,this.pointArray[3]=s);for(var l=0;l<this.pointArray.length;l++){var u=this.pointArray[l],d=1e4*(Math.floor(u.x/this.getSmallGirdWidth())*this.getSmallGirdWidth())+Math.floor(u.y/this.getSmallGirdWidth())*this.getSmallGirdWidth(),h=this.getBlock(d);if(h&&!h.DeadAni)return c.EndSample(i),h}c.EndSample(i)},isSmallCollisionAdobe:function(e,t,n){var i=c.BeginSample("BlockMgr::isSmallCollisionAdobe"),a=new cc.Rect(n.node.x-n.node.anchorX*n.node.width,n.node.y-n.node.anchorY*n.node.height,n.node.width,n.node.height),o=this.rectCollisioWithSigment(a,e,t);return o?(c.EndSample(i),o):(c.EndSample(i),!1)},preMap:function(){this.map||(this.map={}),this.pointArray||(this.pointArray=[])},insertBlockMap:function(e,t){this.preMap(),this.map[e]=t},destorySmallCollisionAdobeArea:function(e,t,n,r){var u=c.BeginSample("BlockMgr::destorySmallCollisionAdobeArea");if(t){if((e instanceof a||e instanceof l)&&t.EntityType==o.EntityType.EntitySteel)return window.GGameEntry.SoundManager.PlayHitNoDamage(e.node.position),void c.EndSample(u);var d=r.sub(n),h=t.node.x-this.getSmallAnchorOffset(),f=t.node.y-this.getSmallAnchorOffset(),m=[],y=1e4*h+f;m[m.length]=y;var p=Math.abs(d.y)<Math.abs(d.x);if(e instanceof a||e instanceof l)if(p){G=1e4*h+f+this.getSmallGirdWidth();m[m.length]=G;S=1e4*h+f-this.getSmallGirdWidth();m[m.length]=S}else{G=1e4*(h+this.getSmallGirdWidth())+f;m[m.length]=G;S=1e4*(h-this.getSmallGirdWidth())+f;m[m.length]=S}else if(e instanceof i){var g=window.GGameEntry.MathUtil.sin(e.node.rotation),C=window.GGameEntry.MathUtil.cos(e.node.rotation);if(p){G=1e4*h+f+this.getSmallGirdWidth();m[m.length]=G;S=1e4*h+f-this.getSmallGirdWidth();m[m.length]=S;E=this.getSmallGirdWidth();g<0&&(E=-this.getSmallGirdWidth());T=1e4*(h+E)+f;m[m.length]=T;w=1e4*(h+E)+f+this.getSmallGirdWidth();m[m.length]=w;M=1e4*(h+E)+f-this.getSmallGirdWidth();m[m.length]=M}else{var G=1e4*(h+this.getSmallGirdWidth())+f;m[m.length]=G;var S=1e4*(h-this.getSmallGirdWidth())+f;m[m.length]=S;var E=this.getSmallGirdWidth();C<0&&(E=-this.getSmallGirdWidth());var T=1e4*h+f+E;m[m.length]=T;var w=1e4*(h+this.getSmallGirdWidth())+f+E;m[m.length]=w;var M=1e4*(h-this.getSmallGirdWidth())+f+E;m[m.length]=M}}var _=[],I=this.getBlock(m[1]),B=this.getBlock(m[2]);if(e instanceof a||e instanceof l)if(this.getBlock(m[0]).EntityType===o.EntityType.EntityAdobe&&(_[0]=this.getBlock(m[0])),I&&B)if(I.EntityType===o.EntityType.EntityAdobe&&B.EntityType===o.EntityType.EntityAdobe){var v=I.node.x,P=I.node.y,R=B.node.x,A=B.node.y,D=cc.v2(e.node.x,e.node.y).sub(cc.v2(v,P)).mag(),b=cc.v2(e.node.x,e.node.y).sub(cc.v2(R,A)).mag();_[1]=D<b?this.getBlock(m[1]):this.getBlock(m[2])}else I.EntityType===o.EntityType.EntityAdobe?_[1]=this.getBlock(m[1]):B.EntityType===o.EntityType.EntityAdobe&&(_[1]=this.getBlock(m[2]));else I?I.EntityType===o.EntityType.EntityAdobe&&(_[1]=this.getBlock(m[1])):B&&B.EntityType===o.EntityType.EntityAdobe&&(_[1]=this.getBlock(m[2]));else{if(_[0]=this.getBlock(m[0]),I&&B)if(I.EntityType!==o.EntityType.EntityAdobe&&I.EntityType!==o.EntityType.EntitySteel||B.EntityType!==o.EntityType.EntityAdobe&&B.EntityType!==o.EntityType.EntitySteel)I.EntityType===o.EntityType.EntityAdobe||I.EntityType===o.EntityType.EntitySteel?(I.EntityType===o.EntityType.EntitySteel&&(_[1]=this.getBlock(m[1])),I.EntityType===o.EntityType.EntityAdobe&&(_[1]=this.getBlock(m[1]),this.getBlock(m[4])&&(_[2]=this.getBlock(m[4])))):B.EntityType!==o.EntityType.EntityAdobe&&B.EntityType!==o.EntityType.EntitySteel||(B.EntityType===o.EntityType.EntitySteel&&(_[1]=this.getBlock(m[2])),B.EntityType===o.EntityType.EntityAdobe&&(_[1]=this.getBlock(m[2]),this.getBlock(m[5])&&(_[2]=this.getBlock(m[5]))));else{var v=I.node.x,P=I.node.y,R=B.node.x,A=B.node.y;(D=cc.v2(e.node.x,e.node.y).sub(cc.v2(v,P)).mag())<(b=cc.v2(e.node.x,e.node.y).sub(cc.v2(R,A)).mag())?(I.EntityType===o.EntityType.EntitySteel&&(_[1]=this.getBlock(m[1])),I.EntityType===o.EntityType.EntityAdobe&&(_[1]=this.getBlock(m[1]),this.getBlock(m[4])&&(_[2]=this.getBlock(m[4])))):(B.EntityType===o.EntityType.EntitySteel&&(_[1]=this.getBlock(m[2])),B.EntityType===o.EntityType.EntityAdobe&&(_[1]=this.getBlock(m[2]),this.getBlock(m[5])&&(_[2]=this.getBlock(m[5]))))}else I?(I.EntityType===o.EntityType.EntitySteel&&(_[1]=this.getBlock(m[1])),I.EntityType===o.EntityType.EntityAdobe&&(_[1]=this.getBlock(m[1]),this.getBlock(m[4])&&(_[2]=this.getBlock(m[4])))):B&&(B.EntityType===o.EntityType.EntitySteel&&(_[1]=this.getBlock(m[2])),B.EntityType===o.EntityType.EntityAdobe&&(_[1]=this.getBlock(m[2]),this.getBlock(m[5])&&(_[2]=this.getBlock(m[5]))));var U=this.getBlock(m[0]);U&&U.EntityType===o.EntityType.EntityAdobe&&this.getBlock(m[3])&&(_[_.length]=this.getBlock(m[3]))}if(window.GGameEntry.CurGamePlayType===s.GamePlayType.GamePlayType_Single){for(var L=0,N=0;N<_.length;N++)(O=_[N])&&(L++,O.OnDie());window.GGameEntry.NotificationCenter.emit("BlockDestory",{blockCount:L,tankGuid:e.tankGuid})}else{for(var k=[],N=0;N<_.length;N++){var O=_[N];O&&(O.PreDeath=!0,k[k.length]=O.GetGuid())}e.onHitEffect(e.EntitySource.GetGuid(),k)}if(m.length)return c.EndSample(u),!0}return c.EndSample(u),!1},rectCollisioWithSigment:function(e,t,n){if(e.contains(t)||e.contains(n))return!0;var i=cc.v2(e.x,e.y),a=cc.v2(e.x+e.width,e.y),o=cc.v2(e.x,e.y+e.height),r=cc.v2(e.x+e.width,e.y+e.height);return window.GGameEntry.CollisionObject.segmentsIntr(t,n,i,a)||window.GGameEntry.CollisionObject.segmentsIntr(t,n,i,o)||window.GGameEntry.CollisionObject.segmentsIntr(t,n,r,a)||window.GGameEntry.CollisionObject.segmentsIntr(t,n,r,o)}}),cc._RF.pop()},{Bullet:"Bullet",BulletAddHp:"BulletAddHp",BulletBase:"BulletBase",BulletThrough:"BulletThrough",EntityTypeDefine:"EntityTypeDefine",GlobalCfg:"GlobalCfg",MapCfg:"MapCfg",MapManager:"MapManager",Util:"Util"}],BtnSound:[function(e,t,n){"use strict";cc._RF.push(t,"854bf9v5vBG1r/R6ri0iEDf","BtnSound");e("Util");cc.Class({extends:cc.Component,properties:{Btn:{default:null,type:cc.Button,serializable:!1,visible:!1}},onLoad:function(){if(this.Btn=this.node.getComponent("cc.Button"),null!=this.Btn){this.ExtraEventIndex=this.Btn.clickEvents.length;var e=new cc.Component.EventHandler;e.target=this.node,e.component="BtnSound",e.handler="PlayerSound",e.customEventData="",this.Btn.clickEvents[this.ExtraEventIndex]=e}else cc.error("component not found")},onDestroy:function(){null!=this.ExtraEventIndex&&null!=this.Btn&&this.ExtraEventIndex>=0&&this.ExtraEventIndex<this.Btn.clickEvents.length&&this.Btn.clickEvents.splice(this.ExtraEventIndex,1)},PlayerSound:function(){window.GGameEntry.SoundManager.PlayBtnEff()}}),cc._RF.pop()},{Util:"Util"}],BuffAddSpeed:[function(e,t,n){"use strict";cc._RF.push(t,"0b0e2D8LWZOjIFAqkMFk4Kh","BuffAddSpeed");var i=e("BuffBase");e("Util");cc.Class({extends:i,properties:{defaultSpeed:0},execute:function(e){if(this._super(e),void 0!==e.CfgSourceConfigSpeed&&this.param&&this.param.length>0){var t=this.param[0];t>0&&(this.defaultSpeed=e.CfgSourceConfigSpeed,e.CfgSourceConfigSpeed+=t,this.defaultSpeed=e.CfgSourceConfigSpeed-this.defaultSpeed)}e.MotionStreak&&(e.MotionStreak.reset(),e.MotionStreak.enabled=!0)},update:function(e){this._super(e)},release:function(){this.entity&&void 0!==this.entity.CfgSourceConfigSpeed&&(this.entity.CfgSourceConfigSpeed-=this.defaultSpeed),this.entity&&this.entity.MotionStreak&&(this.entity.MotionStreak.enabled=!1,this.entity.MotionStreak.reset()),this._super()}}),cc._RF.pop()},{BuffBase:"BuffBase",Util:"Util"}],BuffAlpha:[function(e,t,n){"use strict";cc._RF.push(t,"a905878AjpOX566blaN5Bkz","BuffAlpha");var i=e("BuffBase");e("BuffDefine"),e("Util");cc.Class({extends:i,properties:{},execute:function(e){this._super(e),this.oldAlpha=e.node.opacity,e.EntityCampCampType!==window.GGameEntry.PlayerManager.Player.EntityCampCampType&&(e.node.opacity=0)},update:function(e){this._super(e)},release:function(){entity.EntityCampCampType!==window.GGameEntry.PlayerManager.Player.EntityCampCampType&&(entity.node.opacity=this.oldAlpha),this._super()}}),cc._RF.pop()},{BuffBase:"BuffBase",BuffDefine:"BuffDefine",Util:"Util"}],BuffAttr:[function(e,t,n){"use strict";cc._RF.push(t,"bfff2zk7C5MZ7hgw67yXmBS","BuffAttr");var i=e("BuffBase"),a=e("star_comm");e("Util");cc.Class({extends:i,properties:{attrType:{default:null},defaultValue:{default:null}},execute:function(e){this._super(e),this.effectConfig&&(this.attrType=this.effectConfig[0],this.changeAttr(this.attrType))},update:function(e){this._super(e)},release:function(){this.resetAttr(this.attrType),this._super()},changeAttr:function(e){if(this.entity){var t=0!=this.effectConfig[1];if(e==a.AttrType.ATTR_HP){if(this.entity.Hp&&(this.defaultValue=this.entity.Hp,t?this.entity.Hp+=this.effectConfig[1]:this.entity.Hp=this.effectConfig[2],this.entity.Hp>this.entity.MaxHp&&(this.entity.Hp=this.entity.MaxHp),this.entity.TankHpControl)){var n=this.entity.Hp/this.entity.MaxHp;this.entity.TankHpControl.scaleX=n}}else e==a.AttrType.ATTR_MAX_HP?this.entity.MaxHp&&(this.defaultValue=this.entity.MaxHp,t?this.entity.MaxHp+=this.effectConfig[1]:this.entity.MaxHp=this.effectConfig[2]):e==a.AttrType.ATTR_SPEED?this.entity.CfgSourceConfigSpeed&&(this.defaultValue=this.entity.CfgSourceConfigSpeed,t?this.entity.CfgSourceConfigSpeed+=this.effectConfig[1]:this.entity.CfgSourceConfigSpeed=this.effectConfig[2],this.defaultValue=this.entity.CfgSourceConfigSpeed-this.defaultValue):e==a.AttrType.ATTR_BULLET_FILL_UP_LIMIT?this.entity.CfgBulletLeftNum&&this.entity.CurrentBulletLeftNum&&(this.defaultValue=this.entity.CfgBulletLeftNum,t?this.entity.CfgBulletLeftNum+=this.effectConfig[1]:this.entity.CfgBulletLeftNum=this.effectConfig[2],this.entity.CurrentBulletLeftNum+=this.entity.CfgBulletLeftNum-this.defaultValue,this.entity.TankUI&&this.entity.TankUI.InitTankBullet(this.entity.CfgBulletLeftNum,this.entity.CurrentBulletLeftNum)):e==a.AttrType.ATTR_BULLET_FILL_INTERVAL&&this.entity.CfgBulletFillTime&&(this.defaultValue=this.entity.CfgBulletFillTime,t?this.entity.CfgBulletFillTime+=this.effectConfig[1]:this.entity.CfgBulletFillTime=this.effectConfig[2])}},resetAttr:function(e){if(this.entity)if(e==a.AttrType.ATTR_HP);else if(e==a.AttrType.ATTR_MAX_HP)this.entity.MaxHp&&(this.entity.MaxHp=this.defaultValue,this.entity.Hp>this.entity.MaxHp&&(this.entity.Hp=this.entity.MaxHp));else if(e==a.AttrType.ATTR_SPEED)this.entity.CfgSourceConfigSpeed&&(this.entity.CfgSourceConfigSpeed-=this.defaultValue);else if(e==a.AttrType.ATTR_BULLET_FILL_UP_LIMIT){if(this.entity.CfgBulletLeftNum&&this.entity.CurrentBulletLeftNum){var t=this.entity.CfgBulletLeftNum;this.entity.CfgBulletLeftNum=this.defaultValue,this.entity.CurrentBulletLeftNum+=this.entity.CfgBulletLeftNum-t,this.entity.TankUI&&this.entity.TankUI.InitTankBullet(this.entity.CfgBulletLeftNum,this.entity.CurrentBulletLeftNum)}}else e==a.AttrType.ATTR_BULLET_FILL_INTERVAL&&this.entity.CfgBulletFillTime&&(this.entity.CfgBulletFillTime=this.defaultValue)}}),cc._RF.pop()},{BuffBase:"BuffBase",Util:"Util",star_comm:"star_comm"}],BuffBase:[function(e,t,n){"use strict";cc._RF.push(t,"a8127IcJXpCorUZ8H2XRrZs","BuffBase");var i=e("BuffDefine"),a=e("ResTableNames"),o=e("UIManager"),r=e("GlobalCfg");e("Util");cc.Class({properties:{buffID:{default:0,serializable:!1,visible:!1},buffEffectID:{default:0},buffType:{default:i.BuffType.BuffType_Immediate,type:i.BuffType},buffTime:{default:0,serializable:!1,visible:!1},executeTime:{default:0,serializable:!1,visible:!1},shouldRelease:{default:!1,serializable:!1,visible:!1},entity:{default:null,serializable:!1,visible:!1},lastTime:{default:0},buffAnimation:{default:null},animationName:{default:""},param:{default:new Array},animationZIndex:{default:o.UIOrder.Animation},buffGroup:{default:0},buffPri:{default:0},effectConfig:{default:new Array},effectResource:{default:""}},init:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.buffID=e,this.buffEffectID=t;var n=window.GGameEntry.ResTableMgr.GetConfigByID(a.star_buff_cs,e);if(n){if(this.buffTime=n.Time/1e3,this.lastTime=0,this.buffGroup=parseInt(n.BuffGroup),this.buffPri=parseInt(n.Priority),"string"==typeof n.Resource&&(l=n.Resource.split("/"))&&(this.animationName=l[l.length-1]),"string"==typeof n.Param)for(var o=n.Param.split(" "),r=0;r<o.length;r++)this.param.push(parseInt(o[r]));if(0!=this.buffEffectID&&n.Effects){var s=this.buffEffectID-1;if(s<n.Effects.length){for(var o=n.Effects[s].Param.split(" "),r=0;r<o.length;r++)this.effectConfig.push(parseInt(o[r]));if(0==this.effectConfig[3]?this.buffType=i.BuffType.BuffType_Immediate:this.buffType=i.BuffType.BuffType_Delay,"string"==typeof n.Effects[s].Resource){if(this.effectResource=n.Effects[s].Resource,-1!=n.Effects[s].Resource.indexOf("|"))return;var l=n.Effects[s].Resource.split("/");l&&(this.animationName=l[l.length-1])}}}}},execute:function(e){this.entity=e;var t=0;if(window.GGameEntry.BattleSystem.IsInvertWorld()&&(t=180),""!=this.animationName){var n=window.GGameEntry.AnimationManager.getAnimationAtPosition(this.animationName,e.node.parent,e.node.position,t,this.animationZIndex);if(n){var i=n.getComponent("DynamicAnimation");i&&(i.entity=e,this.buffAnimation=i)}}},update:function(e){if(this.buffAnimation&&this.entity){var t=this.entity.node.position,n=0;this.entity.GetRotation&&(n=this.entity.GetRotation()),this.buffAnimation.animationUpdate(t,n)}this.buffTime<0||(this.lastTime+=e,window.GGameEntry.CurGamePlayType===r.GamePlayType.GamePlayType_Single&&this.lastTime>this.buffTime&&(this.release(),this.shouldRelease=!0))},release:function(){this.buffAnimation&&this.buffAnimation.releaseAnimation(),this.buffAnimation=null,this.entity=null},reset:function(){this.lastTime=0,this.buffAnimation&&this.buffAnimation.replayAnimation&&this.buffAnimation.replayAnimation()}}),cc._RF.pop()},{BuffDefine:"BuffDefine",GlobalCfg:"GlobalCfg",ResTableNames:"ResTableNames",UIManager:"UIManager",Util:"Util"}],BuffBulletChange:[function(e,t,n){"use strict";cc._RF.push(t,"9d4d0r4CEdNAajJRg09h0Uw","BuffBulletChange");var i=e("BuffBase");e("Util");cc.Class({extends:i,properties:{defaultValue:{default:null}},execute:function(e){this._super(e),this.entity.changeBulletId&&(this.defaultValue=this.entity.ShootBulletId,this.entity.BufferId=this.buffID,this.entity.changeBulletId(this.effectConfig[0]))},update:function(e){this._super(e)},release:function(){this.entity&&this.entity.changeBulletId&&(this.entity.changeBulletId(this.defaultValue),this.entity.BufferId=0),this._super()}}),cc._RF.pop()},{BuffBase:"BuffBase",Util:"Util"}],BuffBulletDistance:[function(e,t,n){"use strict";cc._RF.push(t,"3264ap8culAEI4+PXLVY83k","BuffBulletDistance");var i=e("BuffBase");e("Util");cc.Class({extends:i,properties:{},execute:function(e){if(this._super(e),void 0!==e.BulletMaxDistance&&this.param&&this.param.length>0){var t=this.param[0];t>0&&(e.BulletMaxDistance=t)}},update:function(e){this._super(e)},release:function(){this.entity&&void 0!==this.entity.BulletMaxDistance&&(this.entity.BulletMaxDistance=0),this._super()}}),cc._RF.pop()},{BuffBase:"BuffBase",Util:"Util"}],BuffBulletFillUp:[function(e,t,n){"use strict";cc._RF.push(t,"d7123NesJBHpIQnKCxj/oUa","BuffBulletFillUp");var i=e("BuffBase");e("Util");cc.Class({extends:i,properties:{defaultTime:0},execute:function(e){if(this._super(e),void 0!==e.CfgBulletFillTime&&this.param&&this.param.length>0){var t=this.param[0];t>0&&(this.defaultTime=e.CfgBulletFillTime,e.CfgBulletFillTime=t)}},update:function(e){this._super(e)},release:function(){this.entity&&void 0!==this.entity.CfgBulletFillTime&&this.defaultTime>0&&(this.entity.CfgBulletFillTime=this.defaultTime),this._super()}}),cc._RF.pop()},{BuffBase:"BuffBase",Util:"Util"}],BuffBulletSpeedUp:[function(e,t,n){"use strict";cc._RF.push(t,"9af52cv3xVNqp9sbTAp4VUg","BuffBulletSpeedUp");var i=e("BuffBase");e("Util");cc.Class({extends:i,properties:{},execute:function(e){if(this._super(e),void 0!==e.BulletSpeed&&this.param&&this.param.length>0){var t=this.param[0];t>0&&(e.BulletSpeed=t)}},update:function(e){this._super(e)},release:function(){this.entity&&void 0!==this.entity.BulletSpeed&&(this.entity.BulletSpeed=0),this._super()}}),cc._RF.pop()},{BuffBase:"BuffBase",Util:"Util"}],BuffBulletUp:[function(e,t,n){"use strict";cc._RF.push(t,"73b18Dcuv5Hi6+O5PLnfmeH","BuffBulletUp");var i=e("BuffBase"),a=e("Util");cc.Class({extends:i,properties:{defaultBullet:0},execute:function(e){if(a.BeginSample("BuffBulletUp::execute"),this._super(e),void 0!==e.CfgBulletLeftNum&&void 0!==e.CurrentBulletLeftNum){if(this.param&&this.param.length>0){var t=this.param[0];t>0&&(this.defaultBullet=e.CfgBulletLeftNum,e.CfgBulletLeftNum+=t,e.CurrentBulletLeftNum+=t)}void 0!==e.TankUI&&e.TankUI.InitTankBullet(e.CfgBulletLeftNum,e.CurrentBulletLeftNum)}a.EndSample("BuffBulletUp::execute")},update:function(e){this._super(e)},release:function(){this._super()}}),cc._RF.pop()},{BuffBase:"BuffBase",Util:"Util"}],BuffChangeBullet:[function(e,t,n){"use strict";cc._RF.push(t,"96706Jm2apGMaLVNbPDgfh4","BuffChangeBullet");var i=e("BuffBase");e("AIMapUtil"),e("Util");cc.Class({extends:i,properties:{BulletId:{default:0,serializable:!1,visible:!1}},execute:function(e){this._super(e),void 0!==e.BufferId&&(this.oldBulletId=e.ShootBulletId,e.BufferId=this.buffID,this.entity.changeBulletId(this.BulletId))},update:function(e){this._super(e)},release:function(){this.entity&&this.oldBulletId&&(this.entity.changeBulletId(this.oldBulletId),this.entity.BufferId=0),this._super()}}),cc._RF.pop()},{AIMapUtil:"AIMapUtil",BuffBase:"BuffBase",Util:"Util"}],BuffDefine:[function(e,t,n){"use strict";cc._RF.push(t,"f84abllLRFGE6mHd+z18pph","BuffDefine");var i=cc.Enum({BuffType_None:0,BuffType_Immediate:1,BuffType_Delay:2});t.exports={BuffType:i},cc._RF.pop()},{}],BuffEffectFactory:[function(e,t,n){"use strict";cc._RF.push(t,"2a07bWnQk1MqqWYY1pYggtr","BuffEffectFactory");var i=e("BuffAttr"),a=e("BuffFlashGet"),o=e("BuffBulletChange"),r=e("BuffFlashExecute"),s=e("ResTableNames"),l=(e("star_table"),e("BuffInvisibleGet")),c=e("BuffInvisibleExecute");e("Util");t.exports={GetBuffEffectList:function(e){var t=window.GGameEntry.ResTableMgr.GetConfigByID(s.star_buff_cs,e),n=new Array;if(t&&t.Effects)for(var u=0;u<t.Effects.length;u++){var d=t.Effects[u],h=null;"BET_CHANGE_ATTR "==d.Type?h=new i:"BET_FLUSH_MOVE_ALLOW "==d.Type?h=new a:"BET_FLUSH_MOVE_EXEC "==d.Type?h=new r:"BET_HIDE_ALLOW "==d.Type?h=new l:"BET_HIDE_EXEC "==d.Type?h=new c:"BET_CHANGE_BULLET "==d.Type&&(h=new o),h&&(h.init(e,u+1),n.push(h))}return n}},cc._RF.pop()},{BuffAttr:"BuffAttr",BuffBulletChange:"BuffBulletChange",BuffFlashExecute:"BuffFlashExecute",BuffFlashGet:"BuffFlashGet",BuffInvisibleExecute:"BuffInvisibleExecute",BuffInvisibleGet:"BuffInvisibleGet",ResTableNames:"ResTableNames",Util:"Util",star_table:"star_table"}],BuffFlashExecute:[function(e,t,n){"use strict";cc._RF.push(t,"5d8578JMllIfIAwSaR7ofXg","BuffFlashExecute");var i=e("BuffBase"),a=e("CmdSkill"),o=e("Util");cc.Class({extends:i,properties:{defaultValue:{default:null},animationCount:{default:0}},execute:function(e){o.BeginSample("BuffFlashExecute::execute"),this.animationName="T_canying_H",this._super(e);var t=new a;t.Init(4,this.entity.GetGuid(),this.buffID),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(t),this.buffTime=.3,window.GGameEntry.NotificationCenter.emit("ShowEffectBtn",{show:!1,guid:e.Guid}),this.animationCount=0,o.EndSample("BuffFlashExecute::execute")},update:function(e){this.lastTime>this.buffTime||(this._super(e),++this.animationCount%2!=0&&window.GGameEntry.AnimationManager.getAnimationAtPosition("T_canying_H",this.entity.node.parent,this.entity.node.position,0))},release:function(){this._super()}}),cc._RF.pop()},{BuffBase:"BuffBase",CmdSkill:"CmdSkill",Util:"Util"}],BuffFlashGet:[function(e,t,n){"use strict";cc._RF.push(t,"8b75cUX+95IO7Sei9HTXQvF","BuffFlashGet");var i=e("BuffBase"),a=e("Util");cc.Class({extends:i,properties:{},execute:function(e){a.BeginSample("BuffFlashGet::execute"),this._super(e),window.GGameEntry.NotificationCenter.emit("ShowEffectBtn",{show:!0,guid:e.Guid}),a.EndSample("BuffFlashGet::execute")},update:function(e){this._super(e)},release:function(){this._super()}}),cc._RF.pop()},{BuffBase:"BuffBase",Util:"Util"}],BuffFreeze:[function(e,t,n){"use strict";cc._RF.push(t,"485a9VsZJJEPake+h/YiEJ7","BuffFreeze");var i=e("BuffBase");e("BuffDefine"),e("Util");cc.Class({extends:i,properties:{},execute:function(e){void 0!==e.Invincible&&e.Invincible||(this._super(e),void 0!==e.Pause&&(e.Pause=!0))},update:function(e){this._super(e)},release:function(){this.entity&&void 0!==this.entity.Pause&&(this.entity.Pause=!1),this._super()}}),cc._RF.pop()},{BuffBase:"BuffBase",BuffDefine:"BuffDefine",Util:"Util"}],BuffGlobal:[function(e,t,n){"use strict";cc._RF.push(t,"12972b3PDVE350nCdPJO5Lv","BuffGlobal");var i=e("BuffBase"),a=e("BuffDefine"),o=e("ResTableNames");e("Util");cc.Class({extends:i,properties:{},init:function(e){this.buffID=e;var t=window.GGameEntry.ResTableMgr.GetConfigByID(o.star_buff_cs,e);if(t){if(0==t.Time?this.buffType=a.BuffType.BuffType_OneTime:this.buffType=a.BuffType.BuffType_Continuous,this.buffTime=t.Time/1e3,this.lastTime=0,"string"==typeof t.Resource){var n=t.Resource.split("/");n&&(this.animationName=n[n.length-1])}if(this.param=[],"string"==typeof t.Param)for(var i=t.Param.split(" "),r=0;r<i.length;r++)this.param.push(parseInt(i[r]))}},execute:function(e){""!=this.animationName&&(-1!==this.animationName.indexOf(".mp3")?window.GGameEntry.SoundManager.PlayGameBg2():window.GGameEntry.NotificationCenter.emit("ShowShanHong"))},update:function(e){this._super(e)},release:function(){this._super()}}),cc._RF.pop()},{BuffBase:"BuffBase",BuffDefine:"BuffDefine",ResTableNames:"ResTableNames",Util:"Util"}],BuffInvincible:[function(e,t,n){"use strict";cc._RF.push(t,"f3a7bFHwSZGE66xWLOUjj1g","BuffInvincible");var i=e("BuffBase");e("BuffDefine"),e("Util");cc.Class({extends:i,properties:{},execute:function(e){this._super(e),void 0!==e.Invincible&&(e.Invincible=!0)},update:function(e){this._super(e)},release:function(){this.entity&&void 0!==this.entity.Invincible&&(this.entity.Invincible=!1),this._super()}}),cc._RF.pop()},{BuffBase:"BuffBase",BuffDefine:"BuffDefine",Util:"Util"}],BuffInvisibleExecute:[function(e,t,n){"use strict";cc._RF.push(t,"42ee7qlQgxOmrsJTP62KegN","BuffInvisibleExecute");var i=e("BuffBase");e("CmdSkill"),e("Util");cc.Class({extends:i,properties:{oldAlpha:{default:null}},execute:function(e){this._super(e),this.oldAlpha=e.node.opacity,e.ImageNode&&this.entity.EntityCampType==window.GGameEntry.PlayerManager.Player.EntityCampType?e.ImageNode.opacity=0:e.node.opacity=0},update:function(e){if(this._super(e),this.entity&&this.entity.BuffManager)for(var t=0;t<this.entity.BuffManager.BuffList.length;t++){var n=this.entity.BuffManager.BuffList[t];n&&n.buffAnimation&&(this.entity.EntityCampType===window.GGameEntry.PlayerManager.Player.EntityCampType&&n.buffID===this.buffID||255==n.buffAnimation.node.opacity&&(n.buffAnimation.node.opacity=0))}},release:function(){if(this.entity.node.opacity=this.oldAlpha,this.entity&&this.entity.BuffManager)for(var e=0;e<this.entity.BuffManager.BuffList.length;e++){var t=this.entity.BuffManager.BuffList[e];t&&t.buffAnimation&&(t.buffAnimation.node.opacity=255)}this.entity.ImageNode&&this.entity.EntityCampType==window.GGameEntry.PlayerManager.Player.EntityCampType?this.entity.ImageNode.opacity=255:this.entity.node.opacity=255,this._super()}}),cc._RF.pop()},{BuffBase:"BuffBase",CmdSkill:"CmdSkill",Util:"Util"}],BuffInvisibleGet:[function(e,t,n){"use strict";cc._RF.push(t,"eae2bblTjZGOo9OiLbX9EkS","BuffInvisibleGet");var i=e("BuffBase");cc.Class({extends:i,properties:{},execute:function(e){this._super(e)},update:function(e){this._super(e)},release:function(){this._super()}}),cc._RF.pop()},{BuffBase:"BuffBase"}],BuffJiaSuItem:[function(e,t,n){"use strict";cc._RF.push(t,"60813Jr2LFLv7Z0Pgxmx1Pn","BuffJiaSuItem");var i=e("BuffBase"),a=(e("Util"),e("ResCfgDef"));cc.Class({extends:i,properties:{defaultSpeed:0,resumeSpeed:0,startResumeTime:0,reduceSpeed:0},execute:function(e){if(this._super(e),void 0!==e.CfgSourceConfigSpeed&&this.param&&this.param.length>0){var t=this.param[0];this.startResumeTime=this.param[1]/1e3,t>0&&(this.defaultSpeed=e.CfgSourceConfigSpeed,e.CfgSourceConfigSpeed=t,this.defaultSpeed=e.CfgSourceConfigSpeed-this.defaultSpeed,this.resumeSpeed=this.defaultSpeed/(this.buffTime-this.startResumeTime))}if(window.GGameEntry.ResManager.GetProgramEffCfg(a.ProgramEffType.JiaSuTuoWei)===a.PEJiaSuTuoWei.Y){var n=!1;e.BuffManager&&e.BuffManager.getBuffByBuffID(21,1)&&(n=!0),!n&&e.MotionStreak&&(e.MotionStreak.enabled=!0,e.MotionStreak.fadeTime=.3)}void 0!==e.CannotStop&&(e.CannotStop=!0),this.reduceSpeed=0},update:function(e){if(this._super(e),!(this.lastTime<this.startResumeTime)&&this.entity&&void 0!==this.entity.CfgSourceConfigSpeed){var t=this.resumeSpeed*e,n=this.entity.CfgSourceConfigSpeed-t;if(this.reduceSpeed+=t,this.reduceSpeed>this.defaultSpeed)return void(this.reduceSpeed-=t);this.entity.CfgSourceConfigSpeed=n}},release:function(){this.entity&&void 0!==this.entity.CfgSourceConfigSpeed&&(this.entity.CfgSourceConfigSpeed=this.entity.CfgSourceConfigSpeed-(this.defaultSpeed-this.reduceSpeed)),window.GGameEntry.ResManager.GetProgramEffCfg(a.ProgramEffType.JiaSuTuoWei)===a.PEJiaSuTuoWei.Y&&this.entity&&this.entity.MotionStreak&&(this.entity.MotionStreak.fadeTime=0,this.entity.MotionStreak.enabled=!1),this.entity&&void 0!==this.entity.CannotStop&&(this.entity.CannotStop=!1,window.GGameEntry.NotificationCenter&&window.GGameEntry.NotificationCenter.emit("BuffJiaSuEnd")),this._super()},reset:function(){if(this._super(),window.GGameEntry.ResManager.GetProgramEffCfg(a.ProgramEffType.JiaSuTuoWei)===a.PEJiaSuTuoWei.Y){var e=!1;this.entity&&this.entity.BuffManager&&this.entity.BuffManager.getBuffByBuffID(21,1)&&(e=!0),!e&&this.entity.MotionStreak&&(this.entity.MotionStreak.enabled=!0,this.entity.MotionStreak.fadeTime=.3)}}}),cc._RF.pop()},{BuffBase:"BuffBase",ResCfgDef:"ResCfgDef",Util:"Util"}],BuffJiaXue:[function(e,t,n){"use strict";cc._RF.push(t,"e950bfQUOdHA6oVgCbyo9x+","BuffJiaXue");var i=e("BuffBase");e("Util");cc.Class({extends:i,properties:{},execute:function(e){if(this._super(e),void 0!==e.Hp&&this.param&&this.param.length>0){var t=this.param[0];if(t>0&&(e.Hp+=t,e.Hp>e.MaxHp&&(e.Hp=e.MaxHp),e.TankHpControl)){var n=e.Hp/e.MaxHp;e.TankHpControl.scaleX=n}}},update:function(e){this._super(e)},release:function(){this._super()}}),cc._RF.pop()},{BuffBase:"BuffBase",Util:"Util"}],BuffManager:[function(e,t,n){"use strict";cc._RF.push(t,"aea0a1/m8NGKJqZs0ZzcYZY","BuffManager");var i=e("Util"),a=(e("BuffBase"),e("ResTableNames"),e("BuffDefine")),o=e("GlobalCfg"),i=e("Util");cc.Class({properties:{BuffList:{default:new Array,serializable:!1,visible:!1},BuffCacheList:{default:new Array,serializable:!1,visible:!1},Entity:{default:null}},applyBuff:function(e){var t=i.BeginSample("BuffManager::applyBuff");window.GGameEntry.CurGamePlayType===o.GamePlayType.GamePlayType_Single?e.buffType==a.BuffType.BuffType_Immediate?this.addToBuffList(this.BuffList,e,!1):this.addToBuffList(this.BuffCacheList,e,!0):e.buffType==a.BuffType.BuffType_Immediate?(this.BuffList.push(e),e.execute(this.Entity)):this.addToBuffList(this.BuffCacheList,e,!0),i.EndSample(t)},addToBuffList:function(e,t,n){for(var a=i.BeginSample("BuffManager::addToBuffList"),o=e.length-1;o>=0;o--)if(t.buffID==e[o].buffID)t.buffEffectID==e[o].buffEffectID&&(n||e[o].release(),e.splice(o,1));else if(0!=t.buffGroup&&t.buffGroup==e[o].buffGroup){if(!(t.buffPri>=e[o].buffPri))return void i.EndSample(a);n||e[o].release(),e.splice(o,1)}e.push(t),i.EndSample("BulletManager::addToBuffList"),n||t.execute(this.Entity),i.EndSample(a)},removeBuff:function(e){i.BeginSample("BulletManager::removeBuff");for(var t=this.BuffList.length-1;t>=0;t--)this.BuffList[t].buffID==e&&(this.BuffList[t].release(),this.BuffList.splice(t,1));i.EndSample("BulletManager::removeBuff")},resetBuff:function(e){for(var t=this.BuffList.length-1;t>=0;t--)this.BuffList[t].buffID==e&&this.BuffList[t].reset()},executeBuff:function(e){var t=i.BeginSample("BuffManager::executeBuff");if(this.BuffList&&this.BuffList.length)for(var n=this.BuffList.length-1;n>=0;n--)this.BuffList[n].shouldRelease?this.BuffList.splice(n,1):this.BuffList[n].update(e);i.EndSample(t)},executeCacheBuff:function(e,t){for(var n=i.BeginSample("BuffManager::executeCacheBuff"),a=this.BuffCacheList.length-1;a>=0;a--)if(this.BuffCacheList[a].buffID==e){var o=this.BuffCacheList[a];this.BuffCacheList.splice(a,1),this.BuffList.push(o),o.execute(this.Entity)}i.EndSample(n)},getTopCacheBuffID:function(){if(this.BuffCacheList.length>0){var e={buffID:0,effectIndex:0};return e.buffID=this.BuffCacheList[0].buffID,e.effectIndex=this.BuffCacheList[0].buffEffectID,e}return null},getBuffByBuffID:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.BuffList.length;n++)if(this.BuffList[n].buffID==e&&this.BuffList[n].buffEffectID==t)return this.BuffList[n];return null},clearBuff:function(){if(this.BuffList&&this.BuffList.length){for(var e=this.BuffList.length-1;e>=0;e--)this.BuffList[e].release();this.BuffList.splice(0,this.BuffList.length)}this.BuffCacheList&&this.BuffCacheList.length&&(this.BuffCacheList.splice(0,this.BuffCacheList.length),window.GGameEntry.NotificationCenter.emit("ShowEffectBtn",{show:!1,guid:this.Entity.Guid}))},reset:function(){this.clearBuff(),this.Entity=null}}),cc._RF.pop()},{BuffBase:"BuffBase",BuffDefine:"BuffDefine",GlobalCfg:"GlobalCfg",ResTableNames:"ResTableNames",Util:"Util"}],BuffPowerUp:[function(e,t,n){"use strict";cc._RF.push(t,"5f9eb0qGzJOuJnhOFUSYVAt","BuffPowerUp");var i=e("BuffBase");e("Util");cc.Class({extends:i,properties:{},execute:function(e){this._super(e),void 0!==e.BufferId&&(this.oldBulletId=e.ShootBulletId,e.BufferId=this.buffID,this.entity.changeBulletId(20002))},update:function(e){this._super(e)},release:function(){this.entity&&this.oldBulletId&&(this.entity.changeBulletId(this.oldBulletId),this.entity.BufferId=0),this._super()}}),cc._RF.pop()},{BuffBase:"BuffBase",Util:"Util"}],BuffSpeedUp:[function(e,t,n){"use strict";cc._RF.push(t,"5d0d2EUcuhLBqMBc7Q9H7sP","BuffSpeedUp");var i=e("BuffBase");e("Util");cc.Class({extends:i,properties:{defaultSpeed:0},execute:function(e){if(this._super(e),void 0!==e.CfgSourceConfigSpeed&&this.param&&this.param.length>0){var t=this.param[0];t>0&&(this.defaultSpeed=e.CfgSourceConfigSpeed,e.CfgSourceConfigSpeed=t,this.defaultSpeed=e.CfgSourceConfigSpeed-this.defaultSpeed)}},update:function(e){this._super(e)},release:function(){this.entity&&void 0!==this.entity.CfgSourceConfigSpeed&&this.defaultSpeed>0&&(this.entity.CfgSourceConfigSpeed-=this.defaultSpeed),this._super()}}),cc._RF.pop()},{BuffBase:"BuffBase",Util:"Util"}],BulletAddHp:[function(e,t,n){"use strict";cc._RF.push(t,"f4db7hX/9JG34obQhIL9xYo","BulletAddHp");e("EntityBase"),e("EntityTypeDefine"),e("BulletAttr");var i=e("BulletBase");e("MapManager");cc.Class({extends:i,properties:{isHit:!1},onLoad:function(){},Init:function(e){this._super(e)},minusCollisionCount:function(e){this.OnDie()},CollisionLogic:function(e,t){this.DeadAni||this._super(e,t)},OnDie:function(){this._super()},update:function(e){this._super(e)}}),cc._RF.pop()},{BulletAttr:"BulletAttr",BulletBase:"BulletBase",EntityBase:"EntityBase",EntityTypeDefine:"EntityTypeDefine",MapManager:"MapManager"}],BulletAttr:[function(e,t,n){"use strict";cc._RF.push(t,"c22c884bz9LOLHtFA3spPcH","BulletAttr"),cc.Class({extends:cc.Component,properties:{FlySpeed:100,MaxFlyDistance:500,CollisionWidth:60,CollisionHeight:60,Attack:1},onLoad:function(){}}),cc._RF.pop()},{}],BulletBase:[function(e,t,n){"use strict";cc._RF.push(t,"3a6214VF3xFKpSI0Cv/rWB2","BulletBase");e("EntityBase");var i=e("EntityTypeDefine"),a=e("BulletAttr"),o=e("EntityDynamic"),r=e("ResTableNames"),s=e("MsgPickUpItem"),l=e("MsgHit"),c=e("Util"),u=(e("star_comm"),e("star_cs"),e("GlobalCfg")),d=(e("MonsterManager"),e("CollisionObject"),e("BulletTypeDefine")),h=e("ResCfgDef");cc.Class({extends:o,properties:{BulletAttr:{default:null,type:a},MyCollider:{default:null,type:cc.Collider},FlySpeed:{default:100,serializable:!1,visible:!1},MaxFlyDistance:{default:800,serializable:!1,visible:!1},AttachDamger:{default:50,serializable:!1,visible:!1},StartPos:{default:cc.v2(0,0),serializable:!1,visible:!1},LastPos:{default:cc.v2(-1e4,-1e4),serializable:!1,visible:!1},StepCount:{default:0,serializable:!1,visible:!1},newSpeedx:{default:0,serializable:!1,visible:!1},newSpeedy:{default:0,serializable:!1,visible:!1},tankGuid:{default:!1},bulletType:{default:0,serializable:!1,visible:!1},tuoWeiSprite:{default:null,type:cc.Node},colorSpriteChange:{default:[],type:cc.Node},reflectCfg:{default:0,serializable:!1,visible:!1},reflectCountCfg:{default:0,serializable:!1,visible:!1},reflectObjectCfg:{default:0,serializable:!1,visible:!1},distanFly:{default:0,serializable:!1,visible:!1},blueTeamColor:{default:new cc.color},redTeamColor:{default:new cc.color},seq:{default:-1,serializable:!1,visible:!1}},onLoad:function(){},Init:function(e){this._super(),this.EntityType=i.EntityType.EntityBullet,this.EntitySource=e,this.tankGuid=e.GetGuid(),this.StartPos=this.node.position;var t=window.GGameEntry.ResTableMgr.GetConfigByID(r.star_bullet_cs,this.ConfigId);this.AttachDamger=parseInt(t.Atk),this.FlySpeed=parseInt(t.Speed),this.MaxFlyDistance=parseInt(t.Dist),this.BoomAreaWidth=parseInt(t.HurtRange),this.BoomAreaHeight=parseInt(t.HurtRange),this.bulletType=parseInt(t.Type),this.Pic=parseInt(t.Pic),this.BoxPic=parseInt(t.BoxPic),this.reflectCfg=parseInt(t.IsRebound),this.reflectCountCfg=parseInt(t.ReboundCnt),this.reflectObjectCfg=parseInt(t.ReboundType),this.tuoWeiSprite&&(e.EntityCampType===window.GGameEntry.PlayerManager.Player.EntityCampType?this.tuoWeiSprite.color=this.blueTeamColor:this.tuoWeiSprite.color=this.redTeamColor);for(var n=0;n<this.colorSpriteChange.length;n++)e.EntityCampType===window.GGameEntry.PlayerManager.Player.EntityCampType?this.colorSpriteChange[n].color=this.blueTeamColor:this.colorSpriteChange[n].color=this.redTeamColor},SetStartPos:function(e){this.StartPos=e},OnDie:function(){this.DeadAni||(this.DeadAni=!0,this._super())},_DoDieAction:function(){this.node.disableCollider=!0,this.node.setPosition(cc.p(1e6,1e6)),window.GGameEntry.BulletManager.RecycleBulletNode(this)},SetFlySpeed:function(e){this.FlySpeed=e},SetSeq:function(e){this.seq=e},getBulletSpeed:function(){return cc.v2(this.newSpeedx,this.newSpeedy)},minusCollisionCount:function(e){},StopAll:function(){},onCollisionStay:function(e,t){this.CollisionLogic(e,t)},onCollisionEnter:function(e,t){this.CollisionLogic(e,t)},reflectJudge:function(e){if(this.reflectCfg){if(!e)return!1;if(1<<e.GetEntityType()&this.reflectObjectCfg){var t=this.EntitySource.node.position,n=cc.v2(this.node.position);n.addSelf(cc.v2(50*this.newSpeedx,50*this.newSpeedy));var i=window.GGameEntry.CollisionObject.getLineCollisionEntityReturnLine(t,n,e);if(i)return 1==i||2==i?this.reflectSpeed(1):this.reflectSpeed(0)}}return!1},reflectBorld:function(){var e=this.EntitySource.node.position,t=cc.v2(this.node.position);t.addSelf(cc.v2(50*this.newSpeedx,50*this.newSpeedy));var n=window.GGameEntry.CollisionObject.getLineCollisionBordReturnLine(e,t);return!!n&&(1==n||2==n?this.reflectSpeed(1):this.reflectSpeed(0))},reflectSpeed:function(e){if(0!==this.reflectCfg){this.reflectCountCfg=this.reflectCountCfg-1,0===this.reflectCountCfg&&(this.reflectCfg=0),e?this.newSpeedy=-this.newSpeedy:this.newSpeedx=-this.newSpeedx;var t=Math.atan2(this.newSpeedy,this.newSpeedx)*(180/Math.PI)-90;return this.node.rotation=-t,!0}},onHitEffect:function(e,t){var n=c.BeginSample("Player::onHitEffect");if(window.GGameEntry.PlayerManager.Player&&e===window.GGameEntry.PlayerManager.Player.GetGuid()){var i=new l;i.entityGUID=e,i.dir=this.node.rotation,i.skillSeq=this.seq,i.TargetNum=t.length,i.Targets=t,i.BulletId=this.ConfigId,i.Send()}c.EndSample(n)},hitObjectInSingleMode:function(e){e.LastHitByEntity=this.EntitySource,e.OnMinusHp(this.AttachDamger)},CollisionLogic:function(e,t){if(!this.isHit&&!this.DeadAni&&this.EntitySource.node!==e.node){if(c.BeginSample("BulletBase::CollisionLogic"),this.bulletType===d.BulletType.Bullet_AddHp){var n=e.node.getComponent("EntityBase");if(!this.EntitySource.getComponent("EntityBase")||!n)return;if(n.DeadAni)return;return window.GGameEntry.CurGamePlayType===u.GamePlayType.GamePlayType_Network?((m=[])[m.length]=n.GetGuid(),this.onHitEffect(this.EntitySource.GetGuid(),m),window.GGameEntry.SoundManager.PlayHitTank()):n.OnAddHp(this.AttachDamger),void this.OnDie()}if("AirDropItem"===e.node.group){a=e.node.getComponent("EntityBase"),this.EntitySource.getComponent("TankBase");if(a.boxState&&a.isCanHit())return;return window.GGameEntry.CurGamePlayType===u.GamePlayType.GamePlayType_Network?((m=[])[m.length]=a.GetGuid(),this.onHitEffect(this.EntitySource.GetGuid(),m)):a.HitByBullet(this.AttachDamger),window.GGameEntry.PlayerManager.Player&&this.EntitySource===window.GGameEntry.PlayerManager.Player&&window.GGameEntry.SoundManager.PlayHitTank(),void this.OnDie()}if("Border"===e.node.group){var a=e.node.getComponent("EntityBase");this.EntitySource.getComponent("TankBase");if(window.GGameEntry.CurGamePlayType===u.GamePlayType.GamePlayType_Network){if(this.reflectJudge(a))return;(m=[])[m.length]=a.GetGuid(),this.onHitEffect(this.EntitySource.GetGuid(),m)}return window.GGameEntry.PlayerManager.Player&&this.EntitySource===window.GGameEntry.PlayerManager.Player&&window.GGameEntry.SoundManager.PlayHitTank(),void this.OnDie()}if("Monster"===e.node.group){var o=e.node.getComponent("Monster");if(o&&(this.EntitySource.EntityCampType!=o.EntityCampType&&(this.hitObjectInSingleMode(o),this.OnDie(),window.GGameEntry.PlayerManager.Player&&this.EntitySource===window.GGameEntry.PlayerManager.Player&&window.GGameEntry.SoundManager.PlayHitTank(o.node.position)),this.EntitySource.EntityCampType==o.EntityCampType)){var r=o.GetGuid(),l=new s;l.entityGUID=r,l.buffID=3,l.Send(),this.OnDie(),window.GGameEntry.PlayerManager.Player&&this.EntitySource===window.GGameEntry.PlayerManager.Player&&window.GGameEntry.SoundManager.PlayHitTank(o.node.position)}}else if("Player"===e.node.group){if(this.EntitySource.EntityType===i.EntityType.EntityOtherPlayer)return this.OnDie(),void window.GGameEntry.SoundManager.PlayHitTank();var h=e.node.getComponent("Player");h&&(window.GGameEntry.CurGamePlayType===u.GamePlayType.GamePlayType_Network?this.EntitySource!=h&&((m=[])[m.length]=h.GetGuid(),this.onHitEffect(this.EntitySource.GetGuid(),m),this.OnDie(),window.GGameEntry.SoundManager.PlayHitTank()):(this.EntitySource.EntityCampType!=h.EntityCampType&&(this.hitObjectInSingleMode(h),this.OnDie(),window.GGameEntry.SoundManager.PlayHitTank()),this.EntitySource.EntityCampType==h.EntityCampType&&(this.OnDie(),window.GGameEntry.SoundManager.PlayHitTank())));var f=e.node.getComponent("OtherPlayer");if(f&&window.GGameEntry.CurGamePlayType===u.GamePlayType.GamePlayType_Network&&this.EntitySource!=f){var m=[];m[m.length]=f.GetGuid(),this.onHitEffect(this.EntitySource.GetGuid(),m),this.OnDie(),window.GGameEntry.SoundManager.PlayHitTank(f.node.position)}}c.EndSample("BulletBase::CollisionLogic")}},updateBulletCollisionRect:function(e,t){if(!e.DeadAni)return this.updateBulletCollisionRectWithBlock(e,t)},updateBulletCollisionRectWithBlock:function(e,t){var n=e.position;if(n!=t){var i=c.BeginSample("BulletBase::updateBulletCollisionRectWithBlock"),a=20*window.GGameEntry.MathUtil.sin(this.node.rotation),o=20*window.GGameEntry.MathUtil.cos(this.node.rotation),r=t.sub(n).mag();r/=20;var s=[],l=n,d=this.MyCollider,h=cc.rect(e.x+d.offset.x,e.y+d.offset.y,d.size.width,d.size.height);s[s.length]=h;for(var f=0;f<r-1;f++)(m=cc.rect(0,0,0,0)).x=h.x+a*(f+1),m.y=h.y+o*(f+1),m.width=h.width,m.height=h.height,s[s.length]=m;var m=cc.rect(0,0,0,0);m.x=t.x,m.y=t.y,m.width=h.width,m.height=h.height,s[s.length]=m;var y=this.getBlockCollisionByRect(s,l);if(y){var p=y.node.position;if(window.GGameEntry.CurGamePlayType!==u.GamePlayType.GamePlayType_Single&&this.reflectJudge(y)){if(-1e4===this.LastPos.x&&-1e4===this.LastPos.y){var a=n.x+1.1*this.newSpeedx*this.MyCollider.world.aabb.width,o=n.y+1.1*this.newSpeedy*this.MyCollider.world.aabb.height;return cc.v2(a,o)}return this.LastPos}return window.GGameEntry.BlockMgr.destorySmallCollisionAdobeArea(this,y,n,t),this.OnDie(),c.EndSample(i),p}return c.EndSample(i),!1}},getHomeBaseCollisionByRect:function(){for(var e=c.BeginSample("BulletBase::getHomeBaseCollisionByRect"),t=0;t<window.GGameEntry.MapManager.MapItem[i.EntityType.EntityBase].length;t++){var n=window.GGameEntry.MapManager.MapItem[i.EntityType.EntityBase][t],a=this.MyCollider.world.aabb,o=n.MyCollider.world.aabb;if(a.intersects(o)){if(window.GGameEntry.CurGamePlayType===u.GamePlayType.GamePlayType_Network){var r=[];r[r.length]=n.GetGuid(),this.onHitEffect(this.EntitySource.GetGuid(),r)}else n.HitByBullet(this.AttachDamger);return this.OnDie(),window.GGameEntry.SoundManager.PlayHitTank(n.node.position),c.EndSample(e),cc.v2(n.node.position)}}c.EndSample(e)},getBlockCollisionByRect:function(e,t){for(var n=c.BeginSample("BulletBase::getHomeBaseCollisionByRect"),i=0;i<e.length;i++){var a=e[i],o=window.GGameEntry.BlockMgr.getBlockFromRect(a,this.newSpeedx,this.newSpeedy);if(o){var r=cc.v2(t.x-a.width/2,t.y-a.height/2),s=cc.v2(t.x+a.width/2,t.y+a.height/2),l=cc.v2(a.x-a.width/2,a.y-a.height/2),u=cc.v2(a.x+a.width/2,a.y+a.height/2),d=window.GGameEntry.BlockMgr.isSmallCollisionAdobe(r,l,o);if(d)return c.EndSample(n),o;if(d=window.GGameEntry.BlockMgr.isSmallCollisionAdobe(s,u,o))return c.EndSample(n),o}}c.EndSample(n)},updateBulletPosArrayCollision:function(e,t){for(var n=c.BeginSample("BulletBase::updateBulletPosArrayCollision"),i=0;i<e.length;i++){var a=e[i],o=window.GGameEntry.BlockMgr.getBlockFromPosition(a);if(o&&window.GGameEntry.BlockMgr.isSmallCollisionAdobe(t,e[i],o))return c.EndSample(n),o}c.EndSample(n)},update:function(e){if(!this.DeadAni){var t=c.BeginSample("BulletBase::update"),n=this.node.position;0==this.newSpeedx&&(0===this.node.rotation?this.newSpeedx=0:90===this.node.rotation?this.newSpeedx=1:180===this.node.rotation?this.newSpeedx=0:270===this.node.rotation?this.newSpeedx=-1:this.newSpeedx=Math.sin(.01745*this.node.rotation)),0==this.newSpeedy&&(0===this.node.rotation?this.newSpeedy=1:90===this.node.rotation?this.newSpeedy=0:180===this.node.rotation?this.newSpeedy=-1:270===this.node.rotation?this.newSpeedy=0:this.newSpeedy=window.GGameEntry.MathUtil.cos(this.node.rotation));var i=this.FlySpeed*e*this.newSpeedx,a=this.FlySpeed*e*this.newSpeedy;if(n.x=this.node.position.x+i,n.y=this.node.position.y+a,window.GGameEntry.MapManager.GetBattleFieldRect().contains(n)){var o=this.distanFly+cc.pDistance(n,this.LastPos);this.distanFly>0&&o>this.MaxFlyDistance&&(o-=this.MaxFlyDistance,n.x=n.x-this.newSpeedx*o+this.newSpeedx,n.y=n.y-this.newSpeedy*o+this.newSpeedy);this.updateBulletCollisionRect(this.node,n);this.node.setPosition(n)}else{if(this.reflectBorld()){if(-1e4===this.LastPos.x&&-1e4===this.LastPos.y){var i=this.node.position.x+this.newSpeedx*this.MyCollider.world.aabb.width,a=this.node.position.y+this.newSpeedy*this.MyCollider.world.aabb.height;return this.node.setPosition(cc.v2(i,a)),void(this.LastPos=this.node.position)}return}this.DeadAni||(window.GGameEntry.SoundManager.PlayHitNoDamage(this.node.position),this.OnDie())}-1e4!=this.LastPos.x&&(this.distanFly=this.distanFly+cc.pDistance(this.node.position,this.LastPos),this.distanFly>=this.MaxFlyDistance&&(this.DeadAni||this.areaDestory())),this.LastPos=this.node.position,c.EndSample(t)}},lateUpdate:function(e){window.GGameEntry.Performance1104,window.GGameEntry.CollisionObject.BulletWithHome(this)},areaBlockDestory:function(e,t){var n=[];n[n.length]=cc.v2(this.node.position.x-e/2,this.node.position.y-t/2),n[n.length]=cc.v2(this.node.position.x-e/2,this.node.position.y),n[n.length]=cc.v2(this.node.position.x-e/2,this.node.position.y+t/2),n[n.length]=cc.v2(this.node.position.x,this.node.position.y+t/2),n[n.length]=cc.v2(this.node.position.x,this.node.position.y-t/2),n[n.length]=cc.v2(this.node.position.x+e/2,this.node.position.y-t/2),n[n.length]=cc.v2(this.node.position.x+e/2,this.node.position.y),n[n.length]=cc.v2(this.node.position.x+e/2,this.node.position.y+t/2);for(var a=[],o=0;o<n.length;o++)(s=window.GGameEntry.BlockMgr.getBlockByPosition(n[o].x,n[o].y))&&(a.length?a[a.length-1]!=s&&(a[a.length]=s):a[a.length]=s);for(var r=[],o=0;o<a.length;o++){var s=a[o];s&&(s.EntityType==i.EntityType.EntitySteel&&20002===this.ConfigId&&(window.GGameEntry.CurGamePlayType!==u.GamePlayType.GamePlayType_Network?s.OnDie():r[r.length]=s.GetGuid()),s.EntityType==i.EntityType.EntityAdobe&&(window.GGameEntry.CurGamePlayType!==u.GamePlayType.GamePlayType_Network?s.OnDie():r[r.length]=s.GetGuid()))}r.length&&this.onHitEffect(this.EntitySource.GetGuid(),r)},areaDestory:function(){var e=c.BeginSample("BulletBase::areaDestory");window.GGameEntry.Performance1104||(window.GGameEntry.CollisionObject.BulletBombCollisionWithObject(this,this.BoomAreaWidth,this.BoomAreaHeight),this.areaBlockDestory(this.BoomAreaWidth,this.BoomAreaHeight)),window.GGameEntry.ResManager.GetProgramEffCfg(h.ProgramEffType.ZiDanFireEffect)===h.PEZiDanFireEffect.NONE&&(this.PlayDeathAni=!1),this.OnDie(),c.EndSample(e)},Reset:function(){this._super(),this.node.disableCollider=!1,this.EntitySource=null,this.node.active=!0,this.newSpeedx=0,this.newSpeedy=0,this.LastPos.x=-1e4,this.LastPos.y=-1e4,this.distanFly=0,this.PlayDeathAni=!0}}),cc._RF.pop()},{BulletAttr:"BulletAttr",BulletTypeDefine:"BulletTypeDefine",CollisionObject:"CollisionObject",EntityBase:"EntityBase",EntityDynamic:"EntityDynamic",EntityTypeDefine:"EntityTypeDefine",GlobalCfg:"GlobalCfg",MonsterManager:"MonsterManager",MsgHit:"MsgHit",MsgPickUpItem:"MsgPickUpItem",ResCfgDef:"ResCfgDef",ResTableNames:"ResTableNames",Util:"Util",star_comm:"star_comm",star_cs:"star_cs"}],BulletIconUI:[function(e,t,n){"use strict";cc._RF.push(t,"5cf89WkMaBOzo5W3WuWIVUR","BulletIconUI"),cc.Class({extends:cc.Component,properties:{ValueSprite:{type:cc.Sprite,default:null}},ChangeBulletProgress:function(e){this.ValueSprite.fillRange!==e&&(this.ValueSprite.fillRange=e)}}),cc._RF.pop()},{}],BulletManager:[function(e,t,n){"use strict";cc._RF.push(t,"adc8eyYtgpNApSh3ntpKm+e","BulletManager");var i=e("EntityTypeDefine"),a=e("Util"),o=(e("assert"),e("GlobalCfg")),r=e("ResTableNames");e("BulletTypeDefine");cc.Class({extends:cc.Component,properties:{MapBulletPlayer:{default:null,type:cc.Node},Bullet1Prefab:{default:null,type:cc.Prefab},BulletThrough:{default:null,type:cc.Prefab},BulletStrong:{default:null,type:cc.Prefab},BulletHp:{default:null,type:cc.Prefab},BulletSpeed:{default:0},BulletCache:null},onLoad:function(){},Init:function(e){this.MapManager=window.GGameEntry.MapManager,this.gameSourceEntity=e,this.BulletCache={}},Release:function(){this.MapManager=null},Preload:function(){this.createBulletPoolPre()},SetBulletRotate:function(e,t,n){if(window.GGameEntry.PlayerManager.Player&&(e.rotation=t.PaoTaiNode.rotation+n,parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(r.star_global_cs,14).Value))){if(t.EntityType!==i.EntityType.EntityPlayer)return;var s,l=a.BeginSample("BulletManager::SetBulletRotate"),c=999999;s=window.GGameEntry.CurGamePlayType===o.GamePlayType.GamePlayType_Network?window.GGameEntry.PlayerManager.otherPlayerArray:window.GGameEntry.MonsterManager.monsterMap;for(var u in s)if(!s[u].DeadAni&&s[u].EntityCampType!==window.GGameEntry.PlayerManager.Player.EntityCampType){var d=s[u],h=d.node.position.sub(t.node.position);if(!(h.mag()>500)){var f=90;0===h.x?(h.y>0&&(f=90),h.y<0&&(f=270)):f=Math.atan2(h.y,h.x)/(2*Math.PI)*360,f=-(f-90);var m=Math.abs(f-e.rotation);m<c&&m<parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(r.star_global_cs,15).Value)&&(c=f,d)}}999999!==c&&(e.rotation=c),a.EndSample(l)}},CreateBulletByFrame:function(e,t,n,i,o,r,s,l){0===o&&(o=1);var c=0;o>1&&(c=-parseInt(o/2)*i);for(var u=s;u<r+s&&u<o;u++){var d=this.GetBulletNode(e);if(!d)return void a.AssertCheck(!1,"子弹不存在 id："+e);var h=t.GetBulletSpawnPosition(),f=this.MapBulletPlayer.convertToNodeSpaceAR(h);if(l){var m=l*window.GGameEntry.MathUtil.cos(t.ImageNode.rotation),y=l*window.GGameEntry.MathUtil.sin(t.ImageNode.rotation);d.x=f.x+y,d.y=f.y+m}else d.x=f.x,d.y=f.y;this.SetBulletRotate(d,t,c+u*i);var p=d.getComponent("BulletBase");p.SetConfigId(e),p.SetSeq(n),p&&(p.Init(t),t.BulletMaxDistance&&t.BulletMaxDistance>0&&(p.MaxFlyDistance=t.BulletMaxDistance),t.BulletSpeed&&t.BulletSpeed>0&&p.SetFlySpeed(t.BulletSpeed))}},CreateBullet:function(e,t,n){a.BeginSample("BulletManager::CreateBullet");var i=window.GGameEntry.ResTableMgr.GetConfigByID(r.star_bullet_cs,e);if(i){var o=parseInt(i.Angle),s=parseInt(i.Column);0===s&&(s=1);var l=0;s>1&&(l=-parseInt(s/2)*o);for(var c=0;c<s;c++){a.BeginSample("BulletManager::CreateBullet GetBulletNode");var u=this.GetBulletNode(e);if(!u)return void a.AssertCheck(!1,"子弹不存在 id："+e);a.EndSample("BulletManager::CreateBullet GetBulletNode"),a.BeginSample("BulletManager::Bullet Init");var d=t.GetBulletSpawnPosition(),h=this.MapBulletPlayer.convertToNodeSpaceAR(d),f=parseInt(i.ShiftingY);if(f){var m=f*window.GGameEntry.MathUtil.cos(t.ImageNode.rotation),y=f*window.GGameEntry.MathUtil.sin(t.ImageNode.rotation);u.x=h.x+y,u.y=h.y+m}else u.x=h.x,u.y=h.y;this.SetBulletRotate(u,t,l+c*o);var p=u.getComponent("BulletBase");p.SetConfigId(e),p.SetSeq(n),a.EndSample("BulletManager::Bullet Init"),p&&(p.Init(t),t.BulletMaxDistance&&t.BulletMaxDistance>0&&(p.MaxFlyDistance=t.BulletMaxDistance),t.BulletSpeed&&t.BulletSpeed>0&&p.SetFlySpeed(t.BulletSpeed))}a.EndSample("BulletManager::CreateBullet")}else a.AssertCheck(null!=i,"子弹不存在 id："+e)},setBulletFlySpeed:function(){this.BulletSpeed},loadFromPrefabs:function(e){return cc.instantiate(e)},createBulletPoolPre:function(){var e=window.GGameEntry.ResTableMgr.GetTableByName(r.star_item_buffer_c);if(e&&e.length>0)for(var t=0;t<e.length;t++){var n=e[t];if(!n)return cc.error("Item not found"),null;var o=window.GGameEntry.BattleSystem.MapID;if(o){var s=a.TableStr2Num(n.Map);if(s&&o!==s)continue}var l=a.TableStr2Num(n.Type),c=n.DataList.split(" ");l===i.CacheConfigType.CacheConfigType_Bullet&&this.createBulletPool(a.TableStr2Num(c[0]),a.TableStr2Num(c[1]))}},createBulletPool:function(e,t){this.BulletCache[e]||(this.BulletCache[e]=[]);var n=window.GGameEntry.ResTableMgr.GetConfigByID(r.star_bullet_cs,e);if(n){for(var i=0;i<t;i++){var o;(o=window.GGameEntry.ResManager.GetResPrefab(n.Pic))||a.AssertCheck(!1,"子弹配置错误得不到prefab"+o);var s=this.loadFromPrefabs(o);s?this.MapBulletPlayer.addChild(s):a.AssertCheck(!1),s.x=1e4,s.y=1e4,s.active=!1,this.BulletCache[e].push(s)}console.error("create bullet id:"+e+" count: "+t)}else a.AssertCheck(!1,"子弹配置错误 id："+e)},GetBulletNode:function(e){this.BulletCache[e]||(console.error("GetBulletNode "+e),this.createBulletPoolPre());var t=this.BulletCache[e],n=null;0==t.length&&(a.AssertCheck(!1,"子弹数量不足 id："+e),this.createBulletPool(e,1)),a.BeginSample("GetBulletNode pop"),n=t.pop(),a.EndSample("GetBulletNode pop"),a.BeginSample("GetBulletNode getComponent");var i=n.getComponent("BulletBase");return a.EndSample("GetBulletNode getComponent"),a.BeginSample("GetBulletNode Reset"),i.Reset(),a.EndSample("GetBulletNode Reset"),n},RecycleBulletNode:function(e){e.node.active=!1,this.BulletCache[e.ConfigId]||(this.BulletCache[e.ConfigId]=[]),this.BulletCache[e.ConfigId].push(e.node)},ReleaseBullet:function(){this.MapBulletPlayer.stopAllActions();for(var e=0;e<this.MapBulletPlayer.childrenCount;++e){var t=this.MapBulletPlayer.children[e].getComponent("BulletBase");"undefined"!=typeof bullet&&t.node.isValid&&t.StopAll()}this.MapBulletPlayer.destroyAllChildren(),this.BulletCache={},this.Log("ReleaseBullet called")},Pause:function(){},Resume:function(){},Log:function(e){this.LogEnabled}}),cc._RF.pop()},{BulletTypeDefine:"BulletTypeDefine",EntityTypeDefine:"EntityTypeDefine",GlobalCfg:"GlobalCfg",ResTableNames:"ResTableNames",Util:"Util",assert:1}],BulletThrough:[function(e,t,n){"use strict";cc._RF.push(t,"37830rJx5NI777jGKkfIvjL","BulletThrough");e("EntityBase"),e("EntityTypeDefine"),e("BulletAttr");var i=e("BulletBase");cc.Class({extends:i,properties:{ThroughCount:{default:1,serializable:!1,visible:!1}},onLoad:function(){},Init:function(e){this._super(e)},minusCollisionCount:function(e){"Block"===e&&(this.ThroughCount=this.ThroughCount-1),"Steel"===e&&(this.ThroughCount=this.ThroughCount-2),this.ThroughCount<=0&&this.OnDie()},CollisionLogic:function(e,t){this.DeadAni||this._super(e,t)},OnDie:function(){this._super()},StopAll:function(){},update:function(e){this._super(e)}}),cc._RF.pop()},{BulletAttr:"BulletAttr",BulletBase:"BulletBase",EntityBase:"EntityBase",EntityTypeDefine:"EntityTypeDefine"}],BulletTypeDefine:[function(e,t,n){"use strict";cc._RF.push(t,"1a474PQ19hLP7PySy4zsBMd","BulletTypeDefine");var i=cc.Enum({Bullet_Normal:1,Bullet_PowerUp:2,Bullet_AddHp:3});t.exports={BulletType:i},cc._RF.pop()},{}],Bullet:[function(e,t,n){"use strict";cc._RF.push(t,"71a93I3hEVFh4S+mJpr7C/k","Bullet");e("EntityBase"),e("EntityTypeDefine"),e("BulletAttr");var i=e("BulletBase");e("MapManager");cc.Class({extends:i,properties:{isHit:!1},onLoad:function(){},Init:function(e){this._super(e)},minusCollisionCount:function(e){this.OnDie()},CollisionLogic:function(e,t){this.DeadAni||this._super(e,t)},OnDie:function(){this._super()},update:function(e){this._super(e)}}),cc._RF.pop()},{BulletAttr:"BulletAttr",BulletBase:"BulletBase",EntityBase:"EntityBase",EntityTypeDefine:"EntityTypeDefine",MapManager:"MapManager"}],ButtonScaler:[function(e,t,n){"use strict";cc._RF.push(t,"583e37tDMZOyrHYOPD8BB3O","ButtonScaler"),cc.Class({extends:cc.Component,properties:{pressedScale:1,transDuration:0},onLoad:function(){function e(e){this.stopAllActions(),this.runAction(t.scaleUpAction)}var t=this,n=cc.find("Menu/AudioMng")||cc.find("Game/AudioMng");n&&(n=n.getComponent("AudioMng")),t.initScale=this.node.scale,t.button=t.getComponent(cc.Button),t.scaleDownAction=cc.scaleTo(t.transDuration,t.pressedScale),t.scaleUpAction=cc.scaleTo(t.transDuration,t.initScale),this.node.on("touchstart",function(e){t.enabled&&(this.stopAllActions(),n&&n.playButton(),this.runAction(t.scaleDownAction))},this.node),this.node.on("touchend",e,this.node),this.node.on("touchcancel",e,this.node)},onDisable:function(){this.node.stopAllActions(),this.node.scale=1}}),cc._RF.pop()},{}],C_BattleElapseTime:[function(e,t,n){"use strict";cc._RF.push(t,"7ecccak2DRGHIbPJyXK5jc9","C_BattleElapseTime");var i=e("TaskStatus"),a=e("BevCond"),o=e("AIEnumDef");cc.Class({extends:a,name:"C_BattleElapseTime",properties:{cmpType:{default:o.CmpType.Equal,type:o.CmpType,serializable:!0},timeMS:{default:4,type:cc.Integer,serializable:!0}},OnExcute:function(){var e=(new Date).getTime()-window.GGameEntry.BattleSystem.BattleData.StartTime;return this.cmpType==o.CmpType.Less?e<this.timeMS?i.Success:i.Failure:this.cmpType==o.CmpType.Greater?e>this.timeMS?i.Success:i.Failure:e==this.timeMS?i.Success:i.Failure}}),cc._RF.pop()},{AIEnumDef:"AIEnumDef",BevCond:"BevCond",TaskStatus:"TaskStatus"}],C_CanFire:[function(e,t,n){"use strict";cc._RF.push(t,"1225dSMbsFFS5NtBLdUy98Y","C_CanFire");var i=e("TaskStatus"),a=e("BevCond");cc.Class({extends:a,name:"C_CanFire",OnExcute:function(){var e=this.bevTree.actor;return!e||e.isDead?i.Failure:e.canShoot()?i.Success:i.Failure}}),cc._RF.pop()},{BevCond:"BevCond",TaskStatus:"TaskStatus"}],C_CheckUserVar:[function(e,t,n){"use strict";cc._RF.push(t,"840aboq5AlEN63nDfc+ekYq","C_CheckUserVar");var i=e("TaskStatus"),a=e("BevAction");cc.Class({name:"C_CheckUserVar",extends:a,properties:{varName:{default:"",type:cc.String},value:{default:0,type:cc.Integer}},OnExcute:function(){return this.bevTree.sharedVars.userVars[this.varName]==this.value?i.Success:i.Failure}}),cc._RF.pop()},{BevAction:"BevAction",TaskStatus:"TaskStatus"}],C_HasAnyGridAround:[function(e,t,n){"use strict";cc._RF.push(t,"51830glpO5P2JAn7HkZ47Dw","C_HasAnyGridAround");var i=e("TaskStatus"),a=e("BevCond"),o=(e("AiInterface"),e("AIUtil")),r=e("AIEnumDef"),s=e("AIMapUtil"),l=e("EntityTypeDefine");e("MapCfg");cc.Class({extends:a,name:"C_HasAnyGridAround",properties:{camp_select:{default:r.Camp_Select.My,type:r.Camp_Select},line_select:{default:l.EntityLineType.None,type:l.EntityLineType},gridsName:{default:"secondDefendGrids",type:cc.String}},OnExcute:function(){var e=this.bevTree.actor;if(!e||e.isDead)return i.Failure;var t=this.bevTree.actor.GetCamp();this.camp_select==r.Camp_Select.Enemy&&(t=o.GetEnemyCamp(t));var n=s.GetCampConfig(t);this.line_select==l.EntityLineType.Left?n=n.left:this.line_select==l.EntityLineType.Right?n=n.right:this.line_select==l.EntityLineType.Mid&&(n=n.mid);for(var a=n[this.gridsName],c=null,u=Number.MAX_SAFE_INTEGER,d=this.bevTree.actor.GetSmallGridPos(),h=this.bevTree.actor.GetPixelPos(),f=e.GetShootDistancePixel()*e.GetShootDistancePixel(),m=e.getBufferId()>0,y=0;y<a.length;y++){var p=a[y],g=cc.v2(p[0],p[1]),C=s.GetObstructInBigGrid(g,m);if(null!=C)for(var G=0;G<C.length;++G)if(!this.bevTree.sharedVars.lastTargetPos||!this.bevTree.sharedVars.lastTargetPos.equals(C[G])){var S=h.sub(s.GetGirdCenterPixelPos(C[G].x,C[G].y)).magSqr();S<=u&&S<f&&window.GGameEntry.MapManager.RaycastMapdata(d,C[G])&&(u=S,c=C[G])}}return null!=c?(e.targetPosToFire=c,i.Success):(e.targetPosToFire=null,i.Failure)}}),cc._RF.pop()},{AIEnumDef:"AIEnumDef",AIMapUtil:"AIMapUtil",AIUtil:"AIUtil",AiInterface:"AiInterface",BevCond:"BevCond",EntityTypeDefine:"EntityTypeDefine",MapCfg:"MapCfg",TaskStatus:"TaskStatus"}],C_HasBuf:[function(e,t,n){"use strict";cc._RF.push(t,"b98cc9xG0NB5qNfpZYkABx5","C_HasBuf");var i=e("TaskStatus"),a=e("BevCond");e("AiInterface"),e("AIUtil");cc.Class({extends:a,name:"C_HasBuf",properties:{bufID:{default:0,type:cc.Integer}},OnExcute:function(){var e=this.bevTree.actor;return!e||e.isDead?i.Failure:e.getBufferId()==this.bufID?i.Success:i.Failure}}),cc._RF.pop()},{AIUtil:"AIUtil",AiInterface:"AiInterface",BevCond:"BevCond",TaskStatus:"TaskStatus"}],C_HasTarget:[function(e,t,n){"use strict";cc._RF.push(t,"d103clEvLhI8pdl7XVwrkld","C_HasTarget");var i=e("TaskStatus"),a=e("BevCond");cc.Class({extends:a,name:"C_HasTarget",OnExcute:function(){var e=this.bevTree.actor;return!e||e.isDead?i.Failure:null!=e.targetGuid?i.Success:i.Failure}}),cc._RF.pop()},{BevCond:"BevCond",TaskStatus:"TaskStatus"}],C_IsAllyInRange:[function(e,t,n){"use strict";cc._RF.push(t,"8dc43y80B1ItpHsw9aJObCd","C_IsAllyInRange");var i=e("TaskStatus"),a=e("BevCond"),o=e("AIUtil");e("MapCfg");cc.Class({extends:a,name:"C_IsAllyInRange",OnExcute:function(){var e=this.bevTree.actor;if(!e||e.isDead)return i.Failure;var t=null;if(null!=e.targetGuid){var n=o.FindTargetObj(o.GetEnemyCamp(e.EntityCampType),e.targetGuid);t=null!=n?n.node.position:null}else if(null!=e.targetPosToFire){var a=window.GGameEntry.MapManager.GetWorldPositionCenter(e.targetPosToFire.x,e.targetPosToFire.y);t=cc.v2(a[0],a[1])}if(null==t)return i.Failure;for(var r=t.sub(e.node.position),s=r.magSqr(),l=o.GetSceneTanks(e.EntityCampType),c=0;c<l.length;c++)if(l[c]!=e){var u=l[c].node.position.sub(e.node.position),d=u.magSqr();if(!(d>s)){if(d<window.GGameEntry.MapManager.GridSize*window.GGameEntry.MapManager.GridSize)return i.Success;var h=u.angle(r)/Math.PI*180;if(!(h>80)&&h<45/(Math.sqrt(d)/window.GGameEntry.MapManager.GridSize-1))return i.Success}}return i.Failure}}),cc._RF.pop()},{AIUtil:"AIUtil",BevCond:"BevCond",MapCfg:"MapCfg",TaskStatus:"TaskStatus"}],C_IsBeingShooted:[function(e,t,n){"use strict";cc._RF.push(t,"42c4enXibJBXbLxxi/vB9Ml","C_IsBeingShooted");var i=e("TaskStatus"),a=e("BevCond"),o=e("AIUtil");cc.Class({extends:a,name:"C_IsBeingShooted",OnExcute:function(){var e=this.bevTree.actor;if(!e||e.isDead)return i.Failure;var t=o.GetBulletFlyMe(e);return null!=t&&t.length>0?i.Success:i.Failure}}),cc._RF.pop()},{AIUtil:"AIUtil",BevCond:"BevCond",TaskStatus:"TaskStatus"}],C_IsItemInRange:[function(e,t,n){"use strict";cc._RF.push(t,"85241YMYVVMMqIVWOam5bdD","C_IsItemInRange");var i=e("TaskStatus"),a=e("BevCond"),o=e("AIUtil");cc.Class({extends:a,name:"C_IsItemInRange",properties:{radius_pixel:{default:25,type:cc.Integer}},OnExcute:function(){var e=o.GetItemsInCircle(this.bevTree.actor,this.radius_pixel);return!e||e.length<=0?i.Failure:(this.bevTree.sharedVars.itemPos=e[0].GetSmallGridPos(),i.Success)}}),cc._RF.pop()},{AIUtil:"AIUtil",BevCond:"BevCond",TaskStatus:"TaskStatus"}],C_IsMyBaseInRange:[function(e,t,n){"use strict";cc._RF.push(t,"9ae5d3jSKdB5bMohR2QBv/b","C_IsMyBaseInRange");var i=e("TaskStatus"),a=e("BevCond");cc.Class({extends:a,name:"C_IsMyBaseInRange",OnExcute:function(){var e=this.bevTree.actor;return!e||e.isDead?i.Failure:e.canShoot()?i.Success:i.Failure}}),cc._RF.pop()},{BevCond:"BevCond",TaskStatus:"TaskStatus"}],C_IsTargetInRange:[function(e,t,n){"use strict";cc._RF.push(t,"071e7XH8DdJG5xTTqdBesM0","C_IsTargetInRange");var i=e("TaskStatus"),a=e("BevCond"),o=e("AIUtil");e("MapCfg");cc.Class({extends:a,name:"C_IsTargetInRange",OnExcute:function(){var e=this.bevTree.actor;if(!e||e.isDead)return i.Failure;if(!e.targetGuid)return i.Failure;var t=o.FindTargetObj(o.GetEnemyCamp(e.EntityCampType),e.targetGuid);return null==t||t.isDead?i.Failure:o.CanDirectAttack_Pixel(e.GetPixelPos(),e.GetShootDistancePixel(),t.GetPixelPos())?i.Success:i.Failure}}),cc._RF.pop()},{AIUtil:"AIUtil",BevCond:"BevCond",MapCfg:"MapCfg",TaskStatus:"TaskStatus"}],C_LockAirdropBox:[function(e,t,n){"use strict";cc._RF.push(t,"73421TkGARBBaVhzUI60001","C_LockAirdropBox");var i=e("TaskStatus"),a=e("BevCond"),o=(e("AiInterface"),e("AIUtil")),r=(e("AIEnumDef"),e("AIMapUtil"),e("EntityTypeDefine"),e("MapCfg"),e("Util"));cc.Class({extends:a,name:"C_LockAirdropBox",properties:{radius_Pixel:{default:300,type:cc.Integer}},OnExcute:function(){var e=this.bevTree.actor;if(!e||e.isDead)return i.Failure;if(!window.GGameEntry.AirDropSystem.AirDropBoxArray)return i.Failure;if(window.GGameEntry.AirDropSystem.AirDropBoxArray.length<=0)return i.Failure;for(var t=Number.MAX_SAFE_INTEGER,n=null,a=0;a<window.GGameEntry.AirDropSystem.AirDropBoxArray.length;++a){var s=window.GGameEntry.AirDropSystem.AirDropBoxArray[a].getComponent("AirDropBox");if(s){var l=e.GetPixelPos().sub(s.GetPixelPos()).magSqr();l<=t&&o.IsTargetPosInRange(e.GetPixelPos(),this.radius_Pixel,s.GetPixelPos())&&(t=l,n=s)}}return null!=n?(e.targetGuid=n.Guid,r.AssertCheck(0!=n.Guid,"目标对象的Guid不能为空"),i.Success):(e.targetGuid=null,i.Failure)}}),cc._RF.pop()},{AIEnumDef:"AIEnumDef",AIMapUtil:"AIMapUtil",AIUtil:"AIUtil",AiInterface:"AiInterface",BevCond:"BevCond",EntityTypeDefine:"EntityTypeDefine",MapCfg:"MapCfg",TaskStatus:"TaskStatus",Util:"Util"}],C_LockBase:[function(e,t,n){"use strict";cc._RF.push(t,"67951uBYMxAzZiXTKRXPrpm","C_LockBase");var i=e("TaskStatus"),a=e("BevCond"),o=e("AIUtil"),r=(e("AIMapUtil"),e("MapCfg"),e("Util"));cc.Class({extends:a,name:"C_LockBase",properties:{isEnemy:{default:!0,type:cc.Boolean},radius_grid:{default:10,type:cc.Integer}},OnExcute:function(){var e=this.bevTree.actor;if(!e||e.isDead)return i.Failure;var t=window.GGameEntry.MapManager.GetMapBattleHome(o.GetEnemyCamp(e.EntityCampType));return r.AssertCheck(null!=t,"获取地方基地对象失败, camp="+o.GetEnemyCamp(e.EntityCampType)),t?o.CanDirectAttack_Grid(e.GetSmallGridPos(),this.radius_grid,t.GetSmallGridPos())?(e.targetGuid=t.GetGuid(),r.AssertCheck(0!=e.targetGuid,"基地对象的Guid不能为空,camp="+o.GetEnemyCamp(e.EntityCampType)),i.Success):(e.targetGuid=null,i.Failure):i.Failure}}),cc._RF.pop()},{AIMapUtil:"AIMapUtil",AIUtil:"AIUtil",BevCond:"BevCond",MapCfg:"MapCfg",TaskStatus:"TaskStatus",Util:"Util"}],C_LockTargetInArea:[function(e,t,n){"use strict";cc._RF.push(t,"cf20cNN68dOGbkbpdIQbTu7","C_LockTargetInArea");var i=e("TaskStatus"),a=e("BevCond"),o=(e("AiInterface"),e("AIUtil")),r=e("AIEnumDef"),s=e("AIMapUtil"),l=(e("EntityTypeDefine"),e("MapCfg")),c=e("Util");cc.Class({extends:a,name:"C_LockTargetInArea",properties:{camp_select:{default:r.Camp_Select.My,type:r.Camp_Select},areaName:{default:"secondDefendGrids",type:cc.String}},OnExcute:function(){var e=this.bevTree.actor;if(!e||e.isDead)return i.Failure;var t=this.bevTree.actor.GetCamp();this.camp_select==r.Camp_Select.Enemy&&(t=o.GetEnemyCamp(t));for(var n=s.GetCampConfig(t)[this.areaName],a=cc.v2(l.MapGlobalCfg.MapTileSize[0],l.MapGlobalCfg.MapTileSize[1]),u=n[0],d=cc.v2(u[0]*a.x,u[1]*a.y),h=n[1],f=cc.v2(h[0]*a.x+a.x-1,h[1]*a.y+a.y-1),m=o.GetSceneTanks(o.GetEnemyCamp(t)),y=null,p=0;p<m.length;++p)if(!m[p].Invincible){var g=m[p].GetSmallGridPos();if(g.x>=d.x&&g.x<=f.x&&g.y>=d.y&&g.y<=f.y){y=m[p];break}}return null!=y?(e.targetGuid=y.Guid,c.AssertCheck(0!=y.Guid,"目标对象的Guid不能为空"),i.Success):(e.targetGuid=null,i.Failure)}}),cc._RF.pop()},{AIEnumDef:"AIEnumDef",AIMapUtil:"AIMapUtil",AIUtil:"AIUtil",AiInterface:"AiInterface",BevCond:"BevCond",EntityTypeDefine:"EntityTypeDefine",MapCfg:"MapCfg",TaskStatus:"TaskStatus",Util:"Util"}],C_LockTargetNearbyMyBase:[function(e,t,n){"use strict";cc._RF.push(t,"94f5didEG1LFqMG0qIlk1+3","C_LockTargetNearbyMyBase");var i=e("TaskStatus"),a=e("BevCond"),o=(e("AIMapUtil"),e("AIUtil")),r=e("Util");cc.Class({extends:a,name:"C_LockTargetNearbyMyBase",properties:{radius:{default:500,type:cc.Integer,serializable:!0}},OnExcute:function(){r.BeginSample("C_LockTargetNearbyMyBase::OnExcute");var e=this.bevTree.actor;if(!e||e.isDead)return i.Failure;var t=window.GGameEntry.MapManager.GetMapBattleHome(e.GetCamp());if(r.AssertCheck(null!=t,"获取基地对象失败, camp="+e.GetCamp()),!t)return cc.log("Get Base Failed"),i.Failure;var n=t.GetPixelPos(),a=o.GetNearestEnemysAtPosition(n,e.GetCamp());return null!=a&&a.GetPixelPos().sub(n).magSqr()<=this.radius*this.radius?(e.targetGuid=a.Guid,r.EndSample("C_LockTargetNearbyMyBase::OnExcute"),i.Success):(e.targetGuid=null,r.EndSample("C_LockTargetNearbyMyBase::OnExcute"),i.Failure)}}),cc._RF.pop()},{AIMapUtil:"AIMapUtil",AIUtil:"AIUtil",BevCond:"BevCond",TaskStatus:"TaskStatus",Util:"Util"}],C_LockTargetOfAllies:[function(e,t,n){"use strict";cc._RF.push(t,"1e1a4eOTtxAhLUc3huCOhL2","C_LockTargetOfAllies");var i=e("TaskStatus"),a=e("BevCond"),o=e("AIUtil"),r=e("Util");cc.Class({extends:a,name:"C_LockTargetOfAllies",properties:{radius:{default:500,type:cc.Integer,serializable:!0}},OnExcute:function(){r.BeginSample("C_LockTargetOfAllies::OnExcute");var e=this.bevTree.actor;if(!e||e.isDead)return i.Failure;for(var t=o.GetSceneTanks(e.EntityCampType),n=Number.MAX_SAFE_INTEGER,a=null,s=0;s<t.length;++s)if(e!=t[s]&&null!=t[s].targetGuid){var l=o.FindTargetObj(o.GetEnemyCamp(e.EntityCampType),t[s].targetGuid);if(null!=l&&!l.isDead){var c=e.GetSmallGridPos().sub(l.GetSmallGridPos()).magSqr();c<=n&&(n=c,a=t[s].targetGuid)}}return null!=a?(e.targetGuid=a,i.Success):(e.targetGuid=null,r.EndSample("C_LockTargetOfAllies::OnExcute"),i.Failure)}}),cc._RF.pop()},{AIUtil:"AIUtil",BevCond:"BevCond",TaskStatus:"TaskStatus",Util:"Util"}],C_LockTargetWithBuf:[function(e,t,n){"use strict";cc._RF.push(t,"b17ca9CH79LLoW112oc9bNJ","C_LockTargetWithBuf");var i=e("TaskStatus"),a=e("BevCond"),o=(e("AiInterface"),e("AIUtil")),r=e("Util");cc.Class({extends:a,name:"C_LockTargetWithBuf",properties:{bufID:{default:0,type:cc.Integer}},OnExcute:function(){r.BeginSample("C_LockTargetWithBuf::OnExcute");var e=this.bevTree.actor;if(!e||e.isDead)return i.Failure;for(var t=o.GetSceneTanks(o.GetEnemyCamp(e.EntityCampType)),n=0;n<t.length;n++)if(t[n].getBufferId()==this.bufID)return e.targetGuid=t[n].Guid,r.EndSample("C_LockTargetWithBuf::OnExcute"),i.Success;return e.targetGuid=null,r.EndSample("C_LockTargetWithBuf::OnExcute"),i.Failure}}),cc._RF.pop()},{AIUtil:"AIUtil",AiInterface:"AiInterface",BevCond:"BevCond",TaskStatus:"TaskStatus",Util:"Util"}],C_LockTarget:[function(e,t,n){"use strict";cc._RF.push(t,"f7dee3lZahAwIxtJZ4TDHlr","C_LockTarget");var i=e("TaskStatus"),a=e("BevCond"),o=(e("AiInterface"),e("AIUtil"));cc.Class({extends:a,name:"C_LockTarget",properties:{radius:{default:500,type:cc.Integer,serializable:!0}},OnExcute:function(){var e=this.bevTree.actor;if(!e||e.isDead)return i.Failure;var t=o.GetNearestEnemys(e);return null!=t&&t.node.position.sub(e.node.position).magSqr()<=this.radius*this.radius?(e.targetGuid=t.Guid,i.Success):(e.targetGuid=null,i.Failure)}}),cc._RF.pop()},{AIUtil:"AIUtil",AiInterface:"AiInterface",BevCond:"BevCond",TaskStatus:"TaskStatus"}],CameraShake:[function(e,t,n){"use strict";cc._RF.push(t,"1efa9Zre45Ox59QPubA01oV","CameraShake");var i=e("ResTableNames");cc.Class({extends:cc.Component,properties:{startShake:{default:!1},seconds:{default:0},started:{default:0},quake:{default:10},sourceSeconds:{default:.5}},onLoad:function(){this.node=new cc.Node},update:function(e){},getShakePosint:function(e){if(this.started&&(this.seconds=this.seconds-1e3*e,this.seconds<0&&(this.startShake=!1,this.started=!1)),this.startShake){var t=Math.random();return cc.v2(this.quake*t,this.quake*t)}return cc.v2(0,0)},ShakeFor:function(){this.quake=parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(i.star_global_cs,27).Value),this.sourceSeconds=parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(i.star_global_cs,28).Value),this.seconds=this.sourceSeconds,this.started=!0,this.startShake=!0}}),cc._RF.pop()},{ResTableNames:"ResTableNames"}],ClearTargets:[function(e,t,n){"use strict";cc._RF.push(t,"e2ecdHP0vpD46Y4RdVEEQSI","ClearTargets");var i=e("TaskStatus"),a=e("BevAction");cc.Class({name:"ClearTargets",extends:a,properties:{},OnExcute:function(){var e=this.bevTree.actor;return e.targetGuid=null,e.targetPosToFire=null,i.Success}}),cc._RF.pop()},{BevAction:"BevAction",TaskStatus:"TaskStatus"}],CmdAddBuff:[function(e,t,n){"use strict";cc._RF.push(t,"81a48zVJblM77rO3IRM87Q2","CmdAddBuff");var i=e("CmdBase"),a=e("CmdDefine"),o=(e("EntityManager"),e("EntityTypeDefine")),r=e("BuffBase"),s=(e("BuffDefine"),e("BuffFreeze")),l=e("BuffInvincible"),c=e("BuffPowerUp"),u=(e("star_comm"),e("CmdSkill")),d=e("star_cs"),h=e("BuffSpeedUp"),f=e("BuffAddSpeed"),m=e("BuffBulletUp"),y=e("BuffBulletFillUp"),p=e("BuffGlobal"),g=e("BuffBulletDistance"),C=e("BuffBulletSpeedUp"),G=e("BuffJiaXue"),S=e("BuffJiaSuItem"),E=e("BuffEffectFactory");cc.Class({extends:i,properties:{entityGuid:0,buffId:0,BuffOp:0},Init:function(e,t){this.cmdType=a.CmdType.CmdType_AddBuff,this.entityGuid=e,this.buffId=t},ServerDataToClient:function(e){this.entityGuid=e.SD.BuffNotify.P[0],this.buffId=e.SD.BuffNotify.P[1],this.LeftTime=e.SD.BuffNotify.P[2],this.BuffOp=e.SD.BuffNotify.P[3]},Execute:function(){var e=window.GGameEntry.EntityManager.getEntity(this.entityGuid);if(e&&(e.GetEntityType()==o.EntityType.EntityPlayer||e.GetEntityType()==o.EntityType.EntityMonster||e.GetEntityType()==o.EntityType.EntityOtherPlayer||e.GetEntityType()==o.EntityType.EntityHide))if(this.BuffOp===d.BuffOp.BUFF_OP_ADD){var t=null,n=null;if(2==this.buffId&&(t=new c),3==this.buffId&&(t=new s),4==this.buffId){var i=new u;i.Init(3,this.entityGuid,this.buffId),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(i)}if(5==this.buffId&&(t=new l),6==this.buffId&&(t=new h),7==this.buffId&&(t=new m),8==this.buffId&&(t=new y),9==this.buffId&&(t=new C),10==this.buffId&&(t=new g),11==this.buffId&&(t=new f),12==this.buffId&&(t=new p),13==this.buffId&&(t=new p),14==this.buffId&&(t=new r)&&t.animationZIndex&&(t.animationZIndex=-1),15==this.buffId&&(t=new r)&&t.animationZIndex&&(t.animationZIndex=-1),16==this.buffId&&(t=new r)&&t.animationZIndex&&(t.animationZIndex=-1),17==this.buffId&&(t=new G),18==this.buffId&&(t=new S),19!=this.buffId&&20!=this.buffId&&21!=this.buffId&&22!=this.buffId&&24!=this.buffId&&25!=this.buffId||(n=E.GetBuffEffectList(this.buffId)),23==this.buffId&&(t=new l),t&&(t.init(this.buffId),e.BuffManager?e.BuffManager.applyBuff(t):e.applyBuff&&e.applyBuff(t)),n)for(var a=0;a<n.length;a++)e.BuffManager&&e.BuffManager.applyBuff(n[a])}else this.BuffOp===d.BuffOp.BUFF_OP_DEL?e.BuffManager&&e.BuffManager.removeBuff&&e.BuffManager.removeBuff(this.buffId):this.BuffOp===d.BuffOp.BUFF_OP_OVERLAY&&e.BuffManager&&e.BuffManager.resetBuff&&e.BuffManager.resetBuff(this.buffId)}}),cc._RF.pop()},{BuffAddSpeed:"BuffAddSpeed",BuffBase:"BuffBase",BuffBulletDistance:"BuffBulletDistance",BuffBulletFillUp:"BuffBulletFillUp",BuffBulletSpeedUp:"BuffBulletSpeedUp",BuffBulletUp:"BuffBulletUp",BuffDefine:"BuffDefine",BuffEffectFactory:"BuffEffectFactory",BuffFreeze:"BuffFreeze",BuffGlobal:"BuffGlobal",BuffInvincible:"BuffInvincible",BuffJiaSuItem:"BuffJiaSuItem",BuffJiaXue:"BuffJiaXue",BuffPowerUp:"BuffPowerUp",BuffSpeedUp:"BuffSpeedUp",CmdBase:"CmdBase",CmdDefine:"CmdDefine",CmdSkill:"CmdSkill",EntityManager:"EntityManager",EntityTypeDefine:"EntityTypeDefine",star_comm:"star_comm",star_cs:"star_cs"}],CmdAttr:[function(e,t,n){"use strict";cc._RF.push(t,"695a5ucvE5JrbjSyISqHxlt","CmdAttr");var i=e("CmdBase"),a=e("CmdDefine"),o=(e("EntityManager"),e("EntityTypeDefine"),e("BuffBase"),e("BuffDefine"),e("BuffFreeze"),e("BuffInvincible"),e("BuffPowerUp"),e("star_comm"));e("CmdSkill"),e("star_cs");cc.Class({extends:i,properties:{num:0,attrList:0},Init:function(e,t){this.cmdType=a.CmdType.CmdType_AddBuff,this.entityGuid=e,this.buffId=t},ServerDataToClient:function(e){this.num=e.SD.AttrNotify.Num,this.attrList=e.SD.AttrNotify.List},Execute:function(){for(var e=0;e<this.num;e++){var t=this.attrList[e];if(t){var n=window.GGameEntry.EntityManager.getEntity(t.ObjID);if(n)for(var i=t.AttrList,a=0;a<i.length;a++){var r=i[a];r&&(r.AttrID===o.AttrType.ATTR_HP?(n.Hp=r.Value,0===n.Hp&&n.OnDie()):r.AttrID===o.AttrType.ATTR_MAX_HP?n.MaxHp=r.Value:r.AttrID===o.AttrType.ATTR_SPEED?n.CfgSourceConfigSpeed=r.Value:r.AttrID===o.AttrType.ATTR_BULLET_FILL_UP_LIMIT?n.CfgBulletLeftNum=r.Value:r.AttrID===o.AttrType.ATTR_BULLET_FILL_INTERVAL&&(n.CfgBulletFillTime=r.Value))}}}}}),cc._RF.pop()},{BuffBase:"BuffBase",BuffDefine:"BuffDefine",BuffFreeze:"BuffFreeze",BuffInvincible:"BuffInvincible",BuffPowerUp:"BuffPowerUp",CmdBase:"CmdBase",CmdDefine:"CmdDefine",CmdSkill:"CmdSkill",EntityManager:"EntityManager",EntityTypeDefine:"EntityTypeDefine",star_comm:"star_comm",star_cs:"star_cs"}],CmdBase:[function(e,t,n){"use strict";cc._RF.push(t,"823faypelBK/IndLQQlHs/T","CmdBase");var i=e("CmdDefine");cc.Class({properties:{id:{default:0,serializable:!1,visible:!1},cmdType:{default:i.CmdType.CmdType_None,type:i.CmdType}},onLoad:function(){},Init:function(){},Execute:function(){}}),cc._RF.pop()},{CmdDefine:"CmdDefine"}],CmdBuffSync:[function(e,t,n){"use strict";cc._RF.push(t,"2f1eaEruSZEt4bI44+3H5O8","CmdBuffSync");var i=e("CmdBase"),a=e("CmdDefine"),o=(e("EntityManager"),e("star_comm"),e("CmdAddBuff"));cc.Class({extends:i,Init:function(e,t){this.cmdType=a.CmdType.CmdType_DeleteItem,this.entityGuid=e,this.targetGuid=t},Execute:function(){if(this._super(),window.GGameEntry.EntityManager.getEntity(this.entityGUID)){var e=new o;e.Init(this.entityGUID,this.buffID),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(e)}}}),cc._RF.pop()},{CmdAddBuff:"CmdAddBuff",CmdBase:"CmdBase",CmdDefine:"CmdDefine",EntityManager:"EntityManager",star_comm:"star_comm"}],CmdDefine:[function(e,t,n){"use strict";cc._RF.push(t,"9c14cJgwlVPUYXxi53NxYa6","CmdDefine");var i=cc.Enum({CmdType_None:0,CmdType_Skill:1,CmdType_Move:2,CmdType_DeleteItem:3,CmdType_AddBuff:4,CmdType_Forward:5,CmdType_StartGame:6,CmdType_StartLoadGame:7,CmdType_DeleteObj:8,CmdType_Hit:9,CmdType_MovePath:10});t.exports={CmdType:i},cc._RF.pop()},{}],CmdDeleteItem:[function(e,t,n){"use strict";cc._RF.push(t,"3306ctMUdRLzrw08jAMkp+j","CmdDeleteItem");e("CmdBase");var i=e("CmdDefine"),a=(e("EntityManager"),e("ItemManager"),e("CmdDeleteObj"));cc.Class({extends:a,Init:function(e,t){this.cmdType=i.CmdType.CmdType_DeleteItem,this.entityGuid=e,this.targetGuid=t},Execute:function(){this._super()}}),cc._RF.pop()},{CmdBase:"CmdBase",CmdDefine:"CmdDefine",CmdDeleteObj:"CmdDeleteObj",EntityManager:"EntityManager",ItemManager:"ItemManager"}],CmdDeleteObj:[function(e,t,n){"use strict";cc._RF.push(t,"26c71SIjURM8KUN+Qgvhnk8","CmdDeleteObj");var i=e("CmdBase"),a=e("CmdDefine");e("EntityManager"),e("ItemManager");cc.Class({extends:i,properties:{entityGuid:0,targetGuid:0},Init:function(e,t){this.cmdType=a.CmdType.CmdType_DeleteObj,this.entityGuid=e,this.targetGuid=t},Execute:function(){var e=window.GGameEntry.EntityManager.getEntity(this.targetGuid);e&&"function"==typeof e.OnDie&&e.OnDie()}}),cc._RF.pop()},{CmdBase:"CmdBase",CmdDefine:"CmdDefine",EntityManager:"EntityManager",ItemManager:"ItemManager"}],CmdEffectHurt:[function(e,t,n){"use strict";cc._RF.push(t,"6599ax63NNFyZOkfjBiPP+g","CmdEffectHurt");var i=e("CmdBase"),a=e("CmdDefine"),o=(e("EntityManager"),e("star_comm"),e("EntityTypeDefine"));cc.Class({extends:i,Init:function(e,t){this.cmdType=a.CmdType.CmdType_Hit,this.entityGuid=e,this.targetGuid=t,this.adobeArray=[]},ServerDataToClient:function(e){this.DataToClient(e.SD.EffectNotify)},DataToClient:function(e){this.entityGuid=e.CasterID,this.Total=e.Total,this.Effects=e.Effects},Execute:function(){this._super();var e=window.GGameEntry.EntityManager.getEntity(this.entityGuid);if(e){this.adobeArray=[];for(r=0;r<this.Total;r++){var t=this.Effects[r];if(t){var n=window.GGameEntry.EntityManager.getEntity(t.ObjID);n&&1===t.EffectType&&(n.OnSetHp(t.EffectData.Hurt.Hp),t.EffectData.Hurt.Die&&(void 0!==n.LastHitByEntity&&(n.LastHitByEntity=e),n.EntityType===o.EntityType.EntityAdobe||n.EntityType===o.EntityType.EntitySteel?this.adobeArray[this.adobeArray.length]=n:n.OnDie()))}}if(this.adobeArray.length){for(var i=0,a=0,r=0;r<this.adobeArray.length;r++)0!=r&&(this.PlayDeathAni=!1),i+=this.adobeArray[r].node.x,a+=this.adobeArray[r].node.y;i/=this.adobeArray.length,a/=this.adobeArray.length;var s=this.adobeArray[0].node.x-i,l=this.adobeArray[0].node.y-a;this.adobeArray[0].EffectOffSetX=s,this.adobeArray[0].EffectOffSetY=l;for(r=0;r<this.adobeArray.length;r++)this.adobeArray[r].OnDie()}}}}),cc._RF.pop()},{CmdBase:"CmdBase",CmdDefine:"CmdDefine",EntityManager:"EntityManager",EntityTypeDefine:"EntityTypeDefine",star_comm:"star_comm"}],CmdForward:[function(e,t,n){"use strict";cc._RF.push(t,"ad9a7hoga5JbaaAzP7spvnh","CmdForward");var i=e("CmdBase"),a=e("CmdDefine");cc.Class({extends:i,properties:{entityGuid:{default:0},forward:{default:cc.v2(0,0),serializable:!1,visible:!1}},Init:function(e,t){this.cmdType=a.CmdType.CmdType_Forward,this.entityGuid=e,this.forward=t},Execute:function(){var e=window.GGameEntry.EntityManager.getEntity(this.entityGuid);e&&(e.PaoTaiNode.forward=this.forward)}}),cc._RF.pop()},{CmdBase:"CmdBase",CmdDefine:"CmdDefine"}],CmdMgr:[function(e,t,n){"use strict";cc._RF.push(t,"93709EsAYFA+b/ggiZVhplP","CmdMgr");e("GlobalCfg");cc.Class({properties:{Cmds:{default:null,serializable:!1,visible:!1}},onLoad:function(){},Init:function(e){this.game=e,this.Cmds=[]},Release:function(){this.Cmds.length>0&&this.Cmds.splice(0,this.Cmds.length)},AddCmd:function(e){e.Execute()},AddCmdSync:function(e){this.Cmds.push(e)},update:function(e){null!=this.Cmds&&this.processCmd()},processCmd:function(){if(this.Cmds.length>0){for(var e=0;e<this.Cmds.length;++e)this.Cmds[e].Execute();this.Cmds.splice(0,this.Cmds.length)}}}),cc._RF.pop()},{GlobalCfg:"GlobalCfg"}],CmdMovePath:[function(e,t,n){"use strict";cc._RF.push(t,"b1baczoAURF2oBvclFvJ1w5","CmdMovePath");var i=e("CmdBase"),a=e("CmdDefine");e("EntityManager"),e("star_comm");cc.Class({extends:i,properties:{PointCnt:{default:0,serializable:!1,visible:!1},PointArray:{default:[],serializable:!1,visible:!1},Dir:{default:0,serializable:!1,visible:!1}},Init:function(e,t){this.cmdType=a.CmdType.CmdType_MovePath,this.entityGUID=e,this.targetGuid=t},ServerDataToClient:function(e){this.entityGUID=e.SD.MP.P[0],this.PointArray=cc.v2(e.SD.MP.P[1],e.SD.MP.P[2]),this.Time=e.SD.MP.P[3],this.Dir=e.SD.MP.P[4]},Execute:function(){this._super();var e=window.GGameEntry.EntityManager.getEntity(this.entityGUID);if(e){var t=this.PointArray;e.setPosAndDir(t,this.Dir,this.Time)}}}),cc._RF.pop()},{CmdBase:"CmdBase",CmdDefine:"CmdDefine",EntityManager:"EntityManager",star_comm:"star_comm"}],CmdMoveStop:[function(e,t,n){"use strict";cc._RF.push(t,"4f444sutsJHLIzmTGKqMxu2","CmdMoveStop");var i=e("CmdBase"),a=e("CmdDefine");e("EntityManager"),e("star_comm");cc.Class({extends:i,properties:{PointCnt:{default:0,serializable:!1,visible:!1},PointArray:{default:[],serializable:!1,visible:!1},Dir:{default:0,serializable:!1,visible:!1}},Init:function(e,t){this.cmdType=a.CmdType.CmdType_MovePath,this.entityGUID=e,this.targetGuid=t},ServerDataToClient:function(e){this.entityGUID=e.SD.MS.P[0],this.PointCnt=1,this.PointArray=cc.v2(e.SD.MS.P[4],e.SD.MS.P[5]),this.Dir=e.SD.MS.P[3]},Execute:function(){this._super()}}),cc._RF.pop()},{CmdBase:"CmdBase",CmdDefine:"CmdDefine",EntityManager:"EntityManager",star_comm:"star_comm"}],CmdMove:[function(e,t,n){"use strict";cc._RF.push(t,"5d1cdeDAR9IhY2IIuKBPf50","CmdMove");var i=e("CmdBase"),a=e("CmdDefine");cc.Class({extends:i,properties:{entityGuid:0,targetSmallGrid:cc.v2(0,0)},Init:function(e,t){this.cmdType=a.CmdType.CmdType_Move,this.entityGuid=e,this.targetSmallGrid=t},Execute:function(){var e=window.GGameEntry.EntityManager.getEntity(this.entityGuid);e&&e.aiSetMoveTarget(this.targetSmallGrid)}}),cc._RF.pop()},{CmdBase:"CmdBase",CmdDefine:"CmdDefine"}],CmdShowEmoticon:[function(e,t,n){"use strict";cc._RF.push(t,"25477ChtSxGJJg7LcLXVT2H","CmdShowEmoticon");e("UIManager");var i=e("CmdBase");cc.Class({extends:i,properties:{EmoticionID:0,ObjID:0},Init:function(e,t){this.EmoticionID=e,this.ObjID=t},Execute:function(){window.GGameEntry.NotificationCenter.emit("OnReceiveShowEmoticon",{guid:this.ObjID,emoticonID:this.EmoticionID})}}),cc._RF.pop()},{CmdBase:"CmdBase",UIManager:"UIManager"}],CmdSkill:[function(e,t,n){"use strict";cc._RF.push(t,"275d3ErdMFEbpCz3TobutaO","CmdSkill");var i=e("CmdBase"),a=e("CmdDefine"),o=e("SkillDefine");cc.Class({extends:i,properties:{skillType:{default:0,serializable:!1,visible:!1},entityGuid:{default:0},skillArg:{default:0,serializable:!1,visible:!1},dir:-1,seq:-1},Init:function(e,t,n){this.cmdType=a.CmdType.CmdType_Skill,this.skillType=e,this.entityGuid=t,this.skillArg=n},Execute:function(){var e=window.GGameEntry.EntityManager.getEntity(this.entityGuid);e&&(-1!==this.dir&&void 0!==e.rotateAll&&e.rotateAll(this.dir),this.skillType==o.SkillType.SkillType_NormalAttack?e.noramlAttackSkill&&e.noramlAttackSkill.UseSkill(this.seq):this.skillType==o.SkillType.SkillType_PickBuffItem?e.PickBufferSkill&&e.PickBufferSkill.UseSkill(this.seq):this.skillType==o.SkillType.SkillType_BlockDisapper?e.BlockDisappearSkill&&e.BlockDisappearSkill.UseSkill(this.seq):this.skillType==o.SkillType.SkillType_Flash&&e.flashSkill&&(e.flashSkill.SetSkillArg(this.skillArg),e.flashSkill.UseSkill(this.seq)))}}),cc._RF.pop()},{CmdBase:"CmdBase",CmdDefine:"CmdDefine",SkillDefine:"SkillDefine"}],CmdStartGame:[function(e,t,n){"use strict";cc._RF.push(t,"1a7de+GggRAl7niU+5IEJ8z","CmdStartGame");var i=e("CmdBase"),a=e("CmdDefine"),o=(e("EntityManager"),e("GlobalCfg")),r=(e("ServerLog"),e("UIManager"));cc.Class({extends:i,properties:{SyncTime:{default:0,serializable:!1,visible:!1},BattleTime:{default:0,serializable:!1,visible:!1},GameBeginTime:{default:0,serializable:!1,visible:!1},Reconnected:{default:0,serializable:!1,visible:!1}},Init:function(){this.cmdType=a.CmdType.CmdType_StartGame},Execute:function(){window.GGameEntry.BattleRoot.EnableMe(),window.GGameEntry.UIManager.HideUI(r.UIType.LogoUI),window.GGameEntry.UIManager.HideUI(r.UIType.BattleLoadingUI),window.GGameEntry.UIManager.HideUI(r.UIType.ActivityUI),window.GGameEntry.CurGamePlayType===o.GamePlayType.GamePlayType_Network&&(window.GGameEntry.BattleSystem.BattleData.FullBattleTime=this.BattleTime,window.GGameEntry.BattleSystem.BattleData.SvrTime=this.SyncTime,window.GGameEntry.BattleSystem.BattleData.StartTime=1e3*this.GameBeginTime),this.Reconnected?(window.GGameEntry.BattleSystem.updateBattleTime(),window.GGameEntry.UIManager.ShowUI(r.UIType.BattleUI),window.GGameEntry.BattleRoot.SetBattleViewTarget(window.GGameEntry.PlayerManager.Player.node)):window.GGameEntry.IsGuiding()?window.GGameEntry.UIManager.ShowUI(r.UIType.GuideUI,r.UIOrder.Default+10):(window.GGameEntry.UIManager.ShowUI(r.UIType.TargetDescriptionUI),window.GGameEntry.BattleSystem.Pause(!0)),console.log("CmdType_StartGame execute:"),window.GGameEntry.ServerLogHelp("CmdType_StartGame execute:"),window.GGameEntry.MapManager.DebugCheck_CheckAll(),window.GGameEntry.ItemManager.DebugCheck_CheckAll(),window.GGameEntry.BattleSystem.ResetBattleKillData(),window.GGameEntry.BattleSystem.GameReady=!0,window.GGameEntry.NotificationCenter.emit("OnBattleMapReady",this),window.GGameEntry.GBattleNetwork.PauseRecvMsg(!1)}}),cc._RF.pop()},{CmdBase:"CmdBase",CmdDefine:"CmdDefine",EntityManager:"EntityManager",GlobalCfg:"GlobalCfg",ServerLog:"ServerLog",UIManager:"UIManager"}],CmdStartLoadMap:[function(e,t,n){"use strict";cc._RF.push(t,"74b27Jybz5Be5WF78WyHwW7","CmdStartLoadMap");var i=e("CmdBase"),a=e("CmdDefine");e("EntityManager"),e("UIManager");cc.Class({extends:i,properties:{MapID:{default:0,serializable:!1,visible:!1}},Init:function(){this.cmdType=a.CmdType.CmdType_StartLoadGame},Execute:function(){window.GGameEntry.BattleSystem.MapID=this.MapID,window.GGameEntry.CursorMapId=this.MapID,window.GGameEntry.BattleSystem.EnterBattle(),console.log("CmdType_StartLoadGame execute:")}}),cc._RF.pop()},{CmdBase:"CmdBase",CmdDefine:"CmdDefine",EntityManager:"EntityManager",UIManager:"UIManager"}],CmdStateSync:[function(e,t,n){"use strict";cc._RF.push(t,"8e923fvS5BMvaOlxm0ktHXY","CmdStateSync");var i=e("CmdBase"),a=e("CmdDefine"),o=(e("EntityManager"),e("star_comm"));cc.Class({extends:i,Init:function(e,t){this.cmdType=a.CmdType.CmdType_DeleteItem,this.entityGuid=e,this.targetGuid=t},ServerDataToClient:function(e){this.entityGuid=e.SD.StateNotify.CasterID,this.Total=e.SD.StateNotify.Total,this.Effects=e.SD.StateNotify.Effects},Execute:function(){if(this._super(),window.GGameEntry.EntityManager.getEntity(this.entityGuid))for(var e=0;e<this.Total;e++){var t=this.Effects[e];if(t){var n=window.GGameEntry.EntityManager.getEntity(t.ObjID);n&&t.EffectType===o.CsEffectType.CS_ONEEFFECT_TYPE_HURT&&(n.OnSetHp(t.EffectData.Hp),t.EffectData.Die&&n.OnDie())}}}}),cc._RF.pop()},{CmdBase:"CmdBase",CmdDefine:"CmdDefine",EntityManager:"EntityManager",star_comm:"star_comm"}],CmdSvrBattleEndStatistic:[function(e,t,n){"use strict";cc._RF.push(t,"bb75eG//C9GR5DjqrGV0pXa","CmdSvrBattleEndStatistic");var i=e("CmdBase");e("EntityTypeDefine");cc.Class({extends:i,properties:{BattleEndStatisticData:null},Init:function(e){this.BattleEndStatisticData=e},Execute:function(){this.BattleEndStatisticData?window.GGameEntry.BattleSystem.ParseBattleEndJsonDataFromServer(this.BattleEndStatisticData):cc.error("Battle data is empty.")}}),cc._RF.pop()},{CmdBase:"CmdBase",EntityTypeDefine:"EntityTypeDefine"}],CmdSvrBattleGetObj:[function(e,t,n){"use strict";cc._RF.push(t,"ab6643qArJAM7BlQsAhtESH","CmdSvrBattleGetObj");var i=e("weixinmsgmgr"),a=e("star_comm");e("EntityTypeDefine");cc.Class({extends:cc.Component,properties:{BattleObj:null},Init:function(e){this.BattleObj=e},Execute:function(){if(this.BattleObj){window.GGameEntry.CursorMapId=this.BattleObj.MapID;for(var e=0;e<this.BattleObj.ObjCnt;e++){var t=i.getOpenID(),n=this.BattleObj.List[e];if(n.Type==a.CsObjectType.CS_OBJ_PLAYER){var o=n.Object.PlayerObj;o.Type===a.ObjType.OBJ_TYPE_HIDE?window.GGameEntry.MapManager.CreateMapBattleHideItemByServer(o):o.OpenId===t?window.GGameEntry.PlayerManager.CreatePlayerFromServerData(o):window.GGameEntry.PlayerManager.CreateOtherPlayerFromServerData(o)}else if(n.Type==a.CsObjectType.CS_OBJ_OTHER){var r=n.Object.OtherObj;r&&(r.Type===a.ObjType.OBJ_TYPE_ITEM?window.GGameEntry.ItemManager.CreateItemByServer(r):r.Type===a.ObjType.OBJ_TYPE_BASE||r.Type===a.ObjType.OBJ_TYPE_BRICK||r.Type===a.ObjType.OBJ_TYPE_STEEL||r.Type===a.ObjType.OBJ_TYPE_RIVER||r.Type===a.ObjType.OBJ_TYPE_GRASS||r.Type===a.ObjType.OBJ_TYPE_ORNAMENT||r.Type===a.ObjType.OBJ_TYPE_MAP_BOX||r.Type===a.ObjType.OBJ_TYPE_NO_BROKEN?window.GGameEntry.MapManager.CreateMapBattleItemByServer(r):r.Type===a.ObjType.OBJ_TYPE_BOX?window.GGameEntry.AirDropSystem.InitWithServerData(r,this.BattleObj.ObjCnt):cc.error("not match:",r.ResID))}}}else cc.error("战场数据为空，创建失败")}}),cc._RF.pop()},{EntityTypeDefine:"EntityTypeDefine",star_comm:"star_comm",weixinmsgmgr:"weixinmsgmgr"}],CmdSvrBattleStart:[function(e,t,n){"use strict";cc._RF.push(t,"e27bac0GZ5MfaNbglliElrT","CmdSvrBattleStart");var i=e("UIManager"),a=e("CmdBase");cc.Class({extends:a,properties:{BattleObj:null,TriggerTime:0},Init:function(e,t){this.BattleObj=e,this.TriggerTime=t},Execute:function(){this.BattleObj?(window.GGameEntry.CursorMapId=this.BattleObj.MapID,window.GGameEntry.GBattleNetwork.PauseRecvMsg(!0),window.GGameEntry.BattleSystem.SvrBattleObj=this.BattleObj,this.BattleObj=null,0===this.TriggerTime?window.GGameEntry.NotificationCenter.emit("OnShowEnterCountdown"):1===this.TriggerTime&&(window.GGameEntry.UIManager.ShowUI(i.UIType.BattleLoadingUI,i.UIOrder.Top+100),window.GGameEntry.BattleSystem.ClearBattle(!0))):cc.error("战场数据为空，创建失败")}}),cc._RF.pop()},{CmdBase:"CmdBase",UIManager:"UIManager"}],CmdSyncBattleStatistic:[function(e,t,n){"use strict";cc._RF.push(t,"da946jZyFdLwZHXxI1TsKys","CmdSyncBattleStatistic");var i=e("CmdBase"),a=e("EntityTypeDefine");cc.Class({extends:i,properties:{BattleStatisticData:null},Init:function(e){this.BattleStatisticData=e},Execute:function(){if(this.BattleStatisticData){for(var e=this.BattleStatisticData.SD.GetStatistic.Statistic,t=e.CampNum,n=0,i=0,o=0;o<t;o++)for(var r=e.CampStatistic[o],s=0;s<r.PlayerNum;s++)r.CampID===a.EntityCampType.BlueTeam?n+=r.PlayerStatistic[s].KillNum:i+=r.PlayerStatistic[s].KillNum;window.GGameEntry.BattleSystem.IsInvertWorld()?(window.GGameEntry.BattleSystem.BattleData.BlueKillCount=i,window.GGameEntry.BattleSystem.BattleData.RedKillCount=n):(window.GGameEntry.BattleSystem.BattleData.BlueKillCount=n,window.GGameEntry.BattleSystem.BattleData.RedKillCount=i),window.GGameEntry.NotificationCenter.emit("OnBattleUIKillUpdate")}else cc.error("战场统计数据为空")}}),cc._RF.pop()},{CmdBase:"CmdBase",EntityTypeDefine:"EntityTypeDefine"}],CollisionBox:[function(e,t,n){"use strict";cc._RF.push(t,"b1ca8Hha2VH94K532Bii8HE","CollisionBox"),cc.Class({extends:cc.Component,properties:{CollisionScaleWidth:{default:1e3,serializable:!0,visible:!0},CollisionScaleHeight:{default:1e3,serializable:!0,visible:!0}},onLoad:function(){}}),cc._RF.pop()},{}],CollisionObject:[function(e,t,n){"use strict";cc._RF.push(t,"a8372jik91M7blK0f8Grctc","CollisionObject");e("CollisionBox"),e("MonsterManager"),e("PlayerManager");var i=e("GlobalCfg"),a=(e("EntityManager"),e("EntityTypeDefine")),o=e("MsgPickUpItem"),r=e("ResTableNames"),s=e("BulletTypeDefine"),l=e("Util");cc.Class({extends:cc.Component,properties:{MapMsgLayer:{default:null,type:cc.Node},MapMsgLabel:{default:null,type:cc.Label},TempTect1:{default:null,type:cc.Rect},TempTect2:{default:null,type:cc.Rect}},onLoad:function(){},Init:function(e){this.TempTect1=new cc.Rect(0,0,0,0),this.TempTect2=new cc.Rect(0,0,0,0)},Release:function(){this.MapMsgLabel.string="",this.TempTect1=null,this.TempTect2=null},addMsg:function(e){this.MapMsgLabel.string=this.MapMsgLabel.string+"\n"+e},getCanWalkPos:function(e,t,n){var i=l.BeginSample("CollisionObject::getCanWalkPos"),a=[];a[a.length]=cc.v2(e,t);for(var o=[[-1,0],[0,-1],[1,0],[0,1],[1,1],[-1,-1],[-1,1],[1,-1],[2,2],[2,1],[2,0],[2,-1],[2,-2],[-2,2],[-2,1],[-2,0],[-2,-1],[-2,-2]],r=0;r<o.length;r++)a[a.length]=cc.v2(e+50*o[r][0],t+50*o[r][1]);for(var s,c,u=!1,d=0;d<a.length;d++)if(n.canWalk(cc.v2(a[d].x,a[d].y))){s=a[d].x,c=a[d].y,u=!0;break}return l.EndSample(i),u?cc.v2(s,c):cc.v2(e,t)},GetCanWalkPositionFromLine:function(e,t,n,i,a,o){for(var r=[],s=Math.floor(a/25);s>=1;s--){var l=Math.floor(e+n*s*25),c=Math.floor(t+i*s*25);r[r.length]=[l,c]}for(var u,d,h=!1,f=window.GGameEntry.MapManager.GridWidth,m=window.GGameEntry.MapManager.GridHeight,y=0;y<r.length;y++){var p=r[y][0],g=r[y][1];if(!(p<0||g<0||p>=100*f||g>=100*m)&&o.canWalk(cc.v2(p,g))){u=p,d=g,h=!0;break}}return h?cc.v2(u,d):cc.v2(e,t)},TankBaseCollisionWithItem:function(e){if(window.GGameEntry.ItemManager.Items&&e.MyCollider.world)for(var t=0;t<window.GGameEntry.ItemManager.Items.length;t++){var n=window.GGameEntry.ItemManager.Items[t],s=e.MyCollider.world.aabb,l=n.getComponent("cc.BoxCollider").world.aabb;if(s.intersects(l))switch(n.EntityType){case a.EntityType.EntityBuffItem:var c=n.getComponent("ItemPowerUp");if(!n.Used){n.Used=!0;var u=e.GetGuid(),d=n.GetGuid();if((h=new o).entityGUID=u,h.targetGUID=d,!(f=window.GGameEntry.ResTableMgr.GetConfigByID(r.star_item_cs,c.Resid)))return cc.error("Item not found:",nItemID),null;h.buffID=f.BuffId,h.itemId=n.Resid,h.Send(),e.Guid==window.GGameEntry.PlayerManager.Player.Guid&&1305!=n.Resid&&window.GGameEntry.SoundManager.PlayPickUpItem(),window.GGameEntry.CurGamePlayType===i.GamePlayType.GamePlayType_Network&&n.OnDie()}break;default:if(1305==n.Resid){var u=e.GetGuid(),d=n.GetGuid(),h=new o;h.entityGUID=u,h.targetGUID=d;var f=window.GGameEntry.ResTableMgr.GetConfigByID(r.star_item_cs,n.Resid);if(!f)return cc.error("Item not found:",nItemID),null;h.buffID=f.BuffId,h.itemId=n.Resid,h.Send()}}}},DynamicObjectCollisionWithItem:function(){if(window.GGameEntry.PlayerManager)if(window.GGameEntry.PlayerManager.Player&&this.TankBaseCollisionWithItem(window.GGameEntry.PlayerManager.Player),window.GGameEntry.CurGamePlayType===i.GamePlayType.GamePlayType_Network);else for(var e in window.GGameEntry.MonsterManager.monsterMap){var t=window.GGameEntry.MonsterManager.monsterMap[e];this.TankBaseCollisionWithItem(t)}},BulletWithHome:function(e){if(!e.DeadAni&&window.GGameEntry.MapManager.MapItem[a.EntityType.EntityBase]){for(var t=0;t<window.GGameEntry.MapManager.MapItem[a.EntityType.EntityBase].length;t++){var n=window.GGameEntry.MapManager.MapItem[a.EntityType.EntityBase][t];if(n&&!n.DeadAni&&(this.TempTect1.width=n.node.width,this.TempTect1.height=n.node.height,this.TempTect1.x=n.node.x-this.TempTect1.width/2,this.TempTect1.y=n.node.y-this.TempTect1.height/2,this.TempTect2=e.MyCollider.world.aabb.clone(),this.TempTect2.x=e.node.x-this.TempTect2.width/2,this.TempTect2.y=e.node.y-this.TempTect2.height/2,this.TempTect1.intersects(this.TempTect2))){if(window.GGameEntry.CurGamePlayType===i.GamePlayType.GamePlayType_Network){var o=[];o[o.length]=n.GetGuid(),e.onHitEffect(e.EntitySource.GetGuid(),o)}else n.HitByBullet(e.AttachDamger);return e.OnDie(),!0}}return!1}},BulletWithItem:function(e){if(!e.DeadAni&&window.GGameEntry.MapManager.MapItem[a.EntityType.EntityMapBox]){for(var t=0;t<window.GGameEntry.MapManager.MapItem[a.EntityType.EntityMapBox].length;t++){var n=window.GGameEntry.MapManager.MapItem[a.EntityType.EntityMapBox][t];if(n&&!n.DeadAni&&(this.TempTect1.width=n.node.width,this.TempTect1.height=n.node.height,this.TempTect1.x=n.node.x-this.TempTect1.width/2,this.TempTect1.y=n.node.y-this.TempTect1.height/2,this.TempTect2=e.MyCollider.world.aabb.clone(),this.TempTect2.x=e.node.x-this.TempTect2.width/2,this.TempTect2.y=e.node.y-this.TempTect2.height/2,this.TempTect1.intersects(this.TempTect2))){if(window.GGameEntry.CurGamePlayType===i.GamePlayType.GamePlayType_Network){var o=[];o[o.length]=n.GetGuid(),e.onHitEffect(e.EntitySource.GetGuid(),o)}else n.HitByBullet(e.AttachDamger);return e.OnDie(),window.GGameEntry.PlayerManager.Player&&e.EntitySource===window.GGameEntry.PlayerManager.Player&&window.GGameEntry.SoundManager.PlayHitTank(),!0}}return!1}},BulletWithBord:function(e){if(!e.DeadAni&&window.GGameEntry.MapManager.MapItem[a.EntityType.EntityNoBroken]){for(var t=0;t<window.GGameEntry.MapManager.MapItem[a.EntityType.EntityNoBroken].length;t++){var n=window.GGameEntry.MapManager.MapItem[a.EntityType.EntityNoBroken][t];if(n&&!n.DeadAni&&(this.TempTect1.width=n.node.width,this.TempTect1.height=n.node.height,this.TempTect1.x=n.node.x-this.TempTect1.width/2,this.TempTect1.y=n.node.y-this.TempTect1.height/2,this.TempTect2=e.MyCollider.world.aabb.clone(),this.TempTect2.x=e.node.x-this.TempTect2.width/2,this.TempTect2.y=e.node.y-this.TempTect2.height/2,this.TempTect1.intersects(this.TempTect2))){if(window.GGameEntry.CurGamePlayType===i.GamePlayType.GamePlayType_Network){var o=[];o[o.length]=n.GetGuid(),e.onHitEffect(e.EntitySource.GetGuid(),o)}else n.HitByBullet(e.AttachDamger);return e.OnDie(),window.GGameEntry.PlayerManager.Player&&e.EntitySource===window.GGameEntry.PlayerManager.Player&&window.GGameEntry.SoundManager.PlayHitTank(),!0}}return!1}},BulletWithAirDrop:function(e){if(!e.DeadAni&&window.GGameEntry.AirDropSystem.AirDropBoxArray){for(var t=0;t<window.GGameEntry.AirDropSystem.AirDropBoxArray.length;t++){var n=window.GGameEntry.AirDropSystem.AirDropBoxArray[t].getComponent("AirDropBox");if(n&&!n.DeadAni&&((!n.boxState||!n.isCanHit())&&(this.TempTect1.width=n.MyCollider.world.aabb.width,this.TempTect1.height=n.MyCollider.world.aabb.height,this.TempTect1.x=n.node.x-this.TempTect1.width/2,this.TempTect1.y=n.node.y-this.TempTect1.height/2,this.TempTect2=e.MyCollider.world.aabb.clone(),this.TempTect2.x=e.node.x-this.TempTect2.width/2,this.TempTect2.y=e.node.y-this.TempTect2.height/2,this.TempTect1.intersects(this.TempTect2)))){if(window.GGameEntry.CurGamePlayType===i.GamePlayType.GamePlayType_Network){var a=[];a[a.length]=n.GetGuid(),e.onHitEffect(e.EntitySource.GetGuid(),a)}else n.HitByBullet(e.AttachDamger);return window.GGameEntry.PlayerManager.Player&&e.EntitySource===window.GGameEntry.PlayerManager.Player&&window.GGameEntry.SoundManager.PlayHitTank(),e.OnDie(),!0}}return!1}},BulletWithAdobleAndSteel:function(e){if(!e.DeadAni){for(var t in window.GGameEntry.BlockMgr.map){var n=window.GGameEntry.BlockMgr.map[t];if(n&&!n.DeadAni&&(this.TempTect1.width=n.node.width,this.TempTect1.height=n.node.height,this.TempTect1.x=n.node.x-this.TempTect1.width/2,this.TempTect1.y=n.node.y-this.TempTect1.height/2,this.TempTect2=e.MyCollider.world.aabb.clone(),this.TempTect2.x=e.node.x-this.TempTect2.width/2,this.TempTect2.y=e.node.y-this.TempTect2.height/2,this.TempTect1.intersects(this.TempTect2))){if((e.bulletType===s.BulletType.Bullet_Normal||e.bulletType===s.BulletType.Bullet_AddHp)&&n.EntityType==a.EntityType.EntitySteel)return window.GGameEntry.SoundManager.PlayHitNoDamage(e.node.position),e.OnDie(),!0;if(window.GGameEntry.CurGamePlayType===i.GamePlayType.GamePlayType_Single)n.OnDie();else{var o=[];o[o.length]=n.GetGuid(),e.onHitEffect(e.EntitySource.GetGuid(),o)}return e.OnDie(),!0}}return!1}},BulletBombCollisionWithDynamicObject:function(e){this.BulletCollisionWithPlayer(e,width,height,window.GGameEntry.MonsterManager.monsterMap),window.GGameEntry.CurGamePlayType===i.GamePlayType.GamePlayType_Network?this.BulletCollisionWithOther(e,width,height,window.GGameEntry.PlayerManager.otherPlayerArray):this.BulletCollisionWithOther(e,width,height,window.GGameEntry.MonsterManager.monsterMap)},BulletBombCollisionWithObject:function(e,t,n){window.GGameEntry.CurGamePlayType===i.GamePlayType.GamePlayType_Network?this.BulletBombCollisionWithOther(e,t,n,window.GGameEntry.PlayerManager.otherPlayerArray):this.BulletBombCollisionWithOther(e,t,n,window.GGameEntry.MonsterManager.monsterMap)},BulletBombCollisionWithOther:function(e,t,n,a){var o=[],r=e.EntitySource;for(var s in a)if(r!==(d=a[s])&&d.node.active&&r.EntityCampType!==d.EntityCampType){var l=e.MyCollider.world.aabb.clone(),c=d.MyCollider.world.aabb.clone();l.width=t,l.height=n,l.x=e.node.x-t/2,l.y=e.node.y-n/2,c.x=d.node.x-d.MyCollider.world.aabb.width/2,c.y=d.node.y-d.MyCollider.world.aabb.height/2,l.intersects(c)&&(o[o.length]=d)}for(var u=[],s=0;s<o.length;s++){var d=o[s];d&&(window.GGameEntry.CurGamePlayType!==i.GamePlayType.GamePlayType_Network?(d.LastHitByEntity=r,d.OnMinusHp(e.AttachDamger)):u[u.length]=d.GetGuid())}u.length&&e.onHitEffect(e.EntitySource.GetGuid(),u)},BulletCollisionWithTank:function(e){return window.GGameEntry.CurGamePlayType===i.GamePlayType.GamePlayType_Network?this.BulletCollisionWithPlayerMap(e,window.GGameEntry.PlayerManager.otherPlayerArray):this.BulletCollisionWithMonsterObjectMap(e,window.GGameEntry.MonsterManager.monsterMap)},BulletCollisionWithPlayerMap:function(e,t){for(var n in t){var i=t[n];if(this.BulletCollisionInNetMode(e,i))return!0}return this.BulletCollisionInNetMode(e,window.GGameEntry.PlayerManager.Player)},BulletCollisionWithMonsterObjectMap:function(e,t){for(var n in t){var i=t[n];return this.BulletCollisionInSingleMode(e,i)}return this.BulletCollisionInSingleMode(e,window.GGameEntry.PlayerManager.Player)},BulletCollisionInSingleMode:function(e,t){var n=e.EntitySource;if(n===t)return!1;if(!t.node.active)return!1;if(n.EntityCampType===t.EntityCampType)return!1;var i=e.MyCollider.world.aabb.clone(),a=t.MyCollider.world.aabb.clone();return!!i.intersects(a)&&(t.LastHitByEntity=n,t.OnMinusHp(e.AttachDamger),e.OnDie(),window.GGameEntry.SoundManager.PlayHitTank(e.node.position),!0)},BulletCollisionInNetMode:function(e,t){var n=e.EntitySource;if(n===t)return!1;if(!t.node.active)return!1;var i=e.MyCollider.world.aabb.clone(),a=t.MyCollider.world.aabb.clone();if(i.intersects(a)){if(n===window.GGameEntry.PlayerManager.Player){var o=[];o[o.length]=t.GetGuid(),e.onHitEffect(n.GetGuid(),o)}return e.OnDie(),window.GGameEntry.SoundManager.PlayHitTank(e.node.position),!0}return!1},Pause:function(){},Resume:function(){},getLineCollisionEntityReturnLine:function(e,t,n){var i=new cc.Rect(n.node.x-n.node.anchorX*n.node.width,n.node.y-n.node.anchorY*n.node.height,n.node.width,n.node.height),a=cc.v2(i.x,i.y),o=cc.v2(i.x+i.width,i.y),r=cc.v2(i.x,i.y+i.height),s=cc.v2(i.x+i.width,i.y+i.height),l=0,c=9999999,u=this.segmentsIntr(e,t,a,o);if(u){var d=cc.pDistance(u,e);d<c&&(c=d,l=2)}var h=this.segmentsIntr(e,t,a,o);if(this.segmentsIntr(e,t,a,r)){var f=cc.pDistance(h,e);f<c&&(c=f,l=3)}var m=this.segmentsIntr(e,t,a,o);if(this.segmentsIntr(e,t,s,o)){var y=cc.pDistance(m,e);y<c&&(c=y,l=4)}var p=this.segmentsIntr(e,t,a,o);if(this.segmentsIntr(e,t,s,r)){var g=cc.pDistance(p,e);g<c&&(c=g,l=1)}return l},getLineCollisionBordReturnLine:function(e,t){var n=cc.v2(0,0),i=cc.v2(100*window.GGameEntry.MapManager.GridWidth,0),a=cc.v2(0,0+100*window.GGameEntry.MapManager.GridHeight),o=cc.v2(100*window.GGameEntry.MapManager.GridWidth,100*window.GGameEntry.MapManager.GridHeight);return this.segmentsIntr(e,t,n,i)?2:this.segmentsIntr(e,t,n,a)?3:this.segmentsIntr(e,t,o,i)?4:this.segmentsIntr(e,t,o,a)?1:0},pointInLine:function(e,t,n){var i=e.sub(t).mag(),a=e.sub(n),o=t.sub(n);return a.mag()+o.mag()==i},segmentsIntr:function(e,t,n,i){var a=t.y-e.y,o=e.x-t.x,r=i.y-n.y,s=n.x-i.x,l=a*s-o*r;if(0==l)return this.pointInLine(e,t,n)?n:!!this.pointInLine(e,t,i)&&i;var c=r*n.x+s*n.y,u=r*e.x+s*e.y-c;if(u*(r*t.x+s*t.y-c)>=0)return!1;var d=a*e.x+o*e.y;if((a*n.x+o*n.y-d)*(a*i.x+o*i.y-d)>=0)return!1;var h=u/l,f=h*o,m=-h*a;return cc.v2(e.x+f,e.y+m)},YfVector2SegmentIntersects:function(e,t,n,i){var a,o;return a=this.YfVector2IsLeft(e,n,i),o=this.YfVector2IsLeft(t,n,i),!(a*o>=0)&&(a=this.YfVector2IsLeft(n,e,t),o=this.YfVector2IsLeft(i,e,t),!(a*o>=0))},YfVector2IsLeft:function(e,t,n){return(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y)}}),cc._RF.pop()},{BulletTypeDefine:"BulletTypeDefine",CollisionBox:"CollisionBox",EntityManager:"EntityManager",EntityTypeDefine:"EntityTypeDefine",GlobalCfg:"GlobalCfg",MonsterManager:"MonsterManager",MsgPickUpItem:"MsgPickUpItem",PlayerManager:"PlayerManager",ResTableNames:"ResTableNames",Util:"Util"}],CommonMsgBoxUI:[function(e,t,n){"use strict";cc._RF.push(t,"08238Ni0mNE66YBGjLScHbJ","CommonMsgBoxUI");var i=e("loginServerMgr"),a=e("UIManager"),o=e("JsonUtils"),r=e("weixininterface");cc.Class({extends:cc.Component,properties:{ContentLabel:{default:null,type:cc.Label},ConfirmBtn:{default:null,type:cc.Button},MsgType:{default:0,type:cc.Integer},CancelBtn:{default:null,type:cc.Button}},onEnable:function(){this.ContentLabel.string="",this.ConfirmBtn.node.active=!0,this.CancelBtn.node.active=!1,this.showErrorMsgeInUI()},showErrorMsgeInUI:function(){if(0!==i.onGetServerErrMsgCount()){var e=i.onGetServerErrMsg(),t=o.SafeParse(e);if(t){var n=t.msg;n&&(this.ContentLabel.string=n);var r=t.type;if(this.MsgType=r,r&&1===r){this.ConfirmBtn.node.active=!1;this.scheduleOnce(function(){window.GGameEntry.UIManager.HideUI(a.UIType.CommonMsgBoxUI)},2)}else!r||101!==r&&188!==r||(this.CancelBtn.node.active=!0);199===r?(i.onClearErrMsg(),this.CancelBtn.node.active=!0,window.GGameEntry.GBattleNetwork.btnReconnect=1):200===r?(i.onClearErrMsg(),this.CancelBtn.node.active=!0):201===r&&(i.onClearErrMsg(),this.CancelBtn.node.active=!0)}}else window.GGameEntry.UIManager.HideUI(a.UIType.CommonMsgBoxUI)},checkRepeatMsg:function(){for(var e=[];i.onGetServerErrMsgCount()>0;){var t=i.onGetServerErrMsg(),n=o.SafeParse(t);if(n){var a=n.msg;a&&a!=this.ContentLabel.string&&e.push(t)}}for(var r=0;r<e.length;r++)i.onPushRawErrMsg(e[r])},OnConfirmBtnClick:function(){if(this.checkRepeatMsg(),i.onGetServerErrMsgCount()>0)this.showErrorMsgeInUI();else{if(2===this.MsgType)window.GGameEntry.BattleSystem.ExitBattle();else if(100===this.MsgType);else if(101===this.MsgType)i.onKeeperStartGameCheck();else if(188===this.MsgType)window.GGameEntry.BattleSystem.ExitBattle();else if(199===this.MsgType)window.GGameEntry.GBattleNetwork.btnReconnect=2;else if(200===this.MsgType){var e=i.onGetInviteInfo();r.showGameCallBack({},e,!0)}else 201===this.MsgType&&window.GGameEntry.NotificationCenter.emit("onEnterRoomByInvite",{btnSure:!0});window.GGameEntry.UIManager.HideUI(a.UIType.CommonMsgBoxUI)}},OnCanelBtnClick:function(){199===this.MsgType?window.GGameEntry.GBattleNetwork.btnReconnect=3:200===this.MsgType?i.onSetInviteInfo({}):201===this.MsgType&&(i.onSetInviteInfo({}),window.GGameEntry.NotificationCenter.emit("onEnterRoomByInvite",{btnSure:!1})),window.GGameEntry.UIManager.HideUI(a.UIType.CommonMsgBoxUI)}}),cc._RF.pop()},{JsonUtils:"JsonUtils",UIManager:"UIManager",loginServerMgr:"loginServerMgr",weixininterface:"weixininterface"}],Container:[function(e,t,n){"use strict";cc._RF.push(t,"a7359yRQO9DX60ExfogDiEy","Container"),t.exports={CircularQueue:function(e){var t=0,n=0,i=new Array(e);this.push=function(a){var o=(n+1)%e;o!==t?(i[n]=a,n=o):console.log("[CircularQueue.push] queue is full.")},this.pop=function(){if(t!==n){var a=i[t];return t=++t%e,a}},this.clear=function(){t=0,n=0},this.count=function(){return(n-t+e)%e},this.capacity=function(){return e}},PriorityQueue:function(e){var t=[];this.push=function(i){var a,o=t.length;for(t.push(i);0!==o&&(a=o-1>>1,e(t[o],t[a])<0);)n(o,a),o=a},this.pop=function(){return t.shift()},this.clear=function(){t=[]},this.count=function(){return t.length};var n=function(e,n){var i=t[e];t[e]=t[n],t[n]=i}},ObjectPool:function(t){var n,i=[];this.alloc=function(){if(i.length>0)return i.pop();if(n)return new n;if(!(n=window[t])){var a=t.split(".");n="cc"===a[0]?cc:e(a[0]);for(var o=1,r=a.length;o<r;++o)n=n?n[a[o]]:void 0}if(n)return new n;console.log("[ObjectPool.alloc] can not find type: "+t)},this.free=function(e){n&&e instanceof n?i.push(e):console.log("[ObjectPool.free] need type: "+t)},this.clear=function(){i=[]}}},cc._RF.pop()},{}],1:[function(e,t,n){function i(e,t){return f.isUndefined(t)?""+t:f.isNumber(t)&&!isFinite(t)?t.toString():f.isFunction(t)||f.isRegExp(t)?t.toString():t}function a(e,t){return f.isString(e)?e.length<t?e:e.slice(0,t):e}function o(e){return a(JSON.stringify(e.actual,i),128)+" "+e.operator+" "+a(JSON.stringify(e.expected,i),128)}function r(e,t,n,i,a){throw new p.AssertionError({message:n,actual:e,expected:t,operator:i,stackStartFunction:a})}function s(e,t){e||r(e,!0,t,"==",p.ok)}function l(e,t){if(e===t)return!0;if(f.isBuffer(e)&&f.isBuffer(t)){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return f.isDate(e)&&f.isDate(t)?e.getTime()===t.getTime():f.isRegExp(e)&&f.isRegExp(t)?e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase:f.isObject(e)||f.isObject(t)?u(e,t):e==t}function c(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function u(e,t){if(f.isNullOrUndefined(e)||f.isNullOrUndefined(t))return!1;if(e.prototype!==t.prototype)return!1;if(f.isPrimitive(e)||f.isPrimitive(t))return e===t;var n=c(e),i=c(t);if(n&&!i||!n&&i)return!1;if(n)return e=m.call(e),t=m.call(t),l(e,t);var a,o,r=g(e),s=g(t);if(r.length!=s.length)return!1;for(r.sort(),s.sort(),o=r.length-1;o>=0;o--)if(r[o]!=s[o])return!1;for(o=r.length-1;o>=0;o--)if(a=r[o],!l(e[a],t[a]))return!1;return!0}function d(e,t){return!(!e||!t)&&("[object RegExp]"==Object.prototype.toString.call(t)?t.test(e):e instanceof t||!0===t.call({},e))}function h(e,t,n,i){var a;f.isString(n)&&(i=n,n=null);try{t()}catch(e){a=e}if(i=(n&&n.name?" ("+n.name+").":".")+(i?" "+i:"."),e&&!a&&r(a,n,"Missing expected exception"+i),!e&&d(a,n)&&r(a,n,"Got unwanted exception"+i),e&&a&&n&&!d(a,n)||!e&&a)throw a}var f=e("util/"),m=Array.prototype.slice,y=Object.prototype.hasOwnProperty,p=t.exports=s;p.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=o(this),this.generatedMessage=!0);var t=e.stackStartFunction||r;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var i=n.stack,a=t.name,s=i.indexOf("\n"+a);if(s>=0){var l=i.indexOf("\n",s+1);i=i.substring(l+1)}this.stack=i}}},f.inherits(p.AssertionError,Error),p.fail=r,p.ok=s,p.equal=function(e,t,n){e!=t&&r(e,t,n,"==",p.equal)},p.notEqual=function(e,t,n){e==t&&r(e,t,n,"!=",p.notEqual)},p.deepEqual=function(e,t,n){l(e,t)||r(e,t,n,"deepEqual",p.deepEqual)},p.notDeepEqual=function(e,t,n){l(e,t)&&r(e,t,n,"notDeepEqual",p.notDeepEqual)},p.strictEqual=function(e,t,n){e!==t&&r(e,t,n,"===",p.strictEqual)},p.notStrictEqual=function(e,t,n){e===t&&r(e,t,n,"!==",p.notStrictEqual)},p.throws=function(e,t,n){h.apply(this,[!0].concat(m.call(arguments)))},p.doesNotThrow=function(e,t){h.apply(this,[!1].concat(m.call(arguments)))},p.ifError=function(e){if(e)throw e};var g=Object.keys||function(e){var t=[];for(var n in e)y.call(e,n)&&t.push(n);return t}},{"util/":9}],2:[function(e,t,n){"use strict";function i(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function a(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function o(e,t,n){for(var i,o=[],r=t;r<n;r+=3)i=(e[r]<<16)+(e[r+1]<<8)+e[r+2],o.push(a(i));return o.join("")}n.byteLength=function(e){return 3*e.length/4-i(e)},n.toByteArray=function(e){var t,n,a,o,r,c=e.length;o=i(e),r=new l(3*c/4-o),n=o>0?c-4:c;var u=0;for(t=0;t<n;t+=4)a=s[e.charCodeAt(t)]<<18|s[e.charCodeAt(t+1)]<<12|s[e.charCodeAt(t+2)]<<6|s[e.charCodeAt(t+3)],r[u++]=a>>16&255,r[u++]=a>>8&255,r[u++]=255&a;return 2===o?(a=s[e.charCodeAt(t)]<<2|s[e.charCodeAt(t+1)]>>4,r[u++]=255&a):1===o&&(a=s[e.charCodeAt(t)]<<10|s[e.charCodeAt(t+1)]<<4|s[e.charCodeAt(t+2)]>>2,r[u++]=a>>8&255,r[u++]=255&a),r},n.fromByteArray=function(e){for(var t,n=e.length,i=n%3,a="",s=[],l=0,c=n-i;l<c;l+=16383)s.push(o(e,l,l+16383>c?c:l+16383));return 1===i?(t=e[n-1],a+=r[t>>2],a+=r[t<<4&63],a+="=="):2===i&&(t=(e[n-2]<<8)+e[n-1],a+=r[t>>10],a+=r[t>>4&63],a+=r[t<<2&63],a+="="),s.push(a),s.join("")};for(var r=[],s=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,d=c.length;u<d;++u)r[u]=c[u],s[c.charCodeAt(u)]=u;s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63},{}],3:[function(e,t,n){(function(t){"use strict";function i(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(i()<t)throw new RangeError("Invalid typed array length");return o.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=o.prototype:(null===e&&(e=new o(t)),e.length=t),e}function o(e,t,n){if(!(o.TYPED_ARRAY_SUPPORT||this instanceof o))return new o(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return r(this,e,t,n)}function r(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?h(e,t,n,i):"string"==typeof t?u(e,t,n):f(e,t)}function s(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function l(e,t,n,i){return s(t),t<=0?a(e,t):void 0!==n?"string"==typeof i?a(e,t).fill(n,i):a(e,t).fill(n):a(e,t)}function c(e,t){if(s(t),e=a(e,t<0?0:0|m(t)),!o.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function u(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!o.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|y(t,n),r=(e=a(e,i)).write(t,n);return r!==i&&(e=e.slice(0,r)),e}function d(e,t){var n=t.length<0?0:0|m(t.length);e=a(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function h(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i),o.TYPED_ARRAY_SUPPORT?(e=t).__proto__=o.prototype:e=d(e,t),e}function f(e,t){if(o.isBuffer(t)){var n=0|m(t.length);return 0===(e=a(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||j(t.length)?a(e,0):d(e,t);if("Buffer"===t.type&&Q(t.data))return d(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function m(e){if(e>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|e}function y(e,t){if(o.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return Y(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return z(e).length;default:if(i)return Y(e).length;t=(""+t).toLowerCase(),i=!0}}function p(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return A(this,t,n);case"utf8":case"utf-8":return B(this,t,n);case"ascii":return P(this,t,n);case"latin1":case"binary":return R(this,t,n);case"base64":return I(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function g(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function C(e,t,n,i,a){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=a?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(a)return-1;n=e.length-1}else if(n<0){if(!a)return-1;n=0}if("string"==typeof t&&(t=o.from(t,i)),o.isBuffer(t))return 0===t.length?-1:G(e,t,n,i,a);if("number"==typeof t)return t&=255,o.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):G(e,[t],n,i,a);throw new TypeError("val must be string, number or Buffer")}function G(e,t,n,i,a){function o(e,t){return 1===r?e[t]:e.readUInt16BE(t*r)}var r=1,s=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;r=2,s/=2,l/=2,n/=2}var c;if(a){var u=-1;for(c=n;c<s;c++)if(o(e,c)===o(t,-1===u?0:c-u)){if(-1===u&&(u=c),c-u+1===l)return u*r}else-1!==u&&(c-=c-u),u=-1}else for(n+l>s&&(n=s-l),c=n;c>=0;c--){for(var d=!0,h=0;h<l;h++)if(o(e,c+h)!==o(t,h)){d=!1;break}if(d)return c}return-1}function S(e,t,n,i){n=Number(n)||0;var a=e.length-n;i?(i=Number(i))>a&&(i=a):i=a;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");i>o/2&&(i=o/2);for(var r=0;r<i;++r){var s=parseInt(t.substr(2*r,2),16);if(isNaN(s))return r;e[n+r]=s}return r}function E(e,t,n,i){return K(Y(t,e.length-n),e,n,i)}function T(e,t,n,i){return K(V(t),e,n,i)}function w(e,t,n,i){return T(e,t,n,i)}function M(e,t,n,i){return K(z(t),e,n,i)}function _(e,t,n,i){return K(J(t,e.length-n),e,n,i)}function I(e,t,n){return 0===t&&n===e.length?X.fromByteArray(e):X.fromByteArray(e.slice(t,n))}function B(e,t,n){n=Math.min(e.length,n);for(var i=[],a=t;a<n;){var o=e[a],r=null,s=o>239?4:o>223?3:o>191?2:1;if(a+s<=n){var l,c,u,d;switch(s){case 1:o<128&&(r=o);break;case 2:128==(192&(l=e[a+1]))&&(d=(31&o)<<6|63&l)>127&&(r=d);break;case 3:l=e[a+1],c=e[a+2],128==(192&l)&&128==(192&c)&&(d=(15&o)<<12|(63&l)<<6|63&c)>2047&&(d<55296||d>57343)&&(r=d);break;case 4:l=e[a+1],c=e[a+2],u=e[a+3],128==(192&l)&&128==(192&c)&&128==(192&u)&&(d=(15&o)<<18|(63&l)<<12|(63&c)<<6|63&u)>65535&&d<1114112&&(r=d)}}null===r?(r=65533,s=1):r>65535&&(r-=65536,i.push(r>>>10&1023|55296),r=56320|1023&r),i.push(r),a+=s}return v(i)}function v(e){var t=e.length;if(t<=Z)return String.fromCharCode.apply(String,e);for(var n="",i=0;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=Z));return n}function P(e,t,n){var i="";n=Math.min(e.length,n);for(var a=t;a<n;++a)i+=String.fromCharCode(127&e[a]);return i}function R(e,t,n){var i="";n=Math.min(e.length,n);for(var a=t;a<n;++a)i+=String.fromCharCode(e[a]);return i}function A(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var a="",o=t;o<n;++o)a+=W(e[o]);return a}function D(e,t,n){for(var i=e.slice(t,n),a="",o=0;o<i.length;o+=2)a+=String.fromCharCode(i[o]+256*i[o+1]);return a}function b(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function U(e,t,n,i,a,r){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<r)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function L(e,t,n,i){t<0&&(t=65535+t+1);for(var a=0,o=Math.min(e.length-n,2);a<o;++a)e[n+a]=(t&255<<8*(i?a:1-a))>>>8*(i?a:1-a)}function N(e,t,n,i){t<0&&(t=4294967295+t+1);for(var a=0,o=Math.min(e.length-n,4);a<o;++a)e[n+a]=t>>>8*(i?a:3-a)&255}function k(e,t,n,i,a,o){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function O(e,t,n,i,a){return a||k(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),q.write(e,t,n,i,23,4),n+4}function x(e,t,n,i,a){return a||k(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),q.write(e,t,n,i,52,8),n+8}function F(e){if((e=H(e).replace($,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function H(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function W(e){return e<16?"0"+e.toString(16):e.toString(16)}function Y(e,t){t=t||1/0;for(var n,i=e.length,a=null,o=[],r=0;r<i;++r){if((n=e.charCodeAt(r))>55295&&n<57344){if(!a){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(r+1===i){(t-=3)>-1&&o.push(239,191,189);continue}a=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),a=n;continue}n=65536+(a-55296<<10|n-56320)}else a&&(t-=3)>-1&&o.push(239,191,189);if(a=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function V(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function J(e,t){for(var n,i,a,o=[],r=0;r<e.length&&!((t-=2)<0);++r)i=(n=e.charCodeAt(r))>>8,a=n%256,o.push(a),o.push(i);return o}function z(e){return X.toByteArray(F(e))}function K(e,t,n,i){for(var a=0;a<i&&!(a+n>=t.length||a>=e.length);++a)t[a+n]=e[a];return a}function j(e){return e!==e}var X=e("base64-js"),q=e("ieee754"),Q=e("isarray");n.Buffer=o,n.SlowBuffer=function(e){return+e!=e&&(e=0),o.alloc(+e)},n.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),n.kMaxLength=i(),o.poolSize=8192,o._augment=function(e){return e.__proto__=o.prototype,e},o.from=function(e,t,n){return r(null,e,t,n)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(e,t,n){return l(null,e,t,n)},o.allocUnsafe=function(e){return c(null,e)},o.allocUnsafeSlow=function(e){return c(null,e)},o.isBuffer=function(e){return!(null==e||!e._isBuffer)},o.compare=function(e,t){if(!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,a=0,r=Math.min(n,i);a<r;++a)if(e[a]!==t[a]){n=e[a],i=t[a];break}return n<i?-1:i<n?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Q(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=o.allocUnsafe(t),a=0;for(n=0;n<e.length;++n){var r=e[n];if(!o.isBuffer(r))throw new TypeError('"list" argument must be an Array of Buffers');r.copy(i,a),a+=r.length}return i},o.byteLength=y,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},o.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?B(this,0,e):p.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",t=n.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},o.prototype.compare=function(e,t,n,i,a){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===a&&(a=this.length),t<0||n>e.length||i<0||a>this.length)throw new RangeError("out of range index");if(i>=a&&t>=n)return 0;if(i>=a)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,i>>>=0,a>>>=0,this===e)return 0;for(var r=a-i,s=n-t,l=Math.min(r,s),c=this.slice(i,a),u=e.slice(t,n),d=0;d<l;++d)if(c[d]!==u[d]){r=c[d],s=u[d];break}return r<s?-1:s<r?1:0},o.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},o.prototype.indexOf=function(e,t,n){return C(this,e,t,n,!0)},o.prototype.lastIndexOf=function(e,t,n){return C(this,e,t,n,!1)},o.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var a=this.length-t;if((void 0===n||n>a)&&(n=a),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var o=!1;;)switch(i){case"hex":return S(this,e,t,n);case"utf8":case"utf-8":return E(this,e,t,n);case"ascii":return T(this,e,t,n);case"latin1":case"binary":return w(this,e,t,n);case"base64":return M(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Z=4096;o.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var i;if(o.TYPED_ARRAY_SUPPORT)(i=this.subarray(e,t)).__proto__=o.prototype;else{var a=t-e;i=new o(a,void 0);for(var r=0;r<a;++r)i[r]=this[r+e]}return i},o.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||b(e,t,this.length);for(var i=this[e],a=1,o=0;++o<t&&(a*=256);)i+=this[e+o]*a;return i},o.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||b(e,t,this.length);for(var i=this[e+--t],a=1;t>0&&(a*=256);)i+=this[e+--t]*a;return i},o.prototype.readUInt8=function(e,t){return t||b(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return t||b(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return t||b(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return t||b(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return t||b(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||b(e,t,this.length);for(var i=this[e],a=1,o=0;++o<t&&(a*=256);)i+=this[e+o]*a;return a*=128,i>=a&&(i-=Math.pow(2,8*t)),i},o.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||b(e,t,this.length);for(var i=t,a=1,o=this[e+--i];i>0&&(a*=256);)o+=this[e+--i]*a;return a*=128,o>=a&&(o-=Math.pow(2,8*t)),o},o.prototype.readInt8=function(e,t){return t||b(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){t||b(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(e,t){t||b(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(e,t){return t||b(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return t||b(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return t||b(e,4,this.length),q.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return t||b(e,4,this.length),q.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return t||b(e,8,this.length),q.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return t||b(e,8,this.length),q.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,n,i){e=+e,t|=0,n|=0,i||U(this,e,t,n,Math.pow(2,8*n)-1,0);var a=1,o=0;for(this[t]=255&e;++o<n&&(a*=256);)this[t+o]=e/a&255;return t+n},o.prototype.writeUIntBE=function(e,t,n,i){e=+e,t|=0,n|=0,i||U(this,e,t,n,Math.pow(2,8*n)-1,0);var a=n-1,o=1;for(this[t+a]=255&e;--a>=0&&(o*=256);)this[t+a]=e/o&255;return t+n},o.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,1,255,0),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},o.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},o.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):N(this,e,t,!0),t+4},o.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},o.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var a=Math.pow(2,8*n-1);U(this,e,t,n,a-1,-a)}var o=0,r=1,s=0;for(this[t]=255&e;++o<n&&(r*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/r>>0)-s&255;return t+n},o.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var a=Math.pow(2,8*n-1);U(this,e,t,n,a-1,-a)}var o=n-1,r=1,s=0;for(this[t+o]=255&e;--o>=0&&(r*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/r>>0)-s&255;return t+n},o.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,1,127,-128),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},o.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},o.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):N(this,e,t,!0),t+4},o.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},o.prototype.writeFloatLE=function(e,t,n){return O(this,e,t,!0,n)},o.prototype.writeFloatBE=function(e,t,n){return O(this,e,t,!1,n)},o.prototype.writeDoubleLE=function(e,t,n){return x(this,e,t,!0,n)},o.prototype.writeDoubleBE=function(e,t,n){return x(this,e,t,!1,n)},o.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var a,r=i-n;if(this===e&&n<t&&t<i)for(a=r-1;a>=0;--a)e[a+t]=this[a+n];else if(r<1e3||!o.TYPED_ARRAY_SUPPORT)for(a=0;a<r;++a)e[a+t]=this[a+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+r),t);return r},o.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var a=e.charCodeAt(0);a<256&&(e=a)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!o.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var r;if("number"==typeof e)for(r=t;r<n;++r)this[r]=e;else{var s=o.isBuffer(e)?e:Y(new o(e,i).toString()),l=s.length;for(r=0;r<n-t;++r)this[r+t]=s[r%l]}return this};var $=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":2,ieee754:5,isarray:4}],4:[function(e,t,n){var i={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==i.call(e)}},{}],5:[function(e,t,n){n.read=function(e,t,n,i,a){var o,r,s=8*a-i-1,l=(1<<s)-1,c=l>>1,u=-7,d=n?a-1:0,h=n?-1:1,f=e[t+d];for(d+=h,o=f&(1<<-u)-1,f>>=-u,u+=s;u>0;o=256*o+e[t+d],d+=h,u-=8);for(r=o&(1<<-u)-1,o>>=-u,u+=i;u>0;r=256*r+e[t+d],d+=h,u-=8);if(0===o)o=1-c;else{if(o===l)return r?NaN:1/0*(f?-1:1);r+=Math.pow(2,i),o-=c}return(f?-1:1)*r*Math.pow(2,o-i)},n.write=function(e,t,n,i,a,o){var r,s,l,c=8*o-a-1,u=(1<<c)-1,d=u>>1,h=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:o-1,m=i?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,r=u):(r=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-r))<1&&(r--,l*=2),(t+=r+d>=1?h/l:h*Math.pow(2,1-d))*l>=2&&(r++,l/=2),r+d>=u?(s=0,r=u):r+d>=1?(s=(t*l-1)*Math.pow(2,a),r+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,a),r=0));a>=8;e[n+f]=255&s,f+=m,s/=256,a-=8);for(r=r<<a|s,c+=a;c>0;e[n+f]=255&r,f+=m,r/=256,c-=8);e[n+f-m]|=128*y}},{}],6:[function(e,t,n){function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function o(e){if(d===setTimeout)return setTimeout(e,0);if((d===i||!d)&&setTimeout)return d=setTimeout,setTimeout(e,0);try{return d(e,0)}catch(t){try{return d.call(null,e,0)}catch(t){return d.call(this,e,0)}}}function r(e){if(h===clearTimeout)return clearTimeout(e);if((h===a||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function s(){p&&m&&(p=!1,m.length?y=m.concat(y):g=-1,y.length&&l())}function l(){if(!p){var e=o(s);p=!0;for(var t=y.length;t;){for(m=y,y=[];++g<t;)m&&m[g].run();g=-1,t=y.length}m=null,p=!1,r(e)}}function c(e,t){this.fun=e,this.array=t}function u(){}var d,h,f=t.exports={};!function(){try{d="function"==typeof setTimeout?setTimeout:i}catch(e){d=i}try{h="function"==typeof clearTimeout?clearTimeout:a}catch(e){h=a}}();var m,y=[],p=!1,g=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];y.push(new c(e,t)),1!==y.length||p||o(l)},c.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=u,f.addListener=u,f.once=u,f.off=u,f.removeListener=u,f.removeAllListeners=u,f.emit=u,f.prependListener=u,f.prependOnceListener=u,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],7:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],8:[function(e,t,n){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],9:[function(e,t,n){(function(t,i){function a(e,t){var i={seen:[],stylize:r};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),y(t)?i.showHidden=t:t&&n._extend(i,t),G(i.showHidden)&&(i.showHidden=!1),G(i.depth)&&(i.depth=2),G(i.colors)&&(i.colors=!1),G(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=o),l(i,e,i.depth)}function o(e,t){var n=a.styles[t];return n?"["+a.colors[n][0]+"m"+e+"["+a.colors[n][1]+"m":e}function r(e,t){return e}function s(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}function l(e,t,i){if(e.customInspect&&t&&M(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var a=t.inspect(i,e);return C(a)||(a=l(e,a,i)),a}var o=c(e,t);if(o)return o;var r=Object.keys(t),y=s(r);if(e.showHidden&&(r=Object.getOwnPropertyNames(t)),w(t)&&(r.indexOf("message")>=0||r.indexOf("description")>=0))return u(t);if(0===r.length){if(M(t)){var p=t.name?": "+t.name:"";return e.stylize("[Function"+p+"]","special")}if(S(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(T(t))return e.stylize(Date.prototype.toString.call(t),"date");if(w(t))return u(t)}var g="",G=!1,E=["{","}"];if(m(t)&&(G=!0,E=["[","]"]),M(t)&&(g=" [Function"+(t.name?": "+t.name:"")+"]"),S(t)&&(g=" "+RegExp.prototype.toString.call(t)),T(t)&&(g=" "+Date.prototype.toUTCString.call(t)),w(t)&&(g=" "+u(t)),0===r.length&&(!G||0==t.length))return E[0]+g+E[1];if(i<0)return S(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var _;return _=G?d(e,t,i,y,r):r.map(function(n){return h(e,t,i,y,n,G)}),e.seen.pop(),f(_,g,E)}function c(e,t){if(G(t))return e.stylize("undefined","undefined");if(C(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return g(t)?e.stylize(""+t,"number"):y(t)?e.stylize(""+t,"boolean"):p(t)?e.stylize("null","null"):void 0}function u(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,i,a){for(var o=[],r=0,s=t.length;r<s;++r)v(t,String(r))?o.push(h(e,t,n,i,String(r),!0)):o.push("");return a.forEach(function(a){a.match(/^\d+$/)||o.push(h(e,t,n,i,a,!0))}),o}function h(e,t,n,i,a,o){var r,s,c;if((c=Object.getOwnPropertyDescriptor(t,a)||{value:t[a]}).get?s=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(s=e.stylize("[Setter]","special")),v(i,a)||(r="["+a+"]"),s||(e.seen.indexOf(c.value)<0?(s=p(n)?l(e,c.value,null):l(e,c.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),G(r)){if(o&&a.match(/^\d+$/))return s;(r=JSON.stringify(""+a)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(r=r.substr(1,r.length-2),r=e.stylize(r,"name")):(r=r.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),r=e.stylize(r,"string"))}return r+": "+s}function f(e,t,n){var i=0;return e.reduce(function(e,t){return i++,t.indexOf("\n")>=0&&i++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function m(e){return Array.isArray(e)}function y(e){return"boolean"==typeof e}function p(e){return null===e}function g(e){return"number"==typeof e}function C(e){return"string"==typeof e}function G(e){return void 0===e}function S(e){return E(e)&&"[object RegExp]"===_(e)}function E(e){return"object"==typeof e&&null!==e}function T(e){return E(e)&&"[object Date]"===_(e)}function w(e){return E(e)&&("[object Error]"===_(e)||e instanceof Error)}function M(e){return"function"==typeof e}function _(e){return Object.prototype.toString.call(e)}function I(e){return e<10?"0"+e.toString(10):e.toString(10)}function B(){var e=new Date,t=[I(e.getHours()),I(e.getMinutes()),I(e.getSeconds())].join(":");return[e.getDate(),D[e.getMonth()],t].join(" ")}function v(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var P=/%[sdj%]/g;n.format=function(e){if(!C(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(a(arguments[n]));return t.join(" ")}for(var n=1,i=arguments,o=i.length,r=String(e).replace(P,function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(e){return"[Circular]"}default:return e}}),s=i[n];n<o;s=i[++n])p(s)||!E(s)?r+=" "+s:r+=" "+a(s);return r},n.deprecate=function(e,a){if(G(i.process))return function(){return n.deprecate(e,a).apply(this,arguments)};if(!0===t.noDeprecation)return e;var o=!1;return function(){if(!o){if(t.throwDeprecation)throw new Error(a);t.traceDeprecation?console.trace(a):console.error(a),o=!0}return e.apply(this,arguments)}};var R,A={};n.debuglog=function(e){if(G(R)&&(R=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!A[e])if(new RegExp("\\b"+e+"\\b","i").test(R)){var i=t.pid;A[e]=function(){var t=n.format.apply(n,arguments);console.error("%s %d: %s",e,i,t)}}else A[e]=function(){};return A[e]},n.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=m,n.isBoolean=y,n.isNull=p,n.isNullOrUndefined=function(e){return null==e},n.isNumber=g,n.isString=C,n.isSymbol=function(e){return"symbol"==typeof e},n.isUndefined=G,n.isRegExp=S,n.isObject=E,n.isDate=T,n.isError=w,n.isFunction=M,n.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},n.isBuffer=e("./support/isBuffer");var D=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",B(),n.format.apply(n,arguments))},n.inherits=e("inherits"),n._extend=function(e,t){if(!t||!E(t))return e;for(var n=Object.keys(t),i=n.length;i--;)e[n[i]]=t[n[i]];return e}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":8,_process:6,inherits:7}],DirectionBtnCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"e0369HeQ1pBQ6TtzO+jfZZL","DirectionBtnCtrl");var i=cc.Enum({DirectionType_None:0,DirectionType_Up:1,DirectionType_Right:2,DirectionType_Down:3,DirectionType_Left:4});cc.Class({extends:cc.Component,properties:{animation:{default:null,type:cc.Animation},direction:{default:i.DirectionType_None,type:i}},onEnable:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._touchStartEvent,this),this.node.on(cc.Node.EventType.TOUCH_END,this._touchEndEvent,this)},onDisable:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._touchStartEvent,this),this.node.off(cc.Node.EventType.TOUCH_END,this._touchEndEvent,this)},_touchStartEvent:function(){this.animation.play();var e={x:0,y:0};switch(this.direction){case i.DirectionType_Left:e.x=-1,e.y=0,window.GGameEntry.NotificationCenter.emit("DirectionMove",e);break;case i.DirectionType_Right:e.x=1,e.y=0,window.GGameEntry.NotificationCenter.emit("DirectionMove",e);break;case i.DirectionType_Up:e.x=0,e.y=1,window.GGameEntry.NotificationCenter.emit("DirectionMove",e);break;case i.DirectionType_Down:e.x=0,e.y=-1,window.GGameEntry.NotificationCenter.emit("DirectionMove",e)}},_touchEndEvent:function(){var e={x:0,y:0};window.GGameEntry.NotificationCenter.emit("DirectionMove",e)}}),t.exports={DirectionType:i},cc._RF.pop()},{}],DirectionUI:[function(e,t,n){"use strict";cc._RF.push(t,"237fdThkH1IIY2XfLTLvBbQ","DirectionUI");e("TankBase");var i=e("HeadImageUtil"),a=e("GlobalCfg"),o=e("EntityTypeDefine"),r=(e("SimpleRoundSprite"),e("Util"),e("star_cs")),s=e("ActivityMsgMgr");cc.Class({extends:cc.Component,properties:{HeadIconList:{default:[],type:cc.Node},HeadSpriteList:{default:[],type:cc.Sprite}},onEnable:function(){if(this.playerCamp=window.GGameEntry.PlayerManager.PlayerCampType,window.GGameEntry.CurGamePlayType===a.GamePlayType.GamePlayType_Single){this.playerCamp=o.EntityCampType.BlueTeam;var e=window.GGameEntry.PlayerManager.Player;e&&(this.playerGuid=e.Guid)}window.GGameEntry.NotificationCenter.on("OnBattleMapReady",this.setHeadImage,this),window.GGameEntry.IsGuiding()&&window.GGameEntry.NotificationCenter.on("OnCreatMonsterInGuide",this.setHeadImage,this)},onDisable:function(){window.GGameEntry.NotificationCenter.off("OnBattleMapReady",this.setHeadImage,this),window.GGameEntry.IsGuiding()&&window.GGameEntry.NotificationCenter.off("OnCreatMonsterInGuide",this.setHeadImage,this),this.Reset(),this.SelfTank=[],this.EnemyTank=[],this.SelfTank=null,this.EnemyTank=null},setHeadImage:function(){var e=this;if(this.getTanks(),this.SelfTank&&this.EnemyTank){for(var t=0;t<this.SelfTank.length;t++)if(this.SelfTank[t].HeadImageUrl)if(window.GGameEntry.CurGamePlayType===a.GamePlayType.GamePlayType_Single){if(this.SelfTank[t].Guid===this.playerGuid)continue;i.loadImageFromRes(this.HeadSpriteList[t],this.SelfTank[t].HeadImageUrl),this.HeadSpriteList[t].node.getComponent("SimpleRoundSprite").DisableMe()}else!function(){var n=e.HeadSpriteList[t].node.getComponent("SimpleRoundSprite");i.loadImageFromNetUrl(e.HeadSpriteList[t],e.SelfTank[t].HeadImageUrl,function(){n.SetMesh()})}();for(var n=0;n<this.EnemyTank.length;n++){var o=3+n;this.EnemyTank[n].HeadImageUrl&&(window.GGameEntry.CurGamePlayType===a.GamePlayType.GamePlayType_Single?(i.loadImageFromRes(this.HeadSpriteList[o],this.EnemyTank[n].HeadImageUrl),this.HeadSpriteList[o].node.getComponent("SimpleRoundSprite").DisableMe()):function(){var t=e.HeadSpriteList[o].node.getComponent("SimpleRoundSprite");i.loadImageFromNetUrl(e.HeadSpriteList[o],e.EnemyTank[n].HeadImageUrl,function(){t.SetMesh()})}())}}},Reset:function(){for(var e=0;e<this.HeadIconList.length;e++)this.HeadIconList[e].setPosition(-1e4,-1e4)},update:function(){window.GGameEntry.BattleSystem.IsPlaying()?this.directionTankInScreen():this.Reset()},directionTankInScreen:function(){if(window.GGameEntry.PlayerManager.Player&&!window.GGameEntry.PlayerManager.Player.isDead){if(window.GGameEntry.PlayerManager.Player.node){this.getTanks();for(var e=window.GGameEntry.PlayerManager.Player.node.position,t=0;t<this.SelfTank.length;t++)if(!this.SelfTank[t]||this.SelfTank[t].isDead||this.SelfTank[t].isInvisible())this.HeadIconList[t]&&this.HeadIconList[t].setPosition(-1e4,-1e4);else{var n=this.SelfTank[t].node.getPosition();this.checkSingleOtherShow(t,n,e)}for(var i=0;i<this.EnemyTank.length;i++)if(!this.EnemyTank[i]||this.EnemyTank[i].isDead||this.EnemyTank[i].isInvisible())this.HeadIconList[i+3]&&this.HeadIconList[i+3].setPosition(-1e4,-1e4);else{var a=this.EnemyTank[i].node.getPosition();this.checkSingleOtherShow(i+3,a,e)}}}else this.Reset()},getTanks:function(){if(this.SelfTank=[],this.EnemyTank=[],window.GGameEntry.CurGamePlayType===a.GamePlayType.GamePlayType_Single)this.SelfTank=window.GGameEntry.MonsterManager.monsterBuluTeamArray,this.EnemyTank=window.GGameEntry.MonsterManager.monsterRedTeamArray;else{var e=window.GGameEntry.PlayerManager.otherPlayerArray;for(var t in e){var n=e[t];n&&(n.EntityCampType!==this.playerCamp||s.isActivityMode(r.ROOM_TYPE.ROOM_IO)?this.EnemyTank[this.EnemyTank.length]=n:this.SelfTank[this.SelfTank.length]=n)}}},checkSingleOtherShow:function(e,t,n){if(this.isOtherInPlayerView(t))this.HeadIconList[e]&&this.HeadIconList[e].setPosition(-1e4,-1e4);else{var i=this.getRealAngleInScreen(this.getAngleOtherBetweenPlayer(t,n));window.GGameEntry.BattleSystem.IsInvertWorld()&&(i+=180),this.HeadIconList[e]&&(this.HeadIconList[e].rotation=i,this.HeadSpriteList[e].node.rotation=-1*i,this.HeadIconList[e].setPosition(this.getLineCutScreenRectPoint(t,n)))}},isOtherInPlayerView:function(e){var t=window.GGameEntry.BattleRoot.GetCameraViewArea();return e.x>t[0]&&e.x<t[2]&&e.y>t[1]&&e.y<t[3]},getOtherPosition:function(){return new cc.Vec2(250,800)},getAngleOtherBetweenPlayer:function(e,t){var n=e,i=t.sub(n),a=cc.pToAngle(i)/Math.PI*180;return a<0&&(a+=360),a},getRealAngleInScreen:function(e){return-1*e+270},getLineCutScreenRectPoint:function(e,t){var n=new cc.Vec2(e.x-t.x,e.y-t.y),i=window.GGameEntry.BattleRoot.ConvertBattlePosToUIPos(t.x,t.y),a=new cc.Vec2(i[0],i[1]),o=new cc.Vec2(0,0);return o.x=0,o.y=(0-a.x)*n.y/n.x+a.y,o.y>0&&o.y<cc.visibleRect.height&&e.x<=t.x?o.x+=20:(o.x=cc.visibleRect.width,o.y=(cc.visibleRect.width-a.x)*n.y/n.x+a.y,o.y>0&&o.y<cc.visibleRect.height&&e.x>=t.x?o.x-=20:(o.y=0,o.x=(0-a.y)*n.x/n.y+a.x,o.x>0&&o.x<cc.visibleRect.width&&e.y<=t.y?o.y+=22:(o.y=cc.visibleRect.height,o.x=(cc.visibleRect.height-a.y)*n.x/n.y+a.x,o.y-=22))),window.GGameEntry.BattleSystem.IsInvertWorld()&&(o.x=cc.visibleRect.width-o.x,o.x=o.x>0?o.x:-1*o.x,o.y=cc.visibleRect.height-o.y,o.y=o.y>0?o.y:-1*o.y),o}}),cc._RF.pop()},{ActivityMsgMgr:"ActivityMsgMgr",EntityTypeDefine:"EntityTypeDefine",GlobalCfg:"GlobalCfg",HeadImageUtil:"HeadImageUtil",SimpleRoundSprite:"SimpleRoundSprite",TankBase:"TankBase",Util:"Util",star_cs:"star_cs"}],DownLoad:[function(e,t,n){"use strict";cc._RF.push(t,"a8c0euohN9MbZ1Vl1UC3pFr","DownLoad");var i=e("PlatformUtil"),a="",o=null;cc.Class({extends:cc.Component,properties:{eventEngine:null,file:""},onLoad:function(){},StartDownLoad:function(e){a=e,cc.log("StartDownLoad ："+a),o=this.eventEngine,i.IsWeichatGame()&&wx.downloadFile({url:e,success:function(e){if(void 0===e.tempFilePath)return console.error("downloadFile failure: "+a),void o.emit("DownLoadFileEvent",{fileUrl:a,result:!1});console.log("downloadFile success: "+a),console.log("downloadFile success temp file: "+e.tempFilePath),wx.saveFile({tempFilePath:e.tempFilePath,success:function(e){var t=e.savedFilePath;console.log("saveFile success: "+e.savedFilePath),o.emit("DownLoadFileEvent",{fileUrl:t,result:!0})},fail:function(e){console.error("saveFile failure: "+a),o.emit("DownLoadFileEvent",{fileUrl:a,result:!1})}})},fail:function(e){console.error("downloadFile failure: "+a),o.emit("DownLoadFileEvent",{fileUrl:a,result:!1})}})}}),cc._RF.pop()},{PlatformUtil:"PlatformUtil"}],DynamicAnimation:[function(e,t,n){"use strict";cc._RF.push(t,"5f78867I45Ho4XUIjr0GHcB","DynamicAnimation"),cc.Class({extends:cc.Component,properties:{animationCtrl:{default:null,type:cc.Animation},rotationFlow:{default:!1},positionNode:{default:null,type:cc.Node}},onEnable:function(){this.playAnimation()},animationUpdate:function(e,t){this.positionNode?this.positionNode.position=e:this.node.position=e,t&&this.rotationFlow&&(this.node.rotation=t)},playAnimation:function(){this.animationCtrl&&this.animationCtrl.play()},replayAnimation:function(){this.animationCtrl&&(this.animationCtrl.stop(),this.animationCtrl.play())},onDisable:function(){this.animationCtrl&&this.animationCtrl.stop()},releaseAnimation:function(){this.entity=null,this.animationCtrl&&this.animationCtrl.stop(),window.GGameEntry.AnimationManager.returnAnimation(this.node.name,this.node)}}),cc._RF.pop()},{}],EffectBtnCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"6a31dSdr49CyrmNHFmWkGJn","EffectBtnCtrl"),cc.Class({extends:cc.Component,properties:{animation:{default:null,type:cc.Animation},spriteBG:{default:null,type:cc.Sprite},effectBtnBG:{type:cc.SpriteFrame,default:[]},tipsLabel:{default:null,type:cc.Node}},onEnable:function(){this.initTouchEvent(),window.GGameEntry.ResManager.IsL()?(this.animation.node.active=!1,this.tipsLabel.active=!1):(this.animation.node.active=!0,this.tipsLabel.active=!0,this.animation.play()),this.time=0},onDisable:function(){this.removeTouchEvent(),window.GGameEntry.ResManager.IsL()||this.animation.stop(),this.time=-1},update:function(e){this.time>=0&&(this.time+=e,this.time>2&&this.tipsLabel.active&&(this.tipsLabel.active=!1))},initTouchEvent:function(){var e=this;e.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,e)},removeTouchEvent:function(){var e=this;e.node.off(cc.Node.EventType.TOUCH_START,this.touchStart,e)},touchStart:function(e){window.GGameEntry.PlayerManager.Player.executeEffect()}}),cc._RF.pop()},{}],EffectDeath:[function(e,t,n){"use strict";cc._RF.push(t,"ccdff7OMY5Dlbq2z67KHYsy","EffectDeath"),cc.Class({extends:cc.Component,onLoad:function(){},Init:function(e,t){this.PrefabArray=[],this.PrefabUsingFlagArray=[];for(var n=0;n<6;n++){var i=cc.instantiate(t);i.active=!1,this.PrefabArray.push(i),e.addChild(i),this.PrefabUsingFlagArray.push(0)}this.node=new cc.Node,window.GGameEntry.NotificationCenter.on("TankDie",this.TankDie,this),window.GGameEntry.NotificationCenter.on("OtherPlayerDie",this.TankDie,this)},Release:function(){this.PrefabArray=[],window.GGameEntry.NotificationCenter.off("TankDie",this.TankDie,this),window.GGameEntry.NotificationCenter.off("OtherPlayerDie",this.TankDie,this)},TankDie:function(e){var t=window.GGameEntry.EntityManager.getEntity(e.detail.guid);t&&this.PlayerEffect(t.node.position,t.PaoTaiNode.rotation)},PlayerEffect:function(e,t){for(var n=0,i=0;i<this.PrefabUsingFlagArray.length;i++)if(!this.PrefabUsingFlagArray[i]){n=i;break}if(n!=this.PrefabUsingFlagArray.length){window.GGameEntry.PlayerManager.Player.EntityLineType;var a=this.PrefabArray[n];if(this.PrefabUsingFlagArray[n]=1,null!=a){a.active=!0,a.x=e.x,a.y=e.y,a.rotation=t;var o=a.getComponent(cc.Animation);o&&o.play()}var r=cc.callFunc(function(){this.PlayerPrefabOver(n)},this);this.node.runAction(cc.sequence(cc.delayTime(3),r))}},PlayerPrefabOver:function(e){this.PrefabUsingFlagArray[e]=0;var t=this.PrefabArray[e].getComponent(cc.Animation);this.PrefabArray[e].active=!1,t&&t.stop()},getEffect:function(){}}),cc._RF.pop()},{}],EmoticonUI:[function(e,t,n){"use strict";cc._RF.push(t,"b013aj7WytJ3KHjrBPucY2i","EmoticonUI");var i=e("MsgEmoticon"),a=e("PlayerBase"),o=e("EntityTypeDefine"),r=e("ResTableNames"),s=new cc.Vec2(360,-25),l=new cc.Vec2(-2e3,-2e3);new cc.Vec2(460,-60),new cc.Vec2(-2e3,-2e3);cc.Class({extends:cc.Component,properties:{EmoticonPageView:{default:null,type:cc.PageView},EmoticonToggelBtn:{default:null,type:cc.Button},SpriteList:{default:[],type:cc.Sprite},CachEmoticonItemList:{default:[],type:cc.Node},preEmoticonItem:{default:null,type:cc.Prefab},BKNode:{default:null,type:cc.Node}},onEnable:function(){window.GGameEntry.NotificationCenter.on("OnSelfEmoticonEnd",this.OnSelfEmoticonEnd,this),window.GGameEntry.NotificationCenter.on("OnReceiveShowEmoticon",this.OnReceiveShowEmoticon,this),window.GGameEntry.NotificationCenter.on("OnShowEmoticonPanel",this.ShowEmoticonView,this),window.GGameEntry.NotificationCenter.on("OnHideEmoticonPanel",this.HideEmotionView,this),this.HideEmotionView(),this.EmoticonToggelBtn.interactable=!0,this.BKNode.active=!1},onDisable:function(){window.GGameEntry.NotificationCenter.off("OnSelfEmoticonEnd",this.OnSelfEmoticonEnd,this),window.GGameEntry.NotificationCenter.off("OnReceiveShowEmoticon",this.OnReceiveShowEmoticon,this),window.GGameEntry.NotificationCenter.off("OnShowEmoticonPanel",this.ShowEmoticonView,this),window.GGameEntry.NotificationCenter.off("OnHideEmoticonPanel",this.HideEmotionView,this),this.HideEmotionView(),this.clearEmoctionItem(),this.unscheduleAllCallbacks()},clearEmoctionItem:function(){this.CachEmoticonItemList=[],window.GGameEntry.UIManager.EmoctionLayer.destroyAllChildren(),this.unscheduleAllCallbacks()},OnEmoticonBtnClick:function(){if(this.EmoticonPageView.node){var e=this.EmoticonPageView.node.getPosition();e.x===l.x&&e.y===l.y?this.ShowEmoticonView():e.x===s.x&&e.y===s.y&&this.HideEmotionView()}},HideEmotionView:function(){this.EmoticonPageView.node.setPosition(l),this.EmoticonPageView.scrollToPage(0),this.BKNode.active=!1},ShowEmoticonView:function(){this.EmoticonPageView.node.setPosition(s),this.BKNode.active=!0},ToggleButtonTimeout:function(){!0!==this.EmoticonToggelBtn.interactable&&(this.EmoticonToggelBtn.interactable=!0)},OnEmoticonItemClick:function(e,t){if(!window.GGameEntry.GBattleNetwork.IsConnected()){var n=window.GGameEntry.ResTableMgr.GetConfigByID(r.star_client_c,66).Context;return window.GGameEntry.UIManager.ShowMsgBox(n),void this.HideEmotionView()}this.unschedule(this.ToggleButtonTimeout),this.scheduleOnce(this.ToggleButtonTimeout,4);var a=parseInt(t),o=window.GGameEntry.PlayerManager.Player,s=0;if(o){s=o.Guid;var l=new i;l.EmoticionID=a,l.ObjID=s,l.Send()}this.EmoticonToggelBtn.interactable=!1,this.HideEmotionView()},isTankInScreen:function(e){return!!(e&&e instanceof a&&e.Hp>0&&e.node)&&this.isOtherInPlayerView(e.node.getPosition())},isOtherInPlayerView:function(e){var t=window.GGameEntry.BattleRoot.GetCameraViewArea();return e.x>t[0]&&e.x<t[2]&&e.y>t[1]&&e.y<t[3]},OnReceiveShowEmoticon:function(e){var t=e.detail,n=t.guid,i=t.emoticonID,a=void 0;if(i<0&&i>=this.SpriteList.length)cc.error("emoticon itemID error");else{a=this.SpriteList[i].spriteFrame;var o=window.GGameEntry.EntityManager.getEntity(n);this.isTankInScreen(o)?this.showEmoticonInTank(o,a,2):this.showEmoticonInLeftOrRightSideUI(n,o,a,2)}},showEmoticonInLeftOrRightSideUI:function(e,t,n,i){t&&t instanceof a&&(window.GGameEntry.NotificationCenter.emit("OnShowEmoticonInUI",{spriteF:n,guid:e,time:i}),t.isDead&&this.showEmotionInTankDie(t,n,i))},showEmotionInTankDie:function(e,t,n){var i=e.LastDiePosition;this.showEmoticonOnTank(e,i,n,t)},showEmoticonInTank:function(e,t,n){var i=e.node.getPosition();this.showEmoticonOnTank(e,i,n,t)},showEmoticonOnTank:function(e,t,n,i){if(e&&e instanceof a){var r=window.GGameEntry.PlayerManager.Player,s=this.getEmoticonItem();if(e.isDead)s.setPosition(t.x-72.4,t.y+42.3),s.opacity=255;else{var l=s.getComponent("FollowTarget");l&&(l.Target=e.node,l.Offset=[-72.4,42.3])}s.setParent(window.GGameEntry.UIManager.EmoctionLayer);var c=s.getChildByName("EmoticonSprite");r.EntityCampType===o.EntityCampType.RedTeam&&(c.rotation=180);var u=c.getComponent(cc.Sprite);i&&(u.spriteFrame=i);var d=this;this.scheduleOnce(function(){s.opacity=0,d.returnEmoticonItem(s),window.GGameEntry.PlayerManager.Player&&e.Guid===window.GGameEntry.PlayerManager.Player.Guid&&window.GGameEntry.NotificationCenter.emit("OnSelfEmoticonEnd")},n)}},getTankDirBesidePlayer:function(e){var t=1,n=window.GGameEntry.PlayerManager.Player;if(n&&e.Guid===n.Guid)return t;if(e.node){var i=e.node.getPosition();if(n){var a=n.node.getPosition();t=i.x<a.x?1:-1}}return t},OnSelfEmoticonEnd:function(){this.EmoticonToggelBtn.interactable=!0},getEmoticonItem:function(e){var t=null;return this.CachEmoticonItemList.length>0?t=this.CachEmoticonItemList.pop():this.preEmoticonItem&&(t=cc.instantiate(this.preEmoticonItem)),t},returnEmoticonItem:function(e){e&&(e.opacity=0,e.getComponent("FollowTarget").Target=null,e.setPosition(1e4,1e4),e.getChildByName("EmoticonSprite").rotation=0,this.CachEmoticonItemList.push(e))}}),cc._RF.pop()},{EntityTypeDefine:"EntityTypeDefine",MsgEmoticon:"MsgEmoticon",PlayerBase:"PlayerBase",ResTableNames:"ResTableNames"}],EnterStateMgr:[function(e,t,n){"use strict";cc._RF.push(t,"e22091Hu8xHsZabKsj8XquR","EnterStateMgr");e("PlatformUtil");var i={EnterState_Default:0,EnterState_NewGuid:1,EnterState_Single:2,EnterState_PVP:3,EnterState_AutoPVP:4,EnterState_Activity:5,EnterState_AutoActivity:6},a=i.EnterState_Default,o=!1,r=!1;t.exports={globalEnterStateFlag:i,setEnterState:function(e){a=e},getEnterState:function(e){return a===e},setEnterStateShowAutoPVP:function(e){o=e},getEnterStateShowAutoPVP:function(){return o},setEnterStateShowActivity:function(e){r=e},getEnterStateShowActivity:function(){return r}},cc._RF.pop()},{PlatformUtil:"PlatformUtil"}],EntityBase:[function(e,t,n){"use strict";cc._RF.push(t,"283deLRoEdBrrZr8xNXRa94","EntityBase");e("GenerateId");var i=e("EntityTypeDefine"),a=(e("Skill"),e("NormalAttackSkill"),e("Util"));e("AnimationManager");cc.Class({extends:cc.Component,properties:{SpAtlas:{default:null,type:cc.SpriteAtlas},Guid:{default:0,serializable:!1,visible:!1},Resid:{default:0},SubItemIndex:{default:0,serializable:!1,visible:!1},EntityType:{default:i.EntityType.EntityNone,type:i.EntityType},EntityCampType:{default:i.EntityCampType.None,type:i.EntityCampType},DeadPrefab:{default:null,type:cc.Prefab},DeadPrefabName:"",DeadAni:{default:!1,visible:!1},DieAnimation:{default:null,type:cc.Animation},Configid:{default:0,serializable:!1,visible:!1},Body:{default:null,type:cc.Node},PlayDeathAni:{default:!0,visible:!1},LastHitByEntity:{default:null,serializable:!1,visible:!1},PreDeath:{default:!1,visible:!1},EffectOffSetX:{default:0,visible:!1},EffectOffSetY:{default:0,visible:!1},dieAnimationClip:""},onLoad:function(){},Init:function(){},UnInit:function(){},ReInitOver:function(){},SetConfigId:function(e){this.ConfigId=e},SetEntityType:function(e){this.EntityType=e},AnimationFinished:function(){"function"==typeof this._DoDieAction&&window.GGameEntry.ItemManager.ReleaseItem(this),this._DoDieAction()},OnDie:function(){this.DeadAni=!0,this.UnInit();var e=cc.p(this.node.position.x+(.5-this.node.anchorX)*this.node.width+this.EffectOffSetX,this.node.position.y+(.5-this.node.anchorY)*this.node.height+this.EffectOffSetX);""!=this.DeadPrefabName&&this.PlayDeathAni&&(this.EntityType===i.EntityType.EntityPlayer||this.EntityType===i.EntityType.EntityOtherPlayer||this.EntityType===i.EntityType.EntityMonster?window.GGameEntry.AnimationManager.getAnimationAtPosition(this.DeadPrefabName,window.GGameEntry.MapManager.MapBottomLayer,e):window.GGameEntry.AnimationManager.getAnimationAtPosition(this.DeadPrefabName,this.node.parent,e)),this._DoDieAction()},GetDeadPrefab:function(){this.animation=window.GGameEntry.AnimationManager.getAnimation(this.DeadPrefabName),this.animation&&(this.animation.setParent(this.node),this.animation.setPosition(this.node.width/2,this.node.height/2),this.DieAnimation=this.animation.getComponent(cc.Animation))},ReleaseDeadPrefab:function(){window.GGameEntry.AnimationManager.returnAnimation(this.DeadPrefabName,this.animation)},_DoDieAction:function(){},GetEntityType:function(){return this.EntityType},GenGUID:function(){this.Guid=1e5*this.EntityType+window.GGameEntry.GenerateId.GetGuid()},GetGuid:function(){return 0==this.Guid&&this.GenGUID(),this.Guid},SetTeamType:function(e){this.EntityCampType=e},GetSmallGridPos:function(){var e=window.GGameEntry.MapManager.GetGridPos(this.node.position.x,this.node.position.y);return cc.v2(e[0],e[1])},GetPixelPos:function(){return this.EntityType==i.EntityType.EntityBase?cc.v2(this.node.position.x+1*window.GGameEntry.MapManager.GridSize,this.node.position.y+1*window.GGameEntry.MapManager.GridSize):this.EntityType==i.EntityType.EntityMonster||this.EntityType==i.EntityType.EntityPlayer?this.node.position:cc.v2(this.node.position.x+.5*window.GGameEntry.MapManager.GridSize,this.node.position.y+.5*window.GGameEntry.MapManager.GridSize)},OnSetHp:function(e){},SetResID:function(e,t){if(this.Resid=e,this.SubItemIndex=t,this.EntityType===i.EntityType.EntityAdobe||this.EntityType===i.EntityType.EntitySteel){if(this.Body){var n=this.Body.getComponent(cc.Sprite);if(n){var o=this.EntityType===i.EntityType.EntityAdobe?"tk_":"tp_";n.spriteFrame=this.SpAtlas.getSpriteFrame(o+1..toString()),n.spriteFrame?(n.spriteFrame.getTexture().setAliasTexParameters(),(n.spriteFrame._name.toString().startsWith("tz")||n.spriteFrame._name.startsWith("tp"))&&n.spriteFrame.getRect().width%10==2&&a.StrechSpriteFrameUV(n.spriteFrame,1)):cc.error("res not found:",e,":",t)}}this.Configid=e}},Reset:function(){this.DeadAni=!1,this.PreDeath=!1,this.EffectOffSetX=0,this.EffectOffSetY=0,null!==this.Body&&(this.Body.active=!0,this.Body.visible=!0)}}),cc._RF.pop()},{AnimationManager:"AnimationManager",EntityTypeDefine:"EntityTypeDefine",GenerateId:"GenerateId",NormalAttackSkill:"NormalAttackSkill",Skill:"Skill",Util:"Util"}],EntityDynamic:[function(e,t,n){"use strict";cc._RF.push(t,"5dcd1h6iHNBTrJZi8+LdoJ4","EntityDynamic");var i=e("EntityBase");e("EntityTypeDefine");cc.Class({extends:i,onLoad:function(){this._super()},OnDie:function(){this._super()},Init:function(e){this._super()}}),cc._RF.pop()},{EntityBase:"EntityBase",EntityTypeDefine:"EntityTypeDefine"}],EntityManager:[function(e,t,n){"use strict";cc._RF.push(t,"08033iTiLRMvIq3xoim+dii","EntityManager");e("EntityTypeDefine");cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.map={}},Release:function(){this.map={}},AddEntity:function(e){this.map[e.GetGuid()]=e},getEntity:function(e){return this.map[e]},getAllEntity:function(){return this.map},removeEntity:function(e){this.getEntity(e)&&(this.map[e]=null)}}),cc._RF.pop()},{EntityTypeDefine:"EntityTypeDefine"}],EntityTypeDefine:[function(e,t,n){"use strict";cc._RF.push(t,"89992fcblxKoZLePK6eskDM","EntityTypeDefine");var i=e("MapCfg").MapTileType,a=cc.Enum({EntityNone:0,EntityBase:1,EntityGround:2,EntityAdobe:3,EntitySteel:4,EntityWater:5,EntityGrass:6,EntityBorder:7,EntityBigAdobe:8,EntityMonster:10,EntityPlayer:11,EntityBullet:12,EntityBuffItem:13,EntityDecorate:14,EntityMapMask:15,EntityOtherPlayer:16,EntityHide:17,EntityAirDropBox:18,EntityMapBox:19,EntityNoBroken:20}),o=cc.Enum({None:0,BlueTeam:1,RedTeam:2}),r=cc.Enum({None:0,Left:1,Mid:2,Right:3}),s=cc.Enum({None:0,CacheConfigType_Bullet:1,CacheConfigType_AirDrop:2});t.exports={EntityType:a,EntityCampType:o,EntityLineType:r,GetEntityTypeFromResID:function(e){return Math.floor(e/100)},GetEntityTypeFromMapTileType:function(e){var t=0;switch(e){case i.Base:t=a.EntityBase;break;case i.Ground:t=a.EntityGround;break;case i.Adobe:t=a.EntityAdobe;break;case i.Steel:t=a.EntitySteel;break;case i.Water:t=a.EntityWater;break;case i.Grass:t=a.EntityGrass;break;case i.Border:t=a.EntityBorder;break;case i.Decorate:t=a.EntityDecorate;break;case i.Mask:t=a.EntityMapMask;break;case i.Box:t=a.EntityMapBox;break;case i.NoBroken:t=a.EntityNoBroken}return t},GetPrefabs:function(e){var t=null;switch(e){case a.EntityBase:t="Prefabs/GameMapItem/BasePrefab";break;case a.EntityGround:t="Prefabs/GameMapItem/GroundPrefab";break;case a.EntityAdobe:t="Prefabs/GameMapItem/SmallBlockPrefab";break;case a.EntitySteel:t="Prefabs/GameMapItem/SteelPrefab";break;case a.EntityWater:t="Prefabs/GameMapItem/WaterPrefab";break;case a.EntityGrass:t="Prefabs/GameMapItem/GrassPrefab";break;case a.EntityBorder:case a.EntityMonster:case a.EntityPlayer:case a.EntityBullet:t="Prefabs/GameMapItem/BorderPrefab";break;case a.EntityBigAdobe:t="Prefabs/GameMapItem/BigBlockPrefab";break;case a.EntityDecorate:t="Prefabs/GameMapItem/MapDecoratePrefab";break;case a.EntityMapMask:t="Prefabs/GameMapItem/MapMaskPrefab";break;case a.EntityMapBox:t="Prefabs/GameMapItem/BoxPrefab";break;case a.EntityNoBroken:t="Prefabs/GameMapItem/NoBrokenPrefab"}return null===t&&cc.error("cfg invalid"),t},CheckBulletCanThrough:function(e){switch(eType){case a.EntityWater:case a.EntityGrass:}},CheckTankCanThrough:function(e){switch(eType){case a.EntityGrass:ret=!0}return!1},CacheConfigType:s},cc._RF.pop()},{MapCfg:"MapCfg"}],FPSUI:[function(e,t,n){"use strict";cc._RF.push(t,"41c78zUp31FqJsq8vBpP0qT","FPSUI");var i=e("SimpleLabel"),a=e("Util"),o=(e("ServerLog"),e("ResCfgDef")),r=e("PlatformUtil");cc.Class({extends:cc.Component,properties:{FPS:{default:null,type:i},FPSBtn:{default:null,type:cc.Button},ServerInfo:{default:null,type:cc.Label},CheckNodeCount:!1,EnableDumpNode:!1,DumpNodeBtn:{default:null,type:cc.Node},ActiveNodeCount:0,AllNodeCount:0,EffLevelCfg:{default:null,type:cc.Node},EffLevelCfgToggle:{default:[],type:cc.Toggle},AutoUploadDumpLog:!1,AutoUploadTime:0},onLoad:function(){this.FPSData={TotalFPS:0,Count:10,CurCount:0,beginTime:0},this.DumpNodeBtn.active=this.EnableDumpNode,window.GGameEntry.NotificationCenter.on("CountDownZero",this.CountDownZero,this),window.GGameEntry.NotificationCenter.on("GameOver",this.OnGameOver,this),r.IsWeichatGame()&&!0===GameSettingConfig.Public&&(this.FPS.active=!1,this.FPSBtn.active=!1)},CountDownZero:function(){this.FrameAllTime=0,this.FrameCount=0,this.BeginStart=!0},OnGameOver:function(){this.FrameAllTime=0,this.FrameCount=0,this.BeginStart=!1},update:function(e){if(this.ServerInfo.string=a.GetBuildVersionNum()+"-"+window.GGameEntry.ServerName+"("+window.GGameEntry.OpenID+")",!r.IsWeichatGame()||!0!==GameSettingConfig.Public){this.FPSData.CurCount++;var t=Date.now();if(this.FPSData.CurCount>=5){this.FPSData.beginTime;var n=window.GGameEntry.ResManager.CurResType.toString();if(this.BeginStart&&(this.FrameAllTime=this.FrameAllTime+e,this.FrameCount=this.FrameCount+1,n=n+":"+Math.floor(this.FrameCount/this.FrameAllTime).toString()),this.CheckNodeCount){var i=a.GetAllNodeCount(window.GGameEntry.node,0,!0);n=n+":"+a.GetAllNodeCount().toString()+":"+i.toString()}window.GGameEntry.PlayerManager.pvPInfo.timeCost&&(n=n+":"+window.GGameEntry.PlayerManager.pvPInfo.timeCost),this.FPS.SetString(n),this.FPSData.CurCount=0,this.FPSData.beginTime=t}!0===this.AutoUploadDumpLog&&t-this.AutoUploadTime>3e3&&(this.debugLog(),this.AutoUploadTime=Date.now())}},OnDumpAllNodeBtn:function(){this.DumpAllNode()},DumpAllNode:function(e,t){t=t||window.GGameEntry.node,e=e||0;var n="                                                                  ",i=n.slice(n.length-2*e)+t.name;t.childrenCount>0&&(i+="("+t.childrenCount.toString()+")"),cc.log(i);for(var a=0;a<t.childrenCount;a++)this.DumpAllNode(e+1,t.children[a])},debugLog:function(){!1===this.BeginStart&&(this.FrameAllTime=0,this.FrameCount=0,this.BeginStart=!0)},OnEffLevelBtn:function(){window.GGameEntry.BattleSystem.IsPlaying()||window.GGameEntry.BattleSystem.IsPause()||(this.EffLevelCfg.active=!this.EffLevelCfg.active,this.EffLevelCfg.active&&this.EffLevelCfgToggle[window.GGameEntry.ResManager.CurResType].check())},OnEffLevelCfgOK:function(){if(!window.GGameEntry.BattleSystem.IsPlaying()&&!window.GGameEntry.BattleSystem.IsPause()){for(var e=window.GGameEntry.ResManager.CfgRange,t=0;t<this.EffLevelCfgToggle.length;t++)if(this.EffLevelCfgToggle[t].isChecked){t===o.ResCfgType.H?(window.GGameEntry.ResManager.FPSAvg=window.GGameEntry.ResManager.LastFPSAvg=e[o.ResCfgType.H].Max,window.GGameEntry.ResManager.CurResType=o.ResCfgType.H):t===o.ResCfgType.L?(window.GGameEntry.ResManager.FPSAvg=window.GGameEntry.ResManager.LastFPSAvg=e[o.ResCfgType.L].Min,window.GGameEntry.ResManager.CurResType=o.ResCfgType.L):(window.GGameEntry.ResManager.FPSAvg=window.GGameEntry.ResManager.LastFPSAvg=Math.floor((e[o.ResCfgType.M].Min+e[o.ResCfgType.M].Max)/2),window.GGameEntry.ResManager.CurResType=o.ResCfgType.M);break}window.GGameEntry.ResManager.SetByCustom(!0),window.GGameEntry.ResManager.SaveLOT(!0),window.GGameEntry.ResManager.CalResTypeByLastFPS()}this.EffLevelCfg.active=!1}}),cc._RF.pop()},{PlatformUtil:"PlatformUtil",ResCfgDef:"ResCfgDef",ServerLog:"ServerLog",SimpleLabel:"SimpleLabel",Util:"Util"}],FindPath:[function(e,t,n){"use strict";function i(e,t){this.width=e||0,this.height=t||0,this.nodes=new Array(this.width*this.height);for(var n=0,i=this.nodes.length;n<i;++n)this.nodes[n]=new a(this,n)}function a(e,t){this.graph=e,this.parent=null,this.index=t,this.x=t%e.width,this.y=Math.floor(t/e.width),this.g=0,this.h=0,this.f=function(){return this.g+this.h},this.status=0,this.walkable=function(e){return e(this.x,this.y)},this.getNode=function(e,t){if(e>=0&&e<this.graph.width&&t>=0&&t<this.graph.height)return this.graph.nodes[t*this.graph.width+e]},this.neighbours=function(){var e=this.x,t=this.y;return[this.getNode(e-1,t),this.getNode(e+1,t),this.getNode(e,t-1),this.getNode(e,t+1)]}}cc._RF.push(t,"12640yTUyhG6LCO3w87NdeD","FindPath");var o=e("Container");t.exports={Astar:function(e,t){var n=new i(e,t),a=new o.PriorityQueue(function(e,t){return e.f()-t.f()}),r=1,s=2;this.search=function(e,t,i){r+=2,s+=2,a.clear();var o=n.nodes[e],d=n.nodes[t];if(!o||!d)return[];for(o.parent=null,o.g=0,o.h=0,a.push(o);a.count()>0;){var h=a.pop();if(h.status=s,h===d)return c(l(d));for(var f=h.neighbours(),m=0,y=f.length;m<y;++m){var p=f[m];if(p&&p.walkable(i)){if(p===d)return d.parent=h,c(l(d));var g=h.g+u(h,p);(s===p.status||r===p.status)&&g>=p.g||(p.parent=h,p.g=g,r!==p.status&&(p.status=r,p.h=u(p,d),a.push(p)))}}}return[]};var l=function(e){for(var t=e,n=[];t;)n.push(t.index),t=t.parent;return n.reverse()},c=function(e){return e},u=function(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}}},cc._RF.pop()},{Container:"Container"}],FireAnimationCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"be6d5c9fb5OTp+IveaKCeBj","FireAnimationCtrl"),cc.Class({extends:cc.Component,properties:{Fire01:{default:null,type:cc.Node},Fire02:{default:null,type:cc.Node},Fire03:{default:null,type:cc.Node},tank:{default:null,visible:!1}},onEnable:function(){this.tank=this.node.getComponent("EntityBase"),window.GGameEntry.NotificationCenter.on("ShutDownFire",this.onShowFire,this)},onDisable:function(){this.tank=null,this.Fire01.active=!1,this.Fire02.active=!1,this.Fire03.active=!1,window.GGameEntry.NotificationCenter.off("ShutDownFire",this.onShowFire,this)},onShowFire:function(e){if(e.detail.guid==this.tank.Guid){var t=e.detail.type;1==t?(this.Fire01.active=!0,this.Fire02.active=!1,this.Fire03.active=!1):2==t?(this.Fire01.active=!1,this.Fire02.active=!0,this.Fire03.active=!1):3==t?(this.Fire01.active=!1,this.Fire02.active=!1,this.Fire03.active=!0):(this.Fire01.active=!1,this.Fire02.active=!1,this.Fire03.active=!1)}}}),cc._RF.pop()},{}],FlashSkill:[function(e,t,n){"use strict";cc._RF.push(t,"66969hMTVxK0ZMPJRI1V9PH","FlashSkill");var i=e("Skill"),a=(e("AIMapUtil"),e("TankMisc")),o=e("ResTableNames"),r=e("GlobalCfg"),s=e("Util");cc.Class({extends:i,properties:{},onLoad:function(){},update:function(e){if(void 0!==this.BulletID&&void 0!==this.BulletConfig&&void 0!==this.BulletIdx&&0!==this.BulletID&&null!==this.BulletConfig&&0!==this.BulletIdx&&!0!==this.EntitySource.DeadAni){var t=parseInt(this.BulletConfig.Angle),n=parseInt(this.BulletConfig.Column),i=parseInt(this.BulletConfig.ShiftingY),a=parseInt(n/this.LoadFrame);a+this.BulletIdx>n&&(a=n-this.BulletIdx),a*this.LoadFrame===this.BulletIdx+a&&(a+=parseInt(n%this.LoadFrame)),window.GGameEntry.BulletManager.CreateBulletByFrame(this.BulletID,this.EntitySource,-1,t,n,a,this.BulletIdx,i),this.BulletIdx+=a,this.BulletIdx>=n&&(this.BulletIdx=0)}},SetSkillArg:function(e){this.SkillArg=e,this.BulletConfig=null,this.BulletID=0,this.LoadFrame=3,this.BulletIdx=0},UseSkill:function(e){var t=s.BeginSample("FlashSkill::UseSkill");if(this.EntitySource){window.GGameEntry.CurGamePlayType===r.GamePlayType.GamePlayType_Network&&this.EntitySource!==window.GGameEntry.PlayerManager.Player.Guid&&this.EntitySource.setPosAndClearSitum();var n=parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(o.star_global_cs,18).Value),i=window.GGameEntry.MathUtil.sin(this.EntitySource.PaoTaiNode.rotation),l=window.GGameEntry.MathUtil.cos(this.EntitySource.PaoTaiNode.rotation),c=cc.v2(i,l);this.oldPos=cc.v2(this.EntitySource.node.x,this.EntitySource.node.y),c.normalizeSelf();var u=window.GGameEntry.CollisionObject.GetCanWalkPositionFromLine(this.EntitySource.node.x,this.EntitySource.node.y,c.x,c.y,n,this.EntitySource),d=.3*(u.sub(this.EntitySource.node.position).mag()/n),h=cc.moveTo(d,u),f=cc.callFunc(this.actionOver,this);this.EntitySource.node.runAction(cc.sequence(h,f)),this.EntitySource.tankGamingStateType=a.TankGamingStateType.TankGamingState_Skill_Flash,this.EntitySource.MoveSpeed&&(this.EntitySource.MoveSpeed.x=0,this.EntitySource.MoveSpeed.y=0)}s.EndSample(t)},actionOver:function(){var e=s.BeginSample("FlashSkill::actionOver");if(this.EntitySource){if(window.GGameEntry.MapManager.UpdateDynamicEntityFlag(this.EntitySource,this.oldPos.x,this.oldPos.y,!1),!this.EntitySource.canWalk(cc.v2(this.EntitySource.node.x,this.EntitySource.node.y))){var t=this.EntitySource.findNearCanWalkPos(this.EntitySource.node.x,this.EntitySource.node.y);this.EntitySource.node.setPosition(t)}this.EntitySource.tankGamingStateType=a.TankGamingStateType.TankGamingState_Normal,this.EntitySource.MoveSpeed&&(this.EntitySource.MoveSpeed.x=0,this.EntitySource.MoveSpeed.y=0);var n=window.GGameEntry.ResTableMgr.GetConfigByID(o.star_buff_cs,this.SkillArg);if(n){for(var i=0;i<n.Effects.length;i++){var r=n.Effects[i];if("BET_FLUSH_MOVE_EXEC "==r.Type&&"string"==typeof r.Param){var l=r.Param.split(" ");if(this.BulletID=l[1],this.BulletConfig=window.GGameEntry.ResTableMgr.GetConfigByID(o.star_bullet_cs,this.BulletID),!this.BulletConfig)return void s.AssertCheck(null!=this.BulletConfig,"子弹不存在 id："+this.BulletID);var c=parseInt(this.BulletConfig.Angle),u=parseInt(this.BulletConfig.Column),d=parseInt(this.BulletConfig.ShiftingY),h=parseInt(u/this.LoadFrame);0===h&&(h=u),window.GGameEntry.BulletManager.CreateBulletByFrame(this.BulletID,this.EntitySource,-1,c,u,h,this.BulletIdx,d),this.BulletIdx=h,this.BulletIdx>=u&&(this.BulletIdx=0);break}}s.EndSample(e)}}}}),cc._RF.pop()},{AIMapUtil:"AIMapUtil",GlobalCfg:"GlobalCfg",ResTableNames:"ResTableNames",Skill:"Skill",TankMisc:"TankMisc",Util:"Util"}],FollowManager:[function(e,t,n){"use strict";cc._RF.push(t,"3291d1Bg59BubBIy54l9tGe","FollowManager");var i=function(){function e(e,t){var n=[],i=!0,a=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done)&&(n.push(r.value),!t||n.length!==t);i=!0);}catch(e){a=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(a)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=new Map;cc.Class({extends:cc.Component,properties:{},onLoad:function(){},lateUpdate:function(e){var t=!0,n=!1,o=void 0;try{for(var r,s=a[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){var l=r.value,c=i(l,2),u=c[0],d=c[1];if(u){var h=!0,f=!1,m=void 0;try{for(var y,p=d[Symbol.iterator]();!(h=(y=p.next()).done);h=!0){var g=y.value;g&&(g.position=u.position)}}catch(e){f=!0,m=e}finally{try{!h&&p.return&&p.return()}finally{if(f)throw m}}}}}catch(e){n=!0,o=e}finally{try{!t&&s.return&&s.return()}finally{if(n)throw o}}},Add:function(e,t){var n=a.get(e);n||(n=new Set),n.add(t),a.set(e,n)},Delete:function(e,t){var n=a.get(e);n&&n.delete(t)},Clear:function(e){if(a.has(e)){var t=a.get(e);t&&t.clear(),a.delete(e)}},debug:function(){}}),cc._RF.pop()},{}],FollowTarget:[function(e,t,n){"use strict";cc._RF.push(t,"8da07jO2tlAvr/KKO8GnXaX","FollowTarget"),cc.Class({extends:cc.Component,properties:{Target:{default:null,type:cc.Node},Offset:{default:null}},lateUpdate:function(){if(null!=this.Target){0===this.node.opacity&&(this.node.opacity=255);var e=this.Target.getPosition();null!=this.Offset&&2===this.Offset.length&&(e.x+=this.Offset[0],e.y+=this.Offset[1]),this.node.setPosition(e)}}}),cc._RF.pop()},{}],FuHuoItemUI:[function(e,t,n){"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}cc._RF.push(t,"28aabZjs1FNmZzcWNpfcW6w","FuHuoItemUI");e("UIManager"),e("EntityBase");var a,o=e("HeadImageUtil"),r=e("EntityTypeDefine"),s=e("GlobalCfg"),l=e("SimpleRoundSprite"),c=e("ResCfgDef"),u=e("Util");cc.Class((a={extends:cc.Component,properties:{ValueSprite:{type:cc.Sprite,default:null},Mask:{default:null,type:cc.Node},IsCounting:{default:!1,visible:!1},HeadImageSprite:{default:null,type:cc.Sprite},SimpleRound:{default:null,type:l}},onEnable:function(){window.GGameEntry.NotificationCenter.on("TankDie",this.onPlayerDie,this),window.GGameEntry.CurGamePlayType!=s.GamePlayType.GamePlayType_Single&&window.GGameEntry.NotificationCenter.on("OnShowEmoticonInUI",this.OnShowEmoticonInUI,this),this.Reset()},onDisable:function(){window.GGameEntry.NotificationCenter.off("TankDie",this.onPlayerDie,this),window.GGameEntry.CurGamePlayType!=s.GamePlayType.GamePlayType_Single&&window.GGameEntry.NotificationCenter.off("OnShowEmoticonInUI",this.OnShowEmoticonInUI,this)},init:function(e,t,n,i,a){var r=u.BeginSample("FuHuoItemUI::init");if(this.camp=t,this.lineType=n,this.CDTime=i,this.guid=a,window.GGameEntry.CurGamePlayType===s.GamePlayType.GamePlayType_Single){var l=window.GGameEntry.PlayerManager.Player;if(l)if(l.Guid===a){var c=this;o.loadImageFromNetUrl(this.HeadImageSprite,e,function(){c.SimpleRound.SetMesh()})}else o.loadImageFromRes(this.HeadImageSprite,e),this.SimpleRound.DisableMe()}else{var d=this;o.loadImageFromNetUrl(this.HeadImageSprite,e,function(){d.SimpleRound.SetMesh()})}u.EndSample(r)},onPlayerDie:function(e){if(window.GGameEntry.BattleSystem.IsPlaying()){var t=e.detail,n=t.hitCampType;window.GGameEntry.BattleSystem.BattleData.firstBloodCamp===r.EntityCampType.None&&(window.GGameEntry.BattleSystem.BattleData.firstBloodCamp=n),t.guid==this.guid&&(this.IsCounting||this.startCountDown())}}},i(a,"onDisable",function(){this.Reset(),this.unscheduleAllCallbacks()}),i(a,"startCountDown",function(){this.startTime=0,this.IsCounting=!0,this.Mask.opacity=128,this.lastSecond=0}),i(a,"update",function(e){if(window.GGameEntry.BattleSystem.IsPlaying()){var t=u.BeginSample("FuHuoItemUI::update");if(this.IsCounting)if(this.startTime+=e,this.startTime>=this.CDTime){if(window.GGameEntry.IsGuiding())return;window.GGameEntry.ResManager.GetProgramEffCfg(c.ProgramEffType.TouXiangChongSheng)===c.PETouXiangChongSheng.Count5&&this.ChangeProgress(1),window.GGameEntry.CurGamePlayType===s.GamePlayType.GamePlayType_Single&&window.GGameEntry.NotificationCenter.emit("TankReborn",{campType:this.camp,lineType:this.lineType,guid:this.guid}),this.Reset()}else window.GGameEntry.ResManager.GetProgramEffCfg(c.ProgramEffType.TouXiangChongSheng)===c.PETouXiangChongSheng.Count5&&parseInt(this.startTime)>this.lastSecond&&(this.ChangeProgress(this.startTime/this.CDTime),this.lastSecond=parseInt(this.startTime));u.EndSample(t)}}),i(a,"Reset",function(){this.IsCounting=!1,this.Mask.opacity=255,this.ChangeProgress(0);var e=this.node.getChildByName("EmoticonBk");e&&(e.opacity=0)}),i(a,"ChangeProgress",function(e){this.ValueSprite.fillRange=e}),i(a,"OnShowEmoticonInUI",function(e){var t=u.BeginSample("FuHuoItemUI::OnShowEmoticonInUI"),n=e.detail,i=n.spriteF,a=n.guid,o=n.time;if(a==this.guid){var r=this.node.getChildByName("EmoticonBk");if(r){var s=r.getChildByName("EmoticonSprite").getComponent(cc.Sprite);s&&(s.spriteFrame=i),r.opacity=255,this.scheduleOnce(function(){r&&(r.opacity=0,window.GGameEntry.PlayerManager.Player&&a===window.GGameEntry.PlayerManager.Player.Guid&&window.GGameEntry.NotificationCenter.emit("OnSelfEmoticonEnd"))},o),u.EndSample(t)}}}),a)),cc._RF.pop()},{EntityBase:"EntityBase",EntityTypeDefine:"EntityTypeDefine",GlobalCfg:"GlobalCfg",HeadImageUtil:"HeadImageUtil",ResCfgDef:"ResCfgDef",SimpleRoundSprite:"SimpleRoundSprite",UIManager:"UIManager",Util:"Util"}],FuHuoRootUI:[function(e,t,n){"use strict";cc._RF.push(t,"8f43d7dcD9AqId+CatrhIKt","FuHuoRootUI");var i=e("TankBase"),a=(e("EntityManager"),e("EntityTypeDefine"),e("SimpleLabel")),o=(e("UIManager"),e("GlobalCfg")),r=e("PlatformUtil"),s=e("loginConfig"),l=e("Util"),c=e("ResTableNames");cc.Class({extends:cc.Component,properties:{preSelfItemList:{default:[],type:cc.Node},preEnemyItemList:{default:[],type:cc.Node},SelfFuhuoNode:{default:null,type:cc.Node},EnemyFuhuoNode:{default:null,type:cc.Node},ReBornMask:{type:cc.Node,default:null},SelfFuHuoBkSpriteList:{default:[],type:cc.SpriteFrame},EnemyFuHuoBkSpriteList:{default:[],type:cc.SpriteFrame},CountDownNode:{default:null,type:cc.Node},CountDownNumberSprite0:{default:null,type:cc.Sprite},CountDownNumberSprite1:{default:null,type:cc.Sprite},DiamondLabel:{default:null,type:a},DiamondBtn:{type:cc.Button,default:null},PVPLabel:{default:null,type:cc.Node},SingleLabel:{default:null,type:cc.Node},SelfRootNode:{default:null,type:cc.Node},EnemyRootNode:{default:null,type:cc.Node},ShopBtn:{default:null,type:cc.Node},NumberSpriteFrameList:{default:[],type:cc.SpriteFrame},LeftEdgeBk:{default:null,type:cc.Node},RightEdgeBk:{default:null,type:cc.Node}},fitiPhoneXScreen:function(){if(r.isTargetDevice("iPhone X")){var e=this.SelfRootNode.getComponent(cc.Widget),t=this.EnemyRootNode.getComponent(cc.Widget);e&&(e.left=60,e.updateAlignment()),t&&(t.right=60,t.updateAlignment())}},getCdTime:function(){var e=window.GGameEntry.CursorMapId,t=window.GGameEntry.ResTableMgr.GetConfigByID(c.star_bornpos_cs,e).RebornTime/1e3;return cc.log("RebornTime:"+t),t},onEnable:function(){var e=l.BeginSample("FuHuoRootUI::onEnable");if(this.fitiPhoneXScreen(),window.GGameEntry.NotificationCenter.on("TankDie",this.callback,this),window.GGameEntry.NotificationCenter.on("GameOver",this.OnGameOver,this),window.GGameEntry.NotificationCenter.on("OnBattleMapReady",this.itemInit,this),window.GGameEntry.NotificationCenter.on("onInstantReborn",this.onInstantReborn,this),window.GGameEntry.IsGuiding()&&window.GGameEntry.NotificationCenter.on("OnCreatMonsterInGuide",this.itemInit,this),this.DiamondLabel.SetString("X10"),this.resetItem(),this.DiamondBtn.interactable=!1,this.canInstantReborn=!1,window.GGameEntry.CurGamePlayType!=o.GamePlayType.GamePlayType_Single){var t=r.isTargetPlatform(1),n=r.isTargetPlatform(2),i=s.getPayFlag(1),a=s.getPayFlag(2);t&&i||n&&a?(this.PVPLabel.active=!0,this.SingleLabel.active=!1):(this.PVPLabel.active=!1,this.SingleLabel.active=!0)}else this.PVPLabel.active=!1,this.SingleLabel.active=!0;this.ShopBtn.on(cc.Node.EventType.TOUCH_START,this.OnDiamondBtnClicked,this),l.EndSample(e)},resetItem:function(){for(var e=0;e<this.preSelfItemList.length;e++)this.preSelfItemList[e].active=!1;for(var t=0;t<this.preEnemyItemList.length;t++)this.preEnemyItemList[t].active=!1},itemInit:function(){var e=l.BeginSample("FuHuoRootUI::itemInit"),t=[],n=[];for(var a in window.GGameEntry.EntityManager.map)if(window.GGameEntry.EntityManager.map.hasOwnProperty(a)&&(h=window.GGameEntry.EntityManager.map[a])instanceof i){var r=null,s=window.GGameEntry.PlayerManager.GetMyCamp();h.EntityCampType==s?t.push(h):n.push(h)}if(t.sort(this.SortTank),n.sort(this.SortTank),window.GGameEntry.CurGamePlayType!=o.GamePlayType.GamePlayType_Single){for(var c=0;c<t.length;c++)t[c]&&(t[c].EntityLineType=c+1);for(var u=0;u<n.length;u++)n[u]&&(n[u].EntityLineType=u+1)}for(d=0;d<t.length&&d<this.preSelfItemList.length;d++){h=t[d];this.preSelfItemList[d].active=!0,(f=(r=this.preSelfItemList[d]).getComponent("FuHuoItemUI"))&&f.init(h.HeadImageUrl,h.EntityCampType,h.EntityLineType,this.getCdTime(),h.GetGuid())}for(var d=0;d<n.length&&d<this.preEnemyItemList.length;d++){var h=n[d];this.preEnemyItemList[d].active=!0;var f=(r=this.preEnemyItemList[d]).getComponent("FuHuoItemUI");f&&f.init(h.HeadImageUrl,h.EntityCampType,h.EntityLineType,this.getCdTime(),h.GetGuid())}0===n.length?this.EnemyRootNode.opacity=0:this.EnemyRootNode.opacity=255,l.EndSample(e)},SortTank:function(e,t){return e.node.position.x>t.node.position.x},OnGameOver:function(){this.ReBornMask.opacity=0,this.DiamondBtn.interactable=!1,this.unscheduleAllCallbacks()},onDisable:function(){this.resetCountDown(),this.ReBornMask.opacity=0,this.DiamondBtn.interactable=!1,window.GGameEntry.NotificationCenter.off("TankDie",this.callback,this),window.GGameEntry.NotificationCenter.off("GameOver",this.OnGameOver,this),window.GGameEntry.NotificationCenter.off("OnBattleMapReady",this.itemInit,this),window.GGameEntry.NotificationCenter.off("onInstantReborn",this.onInstantReborn,this),window.GGameEntry.IsGuiding()&&window.GGameEntry.NotificationCenter.off("OnCreatMonsterInGuide",this.itemInit,this),this.ShopBtn.off(cc.Node.EventType.TOUCH_START,this.OnDiamondBtnClicked,this)},callback:function(e){var t=l.BeginSample("FuHuoRootUI::callback"),n=e.detail;if(window.GGameEntry.BattleSystem.UpdateBattleKillData(n.campType,n.lineType,n.guid,n.hitCampType,n.hitLineType,n.hitGuid),window.GGameEntry.PlayerManager.Player&&n.guid==window.GGameEntry.PlayerManager.Player.Guid){window.GGameEntry.NotificationCenter.emit("OnShowEmoticonPanel"),this.ReBornMask.opacity=255,this.DiamondBtn.interactable=!0,this.CountDownNode.setPosition(667,375);var i=this.getCdTime();this.changeCountDown(i-1),this.canInstantReborn=!1,this.countDownCallback=function(){if(window.GGameEntry.PlayerManager.Player){if(this.canInstantReborn||!window.GGameEntry.PlayerManager.Player.isDead)return this.resetCountDown(),this.ReBornMask.opacity=0,this.DiamondBtn.interactable=!1,window.GGameEntry.NotificationCenter.emit("OnHideEmoticonPanel"),void this.unschedule(this.countDownCallback);(i-=1)>=1?this.changeCountDown(i-1):(this.resetCountDown(),this.ReBornMask.opacity=0,this.DiamondBtn.interactable=!1,window.GGameEntry.NotificationCenter.emit("OnHideEmoticonPanel"),this.unschedule(this.countDownCallback))}},this.schedule(this.countDownCallback,1,this.getCdTime()-1,0)}l.EndSample(t)},resetCountDown:function(){var e=this.CountDownNode.getComponent(cc.Animation);e&&e.stop("DaoJiShiUI"),this.CountDownNode.setPosition(-2e3,-2e3),this.unscheduleAllCallbacks()},changeCountDown:function(e){this.CountDownNumberSprite0.node.setPosition(0,0),this.CountDownNumberSprite1.node.setPosition(0,0);var t=this.CountDownNode.getComponent(cc.Animation);t&&(t.stop("DaoJiShiUI"),this.CountDownNumberSprite0.spriteFrame=this.NumberSpriteFrameList[e],this.CountDownNumberSprite1.spriteFrame=this.NumberSpriteFrameList[e],t.play("DaoJiShiUI")),0!=e&&3!==e||(this.CountDownNumberSprite0.node.setPosition(-4,0),this.CountDownNumberSprite1.node.setPosition(-4,0))},OnDiamondBtnClicked:function(){e("loginServerMgr").onRequestRevive(),this.DiamondBtn.interactable=!1},onInstantReborn:function(e){console.log("onRecvBattleMsgCallback receive:"+this.canInstantReborn),this.canInstantReborn=!0},testInstantReborn:function(){}}),cc._RF.pop()},{EntityManager:"EntityManager",EntityTypeDefine:"EntityTypeDefine",GlobalCfg:"GlobalCfg",PlatformUtil:"PlatformUtil",ResTableNames:"ResTableNames",SimpleLabel:"SimpleLabel",TankBase:"TankBase",UIManager:"UIManager",Util:"Util",loginConfig:"loginConfig",loginServerMgr:"loginServerMgr"}],GMActionCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"d39a2ckEgRIV6v6AR4G9K6e","GMActionCtrl");var i=e("UIManager");cc.Class({extends:cc.Component,properties:{GMCmd:{default:null,visible:!1,serializable:!1},label:{default:null,type:cc.Label}},init:function(e){this.GMCmd=e,this.label.string=e.config.Desc},onEnable:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onBtnClick,this)},onDisable:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onBtnClick,this)},onBtnClick:function(){"GM_CMD_TYPE_SELECT_SERVER "==this.GMCmd.config.CmdType?window.GGameEntry.UIManager.ShowUI(i.UIType.ServerUI,i.UIOrder.Top+200):this.GMCmd&&this.GMCmd.execute()}}),cc._RF.pop()},{UIManager:"UIManager"}],GMAddBuff:[function(e,t,n){"use strict";cc._RF.push(t,"bafc0e44QNAn6Vbcw+56sBG","GMAddBuff");var i=e("GMCmd");cc.Class({extends:i,properties:{},init:function(e){this._super(e),this.param&&this.param.length>0&&(this.cmdString=this.cmdString+" "+this.param[0]+" ")}}),cc._RF.pop()},{GMCmd:"GMCmd"}],GMAttr:[function(e,t,n){"use strict";cc._RF.push(t,"525faxR0O1G8IkmX/BUil0B","GMAttr");var i=e("GMCmd");cc.Class({extends:i,properties:{},init:function(e){this._super(e),this.param&&this.param.length>0&&(this.cmdString=this.cmdString+" "+this.param[0]+" "+this.param[1]+" ")}}),cc._RF.pop()},{GMCmd:"GMCmd"}],GMClass:[function(e,t,n){"use strict";cc._RF.push(t,"6e6e79ltEVCI6aY8lmzsf4w","GMClass"),cc.Class({extends:cc.Component,properties:{config:{default:null,visible:!1,serializable:!1},label:{default:null,type:cc.Label},toggleIndex:{default:0}},init:function(e){this.config=e},onEnable:function(){this.node.on("toggle",this.onToggleSelect,this)},onDisable:function(){this.node.off("toggle",this.onToggleSelect,this)},onToggleSelect:function(){window.GGameEntry.NotificationCenter.emit("GMToggleSelect",{index:this.toggleIndex}),console.error("toggle selecct: "+this.toggleIndex)}}),cc._RF.pop()},{}],GMCmd:[function(e,t,n){"use strict";cc._RF.push(t,"77aa2+jTBJPF6D5KZgDplIz","GMCmd"),cc.Class({properties:{config:{default:null},cmdString:{default:null,type:cc.String},param:{default:new Array}},init:function(e){if(this.config=e,"string"==typeof e.Param)for(var t=e.Param.split(" "),n=0;n<t.length;n++)this.param.push(parseInt(t[n]));this.param&&this.param.length>0&&(this.cmdString="//"+e.GMCmdString+" ")},execute:function(){this.cmdString&&window.GGameEntry.NotificationCenter.emit("GMCmdSelect",{cmdString:this.cmdString})},update:function(){},reset:function(){}}),cc._RF.pop()},{}],GMDelBuff:[function(e,t,n){"use strict";cc._RF.push(t,"2c543d6Fl9FgrYo1QVBxgmL","GMDelBuff");var i=e("GMCmd");cc.Class({extends:i,properties:{},init:function(e){this._super(e),this.param&&this.param.length>0&&(this.cmdString=this.cmdString+" "+this.param[0]+" ")}}),cc._RF.pop()},{GMCmd:"GMCmd"}],GMOpenGuide:[function(e,t,n){"use strict";cc._RF.push(t,"b0fb3CLFyZA1afBQwr56V63","GMOpenGuide");var i=e("GMCmd");cc.Class({extends:i,properties:{},init:function(e){this._super(e)},execute:function(){window.GGameEntry.GMSystem.receiveGMMessage("GM reset guide"),window.localStorage.clear()}}),cc._RF.pop()},{GMCmd:"GMCmd"}],GMPanelCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"e997ab4WstJ/Juq/ckATVuM","GMPanelCtrl");var i=e("UIManager");e("NetworkProto"),e("star_cs");cc.Class({extends:cc.Component,properties:{GMCmdPanel:{default:null,type:cc.Node},GMConsle:{default:null,type:cc.Label},GMClassList:{default:null,visible:!1,serializable:!1},GMClassContent:{default:null,type:cc.Node},GMClassItem:{default:null,type:cc.Prefab},GMActionCmdItem:{default:null,type:cc.Prefab},inputLabel:{default:null,type:cc.Node},inputField:{default:null,visible:!1,serializable:!1},goBackBtn:{default:null,type:cc.Node},sendGMCmdBtn:{default:null,type:cc.Node}},onLoad:function(){var e=window.GGameEntry.GMSystem.getGMCmds(0);this.refreshCmds(e),this.inputField=this.inputLabel.getComponent("Inputfield")},onEnable:function(){this.goBackBtn.on(cc.Node.EventType.TOUCH_START,this.onBackBtnClick,this),this.sendGMCmdBtn.on(cc.Node.EventType.TOUCH_START,this.onSendBtnClick,this),window.GGameEntry.NotificationCenter.on("GMSystemRecM",this.onReceiveMessage,this),window.GGameEntry.NotificationCenter.on("GMToggleSelect",this.onGMToggleSelect,this),window.GGameEntry.NotificationCenter.on("GMCmdSelect",this.onGMCmdSelect,this)},onDisable:function(){this.goBackBtn.off(cc.Node.EventType.TOUCH_START,this.onBackBtnClick,this),this.sendGMCmdBtn.off(cc.Node.EventType.TOUCH_START,this.onSendBtnClick,this),window.GGameEntry.NotificationCenter.off("GMSystemRecM",this.onReceiveMessage,this),window.GGameEntry.NotificationCenter.off("GMToggleSelect",this.onGMToggleSelect,this),window.GGameEntry.NotificationCenter.off("GMCmdSelect",this.onGMCmdSelect,this)},onSendBtnClick:function(){window.GGameEntry.GMSystem.sendGMCmd(this.inputField.getString())},onBackBtnClick:function(){window.GGameEntry.UIManager.HideUI(i.UIType.GMPanel)},onReceiveMessage:function(e){this.GMConsle.string=this.GMConsle.string+"\n"+e.detail.message},onGMToggleSelect:function(e){var t=e.detail.index,n=window.GGameEntry.GMSystem.getGMCmds(t);n&&this.refreshCmds(n)},onGMCmdSelect:function(e){var t=e.detail.cmdString;this.inputField&&this.inputField.setLabel(t)},refreshCmds:function(e){this.GMCmdPanel.removeAllChildren();for(var t=0;t<e.length;t++){var n=cc.instantiate(this.GMActionCmdItem);if(n){var i=n.getComponent("GMActionCtrl");i&&i.init(e[t]),this.GMCmdPanel.addChild(n)}}}}),cc._RF.pop()},{NetworkProto:"NetworkProto",UIManager:"UIManager",star_cs:"star_cs"}],GMSystem:[function(e,t,n){"use strict";cc._RF.push(t,"e07f8mMoedBEqmEl7sPHKXm","GMSystem");var i=e("ResTableNames"),a=e("star_table"),o=e("GMAddBuff"),r=e("GMAttr"),s=e("GMDelBuff"),l=e("GMCmd"),c=e("star_cs"),u=e("loginConfig"),d=e("NetworkProto"),h=e("GMOpenGuide"),a=e("star_table");cc.Class({properties:{GMClassList:{default:null},GMCmdMap:{default:{}},curCondition:{default:a.GMConditionType.GM_CON_OUT_ROOM}},init:function(){this.loadGM()},changeCondition:function(e){this.curCondition=e},loadGM:function(){var e=window.GGameEntry.ResTableMgr.GetTableByName(i.star_gm_command_c);if(e&&e.length>0)for(var t=0;t<e.length;t++){var n=e[t],a=0;"GM_ADVANCE "==n.GMClass&&(a=1),null==this.GMCmdMap[a]&&(this.GMCmdMap[a]=new Array);var c=this.GMCmdMap[a];if(c){var u=null;"GM_CMD_TYPE_GET_ITEM "==n.CmdType?u=new l:"GM_CMD_TYPE_ATTR "==n.CmdType?u=new r:"GM_CMD_TYPE_CREATE_ITEM "==n.CmdType||("GM_CMD_TYPE_M_WINCOUNT "==n.CmdType||"GM_CMD_TYPE_M_KILLCOUNT "==n.CmdType||"GM_CMD_TYPE_M_BLOCKCOUNT "==n.CmdType?u=new l:"GM_CMD_TYPE_OPEN_GUIDE "==n.CmdType?u=new h:"GM_CMD_TYPE_SELECT_SERVER "==n.CmdType?u=new l:"GM_CMD_TYPE_SELECT_MAP "==n.CmdType||"GM_CMD_TYPE_SELECT_TANK "==n.CmdType||("GM_CMD_TYPE_ADD_BUFF "==n.CmdType?u=new o:"GM_CMD_TYPE_DEL_BUFF "==n.CmdType?u=new s:"GM_CMD_TYPE_OPEN_ACTIVITY "==n.CmdType||"GM_CMD_TYPE_SET_BULLET "==n.CmdType||n.CmdType)),u&&(u.init(n),c.push(u))}}},getGMCmds:function(e){this.GMCmdMap[e]||(this.GMCmdMap[e]=new Array);var t=new Array,n="GM_CON_OUT_ROOM ";this.curCondition==a.GMConditionType.GM_CON_BATTLE?n="GM_CON_BATTLE ":this.curCondition==a.GMConditionType.GM_CON_IN_ROOM?n="GM_CON_IN_ROOM ":this.curCondition==a.GMConditionType.GM_CON_ANY&&(n="GM_CON_ANY ");for(var i=0;i<this.GMCmdMap[e].length;i++){var o=this.GMCmdMap[e][i];o.config.GMCondition==n&&t.push(o)}return t},sendGMCmd:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.sendCmdInBattle(e):this.sendCmdOutBattle(e),e+=" send...",window.GGameEntry.NotificationCenter.emit("GMSystemRecM",{message:e})},sendCmdInBattle:function(e){var t=d.GetRequestByID(c.CS_CMD_TYPE.CS_CMD_GM);t.GMStr=e,d.SendBattleSvrRequest(0,t)},sendCmdOutBattle:function(e){var t=d.GetRequestByID(c.CS_CMD_TYPE.CS_CMD_GM);t.GMStr=e;var n=u.getShortSocketURL();d.PushGameSvrMsg(n,0,t,this.onRecvGameMsgCallback)},onRecvGameMsgCallback:function(){},receiveGMMessage:function(e){window.GGameEntry.NotificationCenter.emit("GMSystemRecM",{message:e})}}),cc._RF.pop()},{GMAddBuff:"GMAddBuff",GMAttr:"GMAttr",GMCmd:"GMCmd",GMDelBuff:"GMDelBuff",GMOpenGuide:"GMOpenGuide",NetworkProto:"NetworkProto",ResTableNames:"ResTableNames",loginConfig:"loginConfig",star_cs:"star_cs",star_table:"star_table"}],GameConfig:[function(e,t,n){"use strict";cc._RF.push(t,"19ab4Av3IFLNKc1SqdKeaVe","GameConfig");var i=e("PlatformUtil"),a=e("ResTableNames");cc.Class({properties:{winCount:{default:0,visible:!1},loseCount:{default:0,visible:!1},hideAttackRing:{default:0,visible:!1},cameraXFlow:{default:1,visible:!1}},init:function(){var e=i.GetValue("GameConfig");this.rules=[0,2,0,0,3,0],e?(this.winCount=e.winCount,this.loseCount=e.loseCount,this.hideAttackRing=e.hideAttackRing,this.cameraXFlow=1):(this.winCount=0,this.loseCount=0,this.hideAttackRing=0,this.cameraXFlow=1),this.setAIRules()},setAIRules:function(){var e=this.getConfigRule(6);e||(e=this.getConfigRule(7)),e||(e=this.getConfigRule(8)),e||(e=this.getConfigRule(9)),e||(e=this.getConfigRule(10)),e||(e=this.getConfigRule(11)),e&&(this.rules=e)},getConfigRule:function(e){var t=window.GGameEntry.ResTableMgr.GetConfigByID(a.star_global_cs,e);if(t){var n=this.parseConfig(t);if(n&&n.length>0){var i=n.pop();if(9==i)return n;if(this.winCount<=i)return n}}return null},parseConfig:function(e){for(var t=parseInt(e.Value),n=[];t>0;)n.push(t%10),t=Math.floor(t/10);return n},saveGameConfig:function(){var e=i.GetValue("GameConfig");e||(e={winCount:0,loseCount:0,hideAttackRing:0}),e.winCount=this.winCount,e.loseCount=this.loseCount,e.hideAttackRing=this.hideAttackRing,e.cameraXFlow=this.cameraXFlow,i.SetValue("GameConfig",e)},clearWinCount:function(){this.winCount=0,this.loseCount=0,this.saveGameConfig()}}),cc._RF.pop()},{PlatformUtil:"PlatformUtil",ResTableNames:"ResTableNames"}],GameEntry:[function(e,t,n){"use strict";cc._RF.push(t,"ce7b1nOxStH7ZxxGNgbc62G","GameEntry");var i=e("UIManager"),a=e("Util"),o=e("PlatformUtil"),r=e("GameNetwork"),s=e("BattleNetwork"),l=(e("star_macro"),e("CmdMgr")),c=e("ResTableMgr"),u=(e("BattleSystem"),e("GlobalCfg")),d=(e("AnimationManager"),e("weixininterface")),h=e("MsgHandler"),f=e("GameConfig"),m=e("loginServerMgr"),y=e("base64").Base64,p=e("CmdStartLoadMap"),g=(e("FollowManager"),e("TimeSystem")),C=e("MathUtil"),G=(e("ResManager"),e("weixinmsgmgr")),S=e("ServerLog"),E=e("GMSystem");cc.Class({extends:cc.Component,properties:{DebugCollision:{default:!0},ShowFPS:!0,JumpToBattleField:{default:!1},UIRoot:{default:null,type:cc.Node},Performance1104:{default:!0},CurGamePlayType:u.GamePlayType.GamePlayType_None},onEnable:function(){this.init()},init:function(){!0!==this.Inited&&(d.onCatchError(),this.Inited=!0,window.GGameEntry=this,this.ResTableMgr=new c,this.ResTableMgr.Init(),this.TimeSystem=new g,this.TimeSystem.Init(),this.ShowFPS=!1,o.IsWeichatGame()?!0===GameSettingConfig.ShowFPS&&(this.ShowFPS=!0):this.ShowFPS=!0)},InitGameModule:function(){!0!==this.gameMobuleInited&&(this.gameMobuleInited=!0,this.GBase64=y,this.ServerName="",this.OpenID="",this.IsReconnect=!1,this.IsNetAvailable=!0,this.tankshareurl="",this.sharerankurl="",this.inviteshareurl="",this.tanksharetips="",this.shareranktips="",this.shareRecordtips="",this.invitesharetips="",this.rightsharetips="",this.EffPAvgFPS=60,this.EffPRangeH=32,this.EffPRangeL=28,this.EffPRangeMMin=20,this.EffPRangeMMax=40,this.LogoUIShareShow=!1,this.CurGamePlayType=u.GamePlayType.GamePlayType_Single,this.GBattleNetwork=new s,this.GBattleNetwork.Init(this.GBattleNetworkConnectedCallback),this.GGameNetwork=new r,this.GGameNetwork.Init(),this.GameConfig=new f,this.GCmdMgr=new l,this.GCmdMgr.Init(this),this.MathUtil=new C,this.MathUtil.init(),d.onWXInit(),h.RegisterMsgHandler(),cc.macro.BATCH_VERTEX_COUNT=2e4,cc.macro.ENABLE_CULLING=!1,cc.director.setDisplayStats(!1),cc.director.getCollisionManager().enabled=!0,cc.director.enabledDrawBoundingBox=!0,cc.rendererCanvas.enableDirtyRegion(!1),this.NotificationCenter=new cc.EventTarget,this.MapManager=this.node.getComponentInChildren("MapManager"),this.ItemManager=this.node.getComponentInChildren("ItemManager"),this.PlayerManager=this.node.getComponentInChildren("PlayerManager"),this.UIManager=this.node.getComponentInChildren("UIManager"),this.GlobalCfg=this.node.getComponentInChildren("GlobalCfg"),this.LevelManager=this.node.getComponentInChildren("LevelManager"),this.MonsterManager=this.node.getComponentInChildren("MonsterManager"),this.JoystickConfig=this.node.getComponentInChildren("JoystickConfig"),this.SoundManager=this.node.getComponentInChildren("SoundManager"),this.BulletManager=this.node.getComponentInChildren("BulletManager"),this.GenerateId=this.node.getComponentInChildren("GenerateId"),this.CollisionObject=this.node.getComponentInChildren("CollisionObject"),this.BattleItemCacheManager=this.node.getComponentInChildren("BattleItemCacheManager"),this.BattleRoot=this.node.getComponentInChildren("BattleRoot"),this.BattleSystem=this.node.getComponentInChildren("BattleSystem"),this.BlockMgr=this.node.getComponentInChildren("BlockMgr"),this.EntityManager=this.node.getComponentInChildren("EntityManager"),this.AnimationManager=this.node.getComponentInChildren("AnimationManager"),this.PerformanceMgr=this.node.getComponentInChildren("PerformanceMgr"),this.AirDropSystem=this.node.getComponentInChildren("AirDropSystem"),this.FollowManager=this.node.getComponentInChildren("FollowManager"),this.ResManager=this.node.getComponentInChildren("ResManager"),this.MsgDelayDoing=this.node.getComponentInChildren("MsgDelayDoing"),this.GMSystem=new E,this.GMSystem.init(),null!==this.MapManager&&null!==this.ItemManager&&null!==this.PlayerManager&&null!==this.UIManager&&null!==this.GlobalCfg&&null!==this.LevelManager&&null!==this.MonsterManager&&null!==this.JoystickConfig&&null!==this.SoundManager&&null!==this.BulletManager&&null!==this.GenerateId&&null!==this.CollisionObject&&null!==this.PerformanceMgr?(this.GlobalCfg.ProfileEnable=!1,this.BattleRoot.DisableMe(),this.MapManager.Init(this),this.PlayerManager.Init(this),this.UIManager.Init(this),this.ItemManager.Init(this),this.LevelManager.Init(this),this.MonsterManager.Init(this),this.BulletManager.Init(this),this.GenerateId.Init(),this.CollisionObject.Init(this),this.BattleSystem.Init(),this.PerformanceMgr.Init(),this.SoundManager.Init(),this.ResManager.Init(),this.CurGamePlayType===u.GamePlayType.GamePlayType_Single&&(this.BattleSystem.SinglePlayerMapID=1),this.JumpToBattleField&&this.BattleSystem.EnterBattle(),this.IsGuidingNow=!1):cc.error("error, manager is null!!!!"))},update:function(e){this.Inited&&(this.gameMobuleInited?(a.BeginSample("GameEntry::update"),this.GCmdMgr.update(e),this.GGameNetwork.Update(),this.GBattleNetwork.Update(),m.update(e),a.EndSample("GameEntry::update")):this.ResTableMgr.GetLoadProgress().complete&&this.InitGameModule())},EnterGame:function(){},GBattleNetworkConnectedCallback:function(){console.log("GBattleNetworkConnectedCallback"),G.onHideLoadingState(),window.GGameEntry.CurGamePlayType===u.GamePlayType.GamePlayType_Network&&window.GGameEntry.BattleSystem.IsPlaying()&&window.GGameEntry.BattleSystem.Resume(),m.onGetRoleInfo()},EnterGuide:function(){this.IsGuidingNow=!0,window.GGameEntry.CurGamePlayType=u.GamePlayType.GamePlayType_Single;var e=new p;e.Init(),e.MapID=11,window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(e)},IsGuiding:function(){return this.IsGuidingNow},SetFinishGuide:function(){this.IsGuidingNow=!1,o.SetValue("GuideProcessed",!0)},ExitGuide:function(){this.IsGuidingNow=!1,this.UIManager.HideUI(i.UIType.GuideUI)},CheckHasDoneGuide:function(){return o.GetValue("GuideProcessed")},IsNetworkPlay:function(){return window.GGameEntry.CurGamePlayType===u.GamePlayType.GamePlayType_Network},ServerLogHelp:function(e){S.pushLog(e)},StringFormat:function(e){if(0==arguments.length)return null;var t=Array.prototype.slice.call(arguments,1);return e.replace(/\{(\d+)\}/g,function(e,n){return t[n]})}}),cc._RF.pop()},{AnimationManager:"AnimationManager",BattleNetwork:"BattleNetwork",BattleSystem:"BattleSystem",CmdMgr:"CmdMgr",CmdStartLoadMap:"CmdStartLoadMap",FollowManager:"FollowManager",GMSystem:"GMSystem",GameConfig:"GameConfig",GameNetwork:"GameNetwork",GlobalCfg:"GlobalCfg",MathUtil:"MathUtil",MsgHandler:"MsgHandler",PlatformUtil:"PlatformUtil",ResManager:"ResManager",ResTableMgr:"ResTableMgr",ServerLog:"ServerLog",TimeSystem:"TimeSystem",UIManager:"UIManager",Util:"Util",base64:"base64",loginServerMgr:"loginServerMgr",star_macro:"star_macro",weixininterface:"weixininterface",weixinmsgmgr:"weixinmsgmgr"}],GameMode:[function(e,t,n){"use strict";cc._RF.push(t,"486b8JFsAdFHqVMV2bPML/W","GameMode");var i={GameMode_Default:0,GameMode_Single:1,GameMode_PVPPlayer:2,GameMode_Activity:3},a=i.GameMode_Default;t.exports={GM:i,SetGameMode:function(e){a=e},IsGameMode:function(e){return a===e}},cc._RF.pop()},{}],GameNetwork:[function(e,t,n){"use strict";cc._RF.push(t,"c0149u6ae9PZodEZAXSvN6e","GameNetwork");var i=e("Network"),a=e("NetworkConnector"),o=e("NetworkStatus"),r=e("NetworkUtils"),s=(e("Container"),e("JsonUtils"));e("UIManager"),e("loginConfig"),e("GlobalCfg");cc.Class({extends:i,ctor:function(){this.name="Game",this.connector=new a,this.connector.init(this),this.sendQueue=[]},clearSendBuf:function(){this.sendQueue=[]},Request:function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:15e3,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(r.IsValidUrl(e)){var l=s.SafeStringify(t);if(l){if(this.sendQueue.length>0&&(console.error("[GameNetwork.Request] Request message error, some package sending."),console.error(t)),!0===o&&this.sendQueue.length>0)return console.log("[GameNetwork.Request] Request message has been throwen."),void console.log(t);this.Disconnect();var c={url:e,data:l,handler:n,status:"waiting",blocking:i,overTime:a,sendTick:0};this.sendQueue.push(c)}else console.log("[GameNetwork.Request] failed, invalid jsonObject:")}else console.log("[GameNetwork.Request] failed, invalid url")},Update:function(){this.UpdateSend(),this.pauseRecvMsg||this.UpdateRecv()},Disconnect:function(){this.IsConnected()?(this.clearSendBuf(),this.connector.close(),console.log("[GameNetwork.Disconnect] disconnect.")):console.warn("[GameNetwork.Disconnect] failed: network not connected.")},UpdateSend:function(){var e=this.sendQueue.length>0?this.sendQueue[0]:void 0;e&&("waiting"===e.status&&(e.status="connecting",e.sendTick=Date.now(),console.log("[GameNetwork.UpdateSend] begin message: %s.",e.data)),"connecting"===e.status&&(this.connector.getURL()===e.url&&this.connector.status!==o.Status.NotConnect||(this.connector.connect(e.url),console.log("[GameNetwork.UpdateSend] connecting to server.")),e.status="sending"),"sending"===e.status&&this.connector.status===o.Status.Connected&&(this.connector.send(e.data),e.status="recving"),Date.now()-e.sendTick>e.overTime&&(e.status="waiting",this.clearSendBuf(),this.Disconnect()))},UpdateRecv:function(){var e=this.sendQueue.length>0?this.sendQueue[0]:void 0;if(e&&"recving"===e.status){var t=this.connector.recv();t&&(this.clearSendBuf(),this.Disconnect(),e.handler&&e.handler(t),e=null)}}}),cc._RF.pop()},{Container:"Container",GlobalCfg:"GlobalCfg",JsonUtils:"JsonUtils",Network:"Network",NetworkConnector:"NetworkConnector",NetworkStatus:"NetworkStatus",NetworkUtils:"NetworkUtils",UIManager:"UIManager",loginConfig:"loginConfig"}],GenerateId:[function(e,t,n){"use strict";cc._RF.push(t,"c5111I772pAM7FOZqaaQx8C","GenerateId"),cc.Class({extends:cc.Component,properties:{Guid:{default:0,serializable:!1,visible:!1}},onLoad:function(){},GetGuid:function(){return++this.Guid},Init:function(){},Release:function(){this.Guid=0,this.Log("GenerateId Release called")},Pause:function(){},Resume:function(){},Log:function(e){this.LogEnabled}}),cc._RF.pop()},{}],GlobalCfg:[function(e,t,n){"use strict";cc._RF.push(t,"5b34ekplB5GEp8FvRZbRMGy","GlobalCfg");var i=e("PlatformUtil");cc.Class({extends:cc.Component,properties:{PlayerDefaultMoveSpeed:{default:cc.v2(175,175),serializable:!0,visible:!0},CoinScore:5,DiamondScore:25,BonusScore:100,LightningSpeedBonus:100,LightningDuration:5,LightningRunningOutTime:4.5,MonsterPatrolRangeA:3,MonsterPatrolRangeB:15,MonsterVisionA:7,MonsterVisionB:13,LightingMinDis:5,MonsterKilledBaseScore:50,MonsterEscapeDistance:9,MonsterEscapeCheckTime:1,ComboIntervalTime:.5,TeleporterInvincibleTime:.5,ComboFlySpeed:1e3,ViewHeightGridCount:9.5,DefaultGameTime:18e4,DefaultBaseDurability:1,DefaultReBornTime:3e3,DefaultBreakBrickMinValue:1,DefaultTankHP:100,DefaultTankNormalAttackHurt:1,DefaultTankNormalAttackInternal:500,DefaultBulletNum:3,DefaultBulletFillInternal:1e3,DefaultTankMoveSpeed:260,DefaultTankColliderSizeWidth:100,DefaultTankColliderSizeHeight:100,DefaultBulletSpeed:900,DefaultBulletColliderSizeWidth:30,DefaultBulletColliderSizeHeight:20,DefaultBulletMaxDistance:500,DefaultIsOverEdge:!0,DefaultShowAIDifficulty:!0,DefaultEnableSimulatePath:!1,DefaultDirectionUIDistance:10,ProfileEnable:!1,DefaultRotationBase:24,DefaultTankHPControl:!0},onLoad:function(){this.LoadConfig()},LoadConfig:function(){i.GetValue("GlobalConfig");this.ResetConfig()},ResetConfig:function(){this.Config={},this.GameTime=this.DefaultGameTime,this.BaseDurability=this.DefaultBaseDurability,this.ReBornTime=this.DefaultReBornTime,this.BreakBrickMinValue=this.DefaultBreakBrickMinValue,this.TankHP=this.DefaultTankHP,this.TankNormalAttackHurt=this.DefaultTankNormalAttackHurt,this.TankNormalAttackInternal=this.DefaultTankNormalAttackInternal,this.BulletNum=this.DefaultBulletNum,this.BulletFillInternal=this.DefaultBulletFillInternal,this.TankMoveSpeed=this.DefaultTankMoveSpeed,this.TankColliderSizeWidth=this.DefaultTankColliderSizeWidth,this.TankColliderSizeHeight=this.DefaultTankColliderSizeHeight,this.BulletSpeed=this.DefaultBulletSpeed,this.BulletColliderSizeWidth=this.DefaultBulletColliderSizeWidth,this.BulletColliderSizeHeight=this.DefaultBulletColliderSizeHeight,this.BulletMaxDistance=this.DefaultBulletMaxDistance,this.IsOverEdge=this.DefaultIsOverEdge,this.showAIDifficulty=this.DefaultShowAIDifficulty,this.enablesimulatePath=this.DefaultEnableSimulatePath,this.rotationBase=this.DefaultRotationBase,this.DirectionUIDistance=this.DefaultDirectionUIDistance,this.TankHPControl=this.DefaultTankHPControl},SaveConfig:function(){i.SetValue("GlobalConfig",this.Config),window.GGameEntry.NotificationCenter.emit("UpdateGlobalConfig")}});var a=cc.Enum({GamePlayType_None:0,GamePlayType_Single:1,GamePlayType_Network:2});t.exports={GamePlayType:a},cc._RF.pop()},{PlatformUtil:"PlatformUtil"}],GuideUI:[function(e,t,n){"use strict";cc._RF.push(t,"aa0b3odc2JE94kne6ScgxV5","GuideUI");var i=e("ResTableNames"),a=e("Util"),o=e("MapCfg"),r=e("UIManager"),s=e("EntityTypeDefine"),l=e("SkillDefine"),c=e("CmdSkill"),u=cc.Enum({None:0,MoveToPosition:1,GuideComplete:2,DestroyStaticObject:3,ShowText:4,CreateItem:5,GainItem:6,CreateMonster:7,MonsterAtk:8,DestroyMonster:9,ShowUIFlag:10,ShowMapFlag:11,EnableButton:12,GuideLine:13});cc.Class({extends:cc.Component,properties:{GuideTextNode:{default:null,type:cc.Node},GuideText:{default:null,type:cc.Label},GainItemTextNode:{default:null,type:cc.Node},GainItemText:{default:null,type:cc.Label},MapGuideFlag:{default:null,type:cc.Node},UIGuideFlag:{default:[],type:cc.Node},UIGuideFlagAnchorNodeName:{default:[],type:cc.String},BtnEnableSpr:{default:null,type:cc.SpriteFrame},BtnDisableSpr:{default:null,type:cc.SpriteFrame},GuideLineNode:{default:null,type:cc.Node},AttackEnemyNode:{default:null,type:cc.Node}},onLoad:function(){this.MapGuideFlagInstance=null,this.UpdateInterval=.1,this.UpdateTick=0,this.CurGuideData={ID:0,Type:u.None,Param:[],Text:"",Time:0,NextID:0},this.GuideLineCache=[],this.GuideLineUsed=[],this.UpdateGuideData={ID:0,Type:u.None,Param:[],Text:"",Time:0,NextID:0},this.FireFirstNode=!1,this.DisableButton=!1,this.ShowFlag=[];for(var e=0;e<this.UIGuideFlag.length;e++)this.ShowFlag[this.ShowFlag.length]=!1},onEnable:function(){this.GuideTextNode.opacity=0,this.GainItemTextNode.opacity=0,this.FireFirstNode=!1,this.ShowLeftFlag=!1,window.GGameEntry.NotificationCenter.on("GuideGainItem",this.GuideGainItem,this),window.GGameEntry.BattleSystem.Pause(!0),this.BeginCameraEffect()},BeginCameraEffect:function(){var e=window.GGameEntry.MapManager.GetMapBattleHomePos(s.EntityCampType.RedTeam),t=window.GGameEntry.MapManager.GetMapBattleHomePos(s.EntityCampType.BlueTeam);e=new cc.Vec2(e.x,e.y),t=new cc.Vec2(t.x,t.y),this.AttackEnemyNode.opacity=255;var n=this;this.scheduleOnce(function(){window.GGameEntry.BattleRoot.moveBattleCameraInTime(e,t,1.5)},1.5),this.scheduleOnce(function(){n.AttackEnemyNode.opacity=0},5),this.scheduleOnce(function(){window.GGameEntry.UIManager.ShowUI(r.UIType.BeginCountDownUI)},2),this.scheduleOnce(function(){window.GGameEntry.BattleRoot.moveBattleCameraInTime(t,window.GGameEntry.PlayerManager.Player.node.getPosition(),1)},3.8),this.scheduleOnce(function(){window.GGameEntry.BattleRoot.SetBattleViewTarget(window.GGameEntry.PlayerManager.Player.node),window.GGameEntry.BattleSystem.Resume(!0)},5)},onDisable:function(){this.DeleteGuideFlag(),this.DisableButton&&this.SetEnableButton(!0);for(var e=0;e<this.UIGuideFlag.length;e++)this.UIGuideFlag[e].opacity=0,this.UIGuideFlag[e].parent=this.node,this.ShowFlag[e]=!1;window.GGameEntry.NotificationCenter.off("GuideGainItem",this.GuideGainItem,this),this.node.stopAllActions(),this.unscheduleAllCallbacks(),this.SetUpdateGuideData(null)},DeleteGuideFlag:function(){this.MapGuideFlagInstance&&this.MapGuideFlagInstance.destroy(),this.MapGuideFlagInstance=null;for(e=0;e<this.GuideLineCache.length;e++)this.GuideLineCache[e].destroy();for(var e=0;e<this.GuideLineUsed.length;e++)this.GuideLineUsed[e].destroy();this.GuideLineCache=[],this.GuideLineUsed=[]},update:function(e){if(window.GGameEntry.BattleSystem.JoysticUIReady){if(!this.FireFirstNode){var t=window.GGameEntry.PlayerManager.Player;return t&&(t.CfgSourceConfigSpeed=200),this.FireFirstNode=!0,void this.FireGuidByID(1)}0!==this.CurGuideData.ID&&(this.UpdateGuide(e),this.CheckComplete()&&this.FireNextGuide())}},FireNextGuide:function(){0!=this.CurGuideData.NextID&&(this.ClearGuide(this.CurGuideData),this.FireGuidByID(this.CurGuideData.NextID))},FireGuidByID:function(e){var t=window.GGameEntry.ResTableMgr.GetConfigByID(i.star_guide_c,e);if(this.CurGuideData.ID=0,t){this.CurGuideData.ID=a.TableStr2Num(t.ID),this.CurGuideData.Type=a.TableStr2Num(t.Type),this.CurGuideData.Param=[];for(var n=t.Param.split(" "),o=0;o<n.length;o++)""!=n[o]&&(this.CurGuideData.Param[this.CurGuideData.Param.length]=a.TableStr2Num(n[o]));this.CurGuideData.Text=t.Text,this.CurGuideData.Time=a.TableStr2Num(t.Time)/1e3,this.CurGuideData.NextID=a.TableStr2Num(t.NextID)}this.FireGuide(this.CurGuideData)},ClearGuide:function(e){if(e&&0!==e.ID)switch(e.Type){case u.MoveToPosition:case u.DestroyStaticObject:}},FireGuide:function(e){if(e&&0!==e.ID){switch(e.Type){case u.MoveToPosition:break;case u.GuideComplete:this.OnExitGuideBtn();break;case u.DestroyStaticObject:break;case u.CreateItem:(a=window.GGameEntry.MapManager.GetWorldPos(this.CurGuideData.Param[0]*o.MapGlobalCfg.MapTileSize[0],this.CurGuideData.Param[1]*o.MapGlobalCfg.MapTileSize[1],!1))[0]+=50,a[1]+=50;var t=window.GGameEntry.ItemManager.CreateItem(this.CurGuideData.Param[2],a[0],a[1]);t&&(t.AvailableTime=99999,window.GGameEntry.EntityManager.AddEntity(t));break;case u.CreateMonster:var n=this.CurGuideData.Param[0]*o.MapGlobalCfg.MapTileSize[0],i=this.CurGuideData.Param[1]*o.MapGlobalCfg.MapTileSize[1],a=window.GGameEntry.MapManager.GetWorldPos(n,i,!1);(h=window.GGameEntry.MonsterManager.CreateGuideMonster(this.CurGuideData.Param[2],this.CurGuideData.Param[3],a[0]+50,a[1]+50))&&(h.CurrentAttachCd=0),window.GGameEntry.NotificationCenter.emit("OnCreatMonsterInGuide");var r=window.GGameEntry.PlayerManager.Player;if(r){var d=window.GGameEntry.MapManager.GetGridPos(r.node.x,r.node.y);Math.abs(d[0]-n)<2&&Math.abs(d[1]-i)<2&&r.setTankPosition(cc.p(a[0]+100,a[1]))}break;case u.MonsterAtk:var h=this.CurGuideData.Param[2]==s.EntityCampType.BlueTeam?window.GGameEntry.MonsterManager.monsterBuluTeamArray[0]:window.GGameEntry.MonsterManager.monsterRedTeamArray[0];if(h&&!h.DeadAni){var f=h.CalRotation(window.GGameEntry.PlayerManager.Player.node.position);h.rotateAll(f);var m=new c;m.Init(l.SkillType.SkillType_NormalAttack,h.GetGuid(),0),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(m)}break;case u.ShowUIFlag:var y=this.CurGuideData.Param[1]-1;if(0===this.CurGuideData.Param[0])this.UIGuideFlag[y].opacity=0,this.UIGuideFlag[y].parent=this.node,this.ShowFlag[y]=!1;else{var p=cc.find(this.UIGuideFlagAnchorNodeName[y],window.GGameEntry.node);p&&(this.UIGuideFlag[y].parent=p,this.UIGuideFlag[y].setPosition(0,10)),this.UIGuideFlag[y].opacity=255,this.ShowFlag[y]=!0}break;case u.ShowMapFlag:this.MapGuideFlagInstance||(this.MapGuideFlagInstance=cc.instantiate(this.MapGuideFlag),this.MapGuideFlagInstance.parent=window.GGameEntry.MapManager.MapTopLayer,this.MapGuideFlagInstance.active=!0),0===this.CurGuideData.Param[0]?this.MapGuideFlagInstance.opacity=0:(this.MapGuideFlagInstance.opacity=255,(a=window.GGameEntry.MapManager.GetWorldPos(this.CurGuideData.Param[1]*o.MapGlobalCfg.MapTileSize[0],this.CurGuideData.Param[2]*o.MapGlobalCfg.MapTileSize[1],!1))[0]+=50,a[1]+=50,this.MapGuideFlagInstance.setPosition(a[0],a[1]));break;case u.EnableButton:var g=0!=this.CurGuideData.Param[0];this.SetEnableButton(g),this.DisableButton=!g;break;case u.GuideLine:(g=0!=this.CurGuideData.Param[0])?(this.ProcessGuideLine(this.CurGuideData.Param[1],this.CurGuideData.Param[2],this.CurGuideData.Param[3]),this.SetUpdateGuideData(this.CurGuideData)):(this.ClearGuideLine(),this.SetUpdateGuideData(null))}if(this.CurGuideData.Time>0){var C="string"==typeof e.Text;C&&(this.GuideText.string=e.Text);var G=this.CurGuideData.Time;if(0!=G){var S=this.GuideTextNode;this.scheduleOnce(function(){S.opacity=0},G)}this.GuideTextNode.opacity=C?255:1}else this.GuideTextNode.opacity=0}},CheckComplete:function(){if(!this.CurGuideData||0===this.CurGuideData.ID)return!0;switch(this.CurGuideData.Type){case u.MoveToPosition:var e=this.CurGuideData.Param[0],t=this.CurGuideData.Param[1],n=window.GGameEntry.PlayerManager.Player.node.position,i=window.GGameEntry.MapManager.GetGridPos(n.x,n.y);if(e===Math.floor(i[0]/o.MapGlobalCfg.MapTileSize[0])&&t===Math.floor(i[1]/o.MapGlobalCfg.MapTileSize[1]))return!0;break;case u.DestroyStaticObject:var e=this.CurGuideData.Param[0],t=this.CurGuideData.Param[1];return window.GGameEntry.MapManager.BigGridCanWalk(e,t);case u.ShowText:return 0===this.GuideTextNode.opacity;case u.CreateItem:case u.CreateMonster:case u.GuideComplete:case u.MonsterAtk:case u.ShowUIFlag:case u.ShowMapFlag:case u.EnableButton:case u.GuideLine:return!0;case u.GainItem:if(!window.GGameEntry.ItemManager.CheckHasItemByResID(this.CurGuideData.Param[2]))return!0;break;case u.DestroyMonster:var a=this.CurGuideData.Param[2]==s.EntityCampType.BlueTeam?window.GGameEntry.MonsterManager.monsterBuluTeamArray:window.GGameEntry.MonsterManager.monsterRedTeamArray;if(0===a.length)return!0;for(var r=0;r<a.length;r++)if(a[r].Hp>0)return!1;return!0}return!1},UpdateGuide:function(e){if(!this.UpdateGuideData||0===this.UpdateGuideData.ID)return!0;if(this.UpdateTick+=e,!(this.UpdateTick<this.UpdateInterval))switch(this.UpdateTick=0,this.UpdateGuideData.Type){case u.GuideLine:0!=this.UpdateGuideData.Param[0]&&this.ProcessGuideLine(this.UpdateGuideData.Param[1],this.UpdateGuideData.Param[2],this.UpdateGuideData.Param[3])}},OnExitGuideBtn:function(){window.GGameEntry.BattleSystem.ExitGuideBattle()},ProcessGuideLine:function(e,t,n){if(!window.GGameEntry.PlayerManager.Player)return 0;var i=window.GGameEntry.MapManager.GetWorldPos(e*o.MapGlobalCfg.MapTileSize[0],t*o.MapGlobalCfg.MapTileSize[1]);i[0]+=50,i[1]+=50;var a=cc.v2(i[0]-window.GGameEntry.PlayerManager.Player.node.x,i[1]-window.GGameEntry.PlayerManager.Player.node.y),r=Math.floor(a.mag()/n),s=!1;if(r<this.GuideLineUsed.length){for(c=this.GuideLineUsed.length-1;c>=r;c--)this.GuideLineUsed[c].opacity=0,this.GuideLineCache[this.GuideLineCache.length]=this.GuideLineUsed[c];this.GuideLineUsed.splice(r,this.GuideLineUsed.length-r)}else if(r>this.GuideLineUsed.length){for(var l=0,c=0;c<this.GuideLineCache.length&&r>this.GuideLineUsed.length;c++)this.GuideLineCache[c].opacity=255,this.GuideLineUsed[this.GuideLineUsed.length]=this.GuideLineCache[c],l++;this.GuideLineCache.splice(0,l);for(var u=r-this.GuideLineUsed.length,c=0;c<u;c++){var d=cc.instantiate(this.GuideLineNode);d.parent=window.GGameEntry.MapManager.MapItemLayer,d.active=!0,d.opacity=255,s=!0,this.GuideLineUsed[this.GuideLineUsed.length]=d}}if(r>0)for(var h=(a=a.normalizeSelf()).x*n,f=a.y*n,m=90-cc.pToAngle(a)/Math.PI*180,c=0;c<this.GuideLineUsed.length;c++)if(i[0]-=h,i[1]-=f,this.GuideLineUsed[c].setPosition(i[0],i[1]),this.GuideLineUsed[c].rotation=m,s){var y=this.GuideLineUsed[c].getComponent(cc.Animation);y&&(y.setCurrentTime(0),y.play())}},ClearGuideLine:function(){for(var e=this.GuideLineUsed.length-1;e>=0;e--)this.GuideLineUsed[e].opacity=0,this.GuideLineCache[this.GuideLineCache.length]=this.GuideLineUsed[e];this.GuideLineUsed=[]},SetUpdateGuideData:function(e){if(this.UpdateGuideData.ID=0,e){this.UpdateGuideData.ID=e.ID,this.UpdateGuideData.Type=e.Type,this.UpdateGuideData.Param=[];for(var t=0;t<e.Param.length;t++)this.UpdateGuideData.Param[t]=e.Param[t];this.UpdateGuideData.Text=e.Text,this.UpdateGuideData.Time=e.Time,this.UpdateGuideData.NextID=e.NextID}},SetEnableButton:function(e){var t=cc.find("ActiveUIRoot/JoyStickUI/SkillBtn",window.GGameEntry.node);t&&(t.active=e)},GuideGainItem:function(e){if(e&&e.detail&&1304===e.detail.Resid){this.GainItemText.string="“修复”道具让耐久恢复了！";this.GainItemTextNode;this.HideGainItemTextNodeFn||(this.HideGainItemTextNodeFn=this.HideGainItemTextNode.bind(this)),this.unschedule(this.HideGainItemTextNodeFn),this.scheduleOnce(this.HideGainItemTextNodeFn,3),this.GainItemTextNode.opacity=255}},HideGainItemTextNode:function(){this.GainItemTextNode.opacity=0}}),cc._RF.pop()},{CmdSkill:"CmdSkill",EntityTypeDefine:"EntityTypeDefine",MapCfg:"MapCfg",ResTableNames:"ResTableNames",SkillDefine:"SkillDefine",UIManager:"UIManager",Util:"Util"}],HeadImageUtil:[function(e,t,n){"use strict";cc._RF.push(t,"e3cafziWMtNsZSJzrfbQU2n","HeadImageUtil");var i={};t.exports={ImageUrlTexturePool:i,loadImageFromRes:function(e,t){"string"!=typeof t&&t&&(e.spriteFrame&&e.spriteFrame.getTexture()===t||(e.spriteFrame=t))},loadImageFromNetUrl:function(e,t){function n(t){null!==e.spriteFrame&&e.spriteFrame.getTexture()===t||(e.spriteFrame=new cc.SpriteFrame(t),i&&i())}var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if("string"==typeof t&&t){if(this.ImageUrlTexturePool.hasOwnProperty(t)){var a=this.ImageUrlTexturePool[t];if(a)return n(a)}var o=this;cc.loader.load({url:t,type:"png"},function(e,i){e||!i?cc.error("loadImageFromNetUrl error :"+e+" ,url "+t):(o.ImageUrlTexturePool[t]=i,n(i))})}}},cc._RF.pop()},{}],Inputfield:[function(e,t,n){"use strict";cc._RF.push(t,"27386YzqypByYFhbWnM+DO0","Inputfield");var i=e("PlatformUtil");cc.Class({extends:cc.Component,properties:{label:{default:null,type:cc.Label}},onEnable:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchEvent,this)},onDisable:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchEvent,this)},onTouchEvent:function(){if(i.IsWeichatGame()){var e=this,t="请输入内容";""!=this.label.string&&(t=this.label.string),wx.onKeyboardConfirm(function(t){e.setLabel(t.value)}),wx.showKeyboard({defaultValue:t,maxLength:140,multiple:!1,confirmHold:!0,confirmType:"done"})}},setLabel:function(e){this.label.string=e},getString:function(){return this.label.string}}),cc._RF.pop()},{PlatformUtil:"PlatformUtil"}],ItemArriveUI:[function(e,t,n){"use strict";cc._RF.push(t,"8b811AdVe9Egov2OzEQNxpZ","ItemArriveUI");var i=e("UIManager");cc.Class({extends:cc.Component,properties:{ShowTime:2,ContentStr:{default:null,type:cc.Label}},setString:function(e){this.ContentStr.string=e},onEnable:function(){this.ShowTick=0},update:function(e){this.ShowTick+=e,this.ShowTick>=this.ShowTime&&window.GGameEntry.UIManager.HideUI(i.UIType.ItemArriveUI)}}),cc._RF.pop()},{UIManager:"UIManager"}],ItemManager:[function(e,t,n){"use strict";cc._RF.push(t,"5bfbePYlB9Js60O+tbXFHiS","ItemManager");var i=e("MapCfg"),a=e("Util"),o=e("EntityTypeDefine"),r=e("ResTableNames"),s=e("GlobalCfg");e("UIManager"),e("ItemPowerUp");cc.Class({extends:cc.Component,properties:{MapItemLayer:{default:null,type:cc.Node},Items:{default:null,serializable:!1,visible:!1},DropItemCfgCache:{default:null,serializable:!1,visible:!1},BrickDropItem:{default:null,serializable:!1,visible:!1}},Init:function(){this.Items=[],this.DropItemCfgCacheInited=!1,this.BrickDropItem=null},_Init:function(){if(!this.DropItemCfgCacheInited&&(this.DropItemCfgCacheInited=!0,window.GGameEntry.CurGamePlayType===s.GamePlayType.GamePlayType_Single)){this.DropItemCfgCache=[];var e=window.GGameEntry.ResTableMgr.GetTableByName(r.star_item_drop_cs);if(e&&e.length>0)for(i=0;i<e.length;i++)a.TableStr2Num(e[i].MapId)===window.GGameEntry.BattleSystem.MapID&&(this.DropItemCfgCache[this.DropItemCfgCache.length]=e[i]);this.BrickDropItem=[];var t=null,n=window.GGameEntry.ResTableMgr.GetTableByName(r.star_brick_drop_cs);if(n&&n.length>0)for(var i=0;i<n.length;i++)if(a.TableStr2Num(n[i].MapId)===window.GGameEntry.BattleSystem.MapID){t=n[i];var o={};this.BrickDropItem[this.BrickDropItem.length]=o,o.ItemID=a.TableStr2Num(t.ID);var l=t.Pos.trim();l.lastIndexOf(";")===l.length-1&&(l=l.slice(0,l.length-1));var c=l.split(";"),u=c[Math.floor(Math.random(0,1)*c.length)];if(u){var d=u.split(",");o.X=a.TableStr2Num(d[0]),o.Y=a.TableStr2Num(d[1])}else cc.error("cfg not valid"),this.BrickDropItem.splice(this.BrickDropItem.length-1,1)}}},Release:function(){for(var e=0;e<this.Items.length;e++)window.GGameEntry.BattleItemCacheManager.CacheMe(this.Items[e]);this.Items=[],window.GGameEntry.CurGamePlayType===s.GamePlayType.GamePlayType_Single&&(this.DropItemCfgCache=[]),this.DropItemTick=0,this.BrickDropItem=null},CreateItem:function(e,t,n){a.BeginSample("ItemManager::CreateItem");o.GetEntityTypeFromResID(e);var i=window.GGameEntry.BattleItemCacheManager.GetBufferItem(e);return i?(i.node.active=!0,i.node.setPosition(t,n),i.GenGUID(),window.GGameEntry.BattleSystem.SetInvertedNode(i.node),this.Items[this.Items.length]=i,window.GGameEntry.SoundManager.PlayItemShow(i.node.position),a.EndSample("ItemManager::CreateItem"),i):(cc.error("create buff item error:",e),void a.EndSample("ItemManager::CreateItem"))},CreateItemAddEnity:function(e,t,n){var i=this.CreateItem(e,t,n);i&&window.GGameEntry.EntityManager.AddEntity(i)},ReleaseItem:function(e){if(e)for(var t=0;t<this.Items.length;t++)if(this.Items[t].Guid===e.Guid){window.GGameEntry.BattleItemCacheManager.CacheMe(this.Items[t]),this.Items.splice(t,1);break}},update:function(e){if(window.GGameEntry.gameMobuleInited&&window.GGameEntry.BattleSystem.IsPlaying()){var t=a.BeginSample("ItemManager::update");this.UpdateOfflineDropItem(e),this.UpdateOfflineBrickDropItem(e),a.EndSample(t)}},UpdateOfflineDropItem:function(e){if(!(window.GGameEntry.CurGamePlayType!==s.GamePlayType.GamePlayType_Single||window.GGameEntry.IsGuiding()||(this._Init(),0===this.DropItemCfgCache.length||(this.DropItemTick||(this.DropItemTick=0),this.DropItemTick+=e,this.DropItemTick<1)))){this.DropItemTick-=1;for(var t=Math.floor(((new Date).getTime()-window.GGameEntry.BattleSystem.BattleData.StartTime)/1e3),n=this.DropItemCfgCache.length-1;n>=0;n--)if(t>=this.DropItemCfgCache[n].Time){var i=this.DropItemCfgCache[n];this.DropItemCfgCache.splice(n,1);var o=a.TableStr2Num(i.DropType);10===o?window.GGameEntry.NotificationCenter.emit("OnOfflineDropItem10",i):3===o&&this.OfflineCreateItem(i)}}},GetAvailablePos:function(e,t,n,i){var a=0,o=0;if(e===n&&t===i){a=e,o=t;for(m=0;m<this.Items.length;m++){y=window.GGameEntry.MapManager.GetGridPos(this.Items[m].node.x,this.Items[m].node.y);if(Math.floor(y[0]/2)===a&&Math.floor(y[1]/2)===o)return void cc.error("no valid pos for item")}}else{for(var r=[],s=Math.min(e,n),l=Math.min(t,i),c=Math.max(e,n),u=Math.max(t,i),d=l;d<=u;d++)for(var h=s;h<=c;h++)if(window.GGameEntry.MapManager.CheckBigGridEmpty(h,d)){for(var f=!1,m=0;m<this.Items.length;m++){var y=window.GGameEntry.MapManager.GetGridPos(this.Items[m].node.x,this.Items[m].node.y);if(Math.floor(y[0]/2)===h&&Math.floor(y[1]/2)===d){f=!0;break}}f||(r[r.length]=[h,d])}if(0==r.length)return void cc.error("no valid pos for item");var p=Math.floor(Math.random()*r.length);a=r[p][0],o=r[p][1]}return[a,o]},OfflineCreateItem:function(e){if(e.DropItems&&!(this.Items.length>=3)){for(var t=0,n=0,o=0,r=0;r<e.DropItems.length;r++)(l=a.TableStr2Num(e.DropItems[r].Weight))>0&&(n+=l,o++);if(0!==n){if(1===o)t=a.TableStr2Num(e.DropItems[0].ItemID);else for(var s=Math.floor(Math.random()*n)+1,r=0;r<o;r++){var l=a.TableStr2Num(e.DropItems[r].Weight);if(l>=s){t=a.TableStr2Num(e.DropItems[r].ItemID);break}s-=l}if(0!==t){var c=a.TableStr2Num(e.X1),u=a.TableStr2Num(e.Y1),d=a.TableStr2Num(e.X2),h=a.TableStr2Num(e.Y2),f=this.GetAvailablePos(c,u,d,h);if(f){(f=window.GGameEntry.MapManager.GetWorldPos(f[0]*i.MapGlobalCfg.MapTileSize[0],f[1]*i.MapGlobalCfg.MapTileSize[1],!1))[0]+=50,f[1]+=50;var m=this.CreateItem(t,f[0],f[1]);m&&window.GGameEntry.EntityManager.AddEntity(m)}}}}},UpdateOfflineBrickDropItem:function(e){if(this.BrickDropItem&&0!==this.BrickDropItem.length)for(var t=this.BrickDropItem.length-1;t>=0;t--){var n=this.BrickDropItem[t];if(window.GGameEntry.MapManager.BigGridCanWalk(n.X,n.Y)){var a=window.GGameEntry.MapManager.GetWorldPos(n.X*i.MapGlobalCfg.MapTileSize[0],n.Y*i.MapGlobalCfg.MapTileSize[1]);a[0]+=50,a[1]+=50;var o=this.CreateItem(n.ItemID,a[0],a[1]);o&&window.GGameEntry.EntityManager.AddEntity(o),this.BrickDropItem.splice(t,1)}}},CreateItemByServer:function(e){if(e){var t=this.CreateItem(e.ResID,e.Pos.x+50,e.Pos.y+50);t?(t.Guid=e.ObjID,t.EntityCampType=e.CampID,t.AvailableTime=20,t.AliveTime=Math.floor(window.GGameEntry.TimeSystem.Now()/1e3)-e.CreateTime,t.AliveTime<=0&&(t.AliveTime=.01),window.GGameEntry.EntityManager.AddEntity(t)):cc.error("create item failed:",e.ResID)}},CheckHasItemByResID:function(e){for(var t=0;t<this.Items.length;t++)if(this.Items[t].Resid===e)return!0;return!1},DebugCheck_CheckAll:function(){this.DebugCheck_Item()},DebugCheck_Item:function(){for(var e={},t=0;t<this.Items.length;t++){var n=this.Items[t];if(a.AssertCheck(n,"道具列表中有空项:"+t.toString()),n){var i=n.Guid;a.AssertCheck(!e[i],"地图物件有相同的GUID:"+this.Items[t].node.name),e[i]||(e[i]=!0)}}}}),cc._RF.pop()},{EntityTypeDefine:"EntityTypeDefine",GlobalCfg:"GlobalCfg",ItemPowerUp:"ItemPowerUp",MapCfg:"MapCfg",ResTableNames:"ResTableNames",UIManager:"UIManager",Util:"Util"}],ItemPowerUp:[function(e,t,n){"use strict";cc._RF.push(t,"9bdf76vszFBEKWDAGyNctFy","ItemPowerUp");var i=e("EntityBase"),a=e("GlobalCfg"),o=e("Util");cc.Class({extends:i,properties:{AvailableTime:20,WarnTime:5,WarnAnimation:{default:null,type:cc.Animation},MyCollider:{default:null,type:cc.Collider},WarnAnimationClip:"",Used:{default:null,serializable:!1,visible:!1},AliveTime:{default:null,serializable:!1,visible:!1},ShowWarning:{default:null,serializable:!1,visible:!1}},onLoad:function(){this._super(),this.Init(),this.Used=!1,this.AliveTime=0,this.ShowWarning=!1},OnDie:function(){this.Used=!0,this.DeadAni||(window.GGameEntry.IsGuiding()&&window.GGameEntry.NotificationCenter.emit("GuideGainItem",this),this._super(),window.GGameEntry.EntityManager.removeEntity(this.Guid))},Reset:function(){this._super(),this.Used=!1,this.AliveTime=0,this.AvailableTime=20,this.WarnAnimation&&(this.WarnAnimation.node.active=!1),this.ShowWarning=!1,this.Body&&(this.Body.active=!0)},_DoDieAction:function(){this._super(),window.GGameEntry.ItemManager.ReleaseItem(this)},update:function(t){if(!this.DeadAni&&!this.Used){var n=o.BeginSample("ItemPowerUp::update");if(this.AliveTime+=t,window.GGameEntry.CurGamePlayType===a.GamePlayType.GamePlayType_Single&&this.AvailableTime-this.AliveTime<=0&&window.GGameEntry.GCmdMgr){var i=new(e("CmdDeleteItem"));i.Init(0,this.Guid),window.GGameEntry.GCmdMgr.AddCmd(i),this.Used=!0,this.WarnAnimation&&(this.WarnAnimation.node.active=!1),this.Body&&(this.Body.active=!0)}!this.ShowWarning&&this.AvailableTime-this.AliveTime<=this.WarnTime&&this.WarnAnimation&&""!==this.WarnAnimationClip&&(this.WarnAnimation.setCurrentTime(0),this.WarnAnimation.play(this.WarnAnimationClip),this.WarnAnimation.node.active=!0,this.ShowWarning=!0,this.Body&&(this.Body.active=!1)),o.EndSample(n)}}}),cc._RF.pop()},{CmdDeleteItem:"CmdDeleteItem",EntityBase:"EntityBase",GlobalCfg:"GlobalCfg",Util:"Util"}],JKTS48UI:[function(e,t,n){"use strict";cc._RF.push(t,"c0de8hcad9F15zaQYL6kwVF","JKTS48UI");var i=e("UIManager");cc.Class({extends:cc.Component,properties:{},onEnable:function(){this.unscheduleAllCallbacks(),this.scheduleOnce(function(){window.GGameEntry.UIManager.ShowUI(i.UIType.LogoUI,i.UIOrder.Top+1),window.GGameEntry.UIManager.HideUI(i.UIType.JKTS48UI)},2)},onDisable:function(){this.unscheduleAllCallbacks()}}),cc._RF.pop()},{UIManager:"UIManager"}],JoystickBG:[function(e,t,n){"use strict";cc._RF.push(t,"db0f2FiBgtK4rT6reD2+4vr","JoystickBG");e("JoystickCommon");cc.Class({extends:cc.Component,properties:{dot:{default:null,type:cc.Node,displayName:"摇杆节点"},directionNode:{default:null,type:cc.Node},directionSprite:{default:null,type:cc.Node},directionSpriteBaseOffset:12,_joyCom:{default:null,displayName:"joy Node"},_playerNode:{default:null,displayName:"被操作的目标Node"},_angle:{default:null,displayName:"当前触摸的角度"},_radian:{default:null,displayName:"弧度"},touchBuffTime:{default:0,visible:!1},touchTime:{default:0,visible:!1},touchStart:{default:!1,visible:!1},_speed:0,_speed1:1,_speed2:1.25,_opacity:0,radius:0},onLoad:function(){this._joyCom=this.node.parent.parent.parent.getComponent("Joystick"),this.radius=this.node.width/2},onEnable:function(){this._initTouchEvent(),window.GGameEntry.NotificationCenter.on("onGameHideCallback",this.reset,this),window.GGameEntry.NotificationCenter.on("UpdateJoystickSetting",this.updateJoystickSetting,this),window.GGameEntry.NotificationCenter.on("BuffJiaSuEnd",this.buffJiaSuEnd,this)},onDisable:function(){this._removeTouchEvent(),window.GGameEntry.NotificationCenter.off("onGameHideCallback",this.reset,this),window.GGameEntry.NotificationCenter.off("UpdateJoystickSetting",this.updateJoystickSetting,this),window.GGameEntry.NotificationCenter.off("BuffJiaSuEnd",this.buffJiaSuEnd,this),this.reset()},_initTouchEvent:function(){var e=this;e.node.on(cc.Node.EventType.TOUCH_START,this._touchStartEvent,e),e.node.on(cc.Node.EventType.TOUCH_MOVE,this._touchMoveEvent,e),e.node.on(cc.Node.EventType.TOUCH_END,this._touchEndEvent,e),e.node.on(cc.Node.EventType.TOUCH_CANCEL,this._touchEndEvent,e)},_removeTouchEvent:function(){var e=this;e.node.off(cc.Node.EventType.TOUCH_START,this._touchStartEvent,e),e.node.off(cc.Node.EventType.TOUCH_MOVE,this._touchMoveEvent,e),e.node.off(cc.Node.EventType.TOUCH_END,this._touchEndEvent,e),e.node.off(cc.Node.EventType.TOUCH_CANCEL,this._touchEndEvent,e),window.GGameEntry.NotificationCenter.off("BuffJiaSuEnd",this.buffJiaSuEnd,this)},update:function(e){null!==this._playerNode&&this._speed>0&&this._dispatchMoveEvent()},_getDistance:function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},_getRadian:function(e){return this._radian=.01745*this._getAngle(e),this._radian},_getAngle:function(e){var t=this.node.getPosition();return this._angle=57.296*Math.atan2(e.y-t.y,e.x-t.x),this._angle},_setSpeed:function(e){this._getDistance(e,this.node.getPosition())<window.GGameEntry.JoystickConfig.Config.HouXuSiQuRadius?(this._dispatchStopMoveEvent(),this._speed=0):this._speed=this._speed1},isInSpawnArea:function(e){var t=this._joyCom.spawnArea,n=t.convertToNodeSpaceAR(e.getLocation()),i=t.width,a=t.height;return n.x>=0&&n.x<=i&&n.y>=0&&n.y<=a},_touchStartEvent:function(e){if(!this.touchStart&&(this.touchStart=!0,!this.isInSpawnArea(e))){var t=this.node.convertToNodeSpaceAR(e.getLocation()),n=this._getDistance(t,cc.p(0,0));this._stickPos=t;var i=this.node.getPosition().x+t.x,a=this.node.getPosition().y+t.y;return this.radius>n?(this.dot.setPosition(cc.p(i,a)),n>window.GGameEntry.JoystickConfig.Config.SiQuRadius&&this._touchMoveEvent(e),!0):(this._touchMoveEvent(e),!1)}},_touchMoveEvent:function(e){var t=this.node.convertToNodeSpaceAR(e.getLocation()),n=this._getDistance(t,cc.p(0,0)),i=this.node.getPosition().x+t.x,a=this.node.getPosition().y+t.y;if(this._getAngle(cc.p(i,a)),this._setSpeed(cc.p(i,a)),this.radius>n)this.dot.setPosition(cc.p(i,a));else{var o=this.node.getPosition().x+window.GGameEntry.MathUtil.cos(this._angle)*this.radius,r=this.node.getPosition().y+window.GGameEntry.MathUtil.sin(this._angle)*this.radius;this.dot.setPosition(cc.p(o,r))}0!==this.directionSprite.position.x&&this.directionSprite.setPosition(cc.p(0,this.directionSprite.position.y)),this._updateDirectionSprite()},_touchEndEvent:function(){this.dot.setPosition(this.node.getPosition()),this._dispatchStopMoveEvent(),this._speed=0,this.directionSprite.setPosition(cc.p(1e4,this.directionSprite.position.y)),this.touchStart=!1,this.touchTime=0},_dispatchMoveEvent:function(){window.GGameEntry.NotificationCenter.emit("JoystickMove",{speed:this._speed,angle:this._angle})},_dispatchRotateEvent:function(){window.GGameEntry.NotificationCenter.emit("JoystickRotate",{angle:this._angle})},_dispatchStoppedMoveEvent:function(e){window.GGameEntry.NotificationCenter.emit("JoystickMove",{speed:0,angle:e})},_dispatchStopMoveEvent:function(){window.GGameEntry.NotificationCenter.emit("JoystickStopMove")},_updateDirectionSprite:function(){var e=this._angle;e<0&&(e+=360),e>=360&&(e%=360);var t=this.directionNode;t.rotation=e<90?90-e:e>=90&&e<180?180-e+270:e>=180&&e<270?270-e+180:360-e+90},updateJoystickSetting:function(){this.touchBuffTime=window.GGameEntry.JoystickConfig.Config.JoystickNoResTime/1e3},reset:function(){this.directionSprite.setPosition(cc.p(1e4,this.directionSprite.position.y)),this.directionNode.rotation=0,this._speed=0,this._angle=0,this.dot.setPosition(this.node.getPosition()),this._dispatchStopMoveEvent()},buffJiaSuEnd:function(){0==this._speed&&this._dispatchStopMoveEvent()}}),cc._RF.pop()},{JoystickCommon:"JoystickCommon"}],JoystickCommon:[function(e,t,n){"use strict";cc._RF.push(t,"2f218v14+5ApY52tiPQqn49","JoystickCommon"),t.exports={TouchType:cc.Enum({DEFAULT:0,FOLLOW:1}),DirectionType:cc.Enum({FOUR:4,EIGHT:8,ALL:0})},cc._RF.pop()},{}],JoystickConfig:[function(e,t,n){"use strict";cc._RF.push(t,"bf147Dpky5HEYqpdjkRhLkl","JoystickConfig");var i=e("PlatformUtil");cc.Class({extends:cc.Component,properties:{DefaultJoystickRadius:100,DefaultJoystickFollow:!1,DefaultJoystickShowJoystick:!0,DefaultJoystickMovingAfterRelease:!1,DefaultSiQuRadiusRadius:15,DefaultHouXuSiQuRadius:0,DefaultPressKeyRadius:125,DefaultFadeOutTime:120,DefaultAnchorCreateRangePostionX:148,DefaultAnchorCreateRangePostionY:152,DefaultAnchorCreateRangeWidth:70,DefaultAnchorCreateRangeHeight:30,DefaultActiveRangeWidth:500,DefaultActiveRangeHeight:500,DefaultIsShowArea:!1,DefaultJoystickCreatePostionX:10,DefaultJoystickCreatePostionY:0,DefaultStartSpeed:10,DefaultStartSpeedTime:300,DefaultCenterSpeed:10,DefaultCenterChangeSpeedTime:350,JoystickMoveDeadZoneRadius:50,JoystickDirectionMoveRadius:80,JoystickMoveRadius:250,JoystickMoveAreaWidth:400,JoystickMoveAreaHeight:400,JoystickMoveDeadZoneChangeRadius:30,JoystickFadeTime:300,JoystickNoResTime:{default:0,visible:!1},RotateRadius:{default:0,visible:!1},Config:{default:null,serializable:!1,visible:!1}},onLoad:function(){this.LoadConfig()},LoadConfig:function(){this.ResetConfig()},ResetConfig:function(){this.Config={},this.Config.Radius=this.DefaultJoystickRadius,this.Config.Follow=this.DefaultJoystickFollow,this.Config.ShowJoystick=this.DefaultJoystickShowJoystick,this.Config.MovingAfterRelease=this.DefaultJoystickMovingAfterRelease,this.Config.SiQuRadius=this.DefaultSiQuRadiusRadius,this.Config.HouXuSiQuRadius=this.DefaultHouXuSiQuRadius,this.Config.PressKeyRadius=this.DefaultPressKeyRadius,this.Config.FadeOutTime=this.DefaultFadeOutTime,this.Config.AnchorCreateRangePostionX=this.DefaultAnchorCreateRangePostionX,this.Config.AnchorCreateRangePostionY=this.DefaultAnchorCreateRangePostionY,this.Config.AnchorCreateRangeWidth=this.DefaultAnchorCreateRangeWidth,this.Config.AnchorCreateRangeHeight=this.DefaultAnchorCreateRangeHeight,this.Config.ActiveRangeWidth=this.DefaultActiveRangeWidth,this.Config.ActiveRangeHeight=this.DefaultActiveRangeHeight,this.Config.JoystickCreatePostionX=this.DefaultJoystickCreatePostionX,this.Config.JoystickCreatePostionY=this.DefaultJoystickCreatePostionY,this.Config.IsShowArea=this.DefaultIsShowArea,this.Config.JoystickNoResTime=0,this.Config.RotateRadius=0,this.Config.StartSpeed=this.DefaultStartSpeed,this.Config.StartSpeedTime=this.DefaultStartSpeedTime,this.Config.CenterSpeed=this.DefaultCenterSpeed,this.Config.CenterChangeSpeedTime=this.DefaultCenterChangeSpeedTime},SaveConfig:function(){i.SetValue("JoystickConfig",this.Config),window.GGameEntry.NotificationCenter.emit("UpdateJoystickSetting")}}),cc._RF.pop()},{PlatformUtil:"PlatformUtil"}],JoystickSpawnCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"c1e43yCSSFPsJiaeYTweRq1","JoystickSpawnCtrl");var i=e("JoystickBG");cc.Class({extends:cc.Component,properties:{joystickNode:{default:null,type:cc.Node,displayName:"摇杆单元"},joystick:{default:null,type:i,displayName:"摇杆"},nodeWidth:{default:200,displayName:"生成区域宽度",visible:!1},nodeHeight:{default:200,displayName:"生成区域高度",visible:!1},configTime:{default:.2,visible:!1}},onLoad:function(){this.initTouchEvent()},initTouchEvent:function(){var e=this;e.node.on(cc.Node.EventType.TOUCH_START,this.touchStartEvent,e),e.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMoveEvent,e),e.node.on(cc.Node.EventType.TOUCH_END,this.touchEndEvent,e),e.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEndEvent,e),this.resetFlag(),this.setJoystickNodePosition({x:window.GGameEntry.JoystickConfig.Config.JoystickCreatePostionX,y:window.GGameEntry.JoystickConfig.Config.JoystickCreatePostionY})},touchStartEvent:function(e){if(!this.joystick.touchStart){this.resetFlag();var t=this.node.convertToNodeSpaceAR(e.getLocation()),n=!1;t.x>this.node.width&&(n=!0,t.x=this.node.width),t.x<0&&(n=!0,t.x=0),t.y>this.node.height&&(n=!0,t.y=this.node.height),t.y<0&&(n=!0,t.y=0),this.setJoystickNodePosition(t),null!==this.joystick&&n&&this.joystick._touchStartEvent(e)}},touchMoveEvent:function(e){this.resetFlag(),null!==this.joystick&&this.joystick._touchMoveEvent(e)},touchEndEvent:function(e){this.joystickReset=!0,null!==this.joystick&&this.joystick._touchEndEvent(e)},stopAllAction:function(){this.joystickNode.stopAllActions()},setJoystickNodePosition:function(e){null!==this.joystickNode&&this.joystickNode.setPosition(cc.p(e.x,e.y))},setMyNodePosition:function(e){this.node.setPosition(cc.p(e.x,e.y))},resetFlag:function(){this.resetTime=0,this.joystickReset=!1},update:function(e){this.joystickReset&&(this.resetTime+=e,this.resetTime>this.configTime&&(this.setJoystickNodePosition({x:window.GGameEntry.JoystickConfig.Config.JoystickCreatePostionX,y:window.GGameEntry.JoystickConfig.Config.JoystickCreatePostionY}),this.resetFlag()))}}),cc._RF.pop()},{JoystickBG:"JoystickBG"}],JoystickTouchArea:[function(e,t,n){"use strict";cc._RF.push(t,"b3f2aq1pHVBkIVarMuItrX7","JoystickTouchArea");var i=e("JoystickSpawnCtrl");cc.Class({extends:cc.Component,properties:{spawnArea:{default:null,type:i,displayName:"生成区域"}},onLoad:function(){this.initTouchEvent()},initTouchAreaSize:function(){this.node.width=window.GGameEntry.JoystickConfig.DefaultActiveRangeWidth,this.node.height=window.GGameEntry.JoystickConfig.DefaultActiveRangeHeight},initTouchEvent:function(){var e=this;e.node.on(cc.Node.EventType.TOUCH_START,this.touchStartEvent,e),e.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMoveEvent,e),e.node.on(cc.Node.EventType.TOUCH_END,this.touchEndEvent,e),e.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEndEvent,e)},touchStartEvent:function(e){null!==this.spawnArea&&this.spawnArea.touchStartEvent(e)},touchMoveEvent:function(e){null!==this.spawnArea&&this.spawnArea.touchMoveEvent(e)},touchEndEvent:function(e){null!==this.spawnArea&&this.spawnArea.touchEndEvent(e)}}),cc._RF.pop()},{JoystickSpawnCtrl:"JoystickSpawnCtrl"}],Joystick:[function(e,t,n){"use strict";cc._RF.push(t,"e98e7hxETxODLM8wGu55+mC","Joystick");var i=e("JoystickCommon"),a=(e("JoystickBG"),e("JoystickSpawnCtrl")),o=e("GlobalCfg");cc.Class({extends:cc.Component,properties:{touchArea:{default:null,type:cc.Node,displayName:"激活区域"},spawnArea:{default:null,type:cc.Node,displayName:"生成区域"},ring:{default:null,type:cc.Node,displayName:"摇杆圆盘"},touchType:{default:i.TouchType.DEFAULT,type:i.TouchType,displayName:"触摸类型"},directionType:{default:i.DirectionType.ALL,type:i.DirectionType,displayName:"方向类型"},sprite:{default:null,type:cc.Node,displayName:"操控的目标"},MoveNode:{default:null,type:cc.Node,displayName:"移动根节点"},normalSkillBtn:{default:null,type:cc.Node,displayName:"普通攻击按钮"},joystickSkillBtn:{default:null,type:cc.Node,displayName:"摇杆攻击按钮"},joystickSkillBtnTouchArea:{default:null,type:cc.Node,displayName:"攻击摇杆触摸区域"},effectBtn:{default:null,type:cc.Node}},onEnable:function(){this.updateJoystickSetting(),this.initSkillBtn(),this.setupPlayer(window.GGameEntry.PlayerManager.Player?window.GGameEntry.PlayerManager.Player.node:null),window.GGameEntry.NotificationCenter.on("UpdateJoystick",this.UpdateJoystick,this),window.GGameEntry.NotificationCenter.on("UpdateJoystickSetting",this.updateJoystickSetting,this),window.GGameEntry.NotificationCenter.on("UpdateGlobalConfig",this.updateGlobalConfig,this),window.GGameEntry.NotificationCenter.on("ShowEffectBtn",this.showEffectBtn,this),window.GGameEntry.BattleSystem.JoysticUIReady=!0,window.GGameEntry.CurGamePlayType===o.GamePlayType.GamePlayType_Single&&(this.effectBtn.active=!1),window.GGameEntry.IsGuiding()&&(this.normalSkillBtn.active=!1),this.checkFlashBuff()},onDisable:function(){window.GGameEntry.NotificationCenter.off("UpdateJoystick",this.UpdateJoystick,this),window.GGameEntry.NotificationCenter.off("UpdateJoystickSetting",this.updateJoystickSetting,this),window.GGameEntry.NotificationCenter.off("UpdateGlobalConfig",this.updateGlobalConfig,this),window.GGameEntry.NotificationCenter.off("ShowEffectBtn",this.showEffectBtn,this),this.effectBtn.active=!1},initSkillBtn:function(){window.GGameEntry.GlobalCfg.useDoubleJoystick?(this.joystickSkillBtnTouchArea.active=!0,this.joystickSkillBtn.active=!0,this.normalSkillBtn.active=!1):(this.joystickSkillBtnTouchArea.active=!1,this.joystickSkillBtn.active=!1,this.normalSkillBtn.active=!0)},updateGlobalConfig:function(){this.initSkillBtn()},updateJoystickSetting:function(){this.setTouchArea(),this.setSpawnArea(),this.setRingSize(),this.setIsShowArea()},setTouchArea:function(){null!==this.touchArea&&(this.touchArea.width=window.GGameEntry.JoystickConfig.Config.ActiveRangeWidth,this.touchArea.height=window.GGameEntry.JoystickConfig.Config.ActiveRangeHeight)},setSpawnArea:function(){if(null!==this.spawnArea){var e=this.spawnArea.getComponent(cc.Widget);e.left=window.GGameEntry.JoystickConfig.Config.AnchorCreateRangePostionX,e.bottom=window.GGameEntry.JoystickConfig.Config.AnchorCreateRangePostionY,e.enabled=!0,this.spawnArea.width=window.GGameEntry.JoystickConfig.Config.AnchorCreateRangeWidth,this.spawnArea.height=window.GGameEntry.JoystickConfig.Config.AnchorCreateRangeHeight,this.spawnArea.getComponent(a).configTime=window.GGameEntry.JoystickConfig.Config.FadeOutTime/1e3}},setRingSize:function(){null!==this.ring&&(this.ring.width=2*window.GGameEntry.JoystickConfig.Config.PressKeyRadius,this.ring.height=2*window.GGameEntry.JoystickConfig.Config.PressKeyRadius,this.MoveNode.setPosition(window.GGameEntry.JoystickConfig.Config.JoystickCreatePostionX,window.GGameEntry.JoystickConfig.Config.JoystickCreatePostionY))},setIsShowArea:function(){this.touchAreaSprite=this.touchArea.getComponent("cc.Sprite"),this.spawnAreaSprite=this.spawnArea.getComponent("cc.Sprite"),window.GGameEntry.JoystickConfig.Config.IsShowArea?(this.spawnAreaSprite.enabled=!0,this.touchAreaSprite.enabled=!0):(this.spawnAreaSprite.enabled=!1,this.touchAreaSprite.enabled=!1)},StopAll:function(){this.node.stopAllActions(),window.GGameEntry.NotificationCenter.off("UpdateJoystick",this.UpdateJoystick,this)},UpdateJoystick:function(){var e=window.GGameEntry.JoystickConfig.Config;e.MovingAfterRelease||this.node.stopAllActions(),this.MoveNode.scale=e.Radius/window.GGameEntry.JoystickConfig.DefaultJoystickRadius},setupPlayer:function(e){this.sprite=e,this.node.getComponentInChildren("JoystickBG")._playerNode=e},showEffectBtn:function(e){if(e.detail.guid===window.GGameEntry.PlayerManager.MainPlayerGuid){var t=e.detail.show;this.effectBtn.active=!!t}},checkFlashBuff:function(){window.GGameEntry&&window.GGameEntry.PlayerManager&&window.GGameEntry.PlayerManager.Player&&window.GGameEntry.PlayerManager.Player.BuffManager&&window.GGameEntry.PlayerManager.Player.BuffManager.getTopCacheBuffID()&&(this.effectBtn.active=!0)}}),cc._RF.pop()},{GlobalCfg:"GlobalCfg",JoystickBG:"JoystickBG",JoystickCommon:"JoystickCommon",JoystickSpawnCtrl:"JoystickSpawnCtrl"}],JsonUtils:[function(e,t,n){"use strict";cc._RF.push(t,"41a26ksBpJL8JMaIi2Rr2gb","JsonUtils"),t.exports={SafeParse:function(e){var t;try{t=JSON.parse(e)}catch(e){console.error("[JsonUtils.SafeParse] failed: %s.",e.message)}return t},SafeStringify:function(e){var t;try{t=JSON.stringify(e)}catch(e){console.error("[JsonUtils.SafeStringify] failed: %s.",e.message)}return t}},cc._RF.pop()},{}],KillMessageCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"5a71d8LybVJgaxxI122y5jS","KillMessageCtrl");var i=e("Util"),a=e("PlatformUtil");cc.Class({extends:cc.Component,properties:{killNode:{default:null,type:cc.Prefab},killNodeList:{default:null,visible:!1},killNodeHeight:{default:0,visible:!1,serializable:!1},isInited:{default:!1,visible:!1,serializable:!1}},fitiPhoneXScreen:function(){if(a.isTargetDevice("iPhone X")){var e=this.getComponent(cc.Widget);e&&(e.left=60,e.updateAlignment())}},onEnable:function(){this.fitiPhoneXScreen(),this.isInited=!1,window.GGameEntry.BattleSystem.GameReady&&this.preload(),window.GGameEntry.NotificationCenter.on("OnKillMessage",this.onKillMessage,this),window.GGameEntry.NotificationCenter.on("OnBattleMapReady",this.preload,this)},onKillMessage:function(e){var t=i.BeginSample("KillMessageCtrl::onKillMessage"),n=(Date.now(),e.detail),a=window.GGameEntry.EntityManager.getEntity(n.hitGuid).GetTankName(),o=window.GGameEntry.EntityManager.getEntity(n.dieGuid).GetTankName(),r=null,s=n.hitCampType==window.GGameEntry.PlayerManager.GetMyCamp();if(this.killNodeList)for(var l=0;l<this.killNodeList.length;l++)if(!this.killNodeList[l].isActive){r=this.killNodeList[l];break}r&&(Date.now(),r.isActive=!0,this.reOrderChildren(),r.init(a,o,s)),i.EndSample(t)},onDisable:function(){window.GGameEntry.NotificationCenter.off("OnKillMessage",this.onKillMessage,this),window.GGameEntry.NotificationCenter.off("OnBattleMapReady",this.itemInit,this),this.node.removeAllChildren(),this.killNodeList&&this.killNodeList.splice(0,this.killNodeList.length)},preload:function(){if(!this.isInited){this.isInited=!0,this.killNodeList=[];var e=window.GGameEntry.PlayerManager.GetPlayerNames();if(a.isTargetPlatform(2))for(var t=0;t<e.length;t++)e[t]=e[t].replace(/\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]/g,"");for(var n=0;n<8;n++){var i=cc.instantiate(this.killNode);this.node.addChild(i),this.node.active=!0,i.setPosition(cc.p(1e4,1e4));var o=i.getComponent("KillNodeCtrl");o&&(o.preLoad(e),this.killNodeList.push(o)),0==this.killNodeHeight&&(this.killNodeHeight=this.node.height)}}},returnChild:function(e){e.isActive&&(e.isActive=!1),e.node.setPosition(cc.p(1e4,1e4)),this.reOrderChildren()},reOrderChildren:function(){for(var e=0,t=0;t<this.killNodeList.length;t++)this.killNodeList[t].isActive&&(this.killNodeList[t].node.setPosition(cc.p(0,e)),e-=this.killNodeHeight+8)}}),cc._RF.pop()},{PlatformUtil:"PlatformUtil",Util:"Util"}],KillNodeCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"0bcddrmPGZKspG82i0ormtG","KillNodeCtrl");var i=e("Util"),a=e("PlatformUtil");cc.Class({extends:cc.Component,properties:{centerBullet:{default:null,type:cc.Node},countTime:{default:0},bgSprite:{default:null,type:cc.Sprite},bgSpriteList:{type:cc.SpriteFrame,default:[]},isActive:{default:!1,visible:!1},playerNameLabelList:{default:[],type:cc.Label},leftNamePosition:{default:cc.p(10,0)}},preLoad:function(e){if(e)for(t=0;t<e.length&&t<this.playerNameLabelList.length;t++)this.playerNameLabelList[t].string=e[t];for(var t=0;t<this.playerNameLabelList.length;t++)this.playerNameLabelList[t].node.setPosition(cc.p(1e4,1e4))},init:function(e,t,n){var o=i.BeginSample("KillNodeCtrl::init");a.isTargetPlatform(2)&&(e=e.replace(/\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]/g,""),t=t.replace(/\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]/g,""));Date.now();var r=this.setNameLabel(e,this.leftNamePosition);r&&this.centerBullet.setPosition(cc.p(r.node.position.x+r.node.width+16,this.centerBullet.position.y));var s=cc.p(this.centerBullet.position.x+this.centerBullet.width+10,0),l=this.setNameLabel(t,s),c=100;l&&(c=Math.abs(l.node.position.x+l.node.width+10)),this.node.width=c,this.bgSprite.spriteFrame=n?this.bgSpriteList[0]:this.bgSpriteList[1],this.countTime=0,i.EndSample(o)},setNameLabel:function(e,t){for(var n=0;n<this.playerNameLabelList.length;n++){var i=this.playerNameLabelList[n];if(i.string==e&&1e4==i.node.position.x&&1e4==i.node.position.y)return i.node.setPosition(t),i}},removeFromParent:function(){var e=i.BeginSample("KillNodeCtrl::removeFromParent");this.countTime=-1;for(var t=this.node.parent.getComponent("KillMessageCtrl"),n=0;n<this.playerNameLabelList.length;n++){var a=this.playerNameLabelList[n];a.position!=cc.p(1e4,1e4)&&a.node.setPosition(cc.p(1e4,1e4))}t?t.returnChild(this):this.node.parent.removeChild(this.node),i.EndSample(e)},update:function(e){this.countTime<0||(this.countTime>2?this.removeFromParent():this.countTime+=e)}}),cc._RF.pop()},{PlatformUtil:"PlatformUtil",Util:"Util"}],LRandomSelector:[function(e,t,n){"use strict";cc._RF.push(t,"0a754pm8sdKS5B0y1oVctDt","LRandomSelector");e("TaskStatus");var i=e("BevComposite");cc.Class({name:"LRandomSelector",extends:i,properties:{randomPrecent:{default:[],type:[cc.Integer],serializable:!1,visible:!1}},excuted:!1,OnStart:function(){this.excuted=!1},GetChildrenIndex:function(){return 0==this.excuted?this.PercentRandom(this.randomPrecent):-1},OnChildrenExcuted:function(e){this.excuted=!0},PercentRandom:function(e){if(null==e)return-1;if(0==e.length)return 0==this.Children.length?-1:cc.rand()%this.Children.length;this.sum=0,e.forEach(function(e){this.sum+=e},this);var t=cc.random0To1()*this.sum,n=0;for(n=0;n<e.length;++n){if(t<=e[n])return n;t-=e[n]}return-1}}),cc._RF.pop()},{BevComposite:"BevComposite",TaskStatus:"TaskStatus"}],LevelCfg:[function(e,t,n){"use strict";cc._RF.push(t,"556fajg3blKs40NguEP/Dvm","LevelCfg");var i=cc.Enum({None:0,Normal:1,Gold:2,Hunt:3}),a=[{LevelType:i.Normal,LevelID:100001,NormalMonsterCount:0,HunterCount:0,TeleporterCount:1,MonsterSpeed:120,MonsterGiveUpTime:1500,MonsterRebornTime:5500,GoldCount:0,LightningBufCount:4,LevelTime:6e4},{LevelType:i.Normal,LevelID:100002,NormalMonsterCount:0,HunterCount:0,TeleporterCount:1,MonsterSpeed:125,MonsterGiveUpTime:1600,MonsterRebornTime:5400,GoldCount:0,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100003,NormalMonsterCount:4,HunterCount:0,TeleporterCount:1,MonsterSpeed:130,MonsterGiveUpTime:1700,MonsterRebornTime:5300,GoldCount:1215,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100004,NormalMonsterCount:4,HunterCount:0,TeleporterCount:2,MonsterSpeed:135,MonsterGiveUpTime:1800,MonsterRebornTime:5200,GoldCount:1255,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100005,NormalMonsterCount:4,HunterCount:0,TeleporterCount:2,MonsterSpeed:140,MonsterGiveUpTime:1900,MonsterRebornTime:5100,GoldCount:1330,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100006,NormalMonsterCount:5,HunterCount:0,TeleporterCount:2,MonsterSpeed:145,MonsterGiveUpTime:2e3,MonsterRebornTime:5e3,GoldCount:1370,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100007,NormalMonsterCount:5,HunterCount:0,TeleporterCount:2,MonsterSpeed:150,MonsterGiveUpTime:2100,MonsterRebornTime:4900,GoldCount:1445,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100008,NormalMonsterCount:5,HunterCount:0,TeleporterCount:2,MonsterSpeed:150,MonsterGiveUpTime:2200,MonsterRebornTime:4800,GoldCount:1485,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100009,NormalMonsterCount:6,HunterCount:0,TeleporterCount:2,MonsterSpeed:155,MonsterGiveUpTime:2300,MonsterRebornTime:4700,GoldCount:1560,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100010,NormalMonsterCount:6,HunterCount:0,TeleporterCount:2,MonsterSpeed:155,MonsterGiveUpTime:2400,MonsterRebornTime:4600,GoldCount:1600,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100011,NormalMonsterCount:6,HunterCount:0,TeleporterCount:2,MonsterSpeed:160,MonsterGiveUpTime:2500,MonsterRebornTime:4500,GoldCount:1675,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100012,NormalMonsterCount:7,HunterCount:0,TeleporterCount:2,MonsterSpeed:160,MonsterGiveUpTime:2600,MonsterRebornTime:4400,GoldCount:1715,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100013,NormalMonsterCount:7,HunterCount:0,TeleporterCount:2,MonsterSpeed:165,MonsterGiveUpTime:2700,MonsterRebornTime:4300,GoldCount:1790,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100014,NormalMonsterCount:7,HunterCount:0,TeleporterCount:2,MonsterSpeed:165,MonsterGiveUpTime:2800,MonsterRebornTime:4200,GoldCount:1830,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100015,NormalMonsterCount:8,HunterCount:0,TeleporterCount:2,MonsterSpeed:170,MonsterGiveUpTime:2900,MonsterRebornTime:4100,GoldCount:1905,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100016,NormalMonsterCount:8,HunterCount:0,TeleporterCount:2,MonsterSpeed:170,MonsterGiveUpTime:3e3,MonsterRebornTime:4e3,GoldCount:1945,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100017,NormalMonsterCount:8,HunterCount:0,TeleporterCount:2,MonsterSpeed:175,MonsterGiveUpTime:3100,MonsterRebornTime:3900,GoldCount:2020,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100018,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:175,MonsterGiveUpTime:3200,MonsterRebornTime:3800,GoldCount:2060,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100019,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:180,MonsterGiveUpTime:3300,MonsterRebornTime:3700,GoldCount:2135,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100020,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:180,MonsterGiveUpTime:3400,MonsterRebornTime:3600,GoldCount:2175,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100021,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:185,MonsterGiveUpTime:3500,MonsterRebornTime:3500,GoldCount:2250,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100022,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:185,MonsterGiveUpTime:3600,MonsterRebornTime:3400,GoldCount:2290,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100023,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:190,MonsterGiveUpTime:3700,MonsterRebornTime:3300,GoldCount:2365,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100024,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:190,MonsterGiveUpTime:3800,MonsterRebornTime:3200,GoldCount:2405,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100025,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:195,MonsterGiveUpTime:3900,MonsterRebornTime:3100,GoldCount:2480,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100026,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:195,MonsterGiveUpTime:4e3,MonsterRebornTime:3e3,GoldCount:2520,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100027,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:200,MonsterGiveUpTime:4100,MonsterRebornTime:2900,GoldCount:2595,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100028,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:200,MonsterGiveUpTime:4200,MonsterRebornTime:2800,GoldCount:2635,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100029,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:205,MonsterGiveUpTime:4300,MonsterRebornTime:2700,GoldCount:2710,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100030,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:205,MonsterGiveUpTime:4400,MonsterRebornTime:2600,GoldCount:2750,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100031,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:210,MonsterGiveUpTime:4500,MonsterRebornTime:2500,GoldCount:2825,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100032,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:210,MonsterGiveUpTime:4600,MonsterRebornTime:2400,GoldCount:2865,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100033,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:215,MonsterGiveUpTime:4700,MonsterRebornTime:2300,GoldCount:2940,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100034,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:215,MonsterGiveUpTime:4800,MonsterRebornTime:2200,GoldCount:2980,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100035,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:220,MonsterGiveUpTime:4900,MonsterRebornTime:2100,GoldCount:3055,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100036,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:220,MonsterGiveUpTime:5e3,MonsterRebornTime:2e3,GoldCount:3095,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100037,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:225,MonsterGiveUpTime:5100,MonsterRebornTime:1900,GoldCount:3170,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100038,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:225,MonsterGiveUpTime:5200,MonsterRebornTime:1800,GoldCount:3210,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100039,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:225,MonsterGiveUpTime:5300,MonsterRebornTime:1700,GoldCount:3285,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100040,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:225,MonsterGiveUpTime:5400,MonsterRebornTime:1600,GoldCount:3325,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100041,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:225,MonsterGiveUpTime:5500,MonsterRebornTime:1500,GoldCount:3400,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100042,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:225,MonsterGiveUpTime:5600,MonsterRebornTime:1400,GoldCount:3440,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100043,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:225,MonsterGiveUpTime:5700,MonsterRebornTime:1300,GoldCount:3515,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100044,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:225,MonsterGiveUpTime:5800,MonsterRebornTime:1200,GoldCount:3555,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100045,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:225,MonsterGiveUpTime:5900,MonsterRebornTime:1100,GoldCount:3630,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100046,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:225,MonsterGiveUpTime:6e3,MonsterRebornTime:1e3,GoldCount:3670,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100047,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:225,MonsterGiveUpTime:6100,MonsterRebornTime:900,GoldCount:3745,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100048,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:225,MonsterGiveUpTime:6200,MonsterRebornTime:800,GoldCount:3785,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100049,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:225,MonsterGiveUpTime:6300,MonsterRebornTime:700,GoldCount:3860,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Normal,LevelID:100050,NormalMonsterCount:9,HunterCount:0,TeleporterCount:2,MonsterSpeed:225,MonsterGiveUpTime:6400,MonsterRebornTime:600,GoldCount:3900,LightningBufCount:3,LevelTime:6e4},{LevelType:i.Gold,LevelID:200002,NormalMonsterCount:0,HunterCount:0,TeleporterCount:1,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:9500,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200004,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:9600,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200006,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:9700,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200008,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:9800,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200010,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:9900,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200012,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:1e4,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200014,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:10100,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200016,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:10200,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200018,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:10300,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200020,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:10400,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200022,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:10500,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200024,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:10600,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200026,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:10700,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200028,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:10800,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200030,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:10900,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200032,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:11e3,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200034,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:11100,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200036,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:11200,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200038,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:11300,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200040,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:11400,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200042,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:11500,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200044,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:11600,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200046,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:11700,LightningBufCount:0,LevelTime:1e4},{LevelType:i.Gold,LevelID:200048,NormalMonsterCount:0,HunterCount:0,TeleporterCount:2,MonsterSpeed:0,MonsterGiveUpTime:0,MonsterRebornTime:0,GoldCount:11800,LightningBufCount:0,LevelTime:1e4}],o=[{LevelIndex:1,Level:[{LevelID:100001,Random:1e3}]},{LevelIndex:2,Level:[{LevelID:100002,Random:500},{LevelID:200002,Random:500}]},{LevelIndex:3,Level:[{LevelID:100003,Random:1e3}]},{LevelIndex:4,Level:[{LevelID:100004,Random:500},{LevelID:200004,Random:500}]},{LevelIndex:5,Level:[{LevelID:100005,Random:1e3}]},{LevelIndex:6,Level:[{LevelID:100006,Random:500},{LevelID:200006,Random:500}]},{LevelIndex:7,Level:[{LevelID:100007,Random:1e3}]},{LevelIndex:8,Level:[{LevelID:100008,Random:500},{LevelID:200008,Random:500}]},{LevelIndex:9,Level:[{LevelID:100009,Random:1e3}]},{LevelIndex:10,Level:[{LevelID:100010,Random:500},{LevelID:200010,Random:500}]},{LevelIndex:11,Level:[{LevelID:100011,Random:1e3}]},{LevelIndex:12,Level:[{LevelID:100012,Random:500},{LevelID:200012,Random:500}]},{LevelIndex:13,Level:[{LevelID:100013,Random:1e3}]},{LevelIndex:14,Level:[{LevelID:100014,Random:500},{LevelID:200014,Random:500}]},{LevelIndex:15,Level:[{LevelID:100015,Random:1e3}]},{LevelIndex:16,Level:[{LevelID:100016,Random:500},{LevelID:200016,Random:500}]},{LevelIndex:17,Level:[{LevelID:100017,Random:1e3}]},{LevelIndex:18,Level:[{LevelID:100018,Random:500},{LevelID:200018,Random:500}]},{LevelIndex:19,Level:[{LevelID:100019,Random:1e3}]},{LevelIndex:20,Level:[{LevelID:100020,Random:500},{LevelID:200020,Random:500}]},{LevelIndex:21,Level:[{LevelID:100021,Random:1e3}]},{LevelIndex:22,Level:[{LevelID:100022,Random:500},{LevelID:200022,Random:500}]},{LevelIndex:23,Level:[{LevelID:100023,Random:1e3}]},{LevelIndex:24,Level:[{LevelID:100024,Random:500},{LevelID:200024,Random:500}]},{LevelIndex:25,Level:[{LevelID:100025,Random:1e3}]},{LevelIndex:26,Level:[{LevelID:100026,Random:500},{LevelID:200026,Random:500}]},{LevelIndex:27,Level:[{LevelID:100027,Random:1e3}]},{LevelIndex:28,Level:[{LevelID:100028,Random:500},{LevelID:200028,Random:500}]},{LevelIndex:29,Level:[{LevelID:100029,Random:1e3}]},{LevelIndex:30,Level:[{LevelID:100030,Random:500},{LevelID:200030,Random:500}]},{LevelIndex:31,Level:[{LevelID:100031,Random:1e3}]},{LevelIndex:32,Level:[{LevelID:100032,Random:500},{LevelID:200032,Random:500}]},{LevelIndex:33,Level:[{LevelID:100033,Random:1e3}]},{LevelIndex:34,Level:[{LevelID:100034,Random:500},{LevelID:200034,Random:500}]},{LevelIndex:35,Level:[{LevelID:100035,Random:1e3}]},{LevelIndex:36,Level:[{LevelID:100036,Random:500},{LevelID:200036,Random:500}]},{LevelIndex:37,Level:[{LevelID:100037,Random:1e3}]},{LevelIndex:38,Level:[{LevelID:100038,Random:500},{LevelID:200038,Random:500}]},{LevelIndex:39,Level:[{LevelID:100039,Random:1e3}]},{LevelIndex:40,Level:[{LevelID:100040,Random:500},{LevelID:200040,Random:500}]},{LevelIndex:41,Level:[{LevelID:100041,Random:1e3}]},{LevelIndex:42,Level:[{LevelID:100042,Random:500},{LevelID:200042,Random:500}]},{LevelIndex:43,Level:[{LevelID:100043,Random:1e3}]},{LevelIndex:44,Level:[{LevelID:100044,Random:500},{LevelID:200044,Random:500}]},{LevelIndex:45,Level:[{LevelID:100045,Random:1e3}]},{LevelIndex:46,Level:[{LevelID:100046,Random:500},{LevelID:200046,Random:500}]},{LevelIndex:47,Level:[{LevelID:100047,Random:1e3}]},{LevelIndex:48,Level:[{LevelID:100048,Random:500},{LevelID:200048,Random:500}]},{LevelIndex:49,Level:[{LevelID:100049,Random:1e3}]},{LevelIndex:50,Level:[{LevelID:100050,Random:1e3}]}];t.exports={LevelType:i,LevelDataCfg:a,RandomLevelCfg:o},cc._RF.pop()},{}],LevelManager:[function(e,t,n){"use strict";cc._RF.push(t,"2baa6kSIQNKI65jHvHCrg5w","LevelManager");var i=e("LevelCfg"),a=i.LevelType,o=i.LevelDataCfg,r=i.RandomLevelCfg;cc.Class({extends:cc.Component,properties:{CurLevelIndex:{default:1,serializable:!1,visible:!1},CurSubLevelIndex:{default:1,serializable:!1,visible:!1},CurLevelIDArray:{default:null,serializable:!1,visible:!1},CachedCurLevelData:{default:null,serializable:!1,visible:!1}},Init:function(){this.CurLevelIndex=0,this.CurSubLevelIndex=0,this.CurLevelIDArray=null,this.CachedCurLevelData=null},Release:function(){this.CurLevelIDArray=null,this.CachedCurLevelData=nul},ResetLevel:function(){this.CurLevelIndex=0,this.CachedCurLevelData=null},CreateNextLevel:function(){if(this.CachedCurLevelData=null,0===this.CurLevelIndex)this.CurLevelIndex=1,this.CurSubLevelIndex=0,this.CurLevelIDArray=[],this.CreateCurLevelIDArray();else if(this.CurSubLevelIndex<this.CurLevelIDArray.length-1)this.CurSubLevelIndex++;else{for(var e=!1,t=0;t<r.length;t++)if(r[t].LevelIndex>this.CurLevelIndex){e=!0,this.CurLevelIndex++,this.CurSubLevelIndex=0,this.CurLevelIDArray=[],this.CreateCurLevelIDArray();break}if(!e)return!1}return this.CachedCurLevelData=this.GetCurLevelData(),!0},CreateCurLevelIDArray:function(){for(var e=null,t=0;t<r.length;t++)if(r[t].LevelIndex===this.CurLevelIndex){e=r[t].Level;break}if(null!==e&&0!==e.length)if(1!==e.length){for(var n=Math.floor(1e3*Math.random()),t=0;t<e.length;t++){if(e[t].Random>=n){this.CurLevelIDArray[this.CurLevelIDArray.length]=e[t].LevelID;break}n-=e[t].Random}if(0!==this.CurLevelIDArray.length){var i=this.FindLevelDataByID(this.CurLevelIDArray[this.CurLevelIDArray.length-1]);if(null!==i){if(i.LevelType!=a.Normal)for(t=0;t<e.length;t++){var o=this.FindLevelDataByID(e[t].LevelID);if(null!=o&&o.LevelType===a.Normal){this.CurLevelIDArray[this.CurLevelIDArray.length]=e[t].LevelID;break}}}else cc.error("cant find level data:id=%d",this.CurLevelIDArray[this.CurLevelIDArray.length-1])}else cc.error("gen level data error")}else this.CurLevelIDArray[this.CurLevelIDArray.length]=e[0].LevelID;else cc.error("RandomLevelCfg Level data is null:%d",this.CurLevelIndex)},FindLevelDataByID:function(e){for(var t=0;t<o.length;t++)if(o[t].LevelID===e)return o[t]},GetCurLevelData:function(){return this.FindLevelDataByID(this.CurLevelIDArray[this.CurSubLevelIndex])},IsLastSubLevel:function(){return this.CurSubLevelIndex<this.CurLevelIDArray.length-1},HasMoreLevel:function(){for(var e=0;e<r.length;e++)if(r[e].LevelIndex>this.CurLevelIndex)return!0;return!1},CheckGameState:function(){return}}),cc._RF.pop()},{LevelCfg:"LevelCfg"}],LevelTransitionUI:[function(e,t,n){"use strict";cc._RF.push(t,"80be5B5e7NHyIF/rtj23Y7d","LevelTransitionUI");e("Util");var i=e("UIManager");cc.Class({extends:cc.Component,properties:{Ani:{default:null,type:cc.Animation,serializable:!0}},onEnable:function(){this.Ani.play("LevelTransition1"),window.GGameEntry.NotificationCenter.emit("LevelTransitionStart")},onDisable:function(){},MoveNextLevel:function(){window.GGameEntry.MoveNextLevel()},HideMe:function(){window.GGameEntry.NotificationCenter.emit("LevelTransitionEnd"),window.GGameEntry.UIManager.HideUI(i.UIType.LevelTransitionUI)}}),cc._RF.pop()},{UIManager:"UIManager",Util:"Util"}],LogoItemEff:[function(e,t,n){"use strict";cc._RF.push(t,"fb574WF1/1GR7r0wsUh/XYG","LogoItemEff"),cc.Class({extends:cc.Component,properties:{IconNode:{default:null,type:cc.Node},Animation:{default:null,type:cc.Animation},AnimationClipName:"",Animation2:{default:null,type:cc.Animation},Animation2ClipName:"",Animation3:{default:null,type:cc.Animation},Animation3ClipName:"",HideIconNodeTime:0,ShowAndPlayAnimationTime:0,ShowAndPlayAnimation2Time:0,ShowAndPlayAnimation3Time:0,HideMeTime:0},onLoad:function(){this.Tick=0,this.AnimationPlayed=!1,this.Animation2Played=!1,this.Animation3Played=!1,this.IconHide=!1},update:function(e){this.Tick+=e,this.Tick>this.HideMeTime&&(this.node.active=!1),null!=this.Animation&&!this.AnimationPlayed&&this.Tick>this.ShowAndPlayAnimationTime&&(this.Animation.node.active=!0,this.Animation.playAdditive(this.AnimationClipName),this.AnimationPlayed=!0),null!=this.Animation2&&!this.Animation2Played&&this.Tick>this.ShowAndPlayAnimation2Time&&(this.Animation2.node.active=!0,this.Animation2.playAdditive(this.Animation2ClipName),this.Animation2Played=!0),null!=this.Animation3&&!this.Animation3Played&&this.Tick>this.ShowAndPlayAnimation3Time&&(this.Animation3.node.active=!0,this.Animation3.playAdditive(this.Animation3ClipName),this.Animation3Played=!0),!this.IconHide&&null!=this.IconNode&&this.Tick>this.HideIconNodeTime&&(this.IconNode.active=!1,this.IconHide=!0)}}),cc._RF.pop()},{}],LogoUI:[function(e,t,n){"use strict";cc._RF.push(t,"35e6aCahn9E0KWwnBmcvZLZ","LogoUI");e("Util");var i=e("PlatformUtil"),a=(e("JsonUtils"),e("UIManager")),o=e("star_macro"),r=e("loginServerMgr"),s=e("weixininterface"),l=(e("MsgUtil"),e("CmdStartLoadMap")),c=e("GlobalCfg"),u=e("star_cs"),d=e("loginConfig"),h=e("weixinmsgmgr"),f=e("MsgFinishLoadMap"),m=e("SimpleLabel"),y=e("ServerLog"),p=e("EnterStateMgr"),g=e("GameMode"),C=e("ActivityMsgMgr"),G=e("loginComNotifyMsg"),S=e("ResTableNames"),E=e("star_table"),T=new cc.Color(0,0,0),w=new cc.Color(99,25,25),M=new cc.Color(255,255,255);cc.Class({extends:cc.Component,properties:{startBtn:{default:null,type:cc.Button},startPVPBtn:{default:null,type:cc.Button},loadingNode:{default:null,type:cc.Node},loadingProcess:{default:null,type:cc.ProgressBar},startGame:{default:!1,visible:!1},sendStartGameMsg:{default:!1,visible:!1},PCEditNode:{default:null,type:cc.Node},PCEditBox:{default:null,type:cc.EditBox},BtnPCLogin:{default:null,type:cc.Button},BtnPCClear:{default:null,type:cc.Button},BtnCreateRoom:{default:null,type:cc.Button},BtnJoinRoom:{default:null,type:cc.Button},BtnServer:{default:null,type:cc.Button},PCRoomNoNode:{default:null,type:cc.Node},PCRoomNoEditBox:{default:null,type:cc.EditBox},LogoMusicPlaying:{default:!1,visible:!1},PCUserNoNode:{default:null,type:cc.Node},PCUserNoEditBox:{default:null,type:cc.EditBox},CreateRoomOr:{default:!1,visible:!1},AIResetBtn:{default:null,type:cc.Button},PCUseFixNumber:{default:!1,visible:!1},AISettingBtn:{default:null,type:cc.Button},GuideBtn:{default:null,type:cc.Button},DiamondLeftLabel:{default:null,type:m,serializable:!0},BlueBtnSpr:{default:null,type:cc.SpriteFrame},OrangeBtnSpr:{default:null,type:cc.SpriteFrame},GreyBtnSpr:{default:null,type:cc.SpriteFrame},IsLoginSuccess:{default:!1,typed:cc.Boolean},GuidBtn:{default:null,type:cc.Button},RecordBtn:{default:null,type:cc.Button},DiamondBtn:{default:null,type:cc.Button},IsFirstLoad:{default:!1,typed:cc.Boolean},QueryConfigTime:{default:!1,typed:cc.Integer},IsReceiveActivityMsg:{default:!1,typed:cc.Boolean},AutoJoinBtn:{default:null,type:cc.Button},ActivityBtn:{default:null,type:cc.Button},ShareBtn:{default:null,type:cc.Button},QRShareBtn:{default:null,type:cc.Button}},onLoad:function(){if(this.LogoMusicPlaying||(window.GGameEntry.SoundManager.PlayLogoBg(),this.LogoMusicPlaying=!0),this.IsFirstLoad=!0,this.QueryConfigTime=0,console.log("LogoUI has been loaded."),i.IsWeichatGame()||(window.GGameEntry.CurGamePlayType=c.GamePlayType.GamePlayType_None,this.autoLogin()),g.SetGameMode(g.GM.GameMode_Default),i.IsWeichatGame())if(this.EnablePVPBtn(!0),this.EnablePVEBtn(!0),this.EnableGuideBtn(!0),this.EnableAutoJoinBtn(!0),this.EnableActivityBtn(!0),this.checkUIBtn(),s.isInvitedToJoinRoom()){n=r.onGetInviteInfo();if(s.checkInviteIsOutOfDate(n)){console.log("LogoUI onLoad link is out of date.",n);var t=window.GGameEntry.ResTableMgr.GetConfigByID(S.star_client_c,53).Context;window.GGameEntry.UIManager.ShowMsgBox(t,201)}else window.GGameEntry.CurGamePlayType=c.GamePlayType.GamePlayType_Network,g.SetGameMode(g.GM.GameMode_PVPPlayer),this.OnPVPMakeTeadUI(),this.EnablePVEBtn(!1),this.EnablePVPBtn(!1),this.EnableGuideBtn(!1),this.EnableAutoJoinBtn(!1),this.EnableActivityBtn(!1);console.log("LogoUI is invited.")}else{var n=r.onGetInviteInfo();s.isViewRankInfo(n)&&(e("QunUserDataMgr").setShareUserData(n),s.onGetRankInfo(),console.log("LogoUI onGetRankInfo")),console.log("LogoUI is load.")}},onEnable:function(){this.LogoMusicPlaying||(window.GGameEntry.SoundManager.PlayLogoBg(),this.LogoMusicPlaying=!0);var e=Date.now();e-this.QueryConfigTime>18e4&&(this.QueryConfigTime=e,r.onQueryServerOnOFFConfig());var t=r.onGetInviteInfo(),n=s.isViewRankInfo(t);!i.IsWeichatGame()||s.isInvitedToJoinRoom()||n||(window.GGameEntry.CurGamePlayType=c.GamePlayType.GamePlayType_None),s.isInvitedToJoinRoom()||g.SetGameMode(g.GM.GameMode_Default),r.onSetUserInfoFailed(r.globalSessionState.sessionState_Default),i.setBtnCheckEnter(0),this.CreateRoomOr=!1,s.isInvitedToJoinRoom()||n?(this.EnablePVPBtn(!1),this.EnablePVEBtn(!1),this.EnableGuideBtn(!1),this.EnableAutoJoinBtn(!1),this.EnableActivityBtn(!1),this.checkUIBtn(),this.RecordBtn.interactable=!1,this.DiamondBtn.interactable=!1,this.ShareBtn.interactable=!1,this.QRShareBtn.interactable=!1):(this.EnablePVPBtn(!0),this.EnablePVEBtn(!0),this.EnableGuideBtn(!0),this.EnableAutoJoinBtn(!0),this.EnableActivityBtn(!0),this.checkUIBtn(),this.RecordBtn.interactable=!0,this.DiamondBtn.interactable=!0,this.ShareBtn.interactable=!0,this.QRShareBtn.interactable=!0),this.loadingNode.active=!1,this.startGame=!1,this.sendStartGameMsg=!1,this.loadingProcess.progress=0,this.IsFirstLoad||window.GGameEntry.GBattleNetwork.Disconnect(),this.IsFirstLoad=!1,r.onSetRoomGuid("0");this.node.getComponentInChildren(cc.Sprite);i.IsDebugMode()||(this.BtnPCClear.node.active=!1,this.BtnPCLogin.node.active=!1,this.BtnCreateRoom.node.active=!1,this.BtnJoinRoom.node.active=!1),this.BtnServer.node.active=!0,i.IsWeichatGame()&&!0===GameSettingConfig.Public&&(this.BtnServer.node.active=!1),window.GGameEntry.NotificationCenter.on("CreateRoomEvent",this.CreateRoomEvent,this),window.GGameEntry.NotificationCenter.on("LoginSuccessEvent",this.LoginSuccessEvent,this),window.GGameEntry.NotificationCenter.on("PlayerReady",this.PlayerReady,this),window.GGameEntry.NotificationCenter.on("OnReceivePlayerRole",this.OnReceivePlayerRole,this),window.GGameEntry.NotificationCenter.on("onRecvBattleError",this.onRecvBattleError,this),window.GGameEntry.NotificationCenter.on("onChangeBtnState",this.onChangeBtnState,this),window.GGameEntry.NotificationCenter.on("onEnterRoomByInvite",this.onEnterRoomByInvite,this),window.GGameEntry.NotificationCenter.on("CancelNetQueue",this.onCancelNetQueue,this),window.GGameEntry.NotificationCenter.on("onReceiveActivityMsgNotify",this.onReceiveActivityMsgNotify,this),window.GGameEntry.NotificationCenter.on("GetGameRecordSuccess",this.GetGameRecordSuccess,this),window.GGameEntry.NotificationCenter.on("onRoleBaseInfoNotify",this.onRoleBaseInfoNotify,this),i.IsDebugMode()&&null===this.PCEditNode&&(this.PCEditNode=new cc.Node,this.PCEditBox=this.PCEditNode.addComponent(cc.EditBox),this.PCEditNode.parent=this.node,this.PCEditNode.setPosition(300,-350),this.PCEditNode.setScale(.5),this.PCEditNode.setContentSize(450,40),this.PCEditBox.fontColor=cc.Color.RED,this.PCEditBox.string="输入登录号",this.PCEditBox.fontSize=29,this.PCEditBox.lineHeight=40,this.PCEditBox.maxLength=200,this.PCRoomNoNode=new cc.Node,this.PCRoomNoEditBox=this.PCRoomNoNode.addComponent(cc.EditBox),this.PCRoomNoNode.parent=this.node,this.PCRoomNoNode.setPosition(401,-350),this.PCRoomNoNode.setScale(.5),this.PCRoomNoNode.setContentSize(250,40),this.PCRoomNoEditBox.fontColor=cc.Color.RED,this.PCRoomNoEditBox.string="输入房间号",this.PCRoomNoEditBox.fontSize=29,this.PCRoomNoEditBox.lineHeight=40,this.PCRoomNoEditBox.maxLength=50,this.PCUserNoNode=new cc.Node,this.PCUserNoEditBox=this.PCUserNoNode.addComponent(cc.EditBox),this.PCUserNoNode.parent=this.node,this.PCUserNoNode.setPosition(-100,-350),this.PCUserNoNode.setScale(.5),this.PCUserNoNode.setContentSize(400,40),this.PCUserNoEditBox.fontColor=cc.Color.RED,this.PCUserNoEditBox.string=window.localStorage.getItem("uuid"),this.PCUserNoEditBox.fontSize=29,this.PCUserNoEditBox.lineHeight=40,this.PCUserNoEditBox.maxLength=100),this.AIResetBtn&&(this.AIResetBtn.node.active=!1),this.AISettingBtn&&(this.AISettingBtn.node.active=!1),this.GuideBtn&&this.GuideBtn.node.active&&(this.GuideBtn.node.on("click",this.OnGuideBtn,this),this.GuideBtn.interactable=!0),window.GGameEntry.NotificationCenter.emit("LogoUiInitOver"),this.DiamondLeftLabel.SetString("0"),this.checkUIBtn();var a=i.isTargetPlatform(1),o=i.isTargetPlatform(2),l=d.getPayFlag(1),u=d.getPayFlag(2);this.DiamondBtn.node.active=!!(a&&l||o&&u),this.QRShareBtn.node.on(cc.Node.EventType.TOUCH_START,this.OnQRShareBtnClick,this)},checkUIBtn:function(){if(console.log("chekcUIBtn"),window.GGameEntry.CheckHasDoneGuide()){this.startPVPBtn.node.active=!0,this.startBtn.node.active=!0,this.AutoJoinBtn.node.active=!1,this.ActivityBtn.node.active=!1,this.GuidBtn.node.active=!1;var e=p.getEnterStateShowAutoPVP();this.AutoJoinBtn.node.active=!!e;var t=p.getEnterStateShowActivity();this.ActivityBtn.node.active=t}else this.startPVPBtn.node.active=!1,this.startBtn.node.active=!1,this.AutoJoinBtn.node.active=!1,this.ActivityBtn.node.active=!1,this.GuidBtn.node.active=!0;window.GGameEntry.LogoUIShareShow?(this.ShareBtn.node.active=!0,this.QRShareBtn.node.active=!0):(this.ShareBtn.node.active=!1,this.QRShareBtn.node.active=!1)},EnableBtnScaler:function(e,t){var n=t.node.getComponent("ButtonScaler");n&&(n.enabled=!!e)},EnablePVPBtn:function(e){e?(this.startPVPBtn.interactable=!0,this.startPVPBtn.getComponent(cc.Sprite).spriteFrame=this.OrangeBtnSpr,this.startPVPBtn.getComponentInChildren(cc.Label).node.color=w,this.startPVPBtn.node.active=!0):(this.startPVPBtn.interactable=!1,this.startPVPBtn.getComponent(cc.Sprite).spriteFrame=this.GreyBtnSpr,this.startPVPBtn.getComponentInChildren(cc.Label).node.color=T,this.startPVPBtn.node.active=!1),this.EnableBtnScaler(e,this.startPVPBtn)},EnableAutoJoinBtn:function(e){var t=this.AutoJoinBtn.node.getChildByName("childNode");e?(this.AutoJoinBtn.interactable=!0,this.AutoJoinBtn.getComponent(cc.Sprite).spriteFrame=this.OrangeBtnSpr,this.AutoJoinBtn.getComponentInChildren(cc.Label).node.color=w,this.AutoJoinBtn.getComponentInChildren(cc.Label).string="快速游戏",this.AutoJoinBtn.node.active=!0,t&&(t.active=!0)):(this.AutoJoinBtn.interactable=!1,this.AutoJoinBtn.getComponent(cc.Sprite).spriteFrame=this.GreyBtnSpr,this.AutoJoinBtn.getComponentInChildren(cc.Label).node.color=T,this.AutoJoinBtn.node.active=!1,t&&(t.active=!1)),this.EnableBtnScaler(e,this.AutoJoinBtn)},EnableActivityBtn:function(e){e?(this.ActivityBtn.interactable=!0,this.ActivityBtn.getComponent(cc.Sprite).spriteFrame=this.OrangeBtnSpr,this.ActivityBtn.getComponentInChildren(cc.Label).node.color=w,this.ActivityBtn.node.active=!0):(this.ActivityBtn.interactable=!1,this.ActivityBtn.getComponent(cc.Sprite).spriteFrame=this.GreyBtnSpr,this.ActivityBtn.getComponentInChildren(cc.Label).node.color=T,this.ActivityBtn.node.active=!1),this.EnableBtnScaler(e,this.ActivityBtn)},EnablePVEBtn:function(e){e?(this.startBtn.interactable=!0,this.startBtn.getComponent(cc.Sprite).spriteFrame=this.BlueBtnSpr,this.startBtn.getComponentInChildren(cc.Label).node.color=M,this.startBtn.node.active=!0):(this.startBtn.interactable=!1,this.startBtn.getComponent(cc.Sprite).spriteFrame=this.GreyBtnSpr,this.startBtn.getComponentInChildren(cc.Label).node.color=T,this.startBtn.node.active=!1),this.EnableBtnScaler(e,this.startBtn)},EnableGuideBtn:function(e){e?(this.GuidBtn.interactable=!0,this.GuidBtn.getComponent(cc.Sprite).spriteFrame=this.BlueBtnSpr,this.GuidBtn.node.active=!0):(this.GuidBtn.interactable=!1,this.GuidBtn.getComponent(cc.Sprite).spriteFrame=this.GreyBtnSpr,this.GuidBtn.node.active=!1),this.EnableBtnScaler(e,this.GuidBtn)},onDisable:function(){window.GGameEntry.NotificationCenter.off("CreateRoomEvent",this.CreateRoomEvent,this),window.GGameEntry.NotificationCenter.off("LoginSuccessEvent",this.LoginSuccessEvent,this),window.GGameEntry.NotificationCenter.off("PlayerReady",this.PlayerReady,this),window.GGameEntry.NotificationCenter.off("OnReceivePlayerRole",this.OnReceivePlayerRole,this),window.GGameEntry.NotificationCenter.off("onRecvBattleError",this.onRecvBattleError,this),window.GGameEntry.NotificationCenter.off("onChangeBtnState",this.onChangeBtnState,this),window.GGameEntry.NotificationCenter.off("onEnterRoomByInvite",this.onEnterRoomByInvite,this),window.GGameEntry.NotificationCenter.off("CancelNetQueue",this.onCancelNetQueue,this),window.GGameEntry.NotificationCenter.off("onReceiveActivityMsgNotify",this.onReceiveActivityMsgNotify,this),window.GGameEntry.NotificationCenter.off("GetGameRecordSuccess",this.GetGameRecordSuccess,this),window.GGameEntry.NotificationCenter.off("onRoleBaseInfoNotify",this.onRoleBaseInfoNotify,this),this.QRShareBtn.node.off(cc.Node.EventType.TOUCH_START,this.OnQRShareBtnClick,this),this.LogoMusicPlaying=!1,this.AIResetBtn&&this.AIResetBtn.node.off("click",this.OnResetAI,this),this.AISettingBtn&&this.AISettingBtn.node.off("click",this.OnAISetting,this)},EnableGameButtonOnTimeOut:function(){this.EnablePVPBtn(!0),this.EnablePVEBtn(!0),this.EnableAutoJoinBtn(!0),this.EnableActivityBtn(!0),this.checkUIBtn(),this.RecordBtn.interactable=!0,this.DiamondBtn.interactable=!0,this.ShareBtn.interactable=!0,this.QRShareBtn.interactable=!0},OnStartBtn:function(){if(y.pushLog("PVE Btn Click"),p.setEnterState(p.globalEnterStateFlag.EnterState_Single),this.IsLoginSuccess=!1,window.GGameEntry.CurGamePlayType=c.GamePlayType.GamePlayType_Single,g.SetGameMode(g.GM.GameMode_Single),i.IsWeichatGame()&&r.onPVEGameBegin(),this.EnablePVEBtn(!1),this.EnablePVPBtn(!1),this.EnableAutoJoinBtn(!1),this.EnableActivityBtn(!1),this.RecordBtn.interactable=!1,this.DiamondBtn.interactable=!1,this.ShareBtn.interactable=!1,this.QRShareBtn.interactable=!1,this.unschedule(this.EnableGameButtonOnTimeOut),this.scheduleOnce(this.EnableGameButtonOnTimeOut,15),window.GGameEntry.UIManager.HideUI(a.UIType.PVPMakeTeamUI),this.loadingNode.active=!0,this.processPercent=0,this.startGame=!0,this.sendStartGameMsg=!0,window.GGameEntry.SoundManager.StopBg(),C.setActivityType(u.ROOM_TYPE.ROOM_COMMON),window.GGameEntry.CheckHasDoneGuide()){if(window.GGameEntry.CurGamePlayType===c.GamePlayType.GamePlayType_Single){var e=new l;e.Init(),e.MapID=1,window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(e)}}else this.OnGuideBtn()},OnClearStorage:function(){window.localStorage.clear()},OnServerBtn:function(){window.GGameEntry.GMSystem.curCondition=E.GMConditionType.GM_CON_OUT_ROOM,window.GGameEntry.UIManager.ShowUI(a.UIType.GMPanel,a.UIOrder.Top+100)},LoginSuccessEvent:function(e){if(this.IsLoginSuccess=!0,this.DiamondBtn.interactable=!0,this.RecordBtn.interactable=!0,this.ShareBtn.interactable=!0,this.QRShareBtn.interactable=!0,G.LoginSuccessEvent(e),null!==this.PCEditBox&&null!==this.PCUserNoEditBox)if(this.PCEditBox.string="登录成功!",i.IsWeichatGame()){var t=window.localStorage.getItem("uuid");!0===this.PCUseFixNumber&&window.location.toString().indexOf("newone")>0&&(t="123412341234"),this.PCUserNoEditBox.string=t}else this.PCUserNoEditBox.string=h.getOpenID();console.log("LogoUI LoginSuccessEvent")},onRecvBattleError:function(e){if(h.onHideLoadingState(),this.EnableAllGameButtonOnTimeOut(),console.log("LogoUI onRecvBattleError"),null!==this.PCEditBox&&(this.PCEditBox.string="Err:"+e.detail.Error.toString()+"Msg: "+e.detail.Msg),e.detail.Error===o.RET_CODE.RET_CODE_INVALID_OP&&!i.IsWeichatGame()){var t=window.location.toString(),n=t.indexOf("?");t=t.substring(0,n-1),window.location=t}},CreateRoomEvent:function(e){null!==this.PCRoomNoEditBox&&(this.PCRoomNoEditBox.string=e.detail.RoomGuid),i.IsWeichatGame()||this.setRoomURLToBrowser(e.detail.RoomGuid)},onChangeBtnState:function(e){console.log("onChangeBtnState:"+e.detail.bShow),this.EnablePVPBtn(e.detail.bShow),this.EnablePVEBtn(e.detail.bShow),this.EnableAutoJoinBtn(e.detail.bShow),this.EnableActivityBtn(e.detail.bShow),this.EnableGuideBtn(e.detail.bShow),this.checkUIBtn(),e.detail.bShow?(this.RecordBtn.interactable=!0,this.DiamondBtn.interactable=!0,this.ShareBtn.interactable=!0,this.QRShareBtn.interactable=!0):(this.RecordBtn.interactable=!1,this.DiamondBtn.interactable=!1,this.ShareBtn.interactable=!1,this.QRShareBtn.interactable=!1)},onEnterRoomByInvite:function(e){console.log("onEnterRoomByInvite"),!0===e.detail.btnSure?(window.GGameEntry.CurGamePlayType=c.GamePlayType.GamePlayType_Network,g.SetGameMode(g.GM.GameMode_PVPPlayer),this.OnPVPMakeTeadUI(),i.setBtnCheckEnter(2),this.EnablePVEBtn(!1),this.EnablePVPBtn(!1),this.EnableGuideBtn(!1),this.EnableAutoJoinBtn(!1),this.EnableActivityBtn(!1)):(this.EnablePVEBtn(!0),this.EnablePVPBtn(!0),this.EnableGuideBtn(!0),this.EnableAutoJoinBtn(!0),this.EnableActivityBtn(!0)),this.checkUIBtn()},onRoleBaseInfoNotify:function(e){console.log("onRoleBaseInfoNotify");var t=e.detail.RoleBaseInfo,n=window.GGameEntry.CheckHasDoneGuide();if(t&&t.OnOffSet)for(var i=0;i<t.OnOffSet.Num;i++)t.OnOffSet.OnOffList[i].OnOffType===u.ON_OFF_TYPE.ON_OFF_TYPE_QUICK_GAME?0!==t.OnOffSet.OnOffList[i].OnOrOff?(this.AutoJoinBtn.node.active=n,p.setEnterStateShowAutoPVP(!0)):(this.AutoJoinBtn.node.active=!1,p.setEnterStateShowAutoPVP(!1)):t.OnOffSet.OnOffList[i].OnOffType===u.ON_OFF_TYPE.ON_OFF_TYPE_ACTIVITY_MODEL&&(0!==t.OnOffSet.OnOffList[i].OnOrOff?(this.ActivityBtn.node.active=n,p.setEnterStateShowActivity(!0)):(this.ActivityBtn.node.active=!1,p.setEnterStateShowActivity(!1)))},onReceiveActivityMsgNotify:function(e){console.log("onReceiveActivityMsgNotify"),h.onHideLoadingState(),this.IsReceiveActivityMsg=!0,window.GGameEntry.UIManager.HideUI(a.UIType.LogoUI),window.GGameEntry.UIManager.ShowUI(a.UIType.ActivityUI)},OnReceivePlayerRole:function(e){G.OnReceivePlayerRole(e)},PlayerReady:function(){null!==this.PCRoomNoEditBox&&(this.PCRoomNoEditBox.string="玩家已准备")},OnCreateRoom:function(){this.CreateRoomOr=!0,r.onCreateRoom(1,0)},OnJoinRoom:function(){var e=this.PCRoomNoEditBox.string;r.onJoinRoom(e,-1,-1)},OnPCBtn:function(){if(i.IsWeichatGame())s.onWXLogin();else{var e=this.PCEditBox.string;r.onLogin(e)}},OnPVPMakeTeadUI:function(){if(window.GGameEntry.IsNetAvailable){var e=cc.ServerConfig;if(e&&e.notice)window.GGameEntry.UIManager.ShowUI(a.UIType.RichMsgBoxUI,a.UIOrder.Top+100);else if(this.IsLoginSuccess=!1,C.setActivityType(u.ROOM_TYPE.ROOM_COMMON),p.setEnterState(p.globalEnterStateFlag.EnterState_PVP),window.GGameEntry.CurGamePlayType=c.GamePlayType.GamePlayType_Network,g.SetGameMode(g.GM.GameMode_PVPPlayer),this.EnablePVPBtn(!1),this.EnablePVEBtn(!1),this.EnableAutoJoinBtn(!1),this.EnableActivityBtn(!1),this.RecordBtn.interactable=!1,this.DiamondBtn.interactable=!1,this.ShareBtn.interactable=!1,this.QRShareBtn.interactable=!1,this.unschedule(this.EnableGameButtonOnTimeOut),this.scheduleOnce(this.EnableGameButtonOnTimeOut,15),i.setBtnCheckEnter(1),console.log("OnPVPMakeTeadUI"),y.pushLog("OnPVPMakeTeadUI"),i.IsWeichatGame()){if(window.GGameEntry.GBattleNetwork.IsConnected())window.GGameEntry.UIManager.HideUI(a.UIType.LogoUI),window.GGameEntry.UIManager.ShowUI(a.UIType.PVPMakeTeamUI);else if(!window.GGameEntry.GBattleNetwork.IsConnecting()){console.error("#OnPVPMakeTeadUI");t=window.GGameEntry.ResTableMgr.GetConfigByID(S.star_client_c,11).Context;h.onShowLoadingState("logining...",15e3,t,this.OnNetNotConnected,this),s.onWXLogin()}}else window.GGameEntry.GBattleNetwork.IsConnected()?(window.GGameEntry.UIManager.HideUI(a.UIType.LogoUI),window.GGameEntry.UIManager.ShowUI(a.UIType.PVPMakeTeamUI)):window.GGameEntry.GBattleNetwork.IsConnecting()||this.autoLogin()}else{var t=window.GGameEntry.ResTableMgr.GetConfigByID(S.star_client_c,54).Context;window.GGameEntry.UIManager.ShowMsgBox(t)}},update:function(e){this.startGame&&(this.processPercent+=.2,this.processPercent>1?window.GGameEntry.BattleSystem.BattleUIReady&&window.GGameEntry.BattleSystem.BattleMapReady&&this.sendStartGameMsg&&((new f).Send(),this.sendStartGameMsg=!1):this.loadingProcess.progress=this.processPercent);var t=r.onGetPlayerMoney().toString();this.DiamondLeftLabel.SetString(t)},OnResetAI:function(){window.GGameEntry.GameConfig.clearWinCount()},OnAISetting:function(){window.GGameEntry.UIManager.ShowUI(a.UIType.AISettingUI,a.UIOrder.Top)},setRoomURLToBrowser:function(e){var t=window.location.toString(),n=t.indexOf("roomid=");t=n>=0?t.substring(0,n)+"roomid="+e:window.location+"?roomid="+e,null!==this.PCEditBox&&(this.PCEditBox.string=t),window.localStorage.setItem("date",Date.now()),window.location=t},getRoomID:function(){return G.get_param("roomid")},IsPC:function(){for(var e=navigator.userAgent,t=new Array("Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"),n=!0,i=0;i<t.length;i++)if(e.indexOf(t[i])>0){n=!1;break}return n},autoLogin:function(){var e=window.localStorage.getItem("uuid");if(this.IsPC()&&!0!==this.PCUseFixNumber){var t=window.localStorage.getItem("date"),n=Date.now();console.log("autoLogin IsPC."+(n-t)),(1==(null===e)||Number(n-t)>4800)&&(e=d.getRandomNum(1,1e8),window.localStorage.setItem("uuid",e))}else console.log("autoLogin mobile."),null===e&&(e=d.getRandomNum(1,1e8),window.localStorage.setItem("uuid",e));var i=G.get_param("server");null!==i&&d.setConnectServer(i);var a=window.location.toString();if(a.indexOf("roomid=")>0&&(window.GGameEntry.CurGamePlayType=c.GamePlayType.GamePlayType_Network),!0===this.PCUseFixNumber){a.indexOf("newone")>0&&(e="123412341234");var n=Date.now(),t=window.localStorage.getItem("date");Number(n-t)<2800&&(a+="newone",window.history.pushState(null,null,a))}r.onLogin(e.toString())},OnGuideBtn:function(){this.EnableGuideBtn(!1),this.RecordBtn.interactable=!1,this.DiamondBtn.interactable=!1,this.ShareBtn.interactable=!1,this.QRShareBtn.interactable=!1,p.setEnterState(p.globalEnterStateFlag.EnterState_NewGuid);var e=this;setTimeout(function(){e.RecordBtn.interactable=!0,e.DiamondBtn.interactable=!0,e.ShareBtn.interactable=!0,e.QRShareBtn.interactable=!0},15e3),window.GGameEntry.UIManager.HideUI(a.UIType.PVPMakeTeamUI),this.loadingNode.active=!0,this.processPercent=0,this.startGame=!0,this.sendStartGameMsg=!0,window.GGameEntry.SoundManager.StopBg(),window.GGameEntry.EnterGuide()},OnRecordBtnClicked:function(){this.EnablePVPBtn(!1),this.EnablePVEBtn(!1),this.EnableGuideBtn(!1),this.EnableAutoJoinBtn(!1),this.EnableActivityBtn(!1),y.pushLog("OnRecordBtnClicked"),this.RecordBtn.interactable=!1,this.DiamondBtn.interactable=!1,this.ShareBtn.interactable=!1,this.QRShareBtn.interactable=!1,this.unschedule(this.EnableAllGameButtonOnTimeOut),this.scheduleOnce(this.EnableAllGameButtonOnTimeOut,3),this.IsLoginSuccess=!1,window.GGameEntry.CurGamePlayType=c.GamePlayType.GamePlayType_Network,console.error("##OnRecordBtnClicked");var e=window.GGameEntry.ResTableMgr.GetConfigByID(S.star_client_c,11).Context;h.onShowLoadingState("logining...",15e3,e,this.OnGetRecordInNetError,r),i.IsWeichatGame()&&r.onQueryPlayerResult()},EnableAllGameButtonOnTimeOut:function(){this.RecordBtn.interactable=!0,this.DiamondBtn.interactable=!0,this.ShareBtn.interactable=!0,this.QRShareBtn.interactable=!0,this.EnablePVPBtn(!0),this.EnablePVEBtn(!0),this.EnableGuideBtn(!0),this.EnableAutoJoinBtn(!0),this.EnableActivityBtn(!0),this.checkUIBtn()},OnDiamondBtnClicked:function(){if(window.GGameEntry.IsNetAvailable){this.EnablePVPBtn(!1),this.EnablePVEBtn(!1),this.EnableAutoJoinBtn(!1),this.EnableActivityBtn(!1),this.EnableGuideBtn(!1),y.pushLog("OnDiamondBtnClicked"),this.DiamondBtn.interactable=!1,this.RecordBtn.interactable=!1,this.ShareBtn.interactable=!1,this.QRShareBtn.interactable=!1,this.unschedule(this.EnableAllGameButtonOnTimeOut),this.scheduleOnce(this.EnableAllGameButtonOnTimeOut,15),this.IsLoginSuccess=!1,window.GGameEntry.CurGamePlayType=c.GamePlayType.GamePlayType_Network,console.error("##OnDiamondBtnClicked");e=window.GGameEntry.ResTableMgr.GetConfigByID(S.star_client_c,11).Context;h.onShowLoadingState("logining...",15e3,e,this.OnGetDiamonInNetError,r),i.IsWeichatGame()&&r.onQueryPlayerDiamond()}else{var e=window.GGameEntry.ResTableMgr.GetConfigByID(S.star_client_c,54).Context;window.GGameEntry.UIManager.ShowMsgBox(e)}},OnNetNotConnected:function(e){return!window.GGameEntry.GBattleNetwork.IsConnected()&&!1===e.IsLoginSuccess&&window.GGameEntry.CurGamePlayType===c.GamePlayType.GamePlayType_Network},GetGameRecordSuccess:function(){this.EnableAllGameButtonOnTimeOut()},OnGetRecordTimeOut:function(e){e&&e.EnableAllGameButtonOnTimeOut()},OnGetRecordInNetError:function(e){return!e.getPlayerResultFlag()},OnGetDiamonInNetError:function(e){return!e.getPlayerDiamonFlag()},OnExitBackToWXBtnClicked:function(){i.IsWeichatGame()&&wx.exitMiniProgram()},OnGMBtnClicked:function(){i.IsWeichatGame()&&wx.getClipboardData({success:function(e){e.data.length>0&&window.GGameEntry.UIManager.ShowMsgBox(e.data,100)}})},onCancelNetQueue:function(){this.EnablePVPBtn(!0),this.EnablePVEBtn(!0),this.EnableAutoJoinBtn(!0),this.EnableActivityBtn(!0),cc.error("onCancelNetQueue"),this.checkUIBtn()},onAonAutoJoinBtnClicked:function(){if(window.GGameEntry.IsNetAvailable){var e=cc.ServerConfig;if(e&&e.notice)window.GGameEntry.UIManager.ShowUI(a.UIType.RichMsgBoxUI,a.UIOrder.Top+100);else if(this.IsLoginSuccess=!1,window.GGameEntry.CurGamePlayType=c.GamePlayType.GamePlayType_Network,g.SetGameMode(g.GM.GameMode_PVPPlayer),this.EnablePVPBtn(!1),this.EnablePVEBtn(!1),this.EnableAutoJoinBtn(!1),this.EnableActivityBtn(!1),this.RecordBtn.interactable=!1,this.DiamondBtn.interactable=!1,this.ShareBtn.interactable=!1,this.QRShareBtn.interactable=!1,this.unschedule(this.EnableGameButtonOnTimeOut),this.scheduleOnce(this.EnableGameButtonOnTimeOut,15),i.setBtnCheckEnter(1),C.setActivityType(u.ROOM_TYPE.ROOM_COMMON),p.setEnterState(p.globalEnterStateFlag.EnterState_AutoPVP),console.log("onAutoJoinBtnClicked"),i.IsWeichatGame()){if(window.GGameEntry.GBattleNetwork.IsConnected())window.GGameEntry.UIManager.HideUI(a.UIType.LogoUI),window.GGameEntry.UIManager.ShowUI(a.UIType.PVPMakeTeamUI);else if(!window.GGameEntry.GBattleNetwork.IsConnecting()){console.error("#onAutoJoinBtnClicked");t=window.GGameEntry.ResTableMgr.GetConfigByID(S.star_client_c,11).Context;h.onShowLoadingState("logining...",15e3,t,this.OnNetNotConnected,this),s.onWXLogin()}}else window.GGameEntry.GBattleNetwork.IsConnected()?(window.GGameEntry.UIManager.HideUI(a.UIType.LogoUI),window.GGameEntry.UIManager.ShowUI(a.UIType.PVPMakeTeamUI)):window.GGameEntry.GBattleNetwork.IsConnecting()||this.autoLogin()}else{var t=window.GGameEntry.ResTableMgr.GetConfigByID(S.star_client_c,54).Context;window.GGameEntry.UIManager.ShowMsgBox(t)}},OnReceiveActivityMsg:function(e){return!e.IsReceiveActivityMsg},onActivityBtnClicked:function(){if(window.GGameEntry.IsNetAvailable){var e=cc.ServerConfig;if(e&&e.notice)window.GGameEntry.UIManager.ShowUI(a.UIType.RichMsgBoxUI,a.UIOrder.Top+100);else{window.GGameEntry.CurGamePlayType=c.GamePlayType.GamePlayType_Network,g.SetGameMode(g.GM.GameMode_Activity),this.EnablePVPBtn(!1),this.EnablePVEBtn(!1),this.EnableAutoJoinBtn(!1),this.EnableActivityBtn(!1),this.RecordBtn.interactable=!1,this.DiamondBtn.interactable=!1,this.ShareBtn.interactable=!1,this.QRShareBtn.interactable=!1,this.unschedule(this.EnableGameButtonOnTimeOut),this.scheduleOnce(this.EnableGameButtonOnTimeOut,15),i.setBtnCheckEnter(1),p.setEnterState(p.globalEnterStateFlag.EnterState_Activity),console.log("onActivityBtnClicked"),this.IsReceiveActivityMsg=!1;t=window.GGameEntry.ResTableMgr.GetConfigByID(S.star_client_c,11).Context;h.onShowLoadingState("logining...",15e3,t,this.OnReceiveActivityMsg,this),C.onRequestActiviryInfo()}}else{var t=window.GGameEntry.ResTableMgr.GetConfigByID(S.star_client_c,54).Context;window.GGameEntry.UIManager.ShowMsgBox(t)}},shareAppMsgCallback:function(e,t,n,i,a){},OnShareBtnClicked:function(){if(i.IsWeichatGame()){var e=""===window.GGameEntry.invitesharetips?"发现一个好玩的坦克大战游戏，点击立即进入":window.GGameEntry.invitesharetips;s.onShareMsgInGame(e,"",""===window.GGameEntry.inviteshareurl?"https://cdn.bt.qq.com/Config/Release/pic/InviteShare.png":window.GGameEntry.inviteshareurl,this.shareAppMsgCallback)}},OnQRShareBtnClick:function(){window.GGameEntry.fromLogoUIQR=!0,this.OnRecordBtnClicked()}}),cc._RF.pop()},{ActivityMsgMgr:"ActivityMsgMgr",CmdStartLoadMap:"CmdStartLoadMap",EnterStateMgr:"EnterStateMgr",GameMode:"GameMode",GlobalCfg:"GlobalCfg",JsonUtils:"JsonUtils",MsgFinishLoadMap:"MsgFinishLoadMap",MsgUtil:"MsgUtil",PlatformUtil:"PlatformUtil",QunUserDataMgr:"QunUserDataMgr",ResTableNames:"ResTableNames",ServerLog:"ServerLog",SimpleLabel:"SimpleLabel",UIManager:"UIManager",Util:"Util",loginComNotifyMsg:"loginComNotifyMsg",loginConfig:"loginConfig",loginServerMgr:"loginServerMgr",star_cs:"star_cs",star_macro:"star_macro",star_table:"star_table",weixininterface:"weixininterface",weixinmsgmgr:"weixinmsgmgr"}],LoseUI:[function(e,t,n){"use strict";cc._RF.push(t,"6ab50ntHYJKkbG92RYHeBfj","LoseUI");var i=e("UIManager");e("Util"),e("BattleDef");cc.Class({extends:cc.Component,properties:{Ani:{default:null,type:cc.Animation,serializable:!0},Value:{default:null,type:cc.Label}},onEnable:function(){this.Ani.play(),window.GGameEntry.UIManager.HideUI(i.UIType.PauseUI),window.GGameEntry.UIManager.HideUI(i.UIType.JoystickSettingUI),this.Ani.on("finished",this.animationFinish,this),window.GGameEntry.SoundManager.PlayLoseMusic(),this.Value.string=window.GGameEntry.BattleSystem.BattleData.LoseReason},animationFinish:function(){window.GGameEntry.UIManager.HideUI(i.UIType.WinUI),window.GGameEntry.UIManager.HideUI(i.UIType.LoseUI),window.GGameEntry.UIManager.HideUI(i.UIType.EmoticonUI),window.GGameEntry.UIManager.ShowUI(i.UIType.SettlementUI)},onDisable:function(){this.Ani.off("finished",this.animationFinish,this)}}),cc._RF.pop()},{BattleDef:"BattleDef",UIManager:"UIManager",Util:"Util"}],MapCfg:[function(e,t,n){"use strict";cc._RF.push(t,"004e7RQVw9DK453C6o8BI+u","MapCfg");var i=cc.Enum({Invalid:9,None:0,Block:1,MonsterHouse:2,Teleporter:3,Item:4,PlayerBorn:5,Border:6}),a=cc.Enum({None:0,Base:1,Ground:2,Adobe:3,Steel:4,Water:5,Grass:6,Border:7,Decorate:14,Mask:15,Box:19,NoBroken:20}),o={MonsterHouseTilePos:[1,1],PlayerTilePos:[1,2],MapTileSize:[2,2],TankSize:[1.5,1.5]},r={1:{101:[101],102:[102]},3:{301:[301,301,301,301],302:[301,301,0,0],303:[0,0,301,301],304:[301,0,301,0],305:[0,301,0,301]},4:{401:[401,401,401,401],402:[401,401,0,0],403:[0,0,401,401],404:[401,0,0,0],405:[0,401,0,0],406:[0,0,401,0],407:[0,0,0,401],408:[401,0,401,0],409:[0,401,0,401]},5:{501:[501],502:[502]},6:{601:[601]},7:{701:[701]},14:{1401:[1401],1402:[1402],1403:[1403],1404:[1404]},19:{1901:[1901],1902:[1901]},20:{2001:[2001]}},s=[{ID:1,Width:13,Height:19,Border:701,Ground:201,GameTime:120,Data:[0,0,0,0,0,401,101,401,0,0,0,0,1403,0,0,1402,0,0,401,401,401,0,0,0,0,0,0,0,0,0,0,1401,0,0,0,0,1402,0,0,501,501,301,0,0,0,0,0,0,1401,301,501,501,1401,0,0,0,0,409,401,408,0,0,0,0,0,0,0,0,0,0,0,0,1403,0,0,0,0,0,601,301,0,301,0,1402,301,0,0,301,0,301,601,601,0,0,1402,0,601,301,601,0,0,1403,0,601,601,302,302,302,0,305,301,304,0,302,302,302,601,601,303,303,303,0,0,0,1403,0,303,303,303,601,601,0,0,0,0,305,301,304,0,0,0,0,601,601,301,0,301,1403,601,301,601,0,301,0,301,601,601,301,1402,301,0,0,301,1402,0,301,0,301,601,0,0,0,1401,0,0,0,0,0,1403,0,0,0,0,0,0,0,0,409,401,408,0,0,0,0,1402,501,501,401,408,0,0,1402,0,0,409,401,501,501,0,0,1402,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,401,401,401,1402,0,1401,1403,0,0,0,0,0,0,401,102,401,0,0,0,0,0]},{ID:11,Width:7,Height:17,Border:701,Ground:201,GameTime:600,Data:[0,0,0,401,101,401,502,0,0,0,401,401,401,502,0,0,0,0,401,502,502,0,0,0,0,401,502,502,0,0,0,0,401,502,502,301,0,0,301,0,502,502,502,502,502,502,401,502,502,502,502,501,501,0,501,501,502,502,601,0,0,0,301,502,502,0,0,0,0,301,502,502,601,0,0,0,301,502,502,0,0,0,0,301,502,502,601,0,0,0,301,502,502,0,0,0,0,0,502,502,601,0,0,0,301,502,502,0,401,401,401,301,501,501,0,301,102,301,301]},{ID:1001,Width:13,Height:17,Border:701,Ground:201,GameTime:120,Data:[0,0,301,0,0,301,101,301,0,1403,301,0,0,1401,0,0,0,0,401,401,401,0,0,0,0,0,401,0,1402,0,0,0,0,0,0,0,0,0,401,0,301,408,401,0,0,0,0,1403,401,409,301,0,301,401,301,401,401,301,0,301,401,401,301,401,301,0,301,601,601,0,0,401,0,1402,601,601,301,1403,0,0,301,601,301,0,301,1401,301,601,301,0,0,1403,0,301,0,0,301,0,301,0,0,301,0,0,501,501,0,0,0,1402,0,0,0,1401,1403,501,501,0,0,301,1401,0,301,0,301,0,0,301,0,0,0,0,301,601,301,0,301,0,301,601,301,0,0,1401,301,601,601,0,0,401,1403,0,601,601,301,0,301,401,301,401,401,301,1402,301,401,401,301,401,301,0,301,408,401,0,0,0,0,0,401,409,301,0,401,0,0,0,0,0,0,1401,1403,0,0,0,401,0,0,1403,0,0,401,401,401,0,0,0,0,0,0,0,301,0,0,301,102,301,0,0,301,0,1402]},{ID:1002,Width:13,Height:17,Border:701,Ground:201,GameTime:120,Data:[0,0,0,0,0,301,101,301,0,0,301,0,601,301,301,0,0,0,401,401,401,0,0,301,0,601,0,401,401,301,301,0,0,0,0,0,401,0,0,401,0,0,0,0,401,601,301,501,501,601,301,301,501,0,401,0,0,401,401,401,301,301,0,0,0,601,0,0,401,601,0,301,0,0,0,0,401,0,601,0,0,0,0,301,401,301,401,401,0,0,301,501,301,401,601,401,601,601,601,0,301,0,0,501,301,301,401,301,401,601,0,601,401,301,401,301,301,501,0,0,301,0,601,601,601,401,601,401,301,501,301,0,0,401,401,301,401,301,0,0,0,0,601,0,401,0,0,0,0,301,0,601,401,0,0,601,0,0,0,301,301,401,401,401,0,0,401,0,501,301,301,601,501,501,301,601,401,0,0,0,0,401,0,0,401,0,0,0,0,0,301,301,401,401,0,601,0,301,0,0,401,401,401,0,0,0,301,301,601,0,301,0,0,301,102,301,0,0,0,0,0]},{ID:1003,Width:13,Height:17,Border:701,Ground:201,GameTime:120,Data:[1901,0,0,0,0,0,401,101,301,0,0,0,0,0,0,0,0,0,1403,401,401,401,0,0,0,0,1401,0,0,0,0,0,0,0,1402,0,0,0,0,601,601,601,601,601,601,0,0,0,0,0,1401,0,601,601,601,601,601,601,601,601,401,401,301,301,401,501,501,501,501,501,501,501,501,501,0,0,0,0,0,601,601,601,301,601,0,0,301,0,0,0,1403,0,0,0,301,0,0,301,0,0,301,0,301,0,0,0,0,2001,301,0,0,0,301,2001,0,0,0,0,301,0,301,0,0,301,0,0,301,0,0,0,0,0,0,0,301,0,0,601,301,601,601,601,0,0,0,0,1403,501,501,501,501,501,501,501,501,501,401,301,301,401,401,601,601,601,601,601,601,601,601,0,0,0,0,0,0,1403,601,601,601,601,601,601,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,401,401,401,0,0,0,0,0,0,0,1401,0,0,301,102,401,0,0,0,0,0,1901]},{ID:1004,Width:13,Height:17,Border:701,Ground:201,GameTime:120,Data:[701,701,0,0,0,0,0,0,0,0,0,701,701,701,1403,0,0,0,1402,0,0,0,0,0,1403,701,301,0,301,0,0,0,0,0,0,0,301,0,301,0,301,0,0,701,401,401,401,701,0,0,301,0,0,0,0,0,701,301,101,301,701,0,0,0,1402,301,0,301,0,701,701,701,701,701,0,301,0,301,0,301,0,0,701,0,301,0,701,0,0,301,0,0,0,0,0,0,0,301,0,0,1401,0,0,0,0,1402,1401,301,301,301,1403,301,301,301,0,0,0,0,0,0,0,0,0,301,0,0,0,0,0,0,0,301,0,0,701,0,301,0,701,1401,0,301,0,301,0,301,0,701,701,701,701,701,0,301,0,301,0,0,0,1402,701,301,102,301,701,0,1401,0,0,0,301,0,0,701,401,401,401,701,0,0,301,0,301,1401,301,0,0,0,0,0,0,0,301,0,301,701,0,0,0,0,0,0,0,0,0,0,1403,701,701,701,0,0,0,0,1402,0,0,0,0,701,701]},{ID:1005,Width:13,Height:17,Border:701,Ground:201,GameTime:120,Data:[701,701,0,0,0,0,0,0,0,0,0,701,701,701,1402,0,0,0,0,0,0,0,0,0,1401,701,0,0,0,0,1401,0,401,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1402,0,0,701,701,0,0,0,701,701,0,0,1401,0,0,0,701,701,0,0,0,701,701,0,0,0,0,401,0,0,0,0,0,0,0,0,0,401,0,0,0,0,0,1402,401,0,401,0,0,1403,0,0,301,1403,301,0,0,0,1402,0,0,0,301,0,301,0,0,0,0,0,401,0,401,0,0,0,0,0,0,401,0,0,0,1402,0,0,0,0,0,401,0,0,0,0,701,701,0,0,1401,701,701,0,0,0,0,0,0,701,701,0,0,0,701,701,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1401,0,401,0,0,0,0,0,0,701,1402,0,0,0,0,0,0,0,0,0,1402,701,701,701,0,0,0,0,0,0,0,0,0,701,701]}];t.exports={MapItemType:i,MapTileType:a,MapGlobalCfg:o,MapTileCfg:r,MapDataCfg:s},cc._RF.pop()},{}],MapDebugUI:[function(e,t,n){"use strict";cc._RF.push(t,"8351f1k6nlM/IWR3366YzyT","MapDebugUI");var i=e("BattleDef"),a=e("MapCfg");cc.Class({extends:cc.Component,properties:{MapData:{default:null,type:cc.Label}},update:function(e){if(window.GGameEntry.BattleSystem.BattleData.BattleState===i.BattleState.Playing){for(var t="",n=window.GGameEntry.MapManager.GridHeight*a.MapGlobalCfg.MapTileSize[1],o=window.GGameEntry.MapManager.GridWidth*a.MapGlobalCfg.MapTileSize[0],r=window.GGameEntry.BattleSystem.IsInvertWorld(),s=n-1;s>=0;s--){for(var l=0;l<o;l++){var c=(r?o-1-l:l)+(r?n-1-s:s)*o,u=window.GGameEntry.MapManager.MapData[c],d=window.GGameEntry.MapManager.MapDynamicBlockData[c];t+=(u=0===(u=d>0?d:u)?0:Math.floor(u/100)).toString(16).toUpperCase()+","}t+="\n"}this.MapData.string=t}}}),cc._RF.pop()},{BattleDef:"BattleDef",MapCfg:"MapCfg"}],MapItemAdobe:[function(e,t,n){"use strict";cc._RF.push(t,"f241cGs8RVKfakp57rZydSZ","MapItemAdobe");e("Util");var i=e("MapItemBase"),a=e("EntityTypeDefine");e("CollisionObject"),e("BlockMgr");cc.Class({extends:i,properties:{},onLoad:function(){this.EntityType=a.EntityType.EntityAdobe,this.Init()},Init:function(){this._super()},start:function(){this.itemId=1e4*(this.node.x-this.node.anchorX*this.node.width)+this.node.y-this.node.anchorY*this.node.height,window.GGameEntry.BlockMgr.insertBlockMap(this.itemId,this)},HitByBullet:function(){this.OnDie()},Reset:function(){this._super()},ReInitOver:function(){this._super(),this.itemId=1e4*(this.node.x-this.node.anchorX*this.node.width)+this.node.y-this.node.anchorY*this.node.height,window.GGameEntry.BlockMgr.insertBlockMap(this.itemId,this)},OnDie:function(){this.DeadAni||(window.GGameEntry.MapManager.RemoveStaticEntity(this),window.GGameEntry.SoundManager.PlayHitBlock(this.node.position),this._super(),this.DeadAni=!0)},_DoDieAction:function(){window.GGameEntry.BlockMgr.removeEntity(this.itemId),window.GGameEntry.CollisionObject.addMsg("ondie block"+this.itemId),this.node.setPosition(cc.p(1e6,1e6))}}),cc._RF.pop()},{BlockMgr:"BlockMgr",CollisionObject:"CollisionObject",EntityTypeDefine:"EntityTypeDefine",MapItemBase:"MapItemBase",Util:"Util"}],MapItemBase:[function(e,t,n){"use strict";cc._RF.push(t,"13789sOD31A5bcoWJD9S7Gz","MapItemBase");e("MapCfg");var i=e("EntityBase");cc.Class({extends:i,properties:{MyCollider:{default:null,type:cc.Collider}},onLoad:function(){},Init:function(){this._super(),this.node.isStatic=!0},OnDie:function(){this._super()},_DoDieAction:function(){window.GGameEntry.EntityManager.removeEntity(this.GetGuid()),window.GGameEntry.BattleItemCacheManager.CacheMe(this)}}),cc._RF.pop()},{EntityBase:"EntityBase",MapCfg:"MapCfg"}],MapItemBigAdobe:[function(e,t,n){"use strict";cc._RF.push(t,"66bbat6woZPYaxk90RJYLba","MapItemBigAdobe");var i=e("Util"),a=e("MapItemBase"),o=e("EntityTypeDefine"),i=(e("CollisionObject"),e("BlockMgr"),e("MapManager"),e("Util"));cc.Class({extends:a,properties:{blockIndex:{default:0,serializable:!1,visible:!1}},onLoad:function(){this.EntityType=o.EntityType.EntityBigAdobe},start:function(){this.blockIndex=window.GGameEntry.BlockMgr.getIndex()},GetBlockIndex:function(){return this.blockIndex},getDestorySmallCollisionAdobe:function(e,t){var n=i.BeginSample("MapItemBigAdobe::getDestorySmallCollisionAdobe"),a=this.getSmallCollisionAdobe(e,t);if(a){var o=cc.v2(a.node.x,a.node.y).sub(e),r=a.node.x,s=a.node.y;if(Math.abs(o.y)<Math.abs(o.x)){var l=1e4*r+s+25,c=window.GGameEntry.BlockMgr.getBlock(l,this);l=1e4*r+s-25;u=window.GGameEntry.BlockMgr.getBlock(l,this);return a.OnDie(),c&&c.OnDie(),u&&u.OnDie(),i.EndSample(n),!0}var l=1e4*(r+25)+s,c=window.GGameEntry.BlockMgr.getBlock(l,this);l=1e4*(r-25)+s;var u=window.GGameEntry.BlockMgr.getBlock(l,this);return a.OnDie(),c&&c.OnDie(),u&&u.OnDie(),i.EndSample(n),!0}return i.EndSample(n),!1},getSmallCollisionAdobe:function(e,t){for(var n=i.BeginSample("MapItemBigAdobe::getSmallCollisionAdobe"),a=window.GGameEntry.MapManager.getSmallAdobeFromBigAdobePos(this.GetBlockIndex()-1),o=[],r=0;r<a.length;r++){var s=a[r],l=new cc.Rect(s.node.x,s.node.y,s.node.width,s.node.height);this.rectCollisioWithSigment(l,e,t)&&(o[o.length]=s)}for(var c,r=0;r<o.length;r++)o[r].node?(c=new cc.v2(o[r].node.x,o[r].node.y)).sub(e).magSqr()<999999999999&&(c=o[r]):i.AssertCheck(!1);return i.EndSample(n),c},rectCollisioWithSigment:function(e,t,n){if(e.contains(t)||e.contains(n))return!0;var i=cc.v2(e.x,e.y),a=cc.v2(e.x+e.width,e.y),o=cc.v2(e.x,e.y+e.height),r=cc.v2(e.x+e.width,e.y+e.height);return this.segmentsIntr(t,n,i,a)||this.segmentsIntr(t,n,i,o)||this.segmentsIntr(t,n,r,a)||this.segmentsIntr(t,n,r,o)},pointInLine:function(e,t,n){var i=e.sub(t).mag(),a=e.sub(n),o=e.sub(n);return a.mag()+o.mag()==i},segmentsIntr:function(e,t,n,a){var o=i.BeginSample("MapItemBigAdobe::segmentsIntr"),r=t.y-e.y,s=e.x-t.x,l=a.y-n.y,c=n.x-a.x,u=r*c-s*l;if(0==u)return this.pointInLine(e,t,n)?(i.EndSample(o),!0):this.pointInLine(e,t,a)?(i.EndSample(o),!0):(i.EndSample(o),!1);var d=l*n.x+c*n.y,h=l*e.x+c*e.y-d;if(h*(l*t.x+c*t.y-d)>=0)return i.EndSample(o),!1;var f=r*e.x+s*e.y;if((r*n.x+s*n.y-f)*(r*a.x+s*a.y-f)>=0)return i.EndSample(o),!1;var m=h/u,y=m*s,p=-m*r;return i.EndSample(o),{x:e.x+y,y:e.y+p}},YfVector2SegmentIntersects:function(e,t,n,i){var a,o;return a=this.YfVector2IsLeft(e,n,i),o=this.YfVector2IsLeft(t,n,i),!(a*o>=0)&&(a=this.YfVector2IsLeft(n,e,t),o=this.YfVector2IsLeft(i,e,t),!(a*o>=0))},YfVector2IsLeft:function(e,t,n){return(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y)},isCollisionWithSamllAdobe:function(){},HitByBullet:function(){},OnDie:function(){this.node.stopAllActions(),this._DoDieAction()}}),cc._RF.pop()},{BlockMgr:"BlockMgr",CollisionObject:"CollisionObject",EntityTypeDefine:"EntityTypeDefine",MapItemBase:"MapItemBase",MapManager:"MapManager",Util:"Util"}],MapItemBorder:[function(e,t,n){"use strict";cc._RF.push(t,"20da64RoJxP5JS/ohB9y2Qx","MapItemBorder");var i=e("EntityBase"),a=e("Util");cc.Class({extends:i,properties:{},SetResID:function(e,t){this.Resid=e,this.SubItemIndex=t;var n="border";701===e&&1===t&&(n="border2");var i=this.node.getComponent(cc.Sprite);i&&(i.spriteFrame=this.SpAtlas.getSpriteFrame(n),i.spriteFrame.getTexture().setAliasTexParameters(),102===i.spriteFrame.getRect().width&&a.StrechSpriteFrameUV(i.spriteFrame,1))},SetBorderSize:function(e,t){this.node.width=e,this.node.height=t;var n=this.node.getComponent(cc.Sprite);n&&102===n.spriteFrame.getRect().width&&a.StrechSpriteFrameUV(n.spriteFrame,1)}}),cc._RF.pop()},{EntityBase:"EntityBase",Util:"Util"}],MapItemBox:[function(e,t,n){"use strict";cc._RF.push(t,"2a818IpKQlG5o6Hc2o5EMrX","MapItemBox");var i=e("MapItemBase"),a=(e("EntityTypeDefine"),e("MapManager"),e("Util"));e("GlobalCfg"),e("MapCfg");cc.Class({extends:i,properties:{HP:{default:100,visible:!1,serializable:!1},MaxHP:{default:100,visible:!1,serializable:!1},HPSprite:{default:null,type:cc.Node},LineSpriteFrame:{default:null,type:cc.SpriteFrame},LeftHpNode:{default:null,type:cc.Node},CachedLineSprite:{default:[],type:cc.Node}},onLoad:function(){this.Reset()},setHPLine:function(e){for(var t=a.BeginSample("MapItemBox::setHPLine"),n=0;n<this.CachedLineSprite.length;n++)this.CachedLineSprite[n].opacity=0;for(var i=e/25,o=this.HPSprite.width,r=o/i,s=r-o/2,l=this.CachedLineSprite.length,c=l<=i-1?l:i-1,u=0;u<c;u++)this.CachedLineSprite[u]&&(this.CachedLineSprite[u].opacity=255,this.CachedLineSprite[u].setPosition(s,0),s+=r);if(i-1>l)for(var d=i-1-this.CachedLineSprite.length,h=0;h<d;h++){var f=new cc.Node;f.addComponent(cc.Sprite).spriteFrame=this.LineSpriteFrame,f.setParent(this.LeftHpNode),f.setPosition(s,0),s+=r,this.CachedLineSprite[this.CachedLineSprite.length]=f}a.EndSample(t)},HitByBullet:function(e){if(!this.DeadAni){var t=a.BeginSample("MapItemBox::HitByBullet");this.HP-=e,this.HP<=0&&this.OnDie(),a.EndSample(t)}},SetHPSprite:function(){this.HPSprite.scaleX=this.HP/this.MaxHP},OnSetHp:function(e){this.HP=e,this.SetHPSprite(),this.HP<=0&&this.OnDie()},OnDie:function(){window.GGameEntry.MapManager.RemoveStaticEntity(this),this.Body.active=!1,this.DeadAni=!0,this._super()},Reset:function(){this.DeadAni=!1,null!==this.Body&&(this.Body.active=!0),this.HP=this.MaxHP,this.SetHPSprite()},_DoDieAction:function(){this.node.active=!1,this.node.setPosition(cc.p(1e6,1e6))},SetResID:function(e,t){this.Resid=e,this.SubItemIndex=t}}),cc._RF.pop()},{EntityTypeDefine:"EntityTypeDefine",GlobalCfg:"GlobalCfg",MapCfg:"MapCfg",MapItemBase:"MapItemBase",MapManager:"MapManager",Util:"Util"}],MapItemDecorate:[function(e,t,n){"use strict";cc._RF.push(t,"05badTxkdZH1aY7IhHO7Bus","MapItemDecorate");var i=e("MapItemBase");cc.Class({extends:i,properties:{},SetResID:function(e,t){this.Resid=e,this.SubItemIndex=t;var n=this.node.getComponent(cc.Sprite);n&&(n.spriteFrame=this.SpAtlas.getSpriteFrame("MapDecorate_"+(this.Resid%100).toString()),102===n.spriteFrame.getRect().width&&Util.StrechSpriteFrameUV(n.spriteFrame,1))}}),cc._RF.pop()},{MapItemBase:"MapItemBase"}],MapItemGrass:[function(e,t,n){"use strict";cc._RF.push(t,"96c6fqII1BAUrbMLcHtJo+K","MapItemGrass");var i=e("MapItemBase");cc.Class({extends:i,properties:{EnterExitAni:{default:null,type:cc.Animation},EnterAniName:"",ExitAniName:""},PlayEnterAni:function(e,t){this.EnterExitAni&&this.EnterAniName&&t&&(this.EnterExitAni.setCurrentTime(0,this.EnterAniName),this.EnterExitAni.play()),e&&e.TankInGrassCount++},PlayExitAni:function(e,t){this.EnterExitAni&&this.ExitAniName&&t&&(this.EnterExitAni.setCurrentTime(0,this.ExitAniName),this.EnterExitAni.play()),e&&e.TankInGrassCount--}}),cc._RF.pop()},{MapItemBase:"MapItemBase"}],MapItemGround:[function(e,t,n){"use strict";cc._RF.push(t,"7ff54edPXdNMqP43DZE7iFT","MapItemGround");var i=e("EntityBase"),a=e("Util");cc.Class({extends:i,properties:{Stripes:{default:null,type:cc.Sprite}},SetResID:function(e,t){this.Resid=e,this.SubItemIndex=t;var n="BrickBg",i=0;201===e&&(1===t?n="BrickBg2":2===t?n="Water2":3===t?n="Water":4===t?(n="Water",i=180):5===t?(n="Water",i=90):6===t?(n="Water",i=270):7===t?n="Water3":8===t?(n="Water3",i=90):9===t?(n="Water3",i=270):10===t&&(n="Water3",i=180)),0!==i&&(this.node.rotation=i),this.Stripes.spriteFrame=this.SpAtlas.getSpriteFrame(n),this.Stripes.spriteFrame.getTexture().setAliasTexParameters(),this.Stripes.spriteFrame.getRect().width%100==2&&a.StrechSpriteFrameUV(this.Stripes.spriteFrame,1)},SetBgSize:function(e,t){this.node.width=e,this.node.height=t,this.Stripes.node.width=e,this.Stripes.node.height=t,this.Stripes.node.setPosition(0,0)}}),cc._RF.pop()},{EntityBase:"EntityBase",Util:"Util"}],MapItemHide:[function(e,t,n){"use strict";cc._RF.push(t,"42319jIsrpFTbWKJx6+XmHU","MapItemHide");var i=e("EntityBase");cc.Class({extends:i,properties:{},applyBuff:function(e){e.execute(this)}}),cc._RF.pop()},{EntityBase:"EntityBase"}],MapItemHome:[function(e,t,n){"use strict";cc._RF.push(t,"d7333ktwhtOp7+WRCPGHImw","MapItemHome");var i=e("MapItemBase"),a=(e("EntityTypeDefine"),e("MapManager"),e("Util")),o=e("GlobalCfg"),r=e("BaseDangerCtrl"),s=e("MapCfg"),l=e("ResTableNames");cc.Class({extends:i,properties:{HP:{default:100,visible:!1,serializable:!1},MaxHP:{default:100,visible:!1,serializable:!1},destroySprite:{default:null,type:cc.Node},BlueTeamHPSprite:{default:null,type:cc.Node},RedTeamHPSprite:{default:null,type:cc.Node},BaseDanger:{default:null,type:r},HPWidthNode:{default:null,type:cc.Node},LineSpriteFrame:{default:null,type:cc.SpriteFrame},LeftHpParentNode:{default:null,type:cc.Node},CachedLineSprite:{default:[],type:cc.Node}},setHPLine:function(e){for(var t=0;t<this.CachedLineSprite.length;t++)this.CachedLineSprite[t].opacity=0;for(var n=e/25,i=this.HPWidthNode.width,a=i/n,o=a-i/2,r=this.CachedLineSprite.length,s=r<=n-1?r:n-1,l=0;l<s;l++)this.CachedLineSprite[l]&&(this.CachedLineSprite[l].opacity=255,this.CachedLineSprite[l].setPosition(o,0),o+=a);if(n-1>r)for(var c=n-1-this.CachedLineSprite.length,u=0;u<c;u++){var d=new cc.Node;d.addComponent(cc.Sprite).spriteFrame=this.LineSpriteFrame,d.setParent(this.LeftHpParentNode),d.setPosition(o,0),o+=a,this.CachedLineSprite[this.CachedLineSprite.length]=d}},HitByBullet:function(e){if(!this.DeadAni){var t=a.BeginSample("MapItemHome::HitByBullet");this.EntityCampType==window.GGameEntry.PlayerManager.GetMyCamp()&&this.BaseDanger&&this.BaseDanger.onBaseDamage(),this.HP-=e,this.SetHPSprite(),this.HP<=0&&this.OnDie(),a.EndSample(t)}},OnSetHp:function(e){this.HP>e&&this.EntityCampType==window.GGameEntry.PlayerManager.GetMyCamp()&&this.BaseDanger&&this.BaseDanger.onBaseDamage(),this.HP=e,this.SetHPSprite(),this.HP<=0&&this.OnDie()},SetHPSprite:function(){this.EntityCampType==window.GGameEntry.PlayerManager.GetMyCamp()?this.BlueTeamHPSprite.scaleX=this.HP/this.MaxHP:this.RedTeamHPSprite.scaleX=this.HP/this.MaxHP},OnDie:function(){if(this.destroySprite.active=!0,this.Body.active=!1,window.GGameEntry.SoundManager.PlayBaseDie(),window.GGameEntry.BattleSystem.IsPlaying()&&window.GGameEntry.CurGamePlayType===o.GamePlayType.GamePlayType_Single)if(this.EntityCampType===window.GGameEntry.PlayerManager.Player.EntityCampType){e=window.GGameEntry.ResTableMgr.GetConfigByID(l.star_client_c,3).Context;window.GGameEntry.BattleSystem.Lose(e,!1)}else{var e=window.GGameEntry.ResTableMgr.GetConfigByID(l.star_client_c,2).Context;window.GGameEntry.BattleSystem.Win(e,!1)}this.DeadAni=!0,this._super();var t=window.GGameEntry.MapManager.GetGridPos(this.node.x,this.node.y);window.GGameEntry.MapManager.RemoveStaticFlagByBigGrid(Math.floor(t[0]/s.MapGlobalCfg.MapTileSize[0]),Math.floor(t[1]/s.MapGlobalCfg.MapTileSize[1])),window.GGameEntry.IsGuiding()&&window.GGameEntry.SetFinishGuide()},Reset:function(){this.DeadAni=!1,null!==this.Body&&(this.Body.active=!0,this.destroySprite.active=!1),this.HP=this.MaxHP,this.EntityCampType==window.GGameEntry.PlayerManager.GetMyCamp()?(this.SetBaseSprite("Base1"),this.BlueTeamHPSprite.active=!0,this.RedTeamHPSprite.active=!1):(this.SetBaseSprite("Base2"),this.BlueTeamHPSprite.active=!1,this.RedTeamHPSprite.active=!0),this.SetHPSprite()},_DoDieAction:function(){},SetResID:function(e,t){this.Resid=e,this.SubItemIndex=t},SetBaseSprite:function(e){if(this.Body){var t=this.Body.getComponent(cc.Sprite);t&&(t.spriteFrame=this.SpAtlas.getSpriteFrame(e),t.spriteFrame&&102===t.spriteFrame.getRect().width&&a.StrechSpriteFrameUV(t.spriteFrame,1))}}}),cc._RF.pop()},{BaseDangerCtrl:"BaseDangerCtrl",EntityTypeDefine:"EntityTypeDefine",GlobalCfg:"GlobalCfg",MapCfg:"MapCfg",MapItemBase:"MapItemBase",MapManager:"MapManager",ResTableNames:"ResTableNames",Util:"Util"}],MapItemMask:[function(e,t,n){"use strict";cc._RF.push(t,"e05e2vxEgxDA6DbzHQDQjA9","MapItemMask");var i=e("EntityBase"),a=e("Util");cc.Class({extends:i,properties:{Stripes:{default:null,type:cc.Sprite}},SetResID:function(e,t){this.Resid=e,this.SubItemIndex=t,this.Stripes.spriteFrame=this.SpAtlas.getSpriteFrame("MapMask"),102===this.Stripes.spriteFrame.getRect().width&&a.StrechSpriteFrameUV(this.Stripes.spriteFrame,1)},SetBgSize:function(e,t){this.node.width=e,this.node.height=t,this.Stripes.node.width=e,this.Stripes.node.height=t,this.Stripes.node.setPosition(0,0)}}),cc._RF.pop()},{EntityBase:"EntityBase",Util:"Util"}],MapItemSteel:[function(e,t,n){"use strict";cc._RF.push(t,"9fe5bsogOBPBr0CkvkCEOSM","MapItemSteel");e("Util");var i=e("MapItemBase"),a=e("EntityTypeDefine");cc.Class({extends:i,properties:{},onLoad:function(){this.EntityType=a.EntityType.EntitySteel,this.Init()},Init:function(){this._super()},start:function(){this.itemIndex=1e4*(this.node.x-this.node.anchorX*this.node.width)+this.node.y-this.node.anchorY*this.node.height,window.GGameEntry.BlockMgr.insertBlockMap(this.itemIndex,this)},HitByBullet:function(e){this.OnDie()},Reset:function(){this._super(),this.node.visible=!0,this.node.disableCollider=!1},OnDie:function(){this.DeadAni||(window.GGameEntry.MapManager.RemoveStaticEntity(this),window.GGameEntry.SoundManager.PlayHitBlock(this.node.position),this._super(),this.DeadAni=!0)},ReInitOver:function(){this._super(),this.itemIndex=1e4*(this.node.x-this.node.anchorX*this.node.width)+this.node.y-this.node.anchorY*this.node.height,window.GGameEntry.BlockMgr.insertBlockMap(this.itemIndex,this)},_DoDieAction:function(){window.GGameEntry.BlockMgr.removeEntity(this.itemIndex),this.node.disableCollider=!0,this.node.visible=!1,this.node.setPosition(cc.p(1e6,1e6))}}),cc._RF.pop()},{EntityTypeDefine:"EntityTypeDefine",MapItemBase:"MapItemBase",Util:"Util"}],MapItemWater:[function(e,t,n){"use strict";cc._RF.push(t,"4b317PvQYBNv6oS4ZPK4rWP","MapItemWater");var i=e("MapItemBase"),a=e("Util");cc.Class({extends:i,properties:{},SetResID:function(e,t){this.Resid=e,this.SubItemIndex=t;var n=this.node.getComponent(cc.Sprite);n&&(501===e?n.spriteFrame=this.SpAtlas.getSpriteFrame("Water"):502===e&&(n.spriteFrame=this.SpAtlas.getSpriteFrame("Water2")),102===n.spriteFrame.getRect().width&&a.StrechSpriteFrameUV(n.spriteFrame,1))}}),cc._RF.pop()},{MapItemBase:"MapItemBase",Util:"Util"}],MapManager:[function(e,t,n){"use strict";cc._RF.push(t,"5fb8cavM8ZEN6pAfXhU1GsU","MapManager");var i=e("MapCfg"),a=i.MapTileType,o=(i.MapGlobalCfg,i.MapTileCfg),r=e("FindPath"),s=(e("EntityManager"),e("EntityTypeDefine")),l=s.EntityType,c=s.EntityCampType,u=e("Util"),d=e("AIMapUtil"),h=(e("TankBase"),e("UIManager"),e("GlobalCfg")),f=e("ResTableNames"),m=e("star_comm"),y=(e("MapItemHide"),e("ResCfgDef"));cc.Class({extends:cc.Component,properties:{MapBottomLayer:{default:null,type:cc.Node},MapItemLayer:{default:null,type:cc.Node},MapTopLayer:{default:null,type:cc.Node},GridWidth:{default:13,displayName:"GridWidth"},GridHeight:{default:19,displayName:"GridHeight"},GridSize:{default:25,displayName:"GridSize",serializable:!1,visible:!1},BigGridSize:100,MaxSmallGridWidth:{default:52,visible:!1},MaxSmallGridHeight:{default:76,visible:!1},MapGridData:{default:null,serializable:!1,visible:!1},MapData:{default:null,serializable:!1,visible:!1},MapDynamicBlockData:{default:null,serializable:!1,visible:!1},Astar:{default:null,serializable:!1,visible:!1},BorderResID:{default:null,serializable:!1,visible:!1},GroundResID:{default:null,serializable:!1,visible:!1},MapItem:{default:null,serializable:!1,visible:!1},GraphicsDebug:{default:null,type:cc.Graphics,serializable:!1,visible:!1},BattleFieldRect:null,CursorMapId:null},Init:function(){this.GridSize=this.BigGridSize/i.MapGlobalCfg.MapTileSize[0],this.MapItem={},this.MapDynamicBlockData=[]},Release:function(){},RelaseMap:function(){for(var e=[l.EntityBase,l.EntityGround,l.EntityAdobe,l.EntitySteel,l.EntityWater,l.EntityGrass,l.EntityBorder,l.EntityBigAdobe,l.EntityDecorate,l.EntityMapBox,l.EntityNoBroken],t=0;t<e.length;t++){var n=this.MapItem[e[t]];if(n)for(a=0;a<n.length;a++)window.GGameEntry.BattleItemCacheManager.CacheMe(n[a])}var i=this.MapItem[l.EntityHide];if(i&&i.left>0)for(var a=0;a<i.length;a++)i[a].node.destroy();this.MapItem={},this.MapDynamicBlockData=[]},GetMapData:function(e){for(var t=0;t<i.MapDataCfg.length;t++)if(i.MapDataCfg[t].ID===e)return i.MapDataCfg[t];return null},GetTileMapData:function(e){if(0===e)return null;var t=this.GetMapTileType(e);return i.MapTileCfg[t]&&i.MapTileCfg[t][e]?i.MapTileCfg[t][e]:null},GetParsedRealMapData:function(e){if(null!==e){for(var t=i.MapGlobalCfg.MapTileSize[0],n=i.MapGlobalCfg.MapTileSize[1],a=e.Width*t,o=e.Height*n,r=new Array(a*o),s=t*n,l=new Array(s),c=0;c<e.Height;c++)for(var u=0;u<e.Width;u++){var d=e.Data[c*e.Width+u],h=this.GetTileMapData(d);if(0!==d&&null===h)return void cc.error("Tile Not Found:",d," MapID:",e.ID);if(0===d||1===h.length||h.length===s)for(var f=0;f<s;f++)l[f]=0===d?0:1===h.length?h[0]:h[f%t+(n-1-Math.floor(f/t))*t];else if(4===h.length)for(var m=0;m<n/2;m++)for(var y=0;y<t/2;y++)l[4*(m+0)+2*y+0]=l[4*(m+1)+2*y+0]=l[4*(m+0)+2*y+1]=l[4*(m+1)+2*y+1]=h[2*m+y];for(var p=0;p<n;p++)for(var g=(c*n+p)*a+u*t,C=0;C<t;C++)r[g+C]=l[p*t+C]}return r}},CreateSinglePlayerMap:function(e){var t=this.GetMapData(e);if(null!==t){var n=u.BeginSample("MapManager::CreateSinglePlayerMap");this.MapGridData=t.Data.slice(0),this.MapData=this.GetParsedRealMapData(t),this.GridHeight=t.Height,this.GridWidth=t.Width,this.MaxSmallGridWidth=this.GridWidth*i.MapGlobalCfg.MapTileSize[0],this.MaxSmallGridHeight=this.GridHeight*i.MapGlobalCfg.MapTileSize[1],this.BorderResID=t.Border,this.GroundResID=t.Ground;var a=[0,0,this.GridWidth*i.MapGlobalCfg.MapTileSize[0]*this.GridSize,this.GridHeight*i.MapGlobalCfg.MapTileSize[1]*this.GridSize];this.BattleFieldRect=new cc.Rect(a[0],a[1],a[2],a[3]),d.InitAiMapConfig(e),this.Astar=new r.Astar(this.MaxSmallGridWidth,this.MaxSmallGridHeight),this.MapDynamicBlockData=new Array(this.MapData.length);for(var o=0;o<this.MapDynamicBlockData.length;o++)this.MapDynamicBlockData[o]=0;window.GGameEntry.CurGamePlayType===h.GamePlayType.GamePlayType_Single&&(window.GGameEntry.BattleSystem.BattleData.FullBattleTime=t.GameTime),window.GGameEntry.BattleRoot.SetBattleAreaSize(this.GridWidth*i.MapGlobalCfg.MapTileSize[0]*this.GridSize,this.GridHeight*i.MapGlobalCfg.MapTileSize[1]*this.GridSize),window.GGameEntry.ResManager.PreLoadRes(this.CreateSinglePlayerMapInternal.bind(this)),u.EndSample(n)}else cc.error("MapCfg not found:",e)},CreateGroundAndBorder:function(){var e=this.CreateMapBattleItemInternal(this.GroundResID,0,0,0,this.MapBottomLayer);e&&e.SetBgSize(this.GridWidth*i.MapGlobalCfg.MapTileSize[0]*this.GridSize,this.GridHeight*i.MapGlobalCfg.MapTileSize[1]*this.GridSize);var t=this.CreateMapBattleItemInternal(this.BorderResID,0,-100,-100,this.MapBottomLayer);t&&t.SetBorderSize((this.GridWidth+2)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize,100);var n=this.CreateMapBattleItemInternal(this.BorderResID,0,-100,this.GridHeight*i.MapGlobalCfg.MapTileSize[1]*this.GridSize,this.MapBottomLayer);n&&n.SetBorderSize((this.GridWidth+2)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize,100);var a=this.CreateMapBattleItemInternal(this.BorderResID,0,-100,0,this.MapBottomLayer);a&&a.SetBorderSize(100,this.GridHeight*i.MapGlobalCfg.MapTileSize[0]*this.GridSize);var o=this.CreateMapBattleItemInternal(this.BorderResID,0,this.GridWidth*i.MapGlobalCfg.MapTileSize[0]*this.GridSize,0,this.MapBottomLayer);if(o&&o.SetBorderSize(100,this.GridHeight*i.MapGlobalCfg.MapTileSize[0]*this.GridSize),window.GGameEntry.ResManager.GetProgramEffCfg(y.ProgramEffType.BianJieWai)!==y.PEBianJieWai.N){var r=this.CreateMapBattleItemInternal(this.GroundResID,1,-100,-300,this.MapBottomLayer);r&&r.SetBgSize((this.GridWidth+2)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize,200);var s=this.CreateMapBattleItemInternal(this.GroundResID,1,-100,(this.GridHeight+1)*i.MapGlobalCfg.MapTileSize[1]*this.GridSize,this.MapBottomLayer);s&&s.SetBgSize((this.GridWidth+2)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize,200);var l=this.CreateMapBattleItemInternal(this.GroundResID,1,-300,-300,this.MapBottomLayer);l&&l.SetBgSize(200,(this.GridHeight+6)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize);var c=this.CreateMapBattleItemInternal(this.GroundResID,1,(this.GridWidth+1)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize,-300,this.MapBottomLayer);c&&c.SetBgSize(200,(this.GridHeight+6)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize);var u=this.CreateMapBattleItemInternal(this.BorderResID,1,-200,-200,this.MapBottomLayer);u&&u.SetBorderSize((this.GridWidth+4)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize,100);var d=this.CreateMapBattleItemInternal(this.BorderResID,1,-200,(this.GridHeight+1)*i.MapGlobalCfg.MapTileSize[1]*this.GridSize,this.MapBottomLayer);d&&d.SetBorderSize((this.GridWidth+4)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize,100);var h=this.CreateMapBattleItemInternal(this.BorderResID,1,-200,-100,this.MapBottomLayer);h&&h.SetBorderSize(100,(this.GridHeight+2)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize);var f=this.CreateMapBattleItemInternal(this.BorderResID,1,(this.GridWidth+1)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize,-100,this.MapBottomLayer);f&&f.SetBorderSize(100,(this.GridHeight+2)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize);var m=this.CreateMapBattleItemInternal(this.GroundResID,2,-300,-600,this.MapBottomLayer);m&&m.SetBgSize((this.GridWidth+6)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize,300);var p=this.CreateMapBattleItemInternal(this.GroundResID,2,-300,(this.GridHeight+3)*i.MapGlobalCfg.MapTileSize[1]*this.GridSize,this.MapBottomLayer);p&&p.SetBgSize((this.GridWidth+6)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize,300);var g=this.CreateMapBattleItemInternal(this.GroundResID,2,-900,-900,this.MapBottomLayer);g&&g.SetBgSize(600,(this.GridHeight+6)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize+1200);var C=this.CreateMapBattleItemInternal(this.GroundResID,2,(this.GridWidth+3)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize,-900,this.MapBottomLayer);C&&C.SetBgSize(600,(this.GridHeight+6)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize+1200);var G=this.CreateMapBattleItemInternal(this.GroundResID,3,-300,-400,this.MapBottomLayer);G&&G.SetBgSize((this.GridWidth+6)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize+0,100);var S=this.CreateMapBattleItemInternal(this.GroundResID,4,(this.GridWidth+6)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize-300,(this.GridHeight+4)*i.MapGlobalCfg.MapTileSize[1]*this.GridSize-0,this.MapBottomLayer);S&&S.SetBgSize((this.GridWidth+6)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize+0,100);var E=this.CreateMapBattleItemInternal(this.GroundResID,5,-400,(this.GridHeight+4)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize-100-0,this.MapBottomLayer);E&&E.SetBgSize((this.GridHeight+6)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize+0,100);var T=this.CreateMapBattleItemInternal(this.GroundResID,6,(this.GridWidth+4)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize-0,-300,this.MapBottomLayer);T&&T.SetBgSize((this.GridHeight+6)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize+0,100);var w=this.CreateMapBattleItemInternal(this.GroundResID,7,-400,-400,this.MapBottomLayer);w&&w.SetBgSize(100,100);var M=this.CreateMapBattleItemInternal(this.GroundResID,8,-400,(this.GridHeight+4)*i.MapGlobalCfg.MapTileSize[1]*this.GridSize,this.MapBottomLayer);M&&M.SetBgSize(100,100);var _=this.CreateMapBattleItemInternal(this.GroundResID,9,(this.GridWidth+4)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize,-400,this.MapBottomLayer);_&&_.SetBgSize(100,100);var I=this.CreateMapBattleItemInternal(this.GroundResID,10,(this.GridWidth+4)*i.MapGlobalCfg.MapTileSize[0]*this.GridSize,(this.GridHeight+4)*i.MapGlobalCfg.MapTileSize[1]*this.GridSize,this.MapBottomLayer);I&&I.SetBgSize(100,100)}},CreateSinglePlayerMapInternal:function(){var e=u.BeginSample("MapManager::CreateSinglePlayerMapInternal");window.GGameEntry.BattleItemCacheManager.CacheSomeItem();var t=this.GetAllMapItemDataByMapTileType(),n=t[a.Grass];n&&n.length>0&&this.CreateMapBattleItem(n,this.GetParentByType(l.EntityGrass));var i=t[a.Water];i&&i.length>0&&this.CreateMapBattleItem(i,this.GetParentByType(l.EntityWater)),this.CreateGroundAndBorder();var o=t[a.Decorate];o&&o.length>0&&this.CreateMapBattleItem(o,this.GetParentByType(l.EntityDecorate));var r=t[a.Base];r&&r.length>0&&this.CreateMapBattleItem(r,this.GetParentByType(l.EntityBase));var s=t[a.Adobe];s&&s.length>0&&this.CreateMapBattleItem(s,this.GetParentByType(l.EntityAdobe));var c=t[a.Steel];c&&c.length>0&&this.CreateMapBattleItem(c,this.GetParentByType(l.EntitySteel));var d=t[a.NoBroken];d&&d.length>0&&this.CreateMapBattleItem(d,this.GetParentByType(l.EntityNoBroken));var h=t[a.Box];h&&c.length>0&&this.CreateMapBattleItem(h,this.GetParentByType(l.EntityMapBox)),window.GGameEntry.BattleSystem.BattleMapReady=!0,window.GGameEntry.BattleRoot.EnableMe(),this.DebugCheck_CheckAll(),window.GGameEntry.ItemManager.DebugCheck_CheckAll(),u.EndSample(e)},CreateServerMap:function(){var e=window.GGameEntry.ResTableMgr.GetConfigByID(f.star_map_desc_cs,window.GGameEntry.BattleSystem.MapID);if(e){var t=u.BeginSample("MapManager::CreateServerMap");this.GridHeight=u.TableStr2Num(e.Height),this.GridWidth=u.TableStr2Num(e.Width),this.MapGridData=new Array(this.GridWidth*this.GridHeight),this.MapData=new Array(this.GridWidth*i.MapGlobalCfg.MapTileSize[0]*this.GridHeight*i.MapGlobalCfg.MapTileSize[1]),this.MaxSmallGridWidth=this.GridWidth*i.MapGlobalCfg.MapTileSize[0],this.MaxSmallGridHeight=this.GridHeight*i.MapGlobalCfg.MapTileSize[1],this.BorderResID=u.TableStr2Num(e.Border),this.GroundResID=u.TableStr2Num(e.Ground);var n=[0,0,this.GridWidth*i.MapGlobalCfg.MapTileSize[0]*this.GridSize,this.GridHeight*i.MapGlobalCfg.MapTileSize[1]*this.GridSize];this.BattleFieldRect=new cc.Rect(n[0],n[1],n[2],n[3]);for(a=0;a<this.MapGridData.length;a++)this.MapGridData[a]=0;for(var a=0;a<this.MapData.length;a++)this.MapData[a]=0;this.MapDynamicBlockData=this.MapData.slice(0);var o=window.GGameEntry.ResTableMgr.GetConfigByID(f.star_bornpos_cs,window.GGameEntry.BattleSystem.MapID);window.GGameEntry.BattleSystem.BattleData.FullBattleTime=o.BattleTime/1e3,window.GGameEntry.BattleRoot.SetBattleAreaSize(this.GridWidth*i.MapGlobalCfg.MapTileSize[0]*this.GridSize,this.GridHeight*i.MapGlobalCfg.MapTileSize[1]*this.GridSize),this.CreateServerMapInternal(),u.EndSample(t)}else cc.error("Map cfg not found:",window.GGameEntry.BattleSystem.MapID)},CreateServerMapInternal:function(){window.GGameEntry.BattleItemCacheManager.CacheSomeItem(),this.CreateGroundAndBorder(),window.GGameEntry.BattleSystem.BattleMapReady=!0},GetMapBattleHome:function(e){var t=this.MapItem[l.EntityBase];if(!t)return null;for(var n=0;n<t.length;n++)if(t[n].EntityCampType===e)return t[n];return null},GetMapBattleHomePos:function(e){var t=null,n=this.MapItem[l.EntityBase];if(n)for(var a=0;a<n.length;a++)if(n[a].EntityCampType===e){t=n[a];break}if(t)return{x:t.node.x,y:t.node.y,exist:!0};var o=Math.floor(this.GridWidth/2),r=e===c.BlueTeam?0:this.GridHeight-1,s=this.GetWorldPos(o*i.MapGlobalCfg.MapTileSize[0],r*i.MapGlobalCfg.MapTileSize[1]);return{x:s[0]+50,y:s[1]+50,exist:!1}},GetMapBigAdobe:function(e){for(var t=[],n=0;n<this.GridHeight;n++)for(var a=0;a<this.GridWidth;a++){var o=this.MapGridData[n*this.GridWidth+a];if(0!==o&&this.GetMapTileType(o)===e){var r=this.GetTileMapData(o);if(!r){cc.error("tileMapData is null");continue}var s=this.GetWorldPos(a*i.MapGlobalCfg.MapTileSize[0],n*i.MapGlobalCfg.MapTileSize[1]);4===r.length&&(t[t.length]={ID:r[0],SubItemIndex:0,PosX:s[0],PosY:s[1]})}}return t},getSmallAdobeFromBigAdobePos:function(e){for(var t=4*e,n=[],i=0;i<4;i++)n[i]=this.MapItem[l.EntityAdobe][t+i];return n},CreateMapBattleBigAdobe:function(e,t){if(e&&t)for(var n=0;n<e.length;n++){var i=e[n];this.CreateMapBattleBigAdobeInternal(i.ID,i.SubItemIndex,i.PosX,i.PosY,t)}},CreateMapBattleBigAdobeInternal:function(e,t,n,i,a){var o=window.GGameEntry.BattleItemCacheManager.GetBattleItem(e,t,l.EntityBigAdobe);if(null!==o&&null!==o.node){o.node.parent=a,o.node.setPosition(n,i),this.MapItem[o.EntityType]||(this.MapItem[o.EntityType]=[]);var r=this.MapItem[o.EntityType].length;this.MapItem[o.EntityType][r]=o}},CreateMapBattleItem:function(e,t){if(e&&t)for(var n=0;n<e.length;n++){var i=e[n];this.CreateMapBattleItemInternal(i.ID,i.SubItemIndex,i.PosX,i.PosY,t)}},CreateMapBattleItemInternal:function(e,t,n,a,o){var r=window.GGameEntry.BattleItemCacheManager.GetMapItem(e,t);{if(null!==r&&null!==r.node){var s=u.BeginSample("MapManager::CreateMapBattleItemInternal");r.EntityType===l.EntityBase||r.EntityType===l.EntityWater||r.EntityType===l.EntityGrass||r.EntityType===l.EntityDecorate||r.EntityType===l.EntityMapBox||r.EntityType===l.EntityNoBroken?(n+=50,a+=50):r.EntityType!==l.EntitySteel&&r.EntityType!==l.EntityAdobe||(n+=50/i.MapGlobalCfg.MapTileSize[0],a+=50/i.MapGlobalCfg.MapTileSize[1]),r.node.parent=o,r.node.setPosition(n,a),r.ReInitOver(),r.EntityType!==l.EntityBase&&r.EntityType!==l.EntityAdobe&&r.EntityType!==l.EntitySteel&&r.EntityType!==l.EntityWater&&r.EntityType!==l.EntityGrass&&r.EntityType!==l.EntityMapBox&&r.EntityType!==l.EntityDecorate&&r.EntityType!==l.EntityNoBroken||window.GGameEntry.BattleSystem.SetInvertedNode(r.node,!0),this.MapItem[r.EntityType]||(this.MapItem[r.EntityType]=[]);var d=this.MapItem[r.EntityType].length;return this.MapItem[r.EntityType][d]=r,r.EntityType===l.EntityBase?(r.EntityCampType=a<this.GridHeight*i.MapGlobalCfg.MapTileSize[1]*this.GridSize/2?c.BlueTeam:c.RedTeam,r.HP=100,r.MaxHP=100,r.setHPLine(r.MaxHP),r.Reset(),r.node.zIndex=100):r.EntityType===l.EntityMapBox&&(r.HP=100,r.MaxHP=100,r.setHPLine(r.MaxHP),r.Reset()),r.EntityType!==l.EntityBase&&r.EntityType!==l.EntityAdobe||u.AssertCheck(0!==r.Guid,"此MapItem Guid不允许为0"),u.EndSample(s),r}cc.error("MapItem create failed:",e)}},GetGridPos:function(e,t){return[Math.floor(e/this.GridSize),Math.floor(t/this.GridSize)]},GetWorldPos:function(e,t){return[e*this.GridSize,t*this.GridSize]},GetWorldPositionCenter:function(e,t){var n=this.GetWorldPos(e,t);return n[0]+=.5*this.GridSize,n[1]+=.5*this.GridSize,n},GetGirdMapItemType:function(e,t){var n=this.GridWidth*i.MapGlobalCfg.MapTileSize[0],a=this.GridHeight*i.MapGlobalCfg.MapTileSize[1];return e>=0&&e<n&&t>=0&&t<a?Math.floor(this.MapData[e+t*n]/100):l.EntityNone},GetGirdMapItemTypeByScreenPos:function(e,t){var n=this.GetGridPos(e,t);return this.GetGirdMapItemType(n[0],n[1])},PrintMapData:function(){for(var e="\n",t=0;t<this.GridHeight;t++){for(n=0;n<this.GridWidth;n++)e+=((a=this.MapGridData[n+t*this.GridWidth])<10?"00":a<100?"0":"")+a.toString()+",";e+="\n"}cc.log(e),e="\n";for(t=0;t<this.GridHeight*i.MapGlobalCfg.MapTileSize[1];t++){for(var n=0;n<this.GridWidth*i.MapGlobalCfg.MapTileSize[0];n++){var a=this.MapData[n+t*this.GridWidth*i.MapGlobalCfg.MapTileSize[0]];e+=(a<10?"00":a<100?"0":"")+a.toString()+","}e+="\n"}cc.log(e)},DrawMapData:function(){for(var e=0;e<this.MaxSmallGridHeight;e++)for(var t=0;t<this.MaxSmallGridWidth;t++)this.DrawGrid(t,e,this.GridCanWalk(t,e)?new cc.Color(0,255,0,64):new cc.Color(255,0,0,64))},GetTileCfgByType:function(e){for(var t=0;t<o.length;t++)if(o[t].TileType===e)return o[t];cc.error("tile cfg is not found:%d",e)},GetMapTileType:function(e){return Math.floor(e/100)},GetMapItemSubSize:function(e){var t=this.GetMapTileType(e);return t===a.Base||t===a.Water||t===a.Grass?[1,1]:t===a.Steel||t===a.Adobe?[4,4]:null},GetAllMapItemDataByMapTileType:function(){for(var e={},t=i.MapGlobalCfg.MapTileSize[0],n=i.MapGlobalCfg.MapTileSize[1],a=0;a<this.GridHeight;a++)for(var o=a*this.GridWidth,r=0;r<this.GridWidth;r++){var s=this.MapGridData[o+r];if(0!==s){var l=this.GetMapTileType(s),c=this.GetTileMapData(s);if(c){var u=e[l];u||(e[l]=[],u=e[l]);var d=this.GetWorldPos(r*t,a*n);if(1===c.length)u[u.length]={ID:c[0],SubItemIndex:0,PosX:d[0],PosY:d[1]};else if(4==c.length){d[1]+=this.BigGridSize/2;for(var h=0;h<2;h++)for(var f=0;f<2;f++){var m=2*(1-h)+f;0!==c[m]&&(u[u.length]={ID:c[m],SubItemIndex:m,PosX:d[0]+f*this.BigGridSize/2,PosY:d[1]-(1-h)*this.BigGridSize/2})}}}else cc.error("tileMapData is null")}}return e},GetBattleFieldRect:function(){return this.BattleFieldRect},UpdateDynamicEntityFlag:function(e,t,n,a){if(e.EntityType===l.EntityMonster||e.EntityType===l.EntityPlayer||e.EntityType===l.EntityOtherPlayer){var o=u.BeginSample("MapManager::UpdateDynamicEntityFlag");this.UpdateGrass(e,t,n);var r=this.GetGridPos(t,n),s=this.GetGridPos(e.node.x,e.node.y);if(a||r[0]!==s[0]||r[1]!==s[1]){var c=i.MapGlobalCfg.MapTileSize[0],d=i.MapGlobalCfg.MapTileSize[1],h=this.GridWidth*c;if(!a)for(f=0;f<d;f++)for(m=0;m<c;m++)this.MapDynamicBlockData[h*(r[1]+f)+r[0]+m]=0;for(var f=0;f<d;f++)for(var m=0;m<c;m++)this.MapDynamicBlockData[h*(s[1]+f)+s[0]+m]=100*e.EntityType+1;u.EndSample(o)}else u.EndSample(o)}},RemoveStaticFlagByBigGrid:function(e,t){for(var n=this.GridWidth*i.MapGlobalCfg.MapTileSize[0],a=i.MapGlobalCfg.MapTileSize[0],o=i.MapGlobalCfg.MapTileSize[1],r=e*a,s=t*o,l=0;l<o;l++)for(var c=0;c<a;c++)this.MapData[n*(s+l)+r+c]=0},AddStaticEntity:function(e,t,n){for(var a=this.GridWidth*i.MapGlobalCfg.MapTileSize[0],o=i.MapGlobalCfg.MapTileSize[0],r=i.MapGlobalCfg.MapTileSize[1],s=t*o,l=n*r,c=0;c<r;c++)for(var u=0;u<o;u++)this.MapData[a*(l+c)+s+u]=e.EntityType},RemoveStaticEntity:function(e){if(e.EntityType===l.EntitySteel||e.EntityType===l.EntityAdobe||e.EntityType==l.EntityMapBox||!e.EntityType===l.EntityAirDropBox){var t=this.GetGridPos(e.node.x,e.node.y),n=i.MapGlobalCfg.MapTileSize[0],a=i.MapGlobalCfg.MapTileSize[1],o=e.EntityType===l.EntityBigAdobe||e.EntityType===l.EntityMapBox||e.EntityType===l.EntityAirDropBox?n*a:1,r=this.GridWidth*i.MapGlobalCfg.MapTileSize[0];if(o>1){t[0]=Math.floor(t[0]/n)*n,t[1]=Math.floor(t[1]/a)*a;for(var s=0;s<o;s++)for(var c=0;c<o;c++)this.MapData[r*(t[1]+s)+t[0]+c]=0}else this.MapData[r*t[1]+t[0]]=0}},GetBlockFlagInLine:function(e,t,n,a){for(var o=u.GetGridPos(e,t,n,a),r=[],c=this.GridWidth*i.MapGlobalCfg.MapTileSize[0],d=0;d<o.length;d++){var h=o[d],f=this.MapData[h[0]+h[1]*c],m=s.GetEntityTypeFromResID(f);m!==l.EntityAdobe&&m!==l.EntitySteel||(r[r.length]=f)}return r},FindEntityByGUID:function(e){var t=Math.floor(e/1e5),n=this.MapItem[t];if(!n)return null;for(var i=0;i<n.length;i++)if(n[i].Guid===e)return n[i];return null},RemoveEntityByGUID:function(e){if(window.GGameEntry.BattleSystem.IsPlaying()){var t=e/1e5,n=this.MapItem[t];if(!n)return null;for(var i=0;i<n.length;i++)if(n[i].Guid===e){window.GGameEntry.BattleItemCacheManager.CacheMe(n[i]),this.MapItem[t].splice(i,1);break}}},CheckBigGridEmpty:function(e,t){for(var n=u.BeginSample("MapManager::CheckBigGridEmpty"),a=i.MapGlobalCfg.MapTileSize[0],o=i.MapGlobalCfg.MapTileSize[1],r=this.GridWidth*a,s=e*a,l=t*o,c=l+o,d=s+a,h=l;h<c;h++)for(var f=s;f<d;f++)if(0!==this.MapData[f+h*r])return u.EndSample(n),!1;return u.EndSample(n),!0},GetDataInBigGrid:function(e,t){for(var n=u.BeginSample("MapManager::GetDataInBigGrid"),a=i.MapGlobalCfg.MapTileSize[0],o=i.MapGlobalCfg.MapTileSize[1],r=[],s=this.GridWidth*a,l=e*a,c=t*o,d=c+o,h=l+a,f=c;f<d;f++)for(var m=l;m<h;m++)0!==this.MapData[m+f*s]&&(r[r.length]={Pos:{X:m,Y:f},Data:this.MapData[m+f*s]});return u.EndSample(n),r},GetGridTitleType:function(e,t){var n=e+t*this.GridWidth*i.MapGlobalCfg.MapTileSize[0],a=this.MapDynamicBlockData[n];if(a>0)return Math.floor(a/100);var o=this.MapData[n];return o>0?Math.floor(o/100):l.EntityNone},GridCanWalk:function(e,t){if(e<0||e>=this.MaxSmallGridWidth||t<0||t>=this.MaxSmallGridHeight)return!1;var n=this.GetGridTitleType(e,t);return n===l.EntityNone||n!==l.EntityBase&&n!==l.EntityAdobe&&n!==l.EntitySteel&&n!==l.EntityWater&&n!==l.EntityBorder&&n!==l.EntityNoBroken},GridCanWalk9:function(e,t){for(var n=[[0,0],[-1,0],[0,-1],[-1,-1]],a=this.GridWidth*i.MapGlobalCfg.MapTileSize[0],o=this.GridHeight*i.MapGlobalCfg.MapTileSize[1],r=n.length,s=0;s<r;s++){var l=n[s][0],c=n[s][1];if(!(e<=0&&l<0||t<=0&&c<0||e>=a-1&&l>0||t>=o-1&&c>0)){var u=e+l,d=t+c;if(!this.GridCanWalk(u,d))return!1}}return!0},SmallGrid2Index:function(e,t){return t*this.MaxSmallGridWidth+e},Index2SmallGridX:function(e){return e%this.MaxSmallGridWidth},Index2SmallGridY:function(e){return Math.floor(e/this.MaxSmallGridWidth)},DrawGrid:function(e,t,n){return},ClearDrawGrid:function(){this.GraphicsDebug&&this.GraphicsDebug.clear()},UpdateGrass:function(e,t,n){var a=this.MapItem[l.EntityGrass];if(a&&0!==a.length){var o=u.BeginSample("MapManager::UpdateGrass"),r=(i.MapGlobalCfg.MapTileSize[0]/2+i.MapGlobalCfg.TankSize[0]/2)*this.GridSize,s=r*r,c=a.length,d=e.node.x,h=e.node.y,f=!1;window.GGameEntry.ResManager.GetProgramEffCfg(y.ProgramEffType.CaoCongDouDong)===y.PECaoCongDouDong.Y&&(f=!0);for(var m=0,p=0;p<c;p++){var g=a[p],C=g.node,G=C.x-t,S=C.y-n,E=C.x-d,T=C.y-h;if((G>r||G<-r||S>r||S<-r)&&(E>r||E<-r||T>r||T<-r))m++;else{var w=G*G+S*S<s,M=E*E+T*T<s;w!=M&&(w?g.PlayExitAni(e,f):M&&g.PlayEnterAni(e,f))}}m===c&&(e.TankInGrassCount=0),u.EndSample(o)}},CheckCanWalkByType:function(e){return e!==l.EntityBase&&e!==l.EntityAdobe&&e!==l.EntitySteel&&e!==l.EntityMapBox&&e!==l.EntityWater&&e!==l.EntityBorder&&e!==l.EntityNoBroken&&e!==l.EntityMonster&&e!==l.EntityPlayer&&e!==l.EntityOtherPlayer},BigGridCanWalk:function(e,t,n){for(var a=i.MapGlobalCfg.MapTileSize[0],o=i.MapGlobalCfg.MapTileSize[1],r=this.GridWidth*a,s=e*a,l=t*o,c=0;c<o;c++)for(var u=0;u<a;u++){var d=0;if(n&&(d=this.MapDynamicBlockData[s+u+(l+c)*r]),0===d&&(d=this.MapData[s+u+(l+c)*r]),d=Math.floor(d/100),!this.CheckCanWalkByType(d))return!1}return!0},RaycastMapdata:function(e,t){for(var n=u.GetGridPos(e.x,e.y,t.x,t.y),a=this.GridWidth*i.MapGlobalCfg.MapTileSize[0],o=n.length,r=0;r<o;r++){var c=n[r],d=this.MapData[c[0]+c[1]*a],h=s.GetEntityTypeFromResID(d);if(h===l.EntityAdobe||h===l.EntitySteel)return!1}return!0},GetParentByType:function(e){var t=this.MapItemLayer;switch(e){case l.EntityAdobe:t=this.MapItemLayer;break;case l.EntityBase:t=this.MapTopLayer;break;case l.EntityAdobe:case l.EntitySteel:case l.EntityWater:t=this.MapItemLayer;break;case l.EntityGrass:t=this.MapTopLayer;break;case l.EntityMapBox:case l.EntityNoBroken:t=this.MapItemLayer}return t},CreateMapBattleItemByServer:function(e){if(e)if(this.MapData){var t=e.ResID,n=s.GetEntityTypeFromResID(t),a=this.GetParentByType(n),o=this.CreateMapBattleItemInternal(t,e.GridState,e.Pos.x,e.Pos.y,a);if(u.AssertCheck(o,"地图物件创建失败:"+t.toString()),o){o.Guid=e.ObjID,o.EntityCampType=e.CampID,window.GGameEntry.EntityManager.AddEntity(o);var r=i.MapGlobalCfg.MapTileSize[0],c=i.MapGlobalCfg.MapTileSize[1],d=this.GridWidth*i.MapGlobalCfg.MapTileSize[0],h=this.GetGridPos(e.Pos.x,e.Pos.y);if(1===(n===l.EntitySteel||n===l.EntityAdobe?r*c:1)&&2===i.MapGlobalCfg.MapTileSize[0]?(this.MapData[h[0]+h[1]*d]=t,this.MapData[h[0]+1+h[1]*d]=t,this.MapData[h[0]+(h[1]+1)*d]=t,this.MapData[h[0]+1+(h[1]+1)*d]=t):this.MapData[h[0]+h[1]*d]=t,n===l.EntityBase||n===l.EntityMapBox){o.Reset();for(var f=e.AttrList.length,y=e.AttrList,p=0;p<f;p++){var g=y[p];g.AttrID===m.AttrType.ATTR_HP?o.HP=g.Value:g.AttrID===m.AttrType.ATTR_MAX_HP&&(o.MaxHP=g.Value,o.setHPLine(o.MaxHP))}}n===l.EntityBase&&(o.node.zIndex=100,o.SetHPSprite())}else cc.error("create map item failed:",e.ResID)}else cc.error("地图数据为空")},CreateMapBattleHideItemByServer:function(e){if(e){var t=new cc.Node;t.parent=this.MapBottomLayer;var n=t.addComponent("MapItemHide");if(n){this.MapItem[l.EntityHide]||(this.MapItem[l.EntityHide]=[]),n.Guid=e.ObjID,n.EntityType=l.EntityHide;var i=this.MapItem[l.EntityHide].length;this.MapItem[l.EntityHide][i]=n,window.GGameEntry.EntityManager.AddEntity(n)}}},DebugCheck_CheckAll:function(){u.AssertCheck(this.MapItem,"地图物件为空"),this.MapItem&&(u.AssertCheck(this.GridWidth>0&&this.GridHeight>0,"地图大小不正确:"+this.GridWidth.toString()+","+this.GridHeight.toString()),u.AssertCheck(this.BorderResID>0&&this.GroundResID>0,"地图底图资源不正确:"+this.BorderResID.toString()+","+this.GroundResID.toString()),this.DebugCheck_Base(),this.DebugCheck_MapItemGUID())},DebugCheck_Base:function(){var e=this.MapItem[l.EntityBase];if(e&&(u.AssertCheck(e.length%2==0,"基地个数不正确:"+e.length),e.length>0)){for(var t=0,n=0,i=0;i<e.length;i++)e[i].EntityCampType===c.RedTeam?(n++,u.AssertCheck(e[i].MaxHP>0&&e[i].HP>=0&&e[i].HP<=e[i].MaxHP,"红方基地血量不正确:"+e[i].HP.toString()+":"+e[i].MaxHP.toString())):e[i].EntityCampType===c.BlueTeam&&(t++,u.AssertCheck(e[i].MaxHP>0&&e[i].HP>=0&&e[i].HP<=e[i].MaxHP,"蓝方基地血量不正确:"+e[i].HP.toString()+":"+e[i].MaxHP.toString()));u.AssertCheck(1===t,"蓝方基地个数不正确:"+t.toString()),u.AssertCheck(1===n,"红方基地个数不正确:"+n.toString())}},DebugCheck_MapItemGUID:function(){for(var e=[l.EntityBase,l.EntityAdobe,l.EntitySteel],t={},n=0;n<e.length;n++){var i=this.MapItem[e[n]];if(i&&0!==i.length)for(var a=0;a<i.length;a++){var o=i[a].Guid;u.AssertCheck(!t[o],"地图物件有相同的GUID:"+e[n]),t[o]||(t[o]=!0)}}}}),cc._RF.pop()},{AIMapUtil:"AIMapUtil",EntityManager:"EntityManager",EntityTypeDefine:"EntityTypeDefine",FindPath:"FindPath",GlobalCfg:"GlobalCfg",MapCfg:"MapCfg",MapItemHide:"MapItemHide",ResCfgDef:"ResCfgDef",ResTableNames:"ResTableNames",TankBase:"TankBase",UIManager:"UIManager",Util:"Util",star_comm:"star_comm"}],MathUtil:[function(e,t,n){"use strict";cc._RF.push(t,"b52284Dk8FOOIYro1/2e9hI","MathUtil");e("Util");cc.Class({properties:{cosMap:{default:null},sinMap:{default:null},pi2:{default:.01745}},init:function(){this.cosMap=[],this.sinMap=[];for(var e=0;e<=36e3;e++){var t=e/100;this.cosMap.push(Math.cos(t*this.pi2)),this.sinMap.push(Math.sin(t*this.pi2))}},cos:function(e){return e<0&&(e+=360),e>=360&&(e%=360),e*=100,e=Math.round(e),this.cosMap[e]},sin:function(e){return e<0&&(e+=360),e>=360&&(e%=360),e*=100,e=Math.round(e),this.sinMap[e]}}),cc._RF.pop()},{Util:"Util"}],MonsterManager:[function(e,t,n){"use strict";cc._RF.push(t,"8adc8GfRE5I66Essv4d4dH3","MonsterManager");var i=e("MapCfg"),a=(e("EntityBase"),e("EntityTypeDefine")),o=(i.MapItemType,e("AIMapUtil")),r=e("Util"),s=e("MsgPickUpItem"),l=(e("GlobalCfg"),e("RandomNameUtil"));cc.Class({extends:cc.Component,properties:{Monster1Prefab:{default:null,type:cc.Prefab},MapEnemyLayer:{default:null,type:cc.Node},MonsterSpawnCount:{default:0,serializable:!1,visible:!1},TagValue:{default:0,serializable:!1,visible:!1},LogEnabled:{default:!1,serializable:!1,visible:!1},WarningPrefabRed:{default:null,type:cc.Prefab},WarningPrefabBlue:{default:null,type:cc.Prefab},MonsterHeadIconSpriteFrameList:{default:[],type:cc.SpriteFrame},MonsterAIRules:{default:null,visible:!1}},Init:function(e){window.GGameEntry.NotificationCenter.on("TankReborn",this.RebornMonster,this),this.MapManager=window.GGameEntry.MapManager,this.monsterMap={},this.monsterRedTeamArray=[],this.monsterBuluTeamArray=[],this.WarningPrefabArrayRed=[],this.WarningPrefabArrayBlue=[]},Release:function(){window.GGameEntry.NotificationCenter.off("TankReborn",this.RebornMonster,this),this.MapManager=null,this.RedTeamCount=0,this.BlueTeamCount=0},RebornMonster:function(e){var t=r.BeginSample("MonsterManager::RebornMonster");e.detail.guid!=window.GGameEntry.PlayerManager.Player.Guid&&(window.GGameEntry.Performance1104?this.RebornMonsterNoWarning(e.detail.campType,e.detail.lineType):this.PlayerWarningPrefab(e.detail.campType,e.detail.lineType)),r.EndSample(t)},RebornMonsterNoWarning:function(e,t){var n=r.BeginSample("MonsterManager::RebornMonsterNoWarning"),i=(Math.floor(3*Math.random()),this.monsterMap[10*e+t]);if(i){if(i.Reset(),e==a.EntityCampType.BlueTeam)i.SetRotateShootPoint(0);else{i.SetRotateShootPoint(180);var l=o.GetBirthPos(e,t);i.x=l[0],i.x=l[1]}var c=i.GetGuid(),u=new s;u.entityGUID=c,u.buffID=23,u.Send()}r.EndSample(n)},RebornMonsterDelay:function(e,t,n){var i=r.BeginSample("MonsterManager::RebornMonsterDelay"),l=(Math.floor(3*Math.random()),this.monsterMap[10*e+t]);if(l){if(l.Reset(),e==a.EntityCampType.BlueTeam)this.WarningPrefabArrayBlue[n].active=!1,(c=this.WarningPrefabArrayBlue[n].getComponent(cc.Animation))&&c.stop(),l.SetRotateShootPoint(0);else{this.WarningPrefabArrayRed[n].active=!1;var c=this.WarningPrefabArrayRed[n].getComponent(cc.Animation);c&&c.stop(),l.SetRotateShootPoint(180);var u=o.GetBirthPos(e,t);l.x=u[0],l.x=u[1]}var d=l.GetGuid(),h=new s;h.entityGUID=d,h.buffID=23,h.Send()}r.EndSample(i)},CreateWarningPrefab:function(){for(var e=r.BeginSample("MonsterManager::CreateWarningPrefab"),t=0;t<2;t++)(n=cc.instantiate(this.WarningPrefabBlue)).active=!1,this.WarningPrefabArrayBlue.push(n),this.MapEnemyLayer.addChild(n);for(t=0;t<3;t++){var n=cc.instantiate(this.WarningPrefabRed);n.active=!1,this.WarningPrefabArrayRed.push(n),this.MapEnemyLayer.addChild(n)}r.EndSample(e)},PlayerWarningPrefab:function(e,t){var n=r.BeginSample("MonsterManager::PlayerWarningPrefab"),i=o.GetBirthPos(e,t),s=0,l=window.GGameEntry.PlayerManager.Player.EntityLineType,c=null;if(e==a.EntityCampType.BlueTeam?(l==a.EntityLineType.Left&&(s=t==a.EntityLineType.Mid?0:1),l==a.EntityLineType.Mid&&(s=t==a.EntityLineType.Left?0:1),l==a.EntityLineType.Right&&(s=t==a.EntityLineType.Left?0:1),c=this.WarningPrefabArrayBlue[s]):(t==a.EntityLineType.Left&&(s=0),t==a.EntityLineType.Mid&&(s=1),t==a.EntityLineType.Right&&(s=2),c=this.WarningPrefabArrayRed[s]),null!=c){c.active=!0,c.x=i.x,c.y=i.y;var u=c.getComponent(cc.Animation);u&&u.play()}var d=cc.callFunc(function(){this.PlayerWarningOver(e,t,s)},this);this.node.runAction(cc.sequence(cc.delayTime(1),d)),r.EndSample(n)},PlayerWarningOver:function(e,t,n){this.RebornMonsterDelay(e,t,n)},CreateMonster:function(){this.TagValue=1,this.MonsterSpawnCount=0,window.GGameEntry.IsGuiding()||(this.MonsterAIRules?this.CreateCustomMonster():(this.CreateTeamateMonster(),this.CreateEnemyMonster())),this.CreateWarningPrefab()},CreateTeamateMonster:function(){var e=r.BeginSample("MonsterManager::CreateTeamateMonster"),t=window.GGameEntry.GameConfig.rules.slice(0,3);if(t){var n=t.pop(),i=t.pop(),o=t.pop(),s=[2,3];this.CreateMonsterWithRule(a.EntityCampType.BlueTeam,n,s,"hard"),this.CreateMonsterWithRule(a.EntityCampType.BlueTeam,i,s,"normal"),this.CreateMonsterWithRule(a.EntityCampType.BlueTeam,o,s,"easy")}r.EndSample(e)},CreateEnemyMonster:function(){var e=r.BeginSample("MonsterManager::CreateEnemyMonster"),t=window.GGameEntry.GameConfig.rules.slice(3);if(t){var n=t.pop(),i=t.pop(),o=t.pop(),s=[1,2,3];this.CreateMonsterWithRule(a.EntityCampType.RedTeam,n,s,"hard"),this.CreateMonsterWithRule(a.EntityCampType.RedTeam,i,s,"normal"),this.CreateMonsterWithRule(a.EntityCampType.RedTeam,o,s,"easy")}r.EndSample(e)},CreateMonsterWithRule:function(e,t,n,i){for(;t>0&&n.length>0;){var a=Math.floor(Math.random()*n.length);a>n.length-1&&(a=n.length-1),this.spawnMonster(e,n[a],i),n.splice(a,1),t--}},CreateCustomMonster:function(){var e=r.BeginSample("MonsterManager::CreateCustomMonster");if(this.MonsterAIRules&&5==this.MonsterAIRules.length){for(var t=new Array,n=0;n<this.MonsterAIRules.length;n++)0==this.MonsterAIRules[n]?t.push("easy"):1==this.MonsterAIRules[n]?t.push("normal"):t.push("hard");this.spawnMonster(a.EntityCampType.RedTeam,a.EntityLineType.Left,t[0]),this.spawnMonster(a.EntityCampType.RedTeam,a.EntityLineType.Mid,t[1]),this.spawnMonster(a.EntityCampType.RedTeam,a.EntityLineType.Right,t[2]),this.spawnMonster(a.EntityCampType.BlueTeam,a.EntityLineType.Mid,t[3]),this.spawnMonster(a.EntityCampType.BlueTeam,a.EntityLineType.Right,t[4])}r.EndSample(e)},CreateMonsterFromServerData:function(e){},GetMonsterArrayByTeam:function(e){return e==a.EntityCampType.BlueTeam?this.monsterBuluTeamArray:e==a.EntityCampType.RedTeam?this.monsterRedTeamArray:void 0},spawnMonster:function(e,t,n){if(r.BeginSample("MonsterManager::spawnMonster"),window.GGameEntry.PerformanceMgr.Config.EnableMonitor)if(e===a.EntityCampType.BlueTeam){if(this.BlueTeamCount||(this.BlueTeamCount=0),this.BlueTeamCount>=window.GGameEntry.PerformanceMgr.Config.BlueTeamCount)return;this.BlueTeamCount++}else if(e===a.EntityCampType.RedTeam){if(this.RedTeamCount||(this.RedTeamCount=0),this.RedTeamCount>=window.GGameEntry.PerformanceMgr.Config.RedTeamCount)return;this.RedTeamCount++}var i=cc.instantiate(this.Monster1Prefab);i.name="Monster"+this.MonsterSpawnCount,this.MonsterSpawnCount++;var s=i.getComponent("Monster");s.SetConfigId(10002),s.SetEntityType(a.EntityType.EntityMonster),s.GenGUID(),s.EntityCampType=e,s.EntityLineType=t,s.difficult=n,s.Init(window.GGameEntry),s.Resid=100*a.EntityType.EntityMonster+1;var c=o.GetBirthPos(e,t);e==a.EntityCampType.BlueTeam?this.monsterBuluTeamArray[this.monsterBuluTeamArray.length]=s:(this.monsterRedTeamArray[this.monsterRedTeamArray.length]=s,s.SetRotateShootPoint(180)),s.setTankPosition(c);var u=2===e?t+1:t-2;if(u>=0&&u<this.MonsterHeadIconSpriteFrameList.length){var d=this.MonsterHeadIconSpriteFrameList[u],h=l.GetTankRandomName();s.CreateFollowNameAndHeadImage(h,d,!0)}return this.MapEnemyLayer.addChild(i),this.monsterMap[10*s.EntityCampType+s.EntityLineType]=s,window.GGameEntry.EntityManager.AddEntity(s),r.EndSample("MonsterManager::spawnMonster"),i},ReleaseMonster:function(){this.MapEnemyLayer.stopAllActions();for(var e=0;e<this.MapEnemyLayer.childrenCount;++e){var t=this.MapEnemyLayer.children[e].getComponent("Monster");t&&t.node.isValid&&t.StopAll()}this.MapEnemyLayer.destroyAllChildren(),window.GGameEntry.UIManager.HeadImageLayer.destroyAllChildren(),window.GGameEntry.UIManager.NameLayer.destroyAllChildren(),this.monsterMap={},this.monsterBuluTeamArray=[],this.monsterRedTeamArray=[],this.WarningPrefabArrayRed=[],this.WarningPrefabArrayBlue=[],this.RedTeamCount=0,this.BlueTeamCount=0},IsCollisionWithOtherMonster:function(e,t){for(var n in this.monsterMap){var i=this.monsterMap[n];if(e!==i&&(i.node.active&&e.EntityCampType!==i.EntityCampType)){var a=e.MyCollider.world.aabb.clone(),o=i.MyCollider.world.aabb.clone();if(a.x=t.x,a.y=t.y,o.x=i.node.x,o.y=i.node.y,a.intersects(o))return!0}}return!1},GetActionTag:function(){var e=this.TagValue;return++this.TagValue,e},GetConfigMonsterMoveSpeed:function(){return window.GGameEntry.LevelManager.CachedCurLevelData.MonsterSpeed},GetConfigGiveUpTime:function(){return window.GGameEntry.LevelManager.CachedCurLevelData.MonsterGiveUpTime/1e3},GetConfigRebornTime:function(){return window.GGameEntry.LevelManager.CachedCurLevelData.MonsterRebornTime/1e3},_DoPauseOrResume:function(e){for(var t=this.MapEnemyLayer.children,n=0;n<t.length;++n){var i=t[n].getComponent("Monster");e?i.OnPause():i.OnResume()}e?this.MapEnemyLayer.pauseAllActions():this.MapEnemyLayer.resumeAllActions()},Pause:function(){},Resume:function(){},PreLoad:function(){},CreateGuideMonster:function(e,t,n,i){var o=cc.instantiate(this.Monster1Prefab);o.name="Monster"+this.MonsterSpawnCount,this.MonsterSpawnCount++;var s=o.getComponent("Monster");s.SetConfigId(10002),s.SetEntityType(a.EntityType.EntityMonster),s.GenGUID(),s.EntityCampType=e,s.EntityLineType=t,s.difficult="easy",s.AIComponent.enabled=!1,s.Init(window.GGameEntry),s.Resid=100*a.EntityType.EntityMonster+1,e==a.EntityCampType.BlueTeam?this.monsterBuluTeamArray[this.monsterBuluTeamArray.length]=s:(this.monsterRedTeamArray[this.monsterRedTeamArray.length]=s,s.SetRotateShootPoint(180)),s.setTankPosition(cc.p(n,i));var c=2===e?t+1:t-2;if(c>=0&&c<this.MonsterHeadIconSpriteFrameList.length){var u=this.MonsterHeadIconSpriteFrameList[c],d=l.GetTankRandomName();s.CreateFollowNameAndHeadImage(d,u,!0)}this.MapEnemyLayer.addChild(o),this.monsterMap[10*s.EntityCampType+s.EntityLineType]=s,window.GGameEntry.EntityManager.AddEntity(s);var h=s,f=h.GetTankName(),m={killCount:0,deadCount:0,multiKillCount:0,blockCount:0,guid:h.Guid,stringName:f,lineType:h.EntityLineType,campType:h.EntityCampType};return window.GGameEntry.BattleSystem.BattleKillData[window.GGameEntry.BattleSystem.BattleKillData.length]=m,r.EndSample("MonsterManager::spawnMonster"),s}}),cc._RF.pop()},{AIMapUtil:"AIMapUtil",EntityBase:"EntityBase",EntityTypeDefine:"EntityTypeDefine",GlobalCfg:"GlobalCfg",MapCfg:"MapCfg",MsgPickUpItem:"MsgPickUpItem",RandomNameUtil:"RandomNameUtil",Util:"Util"}],Monster:[function(e,t,n){"use strict";cc._RF.push(t,"16182LWxhdNYrfRyPThBG06","Monster");e("EntityBase");var i=e("EntityTypeDefine"),a=(e("TankAttr"),e("AIComponent")),o=e("TankBase"),r=e("AIMapUtil"),s=e("Util");cc.Class({extends:o,properties:{AIComponent:{default:null,type:a},enableShoot:{default:!0},shootDistance:{default:500},difficult:{default:0,serializable:!1,visible:!1},MovingPath:{default:[],serializable:!1,visible:!1},movingIdx:{default:-1,serializable:!1,visible:!1},moveDestGrid:{default:cc.v2(0,0),serializable:!1,visible:!1},testTime:{default:5},ChangeSpriteArray:{default:[],type:cc.Sprite},LogEnabled:{default:!1,serializable:!1,visible:!1}},onLoad:function(){this._super()},Init:function(e){this._super(e),this.AIComponent.enabled&&this.AIComponent.Init(this,this.EntityLineType,this.difficult),i.EntityCampType.BlueTeam===this.EntityCampType?(this.ChangeSpriteArray[0].spriteFrame=this.SpAtlas.getSpriteFrame("friendsBloodBar"),this.ChangeSpriteArray[1].spriteFrame=this.SpAtlas.getSpriteFrame("Tank_G")):(this.ChangeSpriteArray[0].spriteFrame=this.SpAtlas.getSpriteFrame("EnemyBloodBar"),this.ChangeSpriteArray[1].spriteFrame=this.SpAtlas.getSpriteFrame("Tank_R"))},onDestroy:function(){this.StopAll(),this.AIComponent.Finit(this)},StopAll:function(){this.node.stopAllActions()},OnPlayerDie:function(){this.StopAll()},Reset:function(){this._super(),this.Hp=this.MaxHp;var e=r.GetBirthPos(this.EntityCampType,this.EntityLineType);this.setTankPosition(e),this.node.active=!0,this.ResetMovePath(),this.AIComponent.Reset()},OnDie:function(){this.DeadAni||(window.GGameEntry.SoundManager.PlayMonsterDie(this.node.position),this._super(),this.DeadAni=!0)},_DoDieAction:function(){var e=cc.v2(1e4,1e4);this.node.setPosition(e),this.node.active=!1},OnPause:function(){this.node.pauseAllActions(),this.rigidbody.linearVelocity=cc.v2(0,0),this.AIComponent.enabled=!1},OnResume:function(){this.node.resumeAllActions(),this.rigidbody.linearVelocity=this.pauseVelocity,this.AIComponent.enabled=!0},onCollisionEnter:function(e,t){this.onCollisionLogic(e,t)},onCollisionStay:function(e,t){},aiMoveTargetPoInTime:function(e,t){var n=cc.moveTo(e,t.x,t.y);this.node.runAction(n)},aiShoot:function(){this.Shoot(-1)},aiSetMoveTarget:function(e){e&&(e.equals(cc.v2(-1,-1))?this.ResetMovePath():this.enableMoving&&this.moveDestGrid.equals(e)||this.InitMovePath(e))},ResetMovePath:function(){this.moveDestGrid=cc.v2(-1,-1),this.MovingPath=[],this.movingIdx=0,this.enableMoving=!1,this.clearSpeed()},InitMovePath:function(e){if(e&&!e.equals(cc.v2(-1,-1))){this.MovingPath=[],this.movingIdx=0;var t=s.BeginSample("Monster::InitMovePath"),n=function(e){var n={};return n.x=e.x,n.y=e.y,window.GGameEntry.MapManager.GridCanWalk(e.x-1,e.y+1)&&window.GGameEntry.MapManager.GridCanWalk(e.x-1,e.y)&&window.GGameEntry.MapManager.GridCanWalk(e.x-1,e.y-1)||!window.GGameEntry.MapManager.GridCanWalk(e.x+1,e.y)||(n.x+=1),window.GGameEntry.MapManager.GridCanWalk(e.x-1,e.y-1)&&window.GGameEntry.MapManager.GridCanWalk(e.x,e.y-1)&&window.GGameEntry.MapManager.GridCanWalk(e.x+1,e.y-1)||!window.GGameEntry.MapManager.GridCanWalk(e.x,e.y+1)||(n.y+=1),s.EndSample(t),n},i={},a=this.GetSmallGridPos(),o=e;window.GGameEntry.MapManager.ClearDrawGrid();var r=n(a),l=n(o),c=window.GGameEntry.MapManager.SmallGrid2Index(r.x,r.y),u=window.GGameEntry.MapManager.SmallGrid2Index(l.x,l.y);if(c!=u){for(var d=window.GGameEntry.MapManager.Astar.search(c,u,function(e,n){var a=window.GGameEntry.MapManager.SmallGrid2Index(e,n),o=i[a];if(void 0!=o)return s.EndSample(t),o;for(var r=-1;r<=0;++r)for(var l=-1;l<=0;++l)if(!window.GGameEntry.MapManager.GridCanWalk(e+r,n+l))return i[a]=!1,s.EndSample(t),!1;return i[a]=!0,s.EndSample(t),!0}),h=0;h<d.length;++h){var f=cc.v2(window.GGameEntry.MapManager.Index2SmallGridX(d[h]),window.GGameEntry.MapManager.Index2SmallGridY(d[h]));if(!a.equals(f)){var m=window.GGameEntry.MapManager.GetWorldPos(f.x,f.y);this.MovingPath[this.MovingPath.length]=cc.v2(m[0],m[1]),window.GGameEntry.MapManager.DrawGrid(f.x,f.y)}}d.length>0&&(this.moveDestGrid=e,this.enableMoving=!0),window.GGameEntry.MapManager.DrawGrid(a.x,a.y,cc.Color.GREEN),window.GGameEntry.MapManager.DrawGrid(o.x,o.y,cc.Color.BLUE),s.EndSample(t)}else s.EndSample(t)}},MoveOnPath:function(e){if(this.enableMoving&&!(this.MovingPath.length<=0)){for(var t=s.BeginSample("Monster::MoveOnPath");this.movingIdx>=0&&this.movingIdx<this.MovingPath.length;){var n=this.MovingPath[this.movingIdx];if(!this.doMoveToTarget(n,e))return void s.EndSample(t);this.movingIdx++}this.enableMoving=!1,this.ResetMovePath(),s.EndSample(t)}},Shoot:function(e){this._super(e)},SetRotateShootPoint:function(e){this.PaoTaiNode.rotation=e,window.GGameEntry.Performance1104&&(this.ImageNode.rotation=e)},update:function(e){this._super(e),this.MoveOnPath(e)},testCode:function(e){this.testTime=this.testTime-e,this.testTime<0&&(this.doMoveToTarget(cc.p(550,500),e),this.Shoot(-1))},Log:function(e){this.LogEnabled}}),cc._RF.pop()},{AIComponent:"AIComponent",AIMapUtil:"AIMapUtil",EntityBase:"EntityBase",EntityTypeDefine:"EntityTypeDefine",TankAttr:"TankAttr",TankBase:"TankBase",Util:"Util"}],MsgBase:[function(e,t,n){"use strict";cc._RF.push(t,"0d26breYKhLu4v9jpsqOCKx","MsgBase"),cc.Class({extends:cc.Component,properties:{id:{default:0,serializable:!1,visible:!1}},onLoad:function(){},Send:function(){}}),cc._RF.pop()},{}],MsgDelayDoing:[function(e,t,n){"use strict";cc._RF.push(t,"163b0mS6dhCrLIUVTOi3u2S","MsgDelayDoing"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},addDelayElementDeadEvent:function(e){this.DeadEvent||(this.DeadEvent=[]),this.DeadEvent[this.DeadEvent.length]=e},update:function(e){if(this.DeadEvent)for(var t=0;t<this.DeadEvent.length;t++){this.DeadEvent[t].OnDie(),this.DeadEvent.shift();break}}}),cc._RF.pop()},{}],MsgEmoticon:[function(e,t,n){"use strict";cc._RF.push(t,"e848cOQaeNDnqbSBJdGRapn","MsgEmoticon");var i=e("MsgBase"),a=e("GlobalCfg"),o=e("NetworkProto"),r=(e("star_comm"),e("star_cs")),s=e("Util");cc.Class({extends:i,properties:{EmoticionID:0,ObjID:0},onLoad:function(){},Send:function(){if(window.GGameEntry.CurGamePlayType===a.GamePlayType.GamePlayType_Network){if(s.BeginSample("MsgEmotion::Send"),window.GGameEntry.PlayerManager.MainPlayerGuid!==this.ObjID)return void console.error("MsgEmoticon error!  Not Main Player");var e=o.GetRequestByID(r.CS_CMD_TYPE.CS_SUB_BATTLE_EMOTION);e.ObjID=this.ObjID,e.EmotionID=this.EmoticionID,o.SendBattleSvrRequest(0,e),s.EndSample("MsgEmotion::Send")}}}),cc._RF.pop()},{GlobalCfg:"GlobalCfg",MsgBase:"MsgBase",NetworkProto:"NetworkProto",Util:"Util",star_comm:"star_comm",star_cs:"star_cs"}],MsgFinishLoadMap:[function(e,t,n){"use strict";cc._RF.push(t,"0ce29xK271DfabRsRyD6ajW","MsgFinishLoadMap");var i=e("MsgBase"),a=(e("SkillDefine"),e("CmdStartGame")),o=e("GlobalCfg");e("star_comm"),e("star_cs");cc.Class({extends:i,properties:{},onLoad:function(){},Send:function(){if(window.GGameEntry.CurGamePlayType===o.GamePlayType.GamePlayType_Single){var e=new a;e.Init(),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(e)}else window.GGameEntry.CurGamePlayType,o.GamePlayType.GamePlayType_Network}}),cc._RF.pop()},{CmdStartGame:"CmdStartGame",GlobalCfg:"GlobalCfg",MsgBase:"MsgBase",SkillDefine:"SkillDefine",star_comm:"star_comm",star_cs:"star_cs"}],MsgHandler:[function(e,t,n){"use strict";function i(e){var t=e;if(null!=t&&null!=(t=e))if(0==t.E)if(t.C==g.CS_CMD_TYPE.CS_SUB_BATTLE_GET_OBJ)o(t);else if(t.C==g.CS_CMD_TYPE.CS_SUB_BATTLE_END_NOTIFY)r(t);else if(t.C==g.CS_CMD_TYPE.CS_SUB_BATTLE_REMOVE_OBJ)C.BeginSample("CS_SUB_BATTLE_REMOVE_OBJ"),s(t),C.EndSample("CS_SUB_BATTLE_REMOVE_OBJ");else if(t.C==g.CS_CMD_TYPE.CS_SUB_BATTLE_SPELL_ACTION)C.BeginSample("CS_SUB_BATTLE_SPELL_ACTION"),l(t),C.EndSample("CS_SUB_BATTLE_SPELL_ACTION");else if(t.C==g.CS_CMD_TYPE.CS_SUB_BATTLE_ATTR_NOTIFY)C.BeginSample("CS_SUB_BATTLE_ATTR_NOTIFY"),c(t),C.EndSample("CS_SUB_BATTLE_ATTR_NOTIFY");else if(t.C==g.CS_CMD_TYPE.CS_SUB_BATTLE_EFFECT_NOTIFY)if(0==t.E){C.BeginSample("CS_SUB_BATTLE_EFFECT_NOTIFY");var n=new T;n.ServerDataToClient(t),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(n),C.EndSample("CS_SUB_BATTLE_EFFECT_NOTIFY")}else C.AssertCheck(0==t.E,"CS_SUB_BATTLE_EFFECT_NOTIFY errorcode is "+t.E);else if(t.C==g.CS_CMD_TYPE.CS_SUB_BATTLE_STATE_NOTIFY)if(0==t.E){C.BeginSample("CS_SUB_BATTLE_STATE_NOTIFY");var i=new E;i.ServerDataToClient(t),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(i),C.EndSample("CS_SUB_BATTLE_STATE_NOTIFY")}else C.AssertCheck(0==t.E,"CS_SUB_BATTLE_STATE_NOTIFY errorcode is "+t.E);else if(t.C==g.CS_CMD_TYPE.CS_SUB_BATTLE_BUFF_OP)0==t.E?(C.BeginSample("CS_SUB_BATTLE_BUFF_OP"),(a=new m).ServerDataToClient(t),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(a),C.EndSample("CS_SUB_BATTLE_BUFF_OP")):C.AssertCheck(0==t.E,"CS_SUB_BATTLE_BUFF_OP errorcode is "+t.E);else if(t.C==g.CS_CMD_TYPE.CS_SUB_BATTLE_MOVE_PATH)0===t.E||-1===t.E?((a=new M).ServerDataToClient(t),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(a)):C.AssertCheck(0==t.E,"CS_SUB_BATTLE_MOVE_PATH errorcode is "+t.E);else if(t.C==g.CS_CMD_TYPE.CS_SUB_BATTLE_MOVE_STOP);else if(t.C===g.CS_CMD_TYPE.CS_SUB_BATTLE_STATISTIC)if(0==t.E){var a=new v;a.BattleStatisticData=t,window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(a)}else C.AssertCheck(0==t.E,"CS_SUB_BATTLE_STATISTIC errorcode is "+t.E);else t.C==g.CS_CMD_TYPE.CS_SUB_BATTLE_EMOTION?u(t):t.C==g.CS_CMD_TYPE.CS_CMD_ERROR_NOTIFY?d(t):t.C==g.CS_CMD_TYPE.CS_SUB_BATTLE_EXEC_BUFF_EFFECT&&(C.BeginSample("CS_SUB_BATTLE_EXEC_BUFF_EFFECT"),f(t),C.EndSample("CS_SUB_BATTLE_EXEC_BUFF_EFFECT"));else console.warn("onRecvBattleMsgCallback failed, Cmd:"+t.C+" Eno:"+t.E)}function a(e){var t={},n=e.SD.GL;t.TriggerTime=n.P[0],t.SyncTime=n.P[1],t.BattleTime=n.P[2],t.MapID=n.P[3],t.CountTime=n.P[4],t.GameBeginTime=n.P[5],t.ObjCnt=n.ObjCnt,t.List=[];for(var i=0;i<n.ObjCnt;++i){var a=n.List[i];t.List[i]={};var o=t.List[i];if(o.Type=a.Type,o.Object={},a.Type==p.CsObjectType.CS_OBJ_PLAYER){var r=a.Object.PlayerObj;o.Object.PlayerObj={};var s=o.Object.PlayerObj;s.Name=r.Name,s.OpenId=r.OpenId,s.Pic=r.Pic,s.ObjID=r.P[0],s.Pos=cc.v2(r.P[1],r.P[2]),s.Dir=r.P[3],s.Type=r.P[4],s.ResID=r.P[5],A.isActivityMode(g.ROOM_TYPE.ROOM_IO)?""!==s.OpenId&&s.OpenId===G.getOpenID()?s.CampID=S.EntityCampType.BlueTeam:s.CampID=S.EntityCampType.RedTeam:s.CampID=r.P[6],s.Bullet=r.P[7],s.RowNum=r.P[8],s.ColumnNum=r.P[9],s.CreateTime=r.P[10],s.AttrNum=r.An,s.AttrList=[];for(u=0;u<r.An;++u)s.AttrList[u]={},s.AttrList[u].AttrID=r.Al[u].P[0],s.AttrList[u].Value=r.Al[u].P[1];s.BuffNum=r.Bn,s.Buff=[];for(u=0;u<r.Bn;++u)s.Buff[u]={},s.Buff[u].ResID=r.Bf[u].P[0],s.Buff[u].LeftTime=r.Bf[u].P[1];s.State=r.State}else if(a.Type==p.CsObjectType.CS_OBJ_OTHER){var l=a.Object.OtherObj;o.Object.OtherObj={};var c=o.Object.OtherObj;c.ObjID=l.P[0],c.Pos=cc.v2(l.P[1],l.P[2]),c.Dir=l.P[3],c.Type=l.P[4],c.ResID=l.P[5],c.CampID=l.P[6],c.GridState=l.P[7],c.RowNum=l.P[8],c.ColumnNum=l.P[9],c.CreateTime=l.P[10],c.Mark=l.P[11],c.AttrNum=l.An,c.AttrList=[];for(var u=0;u<l.An;++u)c.AttrList[u]={},c.AttrList[u].AttrID=l.Al[u].P[0],c.AttrList[u].Value=l.Al[u].P[1]}}return t}function o(e){if(0==e.E){var t=a(e);if(0===t.TriggerTime)(n=new I).Init(t,t.TriggerTime),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(n);else if(1===t.TriggerTime)(n=new I).Init(t,t.TriggerTime),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(n);else if(2==t.TriggerTime){var n=new B;n.Init(t,!1),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(n)}}}function r(e){if(0==e.E){var t=new P;t.Init(e),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(t)}}function s(e){if(0==e.E)for(var t=e.SD.RemoveObj,n=0;n<t.ObjCnt;++n){var i=t.List[n],a=new w;a.Init(0,i),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(a)}}function l(e){if(0==e.E&&0==e.SD.SA.P[0]){var t=e.SD.SA,n=t.P[2],i=t.P[1],a=new y;a.Init(n,i,0),a.dir=t.P[4],a.seq=t.P[3],window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(a)}}function c(e){if(0==e.E){var t=new _;t.ServerDataToClient(e),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(t)}else C.AssertCheck(0==e.E,"CS_SUB_BATTLE_ATTR_NOTIFY errorcode is "+e.E)}function u(e){if(0==e.E){var t=e.SD.Emotion,n=new R;n.Init(t.EmotionID,t.ObjID),window.GGameEntry.GCmdMgr.AddCmd(n)}}function d(e){if(0==e.E){var t="Server Error Notify: "+e.SD.ErrorNotify.NotifyContent;window.GGameEntry&&window.GGameEntry.UIManager&&window.GGameEntry.UIManager.ShowMsgBox(t)}}function h(e){cc.log("=========>onPayMsgCallback:"),cc.log(e)}function f(e){if(0==e.E){var t=e.SD.ExecBuffEffect,n=t.P[0],i=t.P[1],a=(t.P[2],window.GGameEntry.EntityManager.getEntity(n));a&&a.BuffManager&&a.BuffManager.executeCacheBuff(i)}}cc._RF.push(t,"f37a4MZTtxFM7bh2l06Dqzn","MsgHandler");e("MsgBase"),e("CmdDeleteItem");var m=e("CmdAddBuff"),y=(e("CmdStartGame"),e("GlobalCfg"),e("CmdSkill")),p=(e("NetworkProto"),e("star_comm")),g=e("star_cs"),C=e("Util"),G=e("weixinmsgmgr"),S=e("EntityTypeDefine"),m=e("CmdAddBuff"),E=e("CmdStateSync"),T=e("CmdEffectHurt"),w=e("CmdDeleteObj"),M=e("CmdMovePath"),_=(e("CmdMoveStop"),e("CmdAttr")),I=e("CmdSvrBattleStart"),B=e("CmdSvrBattleGetObj"),v=e("CmdSyncBattleStatistic"),P=e("CmdSvrBattleEndStatistic"),R=e("CmdShowEmoticon"),A=(e("UIManager"),e("ActivityMsgMgr"));t.exports={RegisterMsgHandler:function(){window.GGameEntry.GBattleNetwork.Register(g.CS_CMD_TYPE.CS_SUB_BATTLE_GET_OBJ,i),window.GGameEntry.GBattleNetwork.Register(g.CS_CMD_TYPE.CS_SUB_BATTLE_REMOVE_OBJ,i),window.GGameEntry.GBattleNetwork.Register(g.CS_CMD_TYPE.CS_SUB_BATTLE_SPELL_ACTION,i),window.GGameEntry.GBattleNetwork.Register(g.CS_CMD_TYPE.CS_SUB_BATTLE_MOVE_PATH,i),window.GGameEntry.GBattleNetwork.Register(g.CS_CMD_TYPE.CS_SUB_BATTLE_MOVE_STOP,i),window.GGameEntry.GBattleNetwork.Register(g.CS_CMD_TYPE.CS_SUB_BATTLE_END_NOTIFY,i),window.GGameEntry.GBattleNetwork.Register(g.CS_CMD_TYPE.CS_SUB_BATTLE_EFFECT_NOTIFY,i),window.GGameEntry.GBattleNetwork.Register(g.CS_CMD_TYPE.CS_SUB_BATTLE_STATE_NOTIFY,i),window.GGameEntry.GBattleNetwork.Register(g.CS_CMD_TYPE.CS_SUB_BATTLE_BUFF_OP,i),window.GGameEntry.GBattleNetwork.Register(g.CS_CMD_TYPE.CS_SUB_BATTLE_ATTR_NOTIFY,i),window.GGameEntry.GBattleNetwork.Register(g.CS_CMD_TYPE.CS_SUB_BATTLE_STATISTIC,i),window.GGameEntry.GBattleNetwork.Register(g.CS_CMD_TYPE.CS_SUB_BATTLE_EMOTION,i),window.GGameEntry.GBattleNetwork.Register(g.CS_CMD_TYPE.CS_CMD_ERROR_NOTIFY,i),window.GGameEntry.GBattleNetwork.Register(g.CS_CMD_TYPE.CS_SUB_BATTLE_EXEC_BUFF_EFFECT,i),window.GGameEntry.GBattleNetwork.Register(g.CS_CMD_TYPE.CS_CMD_MIDAS_PAY_TEST,h)},UnRegisterMsgHandler:function(){window.GGameEntry.GBattleNetwork.Unregister(g.CS_CMD_TYPE.CS_SUB_BATTLE_GET_OBJ,i),window.GGameEntry.GBattleNetwork.Unregister(g.CS_CMD_TYPE.CS_SUB_BATTLE_REMOVE_OBJ,i),window.GGameEntry.GBattleNetwork.Unregister(g.CS_CMD_TYPE.CS_SUB_BATTLE_SPELL_ACTION,i),window.GGameEntry.GBattleNetwork.Unregister(g.CS_CMD_TYPE.CS_SUB_BATTLE_MOVE_PATH,i),window.GGameEntry.GBattleNetwork.Unregister(g.CS_CMD_TYPE.CS_SUB_BATTLE_MOVE_STOP,i),window.GGameEntry.GBattleNetwork.Unregister(g.CS_CMD_TYPE.CS_SUB_BATTLE_END_NOTIFY,i),window.GGameEntry.GBattleNetwork.Unregister(g.CS_CMD_TYPE.CS_SUB_BATTLE_EFFECT_NOTIFY,i),window.GGameEntry.GBattleNetwork.Unregister(g.CS_CMD_TYPE.CS_SUB_BATTLE_STATE_NOTIFY,i),window.GGameEntry.GBattleNetwork.Unregister(g.CS_CMD_TYPE.CS_SUB_BATTLE_BUFF_OP,i),window.GGameEntry.GBattleNetwork.Unregister(g.CS_CMD_TYPE.CS_SUB_BATTLE_ATTR_NOTIFY,i),window.GGameEntry.GBattleNetwork.Unregister(g.CS_CMD_TYPE.CS_SUB_BATTLE_STATISTIC,i),window.GGameEntry.GBattleNetwork.Unregister(g.CS_CMD_TYPE.CS_SUB_BATTLE_EMOTION,i),window.GGameEntry.GBattleNetwork.Unregister(g.CS_CMD_TYPE.CS_CMD_ERROR_NOTIFY,i),window.GGameEntry.GBattleNetwork.Unregister(g.CS_CMD_TYPE.CS_CMD_MIDAS_PAY_TEST,h)}},cc._RF.pop()},{ActivityMsgMgr:"ActivityMsgMgr",CmdAddBuff:"CmdAddBuff",CmdAttr:"CmdAttr",CmdDeleteItem:"CmdDeleteItem",CmdDeleteObj:"CmdDeleteObj",CmdEffectHurt:"CmdEffectHurt",CmdMovePath:"CmdMovePath",CmdMoveStop:"CmdMoveStop",CmdShowEmoticon:"CmdShowEmoticon",CmdSkill:"CmdSkill",CmdStartGame:"CmdStartGame",CmdStateSync:"CmdStateSync",CmdSvrBattleEndStatistic:"CmdSvrBattleEndStatistic",CmdSvrBattleGetObj:"CmdSvrBattleGetObj",CmdSvrBattleStart:"CmdSvrBattleStart",CmdSyncBattleStatistic:"CmdSyncBattleStatistic",EntityTypeDefine:"EntityTypeDefine",GlobalCfg:"GlobalCfg",MsgBase:"MsgBase",NetworkProto:"NetworkProto",UIManager:"UIManager",Util:"Util",star_comm:"star_comm",star_cs:"star_cs",weixinmsgmgr:"weixinmsgmgr"}],MsgHit:[function(e,t,n){"use strict";cc._RF.push(t,"a37894S8CZAOqFIIdiHH5/R","MsgHit");var i=e("MsgBase"),a=(e("SkillDefine"),e("CmdSkill"),e("GlobalCfg")),o=e("NetworkProto"),r=e("CmdEffectHurt"),s=e("star_cs"),l=e("Util");cc.Class({extends:i,properties:{entityGUID:{default:0,serializable:!1,visible:!1},skillType:0,skillArg:0,skillSeq:0,dir:0,TargetNum:0,Targets:[],BulletId:0},onLoad:function(){},Send:function(){if(l.BeginSample("MsgHit::Send"),window.GGameEntry.CurGamePlayType===a.GamePlayType.GamePlayType_Single){var e=new r,t=s.CSEffectNotify;t.CasterID=this.entityGUID,t.Total=this.TargetNum,t.Effects={};for(c=0;c<this.TargetNum;c++){var n=s.CSOneEffect();n.ObjID=this.Targets[c],n.EffectType=1,n.EffectData=s.CSEffectHurt(),n.EffectData.Die=1,n.EffectData.Hp=0,t.Effects[c]=n}e.DataToClient(t),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(e)}else if(window.GGameEntry.CurGamePlayType===a.GamePlayType.GamePlayType_Network){if(window.GGameEntry.PlayerManager.MainPlayerGuid!==this.entityGUID)return void console.error("MsgHit error!  Not Main Player");var i=o.GetRequestByID(s.CS_CMD_TYPE.CS_SUB_BATTLE_SPELL_HIT);i.P[0]=this.entityGUID,i.P[1]=this.BulletId,i.P[2]=this.skillSeq,i.P[3]=Math.floor(this.dir),i.Tn=this.TargetNum;for(var c=0;c<this.TargetNum;c++)i.Ts[c]=this.Targets[c];o.SendBattleSvrRequest(0,i)}l.EndSample("MsgHit::Send")}}),cc._RF.pop()},{CmdEffectHurt:"CmdEffectHurt",CmdSkill:"CmdSkill",GlobalCfg:"GlobalCfg",MsgBase:"MsgBase",NetworkProto:"NetworkProto",SkillDefine:"SkillDefine",Util:"Util",star_cs:"star_cs"}],MsgMovePath:[function(e,t,n){"use strict";cc._RF.push(t,"0d9f4ajfo5Mv55QBg3cmUKa","MsgMovePath");var i=e("MsgBase"),a=(e("SkillDefine"),e("CmdSkill"),e("GlobalCfg")),o=e("NetworkProto"),r=e("star_cs"),s=e("CmdMovePath"),l=(e("PlayerManager"),e("Util"));cc.Class({extends:i,properties:{entityGUID:{default:0,serializable:!1,visible:!1},skillType:0,skillArg:0,skillSeq:0,dir:0,PointCnt:0,Time:0,Point:[]},onLoad:function(){},Send:function(){if(l.BeginSample("MsgMovePath::Send"),window.GGameEntry.CurGamePlayType===a.GamePlayType.GamePlayType_Single){var e=new s;e.Init(this.entityGUID,0),e.PointArray=this.Point,e.Dir=this.dir,window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(e)}else if(window.GGameEntry.CurGamePlayType===a.GamePlayType.GamePlayType_Network&&window.GGameEntry.PlayerManager.Player&&this.entityGUID==window.GGameEntry.PlayerManager.Player.GetGuid()){var t=o.GetRequestByID(r.CS_CMD_TYPE.CS_SUB_BATTLE_MOVE_PATH);t.P[0]=this.entityGUID,t.P[1]=Math.floor(this.Point.x),t.P[2]=Math.floor(this.Point.y),t.P[3]=this.Time,t.P[4]=Math.floor(this.Dir),o.SendBattleSvrRequest(0,t)}l.EndSample("MsgMovePath::Send")}}),cc._RF.pop()},{CmdMovePath:"CmdMovePath",CmdSkill:"CmdSkill",GlobalCfg:"GlobalCfg",MsgBase:"MsgBase",NetworkProto:"NetworkProto",PlayerManager:"PlayerManager",SkillDefine:"SkillDefine",Util:"Util",star_cs:"star_cs"}],MsgPickUpItem:[function(e,t,n){"use strict";cc._RF.push(t,"c71baeQSYRJN5oMgpTzrJD7","MsgPickUpItem");var i=e("MsgBase"),a=e("CmdDeleteItem"),o=e("CmdAddBuff"),r=e("GlobalCfg"),s=(e("CmdSkill"),e("NetworkProto")),l=(e("star_comm"),e("star_cs")),c=e("Util");cc.Class({extends:i,properties:{entityGUID:{default:0,serializable:!1,visible:!1},targetGUID:{default:0,serializable:!1,visible:!1},buffID:{default:0,serializable:!1,visible:!1},itemId:{default:0,serializable:!1,visible:!1}},onLoad:function(){},Send:function(){if(c.BeginSample("MsgPickUpItem::Send"),window.GGameEntry.CurGamePlayType===r.GamePlayType.GamePlayType_Single){var e=!1,t=!1;if(2==this.buffID&&(e=!0,t=!0),3==this.buffID&&(t=!0),4==this.buffID&&(e=!0,t=!0),5==this.buffID&&(t=!0),11==this.buffID&&(e=!0,t=!0),17==this.buffID&&(e=!0,t=!0),18==this.buffID&&(t=!0),19!=this.buffID&&20!=this.buffID&&21!=this.buffID&&24!=this.buffID&&25!=this.buffID||(t=!0,e=!0),22==this.buffID&&(e=!0,t=!0),23==this.buffID&&(t=!0),e){var n=new a;n.Init(this.entityGUID,this.targetGUID),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(n)}if(t){var i=new o;i.Init(this.entityGUID,this.buffID),i.BuffOp=1,window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(i)}}else if(window.GGameEntry.CurGamePlayType===r.GamePlayType.GamePlayType_Network){if(window.GGameEntry.PlayerManager.MainPlayerGuid!==this.entityGUID)return void console.error("MsgPickUpItem error!  Not Main Player");var u=s.GetRequestByID(l.CS_CMD_TYPE.CS_SUB_BATTLE_PICK_ITEM);u.ObjID=this.entityGUID,u.ItemID=this.targetGUID,s.SendBattleSvrRequest(0,u)}c.EndSample("MsgPickUpItem::Send")}}),cc._RF.pop()},{CmdAddBuff:"CmdAddBuff",CmdDeleteItem:"CmdDeleteItem",CmdSkill:"CmdSkill",GlobalCfg:"GlobalCfg",MsgBase:"MsgBase",NetworkProto:"NetworkProto",Util:"Util",star_comm:"star_comm",star_cs:"star_cs"}],MsgUseBuff:[function(e,t,n){"use strict";cc._RF.push(t,"163253++gZAaKevBI9hiJXp","MsgUseBuff");var i=e("MsgBase"),a=e("GlobalCfg"),o=e("NetworkProto"),r=(e("star_comm"),e("star_cs")),s=e("Util");cc.Class({extends:i,properties:{BuffResID:0,ObjID:0,EffectIndex:0},Send:function(){if(s.BeginSample("MsgUseBuff::Send"),window.GGameEntry.CurGamePlayType===a.GamePlayType.GamePlayType_Network){if(window.GGameEntry.PlayerManager.MainPlayerGuid!==this.ObjID)return void console.error("MsgEmoticon error!  Not Main Player");var e=o.GetRequestByID(r.CS_CMD_TYPE.CS_SUB_BATTLE_EXEC_BUFF_EFFECT);e.P[0]=this.ObjID,e.P[1]=this.BuffResID,e.P[2]=this.EffectIndex,o.SendBattleSvrRequest(0,e)}s.EndSample("MsgUseBuff::Send")}}),cc._RF.pop()},{GlobalCfg:"GlobalCfg",MsgBase:"MsgBase",NetworkProto:"NetworkProto",Util:"Util",star_comm:"star_comm",star_cs:"star_cs"}],MsgUseSkill:[function(e,t,n){"use strict";cc._RF.push(t,"25ceeddsJZHU5WG87MlxSl+","MsgUseSkill");var i=e("MsgBase"),a=(e("SkillDefine"),e("CmdSkill")),o=e("GlobalCfg"),r=e("NetworkProto"),s=(e("star_comm"),e("star_cs")),l=e("Util");cc.Class({extends:i,properties:{entityGUID:{default:0,serializable:!1,visible:!1},skillType:0,skillArg:0,skillSeq:0,dir:0},onLoad:function(){},Send:function(){if(l.BeginSample("MsgUseSkill::Send"),window.GGameEntry.CurGamePlayType===o.GamePlayType.GamePlayType_Single){var e=new a;e.Init(this.skillType,this.entityGUID,this.skillArg),e.dir=this.dir,window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(e)}else if(window.GGameEntry.CurGamePlayType===o.GamePlayType.GamePlayType_Network){if(window.GGameEntry.PlayerManager.MainPlayerGuid!==this.entityGUID)return void console.error("MsgUseSkill error!  Not Main Player");var t=r.GetRequestByID(s.CS_CMD_TYPE.CS_SUB_BATTLE_SPELL_ACTION);t.P[0]=this.entityGUID,t.P[1]=this.skillType,t.P[2]=this.skillSeq,t.P[3]=Math.floor(this.dir),r.SendBattleSvrRequest(0,t)}l.EndSample("MsgUseSkill::Send")}}),cc._RF.pop()},{CmdSkill:"CmdSkill",GlobalCfg:"GlobalCfg",MsgBase:"MsgBase",NetworkProto:"NetworkProto",SkillDefine:"SkillDefine",Util:"Util",star_comm:"star_comm",star_cs:"star_cs"}],MsgUtil:[function(e,t,n){"use strict";cc._RF.push(t,"2175dfI6SFEULyKtn7aspE8","MsgUtil");e("util"),e("JsonUtils"),e("NetworkProto"),e("GlobalCfg"),e("star_comm"),e("star_cs"),e("weixinmsgmgr"),e("loginConfig"),e("CmdStartGame");t.exports={},cc._RF.pop()},{CmdStartGame:"CmdStartGame",GlobalCfg:"GlobalCfg",JsonUtils:"JsonUtils",NetworkProto:"NetworkProto",loginConfig:"loginConfig",star_comm:"star_comm",star_cs:"star_cs",util:9,weixinmsgmgr:"weixinmsgmgr"}],NetWorkQueue:[function(e,t,n){"use strict";cc._RF.push(t,"dacabkFkmJEb4PB4qXhzpsI","NetWorkQueue");var i=e("loginServerMgr"),a=(e("UIManager"),e("JsonUtils"),e("weixinmsgmgr")),o=(e("GameEntry"),e("BattleNetwork"),e("ResTableNames"));cc.Class({extends:cc.Component,properties:{ContentLabel1:{default:null,type:cc.Label},ContentLabel2:{default:null,type:cc.Label},ContentLabel3:{default:null,type:cc.Label},CancelBtn:{default:null,type:cc.Button}},onEnable:function(){},update:function(e){if(window.GGameEntry&&window.GGameEntry.GBattleNetwork&&window.GGameEntry.GBattleNetwork.connector){var t=window.GGameEntry.GBattleNetwork.connector;this.ContentLabel1.node.active=!0,this.ContentLabel2.node.active=!0,this.ContentLabel3.node.active=!0;var n=window.GGameEntry.ResTableMgr.GetConfigByID(o.star_client_c,67).Context,i=window.GGameEntry.ResTableMgr.GetConfigByID(o.star_client_c,68).Context,a=window.GGameEntry.ResTableMgr.GetConfigByID(o.star_client_c,69).Context;this.ContentLabel1.string=n,this.ContentLabel2.string=i+t.queuePos+" / "+t.queueTotal;var r=a,s=Math.floor(t.rough_time/3600),l=t.rough_time-3600*s;l=Math.floor(l/60);var c=t.rough_time-3600*s-60*l;s>0&&(r+=s+"小时"),r+=l+"分钟",r+=c+"秒",this.ContentLabel3.string=r}else{this.ContentLabel1.node.active=!1,this.ContentLabel2.node.active=!0,this.ContentLabel3.node.active=!1;var u=window.GGameEntry.ResTableMgr.GetConfigByID(o.star_client_c,70).Context;this.ContentLabel2.string=u}},OnCanelBtnClick:function(){a.onHideLoadingState(),i.onSetInviteInfo({}),window.GGameEntry&&window.GGameEntry.GBattleNetwork&&window.GGameEntry.GBattleNetwork&&window.GGameEntry.GBattleNetwork.Disconnect(),window.GGameEntry.NotificationCenter.emit("CancelNetQueue")}}),cc._RF.pop()},{BattleNetwork:"BattleNetwork",GameEntry:"GameEntry",JsonUtils:"JsonUtils",ResTableNames:"ResTableNames",UIManager:"UIManager",loginServerMgr:"loginServerMgr",weixinmsgmgr:"weixinmsgmgr"}],NetworkConnector:[function(e,t,n){"use strict";cc._RF.push(t,"53a29xrxENM4IPEZHijhIqX","NetworkConnector");var i=e("NetworkStatus"),a=e("Container"),o=e("JsonUtils"),r=(e("Util"),e("star_cs")),s=e("star_macro"),l=e("UIManager"),c=e("weixininterface"),u=(e("loginServerMgr"),e("weixinmsgmgr")),d=e("GlobalCfg"),h=e("ResTableNames");cc.Class({canShowQueueTips:!1,init:function(e){this.network=e,this.name=e.name,this.status=i.Status.NotConnect,this.recvQueue=new a.CircularQueue(1024),this.serverClose=!1,this.ws=null,this.queuePos=-1,this.queueTotal=-1,this.rough_time=-1},connect:function(e){null!==this.ws&&this.close();var t=new WebSocket(e);t.binaryType="arraybuffer",t.onopen=this.onSocketOpen.bind(this),t.onerror=this.onSocketError.bind(this),t.onmessage=this.onSocketMessage.bind(this),t.onclose=this.onSocketClose.bind(this),this.serverClose=!1,this.ws=t,this.status=i.Status.Connecting},close:function(){null!==this.ws&&(this.ws.onopen=null,this.ws.onerror=null,this.ws.onmessage=null,this.ws.onclose=null,this.ws.close()),this.recvQueue.clear(),this.ws=null,this.status=i.Status.NotConnect,this.queuePos=-1,this.queueTotal=-1,this.rough_time=-1,!0===this.canShowQueueTips&&window.GGameEntry&&window.GGameEntry.UIManager&&window.GGameEntry.UIManager.HideUI(l.UIType.NetWorkQueue)},send:function(e){var t="string"!=typeof e?o.SafeStringify(e):e;t+="\0",this.ws.send(t)},recv:function(){return this.recvQueue.pop()},getURL:function(){return this.ws?this.ws.url:void 0},onSocketOpen:function(e){console.log("[websocket.onSocketOpen][%s] socket open: %s.",this.name,e),!0===this.canShowQueueTips&&console.log("canShowQueueTips onSocketOpen")},onSocketError:function(e){console.error("[websocket.onSocketError][%s] socket error: %s.",this.name,e),console.error(e),this.status=i.Status.NotConnect,!0===this.canShowQueueTips&&console.log("canShowQueueTips onSocketError")},onSocketMessage:function(t){var n=e("Util");if(n.BeginSample("NetWorkConnector::onSocketMessage"),t.data instanceof ArrayBuffer){var i=new Uint8Array(t.data);0===i[i.length-1]&&(i=i.subarray(0,i.length-1));var a="",o=i.length;if(o>500){var r=Math.floor(o/4);r+=o-4*r;for(var s=new Array(r),l=0,c=0;c<o;)if(c+4<o){u=String.fromCharCode(i[c],i[c+1],i[c+2],i[c+3]);s[l++]=u,c+=4}else{var u=String.fromCharCode(i[c]);s[l++]=u,c+=1}a=s.join("")}else a=String.fromCharCode.apply(null,i);this.handleSvrNotify(a)}else this.handleTwsNotify(t.data);n.EndSample("NetWorkConnector::onSocketMessage")},onSocketClose:function(e){console.log("[websocket.onSocketClose][%s] socket close: %s.",this.name,e),this.status=i.Status.NotConnect,!0===this.canShowQueueTips&&console.log("canShowQueueTips onSocketClose")},handleSvrNotify:function(e){var t=o.SafeParse(e);if(t.C===r.CS_CMD_TYPE.CS_CMD_AUTH_RESULT){if(0===t.E)this.status=i.Status.Connected,this.network.ConnectedNotify();else if(t.E===s.RET_CODE.RET_CODE_DB_QUERY_NOT_FOUND||t.E===s.RET_CODE.RET_CODE_TOKEN_DIFF_IN_SVR_AUTH)u.initLoginInfo("",""),console.log("onSocketMessage:"),this.network.clearSendBuf(),c.onWXAuthorize();else if(t.E===s.RET_CODE.RET_CODE_LOGIN_BAN_ON_SVR_AUTH){this.network.clearSendBuf();var n=this.formatSeconds(t.SD.AuthResult.L),a=new Date(1e3*t.SD.AuthResult.B),l=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate(),f=window.GGameEntry.ResTableMgr.GetConfigByID(h.star_client_c,57).Context,m=window.GGameEntry.StringFormat(f,l,n);window.GGameEntry.UIManager.ReturnLogoUI(m),u.onHideLoadingState()}else if(this.network.clearSendBuf(),u.onHideLoadingState(),window.GGameEntry.CurGamePlayType===d.GamePlayType.GamePlayType_Network){m="登录异常("+t.E+")";if(t.E===s.RET_CODE.RET_CODE_LOGIN_LIMIT_ON_SVR_AUTH){f=window.GGameEntry.ResTableMgr.GetConfigByID(h.star_client_c,58).Context;m=window.GGameEntry.StringFormat(f,t.E)}window.GGameEntry.UIManager.ReturnLogoUI(m)}}else if(t.C===r.CS_CMD_TYPE.CS_CMD_DISCONNECTED)if(t.E===s.RET_CODE.RET_CODE_IDLE_TOO_LONG){if(window.GGameEntry.BattleSystem.IsPlaying()||window.GGameEntry.BattleSystem.IsPause()||window.GGameEntry.BattleSystem.IsMapLoading()){this.serverClose=!0;var f=window.GGameEntry.ResTableMgr.GetConfigByID(h.star_client_c,t.E).Context,m=window.GGameEntry.StringFormat(f,t.E);window.GGameEntry.UIManager.ReturnLogoUI(m)}}else this.recvQueue.push(e);else this.recvQueue.push(e)},formatSeconds:function(e){var t=parseInt(e),n=0,i=0,a=0;t>60&&(n=parseInt(t/60),t=parseInt(t%60),n>60&&(i=parseInt(n/60),n=parseInt(n%60),i>24&&(a=parseInt(i/24),i=parseInt(i%24))));var o="";return t>0&&(o=parseInt(t)+"秒"),n>0&&(o=parseInt(n)+"分"+o),i>0&&(o=parseInt(i)+"小时"+o),a>0&&(o=parseInt(a)+"天"+o),o},handleTwsNotify:function(e){var t=o.SafeParse(e);if(t&&t.tws_notify_type){!0===this.canShowQueueTips&&console.log("canShowQueueTips handleTwsNotify"),console.log("[websocket.parseTwsNotify][%s] notify: %s.",this.name,e);var n=!1;"pass"===t.tws_notify_type?(this.status=i.Status.Connecting,console.log("[websocket.parseTwsNotify][%s] Connecting.",this.name)):"close"===t.tws_notify_type?(this.status=i.Status.NotConnect,window.GGameEntry.BattleSystem.IsPlaying()||window.GGameEntry.BattleSystem.IsPause()||window.GGameEntry.BattleSystem.IsMapLoading()||window.GGameEntry.BattleSystem.IsInRooming()||(this.serverClose=!0),console.log("[websocket.parseTwsNotify][%s] not connected, reason: %s, excode: %d, detail: %s.",this.name,t.reason,t.excode,t.detail)):"queue"===t.tws_notify_type?(console.log("[websocket.parseTwsNotify][%s] queue, pos: %d / %d, rough time: %d.",this.name,t.pos,t.total,t.rough_time),this.queuePos=t.pos,this.queueTotal=t.total,this.rough_time=t.rough_time,n=!0):(this.status=i.Status.NotConnect,window.GGameEntry.BattleSystem.IsPlaying()||window.GGameEntry.BattleSystem.IsPause()||window.GGameEntry.BattleSystem.IsMapLoading()||window.GGameEntry.BattleSystem.IsInRooming()||(this.serverClose=!0),console.log("[websocket.parseTwsNotify][%s] not connected.",this.name)),!0===this.canShowQueueTips&&window.GGameEntry&&window.GGameEntry.UIManager&&(!0===n?window.GGameEntry.UIManager.ShowUI(l.UIType.NetWorkQueue,l.UIOrder.Top+100):window.GGameEntry.UIManager.HideUI(l.UIType.NetWorkQueue))}else console.warn("[websocket.parseTwsNotify][%s] invalid notify: %s.",this.name,e)},update:function(){this.status,i.Status.Connected}}),cc._RF.pop()},{Container:"Container",GlobalCfg:"GlobalCfg",JsonUtils:"JsonUtils",NetworkStatus:"NetworkStatus",ResTableNames:"ResTableNames",UIManager:"UIManager",Util:"Util",loginServerMgr:"loginServerMgr",star_cs:"star_cs",star_macro:"star_macro",weixininterface:"weixininterface",weixinmsgmgr:"weixinmsgmgr"}],NetworkHeartbeat:[function(e,t,n){"use strict";cc._RF.push(t,"df7ce5ucIJADq/fq6pU3GGe","NetworkHeartbeat");var i,a=e("star_cs");cc.Class({ctor:function(){i=this},init:function(e){this.network=e,this.sendTick=0,this.recvTick=0,this.duration=3e3,this.msg={C:22,H:[0,0],CD:{HB:{T:0}}},this.network.Register(this.msg.C,this.onResponse)},update:function(){if(this.network.IsConnected()){var e=Date.now();e-this.sendTick>this.duration&&(this.msg.CD.HB.T=e,this.msg.V=a.ProtoVersion,this.network.Request(this.msg),this.sendTick=e,0===this.recvTick&&(this.recvTick=this.sendTick))}},onResponse:function(e){window.GGameEntry.NotificationCenter.emit("HeartResponse",{serverTime:e.SD.HB.T[1]}),window.GGameEntry.TimeSystem.SyncSvrTime(e.SD.HB.T[1]),i.recvTick=Date.now()},onResetRecvTick:function(e){this.recvTick=e}}),cc._RF.pop()},{star_cs:"star_cs"}],NetworkProto:[function(e,t,n){"use strict";function i(){s=[]}function a(e,t,n,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=r.CSMsgC;s.V=r.ProtoVersion,s.C=n.__msgid__,delete n.__msgid__,s.CD=new r.CSDataC(s.C);for(var l in s.CD)s.CD[l]=n;window.GGameEntry.GGameNetwork.Request(e,s,i,a),o(n),o(s)}function o(e){for(var t in e)"number"==typeof e[t]?e[t]=0:"string"==typeof e[t]?e[t]="":e[t]instanceof Array?e[t]=[]:e[t]instanceof Object?e[t]=null:e[t]=0}cc._RF.push(t,"56f41hnb4lNbLvlzxEawrIU","NetworkProto");var r=e("star_cs"),s=[];t.exports={GetRequestByID:function(e){return r.GetMsgCByID(e)},SendGameSvrRequest:a,SendBattleSvrRequest:function(t,n){var i=e("Util");i.BeginSample("SendBattleSvrRequest");var a=r.CSMsgC;a.V=r.ProtoVersion,a.C=n.__msgid__,delete n.__msgid__,a.CD=new r.CSDataC(a.C);for(var s in a.CD)a.CD[s]=n;window.GGameEntry.GBattleNetwork.Request(a),o(n),o(a),i.EndSample("SendBattleSvrRequest")},PushGameSvrMsg:function(t,n,o,r){var l=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(""!==e("weixinmsgmgr").getOpenID())s.length>0?!0===l?console.log("PushGameSvrMsg msg has been throw ",o):(console.error("PushGameSvrMsg msg has other msg in queue.",o),a(t,n,o,r,l)):(console.log("PushGameSvrMsg has no msg, send."),a(t,n,o,r,l));else{if(s.length>0){if(!0===l)return void console.log("PushGameSvrMsg no openid msg has been throw ",o);console.error("PushGameSvrMsg no openid msg has other msg in queue."),i()}var c=new Object;c.url=t,c.uin=n,c.msg=o,c.callback=r,c.bweek=l,console.log("PushGameSvrMsg no openid ",c),s.push(c);var u=e("weixininterface");if(e("PlatformUtil").IsWeichatGame())u.onWXLogin();else{var d=window.localStorage.getItem("uuid");null===d&&(d=loginConfig.getRandomNum(1,1e8),window.localStorage.setItem("uuid",d)),e("loginServerMgr").onLogin(d.toString())}}},SendLoginSuccessGameSvrMsg:function(){if(s.length>0){var t=s.shift();a(e("loginConfig").getShortSocketURL(),t.uin,t.msg,t.callback,t.bweek)}}},cc._RF.pop()},{PlatformUtil:"PlatformUtil",Util:"Util",loginConfig:"loginConfig",loginServerMgr:"loginServerMgr",star_cs:"star_cs",weixininterface:"weixininterface",weixinmsgmgr:"weixinmsgmgr"}],NetworkStatus:[function(e,t,n){"use strict";cc._RF.push(t,"b864bwqMiJBmL6TZ97HM2JD","NetworkStatus");var i={NotConnect:0,Connecting:1,Connected:2};t.exports={Status:i},cc._RF.pop()},{}],NetworkUtils:[function(e,t,n){"use strict";cc._RF.push(t,"f8fa3cAV11HRLIt1IMjO39Z","NetworkUtils"),t.exports={IsValidUrl:function(e){return"string"==typeof e&&/(^ws:\/\/)|(^wss:\/\/)/.test(e)},FormatErrorCode:function(e){return""}},cc._RF.pop()},{}],NetworkWatchdog:[function(e,t,n){"use strict";cc._RF.push(t,"1a71eHfTYFCwqFBtjNSp6b1","NetworkWatchdog");cc.Class({init:function(e){this.network=e,this.retryTick=0,this.retryCount=0},update:function(){if(this.network.IsConnected()||this.network.IsConnecting()||void 0===this.network.connector.getURL())this.network.IsConnected()&&(this.retryCount=0);else{var e=Date.now();e-this.retryTick>5e3&&!1===this.network.connector.serverClose&&(this.retryCount++,this.network.Reconnect(),this.retryTick=e)}},getRetrycount:function(){return this.retryCount},resetRetrycount:function(){this.retryCount=0}}),cc._RF.pop()},{}],Network:[function(e,t,n){"use strict";cc._RF.push(t,"64451N2D9xI95VKd0aERAcZ","Network");var i=e("NetworkStatus");cc.Class({ctor:function(){this.connectedCallback=null,this.pauseRecvMsg=!1},Init:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.connectedCallback=e,this.pauseRecvMsg=!1},Status:function(){return this.connector?this.connector.status:i.Status.NotConnect},IsConnecting:function(){return this.connector&&this.connector.status===i.Status.Connecting},IsConnected:function(e){return this.connector&&this.connector.status===i.Status.Connected&&(!e||this.connector.url===e)},ConnectedNotify:function(){null!==this.connectedCallback&&this.connectedCallback()},PauseRecvMsg:function(e){this.pauseRecvMsg=e}}),cc._RF.pop()},{NetworkStatus:"NetworkStatus"}],NewRecordUI:[function(e,t,n){"use strict";cc._RF.push(t,"4d7993rGYlIw4hLgtfrPMIn","NewRecordUI");var i=e("loginServerMgr"),a=(e("weixinmsgmgr"),e("SimpleLabel")),o=e("UIManager"),r=e("ResTableNames"),s=(e("Util"),e("QunUserDataMgr"));cc.Class({extends:cc.Component,properties:{shareBtn:{default:null,type:cc.Node},pentagon:{default:null,type:cc.Node},scorePanel:{default:null,type:cc.Node},staticPoints:{default:[],type:cc.Node},dataPoints:{default:[],type:cc.Node},centerPoint:{default:null,type:cc.Node},backBtn:{default:null,type:cc.Node},scoreLabel:{default:null,type:a},winRate:{default:null,type:a},totalCount:{default:null,type:a},battleScore:{default:null,type:a},topLimit:{default:[],visible:!1},averHurt:{default:null,type:cc.Label},averMulKill:{default:null,type:cc.Label},averBroke:{default:null,type:cc.Label},averHill:{default:null,type:cc.Label},averKill:{default:null,type:cc.Label},titleLabel:{default:null,type:cc.Node},contentRight:{default:null,type:cc.Node},bottomLabel:{default:null,type:cc.Node},QRCode:{default:null,type:cc.Node},shareLabel:{default:null,type:cc.Node}},onEnable:function(){window.GGameEntry.fromLogoUIQR?(this.titleLabel.active=!1,this.contentRight.active=!1,this.bottomLabel.active=!1,this.QRCode.active=!0,this.shareLabel.active=!0):(this.titleLabel.active=!0,this.contentRight.active=!0,this.bottomLabel.active=!0,this.QRCode.active=!1,this.shareLabel.active=!1),this.shareBtn.on(cc.Node.EventType.TOUCH_START,this.onShareBtn,this),this.initData();var e=this.calculatePoints(),t=this.pentagon.getComponent("RadarUI");t&&e&&t.SetMesh(e)},initData:function(){if(0==this.topLimit.length&&this.setTopLimit(),this.recordData=i.onGetPlayerResultInfo(),this.recordData){this.recordData;if(this.totalCount.SetString(this.recordData.GameCount.toString()),0==this.recordData.GameCount)this.winRate.SetString("0");else{var e=parseInt(100*this.recordData.WinGameCount/this.recordData.GameCount);console.error("winCount: "+this.recordData.WinGameCount+" totalCount "+this.recordData.GameCount),this.winRate.SetString(e.toString())}var t=s.GetUserBattleValue(this.recordData.GameCount,this.recordData.WinGameCount);this.battleScore.SetString(parseInt(t).toString())}},setTopLimit:function(){for(var e=49;e<54;e++){var t=parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(r.star_global_cs,e).Value);this.topLimit.push(t)}},onDisable:function(){this.shareBtn.off(cc.Node.EventType.TOUCH_START,this.onShareBtn,this)},onShareBtn:function(){},onBackBtn:function(){window.GGameEntry.fromLogoUIQR=!1,window.GGameEntry.UIManager.HideUI(o.UIType.RecordUI)},testPoints:function(){var e=new Array;e.push(Math.random()),e.push(Math.random()),e.push(Math.random()),e.push(Math.random()),e.push(Math.random()),this.setDataLabel(e);for(var t=new Array,n=0;n<this.staticPoints.length;n++){var i=(this.staticPoints[n].position.x-this.centerPoint.x)*e[n],a=(this.staticPoints[n].position.y-this.centerPoint.y)*e[n];t.push({x:this.centerPoint.position.x+i,y:this.centerPoint.position.y+a}),this.dataPoints[n].setPosition(cc.p(t[n].x,t[n].y))}return t},calculatePoints:function(){if(null==this.recordData)return null;var e=new Array;if(0==this.recordData.GameCount)for(i=0;i<5;i++)e.push(0);else e.push(this.recordData.AttackTankDmg/this.recordData.GameCount),e.push(this.recordData.KillContinueCount/this.recordData.GameCount),e.push(this.recordData.KillBrickCount/this.recordData.GameCount),e.push(this.recordData.AddHPToTeamCount/this.recordData.GameCount),e.push(this.recordData.KillCount/this.recordData.GameCount);var t=new Array;t.push(e[0]/this.topLimit[0]),t.push(e[1]/this.topLimit[1]),t.push(e[2]/this.topLimit[2]),t.push(e[3]/this.topLimit[3]),t.push(e[4]/this.topLimit[4]);for(i=0;i<t.length;i++)t[i]>1&&(t[i]=1);this.setDataLabel(t);for(var n=new Array,i=0;i<this.staticPoints.length;i++){var a=(this.staticPoints[i].position.x-this.centerPoint.x)*t[i],o=(this.staticPoints[i].position.y-this.centerPoint.y)*t[i];n.push({x:this.centerPoint.position.x+a,y:this.centerPoint.position.y+o}),this.dataPoints[i].setPosition(cc.p(n[i].x,n[i].y))}return n},setDataLabel:function(e){var t=new Array;t.push((5*e[0]).toFixed(1)),t.push((5*e[1]).toFixed(1)),t.push((5*e[2]).toFixed(1)),t.push((5*e[3]).toFixed(1)),t.push((5*e[4]).toFixed(1)),this.averHurt.string=t[0].toString(),this.averMulKill.string=t[1].toString(),this.averBroke.string=t[2].toString(),this.averHill.string=t[3].toString(),this.averKill.string=t[4].toString();var n=this.recordData.GameCount>250?250:this.recordData.GameCount,i=.3*t[0]+.2*t[1]+.2*t[2]+.2*t[3]+.3*t[4]+n/50;this.scoreLabel.SetString(i.toFixed(0).toString())}}),cc._RF.pop()},{QunUserDataMgr:"QunUserDataMgr",ResTableNames:"ResTableNames",SimpleLabel:"SimpleLabel",UIManager:"UIManager",Util:"Util",loginServerMgr:"loginServerMgr",weixinmsgmgr:"weixinmsgmgr"}],NormalAttackSkill:[function(e,t,n){"use strict";cc._RF.push(t,"abb61QRAyJIbKjwrCZajo8N","NormalAttackSkill");var i=e("Skill"),a=e("Util");cc.Class({extends:i,properties:{},onLoad:function(){},UseSkill:function(e){var t=a.BeginSample("NormalAttackSkill::UseSkill");this.EntitySource&&this.EntitySource.Shoot(e),a.EndSample(t)}}),cc._RF.pop()},{Skill:"Skill",Util:"Util"}],OtherPlayer:[function(e,t,n){"use strict";cc._RF.push(t,"ce933Y3d7dA7axE4tKcOGh+","OtherPlayer");e("MapCfg");var i=e("Util"),a=(e("GameEntry"),e("EntityBase"),e("EntityTypeDefine"),e("TankAttr"),e("CmdBase"),e("CmdDefine"),e("SkillDefine"),e("CmdSkill"),e("MsgUseSkill"),e("TankBase"),e("PlayerManager"),e("PlayerAnimationCtrl"),e("NormalAttackSkill"),e("PickBufferSkill"),e("BattleDef"),e("star_comm"),e("PlayerBase")),o=(e("Player"),e("PlayerSimulateMove")),r=e("PlayerSimulatePoint"),s=e("ResTableNames"),l=e("TankMisc"),c=e("ResCfgDef");cc.Class({extends:a,properties:{},onLoad:function(){this._super()},onDestroy:function(){},start:function(){},Reset:function(){this._super(),this.Hp=this.MaxHp},Init:function(e){this._super(e)},InitEventAndAni:function(e){},InitWithServerData:function(e,t){this._super(e,t),this.SetPlayerDataUsingServerData(t),window.GGameEntry.PlayerManager.Player&&this.setModelSprite()},UnInit:function(){},Release:function(){},PaoTaiMove:function(e){var t=e.detail.angle;t<0&&(t+=360),t>=360&&(t%=360),this.PaoTaiNode.rotation=t<90?90-t:t>=90&&t<180?180-t+270:t>=180&&t<270?270-t+180:360-t+90},SetRotate:function(e){var t=Math.cos(.01745*e),n=Math.sin(.01745*e);this.MoveSpeed.x=(this.CfgSourceConfigSpeed+this.MoveSpeedBonus.x)*t,this.MoveSpeed.y=(this.CfgSourceConfigSpeed+this.MoveSpeedBonus.y)*n,this.UpdateDirectionArrow(e)},PlayerStopMove:function(){this.DirectionX=0,this.DirectionY=0,this.MoveSpeed.x=0,this.MoveSpeed.y=0},OnDie:function(){if(!this.DeadAni){var e=i.BeginSample("OtherPlayer::OnDie");window.GGameEntry.SoundManager.PlayPlayerDie(this.node.position),this.LastHitByEntity?window.GGameEntry.NotificationCenter.emit("OtherPlayerDie",{campType:this.EntityCampType,lineType:this.EntityLineType,guid:this.Guid,hitCampType:this.LastHitByEntity.EntityCampType,hitLineType:this.LastHitByEntity.EntityLineType,hitGuid:this.LastHitByEntity.Guid}):window.GGameEntry.NotificationCenter.emit("OtherPlayerDie",{campType:this.EntityCampType,lineType:this.EntityLineType,guid:this.Guid,hitCampType:0,hitLineType:0,hitGuid:0}),this._super(),this.DeadAni=!0,this.PlayerStopMove(),this.node.stopAllActions(),this.playerSimulateMove&&(this.playerSimulateMove.relase(),this.playerSimulateMove=null),i.EndSample(e)}},_DoDieAction:function(){this.node.x=1e5,this.node.y=1e5},OnPause:function(){this.Pause=!0,cc.director.getScheduler().pauseTarget(this)},OnResume:function(){this.Pause=!1,cc.director.getScheduler().resumeTarget(this)},InvincibleTimeout:function(){this.node.opacity=255,this.Invincible=!1},BecomeInvincible:function(e){this.HasLightningItem||(this.Invincible&&this.unschedule(this.InvincibleTimeout),this.Invincible=!0,this.node.opacity=128,this.schedule(this.InvincibleTimeout,e,0))},StopInvincible:function(){this.Invincible=!1,this.unschedule(this.InvincibleTimeout),this.node.opacity=255,this.Invincible=!1},Shoot:function(e){if(0!=this.node.active){var t=i.BeginSample("OtherPlayer::Shoot");this._super()&&this.TankUI.OnShootBullet(this.CurrentBulletLeftNum),i.EndSample(t)}},setPosAndDir:function(e,t,n){if(!this.DeadAni){var a=i.BeginSample("OtherPlayer::setPosAndDir"),l=this.node.position;if(this.canWalkDynamicObject(e)){if(parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(s.star_global_cs,29).Value)){window.GGameEntry.PlayerManager.pvPInfo.setRecTime(n);var c=new r;c.pos=cc.v2(e.x,e.y),c.dwTimeStamp=n,this.playerSimulateMove||(this.playerSimulateMove=new o,this.playerSimulateMove.init(c.pos)),this.playerSimulateMove.insertMovePoint(c,t)}else e=this.outsideTest(e),this.node.setPosition(e);window.GGameEntry.MapManager.UpdateDynamicEntityFlag(this,l.x,l.y,!1)}i.EndSample(a)}},setPosAndClearSitum:function(){this.playerSimulateMove&&this.playerSimulateMove.setPosAndClearSitum(this)},setModelSprite:function(){var e=i.BeginSample("OtherPlayer::setModelSprite"),t=window.GGameEntry.ResTableMgr.GetConfigByID(s.star_bullet_cs,this.ShootBulletId);if(t){var n;this.EntityCampType===window.GGameEntry.PlayerManager.Player.EntityCampType?(this.TankHpControl.children[0].active=!0,this.TankHpControl.children[1].active=!1,n=t.BlueFort):(this.TankHpControl.children[0].active=!1,this.TankHpControl.children[1].active=!0,n=t.RedFort),this.Sprite1Change.spriteFrame=this.SpAtlas.getSpriteFrame(n)}i.EndSample(e)},update:function(e){if(!this.Pause){var t=i.BeginSample("OtherPlayer::update");if(this._super(e),window.GGameEntry.ResManager.GetProgramEffCfg(c.ProgramEffType.TankChangeMode)===c.PETankChangeMode.Y&&this.setModelSprite(),this.playerSimulateMove)if(this.tankGamingStateType!==l.TankGamingStateType.TankGamingState_Skill_Flash){var n=this.node.position,a=this.playerSimulateMove.getSimulatorPos();n.x===a.x&&n.y===a.y||this.canWalkDynamicObject(cc.v2(a.x,a.y))&&(this.node.setPosition(a),this.rotateAll(this.playerSimulateMove.getSimulatorRotate()),window.GGameEntry.MapManager.UpdateDynamicEntityFlag(this,n.x,n.y,!1)),this.playerSimulateMove.updateSimulator()}else this.playerSimulateMove.clearSimulatorPos(),this.playerSimulateMove.setSimulatorPos(this.node.position.x,this.node.position.y);i.EndSample(t)}}}),cc._RF.pop()},{BattleDef:"BattleDef",CmdBase:"CmdBase",CmdDefine:"CmdDefine",CmdSkill:"CmdSkill",EntityBase:"EntityBase",EntityTypeDefine:"EntityTypeDefine",GameEntry:"GameEntry",MapCfg:"MapCfg",MsgUseSkill:"MsgUseSkill",NormalAttackSkill:"NormalAttackSkill",PickBufferSkill:"PickBufferSkill",Player:"Player",PlayerAnimationCtrl:"PlayerAnimationCtrl",PlayerBase:"PlayerBase",PlayerManager:"PlayerManager",PlayerSimulateMove:"PlayerSimulateMove",PlayerSimulatePoint:"PlayerSimulatePoint",ResCfgDef:"ResCfgDef",ResTableNames:"ResTableNames",SkillDefine:"SkillDefine",TankAttr:"TankAttr",TankBase:"TankBase",TankMisc:"TankMisc",Util:"Util",star_comm:"star_comm"}],PVPChangTeamUI:[function(e,t,n){"use strict";cc._RF.push(t,"7d2f6j/WLZFtronwzDoFELi","PVPChangTeamUI");e("Util"),e("PlatformUtil"),e("JsonUtils");var i=e("UIManager");e("loginServerMgr"),e("weixininterface"),e("MsgUtil"),e("GlobalCfg");cc.Class({extends:cc.Component,properties:{},onLoad:function(){},onEnable:function(){},onDisable:function(){},OnSureBtn:function(){window.GGameEntry.UIManager.HideUI(i.UIType.PVPChangeTeamUI),window.GGameEntry.UIManager.ShowUI(i.UIType.PVPMakeTeamUI),window.GGameEntry.NotificationCenter.emit("onTipsMsg",{Object:i.UIType.PVPChangeTeamUI})},OnRefuseBtn:function(){window.GGameEntry.UIManager.HideUI(i.UIType.PVPChangeTeamUI),window.GGameEntry.UIManager.ShowUI(i.UIType.PVPMakeTeamUI)},update:function(e){}}),cc._RF.pop()},{GlobalCfg:"GlobalCfg",JsonUtils:"JsonUtils",MsgUtil:"MsgUtil",PlatformUtil:"PlatformUtil",UIManager:"UIManager",Util:"Util",loginServerMgr:"loginServerMgr",weixininterface:"weixininterface"}],PVPExitTeamUI:[function(e,t,n){"use strict";cc._RF.push(t,"7471aC80DxDNZ2QV22IbAhO","PVPExitTeamUI");e("Util");var i=e("PlatformUtil"),a=e("JsonUtils"),o=e("UIManager"),r=e("loginServerMgr"),s=e("weixininterface"),l=(e("MsgUtil"),e("GlobalCfg")),c=e("GameMode"),u=e("ResTableNames");cc.Class({extends:cc.Component,properties:{TipsLabel:{default:null,type:cc.Label},UIBtn:{default:[],type:cc.Button},TitleLabel:{default:null,type:cc.Label},ExitRoomFlag:{default:!0,type:cc.Boolean},SingleBattleFlag:{default:!1,type:cc.Boolean},BlueBtnSpr:{default:null,type:cc.SpriteFrame},OrangeBtnSpr:{default:null,type:cc.SpriteFrame},GreyBtnSpr:{default:null,type:cc.SpriteFrame}},onLoad:function(){},onEnable:function(){if(this.ExitRoomFlag=!0,this.SingleBattleFlag=!1,r.onGetServerErrMsgCount()>0){var e=a.SafeParse(r.onGetServerErrMsg());console.log("OnSingleSureBtn "+e.msg+" type:"+e.type),2===e.type&&(this.ExitRoomFlag=!1),this.TipsLabel.string=e.msg,this.TitleLabel.string="提示",this.UIBtn[0].node.active=!1,this.UIBtn[1].node.active=!1,this.UIBtn[2].node.active=!0,3===e.type&&(this.SingleBattleFlag=!0,this.UIBtn[0].node.active=!0,this.UIBtn[1].node.active=!0,this.UIBtn[2].node.active=!1)}else{var t=window.GGameEntry.ResTableMgr.GetConfigByID(u.star_client_c,71).Context,n=window.GGameEntry.ResTableMgr.GetConfigByID(u.star_client_c,72).Context;this.TipsLabel.string=t,this.TitleLabel.string=n,this.UIBtn[0].node.active=!0,this.UIBtn[1].node.active=!0,this.UIBtn[2].node.active=!1}this.EnableSureBtn(!0),this.EnableCancelBtn(!0),window.GGameEntry.NotificationCenter.on("LeaveRoomState",this.LeaveRoomState,this)},onDisable:function(){window.GGameEntry.NotificationCenter.off("LeaveRoomState",this.LeaveRoomState,this)},LeaveRoomState:function(e){var t=e.detail.flag;if(window.GGameEntry.BattleSystem.IsInRooming()&&!1===t&&"0"===r.onGetRoomGuid())return console.log("PVPExitTeamUI LeaveRoomState."),window.GGameEntry.UIManager.HideUI(o.UIType.PVPExitTeamUI),window.GGameEntry.UIManager.HideUI(o.UIType.PVPMakeTeamUI),void window.GGameEntry.UIManager.ShowUI(o.UIType.LogoUI);t||this.EnableUIBtn(!0)},EnableSureBtn:function(e){e?(this.UIBtn[0].interactable=!0,this.UIBtn[0].getComponent(cc.Sprite).spriteFrame=this.OrangeBtnSpr,this.UIBtn[0].getComponentInChildren(cc.Label).node.color=new cc.Color(99,25,25)):(this.UIBtn[0].interactable=!1,this.UIBtn[0].getComponent(cc.Sprite).spriteFrame=this.GreyBtnSpr,this.UIBtn[0].getComponentInChildren(cc.Label).node.color=new cc.Color(0,0,0)),this.EnableBtnScaler(e,this.UIBtn[0])},EnableCancelBtn:function(e){e?(this.UIBtn[1].interactable=!0,this.UIBtn[1].getComponent(cc.Sprite).spriteFrame=this.BlueBtnSpr):(this.UIBtn[1].interactable=!1,this.UIBtn[1].getComponent(cc.Sprite).spriteFrame=this.GreyBtnSpr),this.EnableBtnScaler(e,this.UIBtn[1])},EnableUIBtn:function(e){this.EnableCancelBtn(e),this.EnableSureBtn(e)},EnableBtnScaler:function(e,t){var n=t.node.getComponent("ButtonScaler");n&&(n.enabled=!!e)},checkRepeatMsg:function(){for(var e=[];r.onGetServerErrMsgCount()>0;){var t=r.onGetServerErrMsg(),n=a.SafeParse(t);if(n){var i=n.msg;i&&i!=this.TipsLabel.string&&e.push(t)}}for(var o=0;o<e.length;o++)r.onPushRawErrMsg(e[o])},OnSureBtn:function(){if(!i.IsWeichatGame()){var e=window.location.toString(),t=e.indexOf("roomid=");t>=0&&(e=e.substring(0,t)),window.history.pushState(null,null,e)}!0===this.SingleBattleFlag?(console.log("OnSureBtn Enter PVP"),window.GGameEntry.BattleSystem.ExitBattle(!1),window.GGameEntry.CurGamePlayType=l.GamePlayType.GamePlayType_Network,c.SetGameMode(c.GM.GameMode_PVPPlayer),s.onWXLogin()):r.onLeaveRoom(),this.EnableUIBtn(!1)},OnCancelBtn:function(){!0===this.SingleBattleFlag?(window.GGameEntry.UIManager.HideUI(o.UIType.PVPExitTeamUI),r.onSetInviteInfo({}),console.log("OnSureBtn Cancel PVP")):(i.setBtnCheckEnter(3),window.GGameEntry.UIManager.HideUI(o.UIType.PVPExitTeamUI))},OnSingleSureBtn:function(){if(this.checkRepeatMsg(),r.onGetServerErrMsgCount()>0){var e=a.SafeParse(r.onGetServerErrMsg());this.TipsLabel.string=e.msg,console.log("OnSingleSureBtn "+e.msg+" type:"+e.type),2===e.type&&(this.ExitRoomFlag=!1)}else if(window.GGameEntry.ResTableMgr.GetConfigByID(u.star_client_c,52).Context===this.TipsLabel.string)window.GGameEntry.UIManager.HideUI(o.UIType.PVPExitTeamUI);else{if(i.setBtnCheckEnter(3),window.GGameEntry.UIManager.HideUI(o.UIType.PVPExitTeamUI),console.log("OnSingleSureBtn flag:"+this.ExitRoomFlag),window.GGameEntry.BattleSystem.IsSettle())return void window.GGameEntry.BattleSystem.ExitBattle();!0!==this.ExitRoomFlag&&window.GGameEntry.BattleSystem.IsInRooming()||(window.GGameEntry.UIManager.HideUI(o.UIType.PVPMakeTeamUI),window.GGameEntry.UIManager.ShowUI(o.UIType.LogoUI))}},update:function(e){}}),cc._RF.pop()},{GameMode:"GameMode",GlobalCfg:"GlobalCfg",JsonUtils:"JsonUtils",MsgUtil:"MsgUtil",PlatformUtil:"PlatformUtil",ResTableNames:"ResTableNames",UIManager:"UIManager",Util:"Util",loginServerMgr:"loginServerMgr",weixininterface:"weixininterface"}],PVPMakeTeamUI:[function(e,t,n){"use strict";cc._RF.push(t,"4b02aV7oTpO0LrP/WopTltx","PVPMakeTeamUI");var i=e("Util"),a=e("PlatformUtil"),o=e("UIManager"),r=e("loginConfig"),s=e("loginServerMgr"),l=e("weixinmsgmgr"),c=e("weixininterface"),u=(e("MsgUtil"),e("star_cs"),e("GlobalCfg"),e("star_comm")),d=(e("JsonUtils"),e("HeadImageUtil")),h=e("PVPRoomCountDownUI"),f=e("PayManager"),m=e("SimpleLabel"),y=e("ServerLog"),p=e("ResCfgDef"),g=e("EnterStateMgr"),C=e("ActivityMsgMgr"),G=e("ResTableNames"),S=new cc.Color(0,0,0),E=(new cc.Color(99,25,25),new cc.Color(255,255,255)),T=cc.Class({camp:0,pos:0,gender:0,isRoomOwener:0,Name:"",openid:"",headpic:"",status:0});cc.Class({extends:cc.Component,properties:{RoomPlayInfo:{serializable:!1,visible:!1,default:[],type:[T]},ReadyStatus:{default:!1,type:cc.Boolean},PlayerNode:{default:[],type:cc.Node},PlayerNickName:{default:[],type:cc.Label},PlayerHeadIcon:{default:[],type:cc.Sprite},PlayerReadyBtn:{default:null,type:cc.Button},PCEditNode:{default:null,type:cc.Node},PCEditBox:{default:null,type:cc.EditBox},TimeLabel:{default:null,type:m},CountDownTimeSeconds:{default:216,type:cc.Integer},EnterCountDownUI:{default:null,type:h},BKNODE:{default:null,type:cc.Node},ReadyNode:{default:[],type:cc.Node},InviteBtnNode:{default:null,type:cc.Node},BlueBtnSpr:{default:null,type:cc.SpriteFrame},OrangeBtnSpr:{default:null,type:cc.SpriteFrame},GreyBtnSpr:{default:null,type:cc.SpriteFrame},NormalExchangeBtnList:{default:[],type:cc.Button},OwnerExchangBtnList:{default:[],type:cc.Button},TestPay:0,ExitDescriptionNode:{default:null,type:cc.Node},SettingWinNode:{default:null,type:cc.Node},SettingToggle:{default:[],type:cc.Toggle},AllowAutoJoin:{default:null,type:cc.Toggle},AllowAutoJoinNode:{default:null,type:cc.Node},modelNode:{default:null,type:cc.Node},modelText:{default:null,type:cc.Label},selfList:{default:[],type:cc.Node},enemyList:{default:[],type:cc.Node}},onLoad:function(){},fitiPhoneXScreen:function(){if(a.isTargetDevice("iPhone X")){this.BKNODE&&(this.BKNODE.scaleX=.8,this.BKNODE.scaleY=.8);var e=this.node.getChildByName("VSBg");e&&(e.scaleX=.8,e.scaleY=.8)}},onEnable:function(){this.fitiPhoneXScreen(),this.AllowAutoJoin.isChecked=!1,this.BKNODE.active=!1;for(var e=0;e<6;e++)this.RoomPlayInfo[e]=new T,this.RoomPlayInfo[e].camp=0,this.RoomPlayInfo[e].pos=0,this.RoomPlayInfo[e].openid="",this.RoomPlayInfo[e].status=0,this.RoomPlayInfo[e].isRoomOwener=0,this.RoomPlayInfo[e].gender=0,this.RoomPlayInfo[e].headpic=0,this.RoomPlayInfo[e].Name=0,this.PlayerHeadIcon[e].spriteFrame=null,this.PlayerNickName[e].string="";if(this.CountDownTimeSeconds=600,this.startMakeTeamCountDown(),this.InviteBtnNode.active=!0,s.onGetServerErrMsgCount()>0)return window.GGameEntry.UIManager.HideUI(o.UIType.PVPMakeTeamUI),void window.GGameEntry.UIManager.ShowUI(o.UIType.PVPExitTeamUI,o.UIOrder.Default+10);window.GGameEntry.NotificationCenter.on("onUpdateUsersInfo",this.onUpdateUsersInfo,this),window.GGameEntry.NotificationCenter.on("onBeLeaveRoom",this.onBeLeaveRoom,this),window.GGameEntry.NotificationCenter.on("onTipsMsg",this.onTipsMsg,this),window.GGameEntry.NotificationCenter.on("OnShowEnterCountdown",this.OnShowEnterCountdown,this),window.GGameEntry.NotificationCenter.on("onRecvBattleError",this.onRecvBattleError,this),window.GGameEntry.NotificationCenter.on("OnReceivePlayerRole",this.OnReceivePlayerRole,this),window.GGameEntry.NotificationCenter.on("onRoomAutoJoinEvent",this.onRoomAutoJoinEvent,this),window.GGameEntry.BattleSystem.InRooming=!0,console.log("PVPMakeTeadUI enter");var t=!1;if(a.IsWeichatGame())if(1===a.getBtnCheckEnter()){if(g.getEnterState(g.globalEnterStateFlag.EnterState_AutoPVP)||g.getEnterState(g.globalEnterStateFlag.EnterState_AutoActivity)){n=C.getActivityType();s.onCreateRoom(n,1),this.AllowAutoJoin.isChecked=!0}else if(g.getEnterState(g.globalEnterStateFlag.EnterState_PVP)||g.getEnterState(g.globalEnterStateFlag.EnterState_Activity)){n=C.getActivityType();s.onCreateRoom(n,0),this.AllowAutoJoin.isChecked=!1}t=!0}else 2===a.getBtnCheckEnter()&&s.onQueryRoomInfo();else if(1===a.getBtnCheckEnter()){if(g.getEnterState(g.globalEnterStateFlag.EnterState_AutoPVP)||g.getEnterState(g.globalEnterStateFlag.EnterState_AutoActivity)){n=C.getActivityType();s.onCreateRoom(n,1)}else if(g.getEnterState(g.globalEnterStateFlag.EnterState_PVP)||g.getEnterState(g.globalEnterStateFlag.EnterState_Activity)){var n=C.getActivityType();s.onCreateRoom(n,0)}t=!0}else 2===a.getBtnCheckEnter()&&s.onQueryRoomInfo();var i=s.onGetTeamInfo();if(null!==i&&1!==a.getBtnCheckEnter()&&(window.GGameEntry.NotificationCenter.emit("onUpdateUsersInfo",{jsonObject:i}),i=null),!0===t||this.onIsRoomKeeper()){this.BKNODE.width=1420,this.modelNode.x=-110,this.IsKeeper=!0,this.PlayerReadyBtn.node.getComponentInChildren(cc.Label).string="开战";var r=g.getEnterStateShowAutoPVP();this.AllowAutoJoinNode.active=!!r}else this.BKNODE.width=1200,this.modelNode.x=0,this.IsKeeper=!1,this.PlayerReadyBtn.node.getComponentInChildren(cc.Label).string="准备",this.AllowAutoJoinNode.active=!1;this.ReadyStatus=!1,this.EnterCountDownUI.node.active=!1,this.SetEnableBtn(!0),this.initBtnInteractable(this.IsKeeper),this.PlayerReadyBtn.active=!1,this.HideSettingWin(),this.setModleUI(),console.log("AllowAutoJoinisChecked:"+this.AllowAutoJoin.isChecked)},setModleUI:function(){var e=C.getActivityType();if(cc.log("roomType:"+e),e){var t=C.getActivity(e);t?(this.modelNode.active=!0,this.modelText.string=t.ScaleShow+"-"+t.ModelName,this.setTeamPosActive(t.ScaleLimit)):(this.modelNode.active=!1,this.setTeamPosActive(3))}else this.modelNode.active=!1,this.setTeamPosActive(3)},setTeamPosActive:function(e){for(var t=0;t<this.selfList.length;t++)t<e?(this.selfList[t].active=!0,this.enemyList[t].active=!0):(this.selfList[t].active=!1,this.enemyList[t].active=!1)},onDisable:function(){window.GGameEntry.BattleSystem.InRooming=!1,window.GGameEntry.NotificationCenter.off("onUpdateUsersInfo",this.onUpdateUsersInfo,this),window.GGameEntry.NotificationCenter.off("onBeLeaveRoom",this.onBeLeaveRoom,this),window.GGameEntry.NotificationCenter.off("onTipsMsg",this.onTipsMsg,this),window.GGameEntry.NotificationCenter.off("OnShowEnterCountdown",this.OnShowEnterCountdown,this),window.GGameEntry.NotificationCenter.off("onRecvBattleError",this.onRecvBattleError,this),window.GGameEntry.NotificationCenter.off("OnReceivePlayerRole",this.OnReceivePlayerRole,this),window.GGameEntry.NotificationCenter.off("onRoomAutoJoinEvent",this.onRoomAutoJoinEvent,this),this.HideSettingWin()},onRecvBattleError:function(e){console.log("PVPMakeTeamUI onRecvBattleError"),s.onGetServerErrMsgCount()>0&&window.GGameEntry.UIManager.ShowUI(o.UIType.PVPExitTeamUI,o.UIOrder.Default+10)},onRoomAutoJoinEvent:function(e){var t=e.detail.RoomAutoFlag>0;console.log("PVPMakeTeamUI onRoomAutoJoinEvent "+t),this.AllowAutoJoin.isChecked=t},OnReceivePlayerRole:function(e){if(console.log("PVPMakeTeamUI OnReceivePlayerRole"),window.GGameEntry.GBattleNetwork.IsConnected()){var t=e.detail.Code;if(a.IsWeichatGame()&&c.isInvitedToJoinRoom()&&t!==s.globalServerRetState.serverState_EnterRoom){var n=s.onGetInviteInfo();if(void 0!==n&&Object.keys(n).length>0){var i=window.GGameEntry.GBattleNetwork.connector.getURL();if("undefined"!==i&&i.indexOf(n.url)<0)return console.log("PVPMakeTeamUI OnReceivePlayerRole connect another server."+n.url+" old:"+i),window.GGameEntry.GBattleNetwork.Disconnect(),void s.onConnect();if(s.onSetInviteInfo({}),"0"===n.roomid){console.log("PVPMakeTeamUI OnReceivePlayerRole null room roomid=0.");var o=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,9).Context;return void window.GGameEntry.UIManager.ReturnLogoUI(o)}s.onJoinRoom(n.roomid,-1,-1)}}}},onUpdateUsersUI:function(){this.BKNODE.active=!0;var e=this.onIsRoomKeeper();e&&(this.PlayerReadyBtn.active=!0);for(var t=this.onGetMyPos(),n=0;n<6;n++)if(this.ReadyNode[n].active=!1,(s=this.PlayerNode[n].getChildByName("NormalOwnerLabel"))&&(s.active=!1),e){var i=g.getEnterStateShowAutoPVP();if(this.AllowAutoJoinNode.active=!!i,this.BKNODE.width=1420,this.modelNode.x=-110,this.ExitDescriptionNode.active=!0,this.InviteBtnNode.active=!0,n===t){var a=this.PlayerNode[n].getChildByName("OwerLabel"),o=this.PlayerNode[n].getChildByName("OwerOperateBk"),r=this.PlayerNode[n].getChildByName("NormalChange"),s=this.PlayerNode[n].getChildByName("NormalOwnerLabel");null!==a&&(a.active=!0),null!==o&&(o.active=!1),null!==r&&(r.active=!1),s&&(s.active=!1)}else{var a=this.PlayerNode[n].getChildByName("OwerLabel"),l=(o=this.PlayerNode[n].getChildByName("OwerOperateBk")).getChildByName("Exit"),r=this.PlayerNode[n].getChildByName("NormalChange"),s=this.PlayerNode[n].getChildByName("NormalOwnerLabel");null!==a&&(a.active=!1),null!==o&&(o.active=!0),null!==r&&(r.active=!1),s&&(s.active=!1),l&&""===this.RoomPlayInfo[n].openid?l.active=!1:l.active=!0}1===this.RoomPlayInfo[n].status&&(this.ReadyNode[n].active=!0)}else{this.BKNODE.width=1200,this.modelNode.x=0,this.AllowAutoJoinNode.active=!1,this.ExitDescriptionNode.active=!1,(s=this.PlayerNode[n].getChildByName("OwerLabel"))&&(s.active=!1);var a=this.PlayerNode[n].getChildByName("NormalOwnerLabel"),o=this.PlayerNode[n].getChildByName("OwerOperateBk");if(null!==(r=this.PlayerNode[n].getChildByName("NormalChange"))&&null!==a&&null!==o){a.active=!1,o.active=!1,r.active=!0,1===this.RoomPlayInfo[n].isRoomOwener&&(null!==a&&(a.active=!0),null!==r&&(r.active=!1));var c=r.getChildByName("yizhunbei"),u=r.getChildByName("_0006_difangchange");null!==c&&null!==u&&(0===this.RoomPlayInfo[n].status?this.ReadyNode[n].active=!1:this.ReadyNode[n].active=!0)}}},onUpdateUsersInfo:function(e){console.log("PVPMakeTeadUI onUpdateUsersInfo");var t=e.detail.jsonObject;if(console.log(t),null!==t){var n=t.SD.GetTeamInfo;C.setActivityType(n.RoomType),this.setModleUI(),this.CountDownTimeSeconds=n.RoomLeftTime,s.onSetRoomCreateTime(n.RoomCreateTime);for(h=0;h<n.BlueCampRoleInfo.length&&h<3;h++){if(this.RoomPlayInfo[h].camp=u.CAMP_TYPE.CAMP_TYPE_BLUE,this.RoomPlayInfo[h].pos=h,this.RoomPlayInfo[h].openid=n.BlueCampRoleInfo[h].OpenId,this.RoomPlayInfo[h].status=n.BlueCampRoleInfo[h].Status,this.RoomPlayInfo[h].isRoomOwener=n.BlueCampRoleInfo[h].IsRoomOwner,this.RoomPlayInfo[h].gender=n.BlueCampRoleInfo[h].Gender,this.RoomPlayInfo[h].headpic=n.BlueCampRoleInfo[h].Pic,this.RoomPlayInfo[h].Name=window.GGameEntry.GBase64.decode(n.BlueCampRoleInfo[h].Name),this.PlayerHeadIcon[h].spriteFrame=null,this.PlayerNickName[h].string="",""!==n.BlueCampRoleInfo[h].OpenId){if(""===n.BlueCampRoleInfo[h].Name)this.PlayerNickName[h].string="NickName",this.RoomPlayInfo[h].Name="NickName";else{var o=window.GGameEntry.GBase64.decode(n.BlueCampRoleInfo[h].Name);a.isTargetPlatform(2)&&(o=i.FliterEmojString(o)),this.PlayerNickName[h].string=o}""===n.BlueCampRoleInfo[h].Pic?d.loadImageFromNetUrl(this.PlayerHeadIcon[h],"res/raw-assets/resources/Atlas/HeadIcon.png"):d.loadImageFromNetUrl(this.PlayerHeadIcon[h],n.BlueCampRoleInfo[h].Pic)}""!==this.RoomPlayInfo[h].openid&&this.RoomPlayInfo[h].openid===l.getOpenID()&&(1===this.RoomPlayInfo[h].status?this.ReadyStatus=!0:this.ReadyStatus=!1,this.onSetBtnStatus(this.ReadyStatus)),console.log("PVPMakeTeadUI onUpdateUsersInfo "+h)}for(h=0;h<n.RedCampRoleInfo.length&&h<3;h++){if(this.RoomPlayInfo[h+3].camp=u.CAMP_TYPE.CAMP_TYPE_RED,this.RoomPlayInfo[h+3].pos=h,this.RoomPlayInfo[h+3].openid=n.RedCampRoleInfo[h].OpenId,this.RoomPlayInfo[h+3].status=n.RedCampRoleInfo[h].Status,this.RoomPlayInfo[h+3].isRoomOwener=n.RedCampRoleInfo[h].IsRoomOwner,this.RoomPlayInfo[h+3].gender=n.RedCampRoleInfo[h].Gender,this.RoomPlayInfo[h+3].headpic=n.RedCampRoleInfo[h].Pic,this.RoomPlayInfo[h+3].Name=window.GGameEntry.GBase64.decode(n.RedCampRoleInfo[h].Name),this.PlayerHeadIcon[h+3].spriteFrame=null,this.PlayerNickName[h+3].string="",""!==n.RedCampRoleInfo[h].OpenId){if(""===n.RedCampRoleInfo[h].Name)this.PlayerNickName[h+3].string="NickName",this.RoomPlayInfo[h+3].Name="NickName";else{var r=window.GGameEntry.GBase64.decode(n.RedCampRoleInfo[h].Name);a.isTargetPlatform(2)&&(r=i.FliterEmojString(r)),this.PlayerNickName[h+3].string=r}""===n.RedCampRoleInfo[h].Pic?d.loadImageFromNetUrl(this.PlayerHeadIcon[h+3],"res/raw-assets/resources/Atlas/HeadIcon.png"):d.loadImageFromNetUrl(this.PlayerHeadIcon[h+3],n.RedCampRoleInfo[h].Pic)}""!==this.RoomPlayInfo[h+3].openid&&this.RoomPlayInfo[h+3].openid===l.getOpenID()&&(1===this.RoomPlayInfo[h+3].status?this.ReadyStatus=!0:this.ReadyStatus=!1,this.onSetBtnStatus(this.ReadyStatus)),console.log("PVPMakeTeadUI onUpdateUsersInfo "+h)}for(var c=0,h=0;h<n.BlueCampRoleInfo.length&&h<3;h++)""!==n.BlueCampRoleInfo[h].OpenId&&c++;for(h=0;h<n.RedCampRoleInfo.length&&h<6;h++)""!==n.RedCampRoleInfo[h].OpenId&&c++;this.PlayerReadyBtn.node.active=!(c<=1),this.onUpdateUsersUI()}},onTipsMsg:function(e){var t=e.detail;t===o.UIType.PVPChangeTeamUI||t===o.UIType.PVPExitTeamUI&&(window.GGameEntry.UIManager.HideUI(o.UIType.PVPMakeTeamUI),window.GGameEntry.UIManager.ShowUI(o.UIType.LogoUI))},onBeLeaveRoom:function(e){window.GGameEntry.UIManager.HideUI(o.UIType.PVPMakeTeamUI),window.GGameEntry.UIManager.ShowUI(o.UIType.LogoUI)},onIsEmptyPosition:function(e,t){var n=!0;if(e<3&&t<6){var i=3*(e-1)+t;i<6&&""!==this.RoomPlayInfo[i].openid&&(n=!1)}return n},onIsPlayerReady:function(e,t){var n=!1;if(e<3&&t<6){var i=3*(e-1)+t;i<6&&this.RoomPlayInfo[i].status>0&&(n=!0)}return n},onIsRoomKeeper:function(){for(var e=!1,t=0;t<6;t++)if(""!==this.RoomPlayInfo[t].openid&&this.RoomPlayInfo[t].openid===l.getOpenID()&&1===this.RoomPlayInfo[t].isRoomOwener){e=!0;break}return e},onGetMyPos:function(){for(var e=0;e<6;e++)if(console.log("onGetMyPos "+e+"  "+this.RoomPlayInfo[e].openid+"  "+l.getOpenID()),""!==this.RoomPlayInfo[e].openid&&this.RoomPlayInfo[e].openid===l.getOpenID())return e;return-1},isMyPos:function(e,t){var n=this.onGetMyPos();return console.log("isMyPos "+n),n>=0&&n<6&&this.RoomPlayInfo[n].camp===e&&this.RoomPlayInfo[n].pos===t},onBtnReturn:function(){if(window.GGameEntry.IsNetAvailable)if(1!==this.TestPay)if(this.onIsRoomKeeper())window.GGameEntry.UIManager.ShowUI(o.UIType.PVPExitTeamUI,o.UIOrder.Default+10);else{if(!a.IsWeichatGame()){var e=window.location.toString(),t=e.indexOf("roomid=");t>=0&&(e=e.substring(0,t)),window.history.pushState(null,null,e)}s.onLeaveRoom()}else f.GetBalance();else window.GGameEntry.UIManager.ShowMsgBox("没有可用网络，请检查当前网络是否畅通。")},shareAppMsgCallback:function(e,t,n,i,a){if(!0===e){if(console.error("shareAppMessage success ",n,i),!0===t&&void 0!==n.groupMsgInfos){var o=n.groupMsgInfos[0],r=o.groupMsgTicket,l=o.expiresIn;s.onWXInviteGroupMsg(i.encryptedData,i.iv,r,a),console.error("shareAppMessage success ",r,l,i)}}else console.log("shareAppMessage failed "+n.errMsg)},onBtnInvite:function(){if(1!==this.TestPay)if(y.pushLog("PVP Invite"),a.IsWeichatGame()){var e=r.getLongSocketURL(!0),t="uipath=PVPMakeTeamUI&roomid="+(h=s.onGetRoomGuid())+"&url="+e+"&time="+s.onGetRoomCreateTime();if(console.log("onBtnInvite shareLink:"+t),"0"===h){console.log("LogoUI onBtnInvite null room roomid=0.");var n=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,73).Context;return void window.GGameEntry.UIManager.ReturnLogoUI(n)}var i=""===window.GGameEntry.tanksharetips?"“欢乐对战，火力全开”，点击立即进入战场":window.GGameEntry.tanksharetips,o=""===window.GGameEntry.tankshareurl?"https://cdn.bt.qq.com/Config/Release/pic/TankShare.png":window.GGameEntry.tankshareurl,l=C.getCurModeInfo();if(l){var u=o.lastIndexOf("/");o=o.substring(0,u+1)+l.WxInvitePic,i=l.WxInviteWord}"wx"!==window.GGameEntry.ServerName&&!0!==GameSettingConfig.Public&&(i+="("+window.GGameEntry.ServerName+")"),c.onShareMsgInGame(i,t,o,this.shareAppMsgCallback)}else{var d=window.location.toString(),h=s.onGetRoomGuid();(u=d.indexOf("roomid="))>=0?d=d.substring(0,u)+"roomid="+h+"&uipath=PVPMakeTeamUI&server="+window.GGameEntry.ServerName:d+="?roomid="+h+"&uipath=PVPMakeTeamUI&server="+window.GGameEntry.ServerName;var m=Date.now();window.localStorage.setItem("date",m),console.log("onBtnInvite:"+d),window.location=d}else f.Pay()},EnableBtnScaler:function(e,t){var n=t.getComponent("ButtonScaler");n&&(n.enabled=!!e)},EnableInviteBtn:function(e){e?(this.InviteBtnNode.interactable=!0,this.InviteBtnNode.getComponent(cc.Sprite).spriteFrame=this.BlueBtnSpr,this.InviteBtnNode.getComponentInChildren(cc.Label).node.color=E,this.InviteBtnNode.active=!0):(this.InviteBtnNode.interactable=!1,this.InviteBtnNode.getComponent(cc.Sprite).spriteFrame=this.GreyBtnSpr,this.InviteBtnNode.getComponentInChildren(cc.Label).node.color=S,this.InviteBtnNode.active=!1),this.EnableBtnScaler(e,this.InviteBtnNode)},onSetBtnStatus:function(e){window.GGameEntry.IsNetAvailable?this.onIsRoomKeeper()?this.PlayerReadyBtn.getComponentInChildren(cc.Label).string="开战":e?(this.PlayerReadyBtn.getComponentInChildren(cc.Label).string="取消",this.EnableInviteBtn(!1)):(this.PlayerReadyBtn.getComponentInChildren(cc.Label).string="准备",this.EnableInviteBtn(!0)):window.GGameEntry.UIManager.ShowMsgBox("没有可用网络，请检查当前网络是否畅通。")},onBtnStart:function(){1!==this.TestPay?(this.ReadyStatus=!this.ReadyStatus,this.onIsRoomKeeper()?this.checkCanStartGame()&&s.onKeeperStartGameCheck():(this.onSetBtnStatus(this.ReadyStatus),s.onPlayerReadyStatus(this.ReadyStatus),y.pushLog("PVP onBtnStart"))):f.Buy()},checkCanStartGame:function(){for(var e=0,t=0,n=!1,i=0;i<3;i++)""!==this.RoomPlayInfo[i].openid&&(e++,0===this.RoomPlayInfo[i].status&&1!==this.RoomPlayInfo[i].isRoomOwener&&(n=!0));for(i=0;i<3;i++){var a=i+3;""!==this.RoomPlayInfo[a].openid&&(t++,0===this.RoomPlayInfo[a].status&&1!==this.RoomPlayInfo[a].isRoomOwener&&(n=!0))}if(0===e||0===t){o=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,74).Context;return window.GGameEntry.UIManager.ShowMsgBox(o),!1}if(n){o=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,75).Context;return window.GGameEntry.UIManager.ShowMsgBox(o),!1}if(e!=t){var o=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,76).Context;return window.GGameEntry.UIManager.ShowMsgBox(o,101),!1}return!0},onBtnBlueExchange1:function(){if(window.GGameEntry.IsNetAvailable)if(this.onIsEmptyPosition(u.CAMP_TYPE.CAMP_TYPE_BLUE,0))s.onPlayerChangePos(u.CAMP_TYPE.CAMP_TYPE_BLUE,0);else{e=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,77).Context;window.GGameEntry.UIManager.ShowMsgBox(e)}else{var e=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,54).Context;window.GGameEntry.UIManager.ShowMsgBox(e)}},onBtnBlueExit1:function(){if(window.GGameEntry.IsNetAvailable)this.onIsEmptyPosition(u.CAMP_TYPE.CAMP_TYPE_BLUE,0)||!this.onIsRoomKeeper()||this.isMyPos(u.CAMP_TYPE.CAMP_TYPE_BLUE,0)||s.onRoomKeeperKickout(this.RoomPlayInfo[0].openid);else{var e=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,54).Context;window.GGameEntry.UIManager.ShowMsgBox(e)}},onBtnBlueExchange2:function(){if(window.GGameEntry.IsNetAvailable)if(this.onIsEmptyPosition(u.CAMP_TYPE.CAMP_TYPE_BLUE,1))s.onPlayerChangePos(u.CAMP_TYPE.CAMP_TYPE_BLUE,1);else{e=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,77).Context;window.GGameEntry.UIManager.ShowMsgBox(e)}else{var e=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,54).Context;window.GGameEntry.UIManager.ShowMsgBox(e)}},onBtnBlueExit2:function(){if(window.GGameEntry.IsNetAvailable)this.onIsEmptyPosition(u.CAMP_TYPE.CAMP_TYPE_BLUE,1)||!this.onIsRoomKeeper()||this.isMyPos(u.CAMP_TYPE.CAMP_TYPE_BLUE,1)||s.onRoomKeeperKickout(this.RoomPlayInfo[1].openid);else{var e=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,54).Context;window.GGameEntry.UIManager.ShowMsgBox(e)}},onBtnBlueExchange3:function(){if(window.GGameEntry.IsNetAvailable)if(this.onIsEmptyPosition(u.CAMP_TYPE.CAMP_TYPE_BLUE,2))s.onPlayerChangePos(1,2);else{e=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,77).Context;window.GGameEntry.UIManager.ShowMsgBox(e)}else{var e=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,54).Context;window.GGameEntry.UIManager.ShowMsgBox(e)}},onBtnBlueExit3:function(){if(window.GGameEntry.IsNetAvailable)this.onIsEmptyPosition(u.CAMP_TYPE.CAMP_TYPE_BLUE,2)||!this.onIsRoomKeeper()||this.isMyPos(u.CAMP_TYPE.CAMP_TYPE_BLUE,2)||s.onRoomKeeperKickout(this.RoomPlayInfo[2].openid);else{var e=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,54).Context;window.GGameEntry.UIManager.ShowMsgBox(e)}},onBtnRedExchange1:function(){if(window.GGameEntry.IsNetAvailable)if(this.onIsEmptyPosition(u.CAMP_TYPE.CAMP_TYPE_RED,0))s.onPlayerChangePos(2,0);else{e=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,77).Context;window.GGameEntry.UIManager.ShowMsgBox(e)}else{var e=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,54).Context;window.GGameEntry.UIManager.ShowMsgBox(e)}},onBtnRedExit1:function(){if(window.GGameEntry.IsNetAvailable)this.onIsEmptyPosition(u.CAMP_TYPE.CAMP_TYPE_RED,0)||!this.onIsRoomKeeper()||this.isMyPos(u.CAMP_TYPE.CAMP_TYPE_RED,0)||s.onRoomKeeperKickout(this.RoomPlayInfo[3].openid);else{var e=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,54).Context;window.GGameEntry.UIManager.ShowMsgBox(e)}},onBtnRedExchange2:function(){if(window.GGameEntry.IsNetAvailable)if(this.onIsEmptyPosition(u.CAMP_TYPE.CAMP_TYPE_RED,1))s.onPlayerChangePos(u.CAMP_TYPE.CAMP_TYPE_RED,1);else{e=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,77).Context;window.GGameEntry.UIManager.ShowMsgBox(e)}else{var e=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,54).Context;window.GGameEntry.UIManager.ShowMsgBox(e)}},onBtnRedExit2:function(){if(window.GGameEntry.IsNetAvailable)this.onIsEmptyPosition(u.CAMP_TYPE.CAMP_TYPE_RED,1)||!this.onIsRoomKeeper()||this.isMyPos(u.CAMP_TYPE.CAMP_TYPE_RED,1)||s.onRoomKeeperKickout(this.RoomPlayInfo[4].openid);else{var e=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,54).Context;window.GGameEntry.UIManager.ShowMsgBox(e)}},onBtnRedExchange3:function(){if(window.GGameEntry.IsNetAvailable)if(this.onIsEmptyPosition(u.CAMP_TYPE.CAMP_TYPE_RED,2))s.onPlayerChangePos(u.CAMP_TYPE.CAMP_TYPE_RED,2);else{e=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,77).Context;window.GGameEntry.UIManager.ShowMsgBox(e)}else{var e=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,54).Context;window.GGameEntry.UIManager.ShowMsgBox(e)}},onBtnRedExit3:function(){if(window.GGameEntry.IsNetAvailable)this.onIsEmptyPosition(u.CAMP_TYPE.CAMP_TYPE_RED,2)||!this.onIsRoomKeeper()||this.isMyPos(u.CAMP_TYPE.CAMP_TYPE_RED,2)||s.onRoomKeeperKickout(this.RoomPlayInfo[5].openid);else{var e=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,54).Context;window.GGameEntry.UIManager.ShowMsgBox(e)}},scheduleCallback:function(){this.CountDownTimeSeconds>0?(this.CountDownTimeSeconds--,this.TimeLabel.SetString(i.GetTimeFormatStr(this.CountDownTimeSeconds)),this.CountDownTimeSeconds):this.TimeLabel.SetString("00:00")},startMakeTeamCountDown:function(){var e=this.CountDownTimeSeconds-1;this.unschedule(this.scheduleCallback),this.TimeLabel.SetString(i.GetTimeFormatStr(this.CountDownTimeSeconds)),this.schedule(this.scheduleCallback,1,e,1)},OnShowEnterCountdown:function(){window.GGameEntry.UIManager.HideUI(o.UIType.CommonMsgBoxUI),window.GGameEntry.UIManager.HideUI(o.UIType.PVPExitTeamUI),window.GGameEntry.BattleSystem.MapLoading=!0,this.EnterCountDownUI.node.active=!0,this.SetEnableBtn(!1),this.HideSettingWin()},SetEnableBtn:function(e){var t=this.PlayerReadyBtn.node.getComponent(cc.Sprite);t&&(t.spriteFrame=e?this.OrangeBtnSpr:this.GreyBtnSpr);var n=this.InviteBtnNode.getComponent(cc.Sprite);n&&(n.spriteFrame=e?this.BlueBtnSpr:this.GreyBtnSpr)},DisableBtnInTime:function(e,t,n){var i=this;if(n)for(var a=0;a<this.OwnerExchangBtnList.length;a++)a!=e&&(this.OwnerExchangBtnList[a].node.active=!1);else for(var o=0;o<this.NormalExchangeBtnList.length;o++)this.NormalExchangeBtnList[o].node.active=!1;this.scheduleOnce(function(){if(n)for(var t=0;t<this.OwnerExchangBtnList.length;t++)t!=e&&(i.OwnerExchangBtnList[t].node.active=!0);else for(var a=0;a<i.NormalExchangeBtnList.length;a++)i.NormalExchangeBtnList[a].node.active=!0},t)},initBtnInteractable:function(e){if(e)for(var t=0;t<this.OwnerExchangBtnList.length;t++)this.OwnerExchangBtnList[t].node.active=!0;else for(var n=0;n<this.NormalExchangeBtnList.length;n++)this.NormalExchangeBtnList[n].node.active=!0},HideSettingWin:function(){this.SettingWinNode.active=!1},InitSettingWin:function(){window.GGameEntry.ResManager.SetByCustomValue?this.SettingToggle[window.GGameEntry.ResManager.CurResType].check():this.SettingToggle.length>3&&this.SettingToggle[3].check()},OnSettingBtn:function(){this.ReadyStatus||(this.SettingWinNode.active=!this.SettingWinNode.active,this.SettingWinNode.active&&this.InitSettingWin())},OnSettingOKBtn:function(){var e=window.GGameEntry.ResManager.CfgRange;window.GGameEntry.ResManager.SetByCustom(!0);for(var t=0;t<this.SettingToggle.length;t++)if(this.SettingToggle[t].isChecked){t===p.ResCfgType.H?(window.GGameEntry.ResManager.FPSAvg=window.GGameEntry.ResManager.LastFPSAvg=e[p.ResCfgType.H].Max,window.GGameEntry.ResManager.CurResType=p.ResCfgType.H):t===p.ResCfgType.L?(window.GGameEntry.ResManager.FPSAvg=window.GGameEntry.ResManager.LastFPSAvg=e[p.ResCfgType.L].Min,window.GGameEntry.ResManager.CurResType=p.ResCfgType.L):t===p.ResCfgType.M?(window.GGameEntry.ResManager.FPSAvg=window.GGameEntry.ResManager.LastFPSAvg=Math.floor((e[p.ResCfgType.M].Min+e[p.ResCfgType.M].Max)/2),window.GGameEntry.ResManager.CurResType=p.ResCfgType.M):(window.GGameEntry.ResManager.SetByCustom(!1),window.GGameEntry.ResManager.CurResType=p.ResCfgType.L);break}window.GGameEntry.ResManager.SaveLOT(!0),window.GGameEntry.ResManager.CalResTypeByLastFPS(),this.HideSettingWin()},OnToggleClicked:function(){console.error("OnToggleClicked"+this.AllowAutoJoin.isChecked),s.onAutoJoinRoom(this.AllowAutoJoin.isChecked)}}),cc._RF.pop()},{ActivityMsgMgr:"ActivityMsgMgr",EnterStateMgr:"EnterStateMgr",GlobalCfg:"GlobalCfg",HeadImageUtil:"HeadImageUtil",JsonUtils:"JsonUtils",MsgUtil:"MsgUtil",PVPRoomCountDownUI:"PVPRoomCountDownUI",PayManager:"PayManager",PlatformUtil:"PlatformUtil",ResCfgDef:"ResCfgDef",ResTableNames:"ResTableNames",ServerLog:"ServerLog",SimpleLabel:"SimpleLabel",UIManager:"UIManager",Util:"Util",loginConfig:"loginConfig",loginServerMgr:"loginServerMgr",star_comm:"star_comm",star_cs:"star_cs",weixininterface:"weixininterface",weixinmsgmgr:"weixinmsgmgr"}],PVPRoomCountDownUI:[function(e,t,n){"use strict";cc._RF.push(t,"cd1cfwkkd1BopjSVF4dbfVv","PVPRoomCountDownUI");var i=e("UIManager");cc.Class({extends:cc.Component,properties:{Ani:{default:null,type:cc.Animation,serializable:!0},CountDownNode:{default:[],type:cc.Node}},onEnable:function(){this.reset(),this.Ani.setCurrentTime(0),this.Ani.play("daojishi_enter"),window.GGameEntry.SoundManager.PlayGameCountDown();var e=3;this.changeCountDown(e-1);var t=this;this.schedule(function(){(e-=1)>=1?(t.changeCountDown(e-1),window.GGameEntry.SoundManager.PlayGameCountDown()):(t.reset(),t.node.active=!1,window.GGameEntry.UIManager.HideUI(i.UIType.PVPMakeTeamUI),window.GGameEntry.UIManager.ShowUI(i.UIType.BattleLoadingUI,i.UIOrder.Top+100))},1,2,0)},reset:function(){for(var e=0;e<this.CountDownNode.length;e++)this.CountDownNode[e].setPosition(-2e3,-2e3),this.CountDownNode[e].getComponent(cc.Animation).stop("DaoJiShiUI")},changeCountDown:function(e){for(var t=0;t<this.CountDownNode.length;t++)if(t===e){this.CountDownNode[t].setPosition(0,0);var n=this.CountDownNode[t].getComponent(cc.Animation);n&&n.play("DaoJiShiUI")}else{this.CountDownNode[t].setPosition(-2e3,-2e3);var i=this.CountDownNode[t].getComponent(cc.Animation);i&&i.stop("DaoJiShiUI")}}}),cc._RF.pop()},{UIManager:"UIManager"}],PayManager:[function(e,t,n){"use strict";function i(e){switch(e){case-1:return"支付失败！";case 1:return"支付取消！";case 1003:return"系统错误！";case 1e3:return"参数错误！";case-9999:return"请求超时！";default:return"充值失败！("+e+")"}}cc._RF.push(t,"2f21dvpZ8ZIYK5vRrN58w01","PayManager");e("MsgBase"),e("GlobalCfg");var a=e("NetworkProto"),o=e("star_comm"),r=e("star_cs"),s=e("PlatformUtil"),l=(e("UIManager"),e("ServerLog")),c=e("ResTableNames");t.exports={GetBalance:function(){cc.log("=========>GetBalance:"),l.pushLog("PayManager GetBalance");var e=new o.MidasGetBalanceC;e.__msgid__=r.CS_CMD_TYPE.CS_CMD_MIDAS_GET_BALANCE,cc.log(e),a.SendBattleSvrRequest(0,e)},Pay:function(){cc.log("=========>Pay:"),l.pushLog("PayManager pay");var e=new o.MidasPayTestC;e.__msgid__=r.CS_CMD_TYPE.CS_CMD_MIDAS_PAY_TEST,e.Amt=1,cc.log(e),a.SendBattleSvrRequest(0,e)},Buy:function(e,t){if(s.IsWeichatGame())if(window.GGameEntry.IsNetAvailable){l.pushLog("PayManager Buy");var n=s.isTargetPlatform(1),a=!0===GameSettingConfig.Public?0:1,o=n?"iap":"android";wx.requestMidasPayment({env:a,offerId:"1450013315",mode:"game",currencyType:"CNY",platform:o,buyQuantity:e,zoneId:"1",success:function(){cc.log("===>>>OnBuy 支付成功"),t(!0)},fail:function(e){var n=e.errMsg,a=e.errCode;cc.log(n,a),cc.log("===>>>OnBuy 支付失败"),t(!1);var o=i(a);window.GGameEntry.UIManager.ShowMsgBox(o)}})}else{var r=window.GGameEntry.ResTableMgr.GetConfigByID(c.star_client_c,54).Context;window.GGameEntry.UIManager.ShowMsgBox(r)}}},cc._RF.pop()},{GlobalCfg:"GlobalCfg",MsgBase:"MsgBase",NetworkProto:"NetworkProto",PlatformUtil:"PlatformUtil",ResTableNames:"ResTableNames",ServerLog:"ServerLog",UIManager:"UIManager",star_comm:"star_comm",star_cs:"star_cs"}],PerformanceMgr:[function(e,t,n){"use strict";cc._RF.push(t,"fc255rumWRAF4ar4uvcI/PL","PerformanceMgr");var i=e("PlatformUtil");cc.Class({extends:cc.Component,properties:{DefaultEnableMonitor:!1,DefaultDisableAI:!1,DefaultDisableAnimation:!1,DefaultRedTeamCount:3,DefaultBlueTeamCount:2,Config:{default:null,serializable:!1,visible:!1}},Init:function(){this.LoadConfig()},LoadConfig:function(){var e=i.GetValue("PerformanceMgrConfig");null!=e?this.Config=e:this.ResetConfig()},ResetConfig:function(){this.Config={},this.Config.EnableMonitor=this.DefaultEnableMonitor,this.Config.DiableAI=this.DefaultDisableAI,this.Config.DisableAnimation=this.DefaultDisableAnimation,this.Config.RedTeamCount=this.DefaultRedTeamCount,this.Config.BlueTeamCount=this.DefaultBlueTeamCount},SaveConfig:function(){null!=this.Config?i.SetValue("PerformanceMgrConfig",this.Config):cc.error("PerformanceMgrConfig empty")}}),cc._RF.pop()},{PlatformUtil:"PlatformUtil"}],PickBufferSkill:[function(e,t,n){"use strict";cc._RF.push(t,"906a7VkGZJMnJG0pTNkxCol","PickBufferSkill");var i=e("Skill"),a=e("Util");cc.Class({extends:i,properties:{},onLoad:function(){},UseSkill:function(e){var t=a.BeginSample("PickBufferSkill::UseSkill");this.EntitySource&&this.EntitySource.PickBufferItem(e),a.EndSample(t)}}),cc._RF.pop()},{Skill:"Skill",Util:"Util"}],PlatformUtil:[function(e,t,n){"use strict";cc._RF.push(t,"4beb2PaRQdN64sl3a5+OYbt","PlatformUtil");e("Util");var i=0;t.exports={WXEnable:!1,GetValue:function(e){var t=null;if(this.IsWeichatGame())try{null!==(n=wx.getStorageSync(e))&&""!==n&&"undefined"!==n&&(t=n)}catch(e){}else{var n=cc.sys.localStorage.getItem(e);null!==n&&""!==n&&"undefined"!==n&&(t=JSON.parse(n))}return t},SetValue:function(e,t){if(this.IsWeichatGame())try{wx.setStorageSync(e,t)}catch(t){cc.error("save "+e+"to wechat failed!\n"+t)}else cc.sys.localStorage.setItem(e,JSON.stringify(t))},IsWeichatGame:function(){return"function"==typeof cc._isWechatGame&&cc._isWechatGame()},IsDebugMode:function(){return!1},Login:function(e){this.IsWeichatGame()&&wx.checkSession({success:function(){e&&e()},fail:function(){wx.login({success:function(t){t.code?(window.GGameEntry.PlayerManager.PlayerData.WXCode=t.code,e&&e()):console.log("获取用户登录态失败！"+t.errMsg)}})}})},GetUserInfo:function(e){this.IsWeichatGame()&&wx.getUserInfo({success:function(t){window.GGameEntry.PlayerManager.PlayerData.WXUserInfo=t.userInfo;var n=t.userInfo;n.nickName,n.avatarUrl,n.gender,n.province,n.city,n.country,e&&e()}})},AskAllAuthorize:function(){this.AskAuthorize("scope.userInfo")},AskAuthorize:function(e){this.IsWeichatGame()&&(wx.getSetting?wx.getSetting({success:function(t){t.authSetting[e]||wx.authorize({scope:e})}}):wx.authorize({scope:e}))},setBtnCheckEnter:function(e){i=e},getBtnCheckEnter:function(){return i},getDeviceSystemInfo:function(){if(this.IsWeichatGame())return wx.getSystemInfoSync().system},isTargetPlatform:function(e){var t=!1,n=this.getDeviceSystemInfo();return 1===e?n&&n.includes("iOS")&&(t=!0):2===e&&n&&(n.includes("Android")||n.includes("android"))&&(t=!0),t},getDeviceSystemAllInfo:function(){return this.IsWeichatGame()?wx.getSystemInfoSync():null},isTargetDevice:function(e){var t=!1;if(this.IsWeichatGame()){var n=wx.getSystemInfoSync();cc.error(e+","+n.model),n.model.includes(e)&&(t=!0)}return t}},cc._RF.pop()},{Util:"Util"}],PlayerAnimationCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"4af38Fv1sBLaoi/6ZqXjA0s","PlayerAnimationCtrl"),cc.Class({extends:cc.Component,properties:{bodyAnimation:{default:null,type:cc.Animation},fireAnimation:{default:null,type:cc.Animation},IdleAnimationClipName:"",AttackAnimationClipName:"",PickAnimationClipName:"",FireAnimationClipName:""},playAnimation:function(e,t,n){e&&(e.node.active=!0);var i;(i=1==n?e.playAdditive(t):e.play(t)).active=!0,i.wrapMode=cc.WrapMode.Normal,i.repeatCount=1},stopAnimation:function(e,t){e&&(e.stop(t),e.node.active=!1)},onLoad:function(){var e=this;this.bodyAnimation.on("finished",this.bodyAnimationFinished,e),this.fireAnimation.on("finished",this.fireAnimationFinished,e)},bodyAnimationFinished:function(){this.bodyAnimation.currentClip.name!==this.IdleAnimationClipName&&this.bodyAnimation.play(this.IdleAnimationClipName)},fireAnimationFinished:function(){}}),cc._RF.pop()},{}],PlayerBase:[function(e,t,n){"use strict";cc._RF.push(t,"0f0d335+ctDobr3/8f2uTm+","PlayerBase");var i=e("MapCfg"),a=e("Util"),o=(e("GameEntry"),e("EntityBase"),e("EntityTypeDefine"),e("TankAttr"),e("CmdBase"),e("CmdDefine"),e("SkillDefine"),e("CmdSkill"),e("MsgUseSkill"),e("TankBase")),r=(e("PlayerManager"),e("PlayerAnimationCtrl"),e("NormalAttackSkill"),e("PickBufferSkill"),e("BattleDef"),e("star_comm")),s=e("CmdAddBuff");e("AIMapUtil");cc.Class({extends:o,properties:{DirectionX:{default:0,serializable:!1,visible:!1},Pic:{default:0,serializable:!1,visible:!1},DirectionY:{default:0,serializable:!1,visible:!1},MoveSpeedBonus:{default:cc.v2(0,0)},TankUINode:{default:null,type:cc.Node}},onLoad:function(){this._super()},start:function(){},Reset:function(){this._super()},Init:function(e){this._super(e),window.GGameEntry.BattleSystem.IsInvertWorld()&&(this.TankUINode.rotation=180),i.MapGlobalCfg.MapTileSize[0]},InitWithServerData:function(e,t){this.ConfigId=t.ResID,this.Init(e)},UnInit:function(){this._super()},Release:function(){},SetRotate:function(e){var t=a.BeginSample("PlayerBase::SetRotate"),n=window.GGameEntry.MathUtil.cos(e),i=window.GGameEntry.MathUtil.sin(e);this.MoveSpeed.x=(this.CfgSourceConfigSpeed+this.MoveSpeedBonus.x)*n,this.MoveSpeed.y=(this.CfgSourceConfigSpeed+this.MoveSpeedBonus.y)*i,this.UpdateDirectionArrow(e),a.EndSample(t)},SetPlayerDataUsingServerData:function(e){for(var t=a.BeginSample("PlayerBase::SetPlayerDataUsingServerData"),n=0;n<e.AttrList.length;n++)(o=e.AttrList[n]).AttrID===r.AttrType.ATTR_HP?this.Hp=o.Value:o.AttrID===r.AttrType.ATTR_MAX_HP?this.MaxHp=o.Value:o.AttrID===r.AttrType.ATTR_SPEED&&(this.CfgSourceConfigSpeed=o.Value);if(this.OpenId=e.OpenId,this.ShootBulletId=e.Bullet,this.Guid=e.ObjID,this.EntityCampType=e.CampID,this.SetResID(e.ResID),this.rotateAll(e.Dir),this.canWalk(cc.v2(e.Pos.x,e.Pos.y)))this.setPosAndDirect(cc.v2(e.Pos.x,e.Pos.y));else{var i=this.findNearCanWalkPos(e.Pos.x,e.Pos.y);i&&this.setTankPosition(i)}for(n=0;n<e.BuffNum;n++){var o=e.Buff[n];if(o){var l=new s;l.Init(this.Guid,o.ResID),l.BuffOp=1,window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(l)}}this.InitEventAndAni(),a.EndSample(t)},OnDie:function(){this._super()},_DoDieAction:function(){this._super()},OnPause:function(){this.Pause=!0,cc.director.getScheduler().pauseTarget(this)},OnResume:function(){this.Pause=!1,cc.director.getScheduler().resumeTarget(this)},InvincibleTimeout:function(){this.node.opacity=255,this.Invincible=!1},BecomeInvincible:function(e){this.HasLightningItem||(this.Invincible&&this.unschedule(this.InvincibleTimeout),this.Invincible=!0,this.node.opacity=128,this.schedule(this.InvincibleTimeout,e,0))},StopInvincible:function(){this.Invincible=!1,this.unschedule(this.InvincibleTimeout),this.node.opacity=255,this.Invincible=!1},Shoot:function(e){this._super(e)},update:function(e){this._super(e)}}),cc._RF.pop()},{AIMapUtil:"AIMapUtil",BattleDef:"BattleDef",CmdAddBuff:"CmdAddBuff",CmdBase:"CmdBase",CmdDefine:"CmdDefine",CmdSkill:"CmdSkill",EntityBase:"EntityBase",EntityTypeDefine:"EntityTypeDefine",GameEntry:"GameEntry",MapCfg:"MapCfg",MsgUseSkill:"MsgUseSkill",NormalAttackSkill:"NormalAttackSkill",PickBufferSkill:"PickBufferSkill",PlayerAnimationCtrl:"PlayerAnimationCtrl",PlayerManager:"PlayerManager",SkillDefine:"SkillDefine",TankAttr:"TankAttr",TankBase:"TankBase",Util:"Util",star_comm:"star_comm"}],PlayerManager:[function(e,t,n){"use strict";cc._RF.push(t,"58ce8YzxN5EErKepcf4V1jj","PlayerManager");var a=e("MapCfg"),o=(a.MapItemType,e("EntityManager"),e("EntityTypeDefine")),r=e("UIManager"),s=e("AIMapUtil"),l=e("MsgPickUpItem"),c=e("Util"),u=e("weixinmsgmgr"),d=e("PvPInfo"),h=e("GlobalCfg"),u=e("weixinmsgmgr");cc.Class({extends:cc.Component,properties:{PlayerPrefab:{default:null,type:cc.Prefab},OtherPlayerPrefab:{default:null,type:cc.Prefab},DeathPrefab:{default:null,type:cc.Prefab},MapPlayerLayer:{default:null,type:cc.Node},Player:{default:null,serializable:!1,visible:!1},MainPlayerGuid:{default:0,serializable:!1,visible:!1},serverTime:{default:0,serializable:!1,visible:!1},PlayerCampType:{default:0,visibility:!1,serializable:!1},SinglePlayerHeadIcon:{default:null,type:cc.SpriteFrame},UsingSimulate:{default:!1}},Init:function(e){this.PlayerData={WXCode:null,WXUserInfo:null},this.otherPlayerArray={},window.GGameEntry.NotificationCenter.on("TankReborn",this.PlayerReborn,this),window.GGameEntry.NotificationCenter.on("onUpdateUsersInfo",this.onUpdateUsersInfo,this),window.GGameEntry.NotificationCenter.on("HeartResponse",this.HeartResponse,this),window.GGameEntry.NotificationCenter.on("UpdateGlobalConfig",this.updateGlobalConfig,this),window.GGameEntry.NotificationCenter.on("LogoUiInitOver",this.LogoUiInitOver,this),this.pvPInfo=new d},IsCollisionWithPlayer:function(e,t){var n=c.BeginSample("PlayerManager::IsCollisionWithPlayer");if(e&&this.Player&&e.MyCollider&&this.Player.MyCollider&&e.MyCollider.world&&this.Player.MyCollider.world){var i=e.MyCollider.world.aabb.clone(),a=this.Player.MyCollider.world.aabb.clone();if(i.x=t.x,i.y=t.y,a.x=this.Player.node.x,a.y=this.Player.node.y,i.intersects(a))return c.EndSample(n),!0}return c.EndSample(n),!1},IsCollisionWithOtherPlayer:function(e,t){var n=c.BeginSample("PlayerManager::IsCollisionWithPlayer");for(var i in this.otherPlayerArray){var a=this.otherPlayerArray[i];if(a){if(!a.node.active)continue;if(e==a)continue;if(e.MyCollider.world&&a.MyCollider.world){var o=e.MyCollider.world.aabb.clone(),r=a.MyCollider.world.aabb.clone();if(o.x=t.x,o.y=t.y,r.x=a.node.x,r.y=a.node.y,o.intersects(r))return c.EndSample(n),!0}}}return c.EndSample(n),!1},Release:function(){window.GGameEntry.NotificationCenter.off("TankReborn",this.PlayerReborn,this),window.GGameEntry.NotificationCenter.off("onUpdateUsersInfo",this.onUpdateUsersInfo,this),window.GGameEntry.NotificationCenter.off("HeartResponse",this.HeartResponse,this),window.GGameEntry.NotificationCenter.off("UpdateGlobalConfig",this.updateGlobalConfig,this),window.GGameEntry.NotificationCenter.off("LogoUiInitOver",this.LogoUiInitOver,this),this.pvPInfo=null,this.MainPlayerGuid=0},LogoUiInitOver:function(e){this.PlayerCampType=0},HeartResponse:function(e){this.serverTime=e.detail.serverTime},onUpdateUsersInfo:function(e){var t=c.BeginSample("PlayerManager::onUpdateUsersInfo");if(window.GGameEntry.CurGamePlayType!==h.GamePlayType.GamePlayType_Network)return this.PlayerCampType=0,void c.EndSample(t);c.AssertCheck(window.GGameEntry.CurGamePlayType===h.GamePlayType.GamePlayType_Network,"只有PVP才会发送房间信息");var n=e.detail.jsonObject;if(null!==n){var a=n.SD.GetTeamInfo;for(i=0;i<a.BlueCampRoleInfo.length&&i<3;i++)a.BlueCampRoleInfo[i]&&""!==(r=a.BlueCampRoleInfo[i].OpenId)&&r===u.getOpenID()&&(this.PlayerCampType=o.EntityCampType.BlueTeam);for(i=0;i<a.RedCampRoleInfo.length&&i<6;i++)if(a.RedCampRoleInfo[i]){var r=a.RedCampRoleInfo[i].OpenId;""!==r&&r===u.getOpenID()&&(this.PlayerCampType=o.EntityCampType.RedTeam)}}c.EndSample(t)},updateGlobalConfig:function(e){this.UsingSimulate=window.GGameEntry.GlobalCfg.enableSimulatePath},update:function(e){window.GGameEntry.CurGamePlayType===h.GamePlayType.GamePlayType_Network&&(this.serverTime=this.serverTime+1e3*e)},PlayerReborn:function(e){if(this.Player){var t=c.BeginSample("PlayerManager::PlayerReborn");if(e.detail.guid==this.Player.Guid){this.Player.Reset();var n=this.getPlayerSpawnPoint();this.Player.node.active=!0,this.Player.setTankPosition(n),window.GGameEntry.BattleRoot.SetBattleViewTarget(this.Player.node);var i=this.Player.GetGuid(),a=new l;a.entityGUID=i,a.buffID=23,a.Send()}c.EndSample(t)}},CreatePlayer:function(){var e=c.BeginSample("PlayerManager::CreatePlayer"),t=cc.instantiate(this.PlayerPrefab);this.Player=t.getComponent("Player"),this.Player.SetEntityType(o.EntityType.EntityPlayer),this.Player.GenGUID();var n=this.Player.Guid;this.MapPlayerLayer.addChild(t),this.InstancePlayer(),c.AssertCheck(this.Player.Guid===n,"player guid 发生变化"),c.EndSample(e)},CreatePlayerFromServerData:function(e){var t=c.BeginSample("PlayerManager::CreatePlayerFromServerData");if(this.Player)this.Player.Reset(),this.Player.node.active=!0;else{var n=cc.instantiate(this.PlayerPrefab);this.Player=n.getComponent("Player"),this.Player.SetEntityType(o.EntityType.EntityPlayer),this.Player.InitWithServerData(window.GGameEntry,e),this.CreateNameAndHead(this.Player,e),this.MapPlayerLayer.addChild(n),window.GGameEntry.EntityManager.AddEntity(this.Player)}return this.Player.SetPlayerDataUsingServerData(e),this.MainPlayerGuid=this.Player.Guid,this.Player.setModelSprite(),window.GGameEntry.BattleRoot.SetBattleViewTarget(this.Player.node),window.GGameEntry.SoundManager.PlayPlayerBorn(),this.BindJoystick(this.Player),c.AssertCheck(0!==this.Player.Guid,"pvp player guid 不允许为0"),c.EndSample(t),this.Player},CreateNameAndHead:function(e,t){var n=t.Name;n&&0!==n.length||(n="Tmlja05hbWU="),n=window.GGameEntry.GBase64.decode(n);var i=t.Pic;i&&0!==i.length||(i="res/raw-assets/resources/Atlas/HeadIcon.png"),e.CreateFollowNameAndHeadImage(n,i,!1)},CreateOtherPlayerFromServerData:function(e){var t=c.BeginSample("PlayerManager::CreateOtherPlayerFromServerData");if(this.otherPlayerArray[e.ObjID])this.otherPlayerArray[e.ObjID].Reset(),this.otherPlayerArray[e.ObjID].node.active=!0,this.otherPlayerArray[e.ObjID].SetPlayerDataUsingServerData(e);else{var n=cc.instantiate(this.OtherPlayerPrefab),i=n.getComponent("OtherPlayer");i.SetEntityType(o.EntityType.EntityOtherPlayer),i.InitWithServerData(window.GGameEntry,e),this.CreateNameAndHead(i,e),this.MapPlayerLayer.addChild(n),window.GGameEntry.EntityManager.AddEntity(i),this.otherPlayerArray[e.ObjID]=i}c.EndSample(t)},InstancePlayer:function(){var e=c.BeginSample("PlayerManager::InstancePlayer"),t=this.getPlayerSpawnPoint();this.Player.setTankPosition(t),this.Player.SetConfigId(10001),this.Player.Init(window.GGameEntry),this.Player.EntityCampType=o.EntityCampType.BlueTeam,this.Player.EntityLineType=o.EntityLineType.Left;var n=u.getUserNickName(),i=u.getUserHeadURL();return this.Player.CreateFollowNameAndHeadImage(n,i,!1),window.GGameEntry.EntityManager.AddEntity(this.Player),window.GGameEntry.SoundManager.PlayPlayerBorn(),c.EndSample(e),this.Player},ReleasePlayer:function(){this.MapPlayerLayer.destroyAllChildren(),window.GGameEntry.UIManager.HeadImageLayer.destroyAllChildren(),window.GGameEntry.UIManager.NameLayer.destroyAllChildren(),this.Player=null,this.otherPlayerArray={},this.BindJoystick(null),this.MainPlayerGuid=0},RecyclePlayerNode:function(e){e.node.active=!1},RecycleOtherPlayerNode:function(e){e.node.active=!1},getPlayerSpawnPoint:function(){var e=c.BeginSample("PlayerManager::getPlayerSpawnPoint");if(window.GGameEntry.IsGuiding()){var t=window.GGameEntry.MapManager.GetWorldPos(1*a.MapGlobalCfg.MapTileSize[0],0*a.MapGlobalCfg.MapTileSize[1],!1);return t[0]+=50,t[1]+=50,c.EndSample(e),cc.v2(t[0],t[1])}var n=s.GetBirthPos(o.EntityCampType.BlueTeam,o.EntityLineType.Left);return c.EndSample(e),n},Pause:function(){if(this.Player&&this.Player.OnPause(),this.otherPlayerArray&&this.otherPlayerArray.length>0)for(var e=0;e<this.otherPlayerArray.length;e++)this.otherPlayerArray[e].OnPause&&this.otherPlayerArray[e].OnPause()},Resume:function(){if(this.Player&&this.Player.OnResume(),this.otherPlayerArray&&this.otherPlayerArray.length>0)for(var e=0;e<this.otherPlayerArray.length;e++)this.otherPlayerArray[e].OnPause&&this.otherPlayerArray[e].OnResume()},FindEntityByGUID:function(e){return this.Player&&this.Player.Guid===e?this.Player:null},RemoveEntityByGUID:function(e){this.Player&&this.Player.Guid},BindJoystick:function(e){var t=c.BeginSample("PlayerManager::BindJoystick"),n=window.GGameEntry.UIManager.GetActiveUI(r.UIType.JoyStickUI);if(n){var i=n.getComponent("Joystick");i&&i.setupPlayer(e)}c.EndSample(t)},GetMyCamp:function(){var e=o.EntityCampType.BlueTeam;return this.PlayerCampType&&(e=this.PlayerCampType),e},GetPlayerNames:function(){var e=new Array;if(e.push(this.Player.GetTankName()),window.GGameEntry.CurGamePlayType===h.GamePlayType.GamePlayType_Single)for(var t in window.GGameEntry.MonsterManager.monsterMap)e.push(window.GGameEntry.MonsterManager.monsterMap[t].GetTankName());else for(var t in this.otherPlayerArray)e.push(this.otherPlayerArray[t].GetTankName());return e}}),cc._RF.pop()},{AIMapUtil:"AIMapUtil",EntityManager:"EntityManager",EntityTypeDefine:"EntityTypeDefine",GlobalCfg:"GlobalCfg",MapCfg:"MapCfg",MsgPickUpItem:"MsgPickUpItem",PvPInfo:"PvPInfo",UIManager:"UIManager",Util:"Util",weixinmsgmgr:"weixinmsgmgr"}],PlayerSimulateMove:[function(e,t,n){"use strict";cc._RF.push(t,"70929cK9OxGXawnlZ/IHgI8","PlayerSimulateMove");var i=e("PlayerSimulatePoint"),a=e("Util"),o=e("ResTableNames");cc.Class({extends:cc.Component,properties:{m_bSimulating:{default:!1,serializable:!1,visible:!1}},onLoad:function(){},init:function(e){this.m_lastPoint||(this.m_lastPoint=new i,this.m_lastPoint.pos=cc.v2(0,0),this.m_lastPoint.dwTimeStamp=0),this.m_simulator||(this.m_simulator=new cc.Node,this.m_simulator.x=e.x,this.m_simulator.y=e.y,window.GGameEntry.PlayerManager.MapPlayerLayer.addChild(this.m_simulator))},relase:function(){this.m_simulator.removeFromParent(),this.m_simulator=null},insertMovePoint:function(e,t){this.movePointArray||(this.movePointArray=[]),this.moveRotateArray||(this.moveRotateArray=[]),this.movePointArray[this.movePointArray.length]=e,this.moveRotateArray[this.moveRotateArray.length]=t},setPosAndClearSitum:function(e){if(this.m_bSimulating){if(this.movePointArray.length){var t=cc.v2(this.movePointArray[this.movePointArray.length-1].pos.x,this.movePointArray[this.movePointArray.length-1].pos.y);e.canWalkDynamicObject(t)&&e.node.setPosition(t)}this.moveRotateArray.length&&e.rotateAll(this.moveRotateArray[this.moveRotateArray.length-1])}this.clearSimulatorPos()},getSimulatorPos:function(){return null!=this.m_simulator?this.m_simulator.position:cc.v2(0,0)},clearSimulatorPos:function(){this.m_simulator.stopAllActions(),this.movePointArray=[],this.moveRotateArray=[],this.m_bSimulating=!1},setSimulatorPos:function(e,t){this.m_simulator.setPosition(e,t)},getSimulatorRotate:function(){return null!=this.m_simulator?this.m_simulator.rotation:cc.v2(0,0)},updateSimulator:function(){if(!this.m_bSimulating&&this.movePointArray.length){var e=this.movePointArray[0];this.doMoveAction(e)}},doMoveAction:function(e){var t=parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(o.star_global_cs,24).Value),n=t,i=0;if(this.m_lastPoint){var r=a.BeginSample("PlayerSimulateMove::doMoveAction");1==this.movePointArray.length||0==this.m_lastPoint.dwTimeStamp?i=t-5:e.dwTimeStamp>this.m_lastPoint.dwTimeStamp?((i=e.dwTimeStamp-this.m_lastPoint.dwTimeStamp)>n&&(i=t-5),(i-=3)<=0&&(i=t/2)):i=t-5;var s=i/1e3;if(null!=this.m_simulator){var l=cc.v2(e.pos.x,e.pos.y),c=cc.moveTo(s,l),u=cc.callFunc(this.onMoveEnd,this),d=cc.sequence(c,u);this.m_simulator.runAction(d)}this.m_bSimulating=!0,a.EndSample(r)}},onMoveEnd:function(){var e=a.BeginSample("PlayerSimulateMove::onMoveEnd");if(this.m_lastPoint=this.movePointArray[0],this.movePointArray.shift(),this.m_simulator.rotation=this.moveRotateArray[0],this.moveRotateArray.shift(),this.m_bSimulating=!1,this.movePointArray.length){var t=this.movePointArray[0];(n=this.movePointArray[this.movePointArray.length-1]).dwTimeStamp-t.dwTimeStamp>500&&this.movePointArray.length>5&&(this.m_lastPoint=this.movePointArray[0],this.movePointArray.shift(),this.moveRotateArray.shift())}if(this.movePointArray.length){var n=this.movePointArray[0];this.doMoveAction(n)}a.EndSample(e)}}),cc._RF.pop()},{PlayerSimulatePoint:"PlayerSimulatePoint",ResTableNames:"ResTableNames",Util:"Util"}],PlayerSimulatePoint:[function(e,t,n){"use strict";cc._RF.push(t,"d5865g7+QxHIqHeOy/W7xFt","PlayerSimulatePoint"),cc.Class({extends:cc.Component,properties:{pos:{default:cc.v2(0,0),serializable:!1,visible:!1},dwTimeStamp:{default:0,serializable:!1,visible:!1}},onLoad:function(){}}),cc._RF.pop()},{}],Player:[function(e,t,n){"use strict";cc._RF.push(t,"770c3zq3GVFfZ1IaJvbgzZ1","Player");e("MapCfg");var i=e("Util"),a=(e("GameEntry"),e("EntityBase"),e("EntityTypeDefine"),e("TankAttr"),e("CmdBase"),e("CmdDefine"),e("SkillDefine")),o=(e("CmdSkill"),e("MsgUseSkill")),r=(e("PlayerManager"),e("PlayerAnimationCtrl"),e("NormalAttackSkill"),e("PickBufferSkill"),e("BattleDef"),e("star_comm"),e("PlayerBase")),s=e("ResTableNames"),l=(e("BattleSystem"),e("GlobalCfg"),e("TankMisc"));cc.Class({extends:r,properties:{HasLightningItem:{default:!1,serializable:!1,visible:!1},FlagSpeedSplit:{default:!0,serializable:!0,visible:!0},FlagSpeedSplitMinSpeed:{default:0,serializable:!0,visible:!0},TryShootCount:0,ConfigMinSpeed:0,UsingFloatMove:1,CannotStop:{default:!1,serializable:!1,visible:!1},attackRing:{default:null,type:cc.Node},lastOffsetDistance:{default:0},lastOffsetPointAdd:{default:cc.v2(0,0)},attackRingBG:{default:[],type:cc.SpriteFrame}},onLoad:function(){this._super()},start:function(){},Reset:function(){var e=i.BeginSample("Player::Reset");this._super(),this.Hp=this.MaxHp,this.TankHpControl.scaleX=1,this.TryShootCount=0,this.TankUI.Reset(),this.SetTankRing(),i.EndSample(e)},SetTankRing:function(){window.GGameEntry.GameConfig.hideAttackRing?this.attackRing.active=!1:this.attackRing.active=!0},Init:function(e){this._super(e),this.SetResID(1101,0),this.HasLightningItem=!1,this.MoveSpeedBonus=cc.v2(0,0),this.GlobalCfg=e.GlobalCfg,this.TankUI=this.TankUINode.getComponent("TankUI"),this.TankUI.Init(this.CurrentBulletLeftNum,this.CurrentBulletLeftNum,this.GetTankName()),this.maxMoveDistance=parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(s.star_global_cs,23).Value),this.InitEventAndAni(),this.ConfigMinSpeed=parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(s.star_global_cs,12).Value),window.GGameEntry.NotificationCenter.emit("PlayerBorn",{guid:this.Guid}),this.moveTime=25/this.CfgSourceConfigSpeed,this.moveTimeCount=this.moveTime+1,this.direction={x:0,y:0},this.destinationPos={x:0,y:0},this.SetTankRing()},InitEventAndAni:function(){window.GGameEntry.NotificationCenter.on("JoystickMove",this.PlayerMove,this),window.GGameEntry.NotificationCenter.on("JoystickRotate",this.PlayerRotate,this),window.GGameEntry.NotificationCenter.on("JoystickStopMove",this.PlayerStopMove,this),window.GGameEntry.NotificationCenter.on("SkillBtnJoystickMove",this.PaoTaiMove,this),window.GGameEntry.NotificationCenter.on("SkillBtnUp",this.SkillBtnUp,this),window.GGameEntry.NotificationCenter.on("UpdateGlobalConfig",this.UpdateGlobalConfig,this),window.GGameEntry.NotificationCenter.on("DirectionMove",this.DirectionMove,this),window.GGameEntry.NotificationCenter.on("OnAttackRingHide",this.SetTankRing,this),this.listener1=cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyPressed:this.onKeyPressed.bind(this),onKeyReleased:this.onKeyReleased.bind(this)},this.node)},InitWithServerData:function(e,t){this._super(e,t),this.SetPlayerDataUsingServerData(t),window.GGameEntry.NotificationCenter.emit("PlayerBorn",{guid:this.Guid})},UnInit:function(){},Release:function(){window.GGameEntry.NotificationCenter.off("JoystickMove",this.PlayerMove,this),window.GGameEntry.NotificationCenter.off("JoystickRotate",this.PlayerRotate,this),window.GGameEntry.NotificationCenter.off("JoystickStopMove",this.PlayerStopMove,this),window.GGameEntry.NotificationCenter.off("SkillBtnJoystickMove",this.PaoTaiMove,this),window.GGameEntry.NotificationCenter.off("SkillBtnUp",this.SkillBtnUp,this),window.GGameEntry.NotificationCenter.off("UpdateGlobalConfig",this.UpdateGlobalConfig,this),window.GGameEntry.NotificationCenter.off("DirectionMove",this.DirectionMove,this),window.GGameEntry.NotificationCenter.off("OnAttackRingHide",this.SetTankRing,this),cc.eventManager.removeListener(this.listener1)},UpdateGlobalConfig:function(){this.CfgSourceConfigSpeed=window.GGameEntry.GlobalCfg.TankMoveSpeed,this.FlagSpeedSplit=window.GGameEntry.GlobalCfg.TankHPControl},PaoTaiMove:function(e){var t=e.detail.angle;t<0&&(t+=360),t>=360&&(t%=360),this.PaoTaiNode.rotation=t<90?90-t:t>=90&&t<180?180-t+270:t>=180&&t<270?270-t+180:360-t+90},SkillBtnUp:function(e){this.EnableShootPowerFill=!0},PlayerMove:function(e){if(!window.GGameEntry.JoystickConfig.Config.MovingAfterRelease&&!this.Pause&&this.tankGamingStateType!==l.TankGamingStateType.TankGamingState_Skill_Flash){var t=i.BeginSample("Player::PlayerMove"),n=e.detail.angle;if(window.GGameEntry.BattleSystem.IsInvertWorld()){n=(n+180)%360;e.detail.speed}this.SetRotate(n),i.EndSample(t)}},PlayerRotate:function(e){if(!window.GGameEntry.JoystickConfig.Config.MovingAfterRelease&&!this.Pause){var t=i.BeginSample("Player::PlayerRotate"),n=e.detail.angle;if(window.GGameEntry.BattleSystem.IsInvertWorld()){n=(n+180)%360;e.detail.speed}this.UpdateDirectionArrow(n),i.EndSample(t)}},SetRotate:function(e){this.xDic=window.GGameEntry.MathUtil.cos(e),this.yDic=window.GGameEntry.MathUtil.sin(e),0==this.MoveSpeed.x&&0==this.MoveSpeed.y&&(this.currentSpeed=this.StartSpeed,this.MoveSpeed.x=this.StartSpeed*this.xDic,this.MoveSpeed.y=this.StartSpeed*this.yDic),this.UpdateDirectionArrow(e)},PlayerStopMove:function(){this.CannotStop||(this.DirectionX=0,this.DirectionY=0,this.MoveSpeed.x=0,this.MoveSpeed.y=0,this.currentSpeed=0)},setDestination:function(){var e={x:0,y:0};e.x=this.node.position.x,e.y=this.node.position.y,this.direction&&(e.x%this.TankWalkUnit!=0&&(this.direction.x>0?e.x=Math.ceil(e.x/this.TankWalkUnit)*this.TankWalkUnit:this.direction.x<0&&(e.x=Math.floor(e.x/this.TankWalkUnit)*this.TankWalkUnit)),e.y%this.TankWalkUnit!=0&&(this.direction.y>0?e.y=Math.ceil(e.y/this.TankWalkUnit)*this.TankWalkUnit:this.direction.y<0&&(e.y=Math.floor(e.y/this.TankWalkUnit)*this.TankWalkUnit))),this.destinationPos=e},checkDestination:function(){return Math.abs(this.node.position.x-this.destinationPos.x)+Math.abs(this.node.position.y-this.destinationPos.y)<10},onKeyPressed:function(e,t){switch(e){case cc.KEY.a:case cc.KEY.left:this.DirectionX=-1;break;case cc.KEY.d:case cc.KEY.right:this.DirectionX=1;break;case cc.KEY.w:case cc.KEY.up:this.DirectionY=1;break;case cc.KEY.s:case cc.KEY.down:this.DirectionY=-1}-1===this.DirectionX||this.DirectionX,this.xDic=this.DirectionX,this.yDic=this.DirectionY,0==this.MoveSpeed.x&&0==this.MoveSpeed.y&&(this.currentSpeed=this.StartSpeed,this.MoveSpeed.x=this.StartSpeed*this.xDic,this.MoveSpeed.y=this.StartSpeed*this.yDic),window.GGameEntry.BattleSystem.IsInvertWorld()&&(this.MoveSpeed.x=-this.MoveSpeed.x,this.MoveSpeed.y=-this.MoveSpeed.y)},onKeyReleased:function(e,t){switch(e){case cc.KEY.a:case cc.KEY.left:case cc.KEY.d:case cc.KEY.right:this.DirectionX=0,this.xDic=0,this.MoveSpeed.x=0;break;case cc.KEY.w:case cc.KEY.up:case cc.KEY.s:case cc.KEY.down:this.DirectionY=0,this.yDic=0,this.MoveSpeed.y=0;break;case cc.KEY.space:this.tryShoot()}},onCollisionEnter:function(e,t){this.onCollisionLogic(e,t)},onCollisionStay:function(e,t){},OnDie:function(){if(!this.DeadAni){var e=i.BeginSample("Player::Shoot");this.ResetBonusMove(),this._super(),this.DeadAni=!0,this.tankGamingStateType=l.TankGamingStateType.TankGamingState_Normal,this.PlayerStopMove(),this.node.stopAllActions(),window.GGameEntry.BattleRoot.ClearBattleViewTarget(),window.GGameEntry.SoundManager.PlayPlayerDie(),i.EndSample(e)}},ResetBonusMove:function(){this.bonusMove=!1,this.MoveSpeedBonus.x=0,this.MoveSpeedBonus.y=0},_DoDieAction:function(){this.node.active=!1,this.node.x=1e5,this.node.y=1e5},OnPause:function(){this.Pause=!0,cc.director.getScheduler().pauseTarget(this)},OnResume:function(){var e=i.BeginSample("Player::update");this.Pause=!1,cc.director.getScheduler().resumeTarget(this),i.EndSample(e)},InvincibleTimeout:function(){this.node.opacity=255,this.Invincible=!1},BecomeInvincible:function(e){if(!this.HasLightningItem){var t=i.BeginSample("Player::update");this.Invincible&&this.unschedule(this.InvincibleTimeout),this.Invincible=!0,this.node.opacity=128,this.schedule(this.InvincibleTimeout,e,0),i.EndSample(t)}},StopInvincible:function(){this.Invincible=!1,this.unschedule(this.InvincibleTimeout),this.node.opacity=255,this.Invincible=!1},tryShoot:function(){if(0!=this.node.active&&this.canShoot()){this.TryShootCount=this.TryShootCount+1;var e=new o;e.skillType=a.SkillType.SkillType_NormalAttack,e.entityGUID=this.Guid,e.skillArg=0,e.skillSeq=this.TryShootCount,e.dir=this.PaoTaiNode.rotation,e.Send()}},Shoot:function(e){if(0!=this.node.active){var t=i.BeginSample("Player::Shoot");this._super(e)&&this.TankUI.OnShootBullet(this.CurrentBulletLeftNum),i.EndSample(t)}},IsInPlayerView:function(e){var t=window.GGameEntry.BattleRoot.GetCameraViewArea();return e.x>t[0]&&e.x<t[2]&&e.y>t[1]&&e.y<t[3]},updateUiFillingBUllet:function(){var e=this.CurrentBulletFillTime/this.CfgBulletFillTime;this.TankUI.OnFillingBullet(this.CurrentBulletLeftNum,e)},setTankPosition:function(e){this._super(e),window.GGameEntry.BattleRoot.SetCameraPos(this.node.getPosition())},update:function(e){if(!this.Pause){var t=i.BeginSample("Player::update");if(e>.1){var n=(o=Math.sqrt(this.MoveSpeed.x*this.MoveSpeed.x+this.MoveSpeed.y*this.MoveSpeed.y))/this.maxMoveDistance;n<e&&(e=n)}if(this._super(e),0!=this.MoveSpeed.x||0!=this.MoveSpeed.y){this.CfgSourceConfigSpeed==this.StaticConfigSpeed?(this.currentSpeed<this.MidSpeed&&(this.currentSpeed+=this.SpeedUpSpeed1*e),this.currentSpeed>=this.MidSpeed&&this.currentSpeed<this.CfgSourceConfigSpeed&&(this.currentSpeed+=this.SpeedUpSpeed2*e),this.currentSpeed>this.CfgSourceConfigSpeed&&(this.currentSpeed=this.CfgSourceConfigSpeed)):this.currentSpeed=this.CfgSourceConfigSpeed,this.MoveSpeed.x=this.currentSpeed*this.xDic,this.MoveSpeed.y=this.currentSpeed*this.yDic;var a={x:0,y:0};a.x=this.direction.x,a.y=this.direction.y,this.direction.x=0,this.direction.y=0,0!=this.MoveSpeed.x&&(this.direction.x=this.MoveSpeed.x>0?1:-1),0!=this.MoveSpeed.y&&(this.direction.y=this.MoveSpeed.y>0?1:-1);var o,r=this.node.getPosition(),s=cc.v2(0,0);if(this.UsingFloatMove?(s.x=r.x+this.MoveSpeed.x*e,s.y=r.y+this.MoveSpeed.y*e):(s.x=Math.floor(r.x+this.MoveSpeed.x*e),s.y=Math.floor(r.y+this.MoveSpeed.y*e)),this.canWalk(s))this.setTankPosition(cc.p(s.x,s.y));else{if(0!=this.MoveSpeed.x){c=1;this.MoveSpeed.x<0&&(c=-1);u=this.CfgSourceConfigSpeed;if(this.FlagSpeedSplit&&(u=c*this.MoveSpeed.x+this.ConfigMinSpeed+this.FlagSpeedSplitMinSpeed)>this.CfgSourceConfigSpeed&&(u=this.CfgSourceConfigSpeed),this.UsingFloatMove?(s.x=r.x+c*u*e,s.y=r.y):(s.x=Math.floor(r.x+c*u*e),s.y=Math.floor(r.y)),this.canWalk(s))return this.setTankPosition(cc.p(s.x,s.y)),void i.EndSample(t)}if(0!=this.MoveSpeed.y){var c=1;this.MoveSpeed.y<0&&(c=-1);var u=this.CfgSourceConfigSpeed;if(this.FlagSpeedSplit&&(u=c*this.MoveSpeed.y+this.ConfigMinSpeed+this.FlagSpeedSplitMinSpeed)>this.CfgSourceConfigSpeed&&(u=this.CfgSourceConfigSpeed),this.UsingFloatMove?(s.x=r.x,s.y=r.y+c*u*e):(s.x=Math.floor(r.x),s.y=Math.floor(r.y+c*u*e)),this.canWalk(s))return this.setTankPosition(cc.p(s.x,s.y)),void i.EndSample(t)}}}else this.tankGamingStateType===l.TankGamingStateType.TankGamingState_Skill_Flash&&window.GGameEntry.BattleRoot.SetCameraPos(this.node.getPosition());i.EndSample(t)}},setModelSprite:function(){var e=window.GGameEntry.ResTableMgr.GetConfigByID(s.star_bullet_cs,this.ShootBulletId);if(e){var t;t=this.EntityCampType===window.GGameEntry.PlayerManager.Player.EntityCampType?e.BlueFort:e.RedFort,this.Sprite1Change.spriteFrame=this.SpAtlas.getSpriteFrame(t)}},DirectionMove:function(e){var t=e.detail;this.MoveSpeed.x=this.CfgSourceConfigSpeed*t.x,this.MoveSpeed.y=this.CfgSourceConfigSpeed*t.y;var n=this.ImageNode.rotation;1==t.x&&(n=90),-1==t.x&&(n=270),1==t.y&&(n=0),-1==t.y&&(n=180),this.moveTimeCount=this.moveTime+1,this.ImageNode.rotation=n,window.GGameEntry.GlobalCfg.useDoubleJoystick||(this.PaoTaiNode.rotation=this.ImageNode.rotation)}}),cc._RF.pop()},{BattleDef:"BattleDef",BattleSystem:"BattleSystem",CmdBase:"CmdBase",CmdDefine:"CmdDefine",CmdSkill:"CmdSkill",EntityBase:"EntityBase",EntityTypeDefine:"EntityTypeDefine",GameEntry:"GameEntry",GlobalCfg:"GlobalCfg",MapCfg:"MapCfg",MsgUseSkill:"MsgUseSkill",NormalAttackSkill:"NormalAttackSkill",PickBufferSkill:"PickBufferSkill",PlayerAnimationCtrl:"PlayerAnimationCtrl",PlayerBase:"PlayerBase",PlayerManager:"PlayerManager",ResTableNames:"ResTableNames",SkillDefine:"SkillDefine",TankAttr:"TankAttr",TankMisc:"TankMisc",Util:"Util",star_comm:"star_comm"}],PvPInfo:[function(e,t,n){"use strict";cc._RF.push(t,"5ed32r7+cFFi4jP4xkws8bD","PvPInfo"),cc.Class({extends:cc.Component,properties:{timeCost:{default:0},timeAllCost:{default:0}},onLoad:function(){},setRecTime:function(e){}}),cc._RF.pop()},{}],QunUserDataMgr:[function(e,t,n){"use strict";function i(){return h}function a(e){return e<=0||e>=c.STATISTICS_TYPE_MAX?(console.error("GetUserBattleIdx error type:"+e),-1):e-1}function o(e,t){if(0===e)return 0;var n=parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(u.star_global_cs,38).Value),i=parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(u.star_global_cs,39).Value),a=parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(u.star_global_cs,40).Value),o=parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(u.star_global_cs,41).Value),r=parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(u.star_global_cs,44).Value),s=t/e,l=n*Math.pow(t,i/r)*a*Math.pow(s,o)/10;return 10*Math.floor(l)}function r(){var e=i();if(void 0!==d&&Object.keys(d).length>0)if(void 0!==e&&Object.keys(e).length>0){console.log("CombineUserBattleAndPersonalInfo begin");for(var t=0;t<d.Num&&t<l.MAX_WX_GROUP_OPENID_LIST_NUM;++t)for(var n=d.RoleRankInfoList[t].O,r=0;r<e.Num&&r<d.Num;++r)if(n===e.NamePicInfoList[r].O){d.RoleRankInfoList[t].name=e.NamePicInfoList[r].N,d.RoleRankInfoList[t].pic=e.NamePicInfoList[r].P,d.RoleRankInfoList[t].battle=0;var s=a(c.STATISTICS_TYPE.STATISTICS_TYPE_GAME_COUNT),u=a(c.STATISTICS_TYPE.STATISTICS_TYPE_WIN_GAME_COUNT);if(s>=0&&u>=0&&s<d.RoleRankInfoList[t].N&&u<d.RoleRankInfoList[t].N){var h=o(d.RoleRankInfoList[t].R[s],d.RoleRankInfoList[t].R[u]);d.RoleRankInfoList[t].battle=Math.round(h)}break}}else console.log("CombineUserBattleAndPersonalInfo userPersonalInfo undefined");else console.log("CombineUserBattleAndPersonalInfo userBattleInfo undefined");console.log("CombineUserBattleAndPersonalInfo end")}function s(e,t){return t?function(t,n){return t[e]>n[e]?-1:t[e]<n[e]?1:0}:function(t,n){return t[e]<n[e]?-1:t[e]>n[e]?1:0}}cc._RF.push(t,"bc2f7gZXY5N5qmZbDP/BcEB","QunUserDataMgr");var l=e("star_cs"),c=e("star_macro"),u=e("ResTableNames"),d=(e("weixinmsgmgr"),{}),h={},f=[],m={};t.exports={GetQunUserData:function(){f=[];for(i=0;i<6;++i)f[i]=new String,f[i].openid="0";var t=e("loginServerMgr").onGetTeamInfo();if(void 0!==t){for(var n=t.SD.GetTeamInfo,i=0;i<n.BlueCampRoleInfo.length&&i<3;i++)""!==n.BlueCampRoleInfo[i].OpenId&&(f[i].openid=n.BlueCampRoleInfo[i].OpenId);for(i=0;i<n.RedCampRoleInfo.length&&i<3;i++)""!==n.RedCampRoleInfo[i].OpenId&&(f[i+3].openid=n.RedCampRoleInfo[i].OpenId)}return f},ClearQunUserData:function(){},GetQunUserOpenid:function(e){if(void 0!==m&&0!==Object.keys(m).length){var t=new Array;t[0]=m.id0,t[1]=m.id1,t[2]=m.id2,t[3]=m.id3,t[4]=m.id4,t[5]=m.id5;for(var n=0,i=0;i<6;++i)"0"!==t[i]&&(e.OpenidList[n]=new l.OpenidData,e.OpenidList[n].O=t[i],n++);e.Num=n}else console.error("GetQunUserOpenid globalShareUserData is null")},SetUserBattleInfo:function(e){d=e},GetUserBattleInfo:function(){return d},SetUserPersonalInfo:function(e){h=e},GetUserPersonalInfo:i,CombineUserBattleAndPersonalInfo:r,sortUserBattle:function(){r(),d.Num>0&&(d.RoleRankInfoList.sort(s("O",!0)),d.RoleRankInfoList.sort(s("battle",!0)))},setShareUserData:function(e){m=e},getShareUserData:function(){return m},GetUserBattleValue:o},cc._RF.pop()},{ResTableNames:"ResTableNames",loginServerMgr:"loginServerMgr",star_cs:"star_cs",star_macro:"star_macro",weixinmsgmgr:"weixinmsgmgr"}],RadarUI:[function(e,t,n){"use strict";cc._RF.push(t,"d7a36NkIsxLWpvgqy3SFwgW","RadarUI"),cc.Class({extends:cc.Component,properties:{TargetSprite:{default:null,visible:!1}},SetMesh:function(e){if(this.TargetSprite||(this.TargetSprite=this.node.getComponent(cc.Sprite)),null!=e&&this.TargetSprite&&this.TargetSprite._sgNode&&"function"==typeof this.TargetSprite._sgNode.setMeshPolygonInfo){var t=0,n=0,i=1,a=1,o=this.TargetSprite.spriteFrame;if(o){var r=o._texture;r&&(t=o._rect.x/r.width,n=o._rect.y/r.height,i=o._rect.width/r.width,a=o._rect.height/r.height)}var s=this.node.width,l=this.node.height,c=this.node.position;this.PointCount=e.length;for(var u={triangles:{verts:[],indices:[]},rect:new cc.Rect(c.x,c.y,s,l)},d=0;d<this.PointCount;d++){var h={};h.x=e[d].x+s/2,h.y=e[d].y+l/2,h.u=t+i*(h.x/s),h.v=n+a*(1-h.y/l),u.triangles.verts[d]=h}for(var f=0,d=0;d<this.PointCount-2;d++)u.triangles.indices[f]=0,f++,u.triangles.indices[f]=d+1,f++,u.triangles.indices[f]=d+2,f++;this.TargetSprite._sgNode.setMeshPolygonInfo(u)}}}),cc._RF.pop()},{}],RandomNameUtil:[function(e,t,n){"use strict";cc._RF.push(t,"05d8bwhjSVMwo5e1DKhXIcZ","RandomNameUtil");var i=e("ResTableNames"),a=[];t.exports={TankNamePool:a,CanUseName:function(e){for(var t=0;t<this.TankNamePool.length;t++)if(this.TankNamePool[t]===e)return!1;return!0},GetTankRandomName:function(){for(var e=window.GGameEntry.ResTableMgr.GetTableByName(i.star_random_names_a_c),t=window.GGameEntry.ResTableMgr.GetTableByName(i.star_random_names_c_c),n=this.GetNameRandom(e,t);!this.CanUseName(n);)n=this.GetNameRandom(e,t);return this.TankNamePool[this.TankNamePool.length]=n,n},GetNameRandom:function(e,t){return this.GetRandomNameInCollection(e)+this.GetRandomNameInCollection(t)},GetRandomNameInCollection:function(e){if(e){var t=e.length-1;return e[(Math.random()*t).toFixed(0)].Name}}},cc._RF.pop()},{ResTableNames:"ResTableNames"}],RankItemUI:[function(e,t,n){"use strict";cc._RF.push(t,"e3f99cBEbtDg6Nm/MHjbAO1","RankItemUI");var i=e("HeadImageUtil"),a=new cc.Color(233,192,0),o=new cc.Color(175,199,200),r=new cc.Color(196,148,71),s=new cc.Color(187,187,187);cc.Class({extends:cc.Component,properties:{RankOrderLabel:{default:null,type:cc.Label},HeadIconSprite:{default:null,type:cc.Sprite},NameLabel:{default:null,type:cc.Label},TitleLabel:{default:null,type:cc.Label},ScoreLabel:{default:null,type:cc.Label}},init:function(e,t,n,l,c){this.RankOrderLabel.string=e;var u=s;1===e?u=a:2===e?u=o:3===e&&(u=r),this.RankOrderLabel.node.color=u,i.loadImageFromNetUrl(this.HeadIconSprite,t),this.NameLabel.string=window.GGameEntry.GBase64.decode(n),this.TitleLabel.string=l,this.ScoreLabel.string=c}}),cc._RF.pop()},{HeadImageUtil:"HeadImageUtil"}],RankUI:[function(e,t,n){"use strict";cc._RF.push(t,"7af97Raw21OY4ajdpb/WlCw","RankUI");var i=e("QunUserDataMgr"),a=e("PlatformUtil"),o=e("UIManager"),r=(e("JsonUtils"),e("ResTableNames"));cc.Class({extends:cc.Component,properties:{RankItemPrefab:{default:null,type:cc.Prefab},CacheItemList:{default:[],type:cc.Node},ScrollViewContent:{default:null,type:cc.Node},MsgNode:{default:null,type:cc.Node},MsgContentLabel:{default:null,type:cc.Label}},onEnable:function(){this.MsgNode.active=!1,i.sortUserBattle(),this.initData()},onDisable:function(){this.ScrollViewContent.destroyAllChildren(),window.GGameEntry.NotificationCenter.emit("onChangeBtnState",{bShow:!0})},initData:function(){var e=[],t=i.GetUserBattleInfo();if(void 0!==t&&Object.keys(t).length>0&&0===t.Num)return this.MsgContentLabel.string="只能查看群排行",void(this.MsgNode.active=!0);for(var n=[window.GGameEntry.ResTableMgr.GetConfigByID(r.star_client_c,79).Context,window.GGameEntry.ResTableMgr.GetConfigByID(r.star_client_c,80).Context,window.GGameEntry.ResTableMgr.GetConfigByID(r.star_client_c,81).Context,window.GGameEntry.ResTableMgr.GetConfigByID(r.star_client_c,82).Context,window.GGameEntry.ResTableMgr.GetConfigByID(r.star_client_c,83).Context],a=0;a<t.Num;a++){var o={order:a+1,nameString:t.RoleRankInfoList[a].name,headImageUrl:t.RoleRankInfoList[a].pic,titleString:a<n.length?n[a]:"",score:t.RoleRankInfoList[a].battle};e.push(o)}for(var s=0;s<e.length;s++){var l=cc.instantiate(this.RankItemPrefab);l.setParent(this.ScrollViewContent),l.setPosition(110*s-455,-355);var c=l.getComponent("RankItemUI");c&&c.init(e[s].order,e[s].headImageUrl,e[s].nameString,e[s].titleString,e[s].score)}},OnBtnReturn:function(){console.log("RankUI onBtnReturn"),window.GGameEntry.UIManager.HideUI(o.UIType.RankUI)},shareAppMsgCallback:function(e,t,n,i,a){},OnShareBtnClicked:function(){if(a.IsWeichatGame()){var t=e("weixininterface"),n=e("QunUserDataMgr").getShareUserData();if(null===n||void 0===n){var i=window.GGameEntry.ResTableMgr.GetConfigByID(r.star_client_c,78).Context;return this.MsgContentLabel.string=i,void(this.MsgNode.active=!0)}var o="uipath=RecordUI";o+="&id0="+n.id0,o+="&id1="+n.id1,o+="&id2="+n.id2,o+="&id3="+n.id3,o+="&id4="+n.id4,o+="&id5="+n.id5;var s=""===window.GGameEntry.shareranktips?"一炮绝杀，谁与争锋！":window.GGameEntry.shareranktips;t.onShareMsgInGame(s,o,""===window.GGameEntry.sharerankurl?"https://cdn.bt.qq.com/Config/Release/pic/ShareRank.png":window.GGameEntry.sharerankurl,this.shareAppMsgCallback)}},HideMsgBox:function(){this.MsgNode.active=!1},OnExitBackToWXBtnClicked:function(){a.IsWeichatGame()&&wx.exitMiniProgram()}}),cc._RF.pop()},{JsonUtils:"JsonUtils",PlatformUtil:"PlatformUtil",QunUserDataMgr:"QunUserDataMgr",ResTableNames:"ResTableNames",UIManager:"UIManager",weixininterface:"weixininterface"}],RecordUI:[function(e,t,n){"use strict";cc._RF.push(t,"aa43fM/c3VLDqauuG3pmjZl","RecordUI");var i=e("UIManager"),a=e("HeadImageUtil"),o=e("PlatformUtil"),r=e("SimpleLabel"),s=e("ResTableNames"),l=new cc.Color(255,164,0),c=new cc.Color(136,70,42);cc.Class({extends:cc.Component,properties:{ContentNode:{default:null,type:cc.Node},HeadIcon:{default:null,type:cc.Sprite},NameLabel:{default:null,type:cc.Label},WinCountLabel:{default:null,type:r},WinPossibleLabel:{default:null,type:r},LoseCountLabel:{default:null,type:r},AllKillCountLabel:{default:null,type:r},AllDeadCountLabel:{default:null,type:r},AllBlockCountLabel:{default:null,type:r},OrangeLine:{default:null,type:cc.Node},WeekBtnLabel:{default:null,type:cc.Label},HistoryBtnLabel:{default:null,type:cc.Label}},onEnable:function(){var t=e("loginServerMgr"),n=e("weixinmsgmgr"),i=n.getUserNickName(),o=n.getUserHeadURL();this.NameLabel.string=i,a.loadImageFromNetUrl(this.HeadIcon,o),this.recordData=t.onGetPlayerResultInfo(),this.reset()},reset:function(){if(this.OrangeLine.setPosition(-262,-8),this.HistoryBtnLabel.node.color=c,this.WeekBtnLabel.node.color=l,this.recordData){var e=this.recordData;this.WinCountLabel.SetString(e.WeekWinGameCount.toString()),0===e.WeekGameCount?this.WinPossibleLabel.SetString("0"):this.WinPossibleLabel.SetString((100*e.WeekWinGameCount/e.WeekGameCount).toFixed(0).toString()),this.LoseCountLabel.SetString(e.WeekGameCount.toString()),this.AllKillCountLabel.SetString(e.WeekKillCount.toString()),this.AllDeadCountLabel.SetString(e.WeekDeathCount.toString()),this.AllBlockCountLabel.SetString(e.WeekKillBrickCount.toString())}},onWeekBtnClicked:function(){this.reset()},onHistoryBtnClicked:function(){if(this.OrangeLine.setPosition(262,-8),this.HistoryBtnLabel.node.color=l,this.WeekBtnLabel.node.color=c,this.recordData){var e=this.recordData;this.WinCountLabel.SetString(e.WinGameCount.toString()),0===e.GameCount?this.WinPossibleLabel.SetString("0"):this.WinPossibleLabel.SetString((100*e.WinGameCount/e.GameCount).toFixed(0).toString()),this.LoseCountLabel.SetString(e.GameCount.toString()),this.AllKillCountLabel.SetString(e.KillCount.toString()),this.AllDeadCountLabel.SetString(e.DeathCount.toString()),this.AllBlockCountLabel.SetString(e.KillBrickCount.toString())}},onDisable:function(){window.GGameEntry.NotificationCenter.emit("onChangeBtnState",{bShow:!0})},OnDismiss:function(){window.GGameEntry.UIManager.HideUI(i.UIType.RecordUI)},shareAppMsgCallback:function(e,t,n,i,a){},OnShareBtnClicked:function(){if(o.IsWeichatGame()){var t=e("weixininterface"),n=e("QunUserDataMgr").GetQunUserData();if(null===n){var i=window.GGameEntry.ResTableMgr.GetConfigByID(s.star_client_c,78).Context;return void window.GGameEntry.UIManager.ShowMsgBox(i)}for(var a="uipath=RecordUI",r=0;r<6;r++)a+="&id"+r+"="+n[r].openid;var l=""===window.GGameEntry.shareRecordtips?"本局玩家战力排行榜在此，看看你排第几":window.GGameEntry.shareRecordtips;t.onShareMsgInGame(l,a,""===window.GGameEntry.sharerankurl?"https://cdn.bt.qq.com/Config/Release/pic/ShareRank.png":window.GGameEntry.sharerankurl,this.shareAppMsgCallback)}},OnShareRecordBtnClicked:function(){o.IsWeichatGame()&&wx.captureScreen({success:function(e){e.tempFilePath&&wx.shareAppMessage({title:"战绩分享",imageUrl:e.tempFilePath,query:"",success:function(e){},fail:function(){}})}})}}),cc._RF.pop()},{HeadImageUtil:"HeadImageUtil",PlatformUtil:"PlatformUtil",QunUserDataMgr:"QunUserDataMgr",ResTableNames:"ResTableNames",SimpleLabel:"SimpleLabel",UIManager:"UIManager",loginServerMgr:"loginServerMgr",weixininterface:"weixininterface",weixinmsgmgr:"weixinmsgmgr"}],ResCfgDef:[function(e,t,n){"use strict";cc._RF.push(t,"deef2FuzzlHvLy+28w40JtO","ResCfgDef");var i=cc.Enum({H:0,M:1,L:2,A:3}),a=cc.Enum({JiShaZhenPing:1,CaoCongDouDong:2,ZiDanZhuangTian:3,TouXiangChongSheng:4,TankChangeMode:5,BianJieWai:6,JiaSuDiKuai:7,JiaSuTuoWei:8,DaoJuTuBiao:9,LianShaXiaoGuo:10,ZiDanSheKongBaoZha:11,ZiDanFireEffect:12}),o=cc.Enum({Own:0,N:1,All:2}),r=cc.Enum({Y:0,N:1}),s=cc.Enum({Step:0,Once:1}),l=cc.Enum({Count5:0,Once:1}),c=cc.Enum({Y:0,N:1}),u=cc.Enum({Y:0,N:1}),d=cc.Enum({D:0,S:1}),h=cc.Enum({Y:0,N:1}),f=cc.Enum({DE:0,D:1,S:2}),m=cc.Enum({Y:0,N:1}),y=cc.Enum({Y:0,N:1}),p=cc.Enum({All:0,Simple:1,NONE:2});t.exports={ResCfgType:i,ProgramEffType:a,PEJiShaZhenPing:o,PECaoCongDouDong:r,PEZiDanZhuangTian:s,PETouXiangChongSheng:l,PETankChangeMode:c,PEBianJieWai:u,PEJiaSuDiKua:d,PEJiaSuTuoWei:h,PEDaoJuTuBiao:f,PELianShaXiaoGuo:m,PEZiDanSheKongBaoZha:y,PEZiDanFireEffect:p},cc._RF.pop()},{}],ResManager:[function(e,t,n){"use strict";cc._RF.push(t,"78f18mna4BMq6towf84D05v","ResManager");var i=e("PlatformUtil"),a=e("ResTableNames"),o=(e("EntityTypeDefine"),e("Util")),r=e("ResCfgDef").ResCfgType,i=e("PlatformUtil"),s=e("GlobalCfg"),l=e("loginServerMgr");cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.EnableFPSCheck=!1,this.CurResType=r.M,this.LastFPSAvg=0,this.SetByCustomValue=!1,this.FPSAvg=0,this.FPSTotalCount=0,this.FPSTotalTime=0,this.ResTemplate={},this.ResTemplateLoaded=!1,this.ResTemplateLoadingCount=0,this.CfgRange=[{Min:32,Max:100,RT:r.H},{Min:20,Max:40,RT:r.M},{Min:0,Max:28,RT:r.L}],this.ResDefMap={},this.ResDefKey=[],this.ProgramEffMap={}},OnSvrConfigLoaded:function(){"number"==typeof window.GGameEntry.EffPAvgFPS&&(this.LastFPSAvg=window.GGameEntry.EffPAvgFPS),"number"==typeof window.GGameEntry.EffPRangeH&&(this.CfgRange[r.H].Min=window.GGameEntry.EffPRangeH),"number"==typeof window.GGameEntry.EffPRangeL&&(this.CfgRange[r.L].Max=window.GGameEntry.EffPRangeL),"number"==typeof window.GGameEntry.EffPRangeMMax&&(this.CfgRange[r.M].Max=window.GGameEntry.EffPRangeMMax),"number"==typeof window.GGameEntry.EffPRangeMMin&&(this.CfgRange[r.M].Min=window.GGameEntry.EffPRangeMMin)},ProcessFirstTime:function(){var e=i.getDeviceSystemAllInfo();if(e){if(0===e.system.indexOf("iOS ")){var t=e.model;if(0===t.indexOf("iPhone ")){var n=t.slice("iPhone ".length);if(n.length>0){var a=parseInt(n.slice(0,1));if(a<=5)this.CurResType=r.L,this.LastFPSAvg=this.CfgRange[r.L].Min;else if(6===a){var o=e.system.slice("iOS ".length);o.length>0&&parseInt(o.slice(0,1))>=11&&(this.CurResType=r.L,this.LastFPSAvg=this.CfgRange[r.L].Min)}}}}}},Init:function(){this.OnSvrConfigLoaded(),this.LoadLOT()||this.ProcessFirstTime(),this.CalResTypeByLastFPS(!0);var e=window.GGameEntry.ResTableMgr.GetTableByName(a.star_eff_res_cfg_c);if(e&&e.length>0)for(var t=e.length,n=0;n<t;n++){var i=e[n],r=this.GetRealName(i.H);this.ResDefMap[r]=i,this.ResDefKey[this.ResDefKey.length]=r}var s=window.GGameEntry.ResTableMgr.GetTableByName(a.star_program_eff_cfg_c);if(s&&s.length>0)for(var t=s.length,n=0;n<t;n++){var i=s[n],l=o.TableStr2Num(i.ID),c=o.TableStr2Num(i.H),u=o.TableStr2Num(i.M),d=o.TableStr2Num(i.L);this.ProgramEffMap[l]={H:c,M:u,L:d}}},Release:function(){for(var e in this.ResTemplate){var t=this.ResTemplate[e];t&&t instanceof cc.Prefab&&(cc.loader.release(t,cc.Prefab),this.ResTemplate[e]=null)}this.ResTemplate={},this.ResTemplateLoaded=!1},IsH:function(){return this.CurResType===r.H},IsM:function(){return this.CurResType===r.M},IsL:function(){return this.CurResType===r.L},GetRealName:function(e){var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)},CalPlayerCount:function(){var e=l.onGetTeamInfo();{if(null!==e){for(var t=0,n=e.SD.GetTeamInfo,i=0;i<3;i++)i<n.BlueCampRoleInfo.length&&""!=n.BlueCampRoleInfo[i].OpenId&&t++;for(i=0;i<3;i++)i<n.RedCampRoleInfo.length&&""!=n.RedCampRoleInfo[i].OpenId&&t++;return t}cc.error("team info is null")}},SetByCustom:function(e){this.SetByCustomValue=e,i.SetValue("SetByCustomValue",this.SetByCustomValue)},SaveLOT:function(e){(e||this.CheckCal())&&(this.LastFPSAvg=this.FPSAvg,i.SetValue("LastFPSAvg",this.LastFPSAvg))},LoadLOT:function(){var e=i.GetValue("SetByCustomValue");e&&(this.SetByCustomValue=e);var t=i.GetValue("LastFPSAvg");return null!=t&&(this.LastFPSAvg=t,!0)},CheckCal:function(){return!this.SetByCustomValue&&window.GGameEntry.CurGamePlayType!==s.GamePlayType.GamePlayType_Single&&!(this.CalPlayerCount()<4)},CalResTypeByLastFPS:function(e){if((e||this.LastFPSAvg&&this.CheckCal())&&!(this.LastFPSAvg>=this.CfgRange[this.CurResType].Min&&this.LastFPSAvg<=this.CfgRange[this.CurResType].Max)){for(var t=this.LastFPSAvg>this.CfgRange[this.CurResType].Max?-1:1,n=this.CurResType+t;;){if(n<r.H||n>r.L)break;var i=this.CfgRange[n].Min,a=this.CfgRange[n].Max;if(this.LastFPSAvg>=i&&this.LastFPSAvg<=a)break;n+=t}this.CurResType=n,cc.log("this.CurResType:"+this.CurResType)}},GetResName:function(e){e=this.GetRealName(e);var t=this.ResDefMap[e];if(!t)return cc.error("res not found in ResManager.",e),e;if(this.CurResType===r.H)return e;var n=this.CurResType===r.M?t.M:t.L;return"string"==typeof n?this.GetRealName(n):null},GetResPrefab:function(e){var t=this.GetResName(e);return t?this.ResTemplate[t]?this.ResTemplate[t]:(cc.error("prefab not found!!!",e),null):null},BeginFPSCheck:function(){this.EnableFPSCheck=!0,this.FPSAvg=0,this.FPSTotalCount=0,this.FPSTotalTime=0},EndFPSCheck:function(){this.EnableFPSCheck=!1,this.SaveLOT()},PreLoadRes:function(e){this.CalResTypeByLastFPS();var t=function(){window.GGameEntry.AnimationManager.preLoadAnimation(),window.GGameEntry.AirDropSystem.Init(),window.GGameEntry.BulletManager.Preload(),e&&e()};this.PreLoadEffTemplate(function(){window.GGameEntry.BattleItemCacheManager.PreLoadAllTemplate(t)})},PreLoadEffTemplate:function(e){this.ResTemplateLoaded=!1,this.ResTemplateLoadingCount=0;for(var t=[],n=0;n<this.ResDefKey.length;n++){var i=this.ResDefKey[n];if((s=this.GetResName(i))&&!this.ResTemplate[s]){var a=this.ResDefMap[i];a&&(this.CurResType===r.H?t[t.length]=a.H:this.CurResType===r.M?t[t.length]=a.M:this.CurResType===r.L&&(t[t.length]=a.L))}}if(0===t.length)return this.ResTemplateLoaded=!0,void(e&&e());for(var o=this,n=0;n<t.length;n++){var s=t[n];o.ResTemplateLoadingCount++;var l=-1===s.indexOf("/")?"Prefabs/Effect/"+s:s;cc.loader.loadRes(l,function(t,n){o.ResTemplateLoadingCount--,t?cc.error(t.message||t):(n instanceof cc.Prefab?o.ResTemplate[n.name]=n:cc.error("Should be Prefab"),0===o.ResTemplateLoadingCount&&(o.ResTemplateLoaded=!0,e&&e()))})}},GetProgramEffCfg:function(e){var t=this.ProgramEffMap[e];if(!t)return null;var n=null;return this.CurResType===r.H?n=t.H:this.CurResType===r.M?n=t.M:this.CurResType===r.L&&(n=t.L),n},update:function(e){this.EnableFPSCheck&&(this.FPSTotalCount++,this.FPSTotalTime+=e,this.FPSAvg=this.FPSTotalCount/this.FPSTotalTime)}}),cc._RF.pop()},{EntityTypeDefine:"EntityTypeDefine",GlobalCfg:"GlobalCfg",PlatformUtil:"PlatformUtil",ResCfgDef:"ResCfgDef",ResTableNames:"ResTableNames",Util:"Util",loginServerMgr:"loginServerMgr"}],ResTableMgr:[function(e,t,n){"use strict";cc._RF.push(t,"c7ea392QBxNYJqviJ1qBDrn","ResTableMgr");var i=e("ResTableNames"),a=e("Util"),o=e("PlatformUtil");cc.Class({properties:{ResTableList:{default:null,serializable:!1,visible:!1},LoadPorgress:{default:null,serializable:!1,visible:!1}},Init:function(){this.ResTableList=[],this.LoadPorgress={totalcnt:0,successcnt:0,failedtables:[],complete:!1},this.LoadResTable()},LoadResTable:function(){var e=null;for(var t in i){this.LoadPorgress.totalcnt++;var n=t+".json";if(e=cc.url.raw("resources/Config/"+n),o.IsWeichatGame()){var a=cc.downLoadFiles[n];void 0!==a&&""!==a&&(e=a)}cc.loader.load(e,function(e,n,i){return function(a,o){cc.log("length=%d",e.ResTableList.length),a?(cc.error("load restable [%s],index=[%d] failed,err:%d",i,n,a.status),e.ResTableList[n]=null,e.LoadPorgress.failedtables.push(t)):(e.ResTableList[n]=o,cc.log("load restable[%s],index=[%d] success",i,n),e.LoadPorgress.successcnt++,e.LoadPorgress.totalcnt===e.LoadPorgress.successcnt&&(e.LoadPorgress.complete=!0))}}(this,i[t],e))}},GetLoadProgress:function(){return this.LoadPorgress},GetConfigByID:function(e,t){if(e<0||e>=this.ResTableList.length)return null;if(null==this.ResTableList[e])return null;var n=a.BeginSample("ResTable::GetConfigByID"),i=this.ResTableList[e],o=null,r=i.TResHeadAll.resHead.Count;for(var s in this.ResTableList[e])if("TResHeadAll"!=s){o=i[s];break}if(null==o||0==r)return null;if(1==r){if(o.ID==t)return o}else for(var l=0,c=r-1,u=0;l<=c;){if(u=(l+c)/2,u=Math.floor(u),parseInt(o[u].ID)==t)return a.EndSample(n),o[u];parseInt(o[u].ID)<t?l=u+1:c=u-1}return a.EndSample(n),null},GetObjectByName:function(e){return e<0||e>=this.ResTableList.length||null==this.ResTableList[e]?null:this.ResTableList[e]},GetTableByName:function(e){if(e<0||e>=this.ResTableList.length||null==this.ResTableList[e])return null;var t=a.BeginSample("ResTable::GetTableByName"),n=this.ResTableList[e],i=null,o=n.TResHeadAll.resHead.Count;for(var r in this.ResTableList[e])if("TResHeadAll"!=r){i=n[r];break}if(1==o){var s=[];return s.push(i),a.EndSample(t),s}return a.EndSample(t),i},GetTableRecordNum:function(e){return e<0||e>=this.ResTableList.length||null==this.ResTableList[e]?0:this.ResTableList[e].TResHeadAll.resHead.Count}}),cc._RF.pop()},{PlatformUtil:"PlatformUtil",ResTableNames:"ResTableNames",Util:"Util"}],ResTableNames:[function(e,t,n){"use strict";cc._RF.push(t,"6994cnKnslOHqEu1mLu/1WW","ResTableNames");var i=cc.Enum({star_item_drop_cs:1,bevtree_left_easy:2,bevtree_right_easy:3,bevtree_mid_easy:4,bevtree_left_hard:5,bevtree_right_hard:6,bevtree_mid_hard:7,star_tank_cs:8,star_bullet_cs:9,star_item_cs:10,star_random_names_a_c:11,star_random_names_b_c:12,star_random_names_c_c:13,star_buff_cs:14,bevtree_left_normal:15,bevtree_right_normal:16,bevtree_mid_normal:17,star_map_erase_s:18,star_global_cs:19,star_map_desc_cs:20,star_guide_c:21,star_brick_drop_cs:22,star_chest_cs:23,star_tips_c:24,star_eff_res_cfg_c:25,star_program_eff_cfg_c:26,star_game_model_cs:27,star_item_buffer_c:28,star_client_c:29,star_bornpos_cs:30,star_gm_command_c:31});t.exports=i,cc._RF.pop()},{}],ResUpdate:[function(e,t,n){"use strict";cc._RF.push(t,"690a61aHrdF2ZCaG5/EvC5j","ResUpdate");e("Util");var i,a=e("PlatformUtil"),o=(e("DownLoad"),e("JsonUtils"),e("TipsMsgBox")),r=e("UpdateUtils"),s=new cc.EventTarget,l=!1,c=0,u=[],d=0;cc.Class({extends:r,properties:{Title:{default:null,type:cc.Label},Step:0,CDTime:{default:3.6,type:cc.Float},studioBg:{default:null,url:cc.AudioClip},TimeOutSeconds:{default:10,type:cc.Integer},tipsMsgBox:{default:null,type:o},bRunNextScene:!1},fitiPhoneXScreen:function(){if(a.isTargetDevice("iPhone X")){var e=this.node.getChildByName("LQLogoUI");e&&(e.scaleX=.8,e.scaleY=.8)}},onLoad:function(){d=0,this.fitiPhoneXScreen(),(i=this).Init(),cc.downLoadFiles={},s.on("OnFailEvent",this.onFailEvent,this),this.logoTime=0,l=!1,i.ReadConfig(this.onReadConfig),this.PlayStudioBg()},onFailEvent:function(e){d>=2?i.tipsMsgBox.Show("下载配置文件失败，请尝试重启游戏！",function(){wx.exitMiniProgram()}):(d++,console.log("onFailEvent:"+e.detail.msg),i.tipsMsgBox.Show(e.detail.msg,function(){i.ReadConfig(i.onReadConfig)}))},update:function(e){if(!this.tipsMsgBox.IsActive()){if(this.logoTime+=e,!a.IsWeichatGame()){var t=Date.now(),n=window.localStorage.getItem("date");Number(t-n)>2800?this.logoTime>=this.CDTime&&this.runNextScene():this.runNextScene()}a.IsWeichatGame()&&(l?this.logoTime>=this.CDTime&&this.runNextScene():this.logoTime>=this.TimeOutSeconds&&s.emit("OnFailEvent",{msg:"当前网络环境不好，请重试！"}))}},onReadConfig:function(e){e?(console.log(e),a.IsWeichatGame()?!1===GameSettingConfig.CDN_ENABLE?(console.log("GameSettingConfig CDN_ENABLE false"),l=!0):i.GetAllNewFiles(e,i.onGetAllNewFiles):l=!0):a.IsWeichatGame()?i.UnlinkAllUsrFile(function(){s.emit("OnFailEvent",{msg:"下载配置文件失败，请保证网络畅通或切换网络后重试！"})}):l=!0},onGetAllNewFiles:function(e){(u=e).length<=0?(console.log("没有需要下载的文件"),i.SaveAllFileInfo(),l=!0):(console.log("start download file num:"+u.length),console.log(u),c=0,i.logoTime=0,l=!1,i.UnlinkAllUsrFile(i.startDownLoad))},startDownLoad:function(){var e=u[c];e.endsWith(".zip")?i.DownloadAndUnZip(e,i.onDownloadFinish):i.DownloadAndSave(e,i.onDownloadFinish)},onDownloadFinish:function(e,t){t?++c>=u.length?i.CheckAllLocalFile(i.onCheckAllLocalFile):i.startDownLoad():s.emit("OnFailEvent",{msg:"下载文件失败！请下载最新版本的微信。"})},onCheckAllLocalFile:function(e){e?(i.SaveAllFileInfo(),l=!0):s.emit("OnFailEvent",{msg:"下载文件错误！请下载最新版本的微信。"})},runNextScene:function(){!0!==this.bRunNextScene&&(this.bRunNextScene=!0,console.log("runNextScene GameEntry.fire"),s.off("OnFailEvent",this.onFailEvent,this),cc.director.preloadScene("GameEntry.fire",function(){cc.director.loadScene("GameEntry.fire")}))},PlayStudioBg:function(){cc.audioEngine.playEffect(this.studioBg,!1)}}),cc._RF.pop()},{DownLoad:"DownLoad",JsonUtils:"JsonUtils",PlatformUtil:"PlatformUtil",TipsMsgBox:"TipsMsgBox",UpdateUtils:"UpdateUtils",Util:"Util"}],Return:[function(e,t,n){"use strict";cc._RF.push(t,"4269eDk+AJJ2bTXDK5sSort","Return");var i=e("TaskStatus"),a=e("BevAction");cc.Class({name:"Return",extends:a,properties:{},OnExcute:function(){return i.Success}}),cc._RF.pop()},{BevAction:"BevAction",TaskStatus:"TaskStatus"}],RichMsgBoxUI:[function(e,t,n){"use strict";cc._RF.push(t,"e3554bE5bxGHpLfcqkiuasd","RichMsgBoxUI");var i=e("UIManager");e("PlatformUtil");cc.Class({extends:cc.Component,properties:{contentLabel:{default:null,type:cc.RichText},callback:null},onLoad:function(){this.Hide()},onEnable:function(){var e=cc.ServerConfig;if(e&&e.notice){var t=e.notice;this.contentLabel.string=t}},Show:function(e,t){this.contentLabel.string=e,this.callback=t},Hide:function(){window.GGameEntry.UIManager.HideUI(i.UIType.RichMsgBoxUI)},IsActive:function(){return 1==this.node.active},btnClicked:function(){this.Hide(),this.callback&&this.callback()}}),cc._RF.pop()},{PlatformUtil:"PlatformUtil",UIManager:"UIManager"}],Selector:[function(e,t,n){"use strict";cc._RF.push(t,"28cc3ghKLhOT5ht69OY8bck","Selector");var i=e("TaskStatus"),a=e("BevComposite");cc.Class({name:"Selector",extends:a,OnChildrenExcuted:function(e){e==i.Success?this.index=-1:this.index++}}),cc._RF.pop()},{BevComposite:"BevComposite",TaskStatus:"TaskStatus"}],Sequence:[function(e,t,n){"use strict";cc._RF.push(t,"dd5f3nBW3RNVqHQT4/hq08L","Sequence");var i=e("TaskStatus"),a=e("BevComposite");cc.Class({name:"Sequence",extends:a,OnChildrenExcuted:function(e){e==i.Success?this.index++:this.index=-1}}),cc._RF.pop()},{BevComposite:"BevComposite",TaskStatus:"TaskStatus"}],ServerLog:[function(e,t,n){"use strict";function i(e){if(e){if(e.length>l.MAX_UPLOAD_CLIENT_LOG_REFER_COUNT)return cc.log(e),void cc.error("log array size > "+l.MAX_UPLOAD_CLIENT_LOG_REFER_COUNT);var t=new s.GetRequestByID(l.CS_CMD_TYPE.CS_CMD_UPLOAD_CLIENT_LOG);t.Num=e.length,t.Log=e,cc.log(t);var n=c.getShortSocketURL();s.SendGameSvrRequest(n,0,t,r,!0)}}function a(e){if(e.length>l.MAX_UPLOAD_CLIENT_LOG_STR_SIZE)return cc.log(e),void cc.error("log size > "+l.MAX_UPLOAD_CLIENT_LOG_STR_SIZE);d.push(e)}function o(){if(window.GGameEntry.IsNetworkPlay()){h.length>10&&(a(h),h="FPS:");var e=Math.min(d.length,l.MAX_UPLOAD_CLIENT_LOG_REFER_COUNT);if(cc.log("sendBatchLog:"+e),e>0){var t=d.slice(0,e);d.splice(0,e),i(t)}}}function r(e){var t=u.SafeParse(e);void 0!==t&&0===t.E&&t.C===l.CS_CMD_TYPE.CS_CMD_UPLOAD_CLIENT_LOG&&o()}cc._RF.push(t,"afb72/K04ZERrSXbMbCxuvP","ServerLog");e("MsgBase"),e("GlobalCfg");var s=e("NetworkProto"),l=(e("star_comm"),e("star_cs")),c=e("loginConfig"),u=(e("weixinmsgmgr"),e("GameNetwork"),e("JsonUtils")),d=[],h="FPS:";t.exports={OnLoginSucess:function(){},pushFpsLog:function(e){h.length+e.length>l.MAX_UPLOAD_CLIENT_LOG_STR_SIZE-10&&(a(h),h="FPS:"),h+=e+","},pushLog:a,sendBatchLog:o},cc._RF.pop()},{GameNetwork:"GameNetwork",GlobalCfg:"GlobalCfg",JsonUtils:"JsonUtils",MsgBase:"MsgBase",NetworkProto:"NetworkProto",loginConfig:"loginConfig",star_comm:"star_comm",star_cs:"star_cs",weixinmsgmgr:"weixinmsgmgr"}],ServerMsgError:[function(e,t,n){"use strict";cc._RF.push(t,"8bba7CJVlRBlKIZxEAl3EkI","ServerMsgError");var i=e("star_macro"),a=e("ResTableNames");t.exports={onRoomServerErrorMsg:function(t){var n=new Object;n.msg="",n.type=0,t.E===i.RET_CODE.RET_CODE_CAN_NOT_KICK_OUT?n.type=2:t.E===i.RET_CODE.RET_CODE_CAN_NOT_KICK_OUT_SELF?n.type=2:t.E===i.RET_CODE.RET_CODE_ROOM_POSITION_NOT_EMPTY?n.type=2:t.E===i.RET_CODE.RET_CODE_CAN_NOT_SET_AUTO_JOIN_ROOM?n.type=2:t.E===i.RET_CODE.RET_CODE_ALREADY_IN_THIS_POS?n.type=2:e("loginServerMgr").onSetRoomGuid("0");var o=window.GGameEntry.ResTableMgr.GetConfigByID(a.star_client_c,t.E);if(null!==o){var r=o.Context;n.msg=window.GGameEntry.StringFormat(r,t.E)}else n.msg=t.E+"  "+t.C;return n},onActivityServerErrorMsg:function(e){}},cc._RF.pop()},{ResTableNames:"ResTableNames",loginServerMgr:"loginServerMgr",star_macro:"star_macro"}],ServerUI:[function(e,t,n){"use strict";cc._RF.push(t,"8c3108GY5VBsIFch1oFndRC","ServerUI");var i=e("UIManager"),a=(e("Util"),e("loginConfig")),o=null;cc.Class({extends:cc.Component,properties:{preItem:{default:null,type:cc.Prefab},zonesvr:{default:[],type:""},replaysvr:{default:[],type:""}},onLoad:function(){o=this;var e=a.getNetConfig();if(null!=e)for(var t=e.length/5,n=0;n<t;n++)for(var i=0;i<5;i++){var r=5*n+i;if(r>=e.length)break;var s=new cc.Vec2;s.x=250*i-500,s.y=300-100*n;var l=cc.instantiate(this.preItem);l.setParent(this.node),l.setPosition(s),l.on("click",this.callback,l),l.getComponentInChildren(cc.Label).string=e[r].name+"("+r+")";var c=e[r].replysvr.length,u=a.getRandomNum(0,c),d=e[r].replysvr[u];this.replaysvr[r]=d.url;var h=e[r].zonesvr.length,f=a.getRandomNum(0,h),m=e[r].zonesvr[f];this.zonesvr[r]=m.url}else console.warn("ServerUI.js onLoad jsonObject is null.")},callback:function(e){var t=this.getComponentInChildren(cc.Label).string,n=t.indexOf("("),r=t.indexOf(")"),s=Number(t.substring(n+1,r));window.GGameEntry.ServerName=t.substring(0,n),a.setShortSocketURL(o.replaysvr[s]),a.setLongSocketURL(o.zonesvr[s]);var l="choose server:"+t;console.log(l),window.GGameEntry.GMSystem.receiveGMMessage(l),console.log(o.replaysvr[s]),console.log(o.zonesvr[s]),window.GGameEntry.UIManager.HideUI(i.UIType.ServerUI)}}),cc._RF.pop()},{UIManager:"UIManager",Util:"Util",loginConfig:"loginConfig"}],SettlementItem:[function(e,t,n){"use strict";cc._RF.push(t,"d8fe5X+Jg1JTYqxA7rQWDqx","SettlementItem");var i=e("HeadImageUtil"),a=e("GlobalCfg"),o=e("EntityTypeDefine"),r=e("Util"),s=e("PlatformUtil");cc.Class({extends:cc.Component,properties:{PlayerNameLabel:{default:null,type:cc.Label},PlayerKillValue:{default:null,type:cc.Label},PlayerDeadValue:{default:null,type:cc.Label},headIcon:{default:null,type:cc.Sprite},KillMostLabel:{default:null,type:cc.Sprite},BlockMostLabel:{default:null,type:cc.Sprite},HealthMostLabel:{default:null,type:cc.Sprite},MvpLabel:{default:null,type:cc.Node},DefaultHeadImage:{default:null,type:cc.SpriteFrame}},init:function(e,t,n,l,c,u,d,h,f,m){this.PlayerNameLabel.string="",this.DefaultHeadImage&&(this.headIcon.spriteFrame=this.DefaultHeadImage);window.GGameEntry.PlayerManager.PlayerCampType;window.GGameEntry.CurGamePlayType===a.GamePlayType.GamePlayType_Single&&o.EntityCampType.BlueTeam,this.PlayerKillValue.string=n.toString(),this.PlayerDeadValue.string=l.toString();var y=window.GGameEntry.EntityManager.getEntity(c).getComponent("TankBase");if(y){y.HeadImageUrl?window.GGameEntry.CurGamePlayType===a.GamePlayType.GamePlayType_Single?window.GGameEntry.PlayerManager.Player&&(y.Guid===window.GGameEntry.PlayerManager.Player.Guid?i.loadImageFromNetUrl(this.headIcon,y.HeadImageUrl):i.loadImageFromRes(this.headIcon,y.HeadImageUrl)):i.loadImageFromNetUrl(this.headIcon,y.HeadImageUrl):this.headIcon.spriteFrame=null;var p=y.GetTankName();s.isTargetPlatform(2)&&(p=r.FliterEmojString(p)),this.PlayerNameLabel.string=p}this.BlockMostLabel.node.active=!!h,this.KillMostLabel.node.active=!!d,this.HealthMostLabel.node.active=!!f,this.MvpLabel.active=!!m}}),cc._RF.pop()},{EntityTypeDefine:"EntityTypeDefine",GlobalCfg:"GlobalCfg",HeadImageUtil:"HeadImageUtil",PlatformUtil:"PlatformUtil",Util:"Util"}],SettlementUI:[function(e,t,n){"use strict";cc._RF.push(t,"87854JhqPtCeLna8DVlLqae","SettlementUI");var i=e("UIManager"),a=(e("Util"),e("BattleDef")),o=e("EntityTypeDefine"),r=e("SimpleLabel"),s=e("GlobalCfg"),l=e("PlatformUtil"),c=e("ResTableNames"),u=e("ServerLog"),d=e("loginServerMgr"),h=e("weixinmsgmgr"),f=e("weixininterface"),m=e("QunUserDataMgr"),y=e("GameMode"),p=e("ActivityMsgMgr"),g=new cc.Color(0,0,0),C=new cc.Color(99,25,25);cc.Class({extends:cc.Component,properties:{WinNode:{default:null,type:cc.Node},LoseNode:{default:null,type:cc.Node},Ani:{default:null,type:cc.Animation,serializable:!0},InfoItemNodeList:{default:[],type:cc.Node},SelfKill:{default:null,type:r,serializable:!0},EnemyKill:{default:null,type:r,serializable:!0},SelfHomeNode:{default:null,type:cc.Sprite},EnemyHomeNode:{default:null,type:cc.Sprite},CancelBtn:{default:null,type:cc.Button},ReplayBtn:{default:null,type:cc.Button},IsReceiveRoleInfo:{default:!1,type:cc.Boolean},HomeSpriteList:{default:[],type:cc.SpriteFrame},BlueBtnSpr:{default:null,type:cc.SpriteFrame},OrangeBtnSpr:{default:null,type:cc.SpriteFrame},GreyBtnSpr:{default:null,type:cc.SpriteFrame},WaitTime:{default:3,type:cc.Integer},ShareBtn:{default:null,type:cc.Button},BtnListWidget:{default:null,type:cc.Widget},modelNode:{default:null,type:cc.Node},modelText:{default:null,type:cc.Label}},fitiPhoneXScreen:function(){if(l.isTargetDevice("iPhone X")){this.BtnListWidget&&(this.BtnListWidget.bottom=15,this.BtnListWidget.updateAlignment());var e=this.node.getChildByName("InfoList");e&&(e.scaleX=.8,e.scaleY=.8);var t=this.node.getChildByName("Ret");t&&(t.scaleX=.8,t.scaleY=.8)}},onEnable:function(){if(this.fitiPhoneXScreen(),window.GGameEntry.NotificationCenter.on("OnReceivePlayerRole",this.OnReceivePlayerRole,this),this.IsReceiveRoleInfo=!1,this.resetData(),this.initData(),this.startTime=0,window.GGameEntry.CurGamePlayType===s.GamePlayType.GamePlayType_Single?(this.ShareBtn.node.active=!1,this.ReplayBtn.node.active=!1):(this.ShareBtn.node.active=!0,this.ReplayBtn.node.active=!0),this.EnableButton(!0,this.CancelBtn,!0),this.EnableButton(!0,this.ReplayBtn,!1),this.EnableButton(!0,this.ShareBtn,!0),window.GGameEntry.CurGamePlayType===s.GamePlayType.GamePlayType_Single&&l.IsWeichatGame()&&y.IsGameMode(y.GM.GameMode_Single)){var e=window.GGameEntry.BattleSystem.BattleData.BattleState===a.BattleState.Win?1:0,t=this.getSelfData(),n=0;null!==t&&(n=t.killCount),d.onPVEGameEnd(n,e)}window.GGameEntry.NotificationCenter.on("CancelNetQueue",this.onCancelNetQueue,this),window.GGameEntry.NotificationCenter.on("onRecvBattleError",this.onRecvBattleError,this);var i=p.getActivityType();if(cc.log("roomType:"+i),i){var o=p.getActivity(i);o?(this.modelNode.active=!0,this.modelText.string=o.ScaleShow+"-"+o.ModelName):this.modelNode.active=!1}else this.modelNode.active=!1},update:function(e){this.startTime+=e},onDisable:function(){window.GGameEntry.NotificationCenter.off("OnReceivePlayerRole",this.OnReceivePlayerRole,this),window.GGameEntry.NotificationCenter.off("CancelNetQueue",this.onCancelNetQueue,this),window.GGameEntry.NotificationCenter.off("onRecvBattleError",this.onRecvBattleError,this),this.startTime=0},onRecvBattleError:function(e){console.log("SettlementUI onRecvBattleError"),d.onGetServerErrMsgCount()>0&&window.GGameEntry.UIManager.ShowUI(i.UIType.PVPExitTeamUI,i.UIOrder.Default+10)},OnReceivePlayerRole:function(e){console.log("SettlementUI OnReceivePlayerRole"),h.onHideLoadingState(),this.IsReceiveRoleInfo=!0,l.setBtnCheckEnter(2),d.onBeginBattleAgain()},resetData:function(){for(var e=0;e<this.InfoItemNodeList.length;e++)this.InfoItemNodeList[e].opacity=0},sortDataByLineType:function(e,t){return e.lineType>t.lineType},initData:function(){var e=window.GGameEntry.PlayerManager.PlayerCampType;window.GGameEntry.CurGamePlayType===s.GamePlayType.GamePlayType_Single&&(e=o.EntityCampType.BlueTeam);var t=window.GGameEntry.BattleSystem.BattleKillData;t.sort(this.sortDataByLineType);for(var n=!1,i=!1,r=!1,l=0,c=0,u=0,d=window.GGameEntry.BattleSystem.BattleData.KillMaxCount,h=window.GGameEntry.BattleSystem.BattleData.BlockMaxCount,f=window.GGameEntry.BattleSystem.BattleData.HealthMaxCount,m=0,y=0;y<t.length;y++)t[y].campType===e?m++:0;for(var p=0;p<t.length;p++)t[p].killCount===d&&t[p].killCount>=8&&l++,t[p].blockCount===h&&t[p].blockCount>=8&&c++,t[p].healthCount===f&&t[p].healthCount>0&&u++;1===l&&(n=!0),1===c&&(i=!0),1===u&&(r=!0);for(var g=this.findWhoIsMvp(t,!0),C=this.findWhoIsMvp(t,!1),G=0,S=0,E=0,T=3,w=0;w<t.length;w++)t[w].campType===e?(this.InfoItemNodeList[E].opacity=255,this.InfoItemNodeList[E].getComponent("SettlementItem").init(t[w].campType,t[w].stringName,t[w].killCount,t[w].deadCount,t[w].guid,t[w].blockCount,n&&t[w].killCount===d,i&&t[w].blockCount===h,r&&t[w].healthCount===f,t[w].guid===g),E++,G+=t[w].deadCount):(T-3<t.length-m&&(this.InfoItemNodeList[T].opacity=255,this.InfoItemNodeList[T].getComponent("SettlementItem").init(t[w].campType,t[w].stringName,t[w].killCount,t[w].deadCount,t[w].guid,t[w].blockCount,n&&t[w].killCount===d,i&&t[w].blockCount===h,r&&t[w].healthCount===f,t[w].guid===C),T++),S+=t[w].deadCount);this.SelfKill.SetString(S.toString()),this.EnemyKill.SetString(G.toString());var M=window.GGameEntry.BattleSystem.BattleData.BattleState===a.BattleState.Win;this.SelfHomeNode.spriteFrame=this.HomeSpriteList[0],this.EnemyHomeNode.spriteFrame=this.HomeSpriteList[2],M?(this.LoseNode.opacity=0,this.WinNode.opacity=255,this.SelfHomeNode.spriteFrame=this.HomeSpriteList[1],this.EnemyHomeNode.spriteFrame=this.HomeSpriteList[0]):(this.LoseNode.opacity=255,this.WinNode.opacity=0,this.SelfHomeNode.spriteFrame=this.HomeSpriteList[0],this.EnemyHomeNode.spriteFrame=this.HomeSpriteList[2]),window.GGameEntry.BattleSystem.BattleData.isArriveTime&&(this.SelfHomeNode.spriteFrame=this.HomeSpriteList[1],this.EnemyHomeNode.spriteFrame=this.HomeSpriteList[2])},OnBack:function(){if(window.GGameEntry.BattleSystem.ExitBattle(),!l.IsWeichatGame()){var e=window.location.toString(),t=e.indexOf("?");e=e.substring(0,t),window.history.pushState(null,null,e)}u.sendBatchLog()},EnableButton:function(e,t,n){e?(t.interactable=!0,n?(t.getComponent(cc.Sprite).spriteFrame=this.BlueBtnSpr,t.getComponentInChildren(cc.Label).node.color=g):(t.getComponent(cc.Sprite).spriteFrame=this.OrangeBtnSpr,t.getComponentInChildren(cc.Label).node.color=C)):(t.interactable=!1,t.getComponent(cc.Sprite).spriteFrame=this.GreyBtnSpr,t.getComponentInChildren(cc.Label).node.color=g);var i=t.node.getComponent("ButtonScaler");i&&(i.enabled=!!e)},shareAppMsgCallback:function(e,t,n,i,a){},OnShareBattleInfo:function(){if(l.IsWeichatGame()){var e=m.GetQunUserData();if(null===e){var t=window.GGameEntry.ResTableMgr.GetConfigByID(c.star_client_c,78).Context;return void window.GGameEntry.UIManager.ShowMsgBox(t)}for(var n="uipath=RecordUI",i=0;i<6;i++)n+="&id"+i+"="+e[i].openid;var a=""===window.GGameEntry.shareranktips?"一炮绝杀，谁与争锋！":window.GGameEntry.shareranktips;f.onShareMsgInGame(a,n,""===window.GGameEntry.sharerankurl?DEFAULT_SHARE_RANK_LINK:window.GGameEntry.sharerankurl,this.shareAppMsgCallback)}},OnNetNotConnected:function(e){return e.EnableButton(!0,e.CancelBtn,!0),e.EnableButton(!0,e.ReplayBtn,!1),e.EnableButton(!0,e.ShareBtn,!0),!window.GGameEntry.GBattleNetwork.IsConnected()&&!e.IsReceiveRoleInfo},OnBattleAgain:function(){if(window.GGameEntry.BattleSystem.ClearData(),this.EnableButton(!1,this.CancelBtn,!0),this.EnableButton(!1,this.ReplayBtn,!1),this.EnableButton(!1,this.ShareBtn,!0),this.startTime<=this.WaitTime)if(console.log("OnBattleAgain in less than 3 :"+this.startTime),l.IsWeichatGame()){var e=this.WaitTime-this.startTime.toFixed(0),t=window.GGameEntry.ResTableMgr.GetConfigByID(c.star_client_c,85).Context;h.onShowLoadingState(t,1e3*e,t,this.battleAgain,this)}else{t=window.GGameEntry.ResTableMgr.GetConfigByID(c.star_client_c,84).Context;window.GGameEntry.UIManager.ShowMsgBox(t),this.EnableButton(!0,this.CancelBtn,!0),this.EnableButton(!0,this.ReplayBtn,!1),this.EnableButton(!0,this.ShareBtn,!0)}else this.battleAgain(this)},battleAgain:function(e){console.log("battleAgain onConnect:"+e.startTime),d.onConnect();var t=window.GGameEntry.ResTableMgr.GetConfigByID(c.star_client_c,1).Context;return h.onShowLoadingState("logining...",15e3,t,e.OnNetNotConnected,e),!1},findWhoIsMvp:function(e,t){if(window.GGameEntry.CurGamePlayType===s.GamePlayType.GamePlayType_Single)return-1;for(var n=window.GGameEntry.PlayerManager.PlayerCampType,i=[],a=0;a<e.length;a++)t?e[a].campType===n&&(i[i.length]=e[a]):e[a].campType!==n&&(i[i.length]=e[a]);for(var o=parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(c.star_global_cs,20).Value),r=parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(c.star_global_cs,21).Value),l=parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(c.star_global_cs,22).Value),u=0,d=i.length-1;d>=0;d--){var h=o*i[d].killCount-r*i[d].deadCount;h>l||i.splice(d,1),u=u<h?h:u}if(0===i.length)return-1;if(1===i.length)return i[0].guid;for(var f=i.length-1;f>=0;f--)o*i[f].killCount-r*i[f].deadCount!=u&&i.splice(f,1);return 1===i.length?i[0].guid:(i.sort(this.SortTeamByValue),i[i.length-1].guid)},SortTeamByValue:function(e,t){return e.attackTankDmg!=t.attackTankDmg?e.attackTankDmg-t.attackTankDmg:e.blockCount!=t.blockCount?e.blockCount-t.blockCount:e.attackBaseDmg!=t.attackBaseDmg?e.attackBaseDmg-t.attackBaseDmg:e.killContiMax!=t.killContiMax?e.killContiMax-t.killContiMax:-1},onCancelNetQueue:function(){this.EnableButton(!0,this.CancelBtn,!0),this.EnableButton(!1,this.ReplayBtn,!1),this.EnableButton(!0,this.ShareBtn,!0)},getSelfData:function(){for(var e=null,t=window.GGameEntry.BattleSystem.BattleKillData,n=0;n<t.length;n++)window.GGameEntry.PlayerManager.Player&&t[n].guid===window.GGameEntry.PlayerManager.Player.Guid&&(e=t[n]);return e}}),cc._RF.pop()},{ActivityMsgMgr:"ActivityMsgMgr",BattleDef:"BattleDef",EntityTypeDefine:"EntityTypeDefine",GameMode:"GameMode",GlobalCfg:"GlobalCfg",PlatformUtil:"PlatformUtil",QunUserDataMgr:"QunUserDataMgr",ResTableNames:"ResTableNames",ServerLog:"ServerLog",SimpleLabel:"SimpleLabel",UIManager:"UIManager",Util:"Util",loginServerMgr:"loginServerMgr",weixininterface:"weixininterface",weixinmsgmgr:"weixinmsgmgr"}],ShareUI:[function(e,t,n){"use strict";cc._RF.push(t,"30fadyBBMJMoKtkJvlDf3HI","ShareUI");var i=e("UIManager");cc.Class({extends:cc.Component,properties:{goBackBtn:{default:null,type:cc.Node}},onEnable:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.swallowTouch,this)},onDisable:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.swallowTouch,this)},swallowTouch:function(){},onGoBack:function(){window.GGameEntry.UIManager.HideUI(i.UIType.ShareUI)}}),cc._RF.pop()},{UIManager:"UIManager"}],ShopUI:[function(e,t,n){"use strict";cc._RF.push(t,"43560WtSClJ/6Tw1yvK0+9T","ShopUI");var i=e("SimpleLabel"),a=e("UIManager"),o=e("PayManager"),r=e("weixinmsgmgr"),s=e("loginServerMgr"),l=e("GlobalCfg"),c=e("PlatformUtil"),u=(e("weixininterface"),e("ResTableNames"));cc.Class({extends:cc.Component,properties:{DiamondLeftLabel:{default:null,type:i,serializable:!0},MoneyLableList:{default:[],type:i,serializable:!0}},onEnable:function(){this.DiamondLeftLabel.SetString("0"),this.MoneyLableList[0].SetString("1"),this.MoneyLableList[1].SetString("6"),this.MoneyLableList[2].SetString("30")},onDisable:function(){window.GGameEntry.NotificationCenter.emit("onChangeBtnState",{bShow:!0})},OnExit:function(){window.GGameEntry.UIManager.HideUI(a.UIType.ShopUI)},OnChargeResultCallback:function(e){if(r.onHideLoadingState(),!0===e){window.GGameEntry.CurGamePlayType=l.GamePlayType.GamePlayType_Network,r.onShowLoadingState("logining...",5e3),c.IsWeichatGame()&&s.onQueryPlayerDiamond();var t=window.GGameEntry.ResTableMgr.GetConfigByID(u.star_client_c,86).Context;window.GGameEntry.UIManager.ShowMsgBox(t)}},OnBtnCharge10:function(){r.onShowLoadingState("Paying...",2e4),o.Buy(10,this.OnChargeResultCallback)},OnBtnCharge60:function(){r.onShowLoadingState("Paying...",2e4),o.Buy(60,this.OnChargeResultCallback)},OnBtnCharge300:function(){r.onShowLoadingState("Paying...",2e4),o.Buy(300,this.OnChargeResultCallback)},update:function(e){var t=s.onGetPlayerMoney().toString();this.DiamondLeftLabel.SetString(t)}}),cc._RF.pop()},{GlobalCfg:"GlobalCfg",PayManager:"PayManager",PlatformUtil:"PlatformUtil",ResTableNames:"ResTableNames",SimpleLabel:"SimpleLabel",UIManager:"UIManager",loginServerMgr:"loginServerMgr",weixininterface:"weixininterface",weixinmsgmgr:"weixinmsgmgr"}],ShutDownItem:[function(e,t,n){"use strict";cc._RF.push(t,"21811l7HLBE34JUNj7DKw07","ShutDownItem");e("EntityTypeDefine");var i=e("HeadImageUtil"),a=e("GlobalCfg"),o=e("SimpleRoundSprite"),r=e("Util");cc.Class({extends:cc.Component,properties:{headIcon:{default:null,type:cc.Sprite},headIconBG:{default:null,type:cc.Sprite},playerName:{default:null,type:cc.Label},bgSpriteList:{type:cc.SpriteFrame,default:[]},nameBg:{default:null,type:cc.Sprite},labelBgSpriteList:{type:cc.SpriteFrame,default:[]},SimpleRound:{default:null,type:o}},init:function(e,t,n){var o=r.BeginSample("ShutDownItem::init");e==window.GGameEntry.PlayerManager.GetMyCamp()?(this.headIconBG.spriteFrame=this.bgSpriteList[0],this.nameBg.spriteFrame=this.labelBgSpriteList[0],this.playerName.node.color=new cc.Color(0,135,213)):(this.headIconBG.spriteFrame=this.bgSpriteList[1],this.nameBg.spriteFrame=this.labelBgSpriteList[1],this.playerName.node.color=new cc.Color(209,0,0));var s=window.GGameEntry.EntityManager.getEntity(n);if(s){var l=s.getComponent("TankBase");if(l){var c=l.GetTankName();if(this.playerName.string=c,l.HeadImageUrl)if(window.GGameEntry.CurGamePlayType===a.GamePlayType.GamePlayType_Single){if(window.GGameEntry.PlayerManager.Player)if(l.Guid===window.GGameEntry.PlayerManager.Player.Guid){var u=this;i.loadImageFromNetUrl(this.headIcon,l.HeadImageUrl,function(){u.SimpleRound.SetMesh()})}else i.loadImageFromRes(this.headIcon,l.HeadImageUrl),this.SimpleRound.DisableMe()}else{var d=this;i.loadImageFromNetUrl(this.headIcon,l.HeadImageUrl,function(){d.SimpleRound.SetMesh()})}else this.headIcon.spriteFrame=null}}r.EndSample(o)}}),cc._RF.pop()},{EntityTypeDefine:"EntityTypeDefine",GlobalCfg:"GlobalCfg",HeadImageUtil:"HeadImageUtil",SimpleRoundSprite:"SimpleRoundSprite",Util:"Util"}],ShutDownUI:[function(e,t,n){"use strict";cc._RF.push(t,"a6f5d4hpkJCE5BnwGbC9xRe","ShutDownUI");var i=e("ShutDownItem"),a=e("Util"),o=e("CmdAddBuff"),r=e("GlobalCfg"),s=e("ResCfgDef"),l=e("PlatformUtil");cc.Class({extends:cc.Component,properties:{leftIcon:{default:null,type:i},centerWord:{default:null,type:cc.Sprite},rightIcon:{default:null,type:i},centerWordList:{type:cc.SpriteFrame,default:[]},animationCtrl:{default:null,type:cc.Animation}},fitiPhoneXScreen:function(){l.isTargetDevice("iPhone X")&&this.node.setPosition(60,0)},onEnable:function(){this.fitiPhoneXScreen(),this.shutDownQueue=[],window.GGameEntry.NotificationCenter.on("OnBattleUIUpdate",this.onShutDownEvent,this)},onDisable:function(){window.GGameEntry.NotificationCenter.off("OnBattleUIUpdate",this.onShutDownEvent,this),this.node.opacity=0,this.animationCtrl.stop(),this.shutDownQueue.splice(0,this.shutDownQueue.length)},onShutDownEvent:function(e){var t={campType:e.detail.campType,lineType:e.detail.lineType,dieGuid:e.detail.dieGuid,hitCampType:e.detail.hitCampType,hitLineType:e.detail.hitLineType,hitGuid:e.detail.hitGuid,isShutDown:e.detail.isShutDown};0!=t.hitGuid&&(window.GGameEntry.IsGuiding()||(this.shutDownQueue&&this.shutDownQueue.push(t),1==this.shutDownQueue.length&&this.onShutDown()))},animationFinish:function(){this.shutDownQueue.length>0&&this.shutDownQueue.splice(0,1),this.shutDownQueue.length>0&&this.onShutDown()},onShutDown:function(){if(!(this.shutDownQueue.length<1)){var e=a.BeginSample("ShutDownUI::onShutDown"),t=this.shutDownQueue[0];if(void 0!==t&&void 0!==t.hitCampType&&void 0!==t.hitLineType&&void 0!==t.hitGuid&&void 0!==t.campType&&void 0!==t.lineType&&void 0!==t.dieGuid){if(window.GGameEntry.NotificationCenter.emit("OnKillMessage",t),window.GGameEntry.ResManager.GetProgramEffCfg(s.ProgramEffType.LianShaXiaoGuo)===s.PELianShaXiaoGuo.N)return void this.animationFinish();this.leftIcon.init(t.hitCampType,t.hitLineType,t.hitGuid),this.rightIcon.init(t.campType,t.lineType,t.dieGuid);t.hitLineType,t.hitCampType;for(var n=0,i=window.GGameEntry.BattleSystem.BattleKillData,l=null,c=t.hitCampType!=window.GGameEntry.PlayerManager.GetMyCamp(),u=0;u<i.length;u++)i[u].guid==t.hitGuid&&(2===i[u].multiKillCount?(n=2,(l=new o).Init(t.hitGuid,14),l.BuffOp=1):3===i[u].multiKillCount?n=3:4==i[u].multiKillCount?(n=4,(l=new o).Init(t.hitGuid,15),l.BuffOp=1):5==i[u].multiKillCount?n=5:6==i[u].multiKillCount?(n=6,(l=new o).Init(t.hitGuid,16),l.BuffOp=1):i[u].multiKillCount>=7&&(n=7));if(t.isShutDown)window.GGameEntry.SoundManager.PlayShutDown();else switch(n){case 2:window.GGameEntry.SoundManager.PlayTwoKill(c);break;case 3:case 4:case 5:case 6:window.GGameEntry.SoundManager.PlaySixKill(c);break;case 7:window.GGameEntry.SoundManager.PlaySevenKill(c)}1==window.GGameEntry.BattleSystem.BattleData.BlueKillCount+window.GGameEntry.BattleSystem.BattleData.RedKillCount&&(window.GGameEntry.SoundManager.PlayFirstKill(),n=1),window.GGameEntry.CurGamePlayType===r.GamePlayType.GamePlayType_Single&&l&&window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(l),0!=n?(this.centerWord.spriteFrame=this.centerWordList[n],this.animationCtrl.play(),this.scheduleOnce(function(){this.animationFinish()},1.5)):this.animationFinish()}else this.animationFinish();a.EndSample(e)}}}),cc._RF.pop()},{CmdAddBuff:"CmdAddBuff",GlobalCfg:"GlobalCfg",PlatformUtil:"PlatformUtil",ResCfgDef:"ResCfgDef",ShutDownItem:"ShutDownItem",Util:"Util"}],SimpleBevTree:[function(e,t,n){"use strict";cc._RF.push(t,"2defaH8zv9HoJxdFGEKoPWW","SimpleBevTree");var i=e("TaskStatus"),a=e("BevTask"),o=e("AbortType"),r=e("BTDeserialization"),s=e("BevCond"),l=e("BevComposite"),c=e("EntityTypeDefine");cc.Class({name:"SimpleBevTree",properties:{rootNode:{default:null,serializable:!1,type:a},curNode:{default:null,serializable:!1,type:a},sharedVars:{default:{},serializable:!1},actor:{get:function(){return this.sharedVars.actor}},bevTreeName:"Behavior",openLog:{default:!1,serializable:!1}},init:function(e,t,n){var i=new r;this.rootNode=i.Deserialize(this,n),this.curNode=null,this.bevTreeName=e,this.sharedVars.actor=t,this.sharedVars.userVars={},this.sharedVars.itemPos=null,this.sharedVars.lastTargetPos=null},reset:function(){this.curNode=null;var e=this.sharedVars.actor;this.sharedVars={},this.sharedVars.actor=e,this.sharedVars.userVars={},this.sharedVars.itemPos=null,this.sharedVars.lastTargetPos=null},finit:function(){this.rootNode=null,this.curNode=null,this.sharedVars.actor=null,this.sharedVars.userVars=null,this.sharedVars.itemPos=null,this.sharedVars.lastTargetPos=null},RunBevTree:function(){if(this.openLog&&console.log("--------- ("+this.Camp2String(this.sharedVars.actor.GetCamp())+":"+this.sharedVars.actor.GetTankName()+") -- ("+this.bevTreeName+") ---------"),null!=this.curNode)if(this.ReevaluateConds(this.rootNode,i.Running,"|--"))this.curNode.OnInterupt(),this.curNode=null,this.RunBevTree();else{this.openLog&&console.log("Run running action "+this.curNode.name);var e=this.curNode.OnExcute();e!==i.Running&&(this.curNode.OnEnd(),this.curNode.OnReturn(e),this.curNode=null)}else this.Run(this.rootNode,"|--")},ReevaluateConds:function(e,t,n){if(!e)return!1;if(e instanceof s){var i=e.OnExcute();return i=e.OnReturn(i),this.openLog&&console.log(n+"Ree Condition "+e.name+", last= "+this.TaskStatus2String(t)+", now= "+this.TaskStatus2String(i)),i!=t&&(this.openLog&&console.log(n+">>>>>Ree Condition "+e.name+" break running<<<<<"),!0)}if(!(e instanceof l))return console.log("unexpected node enter reevalue stack, name=",e.name),!1;for(var a=0;a<e.reevalueStack.length;){if(this.ReevaluateConds(e.reevalueStack[a].node,e.reevalueStack[a].status,n+"|--"))return!0;++a}return!1},Camp2String:function(e){switch(e){case c.EntityCampType.None:return"NA";case c.EntityCampType.BlueTeam:return"Blue";case c.EntityCampType.RedTeam:return"Red";default:return"Error"}},TaskStatus2String:function(e){switch(e){case i.Inactive:return"NA";case i.Failure:return"F";case i.Success:return"S";case i.Running:return"R...";default:return"Error"}},Abort2String:function(e){switch(e){case o.None:return"NA";case o.Down:return"Down";case o.Right:return"Right";case o.Both:return"Both";default:return"Error"}},Run:function(e,t){if(null==e)return i.Failure;e.ResetIndex(),e.OnStart();var n=e.OnExcute();if(this.openLog&&(e instanceof l?console.log(t+"Run "+e.name+", state= "+this.TaskStatus2String(n)+" ,Abort= "+this.Abort2String(e.abortType)):console.log(t+"Run "+e.name+", state= "+this.TaskStatus2String(n))),n===i.Running)return this.curNode=e,e.OnReturn(i.Running);for(var a=-1;(a=e.GetChildrenIndex())>=0&&!(a<0&&a>=e.Children.length);){if(n=this.Run(e.Children[a],t+"|--"),e instanceof l&&(e.Children[a]instanceof l&&e.reevalueStack.push({node:e.Children[a],status:i.Inactive}),e.Children[a]instanceof s&&(e.abortType==o.Down||e.abortType==o.Both?e.reevalueStack.push({node:e.Children[a],status:n}):e.abortType==o.Right&&e.tempStack.push({node:e.Children[a],status:n}))),n===i.Running)return e.OnReturn(i.Running);e.OnChildrenExcuted(n)}if(e.OnEnd(),e instanceof l)if(e.abortType==o.Down)for(var r=e.reevalueStack.length-1;r>=0;--r)e.reevalueStack[r].node instanceof l||e.reevalueStack.removeAt(r);else e.abortType==o.Right&&e.tempStack.length>0&&(e.reevalueStack=e.reevalueStack.concat(e.tempStack));return e.OnReturn(n)}}),cc._RF.pop()},{AbortType:"AbortType",BTDeserialization:"BTDeserialization",BevComposite:"BevComposite",BevCond:"BevCond",BevTask:"BevTask",EntityTypeDefine:"EntityTypeDefine",TaskStatus:"TaskStatus"}],SimpleLabel:[function(e,t,n){"use strict";cc._RF.push(t,"16798xaPnVLdZwNbixFe2cV","SimpleLabel");var i=e("Util"),a=cc.Enum({LeftToRight:0,RightToLeft:1,FitCenter:2});cc.Class({extends:cc.Component,properties:{LabelAtlas:{default:null,type:cc.SpriteAtlas},LabelStr:"",ResFormat:"",Template:{default:null,type:cc.Sprite},DefaultString:"",StartCacheCount:4,isToRightGrow:{default:!0},LayoutType:{default:a.LeftToRight,type:a}},onLoad:function(){this.ContentText="",this.CacheCharSpr=[],this.UsedCharSpr=[];for(var e=0;e<this.StartCacheCount;e++){var t=cc.instantiate(this.Template.node),n=t.getComponent(cc.Sprite);t.setPosition(2e3,2e3),t.active=!0,t.parent=this.node,this.CacheCharSpr[this.CacheCharSpr.length]=n}this.SetString(this.DefaultString)},SetString:function(e){if(void 0==this.ContentText&&this.onLoad(),this.ContentText!==e){for(n=0;n<e.length;n++){var t=e.charAt(n);if(this.ContentText.length>n){if(this.ContentText.charAt(n)===t)continue;this.InnerPutToCacheChar(this.UsedCharSpr[n]),this.UsedCharSpr[n]=null}-1!==this.LabelStr.indexOf(t)?this.UsedCharSpr[n]=this.InnerGetChar(t):cc.error("char not found:",t)}for(var n=this.UsedCharSpr.length-1;n>=e.length;n--)this.InnerPutToCacheChar(this.UsedCharSpr[n]),this.UsedCharSpr.splice(n,1);this.ContentText=e,this.OrderChars()}},GetString:function(){return this.ContentText},OrderChars:function(){if(this.LayoutType===a.LeftToRight)for(var e=0,t=0;t<this.UsedCharSpr.length;t++)this.UsedCharSpr[t]&&(this.UsedCharSpr[t].node.setPosition(e,0),e+=this.UsedCharSpr[t].node.width);else if(this.LayoutType===a.RightToLeft)for(var e=0,t=this.UsedCharSpr.length-1;t>=0;t--)this.UsedCharSpr[t]&&(this.UsedCharSpr[t].node.setPosition(e,0),e-=this.UsedCharSpr[t].node.width);else if(this.LayoutType===a.FitCenter){if(!this.UsedCharSpr||0===this.UsedCharSpr.lenght)return;for(var n=this.UsedCharSpr[0].node.width/2,i=0-this.UsedCharSpr.length*n+n,t=0;t<this.UsedCharSpr.length;t++)this.UsedCharSpr[t]&&(this.UsedCharSpr[t].node.setPosition(i,0),i+=this.UsedCharSpr[t].node.width)}},InnerPutToCacheChar:function(e){e&&(e.node.setPosition(2e3,2e3),this.CacheCharSpr[this.CacheCharSpr.length]=e)},InnerGetChar:function(e){var t=i.Char2Code(e);{if(t){var n=null;if(this.CacheCharSpr.length>0&&(n=this.CacheCharSpr[this.CacheCharSpr.length-1],this.CacheCharSpr.splice(this.CacheCharSpr.length-1,1)),null===n){var a=cc.instantiate(this.Template.node);n=a.getComponent(cc.Sprite),a.active=!0,a.parent=this.node}return n.spriteFrame=this.LabelAtlas.getSpriteFrame(this.ResFormat+t),n}cc.error("code not found:",e)}},Test:function(){this.SetString("23连杀")}}),cc._RF.pop()},{Util:"Util"}],SimpleRoundSprite:[function(e,t,n){"use strict";cc._RF.push(t,"69d31orU6xIDajXGNN3s022","SimpleRoundSprite"),cc.Class({extends:cc.Component,properties:{PointCount:16,SetMeshOnEnable:!0,TargetSprite:{default:null,serializable:!1,visible:!1}},onEnable:function(){this.SetMeshOnEnable&&this.SetMesh()},SetMesh:function(){if(this.TargetSprite||(this.TargetSprite=this.node.getComponent(cc.Sprite)),this.TargetSprite&&this.TargetSprite._sgNode&&"function"==typeof this.TargetSprite._sgNode.setMeshPolygonInfo){var e=0,t=0,n=1,i=1,a=this.TargetSprite.spriteFrame;if(a){var o=a._texture;o&&(e=a._rect.x/o.width,t=a._rect.y/o.height,n=a._rect.width/o.width,i=a._rect.height/o.height)}for(var r=this.node.width,s=this.node.height,l=this.node.position,c={triangles:{verts:[],indices:[]},rect:new cc.Rect(l.x,l.y,r,s)},u=2*Math.PI/this.PointCount,d=0;d<this.PointCount;d++){var h={};h.x=Math.sin(d*u)*r/2,h.y=Math.cos(d*u)*s/2,h.u=e+n*(h.x/r+.5),h.v=t+i*(1-(h.y/s+.5)),h.x+=r/2,h.y+=s/2,c.triangles.verts[d]=h}for(var f=0,d=0;d<this.PointCount-2;d++)c.triangles.indices[f]=0,f++,c.triangles.indices[f]=d+1,f++,c.triangles.indices[f]=d+2,f++;this.TargetSprite._sgNode.setMeshPolygonInfo(c)}},DisableMe:function(){this.TargetSprite||(this.TargetSprite=this.node.getComponent(cc.Sprite)),this.TargetSprite&&(this.TargetSprite.type=cc.Sprite.Type.SIMPLE)}}),cc._RF.pop()},{}],SkillBtnCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"d7d80Pa8c5OKJtumEZ9/eiO","SkillBtnCtrl"),cc.Class({extends:cc.Component,properties:{animation:{default:null,type:cc.Animation},autoShoot:{default:!1,visible:!1},autoShootCount:{default:0,visible:!1}},onLoad:function(){},onEnable:function(){this.initTouchEvent()},onDisable:function(){this.removeTouchEvent()},initTouchEvent:function(){var e=this;e.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,e)},removeTouchEvent:function(){var e=this;e.node.off(cc.Node.EventType.TOUCH_START,this.touchStart,e)},touchStart:function(e){if(window.GGameEntry.PlayerManager&&window.GGameEntry.PlayerManager.Player){var t=this.animation.play();t&&(t.wrapMode=cc.WrapMode.Normal,t.repeatCount=1),window.GGameEntry.PlayerManager.Player.tryShoot()}}}),cc._RF.pop()},{}],SkillBtnJoystick:[function(e,t,n){"use strict";cc._RF.push(t,"196a1DgffRNF67E/gd1BZQs","SkillBtnJoystick");e("Util");cc.Class({extends:cc.Component,properties:{touchArea:{default:null,type:cc.Node,displayName:"激活区域"},spawnArea:{default:null,type:cc.Node,displayName:"生成区域"},ring:{default:null,type:cc.Node,displayName:"摇杆圆盘"},dot:{default:null,type:cc.Node,displayName:"摇杆节点"},directionSprite:{default:null,type:cc.Sprite},directionSpriteBaseOffset:12,_angle:{default:null,displayName:"当前触摸的角度"},_radian:{default:null,displayName:"弧度"},MoveNode:{default:null,type:cc.Node,displayName:"移动根节点"},_speed:0},onLoad:function(){window.GGameEntry.NotificationCenter.on("UpdateJoystickSetting",this.updateJoystickSetting,this)},onEnable:function(){this._initTouchEvent()},onDisable:function(){this._removeTouchEvent()},update:function(){this.canShoot&&this.clickToShoot()},updateJoystickSetting:function(){this.setTouchArea(),this.setSpawnArea(),this.setRingSize(),this.setIsShowArea()},setTouchArea:function(){null!==this.touchArea&&(this.touchArea.width=window.GGameEntry.JoystickConfig.Config.ActiveRangeWidth,this.touchArea.height=window.GGameEntry.JoystickConfig.Config.ActiveRangeHeight)},setSpawnArea:function(){if(null!==this.spawnArea){var e=this.spawnArea.getComponent(cc.Widget);e.left=window.GGameEntry.JoystickConfig.Config.AnchorCreateRangePostionX,e.bottom=window.GGameEntry.JoystickConfig.Config.AnchorCreateRangePostionY,e.enabled=!0,this.spawnArea.width=window.GGameEntry.JoystickConfig.Config.AnchorCreateRangeWidth,this.spawnArea.height=window.GGameEntry.JoystickConfig.Config.AnchorCreateRangeHeight,this.spawnArea.getComponent(SkillBtnSpawnCtrl).configTime=window.GGameEntry.JoystickConfig.Config.FadeOutTime/1e3}},setRingSize:function(){null!==this.ring&&(this.ring.width=200,this.ring.height=200,this.MoveNode.setPosition(window.GGameEntry.JoystickConfig.Config.JoystickCreatePostionX,window.GGameEntry.JoystickConfig.Config.JoystickCreatePostionY))},setIsShowArea:function(){this.touchAreaSprite=this.touchArea.getComponent("cc.Sprite"),this.spawnAreaSprite=this.spawnArea.getComponent("cc.Sprite"),window.GGameEntry.JoystickConfig.Config.IsShowArea?(this.spawnAreaSprite.enabled=!0,this.touchAreaSprite.enabled=!0):(this.spawnAreaSprite.enabled=!1,this.touchAreaSprite.enabled=!1)},_initTouchEvent:function(){var e=this;e.node.on(cc.Node.EventType.TOUCH_START,this._touchStartEvent,e),e.node.on(cc.Node.EventType.TOUCH_MOVE,this._touchMoveEvent,e),e.node.on(cc.Node.EventType.TOUCH_END,this._touchEndEvent,e),e.node.on(cc.Node.EventType.TOUCH_CANCEL,this._touchEndEvent,e)},_removeTouchEvent:function(){var e=this;e.node.off(cc.Node.EventType.TOUCH_START,this._touchStartEvent,e),e.node.off(cc.Node.EventType.TOUCH_MOVE,this._touchMoveEvent,e),e.node.off(cc.Node.EventType.TOUCH_END,this._touchEndEvent,e),e.node.off(cc.Node.EventType.TOUCH_CANCEL,this._touchEndEvent,e)},_getRadian:function(e){return this._radian=Math.PI/180*this._getAngle(e),this._radian},_getAngle:function(e){var t=this.node.getPosition();return this._angle=Math.atan2(e.y-t.y,e.x-t.x)*(180/Math.PI),this._angle=Math.floor(this._angle),this._angle},isInSpawnArea:function(e){var t=this.spawnArea,n=t.convertToNodeSpaceAR(e.getLocation()),i=t.width,a=t.height;return n.x>=0&&n.x<=i&&n.y>=0&&n.y<=a},_getDistance:function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},_touchStartEvent:function(e){if(!this.isInSpawnArea(e)){this.canShoot=!0,this.clickToShoot();var t=this.node.convertToNodeSpaceAR(e.getLocation()),n=this._getDistance(t,cc.p(0,0)),i=this.node.width/2;this._stickPos=t;var a=this.node.getPosition().x+t.x,o=this.node.getPosition().y+t.y;return i>n?(this.dot.setPosition(cc.p(a,o)),this._touchMoveEvent(e),!0):(this._touchMoveEvent(e),!1)}},_touchMoveEvent:function(e){this.clickToShoot();var t=this.node.convertToNodeSpaceAR(e.getLocation()),n=this._getDistance(t,cc.p(0,0)),i=this.node.width/2,a=this.node.getPosition().x+t.x,o=this.node.getPosition().y+t.y;if(i>n){if(this.dot.setPosition(cc.p(a,o)),n<window.GGameEntry.JoystickConfig.Config.SiQuRadius+30)return}else{var r=this.node.getPosition().x+Math.cos(this._getRadian(cc.p(a,o)))*i,s=this.node.getPosition().y+Math.sin(this._getRadian(cc.p(a,o)))*i;this.dot.setPosition(cc.p(r,s))}this._getAngle(cc.p(a,o)),this._dispatchMoveEvent()},_touchEndEvent:function(e){this.clickToShoot(),this.canShoot=!1;var t=this.node.convertToNodeSpaceAR(e.getLocation());this._getDistance(t,cc.p(0,0)),this.node.width;this.dot.setPosition(this.node.getPosition()),window.GGameEntry.NotificationCenter.emit("SkillBtnUp")},_dispatchMoveEvent:function(){window.GGameEntry.NotificationCenter.emit("SkillBtnJoystickMove",{angle:this._angle})},_updateDirectionSprite:function(){var e=this._angle;e<0&&(e+=360),e>=360&&(e%=360);var t=this.directionSprite.node;t.rotation=e<90?90-e:e>=90&&e<180?180-e+270:e>=180&&e<270?270-e+180:360-e+90;t.x=this.directionSpriteBaseOffset*window.GGameEntry.MathUtil.cos(e),t.y=this.directionSpriteBaseOffset*window.GGameEntry.MathUtil.sin(e)},clickToShoot:function(){window.GGameEntry.PlayerManager.Player.tryShoot()}}),cc._RF.pop()},{Util:"Util"}],SkillBtnSpawnCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"0c2c1lyzwNKwLKcE5vcOxTz","SkillBtnSpawnCtrl");var i=e("SkillBtnJoystick");cc.Class({extends:cc.Component,properties:{joystickNode:{default:null,type:cc.Node,displayName:"摇杆单元"},joystick:{default:null,type:i,displayName:"摇杆"},nodeWidth:{default:200,displayName:"生成区域宽度",visible:!1},nodeHeight:{default:200,displayName:"生成区域高度",visible:!1},configTime:{default:.2,visible:!1}},onLoad:function(){},onEnable:function(){this.initTouchEvent()},onDisable:function(){this.removeTouchEvent()},initTouchEvent:function(){var e=this;e.node.on(cc.Node.EventType.TOUCH_START,this.touchStartEvent,e),e.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMoveEvent,e),e.node.on(cc.Node.EventType.TOUCH_END,this.touchEndEvent,e),e.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEndEvent,e),this.resetFlag()},removeTouchEvent:function(){var e=this;e.node.off(cc.Node.EventType.TOUCH_START,this.touchStartEvent,e),e.node.off(cc.Node.EventType.TOUCH_MOVE,this.touchMoveEvent,e),e.node.off(cc.Node.EventType.TOUCH_END,this.touchEndEvent,e),e.node.off(cc.Node.EventType.TOUCH_CANCEL,this.touchEndEvent,e)},touchStartEvent:function(e){this.resetFlag();var t=this.node.convertToNodeSpaceAR(e.getLocation()),n=!1;t.x<-this.node.width&&(n=!0,t.x=-this.node.width),t.x>0&&(n=!0,t.x=0),t.y>this.node.height&&(n=!0,t.y=this.node.height),t.y<0&&(n=!0,t.y=0),this.setJoystickNodePosition(t),null!==this.joystick&&n&&this.joystick._touchStartEvent(e)},touchMoveEvent:function(e){this.resetFlag(),null!==this.joystick&&this.joystick._touchMoveEvent(e)},touchEndEvent:function(e){this.joystickReset=!0,null!==this.joystick&&this.joystick._touchEndEvent(e)},stopAllAction:function(){this.joystickNode.stopAllActions()},setJoystickNodePosition:function(e){null!==this.joystickNode&&this.joystickNode.setPosition(cc.p(e.x,e.y))},setMyNodePosition:function(e){this.node.setPosition(cc.p(e.x,e.y))},resetFlag:function(){this.resetTime=0,this.joystickReset=!1},update:function(e){this.joystickReset&&(this.resetTime+=e,this.resetTime>this.configTime&&(this.setJoystickNodePosition({x:window.GGameEntry.JoystickConfig.Config.JoystickCreatePostionX,y:window.GGameEntry.JoystickConfig.Config.JoystickCreatePostionY}),this.resetFlag()))}}),cc._RF.pop()},{SkillBtnJoystick:"SkillBtnJoystick"}],SkillBtnTouchArea:[function(e,t,n){"use strict";cc._RF.push(t,"c1f57Xf/QdC2p9bS8TmKft/","SkillBtnTouchArea");var i=e("SkillBtnSpawnCtrl");cc.Class({extends:cc.Component,properties:{spawnArea:{default:null,type:i,displayName:"生成区域"}},onLoad:function(){this.initTouchAreaSize()},onEnable:function(){this.initTouchEvent()},onDisable:function(){this.removeTouchEvent()},initTouchAreaSize:function(){this.node.width=window.GGameEntry.JoystickConfig.DefaultActiveRangeWidth,this.node.height=window.GGameEntry.JoystickConfig.DefaultActiveRangeHeight},initTouchEvent:function(){var e=this;e.node.on(cc.Node.EventType.TOUCH_START,this.touchStartEvent,e),e.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMoveEvent,e),e.node.on(cc.Node.EventType.TOUCH_END,this.touchEndEvent,e),e.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEndEvent,e)},removeTouchEvent:function(){var e=this;e.node.off(cc.Node.EventType.TOUCH_START,this.touchStartEvent,e),e.node.off(cc.Node.EventType.TOUCH_MOVE,this.touchMoveEvent,e),e.node.off(cc.Node.EventType.TOUCH_END,this.touchEndEvent,e),e.node.off(cc.Node.EventType.TOUCH_CANCEL,this.touchEndEvent,e)},touchStartEvent:function(e){null!==this.spawnArea&&this.spawnArea.touchStartEvent(e)},touchMoveEvent:function(e){null!==this.spawnArea&&this.spawnArea.touchMoveEvent(e)},touchEndEvent:function(e){null!==this.spawnArea&&this.spawnArea.touchEndEvent(e)}}),cc._RF.pop()},{SkillBtnSpawnCtrl:"SkillBtnSpawnCtrl"}],SkillDefine:[function(e,t,n){"use strict";cc._RF.push(t,"cfae9A4FcxJYKX73j5LAcNi","SkillDefine");var i=cc.Enum({SkillType_NormalAttack:1,SkillType_PickBuffItem:2,SkillType_BlockDisapper:3,SkillType_Flash:4});t.exports={SkillType:i},cc._RF.pop()},{}],Skill:[function(e,t,n){"use strict";cc._RF.push(t,"ed70ctiIR1OyJpsrqXQW8Lz","Skill"),cc.Class({extends:cc.Component,properties:{EntitySource:{default:0},EntityDest:{default:0},SkillArg:{default:0}},onLoad:function(){},initSkill:function(e){this.EntitySource=e},UseSkill:function(e){}}),cc._RF.pop()},{}],SoundManager:[function(e,t,n){"use strict";cc._RF.push(t,"fa84bACkDVLuLEOXBf4ptju","SoundManager");var i=e("PlatformUtil"),a=e("Util");cc.Class({extends:cc.Component,properties:{LogoBg:{default:null,url:cc.AudioClip},PreGameBg:{default:null,url:cc.AudioClip},GameBg:{default:null,url:cc.AudioClip},BtnEff:{default:null,url:cc.AudioClip},StartGame:{default:null,url:cc.AudioClip},WinMusic:{default:null,url:cc.AudioClip},LoseMusic:{default:null,url:cc.AudioClip},PlayerDie:{default:null,url:cc.AudioClip},PlayerBorn:{default:null,url:cc.AudioClip},PickUpItem:{default:null,url:cc.AudioClip},HitBlock:{default:null,url:cc.AudioClip},HitTank:{default:null,url:cc.AudioClip},HitNoDamage:{default:null,url:cc.AudioClip},ShootBullet:{default:null,url:cc.AudioClip},CountDown:{default:null,url:cc.AudioClip},ItemShow:{default:null,url:cc.AudioClip},BaseDie:{default:null,url:cc.AudioClip},Alert:{default:null,url:cc.AudioClip},GameBg2:{default:null,url:cc.AudioClip},firstKill:{default:null,url:cc.AudioClip},twoKill:{default:null,url:cc.AudioClip},sixKill:{default:null,url:cc.AudioClip},sevenKill:{default:null,url:cc.AudioClip},enemyTwoKill:{default:null,url:cc.AudioClip},enemySixKill:{default:null,url:cc.AudioClip},enemySevenKill:{default:null,url:cc.AudioClip},shutDown:{default:null,url:cc.AudioClip},preLogoBg:{default:null,url:cc.AudioClip},BgInnerAudioContext:{default:null,visible:!1},innerAudioContextList:{default:null,visible:!1},planeBg:{default:null,url:cc.AudioClip},dropItem:{default:null,url:cc.AudioClip},tenCountDown:{default:null,url:cc.AudioClip},playedHitBlock:{default:!1},playedHitTank:{default:!1},playedHitNoDamger:{default:!1},currentFrameAudio:{default:{},visible:!1,serializable:!1},isInBackground:{default:!1,visible:!1,serializable:!1},lastPlayBg:{default:null,visible:!1,serializable:!1},countDownAudioContext:{default:null,visible:!1,serializable:!1}},onLoad:function(){},Init:function(){if(this.BgID=-1,this.isInBackground=!1,i.IsWeichatGame()){this.BgInnerAudioContext=wx.createInnerAudioContext(),this.innerAudioContextList=[];for(var e=0;e<20;e++){var t=wx.createInnerAudioContext();this.innerAudioContextList.push(t),t.iPaused=!0,t.addCallBack=!1}}window.GGameEntry.NotificationCenter.on("GameOver",this.GameOver,this),window.GGameEntry.NotificationCenter.on("onGameShowCallback",this.onGameShowCallback,this),window.GGameEntry.NotificationCenter.on("onGameHideCallback",this.onGameHideCallback,this),window.GGameEntry.NotificationCenter.on("onAudioInterruptionEnd",this.onAudioInterruptionEnd,this),this.currentFrameAudio={}},onGameShowCallback:function(){this.isInBackground=!1,this.BgInnerAudioContext&&this.BgInnerAudioContext.src&&this.lastPlayBg!==this.WinMusic&&this.lastPlayBg!==this.LoseMusic&&this.BgInnerAudioContext.play()},onAudioInterruptionEnd:function(){this.BgInnerAudioContext&&this.BgInnerAudioContext.src&&this.lastPlayBg!==this.WinMusic&&this.lastPlayBg!==this.LoseMusic&&this.BgInnerAudioContext.play()},onGameHideCallback:function(){this.isInBackground=!0},onPause:function(){this.countDownAudioContext&&this.countDownAudioContext.src&&this.countDownAudioContext.pause()},onResume:function(){this.countDownAudioContext&&this.countDownAudioContext.src&&this.countDownAudioContext.play()},getAudioContext:function(){for(var e=null,t=0;t<this.innerAudioContextList.length;t++)if(this.innerAudioContextList[t].iPaused){e=this.innerAudioContextList[t];break}if(e&&!e.addCallBack){e.addCallBack=!0;var n=this,i=t;e.onEnded(function(){i<n.innerAudioContextList.length&&(n.innerAudioContextList[i].iPaused=!0)}),e.onStop(function(){i<n.innerAudioContextList.length&&(n.innerAudioContextList[i].iPaused=!0)}),e.onError(function(){i<n.innerAudioContextList.length&&(n.innerAudioContextList[i].iPaused=!0)})}return e},PlayBg:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.isInBackground||(this.StopBg(),i.IsWeichatGame()?this.BgInnerAudioContext&&(this.lastPlayBg=e,this.BgInnerAudioContext.src=e,this.BgInnerAudioContext.loop=t,n&&this.BgInnerAudioContext.onEnded(n),this.BgInnerAudioContext.play()):(this.BgID=cc.audioEngine.play(e,t),n&&cc.audioEngine.setFinishCallback(this.BgID,n)))},StopBg:function(){-1!==this.BgID&&cc.audioEngine.stop(this.BgID)},CheckPlaying:function(e){return!(!this.currentFrameAudio[e]||1!=this.currentFrameAudio[e])},PlayAudioEffect:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this.isInBackground&&!this.CheckPlaying(e)){var n=a.BeginSample("SoundManager::PlayAudioEffect");if(this.currentFrameAudio[e]=1,i.IsWeichatGame()){var o=this.getAudioContext();o&&(o.src=e,o.loop=!1,t&&o.onEnded(t),o.play(),o.iPaused=!1)}else cc.audioEngine.playEffect(e,!1);a.EndSample(n)}},effectFinish:function(e){e<this.innerAudioContextList.length&&(this.innerAudioContextList[e].iPaused=!0)},PlayPreLogoBg:function(){var e=this;this.PlayBg(this.preLogoBg,!1,function(){e.PlayLogoBg(),console.error("开始播放")})},PlayLogoBg:function(){this.PlayBg(this.LogoBg)},PlayPreGameBg:function(){this.PlayBg(this.PreGameBg,!1)},PlayGameBg:function(){this.PlayBg(this.GameBg)},PlayGameBg2:function(){this.PlayBg(this.GameBg2)},PlayBtnEff:function(){this.PlayAudioEffect(this.BtnEff)},PlayStartGame:function(){this.PlayAudioEffect(this.StartGame)},PlayWinMusic:function(){this.PlayBg(this.WinMusic,!1)},PlayLoseMusic:function(){this.PlayBg(this.LoseMusic,!1)},PlayMonsterDie:function(e){e&&window.GGameEntry.PlayerManager.Player&&!window.GGameEntry.PlayerManager.Player.IsInPlayerView(e)||this.PlayAudioEffect(this.PlayerDie)},PlayPlayerDie:function(e){e&&window.GGameEntry.PlayerManager.Player&&!window.GGameEntry.PlayerManager.Player.IsInPlayerView(e)||this.PlayAudioEffect(this.PlayerDie)},PlayShootBullet:function(){this.PlayAudioEffect(this.ShootBullet)},PlayPlayerBorn:function(){this.PlayAudioEffect(this.PlayerBorn)},PlayGameCountDown:function(){this.PlayAudioEffect(this.CountDown)},PlayPickUpItem:function(){this.PlayAudioEffect(this.PickUpItem)},PlayHitBlock:function(e){this.playedHitBlock||(this.playedHitBlock=!0,e&&window.GGameEntry.PlayerManager.Player&&!window.GGameEntry.PlayerManager.Player.IsInPlayerView(e)||this.PlayAudioEffect(this.HitBlock))},PlayHitTank:function(e){this.playedHitTank||(this.playedHitTank=!0,e&&window.GGameEntry.PlayerManager.Player&&!window.GGameEntry.PlayerManager.Player.IsInPlayerView(e)||this.PlayAudioEffect(this.HitTank))},PlayHitNoDamage:function(e){this.playedHitNoDamger||(this.playedHitNoDamger=!0,e&&window.GGameEntry.PlayerManager.Player&&!window.GGameEntry.PlayerManager.Player.IsInPlayerView(e)||this.PlayAudioEffect(this.HitNoDamage))},PlayItemShow:function(e){e&&window.GGameEntry.PlayerManager.Player&&!window.GGameEntry.PlayerManager.Player.IsInPlayerView(e)||this.PlayAudioEffect(this.ItemShow)},PlayBaseDie:function(){this.PlayAudioEffect(this.BaseDie)},PlayAlert:function(){this.PlayAudioEffect(this.Alert)},PlayFirstKill:function(){this.PlayAudioEffect(this.firstKill)},PlayTwoKill:function(e){e?this.PlayAudioEffect(this.enemyTwoKill):this.PlayAudioEffect(this.twoKill)},PlaySixKill:function(e){e?this.PlayAudioEffect(this.enemySixKill):this.PlayAudioEffect(this.sixKill)},PlaySevenKill:function(e){e?this.PlayAudioEffect(this.enemySevenKill):this.PlayAudioEffect(this.sevenKill)},PlayShutDown:function(){this.PlayAudioEffect(this.shutDown)},PlayPlane:function(){this.PlayAudioEffect(this.planeBg)},PlayDropItem:function(){this.PlayAudioEffect(this.dropItem)},PlayTenCountDown:function(e){if(i.IsWeichatGame()){this.countDownAudioContext=wx.createInnerAudioContext(),this.countDownAudioContext.src=this.tenCountDown,this.countDownAudioContext.loop=!1;var t=this;this.countDownAudioContext.onPlay(function(){t.countDownAudioContext.seeked||(e>0&&(e++,t.countDownAudioContext.seek(e)),t.countDownAudioContext.seeked=!0)}),this.countDownAudioContext.play(),console.error("startTime: "+e)}else this.tenCountDownID=cc.audioEngine.play(this.tenCountDown,!1)},Pause:function(){cc.audioEngine.pauseAll()},update:function(e){if(this.playedHitTank=!1,this.playedHitBlock=!1,this.playedHitNoDamger=!1,this.currentFrameAudio)for(var t in this.currentFrameAudio)this.currentFrameAudio[t]=0},Resume:function(){cc.audioEngine.resumeAll()},GameOver:function(){if(!i.IsWeichatGame()&&this.tenCountDownID&&cc.audioEngine.stop(this.tenCountDownID),this.innerAudioContextList)for(var e=0;e<this.innerAudioContextList.length;e++)this.innerAudioContextList[e].iPaused||this.innerAudioContextList[e].stop();this.countDownAudioContext&&(this.countDownAudioContext.stop(),this.countDownAudioContext.destroy(),this.countDownAudioContext=null)}}),cc._RF.pop()},{PlatformUtil:"PlatformUtil",Util:"Util"}],StaticAnimation:[function(e,t,n){"use strict";cc._RF.push(t,"3f6973JHftFpKTMspSNwhiz","StaticAnimation"),cc.Class({extends:cc.Component,properties:{animationCtrl:{default:null,type:cc.Animation},randomDelay:{default:!1},randomDelayTime:{default:0}},onEnable:function(){var e=this;if(this.animationCtrl.on("finished",this.animationFinish,e),this.randomDelay){var t=Math.random()*this.randomDelayTime;this.scheduleOnce(function(){this.playAnimation()},t)}else this.playAnimation()},playAnimation:function(){var e=this.animationCtrl.play();e&&(e.wrapMode=cc.WrapMode.Normal,e.repeatCount=1)},onDisable:function(){var e=this;this.animationCtrl.off("finished",this.animationFinish,e),this.animationCtrl.stop()},animationFinish:function(){window.GGameEntry.AnimationManager.returnAnimation(this.node.name,this.node)}}),cc._RF.pop()},{}],StatusReturn:[function(e,t,n){"use strict";cc._RF.push(t,"1d58aPBJXJMur/L6JG3MSzk","StatusReturn");var i=cc.Enum({None:0,Failure:1,Success:2,Invert:3});t.exports=i,cc._RF.pop()},{}],TankAttr:[function(e,t,n){"use strict";cc._RF.push(t,"379b141W0BCZZwMTY7+7dWg","TankAttr"),cc.Class({extends:cc.Component,properties:{GunPoint:{default:null,type:cc.Node}},onLoad:function(){}}),cc._RF.pop()},{}],TankBase:[function(e,t,n){"use strict";cc._RF.push(t,"c0cd0dUkLZDyJZOqY3fCnL7","TankBase");e("EntityBase");var i=e("EntityTypeDefine"),a=e("NormalAttackSkill"),o=e("PickBufferSkill"),r=e("EntityDynamic"),s=e("BlockDisappear"),l=e("Util"),c=e("MsgPickUpItem"),u=e("PlayerAnimationCtrl"),d=e("ResTableNames"),h=(e("BuffBase"),e("BuffDefine"),e("MsgMovePath")),f=e("GlobalCfg"),m=(e("UIManager"),e("PvPInfo"),e("BuffManager")),y=e("FlashSkill"),p=e("MsgUseBuff"),g=(e("CmdSkill"),e("TankMisc")),C=(e("TankMisc"),e("ResCfgDef")),G=e("PlatformUtil");cc.Class({extends:r,properties:{enableMoving:{default:!1},targetPos:{default:500},MoveSpeed:{default:cc.v2(0,0),serializable:!1,visible:!1},LastSendMoveTime:{default:0,serializable:!1,visible:!1},ImageNode:{default:null,type:cc.Node},CurrentAttachCd:{default:500,serializable:!1,visible:!1},DirectionArrow:{default:null,type:cc.Node},Hp:{default:100,serializable:!1,visible:!1},TankName:{default:"贝塔",serializable:!1,visible:!1},LastPosition:{default:cc.v2(0,0),serializable:!1,visible:!1},Gird:{default:null,serializable:!1,visible:!1},MyCollider:{default:null,type:cc.Collider},CfgAttachCd:{default:500,serializable:!1,visible:!1},CfgSourceConfigSpeed:{default:3,serializable:!1,visible:!1},CfgBulletLeftNum:{default:3,serializable:!1,visible:!1},CfgBulletFillTime:{default:1e3,serializable:!1,visible:!1},CurrentBulletLeftNum:{default:3,serializable:!1,visible:!1},CurrentBulletFillTime:{default:0,serializable:!1,visible:!1},BulletSpeed:{default:0,serializable:!1,visible:!1},BulletMaxDistance:{default:0,serializable:!1,visible:!1},LastShootTime:{default:0,serializable:!1,visible:!1},ShootDistancePixel:{default:0,serializable:!1,visible:!1},PaoTaiNode:{default:null,type:cc.Node},PickBufferSkill:{default:0,serializable:!1,visible:!1},BufferId:{default:0,serializable:!1,visible:!1},noramlAttackSkill:{default:0,serializable:!1,visible:!1},flashSkill:{default:0,serializable:!1,visible:!1},EntityLineType:{default:i.EntityLineType.Mid,type:i.EntityLineType,serializable:!1,visible:!1},ShootBulletId:{default:0},MyAnimationCtrl:{default:null,type:u},NewShootRule:{default:!0,serializable:!0,visible:!0},EnableShootPowerFill:{default:!1},Pause:{default:!1,serializable:!1,visible:!1},BuffList:{default:null,serializable:!1,visible:!1},GuijiPrefab:{default:null,type:cc.Prefab},GuijiPrefabName:"",GuijiCount:{default:0,visible:!1},TankHpControl:{default:null,type:cc.Node},MoveBonus:{default:0,visible:!1},Invincible:{default:!1,visible:!1},GuijiDistance:{default:60},GuijiFrameGap:{default:5},HuoLiJiaQiang:{default:null,type:cc.Node},HeadImageUrl:{default:null,visible:!1},RotationBase:{default:10},HalfRotationBase:{default:5},MotionStreak:{default:null,type:cc.MotionStreak},PlayerDieEffect:{default:"Player_die"},TankWalkUnit:{default:50,visible:!1},LineSpriteFrame:{default:null,type:cc.SpriteFrame},LeftHpNode:{default:null,type:cc.Node},CachedLineSprite:{default:[],type:cc.Node},tankGamingStateType:{default:g.TankGamingStateType.TankGamingState_Normal,type:g.TankGamingStateType},Sprite1Change:{default:null,type:cc.Sprite},leftHPnode:{default:null,type:cc.Node},TankNamePrefab:{default:null,type:cc.Prefab},TankHeadImagePrefab:{default:null,type:cc.Prefab},TankHpNode:{default:null,type:cc.Node},TankInGrassCount:{default:0,visible:!1,serializable:!1}},OnDie:function(){var e=l.BeginSample("TankBase::OnDie");this.changeBulletId(20001);var t=cc.p(this.node.position.x+(.5-this.node.anchorX)*this.node.width,this.node.position.y+(.5-this.node.anchorY)*this.node.height);window.GGameEntry.AnimationManager.getAnimationAtPosition(this.PlayerDieEffect,window.GGameEntry.MapManager.MapBottomLayer,t,this.GetRotation()),this.LastDiePosition=t,this.BuffManager.clearBuff(),this._super(),this.LastHitByEntity?(window.GGameEntry.NotificationCenter.emit("TankDie",{campType:this.EntityCampType,lineType:this.EntityLineType,guid:this.Guid,hitCampType:this.LastHitByEntity.EntityCampType,hitLineType:this.LastHitByEntity.EntityLineType,hitGuid:this.LastHitByEntity.Guid}),window.GGameEntry.ResManager.GetProgramEffCfg(C.ProgramEffType.JiShaZhenPing)===C.PEJiShaZhenPing.All&&this.LastHitByEntity.Guid===window.GGameEntry.PlayerManager.Player.Guid&&window.GGameEntry.BattleRoot.ShakeFor()):window.GGameEntry.NotificationCenter.emit("TankDie",{campType:this.EntityCampType,lineType:this.EntityLineType,guid:this.Guid,hitCampType:0,hitLineType:0,hitGuid:0}),window.GGameEntry.ResManager.GetProgramEffCfg(C.ProgramEffType.JiShaZhenPing)!==C.PEJiShaZhenPing.Own&&window.GGameEntry.ResManager.GetProgramEffCfg(C.ProgramEffType.JiShaZhenPing)!==C.PEJiShaZhenPing.All||this.Guid===window.GGameEntry.PlayerManager.Player.Guid&&window.GGameEntry.BattleRoot.ShakeFor(),this.Body.visible=!1,this.ShootBulletId=20001,this.BufferId=0,window.GGameEntry.MapManager.RemoveStaticEntity(this.node.x,this.node.y),this.isDead=!0,l.EndSample(e)},onLoad:function(){this.Gird=window.GGameEntry.MapManager.GetGridPos(this.node.x,this.node.y)},Reset:function(){this._super(),this.LoadConfig(),this.MoveSpeed.x=0,this.MoveSpeed.y=0,this.ShootBulletId=20001,this.BufferId=0,this.ImageNode.rotation=0,this.PaoTaiNode.rotation=0,this.isDead=!1,this.BuffManager.Entity=this,this.tankGamingStateType=g.TankGamingStateType.TankGamingState_Normal,this.TankInGrassCount=0},Release:function(){this.BuffManager.clearBuff()},LoadConfig:function(){var e=window.GGameEntry.ResTableMgr.GetConfigByID(d.star_tank_cs,this.ConfigId);e&&(this.CfgAttachCd=parseInt(e.CD),this.CurrentAttachCd=this.CfgAttachCd,this.CfgBulletLeftNum=parseInt(e.ButtleNum),this.CurrentBulletLeftNum=this.CfgBulletLeftNum,this.CfgBulletFillTime=parseInt(e.ButtleInt),this.MaxHp=parseInt(e.HP),this.Hp=parseInt(e.HP),this.ShootBulletId=parseInt(e.ButtleID),this.SetAttackRing(),this.CfgSourceConfigSpeed=parseInt(e.MoveSpeed),this.StartSpeed=parseInt(e.StartSpeed),this.MidSpeed=parseInt(e.MidSpeed),this.SpeedUpSpeed1=(this.MidSpeed-this.StartSpeed)/(parseInt(e.StartSpeedTime)/1e3),this.SpeedUpSpeed2=(this.CfgSourceConfigSpeed-this.MidSpeed)/(parseInt(e.MidSpeedTime)/1e3),this.StaticConfigSpeed=parseInt(e.MoveSpeed))},Init:function(e){this._super(),this.noramlAttackSkill=new a,this.noramlAttackSkill.initSkill(this),this.PickBufferSkill=new o,this.PickBufferSkill.initSkill(this),this.BlockDisappearSkill=new s,this.BlockDisappearSkill.initSkill(this),this.flashSkill=new y,this.flashSkill.initSkill(this),this.LoadConfig(),this.setHPLine(this.MaxHp),this.BuffManager=new m,this.BuffManager.Entity=this,this.InitMoveArea(),this.isDead=!1,this.RotationBase=360/window.GGameEntry.GlobalCfg.rotationBase,this.HalfRotationBase=this.RotationBase/2},onEnable:function(){window.GGameEntry.NotificationCenter.on("UpdateJoystickSetting",this.updateJoystickSetting,this)},onDisable:function(){window.GGameEntry.NotificationCenter.off("UpdateJoystickSetting",this.updateJoystickSetting,this)},updateJoystickSetting:function(){this.StartSpeed=window.GGameEntry.JoystickConfig.Config.StartSpeed,this.MidSpeed=window.GGameEntry.JoystickConfig.Config.CenterSpeed,this.SpeedUpSpeed1=(this.MidSpeed-this.StartSpeed)/(window.GGameEntry.JoystickConfig.Config.StartSpeedTime/1e3),this.SpeedUpSpeed2=(this.CfgSourceConfigSpeed-this.MidSpeed)/(window.GGameEntry.JoystickConfig.Config.CenterChangeSpeedTime/1e3)},updateGlobalConfig:function(){this.RotationBase=360/window.GGameEntry.GlobalCfg.rotationBase,this.HalfRotationBase=this.RotationBase/2},OnGlobalConfigUpdate:function(){this.RotationBase=window.GGameEntry.GlobalCfg.rotationBase,this.HalfRotationBase=this.RotationBase/2},InitMoveArea:function(){if(this.node){var e=window.GGameEntry.MapManager.GetBattleFieldRect();this.moveLeftX=this.node.width/2,this.moveRightX=e.width-this.node.width/2,this.moveBottomY=this.node.height/2,this.moveTopY=e.height-this.node.height/2}},outsideTest:function(e){return e.x<this.moveLeftX?e.x=this.moveLeftX:e.x>this.moveRightX&&(e.x=this.moveRightX),e.y<this.moveBottomY?e.y=this.moveBottomY:e.y>this.moveTopY&&(e.y=this.moveTopY),e},OnSetHp:function(e){this._super(e),this.Hp=e},GetCamp:function(){return this.EntityCampType},GetLine:function(){return this.EntityLineType},GetTankName:function(){var e=this.TankName;return G.isTargetPlatform(2)&&(e=l.FliterEmojString(e)),e},canShoot:function(){return!!window.GGameEntry.BattleSystem.IsPlaying()&&(!(Date.now()-this.LastShootTime<=this.CurrentAttachCd)&&!(this.CurrentBulletLeftNum<1))},GetShootDistancePixel:function(){if(0===this.ShootDistancePixel){var e=window.GGameEntry.ResTableMgr.GetConfigByID(d.star_bullet_cs,this.ShootBulletId);e&&(this.ShootDistancePixel=e.Dist)}return this.ShootDistancePixel},Shoot:function(e){if(!this.canShoot())return!1;var t=l.BeginSample("TankBase::Shoot");window.GGameEntry.ResManager.GetProgramEffCfg(C.ProgramEffType.ZiDanFireEffect)===C.PEZiDanFireEffect.Y&&(!1===this.PaoTaiNode.active&&(this.PaoTaiNode.active=!0),this.PlayAnimation(this.MyAnimationCtrl.fireAnimation,this.MyAnimationCtrl.FireAnimationClipName,1));var n=-1;void 0!==e&&(n=e),window.GGameEntry.BulletManager.CreateBullet(this.ShootBulletId,this,n),this.Guid==window.GGameEntry.PlayerManager.Player.Guid&&window.GGameEntry.SoundManager.PlayShootBullet(),this.CurrentBulletLeftNum=this.CurrentBulletLeftNum-1,this.NewShootRule&&0==this.CurrentBulletLeftNum&&(this.EnableShootPowerFill=!0);var i=Date.now();return this.LastShootTime=i,l.EndSample(t),!0},PlayAnimation:function(e,t,n){this.MyAnimationCtrl.playAnimation(e,t,n)},StopAnimation:function(e,t){this.MyAnimationCtrl.stopAnimation(e,t)},OnMinusHp:function(e){this.Invincible||(this.Hp=this.Hp-e,this.Hp<=0&&this.OnDie())},OnAddHp:function(e){this.Hp=this.Hp+e,this.Hp>this.MaxHp&&(this.Hp=this.MaxHp)},PickBufferItem:function(e){var t=1;this.GetEntityType()==i.EntityType.EntityPlayer&&this.getBufferId()&&(t=2);var n=-1;void 0!==e&&(n=e),window.GGameEntry.BulletManager.CreateBullet(t,this,n)},SetRotateShootPoint:function(e){},SetMoveTarget:function(e){this.targetPos=e,this.enableMoving=!0},onCollisionLogic:function(e,t){var n=l.BeginSample("TankBase::onCollisionLogic");if("Items"===e.node.group){var a=e.node.getComponent("EntityBase");if(null!==a)switch(a.EntityType){case i.EntityType.EntityBuffItem:var o=e.node.getComponent("ItemPowerUp");if(!o.Used){o.Used=!0;var r=this.GetGuid(),s=o.GetGuid();if((u=new c).entityGUID=r,u.targetGUID=s,!(h=window.GGameEntry.ResTableMgr.GetConfigByID(d.star_item_cs,o.Resid)))return cc.error("Item not found:",nItemID),null;u.buffID=h.BuffId,u.itemId=o.Resid,u.Send(),this.Guid==window.GGameEntry.PlayerManager.Player.Guid&&1305!=a.Resid&&window.GGameEntry.SoundManager.PlayPickUpItem(),window.GGameEntry.CurGamePlayType===f.GamePlayType.GamePlayType_Network&&o.OnDie()}break;default:if(1305==a.Resid){var r=this.GetGuid(),s=a.GetGuid(),u=new c;u.entityGUID=r,u.targetGUID=s;var h=window.GGameEntry.ResTableMgr.GetConfigByID(d.star_item_cs,a.Resid);if(!h)return cc.error("Item not found:",nItemID),null;u.buffID=h.BuffId,u.itemId=a.Resid,u.Send()}}}l.EndSample(n)},getBufferId:function(){return this.BufferId},doChangeBufftId:function(e){this.BufferId=e},changeBulletId:function(e){if(window.GGameEntry.PlayerManager.Player){if(window.GGameEntry.ResManager.GetProgramEffCfg(C.ProgramEffType.TankChangeMode)===C.PETankChangeMode.Y&&this.ShootBulletId!==e){var t=window.GGameEntry.ResTableMgr.GetConfigByID(d.star_bullet_cs,e);if(t){var n;n=this.EntityCampType===window.GGameEntry.PlayerManager.Player.EntityCampType?t.BlueFort:t.RedFort,this.Sprite1Change.spriteFrame=this.SpAtlas.getSpriteFrame(n)}}this.ShootBulletId=e,this.SetAttackRing()}else l.AssertCheck(!1,"玩家没有创建 修改子弹不对"+e)},SetAttackRing:function(){if(this.attackRing){var e=this.attackRing.getComponent(cc.Sprite),t=window.GGameEntry.ResTableMgr.GetConfigByID(d.star_bullet_cs,this.ShootBulletId),n=parseInt(t.Dist);20006==this.ShootBulletId?(e.spriteFrame=this.attackRingBG[1],this.attackRing.setPosition(cc.p(0,-37)),this.attackRing.width=n+120,this.attackRing.height=253):20004==this.ShootBulletId||20010==this.ShootBulletId?(e.spriteFrame=this.attackRingBG[2],this.attackRing.setPosition(cc.p(0,-37)),this.attackRing.width=n+130,this.attackRing.height=300):(e.spriteFrame=this.attackRingBG[0],this.attackRing.setPosition(cc.p(0,-13)),this.attackRing.width=n+96,this.attackRing.height=200)}},IsTankPointsInBlock:function(e){var t=this.node.width/2,n=this.node.height/2,i=[],a=cc.p(e.x-t,e.y+n);i.push(a);a=cc.p(e.x,e.y+n);i.push(a);a=cc.p(e.x+t,e.y+n);i.push(a);a=cc.p(e.x-t,e.y);i.push(a);a=cc.p(e.x+t,e.y);i.push(a);a=cc.p(e.x-t,e.y-n);i.push(a);a=cc.p(e.x,e.y-n);i.push(a);a=cc.p(e.x+t,e.y-n);i.push(a);for(var o=0;o<i.length;o++)if(!window.GGameEntry.BlockMgr.isCanWalk(i[o].x,i[o].y))return!0;return!1},canWalkDynamicObject:function(e){var t=window.GGameEntry.MapManager.MaxSmallGridWidth*window.GGameEntry.MapManager.BigGridSize,n=window.GGameEntry.MapManager.MaxSmallGridHeight*window.GGameEntry.MapManager.BigGridSize,i=this.node.width*this.node.anchorX,a=this.node.height*this.node.anchorY;return t-=i,n-=i,!(e.x<i||e.y<a||e.x>t||e.y>n)&&((this==window.GGameEntry.PlayerManager.Player||!window.GGameEntry.PlayerManager.IsCollisionWithPlayer(this,e))&&!window.GGameEntry.PlayerManager.IsCollisionWithOtherPlayer(this,e))},findNearCanWalkPos:function(e,t){for(var n=[[-100,0],[0,-100],[100,0],[0,100],[100,100],[-100,-100],[-100,100],[100,-100],[200,200],[-200,-200],[200,-100],[100,-200]],i=0;i<n.length;i++){var a=n[i],o=a[0]+e,r=a[1]+t,s=cc.v2(o,r);if((this==window.GGameEntry.PlayerManager.Player||!window.GGameEntry.PlayerManager.IsCollisionWithPlayer(this,s))&&this.canWalk(s))return s}return cc.v2(0,0)},canWalk:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n={x:0,y:0};if(n.x=e.x,n.y=e.y,t&&(n.x%50!=0&&(t.x>0?n.x=50*Math.ceil(n.x/50):t.x<0&&(n.x=50*Math.floor(n.x/50))),n.y%50!=0&&(t.y>0?n.y=50*Math.ceil(n.y/50):t.y<0&&(n.y=50*Math.floor(n.y/50)))),window.GGameEntry.AirDropSystem.IsCollisionWithTank(this,n))return!1;if(this!=window.GGameEntry.PlayerManager.Player&&window.GGameEntry.PlayerManager.IsCollisionWithPlayer(this,n))return!1;if(this.IsTankPointsInBlock(n))return!1;if(window.GGameEntry.MonsterManager&&window.GGameEntry.MonsterManager.IsCollisionWithOtherMonster(this,n))return!1;if(window.GGameEntry.CurGamePlayType===f.GamePlayType.GamePlayType_Network&&window.GGameEntry.PlayerManager.IsCollisionWithOtherPlayer(this,n))return!1;if(this.EntityType===i.EntityType.EntityMonster&&window.GGameEntry.PlayerManager.Player&&window.GGameEntry.PlayerManager.Player.node.active){if(this.EntityCampType===i.EntityCampType.BlueTeam)return!0;if(!window.GGameEntry.PlayerManager.Player.node.active)return!0;var a=window.GGameEntry.PlayerManager.Player.MyCollider.world.aabb.clone(),o=this.MyCollider.world.aabb.clone();if(a.x=window.GGameEntry.PlayerManager.Player.node.x,a.y=window.GGameEntry.PlayerManager.Player.node.y,o.x=n.x,o.y=n.y,a.intersects(o))return!1}return!0},doMoveToNearTarget:function(e,t){var n=l.BeginSample("TankBase::doMoveToNearTarget"),i=cc.v2(0,0),a=!1;if(0!=this.MoveSpeed.x){o=1;if(this.MoveSpeed.x<0&&(o=-1),i.x=Math.floor(e.x+o*this.CfgSourceConfigSpeed*t),i.y=Math.floor(e.y),this.canWalk(i))return this.setTankPosition(cc.p(i.x,i.y)),this.calcSpeed(i),a=!0,l.EndSample(n),!0}if(0!=this.MoveSpeed.y&&!a){var o=1;if(this.MoveSpeed.y<0&&(o=-1),i.x=Math.floor(e.x),i.y=Math.floor(e.y+100*o*t),this.canWalk(i))return this.setTankPosition(cc.p(i.x,i.y)),this.calcSpeed(i),l.EndSample(n),!0}return this.clearSpeed(),l.EndSample(n),!1},clearSpeed:function(){this.moveNeedTime=0,this.MoveSpeed.x=0,this.MoveSpeed.y=0},calcSpeed:function(e){var t=this.node.position;if(e.equals(t))return this.MoveSpeed.x=0,void(this.MoveSpeed.y=0);var n=this.CfgSourceConfigSpeed,i=e.sub(t),a=i.mag();this.moveNeedTime=a/n;var o=i.normalize().mulSelf(n);this.MoveSpeed.x=o.x,this.MoveSpeed.y=o.y},doMoveToTarget:function(e,t){if(!this.Pause){if(this.node.position.equals(e))return!0;0===this.MoveSpeed.x&&0===this.MoveSpeed.y&&this.calcSpeed(e);var n=this.node.position;return this.rotateTarget(e),this.rotatePaotaiTarget(e),this.moveNeedTime=this.moveNeedTime-t,this.moveNeedTime>0?(n.addSelf(cc.v2(this.MoveSpeed.x*t,this.MoveSpeed.y*t)),this.canWalk(n)?(this.setTankPosition(n),!1):!this.doMoveToNearTarget(this.node.position,t)):this.canWalk(n)?(this.clearSpeed(),this.setTankPosition(n),!0):!this.doMoveToNearTarget(this.node.position,t)}},CalRotation:function(e){var t=this.node.position,n=e.sub(t),i=Math.atan2(n.y,n.x)*(180/Math.PI)-90;return i=-i},rotateTarget:function(e){this.node.position.equals(e)||(this.ImageNode.rotation=this.CalRotation(e))},rotatePaotaiTarget:function(e){this.node.position.equals(e)||(this.PaoTaiNode.rotation=this.CalRotation(e))},rotateAll:function(e){this.ImageNode.rotation=e,this.PaoTaiNode.rotation=e},rotatePaotaiToMovingDir:function(){this.PaoTaiNode.rotation=this.ImageNode.rotation},setPhysCollisionPosition:function(e,t){var n=l.BeginSample("TankBase::setPhysCollisionPosition"),i=(this.node.position,this.node.position),a=e.node.getComponent("TankBase").MoveSpeed.normalize().mulSelf(2);i.addSelf(a);var o=[];o[o.length]=cc.v2(i.x-t.node.width/2,i.y-t.node.height/2),o[o.length]=cc.v2(i.x-t.node.width/2,i.y+t.node.height/2),o[o.length]=cc.v2(i.x+t.node.width/2,i.y-t.node.height/2),o[o.length]=cc.v2(i.x+t.node.width/2,i.y+t.node.height/2);for(var r=0;r<o.length;r++){var s=o[r],c=window.GGameEntry.MapManager.GetGridPos(s.x,s.y);if(!window.GGameEntry.MapManager.GridCanWalkByStaticObject(c[0],c[1]))return this.SetLastNodePosition(e,t),void l.EndSample(n)}this.setTankPosition(i),l.EndSample(n)},SetLastNodePositionDirect:function(e,t){this.setTankPosition(this.LastPosition)},SetLastNodePosition:function(e,t){var n=l.BeginSample("TankBase::SetLastNodePosition"),i=!1,a=!1,o=e.world,r=this.node.position;this.setTankPosition(cc.p(r.x,this.LastPosition.y));var s=l.GetColliderWorld(this.MyCollider);o.aabb.intersects(s.aabb)&&(i=!0),this.setTankPosition(cc.p(this.LastPosition.x,r.y)),s=l.GetColliderWorld(this.MyCollider),o.aabb.intersects(s.aabb)&&(a=!0);var c=cc.p(this.LastPosition.x+1.25*(r.x-this.LastPosition.x),this.LastPosition.y+1.25*(r.y-this.LastPosition.y));i&&(c.x=this.LastPosition.x),a&&(c.y=this.LastPosition.y),this.setTankPosition(c),l.EndSample(n)},setTankPosition:function(e){var t=this.node.position;e.equals(t)||(e=this.outsideTest(e),this.node.setPosition(e),window.GGameEntry.MapManager.UpdateDynamicEntityFlag(this,t.x,t.y,!1),this.sendTankPosition(e))},sendTankPosition:function(e){window.GGameEntry.CurGamePlayType===f.GamePlayType.GamePlayType_Network&&window.GGameEntry.PlayerManager.serverTime-this.LastSendMoveTime>parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(d.star_global_cs,24).Value)&&this.sendTankPositionDirect(e)},sendTankPositionDirect:function(e){this.LastSendMoveTime=window.GGameEntry.PlayerManager.serverTime;var t=new h;t.entityGUID=this.GetGuid(),t.Point=cc.v2(e.x,e.y),t.Dir=this.PaoTaiNode.rotation,t.Time=window.GGameEntry.PlayerManager.serverTime-window.GGameEntry.BattleSystem.BattleData.StartTime,t.Send()},setPosAndClearSitum:function(){},setPosAndDir:function(e,t,n){},setPosAndDirect:function(e){var t=this.node.getPosition();this.node.setPosition(e),window.GGameEntry.MapManager.UpdateDynamicEntityFlag(this,t.x,t.y,!1)},updateUiFillingBUllet:function(){},update:function(e){var t=l.BeginSample("TankBase::update");this.flashSkill&&this.flashSkill.update(e),this.NewShootRule?this.EnableShootPowerFill&&(this.CurrentBulletFillTime=this.CurrentBulletFillTime+1e3*e,this.CurrentBulletFillTime>this.CfgBulletFillTime?(this.CurrentBulletFillTime=this.CurrentBulletFillTime-this.CfgBulletFillTime,this.CurrentBulletLeftNum=this.CurrentBulletLeftNum+1,this.CurrentBulletLeftNum>=this.CfgBulletLeftNum&&(this.EnableShootPowerFill=!1)):this.updateUiFillingBUllet()):this.CurrentBulletLeftNum<this.CfgBulletLeftNum&&(this.CurrentBulletFillTime=this.CurrentBulletFillTime+1e3*e,this.CurrentBulletFillTime>this.CfgBulletFillTime?(this.CurrentBulletFillTime=this.CurrentBulletFillTime-this.CfgBulletFillTime,this.CurrentBulletLeftNum=this.CurrentBulletLeftNum+1,this.CurrentBulletLeftNum,this.CfgBulletLeftNum):this.updateUiFillingBUllet());var n=this.node.getPosition();if(this.LastPosition.x==n.x&&this.LastPosition.y==n.y||this.AddGuiji(),this.LastPosition=this.node.position,this.TankHpControl){var i=this.Hp/this.MaxHp;this.TankHpControl.scaleX=i}this.MoveBonus=window.GGameEntry.GlobalCfg.PlayerDefaultMoveSpeed.x*e,l.EndSample(t),this.checkTankInGrass()},checkTankInGrass:function(){if(window.GGameEntry.CurGamePlayType!==f.GamePlayType.GamePlayType_Single&&this.EntityCampType!=window.GGameEntry.PlayerManager.GetMyCamp())if(this.TankInGrassCount>0){if(this.TankHpNode&&this.TankHpNode.active&&(this.TankHpNode.active=!1),this.tankNameFollow&&this.tankNameFollow.node.active&&(this.tankNameFollow.node.active=!1),this.BuffManager)for(e=14;e<17;e++)(t=this.BuffManager.getBuffByBuffID(e))&&t.buffAnimation&&t.buffAnimation.node.active&&(t.buffAnimation.node.active=!1)}else if(this.TankHpNode&&!this.TankHpNode.active&&(this.TankHpNode.active=!0),this.tankNameFollow&&!this.tankNameFollow.node.active&&(this.tankNameFollow.node.active=!0),this.BuffManager)for(var e=14;e<17;e++){var t=this.BuffManager.getBuffByBuffID(e);t&&t.buffAnimation&&!t.buffAnimation.node.active&&(t.buffAnimation.node.active=!0)}},lateUpdate:function(e){this.BuffManager.executeBuff(e)},UpdateDirectionArrow:function(e){this.DirectionArrow.active=!0,e<0&&(e+=360),e>=360&&(e%=360);var t=e=e<90?90-e:e>=90&&e<180?180-e+270:e>=180&&e<270?270-e+180:360-e+90;this.ImageNode.rotation=t,window.GGameEntry.GlobalCfg.useDoubleJoystick||(this.PaoTaiNode.rotation=this.ImageNode.rotation)},GetBulletSpawnPosition:function(){return this.PaoTaiNode.convertToWorldSpaceAR(this.DirectionArrow.getPosition())},GetRotation:function(){return this.ImageNode.rotation},AddGuiji:function(){if(++this.GuijiCount%this.GuijiFrameGap==0){var e={x:0,y:0};e.x=this.node.position.x-this.GuijiDistance*window.GGameEntry.MathUtil.sin(this.ImageNode.rotation),e.y=this.node.position.y-this.GuijiDistance*window.GGameEntry.MathUtil.cos(this.ImageNode.rotation),window.GGameEntry.AnimationManager.getAnimationAtPosition(this.GuijiPrefabName,this.node.parent,e,this.ImageNode.rotation)}},setHPLine:function(e){for(var t=l.BeginSample("TankBase::setHPLine"),n=0;n<this.CachedLineSprite.length;n++)this.CachedLineSprite[n].opacity=0;for(var i=e/25,a=this.leftHPnode.width,o=a/i,r=o-a/2,s=this.CachedLineSprite.length,c=s<=i-1?s:i-1,u=0;u<c;u++)this.CachedLineSprite[u]&&(this.CachedLineSprite[u].opacity=255,this.CachedLineSprite[u].setPosition(r,0),r+=o);if(i-1>s)for(var d=i-1-this.CachedLineSprite.length,h=0;h<d;h++){var f=new cc.Node;f.addComponent(cc.Sprite).spriteFrame=this.LineSpriteFrame,f.setParent(this.LeftHpNode),f.setPosition(r,0),r+=o,this.CachedLineSprite[this.CachedLineSprite.length]=f}l.EndSample(t)},executeEffect:function(){var e=this.BuffManager.getTopCacheBuffID();if(this.sendTankPositionDirect(this.node.position),e)if(window.GGameEntry.CurGamePlayType===f.GamePlayType.GamePlayType_Single)this.BuffManager.executeCacheBuff(e.buffID);else{var t=this.GetGuid(),n=new p;n.ObjID=t,n.BuffResID=e.buffID,n.EffectIndex=e.effectIndex,n.Send()}},isInvisible:function(){if(this.BuffManager)for(var e=0;e<this.BuffManager.BuffList.length;e++)if(21==this.BuffManager.BuffList[e].buffID)return!0;return!1},CreateFollowNameAndHeadImage:function(e,t,n){var i=l.BeginSample("TankBase::CreateFollowNameAndHeadImage");this.TankName=e,this.HeadImageUrl=t;var a=cc.instantiate(this.TankNamePrefab);this.tankNameFollow=a.getComponent("TankNameFollow"),this.tankNameFollow&&this.tankNameFollow.init(this.GetTankName(),this);var o=cc.instantiate(this.TankHeadImagePrefab),r=o.getComponent("TankHeadImageFollow");r&&r.init(this.HeadImageUrl,this,n),window.GGameEntry.UIManager.HeadImageLayer.addChild(o),window.GGameEntry.UIManager.NameLayer.addChild(a),l.EndSample(i)}}),cc._RF.pop()},{BlockDisappear:"BlockDisappear",BuffBase:"BuffBase",BuffDefine:"BuffDefine",BuffManager:"BuffManager",CmdSkill:"CmdSkill",EntityBase:"EntityBase",EntityDynamic:"EntityDynamic",EntityTypeDefine:"EntityTypeDefine",FlashSkill:"FlashSkill",GlobalCfg:"GlobalCfg",MsgMovePath:"MsgMovePath",MsgPickUpItem:"MsgPickUpItem",MsgUseBuff:"MsgUseBuff",NormalAttackSkill:"NormalAttackSkill",PickBufferSkill:"PickBufferSkill",PlatformUtil:"PlatformUtil",PlayerAnimationCtrl:"PlayerAnimationCtrl",PvPInfo:"PvPInfo",ResCfgDef:"ResCfgDef",ResTableNames:"ResTableNames",TankMisc:"TankMisc",UIManager:"UIManager",Util:"Util"}],TankHeadImageFollow:[function(e,t,n){"use strict";cc._RF.push(t,"2e2fbM7lupJ1osyGSdCrNup","TankHeadImageFollow");var i=e("BaseFollowTank"),a=e("HeadImageUtil");cc.Class({extends:i,properties:{HeadImageSprite:{default:null,type:cc.Sprite}},init:function(e,t,n){this._super(t),e&&(n?a.loadImageFromRes(this.HeadImageSprite,e):a.loadImageFromNetUrl(this.HeadImageSprite,e))}}),cc._RF.pop()},{BaseFollowTank:"BaseFollowTank",HeadImageUtil:"HeadImageUtil"}],TankMisc:[function(e,t,n){"use strict";cc._RF.push(t,"9f096l5jOtDbob2tNRsap8j","TankMisc");var i=cc.Enum({TankGamingState_Normal:1,TankGamingState_Skill_Flash:2});t.exports={TankGamingStateType:i},cc._RF.pop()},{}],TankNameFollow:[function(e,t,n){"use strict";cc._RF.push(t,"36012RO3plHgZx8EAnktV3a","TankNameFollow");e("HeadImageUtil");var i=e("BaseFollowTank");cc.Class({extends:i,properties:{NameLabel:{default:null,type:cc.Label}},init:function(e,t){this._super(t),e&&(this.NameLabel.string=e)}}),cc._RF.pop()},{BaseFollowTank:"BaseFollowTank",HeadImageUtil:"HeadImageUtil"}],TankUI:[function(e,t,n){"use strict";cc._RF.push(t,"78dbeCvnJlL85Wz9jPECl0Y","TankUI");e("BulletIconUI");var i=e("ResCfgDef"),a=e("Util");cc.Class({extends:cc.Component,properties:{PreIconItem:{type:cc.Prefab,default:null},BulletContainNode:{type:cc.Node,default:null},BulletItemArray:{default:[],type:cc.Node},NameLabel:{default:null,type:cc.Label}},Init:function(e,t,n){this.InitTankBullet(e,t),this.NameLabel.string=n},InitTankBullet:function(e,t){var n=a.BeginSample("TankUI::InitTankBullet"),i=this.BulletItemArray.length;if(null!=this.PreIconItem&&null!=this.BulletContainNode&&e>i){for(var o=void 0,r=0;r<e-i;r++)(o=cc.instantiate(this.PreIconItem)).parent=this.BulletContainNode,this.BulletItemArray.push(o.getComponent("BulletIconUI"));for(var s=0;s<this.BulletItemArray.length;s++)s<t?this.BulletItemArray[s].ChangeBulletProgress(1):this.BulletItemArray[s].ChangeBulletProgress(0)}a.EndSample(n)},Reset:function(){for(var e=0;e<this.BulletItemArray.length;e++)this.BulletItemArray[e].ChangeBulletProgress(1)},Destroy:function(){this.BulletItemArray.splice(0,this.BulletItemArray.length),this.BulletItemArray=null},OnShootBullet:function(e){this.BulletItemArray&&e<this.BulletItemArray.length&&this.BulletItemArray[e].ChangeBulletProgress(0)},OnFillingBullet:function(e,t){var n=a.BeginSample("TankUI::OnFillingBullet");if(this.BulletItemArray){if(e>=this.BulletItemArray.length||e<0)return;e<this.BulletItemArray.length-1&&this.BulletItemArray[e+1].ChangeBulletProgress(0),window.GGameEntry.ResManager.GetProgramEffCfg(i.ProgramEffType.ZiDanZhuangTian)===i.PEZiDanZhuangTian.Once?t>=.96?this.BulletItemArray[e].ChangeBulletProgress(1):this.BulletItemArray[e].ChangeBulletProgress(0):window.GGameEntry.ResManager.GetProgramEffCfg(i.ProgramEffType.ZiDanZhuangTian)===i.PEZiDanZhuangTian.Step&&this.BulletItemArray[e].ChangeBulletProgress(t);for(var o=0;o<e;o++)this.BulletItemArray[o].ChangeBulletProgress(1);for(var r=this.BulletItemArray.length-1;r>e;r--)this.BulletItemArray[r].ChangeBulletProgress(0)}a.EndSample(n)},OnFilledBullet:function(e){this.BulletItemArray&&this.BulletItemArray[e-1].ChangeBulletProgress(1)}}),cc._RF.pop()},{BulletIconUI:"BulletIconUI",ResCfgDef:"ResCfgDef",Util:"Util"}],TargetDescriptionUI:[function(e,t,n){"use strict";cc._RF.push(t,"27b54EqjWZP8Y0pVwG6PfI4","TargetDescriptionUI");var i=e("UIManager"),a=e("EntityTypeDefine"),o=e("GlobalCfg");cc.Class({extends:cc.Component,properties:{AttackEnemyNode:{default:null,type:cc.Node},ProtectSelfNode:{default:null,type:cc.Node}},onEnable:function(){this.isShowed=!1,this.AttackEnemyNode.opacity=0,this.ProtectSelfNode.opacity=0,window.GGameEntry.BattleSystem.BattleMapReady&&this.OnMapCreateReady(),window.GGameEntry.NotificationCenter.on("OnBattleMapReady",this.OnMapCreateReady,this),window.GGameEntry.NotificationCenter.on("onGameShowCallback",this.onGameShowCallback,this)},onDisable:function(){window.GGameEntry.NotificationCenter.off("OnBattleMapReady",this.OnMapCreateReady,this),window.GGameEntry.NotificationCenter.off("onGameShowCallback",this.onGameShowCallback,this),this.node.stopAllActions(),this.unscheduleAllCallbacks()},showLabel:function(e){e?(this.AttackEnemyNode.opacity=255,this.AttackEnemyNode.getComponent(cc.Animation).play("difang")):(this.AttackEnemyNode.opacity=0,this.AttackEnemyNode.getComponent(cc.Animation).stop("difang")),this.ProtectSelfNode.opacity=0},OnMapCreateReady:function(){if(!this.isShowed){this.isShowed=!0,window.GGameEntry.BattleSystem.BattleData.IsBattleBeginCountDownEnd=!1;var e=window.GGameEntry.MapManager.GetMapBattleHomePos(a.EntityCampType.RedTeam),t=window.GGameEntry.MapManager.GetMapBattleHomePos(a.EntityCampType.BlueTeam),n=t.exist,r=e.exist,s=!0;if(e=new cc.Vec2(e.x,e.y),t=new cc.Vec2(t.x,t.y),e&&t){var l=void 0,c=void 0;(window.GGameEntry.PlayerManager.Player?window.GGameEntry.PlayerManager.Player.EntityCampType:a.EntityCampType.BlueTeam)===a.EntityCampType.BlueTeam?(l=t,c=e,s=r):(l=e,c=t,s=n);var u=[];if(u[0]=c.x,u[1]=c.y,window.GGameEntry.BattleSystem.IsInvertWorld()){var d=window.GGameEntry.BattleRoot.GetInvertWorldPos(u[0],u[1]);u[0]=d[0],u[1]=d[1]}var h=window.GGameEntry.BattleRoot.ConvertBattlePosToUIPos(u[0],u[1]),f=new cc.Vec2(h[0],h[1]);f=window.GGameEntry.UIManager.ActiveRootNode.convertToNodeSpaceAR(f),this.AttackEnemyNode.setPosition(f),window.GGameEntry.BattleRoot.SetCameraPosition(c),this.showLabel(s);var m=this;this.scheduleOnce(function(){m.AttackEnemyNode.opacity=0,m.ProtectSelfNode.opacity=0,window.GGameEntry.BattleRoot.moveBattleCameraInTime(c,l,1.5)},1.5),this.scheduleOnce(function(){if(window.GGameEntry.CurGamePlayType!==o.GamePlayType.GamePlayType_Single&&window.GGameEntry.BattleSystem.BattleData.CurrentBattleTime>=0)return window.GGameEntry.BattleSystem.BattleData.IsBattleBeginCountDownEnd=!0,window.GGameEntry.BattleSystem.Resume(!0),window.GGameEntry.SoundManager.PlayGameBg(),window.GGameEntry.NotificationCenter.emit("onGameStart"),window.GGameEntry.PlayerManager.Player&&window.GGameEntry.PlayerManager.Player.node&&window.GGameEntry.BattleRoot.SetBattleViewTarget(window.GGameEntry.PlayerManager.Player.node),m.node.stopAllActions(),m.unscheduleAllCallbacks(),void window.GGameEntry.UIManager.HideUI(i.UIType.TargetDescriptionUI);window.GGameEntry.PlayerManager.Player&&window.GGameEntry.PlayerManager.Player.node&&window.GGameEntry.BattleRoot.moveBattleCameraInTime(l,window.GGameEntry.PlayerManager.Player.node.getPosition(),1.5)},4.5),this.scheduleOnce(function(){if(window.GGameEntry.CurGamePlayType!==o.GamePlayType.GamePlayType_Single&&window.GGameEntry.BattleSystem.BattleData.CurrentBattleTime>=0)return window.GGameEntry.BattleSystem.BattleData.IsBattleBeginCountDownEnd=!0,window.GGameEntry.BattleSystem.Resume(!0),window.GGameEntry.SoundManager.PlayGameBg(),window.GGameEntry.NotificationCenter.emit("onGameStart"),window.GGameEntry.PlayerManager.Player&&window.GGameEntry.PlayerManager.Player.node&&window.GGameEntry.BattleRoot.SetBattleViewTarget(window.GGameEntry.PlayerManager.Player.node),m.node.stopAllActions(),m.unscheduleAllCallbacks(),void window.GGameEntry.UIManager.HideUI(i.UIType.TargetDescriptionUI);window.GGameEntry.UIManager.ShowUI(i.UIType.BeginCountDownUI)},3)}this.scheduleOnce(function(){window.GGameEntry.PlayerManager.Player&&window.GGameEntry.PlayerManager.Player.node&&window.GGameEntry.BattleRoot.SetBattleViewTarget(window.GGameEntry.PlayerManager.Player.node),window.GGameEntry.UIManager.HideUI(i.UIType.TargetDescriptionUI)},6)}},onGameShowCallback:function(){if(window.GGameEntry.CurGamePlayType!==o.GamePlayType.GamePlayType_Single)return this.node.stopAllActions(),window.GGameEntry.BattleRoot.stopCameraAction(),this.unscheduleAllCallbacks(),window.GGameEntry.BattleSystem.BattleData.IsBattleBeginCountDownEnd=!0,window.GGameEntry.BattleSystem.Resume(!0),window.GGameEntry.SoundManager.PlayGameBg(),window.GGameEntry.NotificationCenter.emit("onGameStart"),window.GGameEntry.PlayerManager.Player&&window.GGameEntry.PlayerManager.Player.node&&window.GGameEntry.BattleRoot.SetBattleViewTarget(window.GGameEntry.PlayerManager.Player.node),void window.GGameEntry.UIManager.HideUI(i.UIType.TargetDescriptionUI)}}),cc._RF.pop()},{EntityTypeDefine:"EntityTypeDefine",GlobalCfg:"GlobalCfg",UIManager:"UIManager"}],TaskStatus:[function(e,t,n){"use strict";cc._RF.push(t,"4a3begFbAJMiIId/7D+Fm/n","TaskStatus");var i=cc.Enum({Inactive:0,Failure:1,Success:2,Running:3});t.exports=i,cc._RF.pop()},{}],TestCount:[function(e,t,n){"use strict";cc._RF.push(t,"53811pdLJJDK7KFD3ZWEOEz","TestCount");var i=e("UIManager");cc.Class({extends:cc.Component,properties:{curNode:{default:null,type:cc.Node},scrollView:{default:null,type:cc.ScrollView},template:{default:null,type:cc.Node}},onLoad:function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},onKeyDown:function(e){switch(e.keyCode){case cc.KEY.c:console.log("Press C key"),this.priChildRow(this.curNode,"");break;case cc.KEY.v:console.log("Press v key"),window.GGameEntry.UIManager.HideUI(i.UIType.BattleUI);break;case cc.KEY.b:console.log("Press b key"),window.GGameEntry.UIManager.ShowUI(i.UIType.BattleUI)}},priChildRow:function(e,t){for(var n=0;n<e.childrenCount;n++){var i=e.children[n];cc.log(t+i.name+"\t"+i.childrenCount),i.childrenCount>0&&this.priChildRow(i,t+"-")}},priChild:function(e,t){for(var n=0;n<e.childrenCount;n++){var i=e.children[n],a={};a.childName=i.name,a.childNum=i.childrenCount,a.child=[],i.childrenCount>0&&this.priChild(i,a.child),t.push(a)}},priChildStr:function(e){for(var t="[",n=0;n<e.childrenCount;n++){var i=e.children[n];t+='{"childName":"'+i.name+" "+i.childrenCount+'"',i.childrenCount>0&&(t+=',"child":'+this.priChildStr(i)),t+="}",n<e.childrenCount-1&&(t+=",")}return t+="]"},priComm:function(e,t){var n=e.getComponent(cc.Sprite);return n?n.spriteFrame:""},priChild2:function(){this.clear();for(var e=this.curNode.childrenCount,t=0;t<e;t++){var n=this.curNode.children[t],i=cc.instantiate(this.template);i.parent=this.scrollView.content,i.active=!0,i.getComponentInChildren(cc.Label).string=n.name+":"+n.childrenCount;var a=i.getComponent(cc.Button);a.tgt=n,a.node.on("click",function(e){cc.log(e.currentTarget),this.curNode=e.currentTarget.tgt,this.priChild2()},this)}},back:function(){this.curNode.parent&&(this.curNode=this.curNode.parent),this.priChild2()},clear:function(){this.scrollView.content.removeAllChildren()}}),cc._RF.pop()},{UIManager:"UIManager"}],TimeSystem:[function(e,t,n){"use strict";cc._RF.push(t,"e18acJvmuVNX4Y37M7Uf5m3","TimeSystem");var i=e("GlobalCfg");cc.Class({properties:{SvrTime:{default:0,serializable:!1,visible:!1},Svr2ClientOffset:{default:0,serializable:!1,visible:!1}},Init:function(){this.Svr2ClientOffset=0},SyncSvrTime:function(e){this.SvrTime=e,this.Svr2ClientOffset=e-Date.now()},Now:function(){var e=Date.now();return window.GGameEntry.CurGamePlayType===i.GamePlayType.GamePlayType_Network&&(e+=this.Svr2ClientOffset),e}}),cc._RF.pop()},{GlobalCfg:"GlobalCfg"}],TipsMsgBox:[function(e,t,n){"use strict";cc._RF.push(t,"b1310KCn4RN24/Dl0Pp2/4z","TipsMsgBox"),cc.Class({extends:cc.Component,properties:{boxRoot:{default:null,type:cc.Node},contentLabel:{default:null,type:cc.RichText},callback:null},onLoad:function(){this.Hide()},Show:function(e,t){this.boxRoot.active=!0,this.contentLabel.string=e,this.callback=t},Hide:function(){this.boxRoot.active=!1},IsActive:function(){return 1==this.boxRoot.active},btnClicked:function(){this.Hide(),this.callback&&this.callback()}}),cc._RF.pop()},{}],UIManager:[function(e,t,n){"use strict";cc._RF.push(t,"83528G0Ng5Ngb+GIFR6KKx/","UIManager");var i=cc.Enum({None:0,BattleUI:1,PauseUI:2,WinUI:3,LoseUI:4,LogoUI:5,RankUI:6,JoystickSettingUI:8,JoystickTest:9,PlayerDieUI:10,SettlementUI:11,BeginCountDownUI:12,GobalSettingUI:13,MapDebugUI:14,PingJuUI:16,DirectionUI:17,ReBornMaskUI:18,JoyStickUI:19,ItemArriveUI:20,FPSUI:21,TargetDescriptionUI:22,BattleLoadingUI:23,EmoticonUI:24,ServerUI:100,PVPMakeTeamUI:101,PVPExitTeamUI:102,PVPChangTeamUI:103,AISettingUI:104,GuideUI:105,ShopUI:106,RecordUI:107,JKTS48UI:108,NetWorkQueue:109,AutoJoinCountDownUI:110,ActivityUI:111,RichMsgBoxUI:199,CommonMsgBoxUI:200,GMPanel:201,ShareUI:202}),a=cc.Enum({Default:0,Animation:100,Top:1e3}),o=[{UIType:i.BattleUI,UIPath:"./Prefabs/UI/BattleUI"},{UIType:i.PauseUI,UIPath:"./Prefabs/UI/PauseUI"},{UIType:i.WinUI,UIPath:"./Prefabs/UI/WinUI"},{UIType:i.LoseUI,UIPath:"./Prefabs/UI/LoseUI"},{UIType:i.LogoUI,UIPath:"./Prefabs/UI/LogoUI"},{UIType:i.RankUI,UIPath:"./Prefabs/UI/RankUI"},{UIType:i.JoystickSettingUI,UIPath:"./Prefabs/UI/JoystickSettingUI"},{UIType:i.JoystickTest,UIPath:"./Prefabs/UI/JoystickTestUI"},{UIType:i.PlayerDieUI,UIPath:"./Prefabs/UI/PlayerDieUI"},{UIType:i.SettlementUI,UIPath:"./Prefabs/UI/SettlementUI"},{UIType:i.BeginCountDownUI,UIPath:"./Prefabs/UI/BeginCountDownUI"},{UIType:i.GobalSettingUI,UIPath:"./Prefabs/UI/GobalSettingUI"},{UIType:i.MapDebugUI,UIPath:"./Prefabs/UI/MapDebugUI"},{UIType:i.PingJuUI,UIPath:"./Prefabs/UI/PingJuUI"},{UIType:i.DirectionUI,UIPath:"./Prefabs/UI/DirectionUI"},{UIType:i.ReBornMaskUI,UIPath:"./Prefabs/UI/ReBornMaskUI"},{UIType:i.JoyStickUI,UIPath:"./Prefabs/UI/JoyStickUI"},{UIType:i.ItemArriveUI,UIPath:"./Prefabs/UI/ItemArriveUI"},{UIType:i.FPSUI,UIPath:"./Prefabs/UI/FPSUI"},{UIType:i.ServerUI,UIPath:"./Prefabs/UI/ServerUI"},{UIType:i.PVPMakeTeamUI,UIPath:"./Prefabs/UI/PVPMakeTeamUI"},{UIType:i.PVPExitTeamUI,UIPath:"./Prefabs/UI/PVPExitTeamUI"},{UIType:i.PVPChangTeamUI,UIPath:"./Prefabs/UI/PVPChangTeamUI"},{UIType:i.TargetDescriptionUI,UIPath:"./Prefabs/UI/TargetDescriptionUI"},{UIType:i.BattleLoadingUI,UIPath:"./Prefabs/UI/BattleLoadingUI"},{UIType:i.EmoticonUI,UIPath:"./Prefabs/UI/EmoticonUI"},{UIType:i.AISettingUI,UIPath:"./Prefabs/UI/AISettingUI"},{UIType:i.CommonMsgBoxUI,UIPath:"./Prefabs/UI/CommonMsgBoxUI"},{UIType:i.GuideUI,UIPath:"./Prefabs/UI/GuideUI"},{UIType:i.ShopUI,UIPath:"./Prefabs/UI/ShopUI"},{UIType:i.RecordUI,UIPath:"./Prefabs/UI/RecordUI"},{UIType:i.RichMsgBoxUI,UIPath:"./Prefabs/UI/RichMsgBoxUI"},{UIType:i.NetWorkQueue,UIPath:"./Prefabs/UI/NetWorkQueue"},{UIType:i.JKTS48UI,UIPath:"./Prefabs/UI/JKTS48UI"},{UIType:i.AutoJoinCountDownUI,UIPath:"./Prefabs/UI/AutoJoinCountDownUI"},{UIType:i.ActivityUI,UIPath:"./Prefabs/UI/ActivityUI"},{UIType:i.GMPanel,UIPath:"./Prefabs/GM/GMPanel"},{UIType:i.ShareUI,UIPath:"./Prefabs/UI/shareUI"}];cc.Class({extends:cc.Component,properties:{ActiveRootNode:{default:null,type:cc.Node},DeActiveRootNode:{default:null,type:cc.Node},EmoctionLayer:{default:null,type:cc.Node},HeadImageLayer:{default:null,type:cc.Node},NameLayer:{default:null,type:cc.Node}},Init:function(t){if(this.gameEntry=t,this.ActiveUIList=[],this.DeactiveUIList=[],this.LoadingUIList=[],!this.gameEntry.JoystickTest&&!this.gameEntry.JumpToBattleField){var n=e("loginServerMgr"),o=e("weixininterface"),r=e("PlatformUtil"),s=n.onGetInviteInfo(),l=o.isViewRankInfo(s);!r.IsWeichatGame()||o.isInvitedToJoinRoom()||l?this.ShowUI(i.LogoUI,a.Top):this.ShowUI(i.JKTS48UI,a.Top)}this.gameEntry.ShowFPS&&this.ShowUI(i.FPSUI,a.Top+1)},ShowUI:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.Default,n=0;n<this.LoadingUIList.length;n++)if(this.LoadingUIList[n]===e)return;for(n=0;n<this.ActiveUIList.length;n++)if(this.ActiveUIList[n].UIType===e)return;for(var i=null,n=0;n<this.DeactiveUIList.length;n++)if(this.DeactiveUIList[n].UIType===e){i=this.DeactiveUIList[n].Node,this.DeactiveUIList.splice(n,1);break}if(null!=i)return this.ActiveUIList[this.ActiveUIList.length]={UIType:e,Node:i},i.active=!0,void(i.parent=this.ActiveRootNode);var o=this.GetUIDef(e);if(null!==o){this.LoadingUIList[this.LoadingUIList.length]=e;var r=this;cc.loader.loadRes(o.UIPath,cc.Prefab,function(n,i){if(n)cc.error(n);else{for(var a=0;a<r.LoadingUIList.length;a++)if(r.LoadingUIList[a]===e){r.LoadingUIList.splice(a,1);break}var o=cc.instantiate(i);cc.loader.release(i),r.ActiveRootNode.addChild(o,t),o.active=!0,r.ActiveUIList[r.ActiveUIList.length]={UIType:e,Node:o}}})}else cc.error("no uidef is found:%d",e)},HideUI:function(e){if(e!==i.None){for(var t=null,n=0;n<this.ActiveUIList.length;n++)if(this.ActiveUIList[n].UIType===e){t=this.ActiveUIList[n].Node,this.ActiveUIList.splice(n,1);break}null!==t&&(this.DeactiveUIList[this.DeactiveUIList.length]={UIType:e,Node:t},t.active=!1,t.parent=this.DeActiveRootNode)}},GetUIDef:function(e){for(var t=0;t<o.length;t++)if(o[t].UIType==e)return o[t];return null},GetActiveUI:function(e){for(var t=0;t<this.ActiveUIList.length;t++)if(this.ActiveUIList[t].UIType===e)return this.ActiveUIList[t].Node;return null},PreLoad:function(){this.ShowUI(i.JoyStickUI),this.PreLoadBattleUI(i.BattleUI),this.PreLoadBattleUI(i.ItemArriveUI,!0)},PreLoadBattleUI:function(e,t){for(a=0;a<this.LoadingUIList.length;a++)if(this.LoadingUIList[a]===e)return;for(a=0;a<this.ActiveUIList.length;a++)if(this.ActiveUIList[a].UIType===e)return;for(var n=null,a=0;a<this.DeactiveUIList.length;a++)if(this.DeactiveUIList[a].UIType===e){if(t)return;n=this.DeactiveUIList[a].Node,this.DeactiveUIList.splice(a,1);break}if(!t&&null!=n)return this.ActiveUIList[this.ActiveUIList.length]={UIType:e,Node:n},n.active=!0,n.parent=this.ActiveRootNode,void(e==i.BattleUI&&(window.GGameEntry.BattleSystem.BattleUIReady=!0));var o=this.GetUIDef(e);if(o){var r=this;cc.loader.loadRes(o.UIPath,cc.Prefab,function(n,a){if(n)cc.error(n);else{var o=cc.instantiate(a);cc.loader.release(a),o.parent=r.DeActiveRootNode,o.active=!1,r.DeactiveUIList[r.DeactiveUIList.length]={UIType:e,Node:o},t||(r.ShowUI(e),e==i.BattleUI&&(window.GGameEntry.BattleSystem.BattleUIReady=!0))}})}},HideAllActiveUI:function(){for(var e=[],t=this.ActiveUIList.length-1;t>=0;t--)this.ActiveUIList[t].UIType!==i.FPSUI&&e.push(this.ActiveUIList[t].UIType);for(var n=0;n<e.length;++n)this.HideUI(e[n])},ShowMsgBox:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e("loginServerMgr").onPushErrMsg(t,n),this.ShowUI(i.CommonMsgBoxUI,a.Top+100)},ReturnLogoUI:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;this.ShowMsgBox(e,t)}}),t.exports={UIType:i,UIOrder:a},cc._RF.pop()},{PlatformUtil:"PlatformUtil",loginServerMgr:"loginServerMgr",weixininterface:"weixininterface"}],UnitTestDemo:[function(e,t,n){"use strict";cc._RF.push(t,"d09cbDO62xCq4/4Ph0B09na","UnitTestDemo");e("CmdMgr");var i=e("CmdSkill"),a=e("SkillDefine"),o=e("Util");cc.Class({extends:cc.Component,properties:{},editor:{executeInEditMode:!0},onLoad:function(){this.stepCount=0},update:function(e){},DoTest:function(){this.DoCmdTest(),this.DoVersionTest(),this.DoResTableMgrTest(),this.DoNetworkTest()},DoArrayTest:function(){for(var e=[],t=0;t<10;++t)e.push(t);e[e.length-1];e.splice(e.length-1,1);for(t=0;t<e.length;++t){var n=e[t];console.log(n)}},DoCmdTest:function(){var e=a.SkillType.SkillType_NormalAttack,t=new i;t.Init(e,1,1),window.GGameEntry.GCmdMgr&&window.GGameEntry.GCmdMgr.AddCmd(t)},DoVersionTest:function(){var e=o.GetBuildVersionNum(),t=o.GetBuildDataStr();console.log("buildVersionNum: "+e),console.log("buildDataStr: "+t)},DoJsonTest:function(){},DoResTableMgrTest:function(){var t=window.GGameEntry.ResTableMgr.GetLoadProgress();if(t.successcnt==t.totalcnt){var n=e("ResTableNames");e("keywords");window.GGameEntry.ResTableMgr.GetConfigByID(n.star_item_drop_cs,1),window.GGameEntry.ResTableMgr.GetTableByName(n.star_item_drop_cs)}},DoTestMsg:function(){if(window.GGameEntry.GBattleNetwork.IsConnected()){var t=e("NetworkProto"),n=(e("star_comm"),e("star_cs")),i=t.GetRequestByID(n.CS_CMD_TYPE.CS_SUB_BATTLE_MOVE_STOP);i.P[0]=123456,i.P[1]=1,i.P[2]=0,i.P[3]=10,i.P[4]=211,i.P[5]=212,t.SendBattleSvrRequest(123456,i);var a=t.GetRequestByID(n.CS_CMD_TYPE.CS_CMD_HEARTBEAT);a.ClientTime=9900099,t.SendGameSvrRequest(123456,a)}},DoNetworkTest:function(){var e=window.GGameEntry.GBattleNetwork;window.GGameEntry.GGameNetwork;e.Connect("ws://test.bt.qq.com:10001?account_value=xxx1&account_type=xxx&appid=xxx&token=xxx")},DoTextStringEncode:function(){for(var e="abcDEF测试中文123".length,t=0;t<e;++t){var n="abcDEF测试中文123"[t],i="abcDEF测试中文123".charCodeAt(t);console.log("字符: "+n+" 编码值： "+i)}}}),cc._RF.pop()},{CmdMgr:"CmdMgr",CmdSkill:"CmdSkill",NetworkProto:"NetworkProto",ResTableNames:"ResTableNames",SkillDefine:"SkillDefine",Util:"Util",keywords:"keywords",star_comm:"star_comm",star_cs:"star_cs"}],UpdateUtils:[function(e,t,n){"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}cc._RF.push(t,"4084d4wCUBMnIOg/RdHbHCE","UpdateUtils");var a,o,r,s,l=e("Util"),c=e("PlatformUtil"),u=e("JsonUtils"),d="https://cdn.bt.qq.com/Config/Test/",h="https://pic.feiji.qq.com/config/bigtank/test/",f=0,m=0,y={},p=2,g=[];Array.prototype.remove=function(e){for(var t=0;t<this.length;t++)if(this[t]==e){this.splice(t,1);break}},cc.Class({extends:cc.Component,Init:function(){s=this},ReadConfig:function(e){if(o=e,c.IsWeichatGame()&&!0===GameSettingConfig.Public){var t=l.GetBuildVersionNum().toString();d="https://cdn.bt.qq.com/Config/Release/"+t+"/",h="https://pic.feiji.qq.com/config/bigtank/Release/"+t+"/"}console.log("CDN_RES_URL: "+d),console.log("BAK_CDN_RES_URL: "+h),c.IsWeichatGame()?(p=2,g=[],s.readConfigNet(d+"config.json")):s.readConfigLocal()},readConfigNet:function(e){var t=e;console.log("readConfigNet:"+t),wx.downloadFile({url:t,success:function(e){console.log("downloadCdnConfig downloadFile success"),wx.getFileSystemManager().readFile({filePath:e.tempFilePath,encoding:"utf8",success:function(e){var t=e.data,n=u.SafeParse(t);console.log(n),s.onReadNetConfig(n)},fail:function(e){console.log("读取网络配置文件失败"+t+" "+e.errMsg),s.onReadNetConfig()}})},fail:function(e){console.log("downloadCdnConfig downloadFile failure"),s.onReadNetConfig()}})},onReadNetConfig:function(e){g[g.length]=e,2===p?1===g.length?s.readConfigNet(h+"config.json"):g.length>=p&&(g[0]?g[1]?(console.log("CDN Config resVersionCode0:"+g[0].resVersionCode+";resVersionCode1:"+g[1].resVersionCode),g[0].resVersionCode>=g[1].resVersionCode?(cc.ServerConfig=g[0],o(g[0])):(cc.ServerConfig=g[1],o(g[1]))):(console.log("CDN Config 0"),cc.ServerConfig=g[0],o(g[0])):g[1]?(console.log("CDN Config 1"),cc.ServerConfig=g[1],o(g[1])):(console.log("CDN Config read failure"),o())):(console.log("CDN Config 0 CONFIG_NUM:"+p),cc.ServerConfig=g[0],o(g[0]))},readConfigLocal:function(){var e=cc.url.raw("resources/Config/config.json");console.log("read local config !"),cc.loader.load(e,function(t,n){if(t)console.log("读取本地配置文件失败"+e+" Err:"+t),o();else{var i=n;console.log("=====> set local serverConfig"),console.log(i),cc.ServerConfig=i,o(i)}})},UnlinkAllUsrFile:function(e){a=e;var t=wx.env.USER_DATA_PATH+"/",n=wx.getFileSystemManager();n.readdir({dirPath:t,success:function(e){var i=e.files;if((f=i.length)<=0)a();else for(var o=0;o<i.length;o++)!function(){var e=i[o];n.unlink({filePath:t+e,success:function(t){console.log("unlink success: "+e),s.onUnlink()},fail:function(t){console.error("unlink failure: "+e),s.onUnlink()}})}()}})},onUnlink:function(){--f<=0&&a()},DownloadAndSave:function(e,t){var n=e,i=t;console.log("StartDownLoad ："+n),wx.downloadFile({url:d+n,success:function(e){console.log("downloadFile success temp file: "+e.tempFilePath);var t=wx.env.USER_DATA_PATH+"/"+n;wx.saveFile({tempFilePath:e.tempFilePath,filePath:t,success:function(e){console.log("saveFile success: "+e.savedFilePath),i(n,e.savedFilePath)},fail:function(e){console.error("saveFile failure: "+n),i(n)}})},fail:function(e){console.error("downloadFile failure: "+n),i(n)}})},DownloadAndUnZip:function(e,t){var n=e,i=t;console.log("StartDownLoad ："+n),0!=n.endsWith(".zip")?wx.downloadFile({url:d+n,success:function(e){console.log("downloadFile success temp file: "+e.tempFilePath);var t=wx.env.USER_DATA_PATH+"/";wx.getFileSystemManager().unzip({zipFilePath:e.tempFilePath,targetPath:t,success:function(e){console.log("解压文件成功"),i(n,!0)},fail:function(e){console.log("解压文件失败"),i(n,!1)}})},fail:function(e){console.error("downloadFile failure: "+n),i(n,!1)}}):i(n,!1)},getUsrFileMd5s:function(e){r=e,y={};var t=wx.env.USER_DATA_PATH+"/",n=wx.getFileSystemManager();n.readdir({dirPath:t,success:function(e){var i=e.files;if((m=i.length)<=0)r(y);else for(var a=0;a<i.length;a++)!function(){var e=i[a];n.getFileInfo({filePath:t+e,success:function(t){var n=t.size,i=t.digest;console.log("getFileInfo success: "+e+"; digest:"+i+" ; size:"+n),s.onGetFileInfo(e,n,i)},fail:function(t){console.error("getFileInfo failure: "+e),s.onGetFileInfo(e,0,"")}})}()}})},onGetFileInfo:function(e,t,n){m--;var a=i({digest:n,size:t},"size",t);y[e]=a,m<=0&&r(y)},GetAllNewFiles:function(e,t){var n=t,i=e.checkType,a=e.resMd5s,o=e.resFiles;if(!1===GameSettingConfig.Public)return cc.log("开发环境强制下载"),void n(o);0!==i?s.getUsrFileMd5s(function(e){for(var t=0;t<a.length;t++){var r=a[t],s=r.resFile,l=e[s];if(!l)return console.log("本地文件不存在！ fileName："+s),void n(o);if(1===i){if(r.digest!==l.digest)return console.log("本地文件版本错误！ fileName："+s),void n(o)}else if(2===i&&r.size!==l.size)return console.log("本地文件版本错误！ fileName："+s),void n(o)}console.log("本地文件跟服务器一致，不用下载！"),n([])}):n(o)},CheckAllLocalFile:function(e){var t=cc.ServerConfig,n=e,i=t.checkType,a=t.resMd5s;t.resFiles;if(!1===GameSettingConfig.Public)return cc.log("开发环境不检查资源"),void n(!0);0!==i?s.getUsrFileMd5s(function(e){for(var t=0;t<a.length;t++){var o=a[t],r=o.resFile,s=e[r];if(!s)return console.log("本地文件不存在！ fileName："+r),void n(!1);if(1===i&&o.digest!==s.digest||2===i&&o.size!==s.size)return console.log("本地文件版本错误！ fileName："+r),console.log(o),console.log(s),void n(!1)}console.log("本地文件跟服务器一致，更新成功！"),n(!0)}):n(!0)},SaveAllFileInfo:function(){var e=cc.ServerConfig.resMd5s,t=wx.env.USER_DATA_PATH+"/";cc.downLoadFiles={};for(var n=0;n<e.length;n++){var i=e[n].resFile;cc.downLoadFiles[i]=t+i}console.log(cc.downLoadFiles)}}),cc._RF.pop()},{JsonUtils:"JsonUtils",PlatformUtil:"PlatformUtil",Util:"Util"}],Util:[function(e,t,n){"use strict";function i(e,t,n){t=t||window.GGameEntry.node,e=e||1;for(var a=0;a<t.childrenCount;a++)n&&!t.children[a].active||(e=i(++e,t.children[a],n));return e}cc._RF.push(t,"98e332dR0tC6KhHtayhXdRB","Util");var a=e("MapCfg"),o=e("Version"),r=e("ServerLog"),s=e("PlatformUtil"),l=a.MapItemType,c={0:"48",1:"49",2:"50",3:"51",4:"52",5:"53",6:"54",7:"55",8:"56",9:"57",":":"58",X:"88"},u={48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",58:":",88:"X"},d={};d.frameCount=0,d.BeginTime=0,d.sampleTable={};var h=0,f=(new Date).getTime(),m={};t.exports={GetTimeFormatStr:function(e){var t=Math.floor(e/60).toString(),n=e%60,i="";return t<10&&(i+="0"),i+=t.toString()+":",n<10&&(i+="0"),i+=n.toString()},FlipLeftOrRight:function(e,t){var n=null;if(-1===t)n=cc.flipX(!0);else{if(1!==t)return void cc.error("Unknown direction");n=cc.flipX(!1)}e.runAction(n)},GetMathResult2:function(e,t,n,i){var a=Math.floor((n-e*i)/(t-e)),o=i-a;if(o>=0&&a>=0&&e*o+t*a===n)return[o,a];for(;a<=i;a++)if((o=Math.floor((n-t*a)/e))>=0&&a>=0&&e*o+t*a===n&&o+a<=i)return[o,a];return null},GetMathResult3:function(e,t,n,i,a){for(var o=0,r=0,s=Math.min(Math.floor((i-t*a)/n),a);s<=a;s++)for(r=Math.floor((i-n*s-e*a+e*s)/(t-e));r<=a;r++)if((o=Math.floor((i-t*r-n*s)/e))>=0&&r>=0&&s>=0&&e*o+t*r+n*s===i&&o+r+s<=a)return[o,r,s];return null},GetRandomArbitrary:function(e,t){return Math.random()*(t-e)+e},GetRandomInt:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},MapDataToAstarGraphValue:function(e){return(e=Math.floor(e/10))===l.None?1:e===l.Block?0:e===l.MonsterHouse?0:e===l.Teleporter?1:e===l.Item?1:e===l.PlayerBorn?1:0},GetGridPos:function(e,t,n,i){var a=1e6*e+1e4*t+100*n+i;if(m[a])return m[a];var o=100*e+t+1e6*n+1e4*i;if(m[o]){var r=[];return(r=m[o].slice()).reverse(),r}var s=[];if(e===n&&t===i)return s;if(1===Math.floor((e-n)/(t-i))){if(Math.abs(e-n)>1){for(var l=e>n?-1:1,c=Math.abs(e-n),u=1;u<c;u++){var d=u*l;u!==n&&(s[s.length]=[e+d,t+d]),s[s.length]=[e+d-l,t+d],s[s.length]=[e+d,t+d-l]}var h=t<i;for(u=0;u<s.length-1;u++){for(var f=u,y=u+1;y<s.length;y++)(s[y][0]<s[f][0]||s[y][0]===s[f][0]&&(!h&&s[y][1]<s[f][1]||h&&s[y][1]>s[f][1]))&&(f=y);f!==u&&(w=s[u],s[u]=s[f],s[f]=w)}}}else if(e===n)for(var p=Math.max(t,i),u=(G=Math.min(t,i))+1;u<p;u++)s[s.length]=[e,u];else if(t===i)for(var g=Math.max(e,n),u=(C=Math.min(e,n))+1;u<g;u++)s[s.length]=[u,t];else{for(var g=Math.max(e,n),C=Math.min(e,n),p=Math.max(t,i),G=Math.min(t,i),S=[],E=C+.5;E<g;E+=1)(T=(E-e)*(i-t)/(n-e)+t)<p&&T>G&&(S[S.length]=[E,T]);for(var T=G+.5;T<p;T+=1)(E=(T-t)*(n-e)/(i-t)+e)<g&&E>C&&(S[S.length]=[E,T]);for(u=0;u<S.length-1;u++){for(var f=u,y=u+1;y<S.length;y++)S[y][0]<S[f][0]&&(f=y);if(f!==u){var w=S[u];S[u]=S[f],S[f]=w}}for(u=S.length-1;u>0;u--)S[u][0]===S[u-1][0]&&S[u][1]===S[u-1][1]&&S.splice(u,1);for(u=1;u<S.length;u++){var M=[(S[u-1][0]+S[u][0])/2,(S[u-1][1]+S[u][1])/2];s[s.length]=[Math.round(M[0]),Math.round(M[1])]}}return(e===n?t<i:e<n)||s.reverse(),m[a]=s,s},ToDirectionValue:function(e){return e>0&&Math.abs(e-1)<.1?1:e<0&&Math.abs(e+1)<.1?-1:0},CheckWXGame:function(){return"function"==typeof cc._isWechatGame?cc._isWechatGame():window.wx},GetBuildVersionNum:function(){return o.BuildVersionNum},GetBuildDataStr:function(){return o.BuildDataStr},ColliderContainPoint:function(e,t){var n={x:e.node.getPosition().x+e._offset.x,y:e.node.getPosition().y+e._offset.y},i=Math.abs(n.x-t.x),a=Math.abs(n.y-t.y);return i<e._size.width/2&&a<e._size.height/2},GetDistance:function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},GetColliderWorld:function(e){var t=e.offset,n=e.world,i=n.aabb,a=n.transform=e.node.getNodeToWorldTransformAR(),o=n.preAabb;o.x=i.x,o.y=i.y,o.width=i.width,o.height=i.height;var r=e.size,s=cc.rect();s.x=t.x-r.width/2,s.y=t.y-r.height/2,s.width=r.width,s.height=r.height;var l=n.points,c=l[0],u=l[1],d=l[2],h=l[3];cc.obbApplyAffineTransform(s,a,c,u,d,h);var f=Math.min(c.x,u.x,d.x,h.x),m=Math.min(c.y,u.y,d.y,h.y),y=Math.max(c.x,u.x,d.x,h.x),p=Math.max(c.y,u.y,d.y,h.y);return i.x=f,i.y=m,i.width=y-f,i.height=p-m,n},StrechSpriteFrameUV:function(e,t){var n=e.getRect();n.x=n.x+t,n.y=n.y+t,n.width=n.width-2*t,n.height=n.height-2*t,e.setRect(n)},TableStr2Num:function(e){return e=e.trim(),parseInt(e)},BeginSample:function(e){if(null!==window.GGameEntry.GlobalCfg&&window.GGameEntry.GlobalCfg.ProfileEnable){var t=d.sampleTable[e];if(void 0==t||null===t){var n={};n.count=0,n.costTotalTime=0,n.costMaxTime=0,n.curBeginTime=0,d.sampleTable[e]=n,t=d.sampleTable[e]}t.curBeginTime=(new Date).getTime()}return e},EndSample:function(e){if(null!==window.GGameEntry.GlobalCfg&&window.GGameEntry.GlobalCfg.ProfileEnable){var t=d.sampleTable[e];if(void 0==t||null===t)return;var n=t.curBeginTime,i=(new Date).getTime()-n;t.count=t.count+1,t.costTotalTime=t.costTotalTime+i,i>t.costMaxTime&&(t.costMaxTime=i)}},RecordSampleFrame:function(){void 0!==window.GGameEntry.GlobalCfg&&window.GGameEntry.GlobalCfg.ProfileEnable&&(d.frameCount=d.frameCount+1,0===d.BeginTime&&(d.BeginTime=(new Date).getTime()))},DumpSample:function(){if(null!==window.GGameEntry.GlobalCfg&&window.GGameEntry.GlobalCfg.ProfileEnable){var e=(new Date).getTime()-d.BeginTime,t=i(window.GGameEntry.node,0,!0),n=i(),a="Profile<"+f+"-"+h+">",o=a+" "+(new Date).toUTCString()+" frame count: "+d.frameCount+"  costTotalTime: "+e;console.error(o),r.pushLog(o);var l="",c=s.getDeviceSystemAllInfo();null!==c&&(l=c.model);var u=a+" All Node："+n+" ActiveNode: "+t+" CurResType: "+window.GGameEntry.ResManager.CurResType+" model: "+l;console.error(u),r.pushLog(u);for(var m in d.sampleTable){var y=d.sampleTable[m];if(y.count>0){var p=Math.floor(y.costTotalTime/y.count),g=a+" sampleName : "+m+" costTotalTime: "+y.costTotalTime+" count: "+y.count+" costMaxTime: "+y.costMaxTime+" avgCostTime: "+p;console.error(g),r.pushLog(g)}}}},ClearSample:function(){null!==window.GGameEntry.GlobalCfg&&window.GGameEntry.GlobalCfg.ProfileEnable&&((d={}).frameCount=0,d.BeginTime=0,d.sampleTable={},h+=1)},GetTankGridWidth:function(){return Math.ceil(a.MapGlobalCfg.TankSize[0])},GetTankGridHeight:function(){return Math.ceil(a.MapGlobalCfg.TankSize[1])},Char2Code:function(e){return c[e]},Code2Char:function(e){return u[char]},GetMainPlayerUIN:function(){return window.GGameEntry.PlayerManager&&window.GGameEntry.PlayerManager.Player?window.GGameEntry.PlayerManager.Player.Guid:0},AssertCheck:function(e,t){},GetFullName:function(e){for(var t="";e;)t=""===t?e.name:e.name+"/"+t,e=e.parent;return t},GetAllNodeCount:i,FliterEmojString:function(e){var t=/[\uD83C|\uD83D|\uD83E][\uDC00-\uDFFF][\u200D|\uFE0F]|[\uD83C|\uD83D|\uD83E][\uDC00-\uDFFF]|[0-9|*|#]\uFE0F\u20E3|[0-9|#]\u20E3|[\u203C-\u3299]\uFE0F\u200D|[\u203C-\u3299]\uFE0F|[\u2122-\u2B55]|\u303D|[\A9|\AE]\u3030|\uA9|\uAE|\u3030/gi;return e.replace(t,"")}},cc._RF.pop()},{MapCfg:"MapCfg",PlatformUtil:"PlatformUtil",ServerLog:"ServerLog",Version:"Version"}],Version:[function(e,t,n){"use strict";cc._RF.push(t,"c14a1p0vj1GSrBpciI3LY8o","Version");t.exports={BuildVersionNum:830,BuildDataStr:"201712281622"},cc._RF.pop()},{}],WinUI:[function(e,t,n){"use strict";cc._RF.push(t,"0cca2s5AK5H/6bwvlpi6Q3S","WinUI");var i=e("UIManager");e("Util"),e("BattleDef");cc.Class({extends:cc.Component,properties:{Ani:{default:null,type:cc.Animation,serializable:!0},Value:{default:null,type:cc.Label}},onEnable:function(){this.Ani.play(),window.GGameEntry.UIManager.HideUI(i.UIType.PauseUI),window.GGameEntry.UIManager.HideUI(i.UIType.JoystickSettingUI),this.Ani.on("finished",this.animationFinish,this),window.GGameEntry.SoundManager.PlayWinMusic(),this.Value.string=window.GGameEntry.BattleSystem.BattleData.WinReason},animationFinish:function(){window.GGameEntry.UIManager.HideUI(i.UIType.WinUI),window.GGameEntry.UIManager.HideUI(i.UIType.LoseUI),window.GGameEntry.UIManager.HideUI(i.UIType.EmoticonUI),window.GGameEntry.UIManager.ShowUI(i.UIType.SettlementUI)},onDisable:function(){this.Ani.off("finished",this.animationFinish,this)}}),cc._RF.pop()},{BattleDef:"BattleDef",UIManager:"UIManager",Util:"Util"}],base64:[function(e,t,n){(function(n){"use strict";cc._RF.push(t,"fe5f348+tdER6ZUQxEx7rho","base64"),function(n){var i,a=n.Base64;if(void 0!==t&&t.exports)try{i=e("buffer").Buffer}catch(e){}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=function(e){for(var t={},n=0,i=e.length;n<i;n++)t[e.charAt(n)]=n;return t}(o),s=String.fromCharCode,l=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?s(192|t>>>6)+s(128|63&t):s(224|t>>>12&15)+s(128|t>>>6&63)+s(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return s(240|t>>>18&7)+s(128|t>>>12&63)+s(128|t>>>6&63)+s(128|63&t)},c=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,u=function(e){return e.replace(c,l)},d=function(e){var t=[0,2,1][e.length%3],n=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[o.charAt(n>>>18),o.charAt(n>>>12&63),t>=2?"=":o.charAt(n>>>6&63),t>=1?"=":o.charAt(63&n)].join("")},h=n.btoa?function(e){return n.btoa(e)}:function(e){return e.replace(/[\s\S]{1,3}/g,d)},f=i?i.from&&i.from!==Uint8Array.from?function(e){return(e.constructor===i.constructor?e:i.from(e)).toString("base64")}:function(e){return(e.constructor===i.constructor?e:new i(e)).toString("base64")}:function(e){return h(u(e))},m=function(e,t){return t?f(String(e)).replace(/[+\/]/g,function(e){return"+"==e?"-":"_"}).replace(/=/g,""):f(String(e))},y=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),p=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return s(55296+(t>>>10))+s(56320+(1023&t));case 3:return s((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return s((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},g=function(e){return e.replace(y,p)},C=function(e){var t=e.length,n=t%4,i=(t>0?r[e.charAt(0)]<<18:0)|(t>1?r[e.charAt(1)]<<12:0)|(t>2?r[e.charAt(2)]<<6:0)|(t>3?r[e.charAt(3)]:0),a=[s(i>>>16),s(i>>>8&255),s(255&i)];return a.length-=[0,0,2,1][n],a.join("")},G=n.atob?function(e){return n.atob(e)}:function(e){return e.replace(/[\s\S]{1,4}/g,C)},S=i?i.from&&i.from!==Uint8Array.from?function(e){return(e.constructor===i.constructor?e:i.from(e,"base64")).toString()}:function(e){return(e.constructor===i.constructor?e:new i(e,"base64")).toString()}:function(e){return g(G(e))},E=function(e){return S(String(e).replace(/[-_]/g,function(e){return"-"==e?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))};if(n.Base64={VERSION:"2.3.2",atob:G,btoa:h,fromBase64:E,toBase64:m,utob:u,encode:m,encodeURI:function(e){return m(e,!0)},btou:g,decode:E,noConflict:function(){var e=n.Base64;return n.Base64=a,e}},"function"==typeof Object.defineProperty){var T=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};n.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",T(function(){return E(this)})),Object.defineProperty(String.prototype,"toBase64",T(function(e){return m(this,e)})),Object.defineProperty(String.prototype,"toBase64URI",T(function(){return m(this,!0)}))}}n.Meteor&&(Base64=n.Base64),void 0!==t&&t.exports?t.exports.Base64=n.Base64:"function"==typeof define&&define.amd&&define([],function(){return n.Base64})}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:void 0),cc._RF.pop()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{buffer:3}],keywords:[function(e,t,n){"use strict";cc._RF.push(t,"1ede2ZwNdRBgbbfDcofiluT","keywords");var i=cc.Enum({GLOBAL_CONFIG_ID_NONE:0,GLOBAL_CONFIG_ID_SVR_STATUS_BUSY:1,GLOBAL_CONFIG_ID_SVR_STATUS_CROWD:2,GLOBAL_CONFIG_ID_MATCHING_TIMEOUT:101}),a=cc.Enum({BET_NONE:0,BET_CHANGE_ATTR:1,BET_FLUSH_MOVE_ALLOW:2,BET_FLUSH_MOVE_EXEC:3,BET_HIDE_ALLOW:4,BET_HIDE_EXEC:5,BET_CHANGE_BULLET:6,BET_LASER_ALLOW:7,BET_LASER_EXEC:8,BET_SKILL_PARAM1:9,BET_SKILL_PARAM2:10}),o=cc.Enum({ATTR_MIN:0,ATTR_HP:1,ATTR_MAX_HP:2,ATTR_SPEED:3,ATTR_BULLET_FILL_UP_LIMIT:4,ATTR_BULLET_FILL_INTERVAL:5,ATTR_MAX:6}),r=cc.Enum({BR_SPELL_ACTION:1}),s=cc.Enum({SCHEDULE_LOOP_TYPE_NONE:0,SCHEDULE_LOOP_TYPE_DAY:1,SCHEDULE_LOOP_TYPE_WEEK:2,SCHEDULE_LOOP_TYPE_MONTH:3,SCHEDULE_LOOP_TYPE_YEAR:4}),l=cc.Enum({GM_NORMAL:0,GM_ADVANCE:1}),c=cc.Enum({GM_CON_BATTLE:0,GM_CON_OUT_ROOM:1,GM_CON_IN_ROOM:2,GM_CON_ANY:3}),u=cc.Enum({GM_CMD_TYPE_GET_ITEM:0,GM_CMD_TYPE_ATTR:1,GM_CMD_TYPE_CREATE_ITEM:2,GM_CMD_TYPE_M_WINCOUNT:3,GM_CMD_TYPE_M_KILLCOUNT:4,GM_CMD_TYPE_M_BLOCKCOUNT:5,GM_CMD_TYPE_OPEN_GUIDE:6,GM_CMD_TYPE_SELECT_SERVER:7,GM_CMD_TYPE_SELECT_MAP:8,GM_CMD_TYPE_SELECT_TANK:9,GM_CMD_TYPE_ADD_BUFF:10,GM_CMD_TYPE_DEL_BUFF:11,GM_CMD_TYPE_OPEN_ACTIVITY:12,GM_CMD_TYPE_SET_BULLET:13,GM__CMD_TYPE_DIAMOND:14}),d=cc.Enum({GM_ACTION:0});t.exports={ProtoVersion:1,GLOBAL_CONFIG_ID:i,BuffEffectType:a,AttrType:o,BuffRemoveType:r,SCHEDULE_LOOP_TYPE:s,GMClassType:l,GMConditionType:c,GMCmdType:u,GMActionType:d},cc._RF.pop()},{}],loginComNotifyMsg:[function(e,t,n){"use strict";function i(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(t);return null!=n?n[2]:null}function a(e){return!window.GGameEntry.GBattleNetwork.IsConnected()&&window.GGameEntry.CurGamePlayType===c.GamePlayType.GamePlayType_Network}cc._RF.push(t,"4c55bdBWnRKd59vCuH43zlc","loginComNotifyMsg");var o=e("Util"),r=e("PlatformUtil"),s=e("UIManager"),l=e("weixinmsgmgr"),c=e("GlobalCfg"),u=e("loginServerMgr"),d=e("weixininterface"),h=e("ResTableNames");e("loginConfig");t.exports={LoginSuccessEvent:function(e){l.onHideLoadingState(),r.IsWeichatGame()&&wx.gameLoginReport({data:{gameVersion:o.GetBuildVersionNum(),roleName:l.getUserNickName(),roleId:l.getOpenID(),userLevel:0},success:function(e){},fail:function(e){}}),console.log("LoginSuccessEvent")},get_param:i,OnReceivePlayerRole:function(e){if(console.log("OnReceivePlayerRole"),window.GGameEntry.GBattleNetwork.IsConnected()){var t=e.detail.Code;if(t===u.globalServerRetState.serverState_EnterRoom&&r.setBtnCheckEnter(2),r.IsWeichatGame()){var n=!1;if(d.isInvitedToJoinRoom()&&t!==u.globalServerRetState.serverState_EnterRoom){var o=u.onGetInviteInfo();if(void 0!==o&&Object.keys(o).length>0){var c=window.GGameEntry.GBattleNetwork.connector.getURL();if(console.log("OnReceivePlayerRole:"+o.url+" old:"+c+" "+c.indexOf(o.url)),"undefined"!==c&&c.indexOf(o.url)<0)return console.log("OnReceivePlayerRole connect another server."+o.url+" old:"+c),window.GGameEntry.GBattleNetwork.Disconnect(),void u.onConnect();if(n=!0,u.onSetInviteInfo({}),"0"===o.roomid)return console.log("OnReceivePlayerRole null room roomid=0."),m=window.GGameEntry.ResTableMgr.GetConfigByID(h.star_client_c,9).Context,void window.GGameEntry.UIManager.ReturnLogoUI(m);u.onJoinRoom(o.roomid,-1,-1)}}if(!1===n&&1!==r.getBtnCheckEnter()&&t!==u.globalServerRetState.serverState_EnterRoom)return console.log("OnReceivePlayerRole null room."+r.getBtnCheckEnter()+" code:"+t),m=window.GGameEntry.ResTableMgr.GetConfigByID(h.star_client_c,10).Context,void window.GGameEntry.UIManager.ReturnLogoUI(m);window.GGameEntry.UIManager.HideUI(s.UIType.LogoUI),window.GGameEntry.UIManager.ShowUI(s.UIType.PVPMakeTeamUI)}else{var f=i("roomid");null!==f?(t!==u.globalServerRetState.serverState_EnterRoom&&u.onJoinRoom(f,-1,-1),window.location.toString().indexOf("uipath=PVPMakeTeamUI")>0&&(window.GGameEntry.UIManager.HideUI(s.UIType.LogoUI),window.GGameEntry.UIManager.ShowUI(s.UIType.PVPMakeTeamUI))):(window.GGameEntry.UIManager.HideUI(s.UIType.LogoUI),window.GGameEntry.UIManager.ShowUI(s.UIType.PVPMakeTeamUI))}}else{console.log("OnReceivePlayerRole no connect, relogin.");var m=window.GGameEntry.ResTableMgr.GetConfigByID(h.star_client_c,11).Context;l.onShowLoadingState("logining...",15e3,m,a),d.onWXLogin()}}},cc._RF.pop()},{GlobalCfg:"GlobalCfg",PlatformUtil:"PlatformUtil",ResTableNames:"ResTableNames",UIManager:"UIManager",Util:"Util",loginConfig:"loginConfig",loginServerMgr:"loginServerMgr",weixininterface:"weixininterface",weixinmsgmgr:"weixinmsgmgr"}],loginConfig:[function(e,t,n){"use strict";function i(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.length>0){var n=e[0].replysvr.length;if(window.GGameEntry.ServerName=e[0].name,n>0){var i=a(0,n);l.IsWeichatGame()||(i=0);var o=e[0].replysvr[i];s(o.url),console.log("parseConfig success short :"+o.url)}else console.log("parseConfig Error jsonObject[0].replysvr.length==0.");if(!0===t){var c=e[0].zonesvr.length;if(c>0){var u=a(0,c);l.IsWeichatGame()||(u=0);var d=e[0].zonesvr[u];r(d.url),console.log("parseConfig success long :"+d.url)}else console.log("parseConfig Error jsonObject[0].zonesvr.length==0.")}}else console.log("parseConfig Error jsonObject.length==0.")}function a(e,t){var n=t-e,i=Math.random(),a=e+Math.round(i*n);return a>=t&&(a-=1),a}function o(){var e=cc.ServerConfig;console.log("initNetLocalConfig"),h=e.server,window.GGameEntry.tankshareurl=e.tankshareurl,window.GGameEntry.sharerankurl=e.sharerankurl,window.GGameEntry.EffPAvgFPS=e.EffPAvgFPS,window.GGameEntry.EffPRangeH=e.EffPRangeH,window.GGameEntry.EffPRangeL=e.EffPRangeL,window.GGameEntry.EffPRangeMMin=e.EffPRangeMMin,window.GGameEntry.EffPRangeMMax=e.EffPRangeMMax,window.GGameEntry.LogoUIShareShow=e.LogoUIShareShow>0,window.GGameEntry.inviteshareurl=e.inviteshareurl,window.GGameEntry.tanksharetips=e.tanksharetips,window.GGameEntry.shareranktips=e.shareranktips,window.GGameEntry.shareRecordtips=e.shareRecordtips,window.GGameEntry.invitesharetips=e.invitesharetips,window.GGameEntry.rightsharetips=e.rightsharetips,y=e.andpay,p=e.iospay,i(h)}function r(e){if(l.IsWeichatGame()&&""!==window.GGameEntry.ServerName&&e.indexOf(window.GGameEntry.ServerName)<0){console.error("loginConfig setLongSocketURL url is not compare with servername.url:"+e+" servername:"+window.GGameEntry.ServerName);var t=window.GGameEntry.ResTableMgr.GetConfigByID(u.star_client_c,12).Context,n=window.GGameEntry.StringFormat(t,window.GGameEntry.ServerName);null!==window.GGameEntry.UIManager&&void 0!==window.GGameEntry.UIManager&&window.GGameEntry.UIManager.ShowMsgBox(n)}else f=e}function s(e){m=e}cc._RF.push(t,"3f171VTlChKYbooyWnqop5V","loginConfig");e("JsonUtils");var l=e("PlatformUtil"),c=e("weixinmsgmgr"),u=(e("UIManager"),e("EnterStateMgr"),e("ResTableNames")),d=5,h=null,f="",m="",y=0,p=0,g=0,C={TFRAMEHEAD_ID_NONE:0,TFRAMEHEAD_ID_UINT32:1,TFRAMEHEAD_ID_UINT64:2,TFRAMEHEAD_ID_STRING:3};t.exports={initNetLocalConfig:o,getNetConfig:function(){return h},setLongSocketURL:r,setShortSocketURL:s,getShortSocketURL:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=e?"":c.getOpenID(),n=e?"":c.getAccessToken(),a=c.getAppID();null!==h&&void 0!==h&&i(h,!1);var o=m+"/?account_value="+t+"&account_type="+C.TFRAMEHEAD_ID_STRING+"&appid="+a+"&token="+n;return console.log("getShortSocketURL"),o},getLongSocketURL:function(){if(!0===(arguments.length>0&&void 0!==arguments[0]&&arguments[0]))return f;var e=c.getOpenID(),t=c.getAccessToken(),n=c.getAppID();return f+"/?account_value="+e+"&account_type="+C.TFRAMEHEAD_ID_STRING+"&appid="+n+"&token="+t},getRandomNum:a,reInitNetConfig:function(){g>=d&&(g=0),o()},getPayFlag:function(e){return 1===e?p>0:2===e&&y>0},setConnectServer:function(e){window.GGameEntry.ServerName=e;for(var t=0;t<h.length;t++)if(h[t].name===e){y=h[t].andpay,p=h[t].iospay,s(h[t].replysvr[0].url),r(h[t].zonesvr[0].url);break}}},cc._RF.pop()},{EnterStateMgr:"EnterStateMgr",JsonUtils:"JsonUtils",PlatformUtil:"PlatformUtil",ResTableNames:"ResTableNames",UIManager:"UIManager",weixinmsgmgr:"weixinmsgmgr"}],loginServerMgr:[function(e,t,n){"use strict";function i(){return X}function a(e){X=e}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=_.SafeStringify({type:t,msg:e});Q.push(n)}function r(){Q.clear()}function s(e){if(I.IsGameMode(I.GM.GameMode_PVPPlayer)){var t=B.GetRequestByID(A.CS_CMD_TYPE.CS_CMD_REPORT_ROLE_DISPLAY_INFO);if("number"==typeof e&&e%1==0)t.ReportResult=e;else{t.ReportResult=0,t.RawData=e.rawData,t.Signature=e.signature,t.EncryptedData=e.encryptedData,t.iv=e.iv;var n=_.SafeParse(e.rawData);t.Name=window.GGameEntry.GBase64.encode(n.nickName);var i=n.avatarUrl;if(""!==i){var a=i.lastIndexOf("/");i=i.substring(0,a+1)+"64"}t.Pic=i,t.Gender=n.gender;var o=d();o&&(t.LoginSyncData=o.LoginSyncData)}console.log("onSendUserInfo:"+i);var r=U.getShortSocketURL();B.SendGameSvrRequest(r,0,t,E)}else console.log("onSendUserInfo not mode GameMode_PVPPlayer.")}function l(){console.log("onQueryQunUserInfo");var e=B.GetRequestByID(A.CS_CMD_TYPE.CS_CMD_NAME_PIC_LIST);e.ClientType=R.CLIENT_TYPE.CLIENT_TYPE_WX_GROUP_RANK_INTERFACE,N.GetQunUserOpenid(e);var t=U.getShortSocketURL();B.PushGameSvrMsg(t,0,e,E)}function c(){var e=U.getLongSocketURL();console.log("onConnect link:"+e),window.GGameEntry.GBattleNetwork.Connect(e)}function u(){var e=B.GetRequestByID(A.CS_CMD_TYPE.CS_CMD_GET_ROLE_INFO);B.SendBattleSvrRequest(0,e)}function d(){console.log("onLoginSyncData");var t=D.getDeviceSystemAllInfo(),n=B.GetRequestByID(A.CS_CMD_TYPE.CS_CMD_LOGIN_SYNC_DATA);if(n.LoginSyncData=new P.LoginSyncData,n.LoginSyncData.IsNew=0,null!==t){var i=e("Util");n.LoginSyncData.ClientVersion=i.GetBuildVersionNum().toString(),n.LoginSyncData.SystemSoftware=t.system,n.LoginSyncData.SystemHardware=t.model,n.LoginSyncData.ScreenWidth=t.screenWidth,n.LoginSyncData.ScreenHight=t.screenHeight}return window.GGameEntry.ResManager.CurResType===O.ResCfgType.H?n.LoginSyncData.MachineType=P.CLIENT_MACHINE_TYPE.CLIENT_MACHINE_TYPE_HIGH:window.GGameEntry.ResManager.CurResType===O.ResCfgType.M?n.LoginSyncData.MachineType=P.CLIENT_MACHINE_TYPE.CLIENT_MACHINE_TYPE_MID:window.GGameEntry.ResManager.CurResType===O.ResCfgType.L&&(n.LoginSyncData.MachineType=P.CLIENT_MACHINE_TYPE.CLIENT_MACHINE_TYPE_LOW),n}function h(){return!se}function f(){return window.GGameEntry.NotificationCenter.emit("LeaveRoomState",{flag:le}),!le}function m(){if(console.log("onLeaveRoom"),"0"===J)return window.GGameEntry.NotificationCenter.emit("LeaveRoomState",{flag:le}),void console.log("onLeaveRoom RoomGuid === 0, not send to server");le=!1;var e=window.GGameEntry.ResTableMgr.GetConfigByID(F.star_client_c,14).Context;b.onShowLoadingState("Leaving...",5e3,e,f);var t=B.GetRequestByID(A.CS_CMD_TYPE.CS_SUB_BATTLE_LEAVE_ROOM);t.RoomGuid=J,B.SendBattleSvrRequest(0,t)}function y(){return!ce}function p(){return!ue}function g(){return!de}function C(){console.log("onQueryRoomInfo");var e=B.GetRequestByID(A.CS_CMD_TYPE.CS_SUB_BATTLE_GET_TEAM_INFO);e.RoomGuid=J,B.SendBattleSvrRequest(0,e)}function G(){j=null}function S(){return j}function E(t){var n=_.SafeParse(t);if(void 0!==n&&0!==n.E){if(n.C===A.CS_CMD_TYPE.CS_CMD_GET_WX_SESSION_INFO){var a=window.GGameEntry.ResTableMgr.GetConfigByID(F.star_client_c,63).Context,o=window.GGameEntry.StringFormat(a,n.E);return void window.GGameEntry.UIManager.ReturnLogoUI(o)}if(n.E===R.RET_CODE.RET_CODE_LOGIN_BAN_ON_SVR_AUTH){var a=window.GGameEntry.ResTableMgr.GetConfigByID(F.star_client_c,19).Context,o=window.GGameEntry.StringFormat(a,n.E);return void window.GGameEntry.UIManager.ShowMsgBox(o)}}if(void 0!==n&&0===n.E){if(n.C===A.CS_CMD_TYPE.CS_CMD_GET_WX_SESSION_INFO){var r=n.SD.GetWxSessionInfo;if(b.initLoginInfo(r.Openid,r.GameToken),K=1,I.IsGameMode(I.GM.GameMode_PVPPlayer)){var u=b.getUserInfo();null===u&&V===H.sessionState_Default||(V=H.sessionState_Default,K=2,s(null===u?V:u))}else B.SendLoginSuccessGameSvrMsg();D.IsWeichatGame()||I.IsGameMode(I.GM.GameMode_Activity)||(window.GGameEntry.NotificationCenter.emit("LoginSuccessEvent",{Eno:n.E}),c())}else if(n.C===A.CS_CMD_TYPE.CS_CMD_REPORT_ROLE_DISPLAY_INFO){if(M(n.SD.ReportRoleDisplayInfo),window.GGameEntry.NotificationCenter.emit("LoginSuccessEvent",{Eno:n.E}),I.IsGameMode(I.GM.GameMode_PVPPlayer)){if(e("weixininterface").isInvitedToJoinRoom()){console.log("onRecvGameMsgCallback isInvitedToJoinRoom=false");var d=i();void 0!==d&&Object.keys(d).length>0&&(console.log("onRecvGameMsgCallback isInvitedToJoinRoom url:"+d.url),U.setLongSocketURL(d.url))}window.GGameEntry.GBattleNetwork.IsConnected(U.getLongSocketURL())?console.log("onRecvGameMsgCallback URL has been connected. "+U.getLongSocketURL()):c()}}else if(n.C===A.CS_CMD_TYPE.CS_CMD_GET_TOTAL_FIGHT_RECORD)b.onHideLoadingState(),q=n.SD.TotalFightRecord,ee=!0,window.GGameEntry.UIManager.ShowUI(v.UIType.RecordUI,v.UIOrder.Top+100);else if(n.C===A.CS_CMD_TYPE.CS_CMD_MIDAS_GET_BALANCE)b.onHideLoadingState(),Z=n.SD.MidasGetBalance.Balance,console.log("onRecvGameMsgCallback globalPlayerMoney:"+Z),te=!0,window.GGameEntry.UIManager.ShowUI(v.UIType.ShopUI,v.UIOrder.Top+1);else if(n.C===A.CS_CMD_TYPE.CS_CMD_WX_GROUP_RANK_LIST){var h=n.SD.WxGroupRankList;console.log("onRecvGameMsgCallback CS_CMD_WX_GROUP_RANK_LIST"),N.SetUserBattleInfo(h),l()}else if(n.C===A.CS_CMD_TYPE.CS_CMD_NAME_PIC_LIST){b.onHideLoadingState();var f=n.SD.NamePicList;console.log("onRecvGameMsgCallback CS_CMD_NAME_PIC_LIST"),N.SetUserPersonalInfo(f),ne=!0,window.GGameEntry.UIManager.ShowUI(v.UIType.RankUI,v.UIOrder.Top+1)}else if(n.C===A.CS_CMD_TYPE.CS_CMD_GET_ROLE_BASE_INFO){var m=n.SD.GetRoleBaseInfo;window.GGameEntry.GBattleNetwork.SetHeartbeatTimeout(m.ClientHeartBeatTerm),window.GGameEntry.NotificationCenter.emit("onRoleBaseInfoNotify",{RoleBaseInfo:m})}console.log("onRecvGameMsgCallback success:"+t)}else console.warn("onRecvGameMsgCallback Error:"+t)}function T(e){e.C===A.CS_CMD_TYPE.CS_SUB_BATTLE_ADD_ROOM?(b.onHideLoadingState(),se=!0):e.C===A.CS_CMD_TYPE.CS_SUB_BATTLE_LEAVE_ROOM?(b.onHideLoadingState(),le=!0,J="0"):e.C===A.CS_CMD_TYPE.CS_SUB_BATTLE_REPORT_READY_STATUS?(b.onHideLoadingState(),ce=!0):e.C===A.CS_CMD_TYPE.CS_SUB_BATTLE_OWNER_KICK_OUT?(b.onHideLoadingState(),ue=!0):e.C===A.CS_CMD_TYPE.CS_SUB_BATTLE_CHANGE_POS?(b.onHideLoadingState(),de=!0):e.C===A.CS_CMD_TYPE.CS_SUB_BATTLE_GAME_BEGIN&&(b.onHideLoadingState(),ce=!0)}function w(t){console.log("onRecvBattleMsgCallback:");var n=t;if(void 0!==n)if(T(n),0===n.E){if(n.C===A.CS_CMD_TYPE.CS_CMD_DISCONNECTED)console.log("服务器断开链接："+n.E);else if(n.C===A.CS_CMD_TYPE.CS_CMD_GET_ROLE_INFO){window.GGameEntry.GBattleNetwork.resetBadNetworkFlag();var r=d();if(B.SendBattleSvrRequest(0,r),re=0,b.onHideLoadingState(),window.GGameEntry.IsReconnect=!1,0===n.E){var s=n.SD.GetRoleInfo.RoleCurRoomInfo;if(console.log("onRecvBattleMsgCallback roomguid:"+s.RoomGid+" globalRoomGuid:"+J),"0"===s.RoomGid&&"0"!==J){if((g=e("weixininterface")).isInvitedToJoinRoom()){i();if(J!==n.roomid&&window.GGameEntry.BattleSystem.IsInRooming())return console.log("onRecvBattleMsgCallback room breakup and join new room."),window.GGameEntry.UIManager.HideUI(v.UIType.PVPMakeTeamUI),window.GGameEntry.UIManager.HideUI(v.UIType.PVPExitTeamUI),window.GGameEntry.UIManager.ShowUI(v.UIType.LogoUI),void window.GGameEntry.NotificationCenter.emit("OnReceivePlayerRole",{Code:W.serverState_EnterRoom})}if(window.GGameEntry.BattleSystem.IsInRooming()){X=window.GGameEntry.ResTableMgr.GetConfigByID(F.star_client_c,20).Context;window.GGameEntry.UIManager.ReturnLogoUI(X),console.log("onRecvBattleMsgCallback room timeout breakup.")}return J=s.RoomGid,void a({})}if(1===s.IsInCurZone)if(window.GGameEntry.IsReconnect=!0,s.RoomStatus===P.ROOM_STATUS.ROOM_STATUS_WAITIN_GAME){if(J=s.RoomGid,(g=e("weixininterface")).isInvitedToJoinRoom()){var l=i();if(void 0!==l&&Object.keys(l).length>0&&l.roomid!==s.RoomGid)return $=Y.LeaveState_JoinNewRoom,m(),void console.log("onRecvBattleMsgCallback invited join new room:"+l.roomid+" serverroom:"+s.RoomGid)}window.GGameEntry.NotificationCenter.emit("OnReceivePlayerRole",{Code:W.serverState_EnterRoom}),C()}else if(s.RoomStatus===P.ROOM_STATUS.ROOM_STATUS_GAME||s.RoomStatus===P.ROOM_STATUS.ROOM_STATUS_LOADMAP){console.log("onRecvBattleMsgCallback ROOM_STATUS_GAME:"+s.RoomStatus);var u=B.GetRequestByID(A.CS_CMD_TYPE.CS_SUB_BATTLE_GET_OBJ);u.TriggerTime=1,B.SendBattleSvrRequest(0,u);var h=B.GetRequestByID(A.CS_CMD_TYPE.CS_SUB_BATTLE_STATISTIC);B.SendBattleSvrRequest(0,h);p="战斗在进行中";window.GGameEntry.NotificationCenter.emit("onRecvBattleError",{Error:P.ROOM_STATUS.ROOM_STATUS_GAME,Msg:p}),a({}),window.GGameEntry.UIManager.HideUI(v.UIType.PVPMakeTeamUI),window.GGameEntry.UIManager.HideUI(v.UIType.PVPExitTeamUI)}else s.RoomStatus,P.ROOM_STATUS.ROOM_STATUS_GAME_END;else if("0"!==s.RoomGid&&0!==s.RoomPort){window.GGameEntry.IsReconnect=!0,window.GGameEntry.GBattleNetwork.Disconnect();I=(V=U.getLongSocketURL(!0)).lastIndexOf("/zs");V=V.substring(0,I+3)+"/"+s.RoomPort,console.log("onRecvBattleMsgCallback "+V),U.setLongSocketURL(V),c()}else window.GGameEntry.NotificationCenter.emit("OnReceivePlayerRole",{Code:W.serverState_Default})}}else if(n.C===A.CS_CMD_TYPE.CS_SUB_BATTLE_CREATE_ROOM){if(0===n.E){n.SD.CreateRoom.RoomType;var f=n.SD.CreateRoom.RoomGuid,y=n.SD.CreateRoom.Port;J=f,z=n.SD.CreateRoom.RoomCreateTime;I=(V=U.getLongSocketURL(!0)).lastIndexOf("/zs");V=V.substring(0,I+3)+"/"+y,U.setLongSocketURL(V),window.GGameEntry.NotificationCenter.emit("CreateRoomEvent",{RoomGuid:f})}}else if(n.C===A.CS_CMD_TYPE.CS_SUB_BATTLE_ALLOW_AUTO_JOIN)0===n.E&&(console.log("onRoomAutoJoinEvent:",n),window.GGameEntry.NotificationCenter.emit("onRoomAutoJoinEvent",{RoomAutoFlag:n.SD.AllowAutoJoin.AutoJoinStatus}));else if(n.C===A.CS_CMD_TYPE.CS_SUB_BATTLE_ADD_ROOM){if(0===n.E){f=n.SD.AddRoom.RoomGuid;J=f}}else if(n.C===A.CS_CMD_TYPE.CS_SUB_BATTLE_LEAVE_ROOM){if(0===n.E){var p="";if(n.SD.LeaveRoom.LeaveReason===A.LEAVE_REASON.LEAVE_REASON_BE_KICKED||n.SD.LeaveRoom.LeaveReason===A.LEAVE_REASON.LEAVE_REASON_DISSOLVE_ROOM){var g=e("weixininterface");if(g.isInvitedToJoinRoom()){var E=i();if(J!==E.roomid&&window.GGameEntry.BattleSystem.IsInRooming())return console.log("onRecvBattleMsgCallback leave room by breakup and join new room."),window.GGameEntry.UIManager.HideUI(v.UIType.PVPMakeTeamUI),window.GGameEntry.UIManager.HideUI(v.UIType.PVPExitTeamUI),window.GGameEntry.UIManager.ShowUI(v.UIType.LogoUI),void window.GGameEntry.NotificationCenter.emit("OnReceivePlayerRole",{Code:W.serverState_EnterRoom})}p=n.SD.LeaveRoom.LeaveReason===A.LEAVE_REASON.LEAVE_REASON_BE_KICKED?window.GGameEntry.ResTableMgr.GetConfigByID(F.star_client_c,21).Context:window.GGameEntry.ResTableMgr.GetConfigByID(F.star_client_c,22).Context;var w=S();if(null!==w&&void 0!==w){for(var M=!1,_=w.SD.GetTeamInfo,I=0;I<6;I++)if(I<3){if(""!==_.BlueCampRoleInfo[I].OpenId&&_.BlueCampRoleInfo[I].OpenId===b.getOpenID()&&1===_.BlueCampRoleInfo[I].IsRoomOwner){M=!0;break}}else if(""!==_.RedCampRoleInfo[I-3].OpenId&&_.RedCampRoleInfo[I-3].OpenId===b.getOpenID()&&1===_.RedCampRoleInfo[I-3].IsRoomOwner){M=!0;break}!1===M&&(window.GGameEntry.UIManager.ShowMsgBox(p),window.GGameEntry.UIManager.ShowUI(v.UIType.LogoUI)),G()}if($===Y.LeaveState_JoinNewRoom)return window.GGameEntry.NotificationCenter.emit("OnReceivePlayerRole",{Code:W.serverState_Default}),console.log("onLeaveRoom response reJoin share room 2."),void($=Y.LeaveState_Default)}else if(n.SD.LeaveRoom.LeaveReason===A.LEAVE_REASON.LEAVE_REASON_ROOM_TIMEOUT)p="房间长时间未开始已解散",window.GGameEntry.NotificationCenter.emit("onRecvBattleError",{Error:n.SD.LeaveRoom.LeaveReason,Msg:p}),window.GGameEntry.UIManager.ShowMsgBox(p);else if(n.SD.LeaveRoom.LeaveReason===A.LEAVE_REASON.LEAVE_REASON_ACTIVE&&$===Y.LeaveState_JoinNewRoom)return window.GGameEntry.NotificationCenter.emit("OnReceivePlayerRole",{Code:W.serverState_Default}),console.log("onLeaveRoom response reJoin share room 1."),void($=Y.LeaveState_Default);n.SD.LeaveRoom.LeaveReason!==A.LEAVE_REASON.LEAVE_REASON_GAME_OVER&&n.SD.LeaveRoom.LeaveReason!==A.LEAVE_REASON.LEAVE_REASON_SYSTEM&&(a({}),window.GGameEntry.UIManager.HideUI(v.UIType.PVPMakeTeamUI),window.GGameEntry.UIManager.HideUI(v.UIType.PVPExitTeamUI),window.GGameEntry.UIManager.ShowUI(v.UIType.LogoUI))}}else if(n.C===A.CS_CMD_TYPE.CS_SUB_BATTLE_REPORT_READY_STATUS){if(0===n.E)n.SD.ReadyStatus.ReadyStatus}else if(n.C===A.CS_CMD_TYPE.CS_SUB_BATTLE_OWNER_KICK_OUT)n.E;else if(n.C===A.CS_CMD_TYPE.CS_SUB_BATTLE_GET_TEAM_INFO)if(0===n.E){j=n;for(var D=n.SD.GetTeamInfo,L=b.getOpenID(),N=0;N<D.RedCampRoleInfo.length&&N<P.CAMP_MAX_USER_NUM;N++)if(D.RedCampRoleInfo[N].OpenId===L){window.GGameEntry.PlayerManager.PlayerCampType=k.EntityCampType.RedTeam;break}for(N=0;N<D.BlueCampRoleInfo.length&&N<P.CAMP_MAX_USER_NUM;N++)if(D.BlueCampRoleInfo[N].OpenId===L){window.GGameEntry.PlayerManager.PlayerCampType=k.EntityCampType.BlueTeam;break}window.GGameEntry.NotificationCenter.emit("onUpdateUsersInfo",{jsonObject:n})}else console.log("onRecvBattleMsgCallback cmd:"+n.C+" Eno:"+n.E);else if(n.C===A.CS_CMD_TYPE.CS_SUB_BATTLE_REVIVE){var O=n.SD.Revive;window.GGameEntry.NotificationCenter.emit("onInstantReborn",{ReviveTimes:O.RemainReviveTimes}),console.log("onRecvBattleMsgCallback cmd:"+n.C+" RemainReviveTimes:"+O.RemainReviveTimes)}else if(n.C===A.CS_CMD_TYPE.CS_SUB_BATTLE_ANOTHER_GAME&&0===n.E){var H=n.SD.AnotherGame;J=H.RoomGuid,z=H.RoomCreateTime,ae=H.Port,oe=H.RoomType,console.log("onRecvBattleMsgCallback CS_SUB_BATTLE_ANOTHER_GAME:"+J+" "+ae+" "+oe);var V=U.getLongSocketURL(!0),I=V.lastIndexOf("/zs");V=V.substring(0,I+3)+"/"+ae,U.setLongSocketURL(V),Q.clear(),window.GGameEntry.UIManager.HideUI(v.UIType.SettlementUI),window.GGameEntry.UIManager.ShowUI(v.UIType.PVPMakeTeamUI)}}else{if(n.C===A.CS_CMD_TYPE.CS_SUB_BATTLE_LEAVE_ROOM&&-1===n.E)return void console.log("onRecvBattleMsgCallback Cmd("+n.C+") ErrCode:("+n.E+")");if(n.E===R.RET_CODE.RET_CODE_FIGHTING_ROOM_NOT_EXIST)return console.log("onRecvBattleMsgCallback 战斗结束 Eno："+R.RET_CODE.RET_CODE_FIGHTING_ROOM_NOT_EXIST),void window.GGameEntry.BattleSystem.ExitBattle();var K=x.onRoomServerErrorMsg(n);if(n.C!==A.CS_CMD_TYPE.CS_CMD_DISCONNECTED){if(!window.GGameEntry.BattleSystem.IsPlaying()&&!window.GGameEntry.BattleSystem.IsPause()&&!window.GGameEntry.BattleSystem.IsMapLoading()){if(n.C===A.CS_CMD_TYPE.CS_SUB_BATTLE_GAME_BEGIN)return window.GGameEntry.UIManager.ShowMsgBox(K.msg),void a({});o(K.msg,K.type)}a({}),window.GGameEntry.NotificationCenter.emit("onRecvBattleError",{Error:n.E,Msg:K.msg})}else{if(n.E===R.RET_CODE.RET_CODE_IDLE_TOO_LONG){var X=window.GGameEntry.ResTableMgr.GetConfigByID(F.star_client_c,10016).Context;window.GGameEntry.UIManager.ReturnLogoUI(X)}console.log("服务器断开链接："+n.E)}}}function M(e){if(void 0!==e&&""!==e)if(0!==e.PortNum){var t=0;if(1===e.PortNum)t=e.PortList[0];else if(e.PortNum>1){var n=getRandomNum(0,e.PortNum);t=e.PortList[n]}if(0!==t)if(re!==t){re=t;var i=U.getLongSocketURL(!0),a=i.lastIndexOf("/zs");i=i.substring(0,a+3)+"/"+t,U.setLongSocketURL(i),console.log("onResetLongSocket globalLoginServerPort !== RoomPort new url:"+i)}else U.initNetLocalConfig(),console.log("onResetLongSocket globalLoginServerPort == RoomPort new url:"+U.getLongSocketURL(!0));console.log("onResetLongSocket RoleDisplayInfo.PortNum:"+e.PortNum+" Port:"+t+" URL:"+U.getLongSocketURL())}else console.log("onResetLongSocket RoleDisplayInfo.PortNum === 0");else console.log("onResetLongSocket undefined or null")}cc._RF.push(t,"9f5b1oM7MZJZ7uB99IEdPhh","loginServerMgr");var _=e("JsonUtils"),I=e("GameMode"),B=e("NetworkProto"),v=e("UIManager"),P=e("star_comm"),R=e("star_macro"),A=e("star_cs"),D=e("PlatformUtil"),b=e("weixinmsgmgr"),U=e("loginConfig"),L=e("Container"),N=(e("CmdStartGame"),e("GlobalCfg"),e("QunUserDataMgr")),k=e("EntityTypeDefine"),O=e("ResCfgDef"),x=e("ServerMsgError"),F=e("ResTableNames"),H={sessionState_Default:0,sessionState_AuthRefuse:1,sessionState_UserInfoFailed:2},W={serverState_Default:0,serverState_EnterRoom:1},Y={LeaveState_Default:0,LeaveState_JoinNewRoom:1},V=H.sessionState_Default,J="0",z=0,K=0,j=null,X=null,q=null,Q=new L.CircularQueue(10),Z=0,$=Y.LeaveState_Default,ee=!1,te=!1,ne=!1,ie="0",ae=1,oe=0,re=0,se=!1,le=!1,ce=!1,ue=!1,de=!1;t.exports={onRegisterLongSocketMsg:function(){window.GGameEntry.GBattleNetwork.Register(A.CS_CMD_TYPE.CS_CMD_GET_ROLE_INFO,w),window.GGameEntry.GBattleNetwork.Register(A.CS_CMD_TYPE.CS_SUB_BATTLE_CREATE_ROOM,w),window.GGameEntry.GBattleNetwork.Register(A.CS_CMD_TYPE.CS_SUB_BATTLE_ALLOW_AUTO_JOIN,w),window.GGameEntry.GBattleNetwork.Register(A.CS_CMD_TYPE.CS_SUB_BATTLE_ADD_ROOM,w),window.GGameEntry.GBattleNetwork.Register(A.CS_CMD_TYPE.CS_SUB_BATTLE_LEAVE_ROOM,w),window.GGameEntry.GBattleNetwork.Register(A.CS_CMD_TYPE.CS_SUB_BATTLE_REPORT_READY_STATUS,w),window.GGameEntry.GBattleNetwork.Register(A.CS_CMD_TYPE.CS_SUB_BATTLE_OWNER_KICK_OUT,w),window.GGameEntry.GBattleNetwork.Register(A.CS_CMD_TYPE.CS_SUB_BATTLE_GET_TEAM_INFO,w),window.GGameEntry.GBattleNetwork.Register(A.CS_CMD_TYPE.CS_SUB_BATTLE_END_NOTIFY,w),window.GGameEntry.GBattleNetwork.Register(A.CS_CMD_TYPE.CS_SUB_BATTLE_IN_ROOM_INFO,w),window.GGameEntry.GBattleNetwork.Register(A.CS_CMD_TYPE.CS_CMD_DISCONNECTED,w),window.GGameEntry.GBattleNetwork.Register(A.CS_CMD_TYPE.CS_SUB_BATTLE_CHANGE_POS,w),window.GGameEntry.GBattleNetwork.Register(A.CS_CMD_TYPE.CS_SUB_BATTLE_REVIVE,w),window.GGameEntry.GBattleNetwork.Register(A.CS_CMD_TYPE.CS_SUB_BATTLE_ANOTHER_GAME,w),window.GGameEntry.GBattleNetwork.Register(A.CS_CMD_TYPE.CS_SUB_BATTLE_GAME_BEGIN,w),window.GGameEntry.GBattleNetwork.Register(A.CS_CMD_TYPE.CS_CMD_LOGIN_SYNC_DATA,w),window.GGameEntry.GBattleNetwork.Register(A.CS_CMD_TYPE.CS_CMD_GM,w)},onUnregisterLongSocketMsg:function(){window.GGameEntry.GBattleNetwork.Unregister(A.CS_CMD_TYPE.CS_CMD_GET_ROLE_INFO,w),window.GGameEntry.GBattleNetwork.Unregister(A.CS_CMD_TYPE.CS_SUB_BATTLE_CREATE_ROOM,w),window.GGameEntry.GBattleNetwork.Unregister(A.CS_CMD_TYPE.CS_SUB_BATTLE_ALLOW_AUTO_JOIN,w),window.GGameEntry.GBattleNetwork.Unregister(A.CS_CMD_TYPE.CS_SUB_BATTLE_ADD_ROOM,w),window.GGameEntry.GBattleNetwork.Unregister(A.CS_CMD_TYPE.CS_SUB_BATTLE_LEAVE_ROOM,w),window.GGameEntry.GBattleNetwork.Unregister(A.CS_CMD_TYPE.CS_SUB_BATTLE_REPORT_READY_STATUS,w),window.GGameEntry.GBattleNetwork.Unregister(A.CS_CMD_TYPE.CS_SUB_BATTLE_OWNER_KICK_OUT,w),window.GGameEntry.GBattleNetwork.Unregister(A.CS_CMD_TYPE.CS_SUB_BATTLE_GET_TEAM_INFO,w),window.GGameEntry.GBattleNetwork.Unregister(A.CS_CMD_TYPE.CS_SUB_BATTLE_END_NOTIFY,w),window.GGameEntry.GBattleNetwork.Unregister(A.CS_CMD_TYPE.CS_SUB_BATTLE_IN_ROOM_INFO,w),window.GGameEntry.GBattleNetwork.Unregister(A.CS_CMD_TYPE.CS_CMD_DISCONNECTED,w),window.GGameEntry.GBattleNetwork.Unregister(A.CS_CMD_TYPE.CS_SUB_BATTLE_CHANGE_POS,w),window.GGameEntry.GBattleNetwork.Unregister(A.CS_CMD_TYPE.CS_SUB_BATTLE_REVIVE,w),window.GGameEntry.GBattleNetwork.Unregister(A.CS_CMD_TYPE.CS_SUB_BATTLE_ANOTHER_GAME,w),window.GGameEntry.GBattleNetwork.Unregister(A.CS_CMD_TYPE.CS_SUB_BATTLE_GAME_BEGIN,w),window.GGameEntry.GBattleNetwork.Unregister(A.CS_CMD_TYPE.CS_CMD_LOGIN_SYNC_DATA,w),window.GGameEntry.GBattleNetwork.Unregister(A.CS_CMD_TYPE.CS_CMD_GM,w)},onSetInviteInfo:a,onGetInviteInfo:i,onGetTeamInfo:S,onClearTeamInfo:G,onGetRoomGuid:function(){return J},onGetRoomCreateTime:function(){return z},onSetRoomCreateTime:function(e){z=e},onSetRoomGuid:function(e){J=e},onIsSendUserInfo:function(){return K},onPushErrMsg:o,onLogin:function(e){var t=B.GetRequestByID(A.CS_CMD_TYPE.CS_CMD_GET_WX_SESSION_INFO);t.WxCode=e,console.log("onLogin:"),console.log(t);var n=U.getShortSocketURL(!0);B.SendGameSvrRequest(n,0,t,E)},onSendUserInfo:s,onQueryPlayerResult:function(){console.log("onQueryPlayerResult"),ee=!1;var e=B.GetRequestByID(A.CS_CMD_TYPE.CS_CMD_GET_TOTAL_FIGHT_RECORD),t=U.getShortSocketURL();B.PushGameSvrMsg(t,0,e,E)},onQueryPlayerDiamond:function(){console.log("onQueryPlayerDiamond"),te=!1;var e=new P.MidasGetBalanceC;e.__msgid__=A.CS_CMD_TYPE.CS_CMD_MIDAS_GET_BALANCE;var t="android";(D.isTargetPlatform(1)?R.SYSTEM_TYPE.SYSTEM_TYPE_IOS:R.SYSTEM_TYPE.SYSTEM_TYPE_NONE)===R.SYSTEM_TYPE.SYSTEM_TYPE_IOS&&(t="iap"),e.PlatType=t;var n=U.getShortSocketURL();B.PushGameSvrMsg(n,0,e,E)},onConnect:c,onCreateRoom:function(e,t){console.log("onCreateRoom");var n=B.GetRequestByID(A.CS_CMD_TYPE.CS_SUB_BATTLE_CREATE_ROOM);n.RoomType=e,n.OpType=t,B.SendBattleSvrRequest(0,n)},onAutoJoinRoom:function(e){console.log("onAutoJoinRoom");var t=B.GetRequestByID(A.CS_CMD_TYPE.CS_SUB_BATTLE_ALLOW_AUTO_JOIN);t.AutoJoinStatus=e,B.SendBattleSvrRequest(0,t)},onJoinRoom:function(e,t,n){if(console.log("onJoinRoom:",e),J=e,"0"!==e){D.setBtnCheckEnter(2),r(),window.GGameEntry.UIManager.HideUI(v.UIType.CommonMsgBoxUI),window.GGameEntry.UIManager.HideUI(v.UIType.PVPExitTeamUI),$=Y.LeaveState_Default,se=!1;var i=window.GGameEntry.ResTableMgr.GetConfigByID(F.star_client_c,13).Context;b.onShowLoadingState("joining...",5e3,i,h);var a=B.GetRequestByID(A.CS_CMD_TYPE.CS_SUB_BATTLE_ADD_ROOM);a.RoomGuid=e,a.Camp=t,a.Position=n,B.SendBattleSvrRequest(0,a)}else console.log("onJoinRoom RoomGuid === 0, not send to server")},onLeaveRoom:m,onPlayerChangePos:function(e,t){de=!1;var n=window.GGameEntry.ResTableMgr.GetConfigByID(F.star_client_c,18).Context;b.onShowLoadingState("Changing...",5e3,n,g);var i=B.GetRequestByID(A.CS_CMD_TYPE.CS_SUB_BATTLE_CHANGE_POS);i.Camp=e,i.Position=t,B.SendBattleSvrRequest(0,i)},onWXInviteGroupMsg:function(e,t,n,i){var a=B.GetRequestByID(A.CS_CMD_TYPE.CS_SUB_BATTLE_SEND_WX_GROUP_MSG);a.GroupInfo=new A.GroupInfo,a.GroupInfo.EncryptedData=e,a.GroupInfo.Iv=t,a.GroupMsgTicket=n,a.Query=i,B.SendBattleSvrRequest(0,a)},onPlayerReadyStatus:function(e){console.log("onPlayerReadyStatus"),ce=!1;var t=window.GGameEntry.ResTableMgr.GetConfigByID(F.star_client_c,15).Context;b.onShowLoadingState("Readying...",5e3,t,y);var n=B.GetRequestByID(A.CS_CMD_TYPE.CS_SUB_BATTLE_REPORT_READY_STATUS);n.ReadyStatus=e>0?1:0,B.SendBattleSvrRequest(0,n)},onRoomKeeperKickout:function(e){console.log("onRoomKeeperKickout"),ue=!1;var t=window.GGameEntry.ResTableMgr.GetConfigByID(F.star_client_c,17).Context;b.onShowLoadingState("Kicking...",5e3,t,p);var n=B.GetRequestByID(A.CS_CMD_TYPE.CS_SUB_BATTLE_OWNER_KICK_OUT);n.KickedOpenId=e,B.SendBattleSvrRequest(0,n)},onQueryRoomInfo:C,onGetServerErrMsg:function(){return Q.pop()},onGetServerErrMsgCount:function(){return Q.count()},globalServerRetState:W,onConnectSuccessNotify:function(e){!0===e||(b.onShowLoadingState("waiting",15e3),u()),console.log("onConnectSuccessNotify is timeout:"+e)},globalSessionState:H,onSetUserInfoFailed:function(e){V=e},onGetPlayerResultInfo:function(){return q},onGetRoleInfo:u,onGetPlayerMoney:function(){return Z},onRequestRevive:function(){console.log("onRequestRevive");var e=B.GetRequestByID(A.CS_CMD_TYPE.CS_SUB_BATTLE_REVIVE),t="android";(D.isTargetPlatform(1)?R.SYSTEM_TYPE.SYSTEM_TYPE_IOS:R.SYSTEM_TYPE.SYSTEM_TYPE_NONE)===R.SYSTEM_TYPE.SYSTEM_TYPE_IOS&&(t="iap"),e.PlatType=t,B.SendBattleSvrRequest(0,e)},onSetLeaveRoomState:function(e){$=e},globalLeaveRoomState:Y,onQueryQunRankInfo:function(){console.log("onQueryQunRankInfo"),ne=!1;var e=B.GetRequestByID(A.CS_CMD_TYPE.CS_CMD_WX_GROUP_RANK_LIST);e.ClientType=R.CLIENT_TYPE.CLIENT_TYPE_WX_GROUP_RANK_INTERFACE,N.GetQunUserOpenid(e);var t=U.getShortSocketURL();B.PushGameSvrMsg(t,0,e,E)},getPlayerResultFlag:function(){return ee},getPlayerDiamonFlag:function(){return te},getPlayerRankFlag:function(){return ne},onPushRawErrMsg:function(e){Q.push(e)},onClearErrMsg:r,onKeeperStartGameCheck:function(){console.log("onKeeperStartGameCheck"),ce=!1;var e=window.GGameEntry.ResTableMgr.GetConfigByID(F.star_client_c,16).Context;b.onShowLoadingState("Readying...",5e3,e,y);var t=B.GetRequestByID(A.CS_CMD_TYPE.CS_SUB_BATTLE_GAME_BEGIN);B.SendBattleSvrRequest(0,t)},setBattleAgainInfo:function(e,t,n){if(J="0",ie=e,ae=t,oe=n,void 0!==e&&""!==e){var i=U.getLongSocketURL(!0),a=i.lastIndexOf("/zs");i=i.substring(0,a+3)+"/"+ae,U.setLongSocketURL(i),console.log("setBattleAgainInfo:"+ie+" "+ae+" "+oe+" url:"+i)}else console.error("setBattleAgainInfo:",e)},onBeginBattleAgain:function(){console.log("onBeginBattleAgain:"+oe+" "+ie);var e=B.GetRequestByID(A.CS_CMD_TYPE.CS_SUB_BATTLE_ANOTHER_GAME);e.RoomType=oe,e.RoomGuid=ie,B.SendBattleSvrRequest(0,e)},onPVEGameBegin:function(){console.log("onPVEGameBegin");var e=B.GetRequestByID(A.CS_CMD_TYPE.CS_CMD_PCG_GAME_BEGIN),t=D.isTargetPlatform(1)?R.SYSTEM_TYPE.SYSTEM_TYPE_IOS:R.SYSTEM_TYPE.SYSTEM_TYPE_NONE;t!==R.SYSTEM_TYPE.SYSTEM_TYPE_IOS&&(t=D.isTargetPlatform(2)?R.SYSTEM_TYPE.SYSTEM_TYPE_ANDROID:R.SYSTEM_TYPE.SYSTEM_TYPE_NONE),e.SystemType=t,e.LoginSync=new P.LoginSyncData;var n=U.getShortSocketURL();B.PushGameSvrMsg(n,0,e,E,!0)},onPVEGameEnd:function(e,t){if(console.log("onPVEGameEnd"),""!==b.getOpenID()){var n=B.GetRequestByID(A.CS_CMD_TYPE.CS_CMD_PCG_GAME_END),i=D.isTargetPlatform(1)?R.SYSTEM_TYPE.SYSTEM_TYPE_IOS:R.SYSTEM_TYPE.SYSTEM_TYPE_NONE;i!==R.SYSTEM_TYPE.SYSTEM_TYPE_IOS&&(i=D.isTargetPlatform(2)?R.SYSTEM_TYPE.SYSTEM_TYPE_ANDROID:R.SYSTEM_TYPE.SYSTEM_TYPE_NONE),n.SystemType=i,n.KillCount=e,n.Result=t,n.LoginSync=new P.LoginSyncData;var a=U.getShortSocketURL();B.PushGameSvrMsg(a,0,n,E,!0)}else console.log("onPVEGameEnd openid is null.")},onQueryServerOnOFFConfig:function(){console.log("onQueryServerOnOFFConfig");var e=B.GetRequestByID(A.CS_CMD_TYPE.CS_CMD_GET_ROLE_BASE_INFO),t=U.getShortSocketURL();B.PushGameSvrMsg(t,0,e,E,!0)},update:function(e){}},cc._RF.pop()},{CmdStartGame:"CmdStartGame",Container:"Container",EntityTypeDefine:"EntityTypeDefine",GameMode:"GameMode",GlobalCfg:"GlobalCfg",JsonUtils:"JsonUtils",NetworkProto:"NetworkProto",PlatformUtil:"PlatformUtil",QunUserDataMgr:"QunUserDataMgr",ResCfgDef:"ResCfgDef",ResTableNames:"ResTableNames",ServerMsgError:"ServerMsgError",UIManager:"UIManager",Util:"Util",loginConfig:"loginConfig",star_comm:"star_comm",star_cs:"star_cs",star_macro:"star_macro",weixininterface:"weixininterface",weixinmsgmgr:"weixinmsgmgr"}],"spark-md5":[function(e,t,n){"use strict";cc._RF.push(t,"ac18ebO1RdLwo8xwPApvn0S","spark-md5");var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){if("object"===(void 0===n?"undefined":i(n)))t.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var a;try{a=window}catch(e){a=self}a.SparkMD5=e()}}(function(e){function t(e,t){var n=e[0],i=e[1],a=e[2],o=e[3];i=((i+=((a=((a+=((o=((o+=((n=((n+=(i&a|~i&o)+t[0]-680876936|0)<<7|n>>>25)+i|0)&i|~n&a)+t[1]-389564586|0)<<12|o>>>20)+n|0)&n|~o&i)+t[2]+606105819|0)<<17|a>>>15)+o|0)&o|~a&n)+t[3]-1044525330|0)<<22|i>>>10)+a|0,i=((i+=((a=((a+=((o=((o+=((n=((n+=(i&a|~i&o)+t[4]-176418897|0)<<7|n>>>25)+i|0)&i|~n&a)+t[5]+1200080426|0)<<12|o>>>20)+n|0)&n|~o&i)+t[6]-1473231341|0)<<17|a>>>15)+o|0)&o|~a&n)+t[7]-45705983|0)<<22|i>>>10)+a|0,i=((i+=((a=((a+=((o=((o+=((n=((n+=(i&a|~i&o)+t[8]+1770035416|0)<<7|n>>>25)+i|0)&i|~n&a)+t[9]-1958414417|0)<<12|o>>>20)+n|0)&n|~o&i)+t[10]-42063|0)<<17|a>>>15)+o|0)&o|~a&n)+t[11]-1990404162|0)<<22|i>>>10)+a|0,i=((i+=((a=((a+=((o=((o+=((n=((n+=(i&a|~i&o)+t[12]+1804603682|0)<<7|n>>>25)+i|0)&i|~n&a)+t[13]-40341101|0)<<12|o>>>20)+n|0)&n|~o&i)+t[14]-1502002290|0)<<17|a>>>15)+o|0)&o|~a&n)+t[15]+1236535329|0)<<22|i>>>10)+a|0,i=((i+=((a=((a+=((o=((o+=((n=((n+=(i&o|a&~o)+t[1]-165796510|0)<<5|n>>>27)+i|0)&a|i&~a)+t[6]-1069501632|0)<<9|o>>>23)+n|0)&i|n&~i)+t[11]+643717713|0)<<14|a>>>18)+o|0)&n|o&~n)+t[0]-373897302|0)<<20|i>>>12)+a|0,i=((i+=((a=((a+=((o=((o+=((n=((n+=(i&o|a&~o)+t[5]-701558691|0)<<5|n>>>27)+i|0)&a|i&~a)+t[10]+38016083|0)<<9|o>>>23)+n|0)&i|n&~i)+t[15]-660478335|0)<<14|a>>>18)+o|0)&n|o&~n)+t[4]-405537848|0)<<20|i>>>12)+a|0,i=((i+=((a=((a+=((o=((o+=((n=((n+=(i&o|a&~o)+t[9]+568446438|0)<<5|n>>>27)+i|0)&a|i&~a)+t[14]-1019803690|0)<<9|o>>>23)+n|0)&i|n&~i)+t[3]-187363961|0)<<14|a>>>18)+o|0)&n|o&~n)+t[8]+1163531501|0)<<20|i>>>12)+a|0,i=((i+=((a=((a+=((o=((o+=((n=((n+=(i&o|a&~o)+t[13]-1444681467|0)<<5|n>>>27)+i|0)&a|i&~a)+t[2]-51403784|0)<<9|o>>>23)+n|0)&i|n&~i)+t[7]+1735328473|0)<<14|a>>>18)+o|0)&n|o&~n)+t[12]-1926607734|0)<<20|i>>>12)+a|0,i=((i+=((a=((a+=((o=((o+=((n=((n+=(i^a^o)+t[5]-378558|0)<<4|n>>>28)+i|0)^i^a)+t[8]-2022574463|0)<<11|o>>>21)+n|0)^n^i)+t[11]+1839030562|0)<<16|a>>>16)+o|0)^o^n)+t[14]-35309556|0)<<23|i>>>9)+a|0,i=((i+=((a=((a+=((o=((o+=((n=((n+=(i^a^o)+t[1]-1530992060|0)<<4|n>>>28)+i|0)^i^a)+t[4]+1272893353|0)<<11|o>>>21)+n|0)^n^i)+t[7]-155497632|0)<<16|a>>>16)+o|0)^o^n)+t[10]-1094730640|0)<<23|i>>>9)+a|0,i=((i+=((a=((a+=((o=((o+=((n=((n+=(i^a^o)+t[13]+681279174|0)<<4|n>>>28)+i|0)^i^a)+t[0]-358537222|0)<<11|o>>>21)+n|0)^n^i)+t[3]-722521979|0)<<16|a>>>16)+o|0)^o^n)+t[6]+76029189|0)<<23|i>>>9)+a|0,i=((i+=((a=((a+=((o=((o+=((n=((n+=(i^a^o)+t[9]-640364487|0)<<4|n>>>28)+i|0)^i^a)+t[12]-421815835|0)<<11|o>>>21)+n|0)^n^i)+t[15]+530742520|0)<<16|a>>>16)+o|0)^o^n)+t[2]-995338651|0)<<23|i>>>9)+a|0,i=((i+=((o=((o+=(i^((n=((n+=(a^(i|~o))+t[0]-198630844|0)<<6|n>>>26)+i|0)|~a))+t[7]+1126891415|0)<<10|o>>>22)+n|0)^((a=((a+=(n^(o|~i))+t[14]-1416354905|0)<<15|a>>>17)+o|0)|~n))+t[5]-57434055|0)<<21|i>>>11)+a|0,i=((i+=((o=((o+=(i^((n=((n+=(a^(i|~o))+t[12]+1700485571|0)<<6|n>>>26)+i|0)|~a))+t[3]-1894986606|0)<<10|o>>>22)+n|0)^((a=((a+=(n^(o|~i))+t[10]-1051523|0)<<15|a>>>17)+o|0)|~n))+t[1]-2054922799|0)<<21|i>>>11)+a|0,i=((i+=((o=((o+=(i^((n=((n+=(a^(i|~o))+t[8]+1873313359|0)<<6|n>>>26)+i|0)|~a))+t[15]-30611744|0)<<10|o>>>22)+n|0)^((a=((a+=(n^(o|~i))+t[6]-1560198380|0)<<15|a>>>17)+o|0)|~n))+t[13]+1309151649|0)<<21|i>>>11)+a|0,i=((i+=((o=((o+=(i^((n=((n+=(a^(i|~o))+t[4]-145523070|0)<<6|n>>>26)+i|0)|~a))+t[11]-1120210379|0)<<10|o>>>22)+n|0)^((a=((a+=(n^(o|~i))+t[2]+718787259|0)<<15|a>>>17)+o|0)|~n))+t[9]-343485551|0)<<21|i>>>11)+a|0,e[0]=n+e[0]|0,e[1]=i+e[1]|0,e[2]=a+e[2]|0,e[3]=o+e[3]|0}function n(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function i(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return n}function a(e){var i,a,o,r,s,l,c=e.length,u=[1732584193,-271733879,-1732584194,271733878];for(i=64;i<=c;i+=64)t(u,n(e.substring(i-64,i)));for(a=(e=e.substring(i-64)).length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=0;i<a;i+=1)o[i>>2]|=e.charCodeAt(i)<<(i%4<<3);if(o[i>>2]|=128<<(i%4<<3),i>55)for(t(u,o),i=0;i<16;i+=1)o[i]=0;return r=8*c,r=r.toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(r[2],16),l=parseInt(r[1],16)||0,o[14]=s,o[15]=l,t(u,o),u}function o(e){var n,a,o,r,s,l,c=e.length,u=[1732584193,-271733879,-1732584194,271733878];for(n=64;n<=c;n+=64)t(u,i(e.subarray(n-64,n)));for(a=(e=n-64<c?e.subarray(n-64):new Uint8Array(0)).length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=0;n<a;n+=1)o[n>>2]|=e[n]<<(n%4<<3);if(o[n>>2]|=128<<(n%4<<3),n>55)for(t(u,o),n=0;n<16;n+=1)o[n]=0;return r=8*c,r=r.toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(r[2],16),l=parseInt(r[1],16)||0,o[14]=s,o[15]=l,t(u,o),u}function r(e){var t,n="";for(t=0;t<4;t+=1)n+=m[e>>8*t+4&15]+m[e>>8*t&15];return n}function s(e){var t;for(t=0;t<e.length;t+=1)e[t]=r(e[t]);return e.join("")}function l(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function c(e,t){var n,i=e.length,a=new ArrayBuffer(i),o=new Uint8Array(a);for(n=0;n<i;n+=1)o[n]=e.charCodeAt(n);return t?o:a}function u(e){return String.fromCharCode.apply(null,new Uint8Array(e))}function d(e,t,n){var i=new Uint8Array(e.byteLength+t.byteLength);return i.set(new Uint8Array(e)),i.set(new Uint8Array(t),e.byteLength),n?i:i.buffer}function h(e){var t,n=[],i=e.length;for(t=0;t<i-1;t+=2)n.push(parseInt(e.substr(t,2),16));return String.fromCharCode.apply(String,n)}function f(){this.reset()}var m=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==s(a("hello"))&&function(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n},"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function t(e,t){return(e=0|e||0)<0?Math.max(e+t,0):Math.min(e,t)}ArrayBuffer.prototype.slice=function(n,i){var a,o,r,s,l=this.byteLength,c=t(n,l),u=l;return i!==e&&(u=t(i,l)),c>u?new ArrayBuffer(0):(a=u-c,o=new ArrayBuffer(a),r=new Uint8Array(o),s=new Uint8Array(this,c,a),r.set(s),o)}}(),f.prototype.append=function(e){return this.appendBinary(l(e)),this},f.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var i,a=this._buff.length;for(i=64;i<=a;i+=64)t(this._hash,n(this._buff.substring(i-64,i)));return this._buff=this._buff.substring(i-64),this},f.prototype.end=function(e){var t,n,i=this._buff,a=i.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<a;t+=1)o[t>>2]|=i.charCodeAt(t)<<(t%4<<3);return this._finish(o,a),n=s(this._hash),e&&(n=h(n)),this.reset(),n},f.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},f.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},f.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},f.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},f.prototype._finish=function(e,n){var i,a,o,r=n;if(e[r>>2]|=128<<(r%4<<3),r>55)for(t(this._hash,e),r=0;r<16;r+=1)e[r]=0;i=(i=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(i[2],16),o=parseInt(i[1],16)||0,e[14]=a,e[15]=o,t(this._hash,e)},f.hash=function(e,t){return f.hashBinary(l(e),t)},f.hashBinary=function(e,t){var n=s(a(e));return t?h(n):n},f.ArrayBuffer=function(){this.reset()},f.ArrayBuffer.prototype.append=function(e){var n,a=d(this._buff.buffer,e,!0),o=a.length;for(this._length+=e.byteLength,n=64;n<=o;n+=64)t(this._hash,i(a.subarray(n-64,n)));return this._buff=n-64<o?new Uint8Array(a.buffer.slice(n-64)):new Uint8Array(0),this},f.ArrayBuffer.prototype.end=function(e){var t,n,i=this._buff,a=i.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<a;t+=1)o[t>>2]|=i[t]<<(t%4<<3);return this._finish(o,a),n=s(this._hash),e&&(n=h(n)),this.reset(),n},f.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},f.ArrayBuffer.prototype.getState=function(){var e=f.prototype.getState.call(this);return e.buff=u(e.buff),e},f.ArrayBuffer.prototype.setState=function(e){return e.buff=c(e.buff,!0),f.prototype.setState.call(this,e)},f.ArrayBuffer.prototype.destroy=f.prototype.destroy,f.ArrayBuffer.prototype._finish=f.prototype._finish,f.ArrayBuffer.hash=function(e,t){var n=s(o(new Uint8Array(e)));return t?h(n):n},f}),cc._RF.pop()},{}],star_comm:[function(e,t,n){"use strict";cc._RF.push(t,"de241bB+sdFxLMrlnIHVcMC","star_comm");var i=cc.Enum({CS_OBJ_PLAYER:1,CS_OBJ_OTHER:2}),a=cc.Enum({EPSI_NO_MOVE:1,EPSI_NO_ATTACK:2,EPSI_NO_DAMAGE:3,EPSI_MAX:4}),o=cc.Enum({COUNTER_PERIOD_TYPE_DAY:1,COUNTER_PERIOD_TYPE_WEEK:2,COUNTER_PERIOD_TYPE_MONTH:3,COUNTER_PERIOD_TYPE_FOREVER:4}),r=cc.Enum({DAILY_COUNTER_TYPE_ROLE_DAILY_ATTR:1,DAILY_COUNTER_TYPE_ROLE_WEEK_ATTR:2,DAILY_COUNTER_TYPE_ROLE_MONTH_ATTR:3}),s=cc.Enum({ROLE_DAILY_ATTR_COUNTER_ID_TEST:1}),l=cc.Enum({ROLE_WEEK_ATTR_COUNTER_ID_TEST:1}),c=cc.Enum({ROLE_MONTH_ATTR_COUNTER_ID_TEST:1}),u=cc.Enum({BULLET_TYPE_NORMAL:1,BULLET_TYPE_ARMOR:2,BULLET_TYPE_CURE:3}),d=cc.Enum({ATTR_MIN:0,ATTR_HP:1,ATTR_MAX_HP:2,ATTR_SPEED:3,ATTR_BULLET_FILL_UP_LIMIT:4,ATTR_BULLET_FILL_INTERVAL:5,ATTR_MAX:6}),h=cc.Enum({OBJ_TYPE_TANK:1,OBJ_TYPE_BASE:2,OBJ_TYPE_ITEM:3,OBJ_TYPE_STEEL:4,OBJ_TYPE_BRICK:5,OBJ_TYPE_RIVER:6,OBJ_TYPE_GRASS:7,OBJ_TYPE_ORNAMENT:8,OBJ_TYPE_HIDE:9,OBJ_TYPE_BOX:10,OBJ_TYPE_MAP_BOX:11,OBJ_TYPE_NO_BROKEN:12}),f=cc.Enum({CAMP_TYPE_NONE:0,CAMP_TYPE_BLUE:1,CAMP_TYPE_RED:2}),m=cc.Enum({ROOM_STATUS_NONE:0,ROOM_STATUS_WAITIN_GAME:1,ROOM_STATUS_LOADMAP:2,ROOM_STATUS_GAME:3,ROOM_STATUS_GAME_END:4,ROOM_STATUS_DISSOLVE:5}),y=cc.Enum({BATTLE_END_REASON_DESTORY_BASE:1,BATTLE_END_REASON_TIME_END:2}),p=cc.Enum({INTERACT_EVENT_LOG_STATUS_NEW:1,INTERACT_EVENT_LOG_STATUS_RETRY:2}),g=cc.Enum({INTERACT_EVENT_TYPE_NONE:0,INTERACT_EVENT_TYPE_TEST:1,INTERACT_EVENT_TYPE_GM:2,INTERACT_EVENT_TYPE_MAX:3}),C=cc.Enum({SIMPLE_COUNTER_TYPE_DAY:1,SIMPLE_COUNTER_TYPE_WEEK:2,SIMPLE_COUNTER_TYPE_MONTH:3,SIMPLE_COUNTER_TYPE_FOREVER:4}),G=cc.Enum({WEEK_COUNTER_STATISTICS_TYPE_GAME_COUNT:1,WEEK_COUNTER_STATISTICS_TYPE_WIN_GAME_COUNT:2,WEEK_COUNTER_STATISTICS_TYPE_LOST_GAME_COUNT:3,WEEK_COUNTER_STATISTICS_TYPE_KILL_COUNT:4,WEEK_COUNTER_STATISTICS_TYPE_DEATH_COUNT:5,WEEK_COUNTER_STATISTICS_TYPE_KILL_BRICK_COUNT:6,WEEK_COUNTER_STATISTICS_TYPE_HEAL_ALLY_COUNT:7,WEEK_COUNTER_STATISTICS_TYPE_HURT_ENEMY_TANK_COUNT:8,WEEK_COUNTER_STATISTICS_TYPE_MAX_COMBO_KILL:9}),S=cc.Enum({CLIENT_MACHINE_TYPE_HIGH:0,CLIENT_MACHINE_TYPE_MID:1,CLIENT_MACHINE_TYPE_LOW:2});t.exports={ProtoVersion:15,KeyValue:function(){return{Key:0,Value:0}},KeyValueChar:function(){return{Key:0,Value:0}},KeyValue2:function(){return{Key:0,Value:[]}},KeyValue4:function(){return{Key:0,Value:[]}},KeyValue5:function(){return{Key:0,Value:[]}},KeyValue6:function(){return{Key:0,Value:[]}},KeyValueUll:function(){return{Key:0,Value:0}},UllKeyValue:function(){return{Key:0,Value:0}},TypeValue:function(){return{Type:null,Value:0}},BATCH_MSG_LEN:102400,MAX_ROLENAME_LEN:32,MAX_BUFF_ONE_OBJ:10,MAX_OBJECT_NUM_PER_MAP:350,MAX_ONE_OBJ_ATTR_NUM:64,MAX_MAGICFIELD_TARGET_NUM:16,CsObjectType:i,CSPoint:function(){return{x:0,y:0}},CSAttrValueOneNew:function(){return{P:[]}},CSAttrValueOne:function(){return{AttrID:0,Value:0}},ObjectStateType:a,MAX_COUNTER_PERIOD_TYPE_NUM:4,COUNTER_PERIOD_TYPE:o,DAILY_COUNTER_TYPE_MIN:1,DAILY_COUNTER_TYPE:r,DAILY_COUNTER_TYPE_MAX:10,MAX_DAILY_COUNTER_TYPE_NUM:0,MAX_DAILY_COUNTER_ITEM_DB_NUM:30,ROLE_DAILY_ATTR_COUNTER_ID_NUM:10,ROLE_DAILY_ATTR_COUNTER_ID:s,ROLE_WEEK_ATTR_COUNTER_ID_NUM:10,ROLE_WEEK_ATTR_COUNTER_ID:l,ROLE_MONTH_ATTR_COUNTER_ID_NUM:10,ROLE_MONTH_ATTR_COUNTER_ID:c,CounterOption:function(){return{Type:0,ID:0,Count:0}},CounterPeriod:function(){return{Type:0,EndTime:0}},CouterTypeLmt:function(){return{CurNum:0,MaxNum:0}},DailyCounter:function(){return{Counters:[],PeriodNum:0,Periods:[],TypeLmt:[]}},DBDailyCounter:function(){return{Num:0,Counters:[],PeriodNum:0,Periods:[]}},CONNDINFO:function(){return{ConnectID:null,ConnIdx:0,ClientPort:null,ClientIP:null}},BulletType:u,AttrType:d,ObjType:h,CAMP_TYPE:f,ROOM_STATUS:m,BATTLE_END_REASON:y,MAX_PVP_CAMP_NUM:2,CAMP_MAX_USER_NUM:3,PlayerStatistic:function(){return{ObjID:0,KillNum:0,DieNum:0,BrickNum:0,AddHPToTeam:0,KillContiMax:0,AttackTankDmg:0,AttackBaseDmg:0,LastKillTime:""}},CampStatistic:function(){return{CampID:0,PlayerNum:0,PlayerStatistic:[]}},CSBattleStatistic:function(){return{CampNum:0,CampStatistic:[]}},RoleCurRoomInfo:function(){return{RoomGid:0,IsInCurZone:0,RoomPort:0,RoomStatus:0}},WxQrCodeInfoC:function(){return{Scene:"",Page:"",Width:0,AutoColor:"",LineColor:"",WxAccessToken:""}},WxQrCodeInfoS:function(){return{QrCodeUrl:""}},MidasGetBalanceC:function(){return{Openid:"",WxAccessToken:"",WxSessionKey:"",PlatType:""}},MidasGetBalanceS:function(){return{Balance:null}},MAX_BILL_NO_LEN:63,MidasPayTestC:function(){return{Openid:"",WxAccessToken:"",WxSessionKey:"",Amt:0,BillNo:""}},MidasPayTestS:function(){return{Balance:null}},MAX_INTERACT_EVENT_TYPE_NUM:100,InteractEventLogData:function(e){switch(e){case INTERACT_EVENT_TYPE_TEST:return{TestData:null}}},RoleFriendBase:function(){return{Openid:"",Name:""}},INTERACT_EVENT_LOG_STATUS:p,INTERACT_EVENT_TYPE:g,InteractEventLog:function(){return{Openid:"",EventType:null,EventLogData:null,Sender:null,Status:null,DBSeq:0,CreateTime:0}},MAX_ONCE_BATCH_HANDLE_EVENTLOG_NUM:50,MAX_BATCH_HANDLE_EVENTLOG_USERDATA_LEN:256,BatchHandleEventLog:function(){return{EventType:null,Reason:null,Num:null,LogIndexList:[]}},BatchHandleEventLogList:function(){return{Num:null,LogList:[]}},MAX_ONCE_GET_INTERACTEVENTLOG_NUM:200,InteractEventLogList:function(){return{Num:null,LogList:[]}},MAX_SIMPLE_COUNTER_VALUE_NUM:50,SimpleCounterValue:function(){return{Type:0,ID:0,Count:0}},SIMPLE_COUNTER_TYPE_:C,COUNTER_STATISTICS_TYPE:G,SimpleCounterOption:function(){return{EndTime:0,Num:0,SimpleCounterValue:[]}},SimpleWeeklyCounterOption:function(){return{EndTime:0,Num:0,SimpleCounterValue:[]}},MAX_SIMPLE_COUNTER_NUM:1,SimpleCounter:function(){return{WeeklyCounterOption:null}},RoleGameData:function(){return{RoomGid:0,RoomPort:0,RoomUpdateTime:0}},RoleAuthData:function(){return{WxSessionKey:"",GameToken:"",GameTokenUpdateTime:0}},RoleBaseData:function(){return{CreateTime:0,LastLoginTime:0}},MAX_RESERVE_LIST_NUM:10,ReserveData:function(){return{Num:0,ReserveList:[]}},RoleExtData:function(){return{Reserve:0,DailyCounter:null,ReserveData:null}},RoleNameData:function(){return{Name:""}},RolePicData:function(){return{Pic:""}},RoleStatisticsData:function(){return{GameCount:0,WinGameCount:0,LostGameCount:0,KillCount:0,DeathCount:0,KillBrickCount:0,HealAllyCount:0,HurtEnemyTankCount:0,MaxComboKill:0}},RoleBaseShowData:function(){return{Gender:0,Statistics:null}},RoleBaseCounterShowData:function(){return{SimpleBaseCounterShow:null}},RoleNoSaveData:function(){return{BanBeginTime:0,BanTerm:0}},LoginSyncData:function(){return{IsNew:0,ClientVersion:"",GLClientVer:"",SystemSoftware:"",SystemHardware:"",TelecomOper:"",Network:"",ScreenWidth:0,ScreenHight:0,Density:0,RegChannel:0,CpuHardware:"",Memory:0,GLRender:"",GLVersion:"",DeviceId:"",DeviceToken:"",LoginChannel:0,IsCrack:0,APPCertificate:"",MachineType:0}},CLIENT_MACHINE_TYPE:S},cc._RF.pop()},{}],star_cs:[function(e,t,n){"use strict";cc._RF.push(t,"49447c95k9BzpzUsxUy9lIk","star_cs");var i=cc.Enum({CS_CMD_SYS_MIN:21,CS_CMD_HEARTBEAT:22,CS_CMD_DISCONNECTED:24,CS_CMD_GM:26,CS_CMD_AUTH_RESULT:27,CS_CMD_SYS_MAX:50,CS_CMD_ROLE_INFO_MIN:51,CS_CMD_GET_ROLE_INFO:52,CS_CMD_LOGIN_SYNC_DATA:53,CS_CMD_MIDAS_PAY_TEST:54,CS_CMD_ERROR_NOTIFY:55,CS_CMD_ROLE_INFO_MAX:100,CS_CMD_GET_EVENT_LOG:101,CS_CMD_ADD_EVENT_LOG:102,CS_CMD_BATCH_HANDLE_EVENT_LOG:103,CS_CMD_EVENT_LOG_MAX:110,CS_SUB_BATTLE_MIN:200,CS_SUB_BATTLE_END_NOTIFY:204,CS_SUB_BATTLE_CREATE_ROOM:205,CS_SUB_BATTLE_ADD_ROOM:206,CS_SUB_BATTLE_LEAVE_ROOM:207,CS_SUB_BATTLE_REPORT_READY_STATUS:208,CS_SUB_BATTLE_OWNER_KICK_OUT:209,CS_SUB_BATTLE_GET_TEAM_INFO:210,CS_SUB_BATTLE_CHANGE_POS:211,CS_SUB_BATTLE_GAME_BEGIN:212,CS_SUB_BATTLE_ANOTHER_GAME:213,CS_SUB_BATTLE_ALLOW_AUTO_JOIN:214,CS_SUB_BATTLE_SEND_WX_GROUP_MSG:215,CS_SUB_BATTLE_MOVE_STOP:221,CS_SUB_BATTLE_MOVE_PATH:222,CS_SUB_BATTLE_SPELL_ACTION:223,CS_SUB_BATTLE_SPELL_HIT:224,CS_SUB_BATTLE_EFFECT_NOTIFY:225,CS_SUB_BATTLE_STATE_NOTIFY:226,CS_SUB_BATTLE_BUFF_OP:227,CS_SUB_BATTLE_ATTR_NOTIFY:228,CS_SUB_BATTLE_GET_OBJ:229,CS_SUB_BATTLE_REMOVE_OBJ:230,CS_SUB_BATTLE_PICK_ITEM:231,CS_SUB_BATTLE_CHANGE_BULLET:232,CS_SUB_BATTLE_STATISTIC:233,CS_SUB_BATTLE_EMOTION:234,CS_SUB_BATTLE_EXEC_BUFF_EFFECT:235,CS_SUB_BATTLE_BOX_HIT:236,CS_SUB_BATTLE_REVIVE:237,CS_SUB_BATTLE_ACTIVITY_GAME_NOTIFY:238,CS_SUB_BATTLE_MAX:300,CS_CMD_GET_WX_SESSION_INFO:1e3,CS_CMD_REPORT_ROLE_DISPLAY_INFO:1001,CS_CMD_GET_WX_QR_CODE:1002,CS_CMD_GET_TOTAL_FIGHT_RECORD:1003,CS_CMD_MIDAS_GET_BALANCE:1004,CS_CMD_WX_GROUP_RANK_LIST:1005,CS_CMD_NAME_PIC_LIST:1006,CS_CMD_UPLOAD_CLIENT_LOG:1007,CS_CMD_PCG_GAME_BEGIN:1008,CS_CMD_PCG_GAME_END:1009,CS_CMD_GET_ROLE_BASE_INFO:1010,CS_CMD_CSMSG_MAX:2e3}),a={T:0},o={T:[]},r={GMStr:""},s={P:[]},l={P:[]},c={P:[]},u={P:[]},d={Reserved:0},h={RoleCurRoomInfo:null},f={LoginSyncData:null},m={Reserved:0},y={Reserved:0},p={Reserved:0},g=cc.Enum({ROOM_COMMON:0,ROOM_JUNGLE:1,ROOM_JUMP:2,ROOM_IO:3}),C={RoomType:g.ROOM_COMMON,OpType:0},G={RoomType:0,RoomGuid:"",Port:null,RoomCreateTime:0},S={RoomGuid:"",Camp:0,Position:0},E={RoomGuid:""},T={GroupInfo:null,GroupMsgTicket:"",Query:""},w={Reserved:0},M={RoomType:g.ROOM_COMMON,RoomGuid:""},_={RoomType:0,RoomGuid:"",Port:null,RoomCreateTime:0},I={Camp:0,Position:0},B={RoomGuid:""},v=cc.Enum({LEAVE_REASON_SYSTEM:0,LEAVE_REASON_ACTIVE:1,LEAVE_REASON_BE_KICKED:2,LEAVE_REASON_ROOM_TIMEOUT:3,LEAVE_REASON_GAME_OVER:4,LEAVE_REASON_DISSOLVE_ROOM:5}),P={RoomGuid:""},R={RoomGuid:"",LeaveReason:0},A={ReadyStatus:0},D={ReadyStatus:0},b={AutoJoinStatus:0},U={AutoJoinStatus:0},L={KickedOpenId:""},N={KickedOpenId:""},k={RoomGuid:""},O={RoomLeftTime:0,RedCampRoleInfo:[],BlueCampRoleInfo:[],RoomType:0,RoomCreateTime:0},x={Winner:0,EndReason:0,FirstBlood:0,Statistic:null,RoomType:0,RoomGuid:"",Port:null},F={P:[]},H={P:[]},W={P:[],Tn:0,Ts:[]},Y={R:0},V=cc.Enum({CS_ONEEFFECT_TYPE_HURT:1}),J={CasterID:0,Total:0,Effects:[]},z={ObjNum:0,State:[]},K=cc.Enum({BUFF_OP_ADD:1,BUFF_OP_DEL:2,BUFF_OP_OVERLAY:3}),j={P:[]},X={ObjectID:0,BulletRes:0},q={P:[]},Q={Num:0,List:[]},Z={TriggerTime:0},$={P:[],ObjCnt:0,List:[]},ee={ObjCnt:0,List:[]},te={ObjID:0,ItemID:0},ne={ObjID:0,ItemID:0},ie={Reserve:0},ae={Statistic:null},oe={ObjID:0,EmotionID:0},re={BoxID:0,TargetID:0},se={Type:null,Time:0,Reason:null},le={Reserver:0},ce={Num:null,List:[]},ue={NotifyContent:""},de={Reserve:0},he={GameCount:0,WinGameCount:0,LostGameCount:0,KillCount:0,DeathCount:0,KillBrickCount:0,WeekGameCount:0,WeekWinGameCount:0,WeekLostGameCount:0,WeekKillCount:0,WeekDeathCount:0,WeekKillBrickCount:0,KillContinueCount:0,AddHPToTeamCount:0,AttackTankDmg:0},fe={WxCode:""},me={Openid:"",GameToken:""},ye=cc.Enum({REPORT_ROLE_DISPLAY_RESULT_SUCC:1,REPORT_ROLE_DISPLAY_RESULT_NORMAL_FAIL:2}),pe={ReportResult:0,Name:"",Pic:"",Gender:0,RawData:"",Signature:"",EncryptedData:"",iv:"",LoginSyncData:null},ge={Val:0,Num:0,Log:[]},Ce={Val:0},Ge={SystemType:0,LoginSync:null},Se={Reserve:0},Ee={SystemType:0,KillCount:0,Result:0,LoginSync:null},Te={Reserve:0},we={Reserve:0},Me=cc.Enum({ON_OFF_TYPE_QUICK_GAME:1,ON_OFF_TYPE_ACTIVITY_MODEL:2}),_e={OnOffSet:null,ClientHeartBeatTerm:0},Ie={Reserve:0},Be={B:0,L:0},ve={PortNum:0,PortList:[]},Pe={Reserve:0,PlatType:""},Re={RemainReviveTimes:0},Ae={ClientType:0,Num:0,OpenidList:[]},De={ClientType:0,Num:0,RoleRankInfoList:[]},be={ClientType:0,Num:0,OpenidList:[]},Ue={ClientType:0,Num:0,NamePicInfoList:[]},Le={V:0,C:0,CD:null},Ne={E:0,C:0,SD:null};t.exports={ProtoVersion:15,CS_CMD_TYPE:i,CSHeartBeatC:a,HEARTBEAT_RETURN_SIZE:2,CSHeartBeatS:o,CSReportResult:function(){return{Score:0,Result:0}},MAX_GM_STR:1024,CSGM:r,MOVESTOPC_PARAM_NUM:6,CSMoveStopNewC:s,CSMoveStopC:function(){return{ObjID:0,Seq:0,Speed:0,Dir:0,CurrPos:null}},MOVESTOPS_PARAM_NUM:6,CSMoveStopNewS:l,CSMoveStopS:function(){return{ObjID:0,Seq:0,Speed:0,Dir:0,CurrPos:null}},CS_MAX_PATH_COUNT:16,MOVEPATHC_PARAM_NUM:5,CSMovePathNewC:c,CSMovePathC:function(){return{ObjID:0,Seq:0,Speed:0,Point:null,Dir:0,Time:0}},CSMovePathNewS:u,CSMovePathS:function(){return{ObjID:0,Seq:0,Speed:0,Point:null,Dir:0,Time:0}},CSGetRoleInfoC:d,CSGetRoleInfoS:h,CSLoginSyncDataC:f,CSLoginSyncDataS:m,CSGameBeginC:y,CSGameBeginS:p,ROOM_TYPE:g,GroupInfo:function(){return{EncryptedData:"",Iv:""}},CSCreateRoomC:C,CSCreateRoomS:G,CSAddRoomC:S,CSAddRoomS:E,CSSendWxGroupMessageC:T,CSSendWxGroupMessageS:w,CSAnotherGameC:M,CSAnotherGameS:_,CSChangePosC:I,CSChangePosS:B,LEAVE_REASON:v,CSLeaveRoomC:P,CSLeaveRoomS:R,CSReportReadyStatusC:A,CSReportReadyStatusS:D,CSAllowAutoJoinC:b,CSAllowAutoJoinS:U,CSOwnerKickOutC:L,CSOwnerKickOutS:N,CSGetTeamInfoC:k,UserInfo:function(){return{OpenId:"",Name:"",Pic:"",Gender:0,Status:0,IsRoomOwner:0}},CSGetTeamInfoS:O,CSStartLoadMapNotify:function(){return{SyncTime:0,MapID:0}},CSFinishLoadMapC:function(){return{Reserved:0}},CSBattleBeginNotify:function(){return{SyncTime:0,BattleTime:0,MapID:0}},CSBattleEndNotify:x,CSSPELLACTIONC_PARAM_SIZE:4,CSSpellActionNewC:F,CSSpellActionC:function(){return{ObjID:0,SpellID:0,Seq:0,Dir:0}},CSSPELLACTIONS_PARAM_SIZE:6,CSSpellActionNewS:H,CSSpellActionS:function(){return{Ret:0,ObjID:0,SpellID:0,Seq:0,Dir:0,CDTime:0}},CS_MAX_RANGE_HITNUM:32,CS_MAX_EFFECT:32,CS_MAX_GRID_HITNUM:5,CSHitOne:function(){return{ObjID:0,GridNum:0,Grids:[]}},CSSPELLHITC_PARAM_SIZE:4,CSSpellHitNewC:W,CSSpellHitNewS:Y,CSSpellHitC:function(){return{ObjID:0,SpellID:0,Seq:0,TargetNum:0,Targets:[],Dir:0}},CsEffectType:V,CSEffectHurt:function(){return{Value:0,Die:0,Hp:0}},CSOneEffectData:function(e){switch(e){case V.CS_ONEEFFECT_TYPE_HURT:return{Hurt:null}}},CSOneEffect:function(){return{ObjID:0,EffectType:0,EffectData:null}},CSEffectNotify:J,MAX_STATE_NUM_BY_CHAR:32,CSStateS:function(){return{BitMap:[]}},MAX_STATE_NOTIFY_OBJ_NUM:32,CSStateOne:function(){return{ObjID:0,State:null}},CSStateNotify:z,BuffOp:K,CSBUFFOPNOTIFY_PARAM_SIZE:4,CSBuffOPNotifyNew:j,CSBuffOPNotify:function(){return{ObjectID:0,ResID:0,LeftTime:0,BuffOp:0}},CSChangeBullet:X,CSExecBuffEffectNew:q,CSExecBuffEffect:function(){return{ObjID:0,BuffResID:0,EffectIndex:0}},CSAttrChangeOne:function(){return{ObjID:0,AttrNum:0,AttrList:[]}},CSAttrNotify:Q,ObjBuffInfoNew:function(){return{P:[]}},ObjBuffInfo:function(){return{ResID:0,LeftTime:0}},MAP_OBJ_ID:1e6,PlayerObjNew:function(){return{P:[],Name:"",OpenId:"",Pic:"",An:0,Al:[],Bn:0,Bf:[],State:null}},PlayerObj:function(){return{ObjID:0,Name:"",OpenId:"",Pic:"",Pos:null,Dir:0,Type:0,ResID:0,CampID:0,AttrNum:0,AttrList:[],BuffNum:0,Buff:[],Bullet:0,State:null,RowNum:0,ColumnNum:0,CreateTime:0}},OtherObjNew:function(){return{P:[],An:0,Al:[]}},OtherObj:function(){return{ObjID:0,Pos:null,Dir:0,Type:0,ResID:0,CampID:0,GridState:0,AttrNum:0,AttrList:[],RowNum:0,ColumnNum:0,CreateTime:0,Mark:0}},CSGameObject:function(e){switch(e){case CS_OBJ_PLAYER:return{PlayerObj:null};case CS_OBJ_OTHER:return{OtherObj:null}}},CSObjOne:function(){return{Type:0,Object:null}},CSGetObjC:Z,CSGetObjSNew:$,CSGetObjS:function(){return{TriggerTime:0,SyncTime:0,BattleTime:0,MapID:0,CountTime:0,GameBeginTime:0,ObjCnt:0,List:[]}},CSRemoveObjS:ee,CSPickUpItemC:te,CSPickUpItemS:ne,CSGetStatisticC:ie,CSGetStatisticS:ae,CSEmotion:oe,CSBoxHit:re,CSGetEventLogC:se,CSActivityGameC:le,CSActivityGameOne:function(){return{ID:0,Open:null}},CS_MAX_GAME_MODEL:50,CSActivityGameS:ce,CSErrorNotifyS:ue,CSTotalFightRecordC:de,CSTotalFightRecordS:he,CSGetWxSessionInfoC:fe,CSGetWxSessionInfoS:me,REPORT_ROLE_DISPLAY_RESULT:ye,CSReportRoleDisplayInfoC:pe,MAX_UPLOAD_CLIENT_LOG_STR_SIZE:2048,MAX_UPLOAD_CLIENT_LOG_REFER_COUNT:100,CSUploadClientLogC:ge,CSUploadClientLogS:Ce,CSPcgGameBeginC:Ge,CSPcgGameBeginS:Se,CSPcgGameEndC:Ee,CSPcgGameEndS:Te,CSGetRoleBaseInfoC:we,ON_OFF_TYPE:Me,MAX_ON_OFF_LIST_NUM:10,OnOffInfo:function(){return{OnOffType:0,OnOrOff:0}},OnOffSet:function(){return{Num:0,OnOffList:[]}},CSGetRoleBaseInfoS:_e,CSDisconnectedS:Ie,CSAuthResultS:Be,MAX_PORT_NUM:10,CSReportRoleDisplayInfoS:ve,CSReviveC:Pe,CSReviveS:Re,MAX_WX_GROUP_OPENID_LIST_NUM:500,OpenidData:function(){return{O:""}},CSWxGroupRankListC:Ae,RoleRankInfo:function(){return{O:"",N:0,R:[]}},CSWxGroupRankListS:De,MAX_NAME_PIC_INFO_LIST_NUM:500,CSNamePicListC:be,RoleNamePicInfo:function(){return{O:"",N:"",P:""}},CSNamePicListS:Ue,CSDataC:function(e){switch(e){case i.CS_CMD_HEARTBEAT:return{HB:null};case i.CS_CMD_GET_ROLE_INFO:return{GetRoleInfo:null};case i.CS_CMD_LOGIN_SYNC_DATA:return{LoginSyncDataC:null};case i.CS_CMD_GM:return{GM:null};case i.CS_CMD_ADD_EVENT_LOG:return{AddEventLog:null};case i.CS_CMD_BATCH_HANDLE_EVENT_LOG:return{BatchHandleEventLog:null};case i.CS_CMD_GET_EVENT_LOG:return{GetEventLog:null};case i.CS_SUB_BATTLE_MOVE_STOP:return{MS:null};case i.CS_SUB_BATTLE_MOVE_PATH:return{MP:null};case i.CS_SUB_BATTLE_SPELL_ACTION:return{SA:null};case i.CS_SUB_BATTLE_SPELL_HIT:return{SH:null};case i.CS_SUB_BATTLE_GET_OBJ:return{GetObjList:null};case i.CS_SUB_BATTLE_PICK_ITEM:return{PickUpItem:null};case i.CS_SUB_BATTLE_CREATE_ROOM:return{CreateRoom:null};case i.CS_SUB_BATTLE_ANOTHER_GAME:return{AnotherGame:null};case i.CS_SUB_BATTLE_ADD_ROOM:return{AddRoom:null};case i.CS_SUB_BATTLE_CHANGE_POS:return{ChangePos:null};case i.CS_SUB_BATTLE_LEAVE_ROOM:return{LeaveRoom:null};case i.CS_SUB_BATTLE_REPORT_READY_STATUS:return{ReadyStatus:null};case i.CS_SUB_BATTLE_ALLOW_AUTO_JOIN:return{AllowAutoJoin:null};case i.CS_SUB_BATTLE_OWNER_KICK_OUT:return{OwnerKickOut:null};case i.CS_SUB_BATTLE_GAME_BEGIN:return{GameBegin:null};case i.CS_SUB_BATTLE_SEND_WX_GROUP_MSG:return{SendWxGroupMessage:null};case i.CS_SUB_BATTLE_GET_TEAM_INFO:return{GetTeamInfo:null};case i.CS_SUB_BATTLE_EMOTION:return{Emotion:null};case i.CS_SUB_BATTLE_EXEC_BUFF_EFFECT:return{ExecBuffEffect:null};case i.CS_SUB_BATTLE_BOX_HIT:return{BoxHit:null};case i.CS_SUB_BATTLE_ACTIVITY_GAME_NOTIFY:return{ActivityGame:null};case i.CS_SUB_BATTLE_STATISTIC:return{GetStatistic:null};case i.CS_SUB_BATTLE_REVIVE:return{Revive:null};case i.CS_CMD_MIDAS_GET_BALANCE:return{MidasGetBalance:null};case i.CS_CMD_MIDAS_PAY_TEST:return{MidasPayTest:null};case i.CS_CMD_GET_WX_SESSION_INFO:return{GetWxSessionInfo:null};case i.CS_CMD_REPORT_ROLE_DISPLAY_INFO:return{ReportRoleDisPlayInfo:null};case i.CS_CMD_GET_WX_QR_CODE:return{WxQrCodeInfo:null};case i.CS_CMD_GET_TOTAL_FIGHT_RECORD:return{TotalFightRecord:null};case i.CS_CMD_WX_GROUP_RANK_LIST:return{WxGroupRankList:null};case i.CS_CMD_NAME_PIC_LIST:return{NamePicList:null};case i.CS_CMD_UPLOAD_CLIENT_LOG:return{UpLoadClientLog:null};case i.CS_CMD_PCG_GAME_BEGIN:return{PcgGameBeginC:null};case i.CS_CMD_PCG_GAME_END:return{PcgGameEndC:null};case i.CS_CMD_GET_ROLE_BASE_INFO:return{GetRoleBaseInfo:null}}},CSDataS:function(e){switch(e){case i.CS_CMD_HEARTBEAT:return{HB:null};case i.CS_CMD_DISCONNECTED:return{Disconnected:null};case i.CS_CMD_GET_ROLE_INFO:return{GetRoleInfo:null};case i.CS_CMD_LOGIN_SYNC_DATA:return{LoginSyncDataS:null};case i.CS_CMD_GM:return{GM:null};case i.CS_CMD_AUTH_RESULT:return{AuthResult:null};case i.CS_CMD_ADD_EVENT_LOG:return{AddEventLog:null};case i.CS_CMD_BATCH_HANDLE_EVENT_LOG:return{BatchHandleEventLog:null};case i.CS_CMD_GET_EVENT_LOG:return{EventLogList:null};case i.CS_SUB_BATTLE_END_NOTIFY:return{BattleEnd:null};case i.CS_SUB_BATTLE_MOVE_STOP:return{MS:null};case i.CS_SUB_BATTLE_MOVE_PATH:return{MP:null};case i.CS_SUB_BATTLE_SPELL_ACTION:return{SA:null};case i.CS_SUB_BATTLE_EFFECT_NOTIFY:return{EffectNotify:null};case i.CS_SUB_BATTLE_STATE_NOTIFY:return{StateNotify:null};case i.CS_SUB_BATTLE_BUFF_OP:return{BuffNotify:null};case i.CS_SUB_BATTLE_ATTR_NOTIFY:return{AttrNotify:null};case i.CS_SUB_BATTLE_GET_OBJ:return{GL:null};case i.CS_SUB_BATTLE_REMOVE_OBJ:return{RemoveObj:null};case i.CS_SUB_BATTLE_CREATE_ROOM:return{CreateRoom:null};case i.CS_SUB_BATTLE_ANOTHER_GAME:return{AnotherGame:null};case i.CS_SUB_BATTLE_ADD_ROOM:return{AddRoom:null};case i.CS_SUB_BATTLE_CHANGE_POS:return{ChangePos:null};case i.CS_SUB_BATTLE_LEAVE_ROOM:return{LeaveRoom:null};case i.CS_SUB_BATTLE_REPORT_READY_STATUS:return{ReadyStatus:null};case i.CS_SUB_BATTLE_ALLOW_AUTO_JOIN:return{AllowAutoJoin:null};case i.CS_SUB_BATTLE_OWNER_KICK_OUT:return{OwnerKickOut:null};case i.CS_SUB_BATTLE_GAME_BEGIN:return{GameBegin:null};case i.CS_SUB_BATTLE_SEND_WX_GROUP_MSG:return{SendWxGroupMessage:null};case i.CS_SUB_BATTLE_PICK_ITEM:return{PickUpItem:null};case i.CS_SUB_BATTLE_GET_TEAM_INFO:return{GetTeamInfo:null};case i.CS_SUB_BATTLE_CHANGE_BULLET:return{ChangeBullet:null};case i.CS_SUB_BATTLE_EMOTION:return{Emotion:null};case i.CS_SUB_BATTLE_EXEC_BUFF_EFFECT:return{ExecBuffEffect:null};case i.CS_SUB_BATTLE_STATISTIC:return{GetStatistic:null};case i.CS_SUB_BATTLE_REVIVE:return{Revive:null};case i.CS_CMD_MIDAS_GET_BALANCE:return{MidasGetBalance:null};case i.CS_CMD_MIDAS_PAY_TEST:return{MidasPayTest:null};case i.CS_CMD_ERROR_NOTIFY:return{ErrorNotify:null};case i.CS_SUB_BATTLE_SPELL_HIT:return{SH:null};case i.CS_SUB_BATTLE_ACTIVITY_GAME_NOTIFY:return{ActivityGame:null};case i.CS_CMD_GET_WX_SESSION_INFO:return{GetWxSessionInfo:null};case i.CS_CMD_REPORT_ROLE_DISPLAY_INFO:return{ReportRoleDisplayInfo:null};case i.CS_CMD_GET_WX_QR_CODE:return{WxQrCodeInfo:null};case i.CS_CMD_GET_TOTAL_FIGHT_RECORD:return{TotalFightRecord:null};case i.CS_CMD_WX_GROUP_RANK_LIST:return{WxGroupRankList:null};case i.CS_CMD_NAME_PIC_LIST:return{NamePicList:null};case i.CS_CMD_UPLOAD_CLIENT_LOG:return{UpLoadClientLog:null};case i.CS_CMD_PCG_GAME_BEGIN:return{PcgGameBeginS:null};case i.CS_CMD_PCG_GAME_END:return{PcgGameEndS:null};case i.CS_CMD_GET_ROLE_BASE_INFO:return{GetRoleBaseInfo:null}}},CSMsgC:Le,CSMsgS:Ne,GetMsgCByID:function(e){switch(e){case i.CS_CMD_HEARTBEAT:return a.__msgid__=i.CS_CMD_HEARTBEAT,a;case i.CS_CMD_GET_ROLE_INFO:return d.__msgid__=i.CS_CMD_GET_ROLE_INFO,d;case i.CS_CMD_LOGIN_SYNC_DATA:return f.__msgid__=i.CS_CMD_LOGIN_SYNC_DATA,f;case i.CS_CMD_GM:return r.__msgid__=i.CS_CMD_GM,r;case i.CS_CMD_ADD_EVENT_LOG:return InteractEventLog.__msgid__=i.CS_CMD_ADD_EVENT_LOG,InteractEventLog;case i.CS_CMD_BATCH_HANDLE_EVENT_LOG:return BatchHandleEventLog.__msgid__=i.CS_CMD_BATCH_HANDLE_EVENT_LOG,BatchHandleEventLog;case i.CS_CMD_GET_EVENT_LOG:return se.__msgid__=i.CS_CMD_GET_EVENT_LOG,se;case i.CS_SUB_BATTLE_MOVE_STOP:return s.__msgid__=i.CS_SUB_BATTLE_MOVE_STOP,s;case i.CS_SUB_BATTLE_MOVE_PATH:return c.__msgid__=i.CS_SUB_BATTLE_MOVE_PATH,c;case i.CS_SUB_BATTLE_SPELL_ACTION:return F.__msgid__=i.CS_SUB_BATTLE_SPELL_ACTION,F;case i.CS_SUB_BATTLE_SPELL_HIT:return W.__msgid__=i.CS_SUB_BATTLE_SPELL_HIT,W;case i.CS_SUB_BATTLE_GET_OBJ:return Z.__msgid__=i.CS_SUB_BATTLE_GET_OBJ,Z;case i.CS_SUB_BATTLE_PICK_ITEM:return te.__msgid__=i.CS_SUB_BATTLE_PICK_ITEM,te;case i.CS_SUB_BATTLE_CREATE_ROOM:return C.__msgid__=i.CS_SUB_BATTLE_CREATE_ROOM,C;case i.CS_SUB_BATTLE_ANOTHER_GAME:return M.__msgid__=i.CS_SUB_BATTLE_ANOTHER_GAME,M;case i.CS_SUB_BATTLE_ADD_ROOM:return S.__msgid__=i.CS_SUB_BATTLE_ADD_ROOM,S;case i.CS_SUB_BATTLE_CHANGE_POS:return I.__msgid__=i.CS_SUB_BATTLE_CHANGE_POS,I;case i.CS_SUB_BATTLE_LEAVE_ROOM:return P.__msgid__=i.CS_SUB_BATTLE_LEAVE_ROOM,P;case i.CS_SUB_BATTLE_REPORT_READY_STATUS:return A.__msgid__=i.CS_SUB_BATTLE_REPORT_READY_STATUS,A;case i.CS_SUB_BATTLE_ALLOW_AUTO_JOIN:return b.__msgid__=i.CS_SUB_BATTLE_ALLOW_AUTO_JOIN,b;case i.CS_SUB_BATTLE_OWNER_KICK_OUT:return L.__msgid__=i.CS_SUB_BATTLE_OWNER_KICK_OUT,L;case i.CS_SUB_BATTLE_GAME_BEGIN:return y.__msgid__=i.CS_SUB_BATTLE_GAME_BEGIN,y;case i.CS_SUB_BATTLE_SEND_WX_GROUP_MSG:return T.__msgid__=i.CS_SUB_BATTLE_SEND_WX_GROUP_MSG,T;case i.CS_SUB_BATTLE_GET_TEAM_INFO:return k.__msgid__=i.CS_SUB_BATTLE_GET_TEAM_INFO,k;case i.CS_SUB_BATTLE_EMOTION:return oe.__msgid__=i.CS_SUB_BATTLE_EMOTION,oe;case i.CS_SUB_BATTLE_EXEC_BUFF_EFFECT:return q.__msgid__=i.CS_SUB_BATTLE_EXEC_BUFF_EFFECT,q;case i.CS_SUB_BATTLE_BOX_HIT:return re.__msgid__=i.CS_SUB_BATTLE_BOX_HIT,re;case i.CS_SUB_BATTLE_ACTIVITY_GAME_NOTIFY:return le.__msgid__=i.CS_SUB_BATTLE_ACTIVITY_GAME_NOTIFY,le;case i.CS_SUB_BATTLE_STATISTIC:return ie.__msgid__=i.CS_SUB_BATTLE_STATISTIC,ie;case i.CS_SUB_BATTLE_REVIVE:return Pe.__msgid__=i.CS_SUB_BATTLE_REVIVE,Pe;case i.CS_CMD_MIDAS_GET_BALANCE:return MidasGetBalanceC.__msgid__=i.CS_CMD_MIDAS_GET_BALANCE,MidasGetBalanceC;case i.CS_CMD_MIDAS_PAY_TEST:return MidasPayTestC.__msgid__=i.CS_CMD_MIDAS_PAY_TEST,MidasPayTestC;case i.CS_CMD_GET_WX_SESSION_INFO:return fe.__msgid__=i.CS_CMD_GET_WX_SESSION_INFO,fe;case i.CS_CMD_REPORT_ROLE_DISPLAY_INFO:return pe.__msgid__=i.CS_CMD_REPORT_ROLE_DISPLAY_INFO,pe;case i.CS_CMD_GET_WX_QR_CODE:return WxQrCodeInfoC.__msgid__=i.CS_CMD_GET_WX_QR_CODE,WxQrCodeInfoC;case i.CS_CMD_GET_TOTAL_FIGHT_RECORD:return de.__msgid__=i.CS_CMD_GET_TOTAL_FIGHT_RECORD,de;case i.CS_CMD_WX_GROUP_RANK_LIST:return Ae.__msgid__=i.CS_CMD_WX_GROUP_RANK_LIST,Ae;case i.CS_CMD_NAME_PIC_LIST:return be.__msgid__=i.CS_CMD_NAME_PIC_LIST,be;case i.CS_CMD_UPLOAD_CLIENT_LOG:return ge.__msgid__=i.CS_CMD_UPLOAD_CLIENT_LOG,ge;case i.CS_CMD_PCG_GAME_BEGIN:return Ge.__msgid__=i.CS_CMD_PCG_GAME_BEGIN,Ge;case i.CS_CMD_PCG_GAME_END:return Ee.__msgid__=i.CS_CMD_PCG_GAME_END,Ee;case i.CS_CMD_GET_ROLE_BASE_INFO:return we.__msgid__=i.CS_CMD_GET_ROLE_BASE_INFO,we;default:return null}},GetMsgSByID:function(e){switch(e){case i.CS_CMD_HEARTBEAT:return o;case i.CS_CMD_DISCONNECTED:return Ie;case i.CS_CMD_GET_ROLE_INFO:return h;case i.CS_CMD_LOGIN_SYNC_DATA:return m;case i.CS_CMD_GM:return r;case i.CS_CMD_AUTH_RESULT:return Be;case i.CS_CMD_ADD_EVENT_LOG:return InteractEventLog;case i.CS_CMD_BATCH_HANDLE_EVENT_LOG:return BatchHandleEventLog;case i.CS_CMD_GET_EVENT_LOG:return InteractEventLogList;case i.CS_SUB_BATTLE_END_NOTIFY:return x;case i.CS_SUB_BATTLE_MOVE_STOP:return l;case i.CS_SUB_BATTLE_MOVE_PATH:return u;case i.CS_SUB_BATTLE_SPELL_ACTION:return H;case i.CS_SUB_BATTLE_EFFECT_NOTIFY:return J;case i.CS_SUB_BATTLE_STATE_NOTIFY:return z;case i.CS_SUB_BATTLE_BUFF_OP:return j;case i.CS_SUB_BATTLE_ATTR_NOTIFY:return Q;case i.CS_SUB_BATTLE_GET_OBJ:return $;case i.CS_SUB_BATTLE_REMOVE_OBJ:return ee;case i.CS_SUB_BATTLE_CREATE_ROOM:return G;case i.CS_SUB_BATTLE_ANOTHER_GAME:return _;case i.CS_SUB_BATTLE_ADD_ROOM:return E;case i.CS_SUB_BATTLE_CHANGE_POS:return B;case i.CS_SUB_BATTLE_LEAVE_ROOM:return R;case i.CS_SUB_BATTLE_REPORT_READY_STATUS:return D;case i.CS_SUB_BATTLE_ALLOW_AUTO_JOIN:return U;case i.CS_SUB_BATTLE_OWNER_KICK_OUT:return N;case i.CS_SUB_BATTLE_GAME_BEGIN:return p;case i.CS_SUB_BATTLE_SEND_WX_GROUP_MSG:return w;case i.CS_SUB_BATTLE_PICK_ITEM:return ne;case i.CS_SUB_BATTLE_GET_TEAM_INFO:return O;case i.CS_SUB_BATTLE_CHANGE_BULLET:return X;case i.CS_SUB_BATTLE_EMOTION:return oe;case i.CS_SUB_BATTLE_EXEC_BUFF_EFFECT:return q;case i.CS_SUB_BATTLE_STATISTIC:return ae;case i.CS_SUB_BATTLE_REVIVE:return Re;case i.CS_CMD_MIDAS_GET_BALANCE:return MidasGetBalanceS;case i.CS_CMD_MIDAS_PAY_TEST:return MidasPayTestS;case i.CS_CMD_ERROR_NOTIFY:return ue;case i.CS_SUB_BATTLE_SPELL_HIT:return Y;case i.CS_SUB_BATTLE_ACTIVITY_GAME_NOTIFY:return ce;case i.CS_CMD_GET_WX_SESSION_INFO:return me;case i.CS_CMD_REPORT_ROLE_DISPLAY_INFO:return ve;case i.CS_CMD_GET_WX_QR_CODE:return WxQrCodeInfoS;case i.CS_CMD_GET_TOTAL_FIGHT_RECORD:return he;case i.CS_CMD_WX_GROUP_RANK_LIST:return De;case i.CS_CMD_NAME_PIC_LIST:return Ue;case i.CS_CMD_UPLOAD_CLIENT_LOG:return Ce;case i.CS_CMD_PCG_GAME_BEGIN:return Se;case i.CS_CMD_PCG_GAME_END:return Te;case i.CS_CMD_GET_ROLE_BASE_INFO:return _e;default:return null}}},cc._RF.pop()},{}],star_macro:[function(e,t,n){"use strict";cc._RF.push(t,"f6c455jhtZHF7U/mqUjCCDk","star_macro");var i=cc.Enum({RET_CODE_NOERR:0,RET_CODE_DISCONNECTED_REASON_OTHER_LOGIN:10001,RET_CODE_DISCONNECTED_REASON_SERVER_FULL:10002,RET_CODE_DISCONNECTED_REASON_NO_LINK:10003,RET_CODE_NO_ROLE_INDB:10004,RET_CODE_BAD_ROLE_INDB:10005,RET_CODE_ROLE_EXSIT_INDB:10006,RET_CODE_CLIENT_VERSION_TOO_OLD:10007,RET_CODE_CLIENT_VERSION_TOO_NEW:10008,RET_CODE_NO_ROLE_UIN:10009,RET_CODE_GET_GID_ERR:10010,RET_CODE_INSERT_ROLEKEY_ERR:10011,RET_CODE_UNPACK_ERR:10012,RET_CODE_OPEN_ID_IS_EMPTY:10013,RET_CODE_FAIL_GET_SIMPLE_DATA:10014,RET_CODE_DELETE_ROLEKEY_ERR:10015,RET_CODE_IDLE_TOO_LONG:10016,RET_CODE_MSG_FREQUENCY_TOO_FAST:10017,RET_CODE_DB_QUERY_NOT_FOUND:10018,RET_CODE_DB_QUERY_ERROR:10019,RET_CODE_DB_INSERT_EXIST:10020,RET_CODE_DB_INSERT_ERROR:10021,RET_CODE_DB_DELETE_ERROR:10022,RET_CODE_DB_INVALID_VERSION:10023,RET_CODE_INPUT_ERR:10024,RET_CODE_EXIST_ROOM:11001,RET_CODE_ROOM_TYPE_ERR:11002,RET_CODE_ROOM_POSITION_NOT_EMPTY:11003,RET_CODE_CAN_NOT_KICK_OUT:11004,RET_CODE_SYNC_ROOM_LIMIT:11005,RET_CODE_SYNC_CREATE_ROOM_FAIL:11006,RET_CODE_SYNC_ROOM_NOT_EXIST:11007,RET_CODE_CAN_NOT_KICK_OUT_SELF:11010,RET_CODE_INVALID_OP:11011,RET_CODE_ROOM_FULL:11012,RET_CODE_NOT_IN_THE_ROOM:11013,RET_CODE_ALREADY_IN_THIS_POS:11014,RET_CODE_TOKEN_DIFF_IN_SVR_AUTH:11015,RET_CODE_FIGHTING_ROOM_NOT_EXIST:11016,RET_CODE_CANT_REVIVE_FOR_ROOM_NOT_EXIST:11017,RET_CODE_CANT_REVIVE_FOR_NOT_IN_GAME_STAT:11018,RET_CODE_CAN_NOT_BEGIN_GAME:11019,RET_CODE_NOT_ALL_READY:11020,RET_CODE_OTHER_SIDE_IS_EMPTY:11021,RET_CODE_CONNIDX_NULL_ON_SHORT_SVR_AUTH:11022,RET_CODE_SEND_TO_DB_FAILED_ON_SHORT_SVR_AUTH:11023,RET_CODE_SEND_TO_MPROXY_FAILED_ON_GET_WX_SESSION_INFO:11024,RET_CODE_QUERY_SEND_TO_DB_FAILED_ON_GET_WX_SESSION_INFO:11025,RET_CODE_INVALID_OPENID_ON_GET_WX_SESSION_INFO:11026,RET_CODE_INSERT_SEND_TO_DB_FAILED_ON_GET_WX_SESSION_INFO:11027,RET_CODE_MPROXY_RET_ERR_GET_WX_SESSION_INFO:11028,RET_CODE_SEND_TO_DB_FAILED_ON_LONG_SVR_AUTH:11029,RET_CODE_PLAYER_NULL_ON_SHORT_SVR_AUTH:11030,RET_CODE_LOGIN_LIMIT_ON_SVR_AUTH:11031,RET_CODE_LOGIN_BAN_ON_SVR_AUTH:11032,RET_CODE_DB_NO_NEED_MODIFY:11033,RET_CODE_UNPACK_ERROR:11034,RET_CODE_CAN_NOT_SET_AUTO_JOIN_ROOM:11035,RET_CODE_GAME_MODEL_NOT_OPEN:11036}),a=cc.Enum({TCONND_STOP_REASON_DB_RECORD_ERROR:1e4,TCONND_STOP_REASON_DB_RECORD_NOT_EXIST:10001,TCONND_STOP_REASON_SHORT_SVR_IS_FULL:10002}),o=cc.Enum({YES:1,NO:0}),r=cc.Enum({STATISTICS_TYPE_GAME_COUNT:1,STATISTICS_TYPE_WIN_GAME_COUNT:2,STATISTICS_TYPE_LOST_GAME_COUNT:3,STATISTICS_TYPE_KILL_COUNT:4,STATISTICS_TYPE_DEATH_COUNT:5,STATISTICS_TYPE_KILL_BRICK_COUNT:6,STATISTICS_TYPE_HEAL_ALLY_COUNT:7,STATISTICS_TYPE_HURT_ENEMY_TANK_COUNT:8,STATISTICS_TYPE_MAX_COMBO_KILL:9}),s=cc.Enum({SYSTEM_TYPE_NONE:0,SYSTEM_TYPE_ANDROID:1,SYSTEM_TYPE_IOS:2,SYSTEM_TYPE_PC:3}),l=cc.Enum({CLIENT_TYPE_WX_GROUP_RANK_INTERFACE:1}),c=cc.Enum({GLOBAL_VALUE_TYPE_QUICK_GAME_ON_OFF:47,GLOBAL_VALUE_TYPE_ACTIVITY_MODEL_ON_OFF:48,GLOBAL_VALUE_TYPE_CLIENT_HEART_BEART_TERM:49});t.exports={ProtoVersion:15,MIN_CLIENT_VERSION_TO_COMPATIBLE:0,RET_CODE:i,TCONND_STOP_REASON:a,MAX_CLT_PKG_DATA:256e3,MAX_SVR_PKG_DATA:512e3,MAX_ZIP_BUFF_LEN:2e5,MAX_CLIENT_ZIP_BUFF_LEN:48e3,MAX_SSMSG_DATA:256e3,MAX_STR_1024_LEN:1024,MAX_NORMAL_STR:512,MAX_STR_LEN:128,MAX_STR_64_LEN:64,MAX_STR_32_LEN:32,MAX_STR_128_LEN:128,MAX_STR_256_LEN:256,MAX_NICK_NAME_LEN:32,MAX_DESC_LEN:200,MAX_IP_STR_LEN:32,MAX_URL_STR_LEN:128,MAX_RELATIVE_PATH_LEN:512,MAX_FILE_NAME_LEN:64,MAX_CHAT_MSG_LEN:256,MAX_PASSWD_LEN:16,MAX_MODE_MATCH_SVR_NUM:5,MAX_OPENID_LEN:64,MAX_APPID_LEN:64,MAX_APPKEY_LEN:64,MAX_MSDK_URL_LEN:256,MAX_TOKEN_LEN:128,MAX_MSDK_NAME_LEN:128,YI_WAN_VALUE:1e4,YI_QIAN_VALUE:1e3,BOOL_:o,STATISTICS_TYPE_MAX:6,STATISTICS_TYPE:r,MAX_INT_VALUE:2147483647,SYSTEM_TYPE:s,CLIENT_TYPE:l,GLOBAL_VALUE_TYPE:c},cc._RF.pop()},{}],star_table:[function(e,t,n){"use strict";cc._RF.push(t,"fde2eAvlkNGdIweJvyU+Qnz","star_table");var i=cc.Enum({HARD_CODE_TYPE_LOGIN_MOD_X:1,HARD_CODE_TYPE_LOGIN_REMAINDER_Y:2,HARD_CODE_TYPE_ROLE_IN_DB_TRY_TIMES:3,HARD_CODE_TYPE_SYS_COMM_DB_TRY_TIMES:4,HARD_CODE_TYPE_MSG_MONITOR_ONOFF:5,HARD_CODE_TYPE_SESSION_KEY_ACTIVE_TIME:6,HARD_CODE_TYPE_IS_OPEN_PAY:7}),a=cc.Enum({BET_NONE:0,BET_CHANGE_ATTR:1,BET_FLUSH_MOVE_ALLOW:2,BET_FLUSH_MOVE_EXEC:3,BET_HIDE_ALLOW:4,BET_HIDE_EXEC:5,BET_CHANGE_BULLET:6,BET_LASER_ALLOW:7,BET_LASER_EXEC:8,BET_SKILL_PARAM1:9,BET_SKILL_PARAM2:10}),o=cc.Enum({BR_SPELL_ACTION:1}),r=cc.Enum({SCHEDULE_LOOP_TYPE_NONE:0,SCHEDULE_LOOP_TYPE_DAY:1,SCHEDULE_LOOP_TYPE_WEEK:2,SCHEDULE_LOOP_TYPE_MONTH:3,SCHEDULE_LOOP_TYPE_YEAR:4}),s=cc.Enum({GM_NORMAL:0,GM_ADVANCE:1}),l=cc.Enum({GM_CON_BATTLE:0,GM_CON_OUT_ROOM:1,GM_CON_IN_ROOM:2,GM_CON_ANY:3}),c=cc.Enum({GM_CMD_TYPE_GET_ITEM:0,GM_CMD_TYPE_ATTR:1,GM_CMD_TYPE_CREATE_ITEM:2,GM_CMD_TYPE_M_WINCOUNT:3,GM_CMD_TYPE_M_KILLCOUNT:4,GM_CMD_TYPE_M_BLOCKCOUNT:5,GM_CMD_TYPE_OPEN_GUIDE:6,GM_CMD_TYPE_SELECT_SERVER:7,GM_CMD_TYPE_SELECT_MAP:8,GM_CMD_TYPE_SELECT_TANK:9,GM_CMD_TYPE_ADD_BUFF:10,GM_CMD_TYPE_DEL_BUFF:11,GM_CMD_TYPE_OPEN_ACTIVITY:12,GM_CMD_TYPE_SET_BULLET:13,GM__CMD_TYPE_DIAMOND:14}),u=cc.Enum({GM_ACTION:0});t.exports={ProtoVersion:15,HARD_CODE_TYPE:i,MAX_RES_HARD_CODE_NUM:100,ResHardCode:function(){return{Type:0,Value:0,Desc:""}},RES_ID_ARRAY:1,MAX_RES_SVR_HARDCODE_NUM:100,MAX_RES_SVR_HARDCODE_OPTION:10,MAX_RES_SVR_HARDCODE_STR_LEN:256,SvrHardCodeOption:function(){return{ID:0,Value:[],String:""}},SvrHardCodeOptionTab:function(){return{Total:0,SvrHardCodeOption:[]}},MAX_RES_GLOBAL_NUM:500,ResGlobalConf:function(){return{ID:0,Value:0}},MAX_RES_MAP_ROW_NUM:1e3,MAX_RES_MAP_COLUMN_NUM:13,ResMapConf:function(){return{ID:0,RowId:0,ColumnList:[]}},MAX_RES_SMALL_GRID_NUM:4,MAX_RES_TILE_NUM:100,ResTileConf:function(){return{ID:0,isExistObject:[]}},MAX_RES_MAP_NUM:50,ResMapDesc:function(){return{ID:0,Width:0,Height:0,Border:0,Ground:0,ResTankID:0}},MAX_RES_DROP_NUM:1e3,MAX_DROP_ITEM_NUM:6,ResDropItem:function(){return{ItemID:0,Weight:0}},ResItemDropConf:function(){return{ID:0,MapId:0,Time:0,X1:0,Y1:0,X2:0,Y2:0,DropType:0,DropItems:[],TotalWeight:0,Mark:0}},MAX_RES_TANK_NUM:10,ResTank:function(){return{ID:0,HP:0,CD:0,ButtleNum:0,ButtleInt:0,MoveSpeed:0,ButtleID:0,StartSpeed:0,StartSpeedTime:0,MidSpeed:0,MidSpeedTime:0}},MAX_RES_EVENT_TRIGGER_NUM:100,EventTrigger:function(){return{ID:0,MapId:0,TriggerCondition:0,ConditionPara:0,BuffId:0,ObjectRange:0}},MAX_RES_EFFRESCFG_NUM:100,MAX_EFFRESCFG_TEXT_LEN:512,EffResCfg:function(){return{ID:0,H:"",M:"",L:"",Cnt:0}},MAX_RES_TIPS_NUM:100,ResTips:function(){return{ID:0,Type:0,Icon:"",Desc:""}},MAX_RES_PROGRAMEFFCFG_NUM:100,ProgramEffCfg:function(){return{ID:0,H:0,M:0,L:0}},MAX_RES_BULLET_NUM:20,MAX_BULLET_RESOURCE_LEN:256,ResBullet:function(){return{ID:0,Atk:0,Speed:0,Dist:0,BoxX:0,BoxY:0,HurtRange:0,Type:0,Pic:"",BoxPic:"",Column:0,Angle:0,BlueFort:"",BlueChassis:"",BlueCannon:"",RedFort:"",RedChassis:"",RedCannon:"",ShiftingX:0,ShiftingY:0,IsRebound:0,ReboundCnt:0,ReboundType:0}},MAX_RES_ITEM_NUM:20,MAX_ITEM_PARAM_NUM:5,MAX_ITEM_RESOURCE_LEN:256,ResItem:function(){return{ID:0,Resource:"",Type:0,Param:[],BuffId:0}},MAX_RES_BORN_POS_NUM:20,MAX_RES_CAMP_POS_NUM:3,ResPos:function(){return{x:0,y:0}},ResBornPos:function(){return{ID:0,BattleTime:0,RebornTime:0,MaxItemNum:0,RedBorn:[],BlueBorn:[]}},MAX_RES_RANK_NAME_NUM:1e3,MAX_STR_RANDOMNAMES_LEN:32,ResRandomNamesA:function(){return{Name:""}},ResRandomNamesB:function(){return{Name:""}},ResRandomNamesC:function(){return{Name:""}},MAX_RES_BUFF_NUM:100,MAX_BUFF_RESOURCE_LEN:256,MAX_BUFF_PARAM_NUM:5,MAX_BUFF_EFFECT:5,BuffEffectType:a,ResBuffEffect:function(){return{Type:0,Param:[],Resource:""}},BuffRemoveType:o,ResBuffRemove:function(){return{Type:0,Param:[]}},ResBuff:function(){return{ID:0,Resource:"",Time:0,EffectType:0,ReviveRemove:0,Param:[],BuffGroup:0,Priority:0,Effects:[],Remove:null}},MAX_RES_MAP_ERASE_NUM:100,ResMapErase:function(){return{ID:0,X:0,Y:0,Camp:0}},MAX_RES_BRICK_DROP_NUM:100,MAX_BRICK_DROP_POS_LEN:512,ResBrickDropConf:function(){return{ID:0,MapId:0,Pos:""}},MAX_RES_CHEST_NUM:100,MAX_RESOURCE_LEN:256,MAX_CHEST_DROP_ITEM_NUM:6,ResChest:function(){return{ID:0,HP:0,Resource:"",ChestItems:[]}},MAX_RES_GUIDE_NUM:100,MAX_GUIDE_PARAM_NUM:5,MAX_GUIDE_TEXT_LEN:512,ResGuide:function(){return{ID:0,Type:0,Param:[],Text:"",Time:0,NextID:0}},MAX_WHITE_LIST_NUM:100,ResWhiteList:function(){return{ID:0,Openid:"",RTX:""}},MAX_RES_BATCHMSG_PARAM:1,ResBatchMsgParam:function(){return{ID:0,Swtich:0,MsgCnt:0,HighTickInt:0,MidTickInt:0,LowTickInt:0}},MAX_RES_CLIENT:500,ResClient:function(){return{ID:0,Context:""}},MAX_SCHEDULE_NUM:4,MAX_RES_GAME_MODEL:50,MAX_WX_INVITE_PIC_LEN:128,MAX_WX_INVITE_WORD_LEN:128,ResGameModel:function(){return{ID:0,ModelName:"",PicName:"",ScaleShow:"",ScaleLimit:0,Weight:0,IsDisplay:0,MapId:0,PicUrl:"",NameUrl:"",Desc:"",CloseDesc:"",OpenAlways:0,ScheduleID:[],WxInvitePic:"",WxInviteWord:""}},MAX_RES_SCHEDULE_NUM:100,MAX_WEEK_DAYS_NUM:7,SCHEDULE_LOOP_TYPE:r,ResSchedule:function(){return{ID:0,StartYear:0,StartMonth:0,StartDate:0,EndYear:0,EndMonth:0,EndDate:0,StartHour:0,StartMinute:0,EndHour:0,EndMinute:0,LoopType:0,WeekDays:[],Offset:0}},MAX_ITEM_BUFFER_DATA_LIST:5,ResItemBuffer:function(){return{ID:0,Type:0,Map:0,DataList:[]}},MAX_GM_PARAM_NUM:3,GMClassType:s,GMConditionType:l,GMCmdType:c,GMActionType:u,ResGMCmd:function(){return{ID:0,GMClass:0,GMCondition:0,Desc:"",CmdType:0,Param:[],GMExecuteType:0,GMCmdString:""}}},cc._RF.pop()},{}],weixininterface:[function(e,t,n){"use strict";function i(e,t,n,i,a){if(C.globalUserState.userState_Cache===t)console.log("getUserInfoCallback userState_Cache");else if(C.globalUserState.userState_Setting===t)!0===n?console.log("getUserInfoCallback userState_Setting success"):console.log("getUserInfoCallback userState_Setting fail "+i.errMsg);else if(C.globalUserState.userState_Auth===t)!0===n?console.log("getUserInfoCallback userState_Auth success"):(""===(o=C.getOpenID())?!0===v?g():S.onSetUserInfoFailed(S.globalSessionState.sessionState_AuthRefuse):S.onSendUserInfo(S.globalSessionState.sessionState_AuthRefuse),console.log("getUserInfoCallback userState_Auth fail "+i.errMsg));else if(C.globalUserState.userState_UserInfo===t)if(!0===n){var o=C.getOpenID();if(console.log("getUserInfoCallback userState_UserInfo true openid:"+o+" isSessionValid:"+a),""===o&&!0===v)return void(!0===a&&g());(1===S.onIsSendUserInfo()&&!1===v||!0===v)&&S.onSendUserInfo(e)}else console.log("getUserInfoCallback userState_UserInfo false openid:"+o+" isSessionValid:"+a),""===(o=C.getOpenID())?!0===v?!0===a&&g():S.onSetUserInfoFailed(S.globalSessionState.sessionState_UserInfoFailed):S.onSendUserInfo(S.globalSessionState.sessionState_UserInfoFailed),console.log("getUserInfoCallback userState_UserInfo fail "+i.errMsg)}function a(e,t,n){if(C.globalLoginState.loginState_Session===e)!0===t?(console.log("checkSession session 未过期"),v=!0):(console.log("checkSession session 已过期, 开始重新登录..."),v=!1);else if(C.globalLoginState.loginState_Login===e)if(!0===t)console.log("登录成功"),console.log(n),S.onLogin(n.code);else{console.log("登录失败"+n.errMsg);var i=window.GGameEntry.ResTableMgr.GetConfigByID(_.star_client_c,51).Context;window.GGameEntry.UIManager.ShowMsgBox(i)}else C.globalLoginState.loginState_ShareInfo===e&&(!0===t?console.log("loginResult->getShareInfo success."):console.log("loginResult->getShareInfo failed."))}function o(){C.wxlogin(a)}function r(e){return window.GGameEntry.NotificationCenter.emit("onChangeBtnState",{bShow:!0}),!window.GGameEntry.GBattleNetwork.IsConnected()&&!S.getPlayerRankFlag()}function s(){var e=G.getShortSocketURL();M.IsValidUrl(e)?o():setTimeout(function(){console.log("onGetRankInfo url:"+e),o()},5e3)}function l(){if(console.log("onGetRankInfo."),E.IsWeichatGame()){console.error("##onGetRankInfo");var e=window.GGameEntry.ResTableMgr.GetConfigByID(_.star_client_c,11).Context;C.onShowLoadingState("logining...",15e3,e,r),window.GGameEntry.UIManager.HideUI(T.UIType.RankUI),window.GGameEntry.NotificationCenter.emit("onChangeBtnState",{bShow:!1}),window.GGameEntry.CurGamePlayType=w.GamePlayType.GamePlayType_Network,S.onQueryQunRankInfo()}}function c(e){console.log("hideSpecialUI"),void 0!==e&&Object.keys(e).length>0&&(window.GGameEntry.UIManager.HideUI(T.UIType.RankUI),window.GGameEntry.UIManager.HideUI(T.UIType.RecordUI),window.GGameEntry.UIManager.HideUI(T.UIType.ShopUI))}function u(e){m()&&(window.GGameEntry.CurGamePlayType===w.GamePlayType.GamePlayType_Single&&(window.GGameEntry.BattleSystem.IsPlaying()||window.GGameEntry.BattleSystem.IsPause()||window.GGameEntry.BattleSystem.IsMapLoading())&&(window.GGameEntry.BattleSystem.ExitBattle(!1),console.log("showGameCallBack connected invited to join room Single battle exit first.")),window.GGameEntry.BattleSystem.IsInRooming()||(console.log("showGameCallBack connected invited to join room and not in room."),window.GGameEntry.CurGamePlayType=w.GamePlayType.GamePlayType_Network,I.SetGameMode(I.GM.GameMode_PVPPlayer),G.setLongSocketURL(e.url),o()))}function d(e){if(console.log("checkInviteIsOutOfDate lanuchInfo:",e),void 0!==e&&Object.keys(e).length>0)if(void 0!==e.time){var t=Date.now()/1e3,n=parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(_.star_global_cs,5).Value),i=parseInt(window.GGameEntry.ResTableMgr.GetConfigByID(_.star_global_cs,46).Value),a=0;if(a=0===n||0===i?720:n+i,console.log("checkInviteIsOutOfDate time:"+a+" now:"+t+" lanuchInfo.time:"+e.time),t-e.time>=a)return!0}else console.log("checkInviteIsOutOfDate lanuchInfo.time is undefined.");else console.log("checkInviteIsOutOfDate lanuchInfo is undefined.");return!1}function h(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(console.log("showGameCallBack scene:"+t),console.log(n),!1===i){if(y(n)){if(window.GGameEntry.BattleSystem.IsPlaying()||window.GGameEntry.BattleSystem.IsPause()||window.GGameEntry.BattleSystem.IsMapLoading()||window.GGameEntry.BattleSystem.IsInRooming())if(window.GGameEntry.CurGamePlayType===w.GamePlayType.GamePlayType_Single)window.GGameEntry.BattleSystem.ExitBattle(!1),console.log("showGameCallBack in pve gaming, exitBattle to show RankUI.");else if(window.GGameEntry.CurGamePlayType===w.GamePlayType.GamePlayType_Network){a=window.GGameEntry.ResTableMgr.GetConfigByID(_.star_client_c,52).Context;return void window.GGameEntry.UIManager.ShowMsgBox(a)}return e("QunUserDataMgr").setShareUserData(n),void l()}if(c(n),S.onSetInviteInfo(n),d(n)){if(window.GGameEntry.CurGamePlayType===w.GamePlayType.GamePlayType_Network&&void 0!==n&&Object.keys(n).length>0&&(window.GGameEntry.BattleSystem.IsPlaying()||window.GGameEntry.BattleSystem.IsPause()||window.GGameEntry.BattleSystem.IsMapLoading())){console.log("showGameCallBack connected isPlaying:"+window.GGameEntry.BattleSystem.IsPlaying()+" isPause:"+window.GGameEntry.BattleSystem.IsPause());a=window.GGameEntry.ResTableMgr.GetConfigByID(_.star_client_c,52).Context;return window.GGameEntry.UIManager.ShowMsgBox(a),void S.onSetInviteInfo({})}console.log("showGameCallBack link is out of date.",n);a=window.GGameEntry.ResTableMgr.GetConfigByID(_.star_client_c,53).Context;return void window.GGameEntry.UIManager.ShowMsgBox(a,200)}}if(window.GGameEntry.GBattleNetwork.IsConnected())if(window.GGameEntry.CurGamePlayType===w.GamePlayType.GamePlayType_Network&&void 0!==n&&Object.keys(n).length>0)if(window.GGameEntry.BattleSystem.IsPlaying()||window.GGameEntry.BattleSystem.IsPause()||window.GGameEntry.BattleSystem.IsMapLoading()){console.log("showGameCallBack connected isPlaying:"+window.GGameEntry.BattleSystem.IsPlaying()+" isPause:"+window.GGameEntry.BattleSystem.IsPause());a=window.GGameEntry.ResTableMgr.GetConfigByID(_.star_client_c,52).Context;window.GGameEntry.UIManager.ShowMsgBox(a),S.onSetInviteInfo({})}else window.GGameEntry.BattleSystem.IsSettle()?(window.GGameEntry.BattleSystem.ExitBattle(!1),m()&&(console.log("showGameCallBack connected invited to room from SettleUI."),window.GGameEntry.CurGamePlayType=w.GamePlayType.GamePlayType_Network,I.SetGameMode(I.GM.GameMode_PVPPlayer),G.setLongSocketURL(n.url),o())):n.roomid!==S.onGetRoomGuid()?(console.log("showGameCallBack connected leave old room, join new room."),S.onSetLeaveRoomState(S.globalLeaveRoomState.LeaveState_JoinNewRoom),G.setLongSocketURL(n.url),"0"===S.onGetRoomGuid()?(S.onSetInviteInfo({}),S.onJoinRoom(n.roomid,-1,-1)):S.onLeaveRoom()):(u(n),console.log("showGameCallBack connected do nothing."));else u(n),console.log("showGameCallBack connected do nothing.",window.GGameEntry.CurGamePlayType);else if(void 0!==n&&Object.keys(n).length>0)if(m()){if(window.GGameEntry.CurGamePlayType===w.GamePlayType.GamePlayType_Single&&(window.GGameEntry.BattleSystem.IsPlaying()||window.GGameEntry.BattleSystem.IsPause()||window.GGameEntry.BattleSystem.IsMapLoading()))return window.GGameEntry.BattleSystem.ExitBattle(!1),window.GGameEntry.CurGamePlayType=w.GamePlayType.GamePlayType_Network,I.SetGameMode(I.GM.GameMode_PVPPlayer),G.setLongSocketURL(n.url),o(),void console.log("showGameCallBack not connected invited to room, in single game.");if(window.GGameEntry.BattleSystem.IsSettle()&&(window.GGameEntry.BattleSystem.ExitBattle(!1),console.log("showGameCallBack not connected IsSettle.")),window.GGameEntry.BattleSystem.IsPlaying()||window.GGameEntry.BattleSystem.IsPause()||window.GGameEntry.BattleSystem.IsMapLoading()){console.log("showGameCallBack not connected isPlaying:"+window.GGameEntry.BattleSystem.IsPlaying()+" isPause:"+window.GGameEntry.BattleSystem.IsPause());a=window.GGameEntry.ResTableMgr.GetConfigByID(_.star_client_c,52).Context;return window.GGameEntry.UIManager.ShowMsgBox(a),void S.onSetInviteInfo({})}if(!window.GGameEntry.IsNetAvailable){var a=window.GGameEntry.ResTableMgr.GetConfigByID(_.star_client_c,54).Context;return window.GGameEntry.UIManager.ShowMsgBox(a),void S.onSetInviteInfo({})}window.GGameEntry.NotificationCenter.emit("onChangeBtnState",{bShow:!1}),console.log("showGameCallBack not connected invited to room."),window.GGameEntry.CurGamePlayType=w.GamePlayType.GamePlayType_Network,I.SetGameMode(I.GM.GameMode_PVPPlayer),G.setLongSocketURL(n.url),s()}else console.log("showGameCallBack not connected no operation.");else window.GGameEntry.BattleSystem.IsPlaying()||window.GGameEntry.BattleSystem.IsPause()||window.GGameEntry.BattleSystem.IsMapLoading()||window.GGameEntry.BattleSystem.IsInRooming()?(console.log("showGameCallBack not connected inRoom or inGaming reconnect."),window.GGameEntry.GBattleNetwork.Reconnect()):console.log("showGameCallBack not connected do nothing.")}function f(){}function m(){if(E.IsWeichatGame()){var e=S.onGetInviteInfo();if(console.log("isInvitedToJoinRoom"),console.log(e),void 0!==e&&Object.keys(e).length>0&&"PVPMakeTeamUI"===e.uipath)return!0}return!1}function y(e){return!!(E.IsWeichatGame()&&(console.log("isViewRankInfo"),console.log(e),void 0!==e&&Object.keys(e).length>0&&"RecordUI"===e.uipath))}function p(){return E.IsWeichatGame()?C.getAppLoginInfo().query:null}function g(){E.IsWeichatGame()&&C.wxAuthorize(a)}cc._RF.push(t,"f65f5lk83RDZZ5ScPZyM+hB","weixininterface");var C=e("weixinmsgmgr"),G=e("loginConfig"),S=e("loginServerMgr"),E=e("PlatformUtil"),T=e("UIManager"),w=e("GlobalCfg"),M=e("NetworkUtils"),_=e("ResTableNames"),I=e("GameMode"),B="https://cdn.bt.qq.com/Config/Release/pic/TankShare.png",v=!1;t.exports={onWXOnShow:function(){C.onShow(h)},onCatchError:function(){C.onGameError()},onWXInit:function(){S.onRegisterLongSocketMsg(),G.initNetLocalConfig(),C.setUserInfoCallback(i),E.IsWeichatGame()&&(this.onCheckNet(),S.onSetInviteInfo(p()),this.onWXOnShow(),C.queryUserInfo(null),C.onTrunShareAppMessage(""===window.GGameEntry.tankshareurl?B:window.GGameEntry.tankshareurl,f))},onWXLogin:o,onWXRelease:function(){S.onUnregisterLongSocketMsg()},onShareMsgInGame:function(e,t,n,i){C.shareAppMessage(e,t,n,i)},isInvitedToJoinRoom:m,getAppLaunchInfo:p,onWXAuthorize:g,onCheckNet:function(){wx.onNetworkStatusChange(function(e){e.isConnected?window.GGameEntry.IsNetAvailable=!0:window.GGameEntry.IsNetAvailable=!1})},isViewRankInfo:y,onGetRankInfo:l,showGameCallBack:h,checkInviteIsOutOfDate:d},cc._RF.pop()},{GameMode:"GameMode",GlobalCfg:"GlobalCfg",NetworkUtils:"NetworkUtils",PlatformUtil:"PlatformUtil",QunUserDataMgr:"QunUserDataMgr",ResTableNames:"ResTableNames",UIManager:"UIManager",loginConfig:"loginConfig",loginServerMgr:"loginServerMgr",weixinmsgmgr:"weixinmsgmgr"}],weixinmsgmgr:[function(e,t,n){"use strict";function a(){return""===M&&(M="nickName"),M}function o(){S=null,E="",T=""}function r(){return""===E&&C.IsWeichatGame()&&(E=p("wxOpenID")),window.GGameEntry.OpenID=E,E}function s(){return""===T&&C.IsWeichatGame()&&(T=p("wxAccessToken")),T}function l(){return wx.getLaunchOptionsSync()}function c(e){console.log("wxAuthorize"),e(B.loginState_Session,!1,""),o(),wx.login({success:function(t){e(B.loginState_Login,!0,t),S=null,u(w)},fail:function(t){e(B.loginState_Login,!1,t)}})}function u(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null===S?wx.getSetting({success:function(n){null!==e&&e(S,v.userState_Setting,!0,n,t),n.authSetting["scope.userInfo"]?wx.getUserInfo({success:function(n){S=n,M=n.userInfo.nickName,_=n.userInfo.avatarUrl,null!==e&&e(S,v.userState_UserInfo,!0,n,t)},fail:function(n){null!==e&&e(S,v.userState_UserInfo,!1,n,t)}}):wx.authorize({scope:"scope.userInfo",success:function(n){null!==e&&e(S,v.userState_Auth,!0,n,t),R=!1,setTimeout(function(){if(!1===R){console.log("queryUserInfo getUserInfo weixin has no result to return.");var e=window.GGameEntry.ResTableMgr.GetConfigByID(G.star_client_c,51).Context;window.GGameEntry.UIManager.ShowMsgBox(e)}},5e3),wx.getUserInfo({success:function(n){console.log("queryUserInfo getUserInfo success."),R=!0,S=n,M=n.userInfo.nickName,_=n.userInfo.avatarUrl,null!==e&&e(S,v.userState_UserInfo,!0,n,t)},fail:function(n){console.log("queryUserInfo getUserInfo failed."),R=!0,null!==e&&e(S,v.userState_UserInfo,!1,n,t)}})},fail:function(n){null!==e&&e(S,v.userState_Auth,!1,n,t)}})},fail:function(n){null!==e&&e(S,v.userState_Setting,!1,n,t)}}):null!==e&&e(S,v.userState_Cache,!0,"",t)}function d(e){var t=l();console.log("切后台scene:"+e.scene+" scene:"+t.scene),console.log("切后台query:"+e.query+" query:"+t.query);var n=!1;window.GGameEntry.BattleSystem&&window.GGameEntry.BattleSystem.BattleData&&(n=window.GGameEntry.BattleSystem.BattleData.IsBattleBeginCountDownEnd),window.GGameEntry.BattleSystem&&n&&window.GGameEntry.BattleSystem.Resume(),window.GGameEntry.NotificationCenter&&window.GGameEntry.NotificationCenter.emit("onGameShowCallback")}function h(){console.log("游戏隐藏"),window.GGameEntry.BattleSystem&&window.GGameEntry.BattleSystem.Pause(),window.GGameEntry.NotificationCenter&&window.GGameEntry.NotificationCenter.emit("onGameHideCallback");var t=e("Util");wx.gameLogoutReport({data:{gameVersion:t.GetBuildVersionNum(),roleName:a(),roleId:r(),userLevel:0},success:function(e){},fail:function(e){}})}function f(e){console.log("游戏发生异常Msg:"+e.message),console.log("游戏发生异常Stack:"+e.stack);var t=e.message+"\n"+e.stack,n="";for(i=0;i<150&&i<t.length;++i)n+=t[i];window.GGameEntry.ServerLogHelp(n),wx.showModal({title:"Crash",content:n,showCancel:!1,success:function(e){e.confirm&&(console.log(t),!0===GameSettingConfig.Public&&wx.exitMiniProgram())}})}function m(){var e=!0;try{var t=wx.getStorageInfoSync();console.log("isEnoughStorage:"+t.currentSize+","+t.limitSize),t.currentSize>=t.limitSize&&(e=!1)}catch(e){console.log("getStorageInfoSync err:"+e.message)}return e}function y(e,t){if(m())try{wx.setStorageSync(e,t)}catch(t){console.log("setValue "+e+" err:"+t.message)}else console.log("storage no enough memory.")}function p(e){var t=null;try{t=wx.getStorageSync(e)}catch(t){console.log("getValue "+e+" err:"+t.message)}return t}function g(){console.error("audioInterruptEnd callback"),window.GGameEntry.NotificationCenter&&window.GGameEntry.NotificationCenter.emit("onAudioInterruptionEnd")}cc._RF.push(t,"059c015EDNGa68kzsIDld2A","weixinmsgmgr");var C=e("PlatformUtil"),G=(e("Util"),e("ServerLog"),e("ResTableNames")),S=null,E="",T="",w=null,M="nickName",_="res/raw-assets/resources/Atlas/HeadIcon.png",I="欢乐坦克大战",B={loginState_Session:1,loginState_Login:2,loginState_ShareInfo:3},v={userState_Cache:1,userState_Setting:2,userState_Auth:3,userState_UserInfo:4},P="wx2fcf29c354c79113",R=!1;t.exports={globalUserNickName:M,globalUserHeadURL:_,globalLoginState:B,globalUserState:v,setUserInfoCallback:function(e){w=e},initLoginInfo:function(e,t){E=e.toString(),T=t.toString(),C.IsWeichatGame()&&(y("wxOpenID",E),y("wxAccessToken",T))},wxlogin:function(e){wx.checkSession({success:function(){C.IsWeichatGame()&&(E=r(),T=s(),console.log("wxlogin openid:"+E+" accesstoken:"+T)),e(B.loginState_Session,!0,""),S=null,u(w,!0);var t=l();wx.getShareInfo({shareTicket:t.shareTicket,success:function(t){e(B.loginState_ShareInfo,!0,t)},fail:function(t){e(B.loginState_ShareInfo,!1,t)}})},fail:function(){c(e)}})},queryUserInfo:u,getUserNickName:a,getUserHeadURL:function(){return""===_&&(_="res/raw-assets/resources/Atlas/HeadIcon.png"),_},getUserInfo:function(){return null===S&&console.log("Error:please login first."),S},getOpenID:r,getAppID:function(){return P},getAccessToken:s,onShow:function(e){wx.onShow(function(t){console.log("群消息场景："+t.scene),console.log(t.query),console.log("群消息票据：",t.shareTicket);var n=l();console.log("切后台scene:"+t.scene+" scene:"+n.scene),console.log("切后台query:"+t.query+" query:"+n.query),e(t.scene,t.query),wx.getShareInfo({shareTicket:t.shareTicket,success:function(e){}})})},onGameShow:function(){wx.onShow(d)},onGameOffShow:function(){wx.offShow(d)},onGameOffHide:function(){wx.offHide(h)},onGameHide:function(){wx.onHide(h)},onGameError:function(){C.IsWeichatGame()?wx.onError(f):window.onerror=function(e,t,n,i,a){var o="游戏发生异常:"+e+"\nFile:"+t+" Line:"+n+" Column:"+i+"游戏发生异常Stack:\n"+a.stack;window.GGameEntry.ServerLogHelp(o),alert(o)}},onOffGameError:function(){wx.offError(f)},setValue:y,getValue:p,removeValue:function(e){try{wx.removeStorageSync(e)}catch(t){console.log("removeValue "+e+" err:"+t.message)}},clearAllValue:function(){try{wx.clearStorageSync()}catch(e){console.log("clearAllValue "+key+" err:"+e.message)}},onTrunShareAppMessage:function(e,t){var n=l();wx.onShareAppMessage(function(){return{title:""===window.GGameEntry.rightsharetips?I:window.GGameEntry.rightsharetips,imageUrl:e,query:n.query,success:function(e){t()},fail:function(e){}}})},shareAppMessage:function(e,t,n,i){l();wx.shareAppMessage({getGroupMsgTicket:!0,title:""===e?I:e,imageUrl:n,query:t,success:function(e){void 0!==e.shareTickets&&wx.getShareInfo({shareTicket:e.shareTickets[0],success:function(n){i(!0,!0,e,n,t)},fail:function(n){i(!0,!1,e,n,t)}}),console.log("shareAppMessage ",e)},fail:function(e){i(!1,!1,e,e,t)}})},getAppLoginInfo:l,wxAuthorize:c,onShowLoadingState:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;C.IsWeichatGame()&&(wx.showLoading({title:e}),setTimeout(function(){wx.hideLoading(),""!==n&&null!==i&&i(a)&&window.GGameEntry.UIManager.ShowMsgBox(n)},t))},onHideLoadingState:function(){C.IsWeichatGame()&&wx.hideLoading()},audioInterruptEnd:function(){wx.onAudioInterruptionEnd&&wx.onAudioInterruptionEnd(g)}},cc._RF.pop()},{PlatformUtil:"PlatformUtil",ResTableNames:"ResTableNames",ServerLog:"ServerLog",Util:"Util"}]},{},["AIComponent","AIEnumDef","AISystem","AIUtil","AiInterface","BTDeserialization","SimpleBevTree","AbortType","BevAction","BevComposite","BevCond","BevTask","StatusReturn","TaskStatus","A_SetUserVar","A_Attack","A_Idle","A_SetAttackTarget","ClearTargets","A_Dodge","A_Move","A_MoveToAreaWithTargetIn","A_MoveToCampConfigPos","A_MoveToEnemyBase","A_MoveToInput","A_MoveToItem","A_MoveToLineConfigPos","A_MoveToRandPos","Return","LRandomSelector","Selector","Sequence","C_BattleElapseTime","C_CanFire","C_CheckUserVar","C_HasAnyGridAround","C_HasBuf","C_HasTarget","C_IsAllyInRange","C_IsBeingShooted","C_IsItemInRange","C_IsMyBaseInRange","C_IsTargetInRange","C_LockAirdropBox","C_LockBase","C_LockTarget","C_LockTargetInArea","C_LockTargetNearbyMyBase","C_LockTargetOfAllies","C_LockTargetWithBuf","AIConfig","AIMapUtil","AirDropBox","AirDropSystem","BattleDef","BattleItemCacheManager","BattleRoot","BattleSystem","BlockMgr","BuffAddSpeed","BuffAlpha","BuffAttr","BuffBase","BuffBulletChange","BuffBulletDistance","BuffBulletFillUp","BuffBulletSpeedUp","BuffBulletUp","BuffChangeBullet","BuffDefine","BuffEffectFactory","BuffFlashExecute","BuffFlashGet","BuffFreeze","BuffGlobal","BuffInvincible","BuffInvisibleExecute","BuffInvisibleGet","BuffJiaSuItem","BuffJiaXue","BuffManager","BuffPowerUp","BuffSpeedUp","Bullet","BulletAddHp","BulletAttr","BulletBase","BulletManager","BulletThrough","BulletTypeDefine","CmdAddBuff","CmdAttr","CmdBase","CmdBuffSync","CmdDefine","CmdDeleteItem","CmdDeleteObj","CmdEffectHurt","CmdForward","CmdMgr","CmdMove","CmdMovePath","CmdMoveStop","CmdShowEmoticon","CmdSkill","CmdStartGame","CmdStartLoadMap","CmdStateSync","CmdSvrBattleEndStatistic","CmdSvrBattleGetObj","CmdSvrBattleStart","CmdSyncBattleStatistic","CollisionObject","ActiveDelay","AniAdditive","AniHideMe","AnimationManager","BtnSound","ButtonScaler","CameraShake","CollisionBox","Container","DownLoad","DynamicAnimation","EntityBase","EntityManager","EntityTypeDefine","FollowManager","GenerateId","HeadImageUtil","JsonUtils","MathUtil","MsgDelayDoing","PlatformUtil","RandomNameUtil","ResCfgDef","ResManager","ServerLog","SimpleLabel","SimpleRoundSprite","StaticAnimation","TankAttr","TimeSystem","Util","Version","base64","spark-md5","EffectDeath","GMActionCtrl","GMAddBuff","GMAttr","GMClass","GMCmd","GMDelBuff","GMOpenGuide","GMPanelCtrl","GMSystem","Inputfield","GameEntry","GameConfig","GlobalCfg","BaseDangerCtrl","ItemManager","ItemPowerUp","DirectionBtnCtrl","EffectBtnCtrl","Joystick","JoystickBG","JoystickCommon","JoystickConfig","JoystickSpawnCtrl","JoystickTouchArea","SkillBtnCtrl","SkillBtnJoystick","SkillBtnSpawnCtrl","SkillBtnTouchArea","LevelCfg","LevelManager","ServerMsgError","loginComNotifyMsg","loginConfig","loginServerMgr","weixininterface","weixinmsgmgr","FindPath","MapCfg","MapItemAdobe","MapItemBase","MapItemBigAdobe","MapItemBorder","MapItemBox","MapItemDecorate","MapItemGrass","MapItemGround","MapItemHide","MapItemHome","MapItemMask","MapItemSteel","MapItemWater","MapManager","Monster","MonsterManager","MsgBase","MsgEmoticon","MsgFinishLoadMap","MsgHandler","MsgHit","MsgMovePath","MsgPickUpItem","MsgUseBuff","MsgUseSkill","MsgUtil","BattleNetwork","GameNetwork","Network","NetworkConnector","NetworkHeartbeat","NetworkProto","NetworkStatus","NetworkUtils","NetworkWatchdog","PayManager","PerformanceMgr","BaseFollowTank","EntityDynamic","FireAnimationCtrl","OtherPlayer","Player","PlayerAnimationCtrl","PlayerBase","PlayerManager","PlayerSimulateMove","PlayerSimulatePoint","PvPInfo","TankBase","TankHeadImageFollow","TankMisc","TankNameFollow","keywords","star_comm","star_cs","star_macro","star_table","ResTableMgr","ResTableNames","ResUpdate","TipsMsgBox","UpdateUtils","BlockDisappear","FlashSkill","NormalAttackSkill","PickBufferSkill","Skill","SkillDefine","SoundManager","TestCount","AISettingCtrl","ActivityItem","ActivityMsgMgr","ActivityUI","AutoJoinCountDownUI","BattleLoadingUI","BattleUI","BeginCountDownUI","BulletIconUI","CommonMsgBoxUI","DirectionUI","EmoticonUI","EnterStateMgr","FPSUI","FollowTarget","FuHuoItemUI","FuHuoRootUI","GameMode","GuideUI","ItemArriveUI","JKTS48UI","KillMessageCtrl","KillNodeCtrl","LevelTransitionUI","LogoItemEff","LogoUI","LoseUI","MapDebugUI","NetWorkQueue","NewRecordUI","PVPChangTeamUI","PVPExitTeamUI","PVPMakeTeamUI","PVPRoomCountDownUI","RadarUI","RankItemUI","RankUI","QunUserDataMgr","RecordUI","RichMsgBoxUI","ServerUI","SettlementItem","SettlementUI","ShareUI","ShopUI","ShutDownItem","ShutDownUI","TankUI","TargetDescriptionUI","UIManager","WinUI","UnitTestDemo"]); 
 			});
 		define("src/settings.js", function(require, module, exports){ 			
_CCSettings={"platform":"web-mobile","groupList":["default","Player","Block","Monster","Items","Teleporter","Bullet","Steel","Base","AirDropItem","Border"],"collisionMatrix":[[false,false,false,false,false,false,false,false,false,false,false],[false,false,true,true,true,false,true,true,true,false,false],[false,true,false,true,false,false,true,false,false,false,false],[false,true,true,true,true,false,true,true,true,false,false],[false,true,false,true,false,false,false,false,false,false,false],[false,false,false,false,false,false,false,false,false,false,false],[false,true,true,true,false,false,false,true,true,true,true],[false,true,false,true,false,false,true,false,false,false,false],[false,true,false,true,false,false,true,false,false,false,false],[false,false,false,false,false,false,true,false,false,false,false],[false,false,false,false,false,false,true,false,false,false,false]],"rawAssets":{"assets":{"0":["resources/Prefabs/UI/ServerUI.prefab",6],"1":["resources/Atlas/LOGOUI",2,1],"2":["resources/Atlas/PVPMakeTeam",2,1],"3":["resources/Prefabs/GM/GMPanel.prefab",6],"4":["resources/Atlas/BattleUI",2,1],"5":["resources/Atlas/Battle",2,1],"6":["resources/Atlas/Battle",2,1],"7":["resources/Atlas/Battle",2,1],"8":["resources/Atlas/Battle",2,1],"9":["resources/Prefabs/Effect/feiji_pre_H.prefab",6],"10":["resources/Atlas/Activity",2,1],"11":["resources/Atlas/Activity",2,1],"12":["resources/Atlas/Activity",2,1],"13":["resources/Atlas/Activity",2,1],"14":["resources/Atlas/Activity",2,1],"15":["resources/Atlas/Activity",2,1],"16":["resources/Atlas/Activity",2,1],"17":["resources/Atlas/Activity",2,1],"18":["resources/Atlas/Activity.plist",3],"19":["resources/Atlas/Activity",2,1],"20":["resources/Atlas/Activity",2,1],"21":["resources/Atlas/Activity",2,1],"22":["resources/Atlas/Activity",2,1],"23":["resources/Atlas/Activity",2,1],"24":["resources/Atlas/Activity",2,1],"25":["resources/Atlas/Battle",2,1],"26":["resources/Animation/EffectAni/xiangzi_L.anim",1],"27":["resources/Atlas/Battle",2,1],"28":["resources/Atlas/Battle",2,1],"29":["resources/Prefabs/Effect/xiangzi_L.prefab",6],"30":["resources/Atlas/Battle",2,1],"31":["resources/Atlas/Battle",2,1],"32":["resources/Atlas/Battle",2,1],"33":["resources/Atlas/Battle",2,1],"34":["resources/Prefabs/Effect/dingshen_H.prefab",6],"35":["resources/Atlas/Battle",2,1],"36":["resources/Atlas/Battle",2,1],"37":["resources/Animation/EffectAni/T_zidan_n_M.anim",1],"38":["resources/Prefabs/Bullet/Bullet1_M.prefab",6],"39":["resources/Atlas/Battle",2,1],"40":["resources/Atlas/Battle",2,1],"41":["resources/Atlas/Battle",2,1],"42":["resources/Atlas/Battle",2,1],"43":["resources/Atlas/Battle",2,1],"44":["resources/Atlas/Battle",2,1],"45":["resources/Atlas/Battle",2,1],"46":["resources/Atlas/BattleUI",2,1],"47":["resources/Atlas/Battle",2,1],"48":["resources/Prefabs/PlayerItem/Player.prefab",6],"49":["resources/Prefabs/PlayerItem/BasePlayerName.prefab",6],"50":["resources/Atlas/Battle",2,1],"51":["resources/Animation/EffectAni/Zhangai_hit_01_M.anim",1],"52":["resources/Prefabs/Effect/Zhangai_hit_01_M.prefab",6],"53":["resources/Atlas/Battle",2,1],"54":["resources/Animation/EffectAni/zidan_q_M.anim",1],"55":["resources/Atlas/Battle",2,1],"56":["resources/Atlas/Battle",2,1],"57":["resources/Prefabs/Bullet/BulletThrough_M.prefab",6],"58":["resources/Prefabs/Effect/T_shouji_qianghua_L.prefab",6],"59":["resources/Animation/EffectAni/T_shouji_qianghua_L.anim",1],"60":["resources/Atlas/Battle",2,1],"61":["resources/Atlas/Battle",2,1],"62":["resources/Atlas/Battle",2,1],"63":["resources/Atlas/Battle",2,1],"64":["resources/Atlas/Battle",2,1],"65":["resources/Atlas/Battle",2,1],"66":["resources/Atlas/Battle",2,1],"67":["resources/Prefabs/Effect/Fire02.prefab",6],"68":["resources/Atlas/Battle",2,1],"69":["resources/Atlas/Battle",2,1],"70":["resources/Atlas/Battle",2,1],"71":["resources/Prefabs/Effect/Zhangai_hit_01.prefab",6],"72":["resources/Atlas/Battle",2,1],"73":["resources/Animation/EffectAni/T_boom_L.anim",1],"74":["resources/Prefabs/Effect/T_boom_L.prefab",6],"75":["resources/Prefabs/Effect/yinshen_L.prefab",6],"76":["resources/Animation/EffectAni/yinshen_L.anim",1],"77":["resources/Animation/Ani_UI/30MDJS.anim",1],"78":["resources/Atlas/BattleUI",2,1],"79":["resources/Atlas/Battle",2,1],"80":["resources/Prefabs/Effect/baohuzhao_H.prefab",6],"81":["resources/Atlas/Battle",2,1],"82":["resources/Atlas/BattleUI",2,1],"83":["resources/Prefabs/UI/BeginCountDownUI.prefab",6],"84":["resources/Atlas/BattleUI",2,1],"85":["resources/Atlas/BattleUI",2,1],"86":["resources/Atlas/BattleUI",2,1],"87":["resources/Atlas/BattleUI",2,1],"88":["resources/Atlas/Battle",2,1],"89":["resources/Animation/EffectAni/huolijiaqiang.anim",1],"90":["resources/Atlas/Battle",2,1],"91":["resources/Atlas/Battle",2,1],"92":["resources/Atlas/Battle",2,1],"93":["resources/Atlas/Battle",2,1],"94":["resources/Prefabs/Item/jiasu.prefab",6],"95":["resources/Atlas/Battle",2,1],"96":["resources/Prefabs/Effect/jiaxue_2_H.prefab",6],"97":["resources/Atlas/Battle",2,1],"98":["resources/Atlas/Battle",2,1],"99":["resources/Prefabs/Item/chanzi.prefab",6],"100":["resources/Prefabs/Effect/Zhangai_hit_M.prefab",6],"101":["resources/Atlas/Battle",2,1],"102":["resources/Animation/EffectAni/Zhangai_hit_M.anim",1],"103":["resources/Atlas/Battle",2,1],"104":["resources/Animation/EffectAni/JD_boom.anim",1],"105":["resources/Animation/EffectAni/xiangzi_die_M.anim",1],"106":["resources/Prefabs/Effect/xiangzi_die_M.prefab",6],"107":["resources/Atlas/Battle",2,1],"108":["resources/Animation/EffectAni/T_fire02_H.anim",1],"109":["resources/Prefabs/Effect/T_fire02_H.prefab",6],"110":["resources/Prefabs/GameMapItem/SmallBlockPrefab.prefab",6],"111":["resources/Atlas/MapItem",2,1],"112":["resources/Prefabs/Effect/baohuzhao_L.prefab",6],"113":["resources/Atlas/MapItem",2,1],"114":["resources/Prefabs/GameMapItem/MapDecoratePrefab.prefab",6],"115":["resources/Animation/EffectAni/jiasu.anim",1],"116":["resources/Prefabs/Effect/T_fire01_M.prefab",6],"117":["resources/Animation/EffectAni/T_fire01_M.anim",1],"118":["resources/Atlas/Battle",2,1],"119":["resources/Atlas/Battle",2,1],"120":["resources/Atlas/Battle",2,1],"121":["resources/Atlas/Battle",2,1],"122":["resources/Atlas/Battle",2,1],"123":["resources/Prefabs/Effect/JD_boom.prefab",6],"124":["resources/Atlas/Battle",2,1],"125":["resources/Atlas/Battle",2,1],"126":["resources/Atlas/Battle",2,1],"127":["resources/Prefabs/Bullet/Bulletjiaxue_H.prefab",6],"128":["resources/Atlas/Battle",2,1],"129":["resources/Prefabs/Ani_tank_prefab/Tank_LvDai_Y.prefab",6],"130":["resources/Prefabs/Effect/yinshen_M.prefab",6],"131":["resources/Animation/EffectAni/yinshen_M.anim",1],"132":["resources/Atlas/BattleUI",2,1],"133":["resources/Animation/Ani_UI/wofang.anim",1],"134":["resources/Prefabs/UI/TargetDescriptionUI.prefab",6],"135":["resources/Atlas/BattleUI",2,1],"136":["resources/Animation/Ani_UI/difang.anim",1],"137":["resources/Atlas/Battle",2,1],"138":["resources/Prefabs/Bullet/Bulletqianghua_L.prefab",6],"140":["resources/Prefabs/GM/GMClassItem.prefab",6],"141":["resources/Prefabs/Bullet/Bullet1_H.prefab",6],"142":["resources/Atlas/Battle",2,1],"143":["resources/Atlas/Battle",2,1],"144":["resources/Atlas/Battle",2,1],"145":["resources/Atlas/Battle",2,1],"146":["resources/Atlas/Battle",2,1],"147":["resources/UnitTest/UnitTestRoot.prefab",6],"148":["resources/Atlas/Battle",2,1],"149":["resources/Atlas/SettlementNotCompress",2,1],"151":["resources/Atlas/PVPMakeTeam",2,1],"153":["resources/Atlas/PVPMakeTeam",2,1],"154":["resources/Atlas/SettlementUI",2,1],"155":["resources/Atlas/PVPMakeTeam",2,1],"157":["resources/Prefabs/UI/NetWorkQueue.prefab",6],"158":["resources/Animation/EffectAni/yinshen_H.anim",1],"159":["resources/Atlas/Battle",2,1],"160":["resources/Prefabs/Effect/yinshen_H.prefab",6],"161":["resources/Prefabs/Effect/feiji_pre_L.prefab",6],"162":["resources/Atlas/Battle",2,1],"163":["resources/Animation/Ani_UI/JiDiWeiXianUI.anim",1],"164":["resources/Atlas/BattleUI",2,1],"165":["resources/Prefabs/GameMapItem/BasePrefab.prefab",6],"166":["resources/Atlas/Battle",2,1],"167":["resources/Atlas/Battle",2,1],"168":["resources/Atlas/BattleUI",2,1],"169":["resources/Atlas/BattleUI",2,1],"170":["resources/Atlas/LOGOUI",2,1],"171":["resources/Atlas/New_Logo_tuji",2,1],"172":["resources/Atlas/LOGOUI",2,1],"173":["resources/Prefabs/UI/ShopUI.prefab",6],"174":["resources/Atlas/LOGOUI",2,1],"175":["resources/Atlas/LOGOUI",2,1],"176":["resources/Atlas/LOGOUI",2,1],"177":["resources/Atlas/BattleUI",2,1],"178":["resources/Atlas/LOGOUI",2,1],"179":["resources/Prefabs/Effect/T_canying.prefab",6],"180":["resources/Atlas/Battle",2,1],"181":["resources/Prefabs/Effect/feiji_pre.prefab",6],"182":["resources/Prefabs/Effect/dingshen.prefab",6],"183":["resources/Atlas/Battle",2,1],"184":["resources/Atlas/Battle",2,1],"185":["resources/Atlas/Battle",2,1],"186":["resources/Atlas/Battle",2,1],"187":["resources/Atlas/Battle",2,1],"188":["resources/Atlas/Battle",2,1],"189":["resources/Atlas/Battle",2,1],"190":["resources/Atlas/Battle",2,1],"191":["resources/Prefabs/Effect/Fire01.prefab",6],"192":["resources/Animation/EffectAni/huolijiaqiang_M.anim",1],"193":["resources/Prefabs/Effect/xiangzi_die.prefab",6],"194":["resources/Atlas/Battle",2,1],"195":["resources/Atlas/ActivityPic.plist",3],"196":["resources/Atlas/ActivityPic",2,1],"197":["resources/Atlas/ActivityPic",2,1],"198":["resources/Atlas/ActivityPic",2,1],"199":["resources/Atlas/ActivityPic",2,1],"200":["resources/Atlas/Battle",2,1],"201":["resources/Animation/EffectAni/huixue.anim",1],"202":["resources/Atlas/Battle",2,1],"203":["resources/Atlas/Battle",2,1],"204":["resources/Animation/EffectAni/dingshen_M.anim",1],"205":["resources/Atlas/Battle",2,1],"206":["resources/Atlas/LOGOUI",2,1],"207":["resources/Atlas/LOGOUI",2,1],"208":["resources/Atlas/LOGOUI",2,1],"209":["resources/Atlas/New_Logo_tuji",2,1],"210":["resources/Atlas/LOGOUI",2,1],"211":["resources/Atlas/SettlementNotCompress",2,1],"212":["resources/Atlas/LOGOUI",2,1],"213":["resources/Atlas/LOGOUI",2,1],"214":["resources/Atlas/SettlementNotCompress",2,1],"215":["resources/Prefabs/UI/shareUI.prefab",6],"216":["resources/Atlas/New_Logo_tuji",2,1],"217":["resources/Atlas/LOGOUI",2,1],"218":["resources/Atlas/LOGOUI",2,1],"219":["resources/Atlas/LOGOUI",2,1],"220":["resources/Atlas/SettlementNotCompress",2,1],"221":["resources/Atlas/LOGOUI",2,1],"222":["resources/Atlas/SettlementNotCompress",2,1],"223":["resources/Atlas/LOGOUI",2,1],"224":["resources/Atlas/LQLogoUI",2,1],"225":["resources/Atlas/LQLogoUI",2,1],"226":["resources/Atlas/LQLogoUI",2,1],"227":["resources/Atlas/LQLogoUI",2,1],"228":["resources/Atlas/LQLogoUI",2,1],"229":["resources/Atlas/LQLogoUI",2,1],"230":["resources/Atlas/LQLogoUI",2,1],"231":["resources/Atlas/LQLogoUI",2,1],"232":["resources/Atlas/LQLogoUI.plist",3],"233":["resources/Atlas/LQLogoUI",2,1],"234":["resources/Atlas/LQLogoUI",2,1],"235":["resources/Atlas/LQLogoUI",2,1],"236":["resources/Atlas/LQLogoUI",2,1],"237":["resources/Atlas/LQLogoUI",2,1],"238":["resources/Atlas/LQLogoUI",2,1],"239":["resources/Atlas/LQLogoUI",2,1],"240":["resources/Atlas/LQLogoUI",2,1],"241":["resources/Atlas/LQLogoUI",2,1],"242":["resources/Atlas/LQLogoUI",2,1],"243":["resources/Atlas/LQLogoUI",2,1],"244":["resources/Atlas/LQLogoUI",2,1],"245":["resources/Atlas/LQLogoUI",2,1],"246":["resources/Atlas/LQLogoUI",2,1],"247":["resources/Atlas/LQLogoUI",2,1],"248":["resources/Atlas/LQLogoUI",2,1],"249":["resources/Atlas/LQLogoUI",2,1],"250":["resources/Atlas/LQLogoUI",2,1],"251":["resources/Atlas/LQLogoUI",2,1],"252":["resources/Atlas/LQLogoUI",2,1],"253":["resources/Atlas/LQLogoUI",2,1],"254":["resources/Atlas/LQLogoUI",2,1],"255":["resources/Atlas/LQLogoUI",2,1],"256":["resources/Atlas/LQLogoUI",2,1],"257":["resources/Atlas/LQLogoUI",2,1],"258":["resources/Prefabs/Effect/Player_yinshen.prefab",6],"259":["resources/Atlas/Battle",2,1],"260":["resources/Atlas/Battle",2,1],"261":["resources/Prefabs/UI/BulletIconUI.prefab",6],"262":["resources/Atlas/Battle",2,1],"263":["resources/Atlas/Battle",2,1],"264":["resources/Atlas/MapItem",2,1],"265":["resources/Prefabs/GameMapItem/GroundPrefab.prefab",6],"266":["resources/Atlas/SettlementUI",2,1],"267":["resources/Prefabs/UI/CommonMsgBoxUI.prefab",6],"268":["resources/Atlas/Battle",2,1],"269":["resources/Prefabs/Effect/T_yujing_blue_H.prefab",6],"270":["resources/Atlas/Battle",2,1],"271":["resources/Prefabs/Effect/Fire02_H.prefab",6],"272":["resources/Atlas/LOGOUI",2,1],"273":["resources/Atlas/LOGOUI",2,1],"274":["resources/Atlas/LOGOUI",2,1],"275":["resources/Atlas/LOGOUI",2,1],"276":["resources/Atlas/LOGOUI",2,1],"277":["resources/Atlas/LOGOUI",2,1],"278":["resources/Atlas/LOGOUI",2,1],"279":["resources/Atlas/LOGOUI.plist",3],"280":["resources/Atlas/LOGOUI",2,1],"281":["resources/Atlas/LOGOUI",2,1],"282":["resources/Atlas/LOGOUI",2,1],"283":["resources/Atlas/LOGOUI",2,1],"284":["resources/Atlas/LOGOUI",2,1],"285":["resources/Atlas/LOGOUI",2,1],"286":["resources/Atlas/LOGOUI",2,1],"287":["resources/Atlas/LOGOUI",2,1],"288":["resources/Atlas/LOGOUI",2,1],"289":["resources/Atlas/LOGOUI",2,1],"290":["resources/Atlas/LOGOUI",2,1],"291":["resources/Atlas/LOGOUI",2,1],"292":["resources/Atlas/LOGOUI",2,1],"293":["resources/Atlas/LOGOUI",2,1],"294":["resources/Atlas/LOGOUI",2,1],"295":["resources/Atlas/LOGOUI",2,1],"296":["resources/Atlas/LOGOUI",2,1],"297":["resources/Atlas/LOGOUI",2,1],"298":["resources/Atlas/LOGOUI",2,1],"299":["resources/Prefabs/Effect/T_shouji_zhiliao.prefab",6],"300":["resources/Animation/EffectAni/T_shouji_zhiliao.anim",1],"301":["resources/Atlas/Battle",2,1],"302":["resources/Atlas/Battle",2,1],"303":["resources/Prefabs/GM/GMActionCmdItem.prefab",6],"304":["resources/Prefabs/PlayerItem/OtherPlayerName.prefab",6],"305":["resources/Prefabs/PlayerItem/OtherPlayer.prefab",6],"306":["resources/Atlas/Battle",2,1],"307":["resources/Atlas/SettlementUI",2,1],"308":["resources/Atlas/SettlementUI",2,1],"309":["resources/Atlas/HeadIcon",2,1],"310":["resources/Atlas/SettlementNotCompress",2,1],"311":["resources/Atlas/SettlementUI",2,1],"312":["resources/Atlas/SettlementUI",2,1],"313":["resources/Atlas/SettlementUI",2,1],"314":["resources/Atlas/SettlementUI",2,1],"315":["resources/Atlas/SettlementNotCompress",2,1],"316":["resources/Atlas/BattleUI",2,1],"317":["resources/Atlas/SettlementUI",2,1],"318":["resources/Atlas/BattleUI",2,1],"319":["resources/Atlas/SettlementUI",2,1],"320":["resources/Atlas/SettlementNotCompress",2,1],"321":["resources/Atlas/SettlementUI",2,1],"322":["resources/Atlas/BattleUI",2,1],"323":["resources/Atlas/BattleUI",2,1],"324":["resources/Atlas/BattleUI",2,1],"325":["resources/Atlas/BattleUI",2,1],"326":["resources/Atlas/SettlementNotCompress",2,1],"327":["resources/Atlas/BattleUI",2,1],"328":["resources/Prefabs/UI/SettlementUI.prefab",6],"329":["resources/Atlas/SettlementNotCompress",2,1],"330":["resources/Atlas/SettlementUI",2,1],"331":["resources/Atlas/SettlementNotCompress",2,1],"332":["resources/Atlas/New_Logo_tuji",2,1],"333":["resources/Atlas/BattleUI",2,1],"334":["resources/Atlas/SettlementUI",2,1],"335":["resources/Atlas/SettlementUI",2,1],"336":["resources/Atlas/SettlementUI",2,1],"337":["resources/Atlas/SettlementUI",2,1],"338":["resources/Prefabs/Effect/T_yujing_red.prefab",6],"339":["resources/Prefabs/Number/Battle_Enemy_Word.prefab",6],"340":["resources/Atlas/Battle",2,1],"341":["resources/Animation/EffectAni/kuangbao_xiaoshi.anim",1],"342":["resources/Prefabs/Item/kuangbao.prefab",6],"343":["resources/Animation/EffectAni/kuangbao.anim",1],"344":["resources/Atlas/Battle",2,1],"345":["resources/Atlas/PVPMakeTeam",2,1],"346":["resources/Atlas/PVPMakeTeam",2,1],"347":["resources/Atlas/PVPMakeTeam",2,1],"348":["resources/Atlas/PVPMakeTeam",2,1],"349":["resources/Atlas/PVPMakeTeam",2,1],"350":["resources/Atlas/PVPMakeTeam",2,1],"351":["resources/Atlas/PVPMakeTeam",2,1],"352":["resources/Atlas/PVPMakeTeam",2,1],"353":["resources/Atlas/PVPMakeTeam",2,1],"354":["resources/Atlas/PVPMakeTeam",2,1],"355":["resources/Atlas/PVPMakeTeam",2,1],"356":["resources/Atlas/PVPMakeTeam",2,1],"357":["resources/Atlas/PVPMakeTeam",2,1],"358":["resources/Atlas/PVPMakeTeam",2,1],"359":["resources/Atlas/PVPMakeTeam",2,1],"360":["resources/Atlas/PVPMakeTeam",2,1],"361":["resources/Atlas/PVPMakeTeam",2,1],"362":["resources/Atlas/PVPMakeTeam",2,1],"363":["resources/Atlas/PVPMakeTeam",2,1],"364":["resources/Atlas/PVPMakeTeam",2,1],"365":["resources/Atlas/PVPMakeTeam",2,1],"366":["resources/Atlas/PVPMakeTeam",2,1],"367":["resources/Atlas/PVPMakeTeam",2,1],"368":["resources/Atlas/PVPMakeTeam",2,1],"369":["resources/Atlas/PVPMakeTeam",2,1],"370":["resources/Atlas/PVPMakeTeam",2,1],"371":["resources/Atlas/PVPMakeTeam",2,1],"372":["resources/Atlas/PVPMakeTeam",2,1],"373":["resources/Atlas/PVPMakeTeam",2,1],"374":["resources/Atlas/PVPMakeTeam",2,1],"375":["resources/Atlas/PVPMakeTeam",2,1],"376":["resources/Atlas/PVPMakeTeam",2,1],"377":["resources/Atlas/PVPMakeTeam",2,1],"378":["resources/Atlas/PVPMakeTeam.plist",3],"379":["resources/Atlas/PVPMakeTeam",2,1],"380":["resources/Atlas/PVPMakeTeam",2,1],"381":["resources/Atlas/PVPMakeTeam",2,1],"382":["resources/Atlas/PVPMakeTeam",2,1],"383":["resources/Atlas/PVPMakeTeam",2,1],"384":["resources/Atlas/PVPMakeTeam",2,1],"385":["resources/Atlas/PVPMakeTeam",2,1],"386":["resources/Atlas/PVPMakeTeam",2,1],"387":["resources/Atlas/PVPMakeTeam",2,1],"388":["resources/Atlas/PVPMakeTeam",2,1],"389":["resources/Atlas/PVPMakeTeam",2,1],"390":["resources/Atlas/PVPMakeTeam",2,1],"391":["resources/Atlas/PVPMakeTeam",2,1],"392":["resources/Atlas/PVPMakeTeam",2,1],"393":["resources/Atlas/PVPMakeTeam",2,1],"394":["resources/Atlas/PVPMakeTeam",2,1],"395":["resources/Atlas/PVPMakeTeam",2,1],"396":["resources/Atlas/PVPMakeTeam",2,1],"397":["resources/Atlas/PVPMakeTeam",2,1],"398":["resources/Prefabs/Effect/Player_yinshen_M.prefab",6],"399":["resources/Prefabs/UI/BattleLoadingUI.prefab",6],"400":["resources/Atlas/Battle",2,1],"401":["resources/Prefabs/Effect/xiangzi_die_H.prefab",6],"402":["resources/Animation/EffectAni/xingxing.anim",1],"403":["resources/Atlas/Battle",2,1],"404":["resources/Atlas/QunRank",2,1],"405":["resources/Prefabs/UI/QunRankItem.prefab",6],"406":["resources/Animation/Ani_Logo/LQ_Logo_UI.anim",1],"407":["resources/Prefabs/Effect/T_yujing_blue_M.prefab",6],"408":["resources/Prefabs/Item/huixue.prefab",6],"409":["resources/Prefabs/Effect/feiji_pre_M.prefab",6],"410":["resources/Prefabs/Effect/T_fire_jiguang_H.prefab",6],"411":["resources/Atlas/Battle",2,1],"412":["resources/Animation/EffectAni/chanzi_xiaoshi.anim",1],"413":["resources/Prefabs/Effect/dianji.prefab",6],"414":["resources/Atlas/Battle",2,1],"415":["resources/Prefabs/Effect/xiangzi_M.prefab",6],"416":["resources/Animation/EffectAni/xiangzi_M.anim",1],"417":["resources/Atlas/Battle",2,1],"418":["resources/Animation/EffectAni/T_guiji.anim",1],"419":["resources/Atlas/Battle",2,1],"420":["resources/Prefabs/Item/jiasu_H.prefab",6],"421":["resources/Prefabs/Effect/T_boom.prefab",6],"422":["resources/Animation/EffectAni/T_boom.anim",1],"423":["resources/Prefabs/Effect/T_shouji_qianghua_H.prefab",6],"424":["resources/Atlas/Battle",2,1],"425":["resources/Atlas/Battle",2,1],"426":["resources/Atlas/Battle",2,1],"427":["resources/Animation/EffectAni/T_shouji_qianghua_H.anim",1],"428":["resources/Prefabs/Effect/Fire01_H.prefab",6],"429":["resources/Atlas/BattleUI",2,1],"430":["resources/Atlas/BattleUI",2,1],"431":["resources/Atlas/BattleUI",2,1],"432":["resources/Atlas/BattleUI",2,1],"433":["resources/Atlas/BattleUI",2,1],"434":["resources/Atlas/BattleUI",2,1],"435":["resources/Atlas/BattleUI",2,1],"436":["resources/Atlas/BattleUI",2,1],"437":["resources/Atlas/BattleUI",2,1],"438":["resources/Atlas/BattleUI",2,1],"439":["resources/Atlas/BattleUI",2,1],"440":["resources/Atlas/BattleUI",2,1],"441":["resources/Atlas/BattleUI",2,1],"442":["resources/Atlas/BattleUI",2,1],"443":["resources/Atlas/BattleUI",2,1],"444":["resources/Atlas/BattleUI",2,1],"445":["resources/Atlas/BattleUI",2,1],"446":["resources/Atlas/BattleUI",2,1],"447":["resources/Atlas/BattleUI",2,1],"448":["resources/Atlas/BattleUI",2,1],"449":["resources/Atlas/BattleUI",2,1],"450":["resources/Atlas/BattleUI",2,1],"451":["resources/Atlas/BattleUI",2,1],"452":["resources/Atlas/BattleUI",2,1],"453":["resources/Atlas/BattleUI",2,1],"454":["resources/Atlas/BattleUI",2,1],"455":["resources/Atlas/BattleUI",2,1],"456":["resources/Atlas/BattleUI",2,1],"457":["resources/Atlas/BattleUI",2,1],"458":["resources/Atlas/BattleUI",2,1],"459":["resources/Atlas/BattleUI",2,1],"460":["resources/Atlas/BattleUI",2,1],"461":["resources/Atlas/BattleUI",2,1],"462":["resources/Atlas/BattleUI",2,1],"463":["resources/Atlas/BattleUI",2,1],"464":["resources/Atlas/BattleUI",2,1],"465":["resources/Atlas/BattleUI.plist",3],"466":["resources/Atlas/BattleUI",2,1],"467":["resources/Atlas/BattleUI",2,1],"468":["resources/Atlas/BattleUI",2,1],"469":["resources/Atlas/BattleUI",2,1],"470":["resources/Atlas/BattleUI",2,1],"471":["resources/Atlas/BattleUI",2,1],"472":["resources/Atlas/BattleUI",2,1],"473":["resources/Atlas/BattleUI",2,1],"474":["resources/Atlas/BattleUI",2,1],"475":["resources/Atlas/BattleUI",2,1],"476":["resources/Atlas/BattleUI",2,1],"477":["resources/Atlas/BattleUI",2,1],"478":["resources/Atlas/BattleUI",2,1],"479":["resources/Atlas/BattleUI",2,1],"480":["resources/Atlas/BattleUI",2,1],"481":["resources/Atlas/BattleUI",2,1],"482":["resources/Atlas/BattleUI",2,1],"483":["resources/Atlas/BattleUI",2,1],"484":["resources/Atlas/BattleUI",2,1],"485":["resources/Atlas/BattleUI",2,1],"486":["resources/Atlas/BattleUI",2,1],"487":["resources/Atlas/BattleUI",2,1],"488":["resources/Atlas/BattleUI",2,1],"489":["resources/Atlas/BattleUI",2,1],"490":["resources/Atlas/BattleUI",2,1],"491":["resources/Atlas/BattleUI",2,1],"492":["resources/Atlas/BattleUI",2,1],"493":["resources/Atlas/BattleUI",2,1],"494":["resources/Atlas/BattleUI",2,1],"495":["resources/Atlas/BattleUI",2,1],"496":["resources/Atlas/BattleUI",2,1],"497":["resources/Atlas/BattleUI",2,1],"498":["resources/Atlas/BattleUI",2,1],"499":["resources/Atlas/BattleUI",2,1],"500":["resources/Atlas/BattleUI",2,1],"501":["resources/Atlas/BattleUI",2,1],"502":["resources/Atlas/BattleUI",2,1],"503":["resources/Atlas/BattleUI",2,1],"504":["resources/Atlas/BattleUI",2,1],"505":["resources/Atlas/BattleUI",2,1],"506":["resources/Atlas/BattleUI",2,1],"507":["resources/Atlas/BattleUI",2,1],"508":["resources/Atlas/BattleUI",2,1],"509":["resources/Prefabs/GameMapItem/BorderPrefab.prefab",6],"510":["resources/Atlas/MapItem",2,1],"511":["resources/Atlas/Battle",2,1],"512":["resources/Prefabs/Effect/Player_die_H.prefab",6],"513":["resources/Prefabs/Effect/daojuxiaoshi_M.prefab",6],"514":["resources/Animation/EffectAni/daojuxiaoshi_M.anim",1],"515":["resources/Prefabs/Effect/T_canying_H.prefab",6],"516":["resources/Atlas/Battle",2,1],"517":["resources/Atlas/Battle",2,1],"518":["resources/Animation/EffectAni/T_fire_jiguang_H.anim",1],"519":["resources/Prefabs/Ani_tank_prefab/Tank_LvDai_G.prefab",6],"520":["resources/Prefabs/Effect/T_yujing_red_M.prefab",6],"521":["resources/Prefabs/Bullet/Bulletqianghua_M.prefab",6],"522":["resources/Animation/EffectAni/T_zidan_qianghua_M.anim",1],"523":["resources/Atlas/QunRank",2,1],"524":["resources/Atlas/QunRank",2,1],"525":["resources/Atlas/QunRank",2,1],"526":["resources/Atlas/QunRank",2,1],"527":["resources/Atlas/QunRank",2,1],"528":["resources/Atlas/QunRank",2,1],"529":["resources/Atlas/QunRank",2,1],"530":["resources/Atlas/QunRank",2,1],"531":["resources/Atlas/QunRank",2,1],"532":["resources/Atlas/QunRank",2,1],"533":["resources/Atlas/QunRank",2,1],"534":["resources/Atlas/QunRank.plist",3],"535":["resources/Atlas/QunRank",2,1],"536":["resources/Atlas/QunRank",2,1],"537":["resources/Atlas/QunRank",2,1],"538":["resources/Atlas/QunRank",2,1],"539":["resources/Atlas/QunRank",2,1],"540":["resources/Atlas/QunRank",2,1],"541":["resources/Prefabs/UI/ItemArriveUI.prefab",6],"542":["resources/Atlas/SettlementNotCompress",2,1],"543":["resources/Animation/EffectAni/T_zidan_jiaxue_M.anim",1],"544":["resources/Prefabs/Bullet/Bulletjiaxue_M.prefab",6],"545":["resources/Atlas/Battle",2,1],"546":["resources/Prefabs/Bullet/Bulletfantan.prefab",6],"547":["resources/Prefabs/Effect/T_guiji_H.prefab",6],"548":["resources/Prefabs/Number/Battle_Self_Word.prefab",6],"549":["resources/Prefabs/Bullet/Bullet1.prefab",6],"550":["resources/Animation/EffectAni/shouji_n_L.anim",1],"551":["resources/Prefabs/Effect/T_shouji_n_L.prefab",6],"552":["resources/Atlas/Battle",2,1],"553":["resources/Atlas/Battle",2,1],"554":["resources/Atlas/Battle",2,1],"555":["resources/Atlas/Battle",2,1],"556":["resources/Atlas/Battle",2,1],"557":["resources/Atlas/Battle",2,1],"558":["resources/Prefabs/Effect/Fire03.prefab",6],"559":["resources/Atlas/Battle",2,1],"560":["resources/Atlas/Battle",2,1],"561":["resources/Prefabs/Number/Enemy_Word.prefab",6],"562":["resources/Prefabs/Effect/T_boom_M.prefab",6],"563":["resources/Animation/EffectAni/T_boom_M.anim",1],"564":["resources/Prefabs/Effect/huolijiaqiang.prefab",6],"565":["resources/Atlas/MapItem",2,1],"566":["resources/Prefabs/GameMapItem/SteelPrefab.prefab",6],"567":["resources/Prefabs/GameMapItem/NoBrokenPrefab.prefab",6],"568":["resources/Atlas/MapItem",2,1],"569":["resources/Animation/EffectAni/shouji_n_H.anim",1],"570":["resources/Prefabs/Effect/T_shouji_n_H.prefab",6],"571":["resources/Atlas/Battle",2,1],"572":["resources/Prefabs/Bullet/Bulletqianghua_H.prefab",6],"573":["resources/Animation/EffectAni/dingshen.anim",1],"574":["resources/Animation/EffectAni/T_shouji_zhiliao_H.anim",1],"575":["resources/Prefabs/Effect/T_shouji_zhiliao_H.prefab",6],"576":["resources/Prefabs/Effect/T_shouji_zhiliao_L.prefab",6],"577":["resources/Animation/EffectAni/T_shouji_zhiliao_L.anim",1],"578":["resources/Prefabs/UI/FPSUI.prefab",6],"579":["resources/Animation/EffectAni/jiaxue_xiaoshi.anim",1],"580":["resources/Atlas/Battle",2,1],"581":["resources/Prefabs/UI/EmoticonItem.prefab",6],"582":["resources/Prefabs/UI/RecordUI.prefab",6],"583":["resources/Atlas/New_Logo_tuji",2,1],"584":["resources/Atlas/New_Logo_tuji",2,1],"585":["resources/Atlas/New_Logo_tuji",2,1],"586":["resources/Atlas/New_Logo_tuji",2,1],"587":["resources/Atlas/New_Logo_tuji",2,1],"588":["resources/Atlas/New_Logo_tuji",2,1],"589":["resources/Atlas/New_Logo_tuji",2,1],"590":["resources/Atlas/New_Logo_tuji",2,1],"591":["resources/Atlas/New_Logo_tuji",2,1],"592":["resources/Atlas/New_Logo_tuji",2,1],"593":["resources/Atlas/New_Logo_tuji",2,1],"594":["resources/Atlas/New_Logo_tuji",2,1],"595":["resources/Atlas/New_Logo_tuji",2,1],"596":["resources/Prefabs/UI/PVPChangTeamUI.prefab",6],"597":["resources/Atlas/SettlementUI",2,1],"598":["resources/Atlas/Battle",2,1],"599":["resources/Prefabs/Effect/T_shouji_jiguang_H.prefab",6],"600":["resources/Atlas/Battle",2,1],"601":["resources/Prefabs/Monster/Monster1.prefab",6],"602":["resources/Prefabs/Monster/MonsterHeadImage.prefab",6],"603":["resources/Prefabs/Monster/MonsterName.prefab",6],"604":["resources/Atlas/SettlementNotCompress",2,1],"605":["resources/Atlas/SettlementNotCompress",2,1],"606":["resources/Atlas/SettlementNotCompress.plist",3],"607":["resources/Atlas/SettlementNotCompress",2,1],"608":["resources/Atlas/SettlementNotCompress",2,1],"609":["resources/Atlas/SettlementNotCompress",2,1],"610":["resources/Atlas/SettlementNotCompress",2,1],"611":["resources/Atlas/SettlementNotCompress",2,1],"612":["resources/Atlas/SettlementNotCompress",2,1],"613":["resources/Atlas/SettlementNotCompress",2,1],"614":["resources/Atlas/SettlementNotCompress",2,1],"615":["resources/Atlas/SettlementNotCompress",2,1],"616":["resources/Atlas/SettlementNotCompress",2,1],"617":["resources/Prefabs/Item/speedUp.prefab",6],"618":["resources/Atlas/Battle",2,1],"619":["resources/Animation/EffectAni/shouji_jiguang_H.anim",1],"620":["resources/Atlas/Battle",2,1],"621":["resources/Animation/EffectAni/Player_die_M.anim",1],"622":["resources/Prefabs/Effect/Player_die_M.prefab",6],"623":["resources/Prefabs/Effect/T_fire02.prefab",6],"624":["resources/Animation/EffectAni/T_fire02.anim",1],"625":["resources/Prefabs/UI/KillNode.prefab",6],"626":["resources/Prefabs/Item/jiaxue.prefab",6],"627":["resources/Animation/EffectAni/jiasu2.anim",1],"628":["resources/Atlas/Battle",2,1],"629":["resources/Prefabs/Item/cisha.prefab",6],"630":["resources/Animation/EffectAni/cisha_xiaoshi.anim",1],"631":["resources/Atlas/Battle",2,1],"632":["resources/Animation/EffectAni/cisha.anim",1],"633":["resources/Animation/EffectAni/shangdan.anim",1],"634":["resources/Prefabs/Effect/shangdan.prefab",6],"635":["resources/Prefabs/UI/EmoticonUI.prefab",6],"636":["resources/Prefabs/Effect/huolijiaqiang_M.prefab",6],"637":["resources/Prefabs/GameMapItem/BoxPrefab.prefab",6],"638":["resources/Prefabs/Effect/xiangzi.prefab",6],"639":["resources/Prefabs/GameMapItem/BigBlockPrefab.prefab",6],"640":["resources/Atlas/Battle",2,1],"641":["resources/Prefabs/Effect/T_fantanshouji_n.prefab",6],"642":["resources/Animation/EffectAni/fantanshouji_n.anim",1],"643":["resources/Prefabs/Effect/T_shouji_qianghua.prefab",6],"644":["resources/Animation/EffectAni/T_shouji_qianghua.anim",1],"645":["resources/Prefabs/Effect/dingshen_L.prefab",6],"646":["resources/Animation/EffectAni/dingshen_L.anim",1],"647":["resources/Prefabs/Effect/Zhangai_hit_01_H.prefab",6],"648":["resources/Animation/EffectAni/Zhangai_hit_01_H.anim",1],"649":["resources/Prefabs/Effect/T_fire01_H.prefab",6],"650":["resources/Prefabs/Effect/dingshen_M.prefab",6],"651":["resources/Prefabs/Effect/Fire01_M.prefab",6],"652":["resources/Animation/EffectAni/huolijiaqiang_H.anim",1],"653":["resources/Prefabs/Number/Self_Word.prefab",6],"654":["resources/Prefabs/Effect/Zhangai_hit_H.prefab",6],"655":["resources/Prefabs/Effect/T_guiji.prefab",6],"656":["resources/Prefabs/UI/PVPExitTeamUI.prefab",6],"657":["resources/Prefabs/UI/RankUI.prefab",6],"658":["resources/Atlas/SettlementUI",2,1],"659":["resources/Animation/EffectAni/jiesuan_shengli.anim",1],"660":["resources/Prefabs/UI/WinUI.prefab",6],"661":["resources/Atlas/SettlementUI",2,1],"662":["resources/Atlas/Battle",2,1],"663":["resources/Animation/EffectAni/zhuanhuan_xiaoshi.anim",1],"664":["resources/Prefabs/Effect/T_fire01.prefab",6],"665":["resources/Atlas/Battle",2,1],"666":["resources/Prefabs/Bullet/Bulletjiguang_L.prefab",6],"667":["resources/Atlas/SettlementUI",2,1],"668":["resources/Atlas/Battle",2,1],"669":["resources/Atlas/Battle",2,1],"670":["resources/Prefabs/UI/GuideUI.prefab",6],"671":["resources/Atlas/Battle",2,1],"672":["resources/Animation/Ani_UI/zhiyinUI_R.anim",1],"673":["resources/Animation/Ani_UI/zhiyinUI_L.anim",1],"674":["resources/Animation/Ani_UI/zhiyinUI_mubiao.anim",1],"675":["resources/Atlas/Battle",2,1],"676":["resources/Animation/Ani_UI/zhiyinUI_jiantou.anim",1],"677":["resources/Atlas/Battle",2,1],"678":["resources/Atlas/Battle",2,1],"679":["resources/Atlas/Battle",2,1],"680":["resources/Atlas/Battle",2,1],"681":["resources/Prefabs/Bullet/Bulletjiaxue.prefab",6],"682":["resources/Prefabs/Effect/Fire03_M.prefab",6],"683":["resources/Prefabs/Effect/T_shouji_q.prefab",6],"684":["resources/Animation/EffectAni/shouji_q.anim",1],"685":["resources/Prefabs/Bullet/Bulletqianghua.prefab",6],"686":["resources/Prefabs/Effect/Player_die.prefab",6],"687":["resources/Atlas/SettlementUI",2,1],"688":["resources/Atlas/SettlementUI",2,1],"689":["resources/Atlas/SettlementUI",2,1],"690":["resources/Atlas/SettlementUI",2,1],"691":["resources/Atlas/SettlementUI",2,1],"692":["resources/Atlas/SettlementUI",2,1],"693":["resources/Atlas/SettlementUI",2,1],"694":["resources/Atlas/SettlementUI",2,1],"695":["resources/Atlas/SettlementUI",2,1],"696":["resources/Atlas/SettlementUI.plist",3],"697":["resources/Atlas/SettlementUI",2,1],"698":["resources/Atlas/SettlementUI",2,1],"699":["resources/Atlas/SettlementUI",2,1],"700":["resources/Atlas/SettlementUI",2,1],"701":["resources/Atlas/SettlementUI",2,1],"702":["resources/Atlas/SettlementUI",2,1],"703":["resources/Atlas/SettlementUI",2,1],"704":["resources/Atlas/SettlementUI",2,1],"705":["resources/Atlas/SettlementUI",2,1],"706":["resources/Atlas/SettlementUI",2,1],"707":["resources/Atlas/SettlementUI",2,1],"708":["resources/Atlas/SettlementUI",2,1],"709":["resources/Atlas/SettlementUI",2,1],"710":["resources/Atlas/SettlementUI",2,1],"711":["resources/Atlas/SettlementUI",2,1],"712":["resources/Atlas/SettlementUI",2,1],"713":["resources/Prefabs/Effect/baohuzhao.prefab",6],"714":["resources/Atlas/New_Logo_tuji",2,1],"715":["resources/Atlas/New_Logo_tuji",2,1],"716":["resources/Atlas/New_Logo_tuji",2,1],"717":["resources/Atlas/New_Logo_tuji",2,1],"718":["resources/Atlas/New_Logo_tuji",2,1],"719":["resources/Atlas/New_Logo_tuji",2,1],"720":["resources/Atlas/New_Logo_tuji",2,1],"721":["resources/Atlas/New_Logo_tuji",2,1],"722":["resources/Atlas/New_Logo_tuji",2,1],"723":["resources/Atlas/New_Logo_tuji.plist",3],"724":["resources/Atlas/New_Logo_tuji",2,1],"725":["resources/Atlas/New_Logo_tuji",2,1],"726":["resources/Atlas/New_Logo_tuji",2,1],"727":["resources/Atlas/New_Logo_tuji",2,1],"728":["resources/Atlas/New_Logo_tuji",2,1],"729":["resources/Atlas/New_Logo_tuji",2,1],"730":["resources/Atlas/New_Logo_tuji",2,1],"731":["resources/Atlas/New_Logo_tuji",2,1],"732":["resources/Prefabs/Effect/T_fire_jiguang_L.prefab",6],"733":["resources/Prefabs/UI/AutoJoinCountDownUI.prefab",6],"734":["resources/Atlas/Battle",2,1],"735":["resources/Prefabs/Item/tuji_L.prefab",6],"736":["resources/Animation/EffectAni/zhuanhuan.anim",1],"737":["resources/Atlas/MapItem",2,1],"738":["resources/Atlas/MapItem.plist",3],"739":["resources/Atlas/MapItem",2,1],"740":["resources/Atlas/MapItem",2,1],"741":["resources/Atlas/MapItem",2,1],"742":["resources/Atlas/MapItem",2,1],"743":["resources/Atlas/MapItem",2,1],"744":["resources/Atlas/MapItem",2,1],"745":["resources/Animation/EffectAni/huixue_xiaoshi.anim",1],"746":["resources/Prefabs/Effect/Zhangai_hit.prefab",6],"747":["resources/Prefabs/Effect/T_shouji_q_L.prefab",6],"748":["resources/Animation/EffectAni/shouji_q_L.anim",1],"749":["resources/Animation/EffectAni/T_fire02_M.anim",1],"750":["resources/Prefabs/Effect/T_fire02_M.prefab",6],"751":["resources/Prefabs/Effect/daojuxiaoshi_H.prefab",6],"752":["resources/Animation/EffectAni/daojuxiaoshi_H.anim",1],"753":["resources/Animation/EffectAni/daojuxiaoshi.anim",1],"754":["resources/Prefabs/Effect/daojuxiaoshi.prefab",6],"755":["resources/Prefabs/UI/ActivityUI.prefab",6],"757":["resources/Atlas/Battle",2,1],"758":["resources/Prefabs/Effect/T_shouji_q_H.prefab",6],"759":["resources/Animation/EffectAni/shouji_q_H.anim",1],"760":["resources/Prefabs/UI/LoseUI.prefab",6],"761":["resources/Animation/EffectAni/jiesuan_shibai.anim",1],"762":["resources/Animation/Ani_UI/LoseUI_ani01.anim",1],"763":["resources/Animation/EffectAni/T_boom_H.anim",1],"764":["resources/Prefabs/Effect/T_boom_H.prefab",6],"765":["resources/Animation/Ani_tank/Tank_G_attack01.anim",1],"766":["resources/Animation/Ani_tank/Tank_G_idle01.anim",1],"767":["resources/Prefabs/Effect/T_shouji_n_M.prefab",6],"768":["resources/Animation/EffectAni/shouji_n_M.anim",1],"769":["resources/Prefabs/Item/jiasu_M.prefab",6],"770":["resources/Atlas/Battle",2,1],"771":["resources/Prefabs/Effect/T_shifang_jiguang_L.prefab",6],"772":["resources/Animation/Ani_Logo/Logo_tanke_ani02.anim",1],"773":["resources/Prefabs/UI/LogoUI.prefab",6],"774":["resources/Animation/Ani_Logo/Logo_yan_ani01.anim",1],"775":["resources/Atlas/Battle",2,1],"776":["resources/Animation/Ani_Logo/Logo_qiu_ani01.anim",1],"777":["resources/Animation/Ani_Logo/Logo_tanke_ani01.anim",1],"778":["resources/Animation/Ani_Logo/Logo_ani01.anim",1],"779":["resources/Animation/EffectAni/jiasu2_xiaoshi.anim",1],"780":["resources/Animation/EffectAni/shouji_q_M.anim",1],"781":["resources/Prefabs/Effect/T_shouji_q_M.prefab",6],"782":["resources/Animation/EffectAni/xingxing_xiaoshi.anim",1],"783":["resources/Prefabs/Item/PowerbuffPrefab.prefab",6],"784":["resources/Prefabs/Number/ZD_Word.prefab",6],"785":["resources/Prefabs/UI/JoyStickUI.prefab",6],"786":["resources/Atlas/Battle",2,1],"787":["resources/Animation/Ani_UI/EffectEnter.anim",1],"788":["resources/Prefabs/UI/RichMsgBoxUI.prefab",6],"789":["resources/Animation/EffectAni/chanzi.anim",1],"790":["resources/Prefabs/Item/jiasu2.prefab",6],"791":["resources/Prefabs/UI/ServerItemButton.prefab",6],"792":["resources/Animation/EffectAni/T_shouji_zhiliao_M.anim",1],"793":["resources/Prefabs/Effect/T_shouji_zhiliao_M.prefab",6],"794":["resources/Prefabs/Item/zhuanhuan.prefab",6],"795":["resources/Prefabs/UI/JKTS48UI.prefab",6],"796":["resources/Animation/EffectAni/jiaxue_2_M.anim",1],"797":["resources/Prefabs/Effect/jiaxue_2_M.prefab",6],"798":["resources/Animation/EffectAni/yinshen.anim",1],"799":["resources/Prefabs/Effect/yinshen.prefab",6],"800":["resources/Animation/EffectAni/jiaxue.anim",1],"801":["resources/Prefabs/UI/PVPMakeTeamUI.prefab",6],"802":["resources/Atlas/Battle",2,1],"803":["resources/Prefabs/Bullet/BulletThrough_L.prefab",6],"804":["resources/Prefabs/Bullet/BulletThrough.prefab",6],"805":["resources/Prefabs/Effect/huolijiaqiang_H.prefab",6],"806":["resources/Prefabs/Effect/Fire03_H.prefab",6],"807":["resources/Prefabs/Effect/baohuzhao_M.prefab",6],"808":["resources/Animation/EffectAni/baohuzhao_M.anim",1],"809":["resources/Prefabs/Ani_tank_prefab/Tank_LvDai_R.prefab",6],"810":["resources/Atlas/NumFnt_0",2,1],"811":["resources/Atlas/NumFnt.fnt",4],"812":["resources/Prefabs/Effect/xiangzi_H.prefab",6],"813":["resources/Animation/EffectAni/xiangzi_H.anim",1],"814":["resources/Atlas/Battle",2,1],"815":["resources/Atlas/Battle",2,1],"816":["resources/Atlas/Battle",2,1],"817":["resources/Atlas/Battle",2,1],"818":["resources/Atlas/Battle",2,1],"819":["resources/Atlas/Battle",2,1],"820":["resources/Atlas/Battle.plist",3],"821":["resources/Atlas/Battle",2,1],"822":["resources/Atlas/Battle",2,1],"823":["resources/Atlas/Battle",2,1],"824":["resources/Atlas/Battle",2,1],"825":["resources/Atlas/Battle",2,1],"826":["resources/Atlas/Battle",2,1],"827":["resources/Atlas/Battle",2,1],"828":["resources/Atlas/Battle",2,1],"829":["resources/Atlas/Battle",2,1],"830":["resources/Atlas/Battle",2,1],"831":["resources/Atlas/Battle",2,1],"832":["resources/Atlas/Battle",2,1],"833":["resources/Atlas/Battle",2,1],"834":["resources/Atlas/Battle",2,1],"835":["resources/Prefabs/Effect/jiaxue_2.prefab",6],"836":["resources/Prefabs/Effect/Fire02_M.prefab",6],"837":["resources/Prefabs/Effect/Player_yinshen_L.prefab",6],"839":["resources/Prefabs/Effect/dianji_H.prefab",6],"840":["resources/Animation/EffectAni/dianji_H.anim",1],"841":["resources/Prefabs/Effect/T_yujing_blue.prefab",6],"842":["resources/Prefabs/Effect/JD_boom_H.prefab",6],"843":["resources/Animation/Ani_UI/ShutDownUI.anim",1],"844":["resources/Prefabs/UI/BattleUI.prefab",6],"845":["resources/Animation/Ani_UI/10MiaoDaoJiShi.anim",1],"846":["resources/Prefabs/GameMapItem/WaterPrefab.prefab",6],"847":["resources/Prefabs/Bullet/Bulletjiaxue_L.prefab",6],"848":["resources/Prefabs/Effect/T_guiji_L.prefab",6],"849":["resources/Prefabs/Effect/T_shouji_n.prefab",6],"850":["resources/Animation/EffectAni/shouji_n.anim",1],"851":["resources/Prefabs/Bullet/Bullet1_L.prefab",6],"852":["resources/Prefabs/GameMapItem/GrassPrefab.prefab",6],"853":["resources/Animation/Ani_sence/Grass_Ani01.anim",1],"854":["resources/Prefabs/Effect/T_yujing_red_H.prefab",6],"855":["resources/Animation/EffectAni/T_shouji_qianghua_M.anim",1],"856":["resources/Prefabs/Effect/T_shouji_qianghua_M.prefab",6],"857":["resources/Prefabs/Bullet/BulletThrough_H.prefab",6],"858":["resources/Animation/EffectAni/tuji.anim",1],"859":["resources/Prefabs/Item/tuji.prefab",6],"860":["resources/Animation/EffectAni/tuji_xiaoshi.anim",1],"861":["resources/Prefabs/Effect/Player_yinshen_H.prefab",6],"b2VA7gvxNEjZaBzyJJH5Jr":["resources/Animation/Ani_Logo/Logo_ani02.anim",1],"87I6ggJtpHDKjTByBDLaPS":["resources/Animation/Ani_Logo/Logo_light_ani01.anim",1],"2fqfeW1EdPc6Y0dmNqZWwp":["resources/Animation/Ani_Logo/Logo_light_loop01.anim",1],"28v1v0/7FKO4Ssjc/JOnGV":["resources/Animation/Ani_Logo/Logo_yun_ani01.anim",1],"f6VLQij4REdKkDkWDGPLLA":["resources/Animation/Ani_UI/DaoJiShiUI.anim",1],"fdVbAqn3dCZ5I91P6Xd0TA":["resources/Animation/Ani_UI/JiDiWeiXianBGadd.anim",1],"2aM3c6kQBNqqki3iTcNDj7":["resources/Animation/Ani_UI/JiDiWeiXianJT.anim",1],"7ePKE8lQFHW7jj2JOtcGh7":["resources/Animation/Ani_UI/JiDiWeiXianWZadd.anim",1],"adP55z3nBIHKPrChH2cxtS":["resources/Animation/Ani_UI/JiSha_ani01.anim",1],"3dE+jiUidOs4k2UeqIiG27":["resources/Animation/Ani_UI/PingJuUI_ani01.anim",1],"48G/lfHCBHtZmtxO8fPyRE":["resources/Animation/Ani_UI/TeShuJISha_ani01.anim",1],"33S7zTtVJEk6oH0Is15Zx2":["resources/Animation/Ani_UI/WinUI_ani01.anim",1],"2b2VieDw5OAqz3X5B7gaRE":["resources/Animation/Ani_UI/bifengban_enter.anim",1],"761UzSbXlGX4PeVAtq4zl2":["resources/Animation/Ani_UI/daojishi_enter.anim",1],"2216v4Cw1Kh6lwowL/76c0":["resources/Animation/Ani_UI/jiesu.anim",1],"6axa+WsclIc4D/Zz/j3Nf8":["resources/Animation/Ani_tank/Tank_Lvdai_idle01.anim",1],"921tZXUH1JB5Xg5gOXklBX":["resources/Animation/EffectAni/Fire01UI.anim",1],"38gCgajeRKO5nN1GAxRZ0j":["resources/Animation/EffectAni/Fire02UI.anim",1],"f2bE79UTNP36y7OLeJzN5K":["resources/Animation/EffectAni/Fire03UI.anim",1],"b27B19KRJPzaOS+EPu0Eaj":["resources/Animation/EffectAni/Player_die.anim",1],"bc118a+h5P6o16uA6rwctz":["resources/Animation/EffectAni/Player_yinshen.anim",1],"db3G8z4kxDx5G4ySM9sjcd":["resources/Animation/EffectAni/T_canying.anim",1],"8a0aNutoJBW5ZiEgtsPpfm":["resources/Animation/EffectAni/T_fire01.anim",1],"73VV8hTvlGoJUZRmADXdmQ":["resources/Animation/EffectAni/T_yujing.anim",1],"5fHYuBlPRAOqAhznp7r+zm":["resources/Animation/EffectAni/T_yujing_blue.anim",1],"20t/wtziZIn6n1cnNtEJ5Y":["resources/Animation/EffectAni/T_yujing_red.anim",1],"ccLrbjUohPbIj9ttgCgI2g":["resources/Animation/EffectAni/T_zidan_jiaxue.anim",1],"62ceB331JMgJfa8pAsrq7s":["resources/Animation/EffectAni/T_zidan_jiaxue_H.anim",1],"2cCxHcvVlCKawoP5Xo51xL":["resources/Animation/EffectAni/T_zidan_qianghua.anim",1],"58Vm4Zz4BOBrFwrjyiQI4+":["resources/Animation/EffectAni/Zhangai_hit.anim",1],"8eRU7+JdFOrovaq/8YxAi9":["resources/Animation/EffectAni/baohuzhao.anim",1],"26b/nH5gtFn7HqPEttDoli":["resources/Animation/EffectAni/chusheng.anim",1],"c4CWEppnZHOJtcFM/R/rWj":["resources/Animation/EffectAni/dianjifankui.anim",1],"06n8SMk9lKf6ZJ1noZsEae":["resources/Animation/EffectAni/feiji_weiyan.anim",1],"d1pyNyb9RDcpWY0gz0K77e":["resources/Animation/EffectAni/fire.anim",1],"7bhhtJICVEgak4KFt7EZZk":["resources/Animation/EffectAni/jiaxue_2.anim",1],"1bdWX7ugFDgIZQYLHsfZWO":["resources/Animation/EffectAni/xiangzi.anim",1],"83HTsUOWVNJZEPxtRkXdcU":["resources/Animation/EffectAni/xiangzi_die.anim",1],"f2bmYaGmRGtruPxRK9QlUc":["resources/Animation/EffectAni/zidan_normal.anim",1],"98LJUVm/tKhqtmwCSgktWP":["resources/Animation/EffectAni/zidan_q.anim",1],"16u8TVIW1NKKAsDrmK8T2j":["resources/Animation/EffectAni/zidan_q_H.anim",1],"19zOF7oQJFxJp4rMTrzPnJ":["resources/Atlas/Activity",2,1],"d8kE3HskNOraYRnaYxnmiG":["resources/Atlas/Activity.png",0],"6b1fzQypRAwZIZXicsLq4I":["resources/Atlas/ActivityPic",2,1],"e68xQT675HKZfvEA4kSknm":["resources/Atlas/ActivityPic.png",0],"34v/EjK1dPkKziyIZn2dxq":["resources/Atlas/Battle",2,1],"20wkx7r05LO5L2PvQg5zW3":["resources/Atlas/Battle.png",0],"3c+eTfr6FKlLYHa4Y4yUn7":["resources/Atlas/BattleUI",2,1],"fcJS4K3v9B9LpajzpsNm+D":["resources/Atlas/BattleUI.png",0],"3d90aQxTdNdJ0FKeaqGNuT":["resources/Atlas/HeadIcon.png",0],"aaTaaCoh9C453rhErYFpS5":["resources/Atlas/LOGOUI",2,1],"25Si/Ki+hMlqF2yaosCl7I":["resources/Atlas/LOGOUI.png",0],"c11AKyHM5BK59eKJvTQygL":["resources/Atlas/LQLogoUI",2,1],"92Sm5Njr5DmbN6OVcGgpwj":["resources/Atlas/LQLogoUI.png",0],"90bi8026VO46VTi2OOg9R7":["resources/Atlas/MapItem",2,1],"96v2cfPGRMrK08a9XaXlj/":["resources/Atlas/MapItem.png",0],"48mbiZAUlNHKlAdDFbQbP5":["resources/Atlas/New_Logo_tuji",2,1],"0c0Po/48ROEpzcz7uf6jDS":["resources/Atlas/New_Logo_tuji.png",0],"30cY9A6KZAL4ICfrChyvll":["resources/Atlas/NumFnt_0.png",0],"6ayE5sGjJGA61lGvlNzV2k":["resources/Atlas/PVPMakeTeam",2,1],"aeQf/v2d5GzL/fTdnhZUd6":["resources/Atlas/PVPMakeTeam.png",0],"4dTAdiZy9G8r9woirnLFem":["resources/Atlas/QunRank",2,1],"edbTbev+hCL6zKsAFEoqlh":["resources/Atlas/QunRank.png",0],"a8XdsWvXlJwZGazzOpUQwI":["resources/Atlas/SettlementNotCompress",2,1],"5f2BaCmQ1CnYPuCD1/rLg9":["resources/Atlas/SettlementNotCompress.png",0],"7fZJZgFRdGsrsP8LZ8niIX":["resources/Atlas/SettlementUI",2,1],"661XjWfv1BOayrl/asTWcd":["resources/Atlas/SettlementUI.png",0],"f04ZzQowlDWrrpI0NKx1v0":["resources/Atlas/flash01",2,1],"5fq6ZqOcpDm7bxfIDGgbYk":["resources/Atlas/flash01.png",0],"50755reVdBeqNFdUsQJ1U6":["resources/Atlas/guiji",2,1],"f2WOG6Gc1KWKojWATUYxzV":["resources/Atlas/guiji.png",0],"b3SP5C5JJKvagHdAwAZ8x6":["resources/Atlas/jiasu09",2,1],"540wLvkHJCkYd3UnrqR9j/":["resources/Atlas/jiasu09.png",0],"6dWnikGW1Oy6z1m9lCKBh+":["resources/Config/bevtree_left_easy.json",5],"6d97+ULENDo6vcPFBuV2Rw":["resources/Config/bevtree_left_hard.json",5],"94aqig36VGS5+fOFkM2egb":["resources/Config/bevtree_left_normal.json",5],"cfG7b0l7hI35ANQrjsx61l":["resources/Config/bevtree_mid_easy.json",5],"5dE5gfqQJHE4r03T2WjWid":["resources/Config/bevtree_mid_hard.json",5],"27i97Ua6ZOYolODGnbJiD4":["resources/Config/bevtree_mid_normal.json",5],"cc+SgVlTJHaprY27ZepNN1":["resources/Config/bevtree_right_easy.json",5],"86iQz7YWVPFpZevUzJea7o":["resources/Config/bevtree_right_hard.json",5],"a1SGAPJR5NxLzMSphLnrb/":["resources/Config/bevtree_right_normal.json",5],"5ekrXoy9NKpYd/QQTo0fGW":["resources/Config/config.json",5],"d6Ec/2R5tNaqoFnyFjwMGc":["resources/Config/star_bornpos_cs.json",5],"5cST/NeYFL0rKzzcERMKnL":["resources/Config/star_brick_drop_cs.json",5],"b4gnFz9a9C6L7x3+zBkdM/":["resources/Config/star_brick_drop_s.json",5],"c4vNgM/SRPCYW6KulmR3kK":["resources/Config/star_buff_cs.json",5],"01yHfeQTJB+K16lda8JyXc":["resources/Config/star_bullet_cs.json",5],"aaDuDAtWxDloh/W3THVEyk":["resources/Config/star_chest_cs.json",5],"cbCakw5PxMv6jj6lxkf0e/":["resources/Config/star_client_c.json",5],"6bcc+2QxxDl6mUCgmJyXKe":["resources/Config/star_eff_res_cfg_c.json",5],"80lEQM3ndNeb1KxhO0MpRY":["resources/Config/star_game_model_cs.json",5],"48Wb7WVgxOhYp2BU0n0e5x":["resources/Config/star_global_cs.json",5],"3bKCY/GhZPEqOpo2nDThj8":["resources/Config/star_gm_command_c.json",5],"62QvreR81JypfQftdSAHJ6":["resources/Config/star_guide_c.json",5],"0dL9z7aVVOzLnHkZl9xGFm":["resources/Config/star_item_buffer_c.json",5],"9d4QlQ3DFLSrRin43igKVw":["resources/Config/star_item_cs.json",5],"d0tApmUe1FDI7GGWbLzg6d":["resources/Config/star_item_drop_cs.json",5],"21SZsl3MtMBrkBarQLAhij":["resources/Config/star_map_desc_cs.json",5],"48mL40/bFFMLCnJujvlYrE":["resources/Config/star_map_erase_s.json",5],"b4IWLtUBlJUahNOvk1gGM2":["resources/Config/star_program_eff_cfg_c.json",5],"22f17ACwxOSZuRjaA6FTLn":["resources/Config/star_random_names_a_c.json",5],"8eo8MdhotMQL9ZUvtwZ57u":["resources/Config/star_random_names_b_c.json",5],"4bF/6hcZJBwIArbodwsNXd":["resources/Config/star_random_names_c_c.json",5],"d8f7drNmBCVJlY99dL4KGi":["resources/Config/star_tank_cs.json",5],"f4SeK92jdBW4gRjQ5leqqa":["resources/Config/star_tips_c.json",5],"607D3/6A9AhocAyFFr+cf1":["resources/Prefabs/Ani_tank_prefab/Tank_G.prefab",6],"4akHte6RdNmb8wU3gf4dQV":["resources/Prefabs/Ani_tank_prefab/Tank_R.prefab",6],"7b+zTujMRFn5JWmO72Tegh":["resources/Prefabs/Ani_tank_prefab/Tank_Y.prefab",6],"6d7xG0wC1I+6d878TjLif5":["resources/Prefabs/PlayerItem/BasePlayerHeadImage.prefab",6],"ebwTcHS2NJuZlh4TxmJRsY":["resources/Prefabs/UI/MapDebugUI.prefab",6],"74LiHsaeNKVq1B+Ur570Op":["resources/Sound/1Kill.mp3",7],"e1FtBOByNAZLl6VOQ5rIk6":["resources/Sound/2Kill.mp3",7],"64+1SQaRJGZIiieNaO+mJ4":["resources/Sound/6Kill.mp3",7],"b6zrIR9CFLcbMYLH/r08Np":["resources/Sound/7Kill.mp3",7],"f8Bw3jRBZBC4cPqMi9Xdyd":["resources/Sound/BtnEff.mp3",7],"04BPi+E5pEbbYMh10JCKav":["resources/Sound/CountDownEff.mp3",7],"c9Ewj36PhL7ZvVrrB5FwlJ":["resources/Sound/GameBg.mp3",7],"c25hkyc1hKxL5/F18zIBcB":["resources/Sound/GameBg2.mp3",7],"fdsvPv1f5OBp6DVtrKO+Vh":["resources/Sound/Jet.mp3",7],"daF455P9BKvay2VLcIE5N2":["resources/Sound/JetDropItem.mp3",7],"abMtVEdoFC5pxRhr8A+1jx":["resources/Sound/LogoBg.mp3",7],"128t6zOolHoaJ0b5TNzscM":["resources/Sound/PlayerDie.mp3",7],"12yMwBnoRMCbUgq0fBGBML":["resources/Sound/StartGame.mp3",7],"2auhuuAXxBkalLJJdsA4Gz":["resources/Sound/alert.mp3",7],"b5lFSW4ElPCL2/yo0Fx4le":["resources/Sound/baseDie.mp3",7],"fcfjudDT1KObbY4EaiOMc4":["resources/Sound/enemy_2kill.mp3",7],"23u3a9tVBHOqNTIgi/xVYI":["resources/Sound/enemy_6kill.mp3",7],"68QBwaRr5J/I9ST1N0/zDF":["resources/Sound/enemy_7kill.mp3",7],"27qyj6vDpG1o7OH6eIQOke":["resources/Sound/hitBlock.mp3",7],"03nZvrV6FDAJDywDe34AAh":["resources/Sound/hitNoDamage.mp3",7],"95QmmOItxEhaEaItmw01jq":["resources/Sound/hitTank.mp3",7],"b0e94Ebx9FCa66IszYaYnx":["resources/Sound/itemShow.mp3",7],"1cMied+fhHZb3sAFP2GVRw":["resources/Sound/loseMusic.mp3",7],"c6n4UzBF9IgpyH68plO6pS":["resources/Sound/pickUpItem.mp3",7],"e3nDEBKLRATox3FGtcf3MN":["resources/Sound/preGameBg.mp3",7],"eaVg7BAtxL/qjnf3DrkdsC":["resources/Sound/preLogoBg.mp3",7],"aaYyyv7JRCF5fG30XWN2yY":["resources/Sound/shootBullet.mp3",7],"32uf/unx5DLJAjQ3CdbZNz":["resources/Sound/shoutdown.mp3",7],"2e2ADTfx5AIJsXLmt9tB3h":["resources/Sound/studioBg.mp3",7],"95UvWFSvVFPbIXdaKbGNFr":["resources/Sound/tankBorn.mp3",7],"c4UlDdYbtN5JgabBhdRugp":["resources/Sound/tenCountDown.mp3",7],"aa2KcilLZKLoQlWkC86Jr+":["resources/Sound/winMusic.mp3",7]},"internal":{"71VhFCTINJM6/Ky3oX9nBT":["image/default_btn_disabled.png",0],"e8Ueib+qJEhL6mXAHdnwbi":["image/default_btn_normal.png",0],"b4P/PCArtIdIH38t6mlw8Y":["image/default_btn_pressed.png",0],"d8HsitJHxOYqo801xBk8ev":["image/default_panel.png",0],"56fc2Ai/RFNYpaMT8crweK":["image/default_radio_button_off.png",0],"9dYAAftfRHJqYpJlnj3tC4":["image/default_radio_button_on.png",0],"4bq2fLGOZAmbhANV8Ec/iQ":["image/default_scrollbar_bg.png",0],"6eBWFz0oVHPLIGQKf/9Thu":["image/default_sprite.png",0],"02delMVqdBD70a/HSD99FK":["image/default_sprite_splash.png",0]}},"assetTypes":["cc.Texture2D","cc.AnimationClip","cc.SpriteFrame","cc.SpriteAtlas","cc.BitmapFont","cc.RawAsset","cc.Prefab","cc.AudioClip"],"launchScene":"db://assets/Scenes/ResUpdateScene.fire","scenes":[{"url":"db://assets/Scenes/ResUpdateScene.fire","uuid":838},{"url":"db://assets/Scenes/GameEntry.fire","uuid":150}],"packedAssets":{"011379abb":[0,1],"0113f0b16":[2,152,3,756,4,156,139],"0120d230b":[5,6,7,8,9],"0127b3a44":[10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"0129f574a":[25,26,27,28,29,30,31,32],"016f4351":[33,34,35],"018bea611":[36,37,38,39],"0190abc61":[40,25,41,42,43,28,44,45,46,47,48,49,32],"01a5d604d":[50,51,52],"01c04df4":[53,54,36,55,56,57],"01e6de89c":[58,59,60],"01e71be84":[61,62,63,64,65,66,67,68,69],"0236ddca5":[50,70,71],"024a781c0":[72,73,74],"025383a69":[70,75,76],"02896f6ea":[77,78],"02a1306ee":[79,80,81],"02b15140d":[82,83,84,85,86,87],"02ece0fda":[88,89],"030792dc0":[90,91,92,93,94],"032079bb9":[95,96,33],"0328db6f5":[97,98,99],"0332b250c":[100,101,102],"033d8a8d3":[103,104],"03520e55":[105,106,107],"035a455ce":[108,43,109],"0360d9251":[110,111],"0361e0b94":[79,112],"03749e368":[113,114],"0382b6fb5":[90,93,115],"038930569":[116,117,43],"038da65a4":[72,118,119,103,120,121,122,70,123,60,124,125,126],"0390417a3":[95,53,36,127,128],"039ea9af6":[44,129,47],"03bf9212a":[70,130,131],"03c5044fd":[132,133,134,135,136],"03cf9e8c7":[137,138],"03e7c6c2e":[4,139,140],"03f21b81c":[36,141,39],"04214dd5d":[142,143,144,145,146,147,148,149,150],"04487ac5e":[151,152,153,154,155,156,157,139],"047a896e6":[158,159,70,160],"047cea6fa":[5,6,161,7],"049ec1412":[162,25,163,28,164,165,166,167,32,168,169],"04b4c5d84":[2,152,170,171,172,173,174,175,149,176,177,156,178],"04b71e3e4":[179,180],"04c24d977":[5,6,181,7,8],"04d1412f5":[33,182,35],"04f6c11c5":[183,184,185,186,187,188,189,190,191],"04fc11643":[88,192],"0501d5dbb":[119,70,193,107,194],"050eb6ff8":[195,196,197,198,199],"05204116e":[200,201],"0528701e4":[202,203,204,35,205],"052af253f":[206,207,208,209,210,211,2,152,212,33,213,214,215,216,217,70,218,219,220,221,156,222,223],"05377cd10":[224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257],"05523f247":[258,259,260],"055810f1":[261,262,263],"0593d832b":[264,265],"05a47c934":[151,152,153,266,267,154,155,156,139],"05e31d297":[268,269,270],"06191de6a":[61,62,63,64,65,66,271,68,69],"061e96ed3":[206,207,208,272,210,273,274,275,276,277,278,212,279,170,280,213,281,282,283,284,217,285,218,286,172,174,287,219,288,175,289,1,290,291,292,293,176,294,221,295,296,297,298,223,178],"06204a173":[299,300,301,302],"0622512a2":[303,152,156,139],"062c48210":[162,304,305,42,306,43,28,44,47,32],"064d54b67":[307,308,309,310,311,312,313,314,315,316,266,317,318,319,320,321,322,323,324,17,325,154,326,327,328,329,330,331,332,333,334,335,336,337],"06545d224":[268,338,270],"0679ba91":[308,339],"067b35a23":[340,341,342,343,344],"0681bd010":[345,346,151,347,348,349,350,351,352,353,354,2,355,356,357,153,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,155,386,387,388,389,390,391,392,393,394,395,396,397],"068e4d392":[259,260,398],"0692280ec":[309,347,351,353,355,399,360,365,366,368,370,376,149,400],"069396302":[119,70,401,107,194],"06980456":[402,403],"06a113cef":[404,"8c20Sso/ZEn7NUfNSM+EBh",405],"06a9854f1":[224,225,226,227,230,231,234,235,236,406,238,241,242,243,245,249,251,253,255,256,257],"06aa52e15":[268,270,407],"06b82e30b":[408,200,344],"06bcf0d6":[5,6,7,8,409],"06bd8ebbe":[410,411],"06d3cfce8":[412,98],"06deb3770":[413,414],"06e4b9798":[72,25,415,27,28,30,31,32,416],"06f173dc8":[417,103,121,418,419,125],"06f19ba58":[90,91,92,93,420],"070fcb1e5":[72,120,122,421,422],"071675a84":[423,424,425,426,60,427,39],"07209d07b":[183,184,185,186,187,428,188,189,190],"0725805aa":[429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,316,444,445,446,447,448,318,449,450,451,452,453,454,455,132,456,457,458,459,322,460,323,324,461,462,463,464,325,465,466,467,468,469,470,471,327,164,82,472,473,474,78,475,476,477,478,479,4,480,481,46,482,483,84,484,485,486,85,487,488,135,86,489,490,491,492,493,494,177,495,496,333,497,498,87,499,500,168,501,502,503,504,505,169,506,507,508],"07423ab37":[509,510],"075b64edb":[511,70,512],"0772e74cb":[88,119,513,124,514],"077cd3915":[180,515],"078c3be51":[516,517,518,411],"07942e0ac":[44,519,47],"07a830190":[268,270,520],"07bd19a0b":[36,521,56,522,39],"07ee458e2":[523,524,525,526,527,404,528,529,530,531,532,533,534,535,536,537,538,539,540],"07fe35cb":[541,542],"0800b349f":[53,36,128,55,543,544],"08084c46b":[545,546],"081cc298f":[70,547],"0841fac6c":[548,334],"084ab6d67":[36,549,39],"084b75e21":[550,425,551],"084ef1a17":[552,553,554,555,556,557,558,559,560],"0859ca597":[308,561],"08689f468":[72,120,122,562,563],"087eddaba":[564,88],"088110774":[565,566],"088de1ba9":[567,568],"089cd5de7":[569,570,120,425,571,39],"08afd6323":[36,572,56,39],"08c089ce0":[202,203,573,35,205],"08df237df":[72,574,571,301,575,302,39],"08df7e3c9":[576,577,301],"08e528da0":["1aMvx28L1PZpgPVpKcDKCz",152,578,477,4,494,177,"e7q6FL+VZEgLJUjVeDLic/",156,139],"08ea0561f":[579,580],"08f6eba6c":[455,459,581],"0913cf910":[582,583,2,584,585,276,266,586,587,588,214,589,590,591,592,593,149,220,296,298,594,595],"0934c8971":[151,152,153,266,154,596,329,597,383,155,390,156],"09419d982":[598,599],"094ebd230":[600,25,601,43,28,44,47,602,32,603],"0958adecf":[310,604,211,605,315,606,607,608,609,214,610,320,326,611,612,329,613,614,615,149,542,220,331,616,222],"0958e66d0":[98,617,344],"095d39201":[598,618,619,620],"09751d009":[511,621,622],"097e7dbcc":[623,43,624],"097ef7791":[625,483,485,507],"09aacab68":[626,97,580],"09bcc31db":[627,628],"09be1ba62":[629,97,630,631,632],"09cbb052a":[633,33,634],"09db0cd1":[635,152,439,449,455,459,469,484,"c9+lH/PwFGAY+AMl0bEdq3",495,156,139,506],"09ee50d6":[636,88],"09ef659ef":[72,25,70,27,28,124,637,32],"09f5bdefe":[72,25,27,28,30,31,32,638],"09f89e43d":[639,111],"0a0232df8":[640,641,642],"0a23ffd22":[643,424,644,425,60],"0a297b42c":[645,646,35],"0a3054f2e":[50,647,648,70],"0a318c808":[649,43],"0a3eac840":[650,35],"0a45b77b5":[184,651],"0a4948d7f":[88,652],"0a82aad6f":[653,334],"0a9e0aa9f":[70,654,101],"0ac4e5b60":[70,655],"0aca4ccb2":[151,314,153,266,656,154,329,155],"0acc5759":[151,524,2,152,153,526,527,266,404,657,329,155,156],"0b2ae7aac":[658,315,659,316,320,322,323,327,612,660,661,331,332],"0b2c44601":[662,663],"0b2e60528":[664,43],"0b5b4b926":[665,666],"0b62dbdd7":[667,668,669,438,670,671,672,673,674,462,675,676,677,490,678,542,679,680,503],"0b6dc5cfb":[95,53,36,128,681],"0b74f0324":[682,554],"0b76133ba":[424,425,426,683,684],"0b9b7a269":[36,56,685,39],"0b9f267f2":[511,686],"0ba5aa2cc":[307,687,308,311,658,667,312,688,313,314,689,690,691,266,692,317,693,319,694,695,321,696,697,154,698,699,700,701,702,703,704,330,597,705,706,707,661,708,709,334,335,710,711,336,712,337],"0bc7d6ab1":[79,713,81],"0bcd3bcdb":[583,714,209,715,716,584,585,717,586,587,588,171,589,216,718,719,720,721,722,723,590,591,592,593,724,725,726,727,728,332,729,730,731,594,595],"0be2005bb":[732,411],"0bedd9f48":[278,733,475,293,177],"0c264c936":[734,735],"0c2891296":[736,662],"0c381e42f":[737,738,739,264,568,113,565,111,740,741,742,510,743,744],"0c48d2dcb":[200,745],"0c4a9c29d":[70,101,746],"0c5a64a83":[747,425,426,748],"0c682d7b2":[43,749,750],"0c6a69c38":[88,119,122,751,124,752],"0c6f53e46":[88,119,753,124,754],"0c7f99088":[10,2,152,12,755,14,15,19,756,20,1,21,22,156],"0c820a3ec":[757,424,425,426,758,759,39],"0c8b2d2ec":[310,607,760,318,324,325,699,702,761,762,333],"0c95a327a":[72,119,763,120,121,122,124,764],"0cbf8e396":[765,766],"0cc94534c":[767,120,425,768],"0ccdb4b91":[769,770],"0cdc807ba":[598,771],"0ce1a6511":[206,772,207,208,209,314,210,2,152,266,773,212,33,170,213,608,609,282,610,284,216,774,217,775,70,154,776,777,778,218,477,4,613,219,221,177,156,139,222,400,223,178],"0ce20713":[628,779],"0ce57c430":[424,425,426,780,781],"0d003f0cc":[782,403,344,783],"0d049add3":[177,784],"0d355c32a":[430,436,438,785,447,33,452,457,462,124,786,487,497,414,787],"0d41d13c":[228,152,237,240,788,254,156,139],"0d43dd43a":[98,789],"0d4b3e7ad":[790,628,344],"0d5e1f42e":[791,152,156,139],"0d61e4808":[792,793,301,302],"0d623a3d2":[662,794,344],"0d763d46e":[605,273,795,1],"0d79a84d6":[95,796,797],"0d891494b":[798,799,159,70],"0d8ee81c4":[580,800],"0db8d5cd9":[345,346,314,348,350,352,354,2,356,152,266,359,361,363,460,364,154,367,82,371,372,374,475,375,329,379,380,84,381,383,85,615,801,86,386,331,177,391,392,393,87,156,394,139,397],"0dbc3725a":[802,803],"0dbf50fdf":[53,159,36,55,56,804],"0dc873426":[88,424,805],"0e0a5baf6":[552,806,553,554,555,556,557,559,560],"0e2be36ae":[807,808,79],"0e5e9ded4":[809,44,47],"0ebca518c":[810,811],"0ebe56666":[72,812,25,122,70,27,28,124,30,31,32,813,194],"0eecb191":[598,814,50,79,40,72,417,640,61,118,62,757,5,600,88,734,183,162,668,25,552,815,119,6,202,200,816,669,103,340,817,671,818,41,97,63,64,665,95,819,33,184,53,185,820,662,120,159,424,36,268,553,65,802,511,425,121,122,628,42,545,66,90,306,554,128,571,259,262,618,516,555,91,403,426,556,821,822,775,70,186,7,517,43,823,55,675,27,203,824,142,557,92,270,143,770,28,144,44,56,187,98,81,677,60,68,559,145,825,826,45,827,146,828,35,180,580,829,8,301,124,560,148,101,631,166,137,188,786,47,107,93,167,830,189,678,190,30,831,205,679,302,411,620,31,832,833,344,32,414,419,680,263,69,194,125,834,260,400,39,126],"0f16915f1":[95,33,835],"0f19e1452":[65,836],"0f364a463":[837,259],"0f3c2789c":[228,229,233,237,239,240,241,244,246,247,248,250,252,254,838],"0f569cf67":[839,840,414],"0f5917724":[268,270,841],"0f745fca6":[72,118,119,842,103,120,121,122,70,60,124,125,126],"0f7ddc6c5":[429,430,432,434,435,2,815,152,440,441,442,444,446,450,451,453,454,455,456,458,459,460,463,464,843,844,470,471,82,474,78,475,827,146,477,"a2MjXRFdtLlYQ5ouAFv/+R",478,479,480,148,481,84,614,85,492,493,177,498,87,616,156,845,139,502,505,508],"0f89c9fa0":[741,846],"0f8e71405":[816,847],"0f93f3940":[818,848],"0f98dafab":[120,425,849,850],"0fad32770":[851,39],"0fae78df0":[852,853,743],"0fb19557c":[268,270,854],"0fbada007":[855,856,424,425,60],"0fd74ab6e":[53,159,36,857,55,56],"0fe44cc56":[858,859,826,860,832,833],"0fe4652aa":[259,861,260]},"orientation":"landscape","uuids":["9dDFZNSU9KFbz2dnohO8yj","c5OvpjAOBBIJ9ZHjOjU4MQ","220iHabAVM0o5fC/dX8u1H","31sh2XnLxCMoqlC7arm7RH","a5+wExUapOgblwqcd8fyc9","15C9JsxFxAlKWPzTcrYVM2","27aFvURKBBKqnlM04vh6ew","7cmNNmc/NCXo0MbaQytZu+","a7X0PBMz9P4bSW6mCa8as5","ecCEv/WllDbJdzolif4xgE","11O4onlPpO+LvzPXbNQSA1","11qg9pB3tFeqj3xAdcbpgY","2a1EbNfQBNQIIl7wQeno6h","39wxUGk8xPyZHnlWe4xOd+","4d5xQLnc9D37aFTMnQ2TSX","55DYvsO8BOvLjR7p6h9EPV","5fEqPNJ+xPv6x/WlZYFKgL","6dhi1holVN0pSTQbtuBQXQ","815RBB0WlAMrOzvjW8ZH0+","9bNjMw6zVP7I7ajVqWd5OF","b6orrHatdLgqeToRdngH01","c8JYssR7ZKBI0XJOVO+Ouw","cdpxS8DvFFn6+3yWJyk8gz","dfxoTBP1VIK5KHRGft93cH","f25QXFfQxFxo4zNiDeto8Q","21Jto3bLtH0o6JMo2+Ch0H","38kW7+YX9KjqxfPPsEUbVW","80VX8eIJtP/bdYtT82o0ZB","84oa/IQ/NAH5H2pPdK4Ehi","89MmLEcQdNlrMfBgJv9mvg","d3hvGWVS9EXrV2d2qB4iIj","ddInceMQZPGZHr+bOYXl8z","e0Fev8ANJIKKn4Z1OaMcay","43qfi+hJVNd4FdjRtQMoB4","9eYkc9BjlGSIeEZv5KjB9w","a3dK9RrShDYJLl4/SAsHri","50H3/BaIdOGqoXs92bPMNi","75HksQBFFDIaauOcIPwgBN","79wOj721RDCb/RjumUfhTw","f9/W1sOmlOW4U8n/PVS6R+","08p/hxJyZDYLXJGYhaFkvW","31OLyzLldIObubFIKp+ar5","63ACg++/pKi5xyML2ogiXg","7diTKu489FPqMdxQRfi4+1","88MmydYDZHsL/IRggwIY4A","9d0PE4SEJDdZ2G1rbRMB2f","aeghF9A0hOGY6H0XXWBsyY","bdbj/6jbBEA7m8y0Fd8K6F","be4EFGpVJLnL5rnzz+EnuL","ddM2XaAaFH65ftAKWtuZu/","06IqozQ0FDDbtvYtDUFv3o","57dW4vCyFNn6pZbOW7pA1M","9eqz9OM9hOnY0rU0BdJSfE","46GZwveUFOAIT2bUCxO28I","4caXuVRyxNvoC/Hdy56m7W","7e7bk4C/NFb7p3+vr4CFEP","89qFomUQhA85D0an2MULV4","95Ltuf22hAfpkWe2hMcThJ","37MPWdLBBNmIxtEnxauS09","81LgaxSI5EkpFBr3IC+7pi","91EZJvUgVMNLNfqktjkUIu","0eLyYNTjdCqJNd9kPK0qqe","129kcUoUhImpx60Z8UYXhl","3aL0yFLj9Gh7xsDB8oCgux","3awHhRDwdGhIezxEfIFRb5","57/KsPms1Jnr3PuO4tlWhf","64KUtfE0lB6p36qL+WJA9b","89WUTnYOZDqZ2vhIzoSrAG","94IqYwFjFF5pZusqAgtrii","ebQUQi3gZA3Kgh3tp0awWq","79w8FR3rZBcJ9MIicho6dx","f5vfLnbzpECalgeJtITfS8","09tpKjMpVA3Zv4JLwA2fZu","62KZfIlMFAJ4Gmr7sMIZgw","f1AKENK7FGHYstoStrVTI9","9bftt1nSdB548qUif5uccl","a4WHbMjN9ABZSwqmNbV8Po","8cldPkz/xDFr2+NFEy6OA+","99HsF2fcRIHrZ/zTYTC4r9","06cKXD7CFPCIKDSV3WmAkD","4exUBK6WhNcafNG8ewUtVh","8cuEiSmD5IS6XrnLdApOPX","89i8AOb+BIdrLRqAN6jdLj","955+WfNz1N/J2hTk0obn8A","b5xJKPJ5hJdqd8kwjzTmHG","becWc+XTdOVK05BHtBOomc","c5poCz8gRFpInr8YfX54D4","e6aLBPp0VDGIOyJXt6EAyr","19iY1gUShAN6BA/VHlnHCe","312X8YOuVINYRPFDfn+ska","644QNeUoFGpZYeFPi6s6pn","703EkkbFRKPYkK5N4Z5yYo","83PnfDeb9CNIGMu292PRc9","beUX9rST5CO7KsFgloRPkJ","f2OQF92C9N4bWOsDOK2rpU","3eUcydxTJMCrwfBgQyg7gN","3e+Ooq3PVBZJAvQ3gP6eko","3463TWDzdLn5Oe6V3xOLLf","8bn4azKAhCEKX0N4wGq3LD","f3+Jwx/WxPTrDDDtSFf4Xu","34S2OJrnVNIrd361+R/qc7","aeJ6zUlexPOr1ZoTgtDQIp","dbipMVOEdIfY7T9bccTgMf","2b7YJVl15BQ7hRXFkdTzan","d207bZq2NCIZVWnf8peVu7","9fbdYPlj1H4aOpxTbexUmK","bdfUX1xcBBoKEwbyTvDPy3","bdrxQCLqRKxbxCSzTIbgbS","6cu+KtN0ZB56yvVIFDoqS0","a4tUEHCapIwJze287MEwU5","46vnul0cdBJaG0dgoMLBJv","e1OADhH6hAcb92r9UOesk9","53HqGPaxpFHrGy3n+xymX9","5doQuh7P1Cb6HSoSIOoiiH","d2UxknygRGLJXfact9109X","f57J7Iy09AxLRwz+bvnVV4","60MdnVOMBPzb4UwwvlZ0x7","743JHnEeVEJ7purpyXWP/0","0eaWLkyPlGtLAXbU3SxmVz","26pZqkuotC368n4/ZSEb56","4bbZRLwOBKooalsfw6FOCT","5fIYYBbUdAiL/vzVmuBgB/","5fhu1h86VFbZ2CRJqTBJcx","7efYKf9e9MtZTq1DfoUKCs","aaf+ObgLJOhL7MOzxja6jD","edB3rr/TBAfJe80h9zvper","fe13UDv5RHLYi5hxZTyaVK","63U+LzeX5KuaRx7dXk7UVX","67qRjCYs9MEou/Fr+qv31t","b5vJC0aANLjZvKbSc8C+PL","8dSqSKlyBPRrZ6eH45FibP","99cHOmMylHA6/lFSXV2g63","5dQ/evPSZCD7r1ZmVpOZs6","b4oUepE6JHvKHsQzHs4UKT","c18RofPzNLj7wKoeTRqf85","c5kvG3krBLQLsZgymv5Z5L","d4vkrlGvJPRqWMDHWs4VoF","b8TkkcDMNJNJvzIMvd9KWh","fbvUxi13ZB54xHXvlQy0zg","f0BIwQ8D5Ml7nTNQbh1YlS","f0+R8irPxJHrH7CEy/La6g","5fuTsCfilCWpX3F8ozaxxz","81JFMF0TRClKaY1w4bykR0","84A5HcHbRMmqCNJxGvZTWC","86rfCqoutMDYpo/zKLo/zN","983Jr5HCdOhYPvZJ0gRp2q","9fvW20ixFOh7Kkb3L1rN7I","a9tapjBw9OSK4EzVmsYPmB","addPD+r6tDcoF5nlwTnvRg","c2fl4ORMBFf4pRwvTlN24/","c3MoflYpVL1Z2q9va/lbYk","05f4uDmUFIEYBRjc0VzC2a","29FYIk+N1GYaeWH/q1NxQO","30/J0ASWZE07VgyW9GICpv","7bVXuX55VM36mljrwl8dF/","c6N8GMjTJHU5feYrw+82Gx","e97GVMl6JHh5Ml5qEDdSGa","eecmOxqZJDpqaBT0mi4h+9","0fGEiIjmVOMKG29PfWN4rY","4cHV7n+e1PQYsn1A03XdEQ","f0VYZisvdD1YHS5oFieKs0","6apprGVSpPhK9+kVpoC8iV","1fWJJvMY1IIaqMjt1behcu","495Dxag3xKWJ/Fzew3cStS","878VUS4D9L5oLDtIjzfCSl","b3z8jOONxDa785Gv/AQAdG","b7gaqJijhPJK0jaVlSyD/i","c8Dg09B5FNcK/JlXj1eyxy","ecFWS/6gxNS4U4lqFzHYHM","f8fbLUsDZEH4j14vWnz/M3","4cp9/TdcFO4KDyKXMGLTwP","52QoxYtcROaYz5GOsuGvW1","a3JFLgSQhM/pFXlnArReU0","a4+NHYYRVOo4/YvqbhIFHn","b0DDOYsppDnqWU4OxU6oG8","beD6EMemVLGZQ3+Zng9gjY","ceCLDJLzdLCqPrwi6NOhPY","d7MnG4kxpKpK8pCaujFtXl","f9f7DGBN1G56xaXgQZrkCS","4aUwcQqyJO6YrA/hqnyrlU","a6IaT6pMNO4YH8mXa8dPtb","2fXZvCK6pFvZZYuvz+SOUk","65OKa3Ed9PgIqdrhwcaM4V","1fRD2X5U5JH5jf9u6f+Tp9","45ie9EJQtNooKiyPCJjKFm","47BrbmLTRIh4a/+GGJMy7H","7cOT5ovOlK6YXxKAKLGlFo","8aV3lyL7tPvLv6ObHAs5QF","b8uC7o2hhCFIgA/VVtFoq8","cdtKUhxatDRbehBOrO/qjz","d2je/XzrBMRawsbAaIuO8T","ddQUcuwclAd451xEoMlPry","f6jLIji4xCgJ5MocDWpfFS","a2kGB4MHVOibHHcLb48zt6","ecpbvCTfZIs4YErQXDANEy","01ufgsd95HJY4WpyikrxXJ","53g+hCJ8VEy5asEDN/5z/N","ddzIkuorpAJpcED3J7FzkO","e4E2aZaJNOTIiKIdVBPGQx","efvQfByiVL26gkNLsfpItt","28eTXyPotANZ/txC23gdha","ad8+xMPV1EWZeDiGjDB3ND","27xU46lz9GEaERn6qcuulx","805MvGq19FL5OKawj/5Gns","9fpbNkF3VLVI7wgnyK6cLH","d4Lnnp1PBGsaGtlL6xWl1w","00hLKVYNhBkK9m5TYUvR+u","06PljV0jxEa6+Orl9g8MAp","09GUfeVYNMJIrVBDb4hl5G","0dD8KNXqBB4JrNqRqhZcGC","11JJ50aX5KW4y+nHqHo0VM","12AnlJItdPKbbLZ8KswJ/b","43Yc80R3xNN4RgdBLMbuZh","51qbbfTchNcKvh7Z/daNm9","5axnvFHj9F2IRG9XY2Vyi2","5d6ABYbAJOd5F9uVe+MpfC","69PEqjLM9IS4tu/qpaezfd","76ZjsPB21C94rrF4e6VF0t","96wtBNuAZPvLxppqo6JjuN","b67iCQV+lLdZnJNC6vXdq6","d4VZq1r8JFRbqy5NwOgJDp","d4o4j7yRFC/bDifhJn3Vw5","f4S0MIPoRJHrvH0v7Kd9W4","f8At+RB41JBIdZPMFK3uDH","02fAe+C6BHj5WO4GATB8G0","03IIcbOlBLhbSIkwwg/AVS","06+y5vdLhFzYhxo3Gs1y7N","12eOc3JMRKG4T1oPovugfo","15FsH88o1MubjEHEmzFZJp","22P39XottLqYfnK9ODyxEn","43nXnYXj5I1o02NGVXYLcb","58XAwJdwxBg52Swssw1CR+","581Vg36ztKAbUn3p9FKTYh","673Ir5cqlAkbPzE3jhpC/V","68M1G+gnJJU7jjZgE9TaB/","6aPEAJQLhAVLQR5lZIzrTG","79an+7fK5LHIOdxyepyd2A","85ZCLxUiBAl7E2FJvCL3Lm","a0iD6rlxhLa6nwViQ9zW02","a6TUjy2khCXr2IKOSQQSO5","a8NSY3gJRDUbYx1a+PPEtk","a8zAxEgb9Gh6m7kXiIGkKu","acUxu7Oz9Icrxxv4KDXhBp","c0NsS5k0dBS62JFPvEz4po","c1G9YBJMNGuIywZXiZ59iS","c6y9yn/qxO8o4ZefX9Pm6X","cdxTw3jq1NpLa9CnTwwYGs","d2lhGbMHZIHoqxSR6Lac9B","d6SSR/8VlE8oVx+wIwY68U","d8fjqzIABLe57zD5jf2jbU","dalGBogtRD66Gtu4hcf+C/","e19Pv/qc5IDLDhnmY5zHSL","e3kLoWhoJAfpT+5l1qUAlx","e4j1t8bpFB24ntENtf7tLC","e8Ype96LhE/I42VKm4Z/X8","ed2lOOOUhLBYyFUSkVkQoT","f8JdKme9hNM4Y3n+sr9Xtw","fcC8zyA2lJDLxBMjdXmRFd","5ctjOXs+pD4a2NLmZMAeQP","691Erz3zdG+44bQMT/uDxW","f3DerGvIpLMbKx2fOG38Pf","35SV/f7CpFLaGlubMl3UNR","695c8S8o5IcrYO1yAUUd+M","eaEh7SdT9HQpNjDRUrFEaC","306+cqs2NOn70ktNyE8JqX","37VAFayMhOa6Gl1thO83Zg","39KPZzUXNForAFpo8GD/Wn","4b1nhcNw5CDKDV1PEQhROt","55P/2bPBZF+pxrwDriv0zc","76/dURW3JMpaZtxjdI8Auz","83h26G2GpNnIMLBaO4Iu30","64+dXUkupAFKbnBSB1OnCl","0e6MJgyL9BgILSmJGMbkRn","1cEPE9QalHXIp1lVAI9+pi","1cnFbMx3NE35ZTmxlCe2Yg","2925ktg9hEuZtWbbxlrpwu","36KN9VVjhJhpKqhlv9sMHL","39C7T89E5L/ogrj5MneMaT","3ewVNiLHFBcYVfavrQxOQy","4a2ijRsuVKUKoJFo3OBMAt","50PQAjYHpBvKMwXiS6ZDsI","582KPdgVtLxprGlQu51YRu","5ay9iNxwlLfLKobTRPtIxX","67CXMseZRNn4EFuis5si/5","68Ijpfea1Cs52J1IelgrsS","79GdUfFdlDhYxlDCAwI9Vr","9742Uuo5BAeonUjKhFuwWD","b6ZgCcRxtG76BjWUbMjhle","ba8nOAhopF/JzcJF0wxZVD","c4oaVwVpFCaaXlGynj9ml7","c7j9YYu9JJtIkOSgiEu2nB","c85ZraNTNPcIo6KtF7QDWk","cadzB3IzpFmqblqvKmhZDB","cd8X0nIGNFyoupWoVLpWMi","d1LrQ3jcpDpYG+zimwSqRL","e6w6U0knhMqIDRJpyNjWo2","e6+ouBaHJN2rlXAtjKd0Gm","eevHsQzixJB6DtA5Ome26X","f0hLVFW2JCY586rcxylZem","12xqP0TcpPerL4i6c54rnF","91S4OgIHhH2JIPL/o98cvs","a90ahEygtDQL2gSSuwNuAa","d8UZuhG6hCf6/pft+EOf1w","01/VgncKtE2bWnHMXiyOIA","57HJZKMo1Le5KXWPiZydCV","61AHVu51pL2bCuTwMn34E8","65TfDwQW5O25HiwYRcjyGU","00wE2svS1Mt6MIEh6ylsQR","02f+NHH21JvYhDH+j0F0yV","02/XNqkLpPj5QmykphvWr/","03OHoIvGZHa5pWKY0EB5NQ","04acFMh/xBKazPA+TUCf/9","0cVLOvOZBEerIuC9Ikr/EH","10SybgbSBI4JHpx6Dywhh8","10aY44y9xPD4hcwKOwE7k0","2332HTeF9M5ovSk6NCKtDb","37hMDw7zFEELcCdJBJpixH","466zSVfFJFeK20FltzQ9Is","4aCpWmtTJNCIWez5av9Jb9","4cqKuQCqRC74uKEGhR0hVh","60bHrs/gpAUJxeY6PvSufe","608+BS4ydB0omjRGIbnJtj","625MLrH1xJmIsAH9WHaYqx","65lh8HMclDBKJXu5eVcg3d","68JPiZW7pO87ngAIpPjmzw","75SmRlhmxEl7FZiMs4M8G6","80IZT7AMxA9oZwY1jrckVf","873b4pOiBPN72/Nho2s8Gk","a4o+So8R1EoKIZx/b0YDOp","a8YMZ/DIZLaLOo6yQIJaWu","aaGCFqapFP4JQ9sBuM13dK","d6RZbdqehIJaf52sv3gX3Z","dbKbl/OJdJK6HAzOJRH1Vg","defsaHha1HhpCUTnFprWTQ","e5r2p3AoJJar3d9UOOsMCI","e5zM9DeoRP/YvFhzu5e/Iv","eemW2Hw0FL9br2eI76g9JC","fdJ1VJeAFHYLmQDynq80FG","6881GQHq9J07eXOy3fvZJG","72fzf1XvlAK7SZfSs3MHTa","2cBS3zqPNBb6iSMoq1oQav","2dhuf21i1HHKicWp67Zuru","68Gfz2I/hFCpic42L//dip","79tHoJ2fZE/aEnydh9wpu5","df6IRlT/JKmb/epNTXOK4i","01W7dkDlhHBYSGiLxXX39W","02hdja29lGq59gQMO1NzxG","0bPfxSCL1BQqQkAFDHhO63","13n26fAJ9JWYw6RV4d1awL","136jSdCVNJa5fmCVo3gyBT","18VGUH1BBHcJ4sHTS1VPmH","1a9elWgNZKQYJYWF+EXohX","1cFK5jgLJHx5qzP30sBE1k","1dX+3Y1gdPvZvalHdRXcQ6","21Z/RC8E5OKZuXXtameJGI","26VkCYpQNGAIlEwatVKzDi","28wR/V+5hMBbfkXkNf4KLs","2aVtaHIo1FnanjhH1lQvB/","38Zo9zGcVPz486LkLziI6U","3bbng9b4NBnp5q3nc9Dgb0","42Wdlzk9hITKXS1b/YgAPt","54qVaAkgFG4b3yI95vDtOR","59WxcCsO9C1a1MzAwZshna","602ymcJXdDsp72fxfWXAKH","68pK7v7xVHuLdPlTx/xjNL","7aExUQ4qpFzLrL5/Ys3sNx","81KyoRI8BHgpxHHhDDChIq","84e1MGFD5PP59+lzWEp3DC","85nN1eyWhEcpPu9Ce4peWo","88rkxN/l5ORIaEaav/1KMq","88t32WnrZHSJpIw+vuaHnm","90bepfip1FCocKOxx4ED1H","91NlOYYFdPi5FISzOzB+eF","92f+koO9NHM4arMFraZhao","96G0A5t5VMZoSBLNKFzwOn","9fkqT5+NNIHIGTqVsmZ5wQ","9f7sMSj9pHnqOEaKcIQMQl","a0MHuxYa9DD7lSogACl4bA","a4ZScUl6ZEZ4rAnt8be2eN","aa5MLvibJLP4+bZYAbpBkN","b1T49qeRxFLY+g6uGTezof","b8NwobLy5C3odWoH64USxI","b9ci8sG/hPKpmqgJ01R/s0","bcRpaiONtDyal+caNHXt3v","c2U4AJ3EJPqp5udl9onErd","c3Tx4/+mtF845ENzaqVWxf","c6oX1uDSdDOq5mC86WiggH","ccF1j8EgJFmY2miUP5HWZa","cenYHN+VVPwZMCg+Srf1Rt","d1y9Q9icZKX4f/aN5xJYoh","d2seDNVAdJa6Qv+3kBhcK4","d7M1qBnvNLmZpN8/pnx9LI","d79+9bqLxIh5wAHwql04KX","e4jzasMFFNxLFc6Z6hvIxu","ebf9kDuUpB4KaebbiaJB2w","f55lkaAcpA7pmZwCfmPB/O","f99VsYb55KbbsHDM2B6YEf","fcc5ypezxMArP8ufdN6DIG","feJ0ahFo5Be5dsP1ehzJ2w","28DGa5HkJBWorZw7lRvDGv","f65lsfwaZGLJPbJIBKtVqx","b4gX5YKP5Fsq6GblfH8UAO","1cYyYe33xHzb1zwHKcI1Uw","732k1j7ftP4rVujrj/nSpw","44yxX6BxVF8brvVjCRQNzN","fdYxGPUTBGH7XTd6TyWo9t","88TXE+HMhNiL4wTaWl8Oqq","a4BkKL3Q9GMJ3pE5gOpBbx","27EQGPvRtLwaTJ16+miZgu","c6ShgK10BHOrdJct+B+NXo","d1QBoGec9CCIy9BbzRipeC","d8qHJli8pPe7Aymmu8lkHC","6201XxmQ1GM4ecCdeVrJwc","762nQeXMpOTIIFK5zwFsD/","e2XSAED0pDkbINuffYEcKe","46xCxilDhOmJITXgyfKvvz","fcztdys9NCm7EfwVhtIVCe","0bDkpoMFlAVrmoqydTCinA","9dZYHdr9NEyqWl5NBN3DKq","e3ebCiCwRL/Kt6V1vUWk98","d3K02OoRlJHKOEm54mjtYI","a0OSIldwxLPbLWbBgZxA7a","acR5d0xR9IwJGt+RRwSfNw","316ZfZoiNPNIO4PhNW9xZ4","4dGu1z74VKu7GDAFoOXdDP","596a0BgDdAI50NfAxDKwmi","74Hoh4rY9N37EpO6sIEK8C","ecn13t0f5Ic5hEIEzb1XQq","a1nupjET1HcoNT6uBpWYpH","0273o8ob5NcaNUNf0i8Tzp","08L+cdXZZHS59r32etsaNM","0a1GQ8o9dMXLezdUAWMoa9","0eMoyyCOBKfY3fa3GfhaIb","16KBnNsTNNw67p3zAmkPVq","20B7ikWMNNEa6MKnLw8T8M","20RsN6zCFDVZOPLOfGXpCF","20Sjk2RVxNSrVPcPCjDpWi","22KTFKI/9OFa2e2hB9cTIT","2bz/Jy+dlEYYctQ3sBmuCC","2b/JpB+AtKQ7g8936K0L12","2d/POR/VdIRpD9exLOpiS8","34oiGB9MdII7TU4NlcxLAM","35gThKL9hAfZXPoZV3Vz54","35mC81b7hPPYwSGH3MRP3Z","3bEfn+W81Dyaf4L/n0BH8a","3caP9htX9MdpQvo3pGt3ao","3fo4wK0hRJHKGUBscAWuvV","43nl5+/ZRKQ5YvBA1uM3+o","45md7B1oVOpZCSvkX3Y3wY","4aDoNu1HpC8rO8hkLMizkE","4axUfEgxZLU4WHVdbQFhrw","51JVMq6epDY5Vqq2IyIU3Q","52FuCDN2RHnpnY+cvsSRwv","529wV1/V5L3o+pr3SKqBzt","53AS6VmShHuIHAxG9+jiow","58LiTPViZPKrHZe9c7BvC8","5drszDf99IHKAnchAofpCT","5dspQNfMFKBZAnkmoDN43Q","60Ud9OnS5Ho6x/08x92OR7","60jCGiFNBHVLwSIBvVw3nh","641mSjl3dLKJGZIhtO+SOe","69yjmIOp1CuYmDLkOP2KDd","6boDiCn3REi6DNw82tap4F","6dYypTPR9PFZp2q4N9MFev","70s447/0ZOUZRVPhyzJ5dm","7bRXkNrzhKoJqYv3aEXya7","7cIiCIaDlMR4dtlkz3zGu7","7cQfxudwdOcJyWloArqlbT","7dPMsXIH9FbJFTWx7AlT9Q","7dex8WZbRBvZCwyacdYE7y","7e7OrpKEZJpYZLsdweWYiy","851XEo3atNjaYDfSOi6lEz","8d8T1irDhJi418/oXFmDjr","8e73zDTV1Fg4QKd9RN4y7w","8e+iDWcZJC8Zh9gkoWH0yk","9bsWayJcpGe78xi8otVqBj","9cGdkN/f5JLbgStpSnvgCo","a18wvB+KRIj69H6umIvZtn","a5R5Vij8xFt5Yj7mOJcWKG","a58YQw4IRLyKiu+0KcNiDx","a9oS6qJZJJioegUuarhqqa","aeRxA7cbZDbpTVj4Jt75UW","b0SJfJ/phOOrlSbbnUAPfq","b1nFziqyVBlYDjwBq33VRn","b62N0usWhPp5VjkAMom35G","b9K5oLy5xM8rLr7zWAw9Ny","baCGakyTZJx5T4ZAkjv90U","c0BBsBd/9EN5/KRPfmhnX4","c2gyhYnWpEAK5boyWds53R","c609YCMSVMcbqOOAwfx3GA","cc5RxEWg9DHo8AGmdcni7w","cdUKbzHpJBdZEFCbz8mBU8","d1gGTKdqVOmKQ1nNFToSLZ","d5K4qgW+dEEJPhMQRmT/rP","d6JtJ/ZNJFI5jAUF+ldE8N","d8nOMivrZEYbDTh6J4Unpq","ddKa4j8ZJFN4f+0I8iG9un","df27Ty87pOnLE1igPJtT7p","e6W7Q+P7lJpr+EboiXCklY","ebNT++Sa9Oz5gURFcoGJby","ebqzpdTHlBO5XmsQZBm4GQ","f0D9KCKyBDD5XJQZ0eZ2mJ","f2NO5hwB1JZr+wT0fYGxKR","f2/dATR8xBP6pVCT8jjB6M","f5C91c0cxOY5FdsPu4M8J5","f5lOyLklVN8qcbjOo/YB8o","fcJ4hwI0VNl6AVY80ZMti6","fdC8HcQGlAiK1qBfbvQdxg","ffQhOzyzFKbrWp5o/D9d8d","deS3jOKYRCm6APIvgMq3tc","f7fZtkEZlC9ZT78PwJsffl","59yi7WrJlA+oXFKNo2aYiE","88is9+OvVOppy0X1RncK3c","95jIWA14lEU6KmXuxRWdkf","d2vhnKI9hBOrcIQ0IcJki7","dfkaKtN91CpbpGblqC5iT2","6dCB3XOwJK4ZdIthsiI7Or","7cuCTzwudKnZFs1JA1K9LO","a1Gm/05yRDLKW4cU3AKkV8","a56P88YNRFrZEwc9tH5bhb","ee1K+1zExIdb4ZKUANHrfk","63ejb/ZqtMVqxVzvrPZFBw","bf71JgnA9EV7VvpBqxU4ce","16JDMOHoNKdLrB25kB3CKH","1atJ2xj6hHYpLvk6P8W5Vi","29tNLs2tNEk6SDEepQgqPi","34N820zJxMy4EqsyfDWrs4","343Zzijt1G7oPxa5HJq8DG","55TextD7ZE962O3IGZRMko","5f7nQBaC9CWKiEImpzCPM5","725bxPfeNK2ZAYUimG+T5J","7dGFezE1tPdriD4hy3FFD8","a6GH1jv59K2LOzNBuBKVfk","baOOY/JodB/4g5aYxPiKKd","c8qX0vEvZDaZye9D8oa1Kx","caiPg0JJ5OmYlsEzXsiJkX","d2h7T7E5JDSJ2Fg+Scuw/4","d3cz+PPGtExJ/ere176N+a","d7zZGXek1M24YzB0MB5nT4","dfJvQ7KJRBH7YBwaFf6/v9","e3ZprLSnhD+ZNv68j5kRtR","38+VBVVIhPmKYUzs+Ydlg9","d18tBER9hChoNPrBU4ysNJ","8f8ExFn8tOiIHQaPeBwW9m","be+ab/d/FIeKntu865Sna0","63Vw/Ro9lMCpR/qVaeKh9A","78M+4X2KhJ0JOw/GW92JUw","a7XJqMFFhE/5iHdPIVzD11","9c1sbJHmhOpoxRNyhoJO1q","afShffH8VMP79GNmrC7tYZ","38AG2Li2NFXo/ACS43D7IG","f4KY1w8bhI9LITCkEa8N5H","22EK+fe7FDDrDUR43iuCUA","56qMQcm21MaII+Dg7xhZGn","66xU5g+xlCIpIHeCptAqoA","6fPQyy6+9GPI+0LUkuxK1k","76nWxgV5ROlKmRk9QnmmAl","82cK8/s35DnJ+u3LcekwJ3","94mU+dzmJONJzCIf6Omc/P","98ayOePlFNl6VaD2cSjdOq","abA8+eTgVP/YhCBlWJxh45","74bgXxLvREHpU7gcGCRZ7F","6dVvQ/ElRHWLL5D3BVoXBq","97R4R1KxZIbIYCSSV3WCjq","10dHsrqP5M7JxSDIq7sMf7","6e4z248MNFAL6JEj2H+fqq","834RTkAThGcrnHTIBD8gak","31XufLGQ5EsZovsYGHf2N/","55rWkpRglCkpDgpFvhOzOf","3dsotOR6dKZIoqKKekaZec","40R3rH+qJFqIhH5cFjtsPa","68toe4Em1DeKJEbg+tnLqX","697ztheAhJ6q0dtKzFL/He","9bt7+mKO5J2IPyvYq58xRa","47G+5mDjtEuKTuuSb9V8MI","adtZm07yRBWY7+sh/HG8HL","53mLED2x9NG7+1xRzLqzNU","a8tRVexMZOKLr3fKwWrF1l","573Y0sOt5A+oic1PMkUECr","7976/JiddGz6EA8TD2GWpY","a6hMZqzPtPV7nH1DoC+FLH","abNI/4RfNPLr3udszWp7/d","04lAJQzaJCnp2LI6I7u+k+","07qQCSCCNFZpcmNNp5d+De","2c46BZ9JtF3LJbLhf+pLkC","2dsWNBuspEl7rnlf3IF5wr","45GZGnqCRCBIYayVrMbafq","45uAxyZ/FI+I8W+euzS73/","4e8LFa5xxH6a8+tSnqzpmn","676dNaQpBAs718hHAxn2XJ","afEG91BwhOAKpztzwd4pE6","b5eh/HHKROAIoKMn1LDHbk","b5j56t7D5B65Nu3xI+Bm18","bdAmcy6+pGR5/Je3tne/Se","f50goqlxdPPI1kM3p4Pag9","f8gQsVQ09F7KL8osbjFRgC","9a8IR2autESr0kr0PgJnQ1","aemcyPHctHuaQmSaHZqpj/","010udLNedJ8pxXmKm0SU6H","f8Xfi1UdJII7ld6CaD1nF8","18kT60AOlGuqbESskTsUSq","727csbs+ZCb5kt1gzTkLxm","d7n8IRx/9NbI0qTzfcdIen","f7a/LDWJlD/6S9SnmVmU8v","040YuS5p1A5INfWh3qyPRx","1be123aO5Msa6vwLbU+D14","40oeH+cIND25ZR/UEsRQbu","40vurQ7gxJl7+rm1/4FkRf","55jABzcpFM9JKReBLgGr32","5aRPxN9E1M74Z68I+D4gzU","5dFHIDcNtPoqrw1yJG8XYJ","87IUS0lrJOuKeDGAYpDrL7","974oVhOydK1ZpZ1FnpZclv","b2fLjEEhpIsajgNSTThtMm","baRxs4+QVEnINNmYLMeTD9","c0N2AFOflDwoB6jwQs1UMm","e8JSlAjPxM0awy6a5cWk+9","96XKGycixJeb4Mye99d5a2","6cXi+9Rl5LF6OMQF4YtGyw","b2zQlkmHhG/5M5ANUgkhCd","dcED24P99IWYA2A1nboSiB","957XDxCwhFJLiqEzGqMxsC","deYeyKXQ9EXZ0Nz3GZk9nP","5aDLnuNVFOPa53WeqD9RA7","8fG6inoMtONr3QF3OR9m2L","0bAISKjThONKxbSdracQyt","11tBAGhJBBwrcapouC/hmB","48IzablEFHjY4ls/0HlukL","61RWVVW+hIOpLpnnZVHIME","26UdouMmtC9r148Vwqx/3X","aex5m/1ElNX4dH+FyvAt8z","b5qQR8f9BCNLbk2X0Y3Kpd","beO5aVBRhILoGO1Zu/sE/g","41tfVsUDRIUZCTA+HXbBKs","83sUzHPIxCmbENfAy2iT61","110cNKQa9A3priHBN4+ZXN","14OAqdO3lHSZdvvRRzEMgi","dfw7ObNU5DFbKDqRkZTa1d","eeO0v/UN5OzI7ftSK4kIsh","5bN0niZ55NBp7Y8ZISwhXe","0cdptsPWpNoqTPuDR9xxrM","4e6UuKZMtOrYV1CSqAYAXM","9eL2t2KwNCJJmjC2M4zExF","45IjZ/UNFB9qEOhb321oYb","51I2NYIDFBuY0Fhr66/TSJ","74bReUnGxKYZs963xHl9a8","82xyigVfhLbKeucyAiO1tq","4dnayrQWlNmqoYByNLrtbE","4e8gCSYchK+4lxm/S951o7","19wzUXK4xNUrwRKYUpqN3n","2eEY5UqG1BWbSMYzZMJkDy","e5Xu1eo3JFRZkjJ3Cdmp67","64pRMZAytCvr5mwQ3P7+Wj","d9OTbARHJBtZsz8g9kwU1F","aeG/nDLr1Gi6TiCibIuSVW","7cV6CgSa9GV4TGRvcgC8h0","52fUI/izNN7qKEoVVWFiDm","523E8xSd5KnYWFScha+9Xq","067f+ZfUNNsJwdbidksjsF","28ig+UY6tCS5di1s7F4ymM","afgmgE+qxAkKGFttZEsWhd","d5YPFm0gBO4YtwBzj23MwW","4aITueRv9LO7GXJqwisaJY","dbygm+HsNMlaotd2v94OHr","43sjvOwApHuaNYG7E2fDMH","3ePCWmLeVM5qlQl6K6f4MZ","b3Xh+9ABNEC6ENbF0dbrh9","0b5hb2HMVM4o5w8FTaSw6M","207+Ny6xVBn4qqzuCHczif","2bVQ43x15OVrQNrdN0C1Xr","2eqUmufkZLabcKoXWI+fQn","2e6Z07qtxIToLfjpIvQw6v","4cA11IX8RHSr1xWOkMjOyZ","5azd7X79RJD6eonvcteNL+","5cwxhLZ0FIrb/zwcvX1cy6","7fobfV7xJCk6Vi6vVHLf4m","88RR1dIrhJa4gCrSP0uhQI","8evLlwVatI6qJAUIMnjN49","cfsAWUxmNGwKKGSeZmvtct","d6VL3x6WdLW6Ec3tKoGYDw","e7fbSxHZ1GraYHovM9808k","94FwVC1vlOXL18hQ08URGr","57RDBNPoNNQoMigvdpkUQE","864uJmUlBNYLW732P59sHM","cevt0qNgNF06Y6JScTDN/d","c0UrH0iRlE3bWQKeftCFuk","f1TkpTqQZFGqL0Dxx+I5zg","01fR42jjZNILJAsSFPhRbV","0fXsmdj3JKb4CE933trWuD","151zUz/5xMDpxzP36BTLGX","249/cJOM5Nr4FtLvNAOGqc","2bI/ZeRA5GcpOJ4A4uTXs2","3dGI0N/WBI4bneLfW3zoe4","48+4w6CGBGM7ctr7lgHY9X","58lTRBg75JyKDaiPXEyB4u","59twhWQklG+6ARX2me5BNP","64k/npa81EH6oKnC7vnPVr","78fMw5gclHnoVZP2ZTgaUJ","87aDRbTQ5NnYP7pWdqo71l","8fn7LYthlJzKAK77RhMGkg","912l7D9pZDjJ8IsCcLfR3a","96v7nCnutDRrFrYQwO0h9N","98oY9qar9Mv6DbcmTU1yZD","a9G/3b7gNIErBkKm0u0rZZ","a9/gS0dyNNiq5/xLtyGJWd","ccPeStbcJCD6Ov2QdPoqPU","ccrBdTxCpLF5OAvntI1Mme","ce8cNOpOZIqZKX2wnuN8nA","d5ZliXk0NGN7UeJ3MWUBE1","e2MVMwa6lCTa75C26rqLre","ea018L1wNA5aXgSS3LUlih","eb63lBp2RC5YtUhGJaj5+Z","f5jwZY0DtEUaRtjx5lzNL2","43Sn0iDsdHZYkm3Gm1CUzh","08N5UgzahOHYWHIgUCPNwy","10QTOFnz5JH4JlH0Wt2Ylc","1agOSCspdN2Y+4EUQboyRS","33DPJKEhhPO7bJRVt6/HtQ","70o2mHZ85IsY6qskNkEXQO","77MnVdSE5OToCLwRJTO2xQ","90LzQe7v1P5pcxI1GkkZ8s","91n4LXFaVFxbrEevtVgnA5","a7EYHTWzpOQpM20bc1pyMf","ab45aA29JDfL+fOmzYYDDw","bfLHYpP3RNYatHqK1b9RYk","c4zeOJo7VDQrt+9FkwWbij","cb3QkYGCBGCJZo4rJ5kTl3","cf5GSsM7FPq6bTTZKGzBro","d4dQYTDsJISq/7KHrq284N","e2VKwqf+VOxZmo0m3GM596","e6B7AQnhtLga/JC5chRP3B","f2lW6zakVMVYbbQo83NUaR","61OOLp1rxGl7Olv1jN5zfA","49WdVbLptDULqzRY6kFPAm","1dy3wSX/xBBZwJ013ZJI1Z","705jfedvpFc5Xk17HUaFD0","25YWWLNllMV78JMQ2l/s1S","0cl71X6UJLDIgvsZhgjkpQ","0dybIr3kNFYrJo5LVNQ/d2","0fvmHDc6RJbIoYp2w5iE7A","edpcxcXPNCEZjBmuBLY1o3","eeQYXjDq1JWp6Xz0PLMryP","f3ezQol3RG14x/fT0hh7IU","f9TUnb8w1F55Hvsb5mNVay","ffXacLOlNKELNsWTwyOzy4","d4qEXgk3xBkIwYlNdsa9EW","d74IAg0TJPWqZ59PWtABfz","0eSi/+J+lIooSHsVufRBg3","bdmTnaq0tO4pqOxzq3s/6h","b6yXtiYGxNt64wKE8o0J7b","dczJVnaaxLq7GzE/ROKqmS","90BXMmogFGZJ6ktzXvSqX7","baym3bHORHGoX1yzcf1TwO","53KkCpyhpEfI6eYFBb//2q","b93CiNZcJMRJDBtFIL71Nc","3bPW8diGNO4Lgp45STNZhr","9bvaMerUlDyary99mJa6xp","1371gg7Y5H3rzQdwjRbfwx","a6qMar66JObaX8bWCM/lwO","d3YOrfp3lJSY3d/3lGWr9h","41eMy68xtHgqDIYqTtvw7b","aeEO4dyYNMq7WJIEd8cADG","c5Aqi2a/9L1Y6W+EzE5jp/","4aASxEwOFJZrs73Niki9hF","c8rninSulHZJ8rbgyyDt23","eaIFxZgZFISosIIoKPhGfh","f36ysosrRK47uCOraPea33","08fGFcvPdNWZdtyK1xLYiz","d12XP0H41DiIfbYpvjfDES","2fKee64AlMCYNac5NoCIGu","84oHcWliRAFozn4GsgtbQ3","fd/EMpWXRKQqYK1ANaHOs0","03wYg7/MRFI6isNqocs+rU","3aQLCrEAdO7btsR48X8Uz2","6araGqeL5HWpwwOAr+4pDf","79l1Fp9AhDC4u/ipkMDvSP","7c9DFSRiRCiqbc3YK1ej+u","7dJbAuztREXZAyw+RO5nWm","8brxXK1qxMCZ9pwBHwuFNC","cfCJO2MYBN+al5Zb5i4V1y","a3MCpGng1C94Js3iSGu7sh","c823cnkN5DGpmJc/YyZtwT","73KfIOskpCHoId7sjdLDFx","f1TPwFSBJMRZ3h9Rk26e1x","dfRhjMNeVCUr3hphM8PCKi","3fv+JFfHJLWq/9NqtdauRy","bbJqf24TZEpoBKZnBoWslt","f4BozkHfxE07B/TkLVrWlq","dfBImKiLJN96KLElneVn/G","cfnFtj1nRGUqGQCifzViVb","4fHK1amTRDI7f67V/0ENZp","11UicUf4FO4KUxRkYic+mO","14fEr8aQFGv75Plj7HXkSp","45TEPLtsJDgYcBu4JrF4ce","d19V7gdn9DzZoydFg/xoyP","a1zgaHEnhIeJkObKsWja8R","82Ts1C1yFNe7Zt41FaFmxR","d0Um/+aQVHyYsFudYDxyB2","09We5zzVJIKZo9imp+6pk3","0dG+xhVEpI/a1dqvgUpfS0","c9o88FUspAA7LaJmMs+CXL","c0oIP1aNdMgavZHxrdk7To","58p/1y8ndOK7v94hj1RFQY","5bfQLWAptJNb8yR6vGx8LQ","cb9ZvruDFMbJQy+wW1OJOO","d9X6FFMVREcbi6RUBXeEwa","44Abh1cGBEy4lJuVrm3w8a","00yQHwvKVPlLu1Y2MMLiHM","03N8Br/45Pqpiv4ZZuOSUJ","1c1W84T11Lqo5UPKkfVTq4","6by8NIXcpABq2EGhjlIIIR","a39rlszudBy6hREVq48HTn","13EGop0otEob0sC3niEqmh","e4sb9T7mZGi74X1ThAPsxO","04B8Lq6cZLfofgAX3xOHsn","2462ic0jxOd7iq4S5juDIY","29M1CBQq5KVKqLKNNE0oMU","2cloy+0hxJJrw5ZhEyOhXa","2fV5R6CmhOJLhxlkfuY1JJ","405X5m9U1CPYV6fEE7bSni","49hgYBWs5C0osUMDkiP1E1","77MLzt225Ks6UAeaRb61eN","771HjpdzBOAou466Agbig1","7etzZwyjROK63XBAyNOMcH","80+fkNG2VBqJKstEdvDsoN","9ad94WSyxC94e4c5oWEv3G","9dxAHDNVpFZInS37vkK4HN","9etAaFK51PZbrnMhIaP2ln","a2WJ2LGgJETa7Ost73CQMb","a7SFHajZVLBZTvGuWesfs9","c9xQGizCxG96F7Uswdf2vX","d3+/5yWqlCh6hKbYgOSf6a","ddm1nAhg5OILRCPbQ/3i0c","dengzrX7ZP8L8EQwjkCXSv","f2f+ettlZDpJ3+GMUmV3Y8","8ejYsh0I1FWaB18SRhJkT7","62kpgsRspCGaZkGi0OSuT3","1bc+OpowVGDL2H5Nq81ZIU","f4vzMeh9pCI5HK81xjEKoZ","70hyfLEyVPZ6NWElh0pUs0","99aRqyHVZAhIvyskyFu8ud","a2Us72MnZFYqyXnzcwym3E","2arWAKqSZFSbZqt3qu1F/b","75XfLUf+RO1Kty6TpAsAoq","7cHdOumfNH6qRME2m6dIX1","edeTWuq6tGeqI/+H729wrs","efuzllpyRM6oOo9Vc7THmb","cdpcPhMF1Lrpq2JpusYWJd","99MkjKhSVH9K9SLrr3BKfJ","61UzZAYnFNspSGVW1yOOyZ","ddgH0ZAutBwZ1lTs6I27Xq","42u/87VYNFWZYCeLLN7edf","58kOo3oHVEd5TkG0qVUy5c","c98CEXlVVHyZGZD6kgjOAB","d82K2wLGxGypwmokmT+Mzb","0cpn/XGvhKB4HvESrl74yC","19OH/mLN5GVp77yxYIFzfw","7bP/fR5clOA67RZwIyVKO+","26LAM5msFEf5a5MI6tPwJH","82kiIwMEVMFoYhgCDpoxo8","d8GP73e0ZG86i952iBZcjb","d6sbikBGpFj45VYj1YkPXB"]}; 
 			});
 		define("weapp-adapter.js", function(require, module, exports){ 			
/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};

/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {

/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;

/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};

/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;

/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}


/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;

/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;

/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";

/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

	'use strict';

	var _window2 = __webpack_require__(1);

	var _window = _interopRequireWildcard(_window2);

	function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

	var global = GameGlobal;

	function inject() {
	  _window.addEventListener = function (type, listener) {
	    _window.document.addEventListener(type, listener);
	  };
	  _window.removeEventListener = function (type, listener) {
	    _window.document.removeEventListener(type, listener);
	  };

	  if (_window.canvas) {
	    _window.canvas.addEventListener = _window.addEventListener;
	    _window.canvas.removeEventListener = _window.removeEventListener;
	  }

	  if (global.sharedCanvas) {
	    // eslint-disable-next-line no-undef
	    sharedCanvas.addEventListener = _window.addEventListener;
	    // eslint-disable-next-line no-undef
	    sharedCanvas.removeEventListener = _window.removeEventListener;
	  }

	  var _wx$getSystemInfoSync = wx.getSystemInfoSync(),
	      platform = _wx$getSystemInfoSync.platform;

	  // 开发者工具无法重定义 window


	  if (typeof __devtoolssubcontext === 'undefined' && platform === 'devtools') {
	    for (var key in _window) {
	      var descriptor = Object.getOwnPropertyDescriptor(global, key);

	      if (!descriptor || descriptor.configurable === true) {
	        Object.defineProperty(window, key, {
	          value: _window[key]
	        });
	      }
	    }

	    for (var _key in _window.document) {
	      var _descriptor = Object.getOwnPropertyDescriptor(global.document, _key);

	      if (!_descriptor || _descriptor.configurable === true) {
	        Object.defineProperty(global.document, _key, {
	          value: _window.document[_key]
	        });
	      }
	    }
	    window.parent = window;
	  } else {
	    for (var _key2 in _window) {
	      global[_key2] = _window[_key2];
	    }
	    global.window = _window;
	    window = global;
	    window.top = window.parent = window;
	  }
	}

	if (!GameGlobal.__isAdapterInjected) {
	  GameGlobal.__isAdapterInjected = true;
	  inject();
	}

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.cancelAnimationFrame = exports.requestAnimationFrame = exports.clearInterval = exports.clearTimeout = exports.setInterval = exports.setTimeout = exports.canvas = exports.location = exports.localStorage = exports.HTMLElement = exports.FileReader = exports.Audio = exports.Image = exports.WebSocket = exports.XMLHttpRequest = exports.navigator = exports.document = undefined;

	var _WindowProperties = __webpack_require__(2);

	Object.keys(_WindowProperties).forEach(function (key) {
	  if (key === "default" || key === "__esModule") return;
	  Object.defineProperty(exports, key, {
	    enumerable: true,
	    get: function get() {
	      return _WindowProperties[key];
	    }
	  });
	});

	var _constructor = __webpack_require__(3);

	Object.keys(_constructor).forEach(function (key) {
	  if (key === "default" || key === "__esModule") return;
	  Object.defineProperty(exports, key, {
	    enumerable: true,
	    get: function get() {
	      return _constructor[key];
	    }
	  });
	});

	var _Canvas = __webpack_require__(9);

	var _Canvas2 = _interopRequireDefault(_Canvas);

	var _Util = __webpack_require__(23);

	var _document2 = __webpack_require__(10);

	var _document3 = _interopRequireDefault(_document2);

	var _navigator2 = __webpack_require__(17);

	var _navigator3 = _interopRequireDefault(_navigator2);

	var _XMLHttpRequest2 = __webpack_require__(18);

	var _XMLHttpRequest3 = _interopRequireDefault(_XMLHttpRequest2);

	var _WebSocket2 = __webpack_require__(19);

	var _WebSocket3 = _interopRequireDefault(_WebSocket2);

	var _Image2 = __webpack_require__(11);

	var _Image3 = _interopRequireDefault(_Image2);

	var _Audio2 = __webpack_require__(12);

	var _Audio3 = _interopRequireDefault(_Audio2);

	var _FileReader2 = __webpack_require__(20);

	var _FileReader3 = _interopRequireDefault(_FileReader2);

	var _HTMLElement2 = __webpack_require__(4);

	var _HTMLElement3 = _interopRequireDefault(_HTMLElement2);

	var _localStorage2 = __webpack_require__(21);

	var _localStorage3 = _interopRequireDefault(_localStorage2);

	var _location2 = __webpack_require__(22);

	var _location3 = _interopRequireDefault(_location2);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	exports.document = _document3.default;
	exports.navigator = _navigator3.default;
	exports.XMLHttpRequest = _XMLHttpRequest3.default;
	exports.WebSocket = _WebSocket3.default;
	exports.Image = _Image3.default;
	exports.Audio = _Audio3.default;
	exports.FileReader = _FileReader3.default;
	exports.HTMLElement = _HTMLElement3.default;
	exports.localStorage = _localStorage3.default;
	exports.location = _location3.default;


	// 暴露全局的 canvas
	var canvas = (0, _Util.isSubContext)() ? undefined : new _Canvas2.default();

	exports.canvas = canvas;
	exports.setTimeout = setTimeout;
	exports.setInterval = setInterval;
	exports.clearTimeout = clearTimeout;
	exports.clearInterval = clearInterval;
	exports.requestAnimationFrame = requestAnimationFrame;
	exports.cancelAnimationFrame = cancelAnimationFrame;

/***/ }),
/* 2 */
/***/ (function(module, exports) {

	"use strict";

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});

	var _wx$getSystemInfoSync = wx.getSystemInfoSync(),
	    screenWidth = _wx$getSystemInfoSync.screenWidth,
	    screenHeight = _wx$getSystemInfoSync.screenHeight,
	    devicePixelRatio = _wx$getSystemInfoSync.devicePixelRatio;

	var innerWidth = exports.innerWidth = screenWidth;
	var innerHeight = exports.innerHeight = screenHeight;
	exports.devicePixelRatio = devicePixelRatio;
	var screen = exports.screen = {
	  availWidth: innerWidth,
	  availHeight: innerHeight
	};
	var performance = exports.performance = {
	  now: function now() {
	    return Date.now() / 1000;
	  }
	};
	var ontouchstart = exports.ontouchstart = null;
	var ontouchmove = exports.ontouchmove = null;
	var ontouchend = exports.ontouchend = null;

/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.HTMLCanvasElement = exports.HTMLImageElement = undefined;

	var _HTMLElement3 = __webpack_require__(4);

	var _HTMLElement4 = _interopRequireDefault(_HTMLElement3);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

	var HTMLImageElement = exports.HTMLImageElement = function (_HTMLElement) {
	  _inherits(HTMLImageElement, _HTMLElement);

	  function HTMLImageElement() {
	    _classCallCheck(this, HTMLImageElement);

	    return _possibleConstructorReturn(this, (HTMLImageElement.__proto__ || Object.getPrototypeOf(HTMLImageElement)).call(this, 'img'));
	  }

	  return HTMLImageElement;
	}(_HTMLElement4.default);

	var HTMLCanvasElement = exports.HTMLCanvasElement = function (_HTMLElement2) {
	  _inherits(HTMLCanvasElement, _HTMLElement2);

	  function HTMLCanvasElement() {
	    _classCallCheck(this, HTMLCanvasElement);

	    return _possibleConstructorReturn(this, (HTMLCanvasElement.__proto__ || Object.getPrototypeOf(HTMLCanvasElement)).call(this, 'canvas'));
	  }

	  return HTMLCanvasElement;
	}(_HTMLElement4.default);

/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});

	var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

	var _Element2 = __webpack_require__(5);

	var _Element3 = _interopRequireDefault(_Element2);

	var _util = __webpack_require__(8);

	var _WindowProperties = __webpack_require__(2);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

	var HTMLElement = function (_Element) {
	  _inherits(HTMLElement, _Element);

	  function HTMLElement() {
	    var tagName = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

	    _classCallCheck(this, HTMLElement);

	    var _this = _possibleConstructorReturn(this, (HTMLElement.__proto__ || Object.getPrototypeOf(HTMLElement)).call(this));

	    _this.className = '';
	    _this.childern = [];
	    _this.style = {
	      width: _WindowProperties.innerWidth + 'px',
	      height: _WindowProperties.innerHeight + 'px'
	    };
	    _this.insertBefore = _util.noop;
	    _this.innerHTML = '';

	    _this.tagName = tagName.toUpperCase();
	    return _this;
	  }

	  _createClass(HTMLElement, [{
	    key: 'setAttribute',
	    value: function setAttribute(name, value) {
	      this[name] = value;
	    }
	  }, {
	    key: 'getAttribute',
	    value: function getAttribute(name) {
	      return this[name];
	    }
	  }, {
	    key: 'getBoundingClientRect',
	    value: function getBoundingClientRect() {
	      return {
	        top: 0,
	        left: 0,
	        width: _WindowProperties.innerWidth,
	        height: _WindowProperties.innerHeight
	      };
	    }
	  }, {
	    key: 'focus',
	    value: function focus() {}
	  }, {
	    key: 'clientWidth',
	    get: function get() {
	      var ret = parseInt(this.style.fontSize, 10) * this.innerHTML.length;

	      return Number.isNaN(ret) ? 0 : ret;
	    }
	  }, {
	    key: 'clientHeight',
	    get: function get() {
	      var ret = parseInt(this.style.fontSize, 10);

	      return Number.isNaN(ret) ? 0 : ret;
	    }
	  }]);

	  return HTMLElement;
	}(_Element3.default);

	exports.default = HTMLElement;

/***/ }),
/* 5 */
/***/ (function(module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});

	var _Node2 = __webpack_require__(6);

	var _Node3 = _interopRequireDefault(_Node2);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

	var ELement = function (_Node) {
	  _inherits(ELement, _Node);

	  function ELement() {
	    _classCallCheck(this, ELement);

	    var _this = _possibleConstructorReturn(this, (ELement.__proto__ || Object.getPrototypeOf(ELement)).call(this));

	    _this.className = '';
	    _this.children = [];
	    return _this;
	  }

	  return ELement;
	}(_Node3.default);

	exports.default = ELement;

/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});

	var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

	var _EventTarget2 = __webpack_require__(7);

	var _EventTarget3 = _interopRequireDefault(_EventTarget2);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

	var Node = function (_EventTarget) {
	  _inherits(Node, _EventTarget);

	  function Node() {
	    _classCallCheck(this, Node);

	    var _this = _possibleConstructorReturn(this, (Node.__proto__ || Object.getPrototypeOf(Node)).call(this));

	    _this.childNodes = [];
	    return _this;
	  }

	  _createClass(Node, [{
	    key: 'appendChild',
	    value: function appendChild(node) {
	      if (node instanceof Node) {
	        this.childNodes.push(node);
	      } else {
	        throw new TypeError('Failed to executed \'appendChild\' on \'Node\': parameter 1 is not of type \'Node\'.');
	      }
	    }
	  }, {
	    key: 'cloneNode',
	    value: function cloneNode() {
	      var copyNode = Object.create(this);

	      Object.assign(copyNode, this);
	      return copyNode;
	    }
	  }, {
	    key: 'removeChild',
	    value: function removeChild(node) {
	      var index = this.childNodes.findIndex(function (child) {
	        return child === node;
	      });

	      if (index > -1) {
	        return this.childNodes.splice(index, 1);
	      }
	      return null;
	    }
	  }]);

	  return Node;
	}(_EventTarget3.default);

	exports.default = Node;

/***/ }),
/* 7 */
/***/ (function(module, exports) {

	'use strict';

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});

	var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	var _events = new WeakMap();

	var EventTarget = function () {
	  function EventTarget() {
	    _classCallCheck(this, EventTarget);

	    _events.set(this, {});
	  }

	  _createClass(EventTarget, [{
	    key: 'addEventListener',
	    value: function addEventListener(type, listener) {
	      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};

	      var events = _events.get(this);

	      if (!events) {
	        events = {};
	        _events.set(this, events);
	      }
	      if (!events[type]) {
	        events[type] = [];
	      }
	      events[type].push(listener);

	      if (options.capture) {
	        console.warn('EventTarget.addEventListener: options.capture is not implemented.');
	      }
	      if (options.once) {
	        console.warn('EventTarget.addEventListener: options.once is not implemented.');
	      }
	      if (options.passive) {
	        console.warn('EventTarget.addEventListener: options.passive is not implemented.');
	      }
	    }
	  }, {
	    key: 'removeEventListener',
	    value: function removeEventListener(type, listener) {
	      var listeners = _events.get(this)[type];

	      if (listeners && listeners.length > 0) {
	        for (var i = listeners.length; i--; i > 0) {
	          if (listeners[i] === listener) {
	            listeners.splice(i, 1);
	            break;
	          }
	        }
	      }
	    }
	  }, {
	    key: 'dispatchEvent',
	    value: function dispatchEvent() {
	      var event = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

	      var listeners = _events.get(this)[event.type];

	      if (listeners) {
	        for (var i = 0; i < listeners.length; i++) {
	          listeners[i](event);
	        }
	      }
	    }
	  }]);

	  return EventTarget;
	}();

	exports.default = EventTarget;

/***/ }),
/* 8 */
/***/ (function(module, exports) {

	'use strict';

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.noop = noop;
	exports.isSubContext = isSubContext;
	function noop() {}

	function isSubContext() {
	  return typeof GameGlobal !== 'undefined' && GameGlobal.__isSubContext === true;
	}

/***/ }),
/* 9 */
/***/ (function(module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.default = Canvas;

	var _constructor = __webpack_require__(3);

	var _HTMLElement = __webpack_require__(4);

	var _HTMLElement2 = _interopRequireDefault(_HTMLElement);

	var _document = __webpack_require__(10);

	var _document2 = _interopRequireDefault(_document);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	var hasModifiedCanvasPrototype = false;
	var hasInit2DContextConstructor = false;
	var hasInitWebGLContextConstructor = false;

	function Canvas() {
	  var canvas = wx.createCanvas();

	  canvas.type = 'canvas';

	  canvas.__proto__.__proto__ = new _HTMLElement2.default('canvas');

	  var _getContext = canvas.getContext;

	  canvas.getBoundingClientRect = function () {
	    var ret = {
	      top: 0,
	      left: 0,
	      width: window.innerWidth,
	      height: window.innerHeight
	    };
	    return ret;
	  };

	  return canvas;
	}

/***/ }),
/* 10 */
/***/ (function(module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});

	var _window = __webpack_require__(1);

	var window = _interopRequireWildcard(_window);

	var _HTMLElement = __webpack_require__(4);

	var _HTMLElement2 = _interopRequireDefault(_HTMLElement);

	var _Image = __webpack_require__(11);

	var _Image2 = _interopRequireDefault(_Image);

	var _Audio = __webpack_require__(12);

	var _Audio2 = _interopRequireDefault(_Audio);

	var _Canvas = __webpack_require__(9);

	var _Canvas2 = _interopRequireDefault(_Canvas);

	__webpack_require__(15);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

	var events = {};

	var document = {
	  readyState: 'complete',
	  visibilityState: 'visible',
	  documentElement: window,
	  hidden: false,
	  style: {},
	  location: window.location,
	  ontouchstart: null,
	  ontouchmove: null,
	  ontouchend: null,

	  head: new _HTMLElement2.default('head'),
	  body: new _HTMLElement2.default('body'),

	  createElement: function createElement(tagName) {
	    if (tagName === 'canvas') {
	      return new _Canvas2.default();
	    } else if (tagName === 'audio') {
	      return new _Audio2.default();
	    } else if (tagName === 'img') {
	      return new _Image2.default();
	    }

	    return new _HTMLElement2.default(tagName);
	  },
	  getElementById: function getElementById(id) {
	    if (id === window.canvas.id) {
	      return window.canvas;
	    }
	    return null;
	  },
	  getElementsByTagName: function getElementsByTagName(tagName) {
	    if (tagName === 'head') {
	      return [document.head];
	    } else if (tagName === 'body') {
	      return [document.body];
	    } else if (tagName === 'canvas') {
	      return [window.canvas];
	    }
	    return [];
	  },
	  querySelector: function querySelector(query) {
	    if (query === 'head') {
	      return document.head;
	    } else if (query === 'body') {
	      return document.body;
	    } else if (query === 'canvas') {
	      return window.canvas;
	    } else if (query === '#' + window.canvas.id) {
	      return window.canvas;
	    }
	    return null;
	  },
	  querySelectorAll: function querySelectorAll(query) {
	    if (query === 'head') {
	      return [document.head];
	    } else if (query === 'body') {
	      return [document.body];
	    } else if (query === 'canvas') {
	      return [window.canvas];
	    }
	    return [];
	  },
	  addEventListener: function addEventListener(type, listener) {
	    if (!events[type]) {
	      events[type] = [];
	    }
	    events[type].push(listener);
	  },
	  removeEventListener: function removeEventListener(type, listener) {
	    var listeners = events[type];

	    if (listeners && listeners.length > 0) {
	      for (var i = listeners.length; i--; i > 0) {
	        if (listeners[i] === listener) {
	          listeners.splice(i, 1);
	          break;
	        }
	      }
	    }
	  },
	  dispatchEvent: function dispatchEvent(event) {
	    var listeners = events[event.type];

	    if (listeners) {
	      for (var i = 0; i < listeners.length; i++) {
	        listeners[i](event);
	      }
	    }
	  }
	};

	exports.default = document;

/***/ }),
/* 11 */
/***/ (function(module, exports) {

	"use strict";

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.default = Image;
	function Image() {
	  var image = wx.createImage();

	  return image;
	}

/***/ }),
/* 12 */
/***/ (function(module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});

	var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

	var _HTMLAudioElement2 = __webpack_require__(13);

	var _HTMLAudioElement3 = _interopRequireDefault(_HTMLAudioElement2);

	var _util = __webpack_require__(8);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

	var HAVE_NOTHING = 0;
	var HAVE_METADATA = 1;
	var HAVE_CURRENT_DATA = 2;
	var HAVE_FUTURE_DATA = 3;
	var HAVE_ENOUGH_DATA = 4;

	var _innerAudioContext = new WeakMap();
	var _src = new WeakMap();
	var _loop = new WeakMap();
	var _autoplay = new WeakMap();

	var Audio = function (_HTMLAudioElement) {
	  _inherits(Audio, _HTMLAudioElement);

	  function Audio(url) {
	    _classCallCheck(this, Audio);

	    var _this = _possibleConstructorReturn(this, (Audio.__proto__ || Object.getPrototypeOf(Audio)).call(this));

	    _this.HAVE_NOTHING = HAVE_NOTHING;
	    _this.HAVE_METADATA = HAVE_METADATA;
	    _this.HAVE_CURRENT_DATA = HAVE_CURRENT_DATA;
	    _this.HAVE_FUTURE_DATA = HAVE_FUTURE_DATA;
	    _this.HAVE_ENOUGH_DATA = HAVE_ENOUGH_DATA;
	    _this.readyState = HAVE_NOTHING;


	    if ((0, _util.isSubContext)()) {
	      console.warn('HTMLAudioElement is not supported in SubContext.');
	      return _possibleConstructorReturn(_this);
	    }

	    _src.set(_this, '');

	    var innerAudioContext = wx.createInnerAudioContext();

	    _innerAudioContext.set(_this, innerAudioContext);

	    innerAudioContext.onCanplay(function () {
	      _this.dispatchEvent({ type: 'load' });
	      _this.dispatchEvent({ type: 'loadend' });
	      _this.dispatchEvent({ type: 'canplay' });
	      _this.dispatchEvent({ type: 'canplaythrough' });
	      _this.dispatchEvent({ type: 'loadedmetadata' });
	      _this.readyState = HAVE_CURRENT_DATA;
	    });
	    innerAudioContext.onPlay(function () {
	      _this.dispatchEvent({ type: 'play' });
	    });
	    innerAudioContext.onPause(function () {
	      _this.dispatchEvent({ type: 'pause' });
	    });
	    innerAudioContext.onEnded(function () {
	      _this.dispatchEvent({ type: 'ended' });
	      _this.readyState = HAVE_ENOUGH_DATA;
	    });
	    innerAudioContext.onError(function () {
	      _this.dispatchEvent({ type: 'error' });
	    });

	    if (url) {
	      _innerAudioContext.get(_this).src = url;
	    }
	    return _this;
	  }

	  _createClass(Audio, [{
	    key: 'load',
	    value: function load() {
	      console.warn('HTMLAudioElement.load() is not implemented.');
	    }
	  }, {
	    key: 'play',
	    value: function play() {
	      if (!(0, _util.isSubContext)()) {
	        _innerAudioContext.get(this).play();
	      }
	    }
	  }, {
	    key: 'pause',
	    value: function pause() {
	      if (!(0, _util.isSubContext)()) {
	        _innerAudioContext.get(this).pause();
	      }
	    }
	  }, {
	    key: 'canPlayType',
	    value: function canPlayType() {
	      var mediaType = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

	      if (typeof mediaType !== 'string') {
	        return '';
	      }

	      if (mediaType.indexOf('audio/mpeg') > -1 || mediaType.indexOf('audio/mp4')) {
	        return 'probably';
	      }
	      return '';
	    }
	  }, {
	    key: 'cloneNode',
	    value: function cloneNode() {
	      var newAudio = new Audio();
	      if (!(0, _util.isSubContext)()) {
	        newAudio.loop = _innerAudioContext.get(this).loop;
	        newAudio.autoplay = _innerAudioContext.get(this).loop;
	        newAudio.src = this.src;
	      }
	      return newAudio;
	    }
	  }, {
	    key: 'currentTime',
	    get: function get() {
	      if (!(0, _util.isSubContext)()) {
	        return _innerAudioContext.get(this).currentTime;
	      }
	      return 0;
	    },
	    set: function set(value) {
	      if (!(0, _util.isSubContext)()) {
	        _innerAudioContext.get(this).seek(value);
	      }
	    }
	  }, {
	    key: 'src',
	    get: function get() {
	      return _src.get(this);
	    },
	    set: function set(value) {
	      _src.set(this, value);
	      if (!(0, _util.isSubContext)()) {
	        _innerAudioContext.get(this).src = value;
	      }
	    }
	  }, {
	    key: 'loop',
	    get: function get() {
	      if (!(0, _util.isSubContext)()) {
	        return _innerAudioContext.get(this).loop;
	      }
	      return false;
	    },
	    set: function set(value) {
	      if (!(0, _util.isSubContext)()) {
	        _innerAudioContext.get(this).loop = value;
	      }
	    }
	  }, {
	    key: 'autoplay',
	    get: function get() {
	      if (!(0, _util.isSubContext)()) {
	        return _innerAudioContext.get(this).autoplay;
	      }
	      return false;
	    },
	    set: function set(value) {
	      if (!(0, _util.isSubContext)()) {
	        _innerAudioContext.get(this).autoplay = value;
	      }
	    }
	  }, {
	    key: 'paused',
	    get: function get() {
	      if (!(0, _util.isSubContext)()) {
	        return _innerAudioContext.get(this).paused;
	      }
	      return false;
	    }
	  }]);

	  return Audio;
	}(_HTMLAudioElement3.default);

	exports.default = Audio;

/***/ }),
/* 13 */
/***/ (function(module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});

	var _HTMLMediaElement2 = __webpack_require__(14);

	var _HTMLMediaElement3 = _interopRequireDefault(_HTMLMediaElement2);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

	var HTMLAudioElement = function (_HTMLMediaElement) {
	  _inherits(HTMLAudioElement, _HTMLMediaElement);

	  function HTMLAudioElement() {
	    _classCallCheck(this, HTMLAudioElement);

	    return _possibleConstructorReturn(this, (HTMLAudioElement.__proto__ || Object.getPrototypeOf(HTMLAudioElement)).call(this, 'audio'));
	  }

	  return HTMLAudioElement;
	}(_HTMLMediaElement3.default);

	exports.default = HTMLAudioElement;

/***/ }),
/* 14 */
/***/ (function(module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});

	var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

	var _HTMLElement2 = __webpack_require__(4);

	var _HTMLElement3 = _interopRequireDefault(_HTMLElement2);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

	var HTMLMediaElement = function (_HTMLElement) {
	  _inherits(HTMLMediaElement, _HTMLElement);

	  function HTMLMediaElement(type) {
	    _classCallCheck(this, HTMLMediaElement);

	    return _possibleConstructorReturn(this, (HTMLMediaElement.__proto__ || Object.getPrototypeOf(HTMLMediaElement)).call(this, type));
	  }

	  _createClass(HTMLMediaElement, [{
	    key: 'addTextTrack',
	    value: function addTextTrack() {}
	  }, {
	    key: 'captureStream',
	    value: function captureStream() {}
	  }, {
	    key: 'fastSeek',
	    value: function fastSeek() {}
	  }, {
	    key: 'load',
	    value: function load() {}
	  }, {
	    key: 'pause',
	    value: function pause() {}
	  }, {
	    key: 'play',
	    value: function play() {}
	  }]);

	  return HTMLMediaElement;
	}(_HTMLElement3.default);

	exports.default = HTMLMediaElement;

/***/ }),
/* 15 */
/***/ (function(module, exports, __webpack_require__) {

	'use strict';

	__webpack_require__(16);

/***/ }),
/* 16 */
/***/ (function(module, exports, __webpack_require__) {

	'use strict';

	var _window = __webpack_require__(1);

	var window = _interopRequireWildcard(_window);

	var _document = __webpack_require__(10);

	var _document2 = _interopRequireDefault(_document);

	var _util = __webpack_require__(8);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	var TouchEvent = function TouchEvent(type) {
	  _classCallCheck(this, TouchEvent);

	  this.target = window.canvas;
	  this.currentTarget = window.canvas;
	  this.touches = [];
	  this.targetTouches = [];
	  this.changedTouches = [];
	  this.preventDefault = _util.noop;
	  this.stopPropagation = _util.noop;

	  this.type = type;
	};

	function touchEventHandlerFactory(type) {
	  return function (event) {
	    var touchEvent = new TouchEvent(type);

	    touchEvent.touches = event.touches;
	    touchEvent.targetTouches = Array.prototype.slice.call(event.touches);
	    touchEvent.changedTouches = event.changedTouches;
	    touchEvent.timeStamp = event.timeStamp;
	    _document2.default.dispatchEvent(touchEvent);
	  };
	}

	wx.onTouchStart(touchEventHandlerFactory('touchstart'));
	wx.onTouchMove(touchEventHandlerFactory('touchmove'));
	wx.onTouchEnd(touchEventHandlerFactory('touchend'));
	wx.onTouchCancel(touchEventHandlerFactory('touchcancel'));

/***/ }),
/* 17 */
/***/ (function(module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});

	var _util = __webpack_require__(8);

	// TODO 需要 wx.getSystemInfo 获取更详细信息
	var _wx$getSystemInfoSync = wx.getSystemInfoSync(),
	    platform = _wx$getSystemInfoSync.platform;

	var navigator = {
	  platform: platform,
	  language: 'zh-cn',
	  appVersion: '5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1',
	  userAgent: 'Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E8301 MicroMessenger/6.6.0 MiniGame NetType/WIFI Language/zh_CN',
	  onLine: true, // TODO 用 wx.getNetworkStateChange 和 wx.onNetworkStateChange 来返回真实的状态

	  // TODO 用 wx.getLocation 来封装 geolocation
	  geolocation: {
	    getCurrentPosition: _util.noop,
	    watchPosition: _util.noop,
	    clearWatch: _util.noop
	  }
	};

	exports.default = navigator;

/***/ }),
/* 18 */
/***/ (function(module, exports) {

	'use strict';

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});

	var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	var _url = new WeakMap();
	var _method = new WeakMap();
	var _requestHeader = new WeakMap();
	var _responseHeader = new WeakMap();
	var _requestTask = new WeakMap();

	function _triggerEvent(type) {
	  if (typeof this['on' + type] === 'function') {
	    for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
	      args[_key - 1] = arguments[_key];
	    }

	    this['on' + type].apply(this, args);
	  }
	}

	function _changeReadyState(readyState) {
	  this.readyState = readyState;
	  _triggerEvent.call(this, 'readystatechange');
	}

	var XMLHttpRequest = function () {
	  // TODO 没法模拟 HEADERS_RECEIVED 和 LOADING 两个状态
	  function XMLHttpRequest() {
	    _classCallCheck(this, XMLHttpRequest);

	    this.onabort = null;
	    this.onerror = null;
	    this.onload = null;
	    this.onloadstart = null;
	    this.onprogress = null;
	    this.ontimeout = null;
	    this.onloadend = null;
	    this.onreadystatechange = null;
	    this.readyState = 0;
	    this.response = null;
	    this.responseText = null;
	    this.responseType = '';
	    this.responseXML = null;
	    this.status = 0;
	    this.statusText = '';
	    this.upload = {};
	    this.withCredentials = false;

	    _requestHeader.set(this, {
	      'content-type': 'application/x-www-form-urlencoded'
	    });
	    _responseHeader.set(this, {});
	  }

	  /*
	   * TODO 这一批事件应该是在 XMLHttpRequestEventTarget.prototype 上面的
	   */


	  _createClass(XMLHttpRequest, [{
	    key: 'abort',
	    value: function abort() {
	      var myRequestTask = _requestTask.get(this);

	      if (myRequestTask) {
	        myRequestTask.abort();
	      }
	    }
	  }, {
	    key: 'getAllResponseHeaders',
	    value: function getAllResponseHeaders() {
	      var responseHeader = _responseHeader.get(this);

	      return Object.keys(responseHeader).map(function (header) {
	        return header + ': ' + responseHeader[header];
	      }).join('\n');
	    }
	  }, {
	    key: 'getResponseHeader',
	    value: function getResponseHeader(header) {
	      return _responseHeader.get(this)[header];
	    }
	  }, {
	    key: 'open',
	    value: function open(method, url /* async, user, password 这几个参数在小程序内不支持*/) {
	      _method.set(this, method);
	      _url.set(this, url);
	      _changeReadyState.call(this, XMLHttpRequest.OPENED);
	    }
	  }, {
	    key: 'overrideMimeType',
	    value: function overrideMimeType() {}
	  }, {
	    key: 'send',
	    value: function send() {
	      var _this = this;

	      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

	      if (this.readyState !== XMLHttpRequest.OPENED) {
	        throw new Error("Failed to execute 'send' on 'XMLHttpRequest': The object's state must be OPENED.");
	      } else {
	        wx.request({
	          data: data,
	          url: _url.get(this),
	          method: _method.get(this),
	          header: _requestHeader.get(this),
	          responseType: this.responseType,
	          success: function success(_ref) {
	            var data = _ref.data,
	                statusCode = _ref.statusCode,
	                header = _ref.header;

	            if (typeof data !== 'string' && !(data instanceof ArrayBuffer)) {
	              try {
	                data = JSON.stringify(data);
	              } catch (e) {
	                data = data;
	              }
	            }

	            _this.status = statusCode;
	            _responseHeader.set(_this, header);
	            _triggerEvent.call(_this, 'loadstart');
	            _changeReadyState.call(_this, XMLHttpRequest.HEADERS_RECEIVED);
	            _changeReadyState.call(_this, XMLHttpRequest.LOADING);

	            _this.response = data;

	            if (data instanceof ArrayBuffer) {
	              _this.responseText = '';
	              var bytes = new Uint8Array(data);
	              var len = bytes.byteLength;

	              for (var i = 0; i < len; i++) {
	                _this.responseText += String.fromCharCode(bytes[i]);
	              }
	            } else {
	              _this.responseText = data;
	            }
	            _changeReadyState.call(_this, XMLHttpRequest.DONE);
	            _triggerEvent.call(_this, 'load');
	            _triggerEvent.call(_this, 'loadend');
	          },
	          fail: function fail(_ref2) {
	            var errMsg = _ref2.errMsg;

	            // TODO 规范错误
	            if (errMsg.indexOf('abort') !== -1) {
	              _triggerEvent.call(_this, 'abort');
	            } else {
	              _triggerEvent.call(_this, 'error', errMsg);
	            }
	            _triggerEvent.call(_this, 'loadend');
	          }
	        });
	      }
	    }
	  }, {
	    key: 'setRequestHeader',
	    value: function setRequestHeader(header, value) {
	      var myHeader = _requestHeader.get(this);

	      myHeader[header] = value;
	      _requestHeader.set(this, myHeader);
	    }
	  }]);

	  return XMLHttpRequest;
	}();

	XMLHttpRequest.UNSEND = 0;
	XMLHttpRequest.OPENED = 1;
	XMLHttpRequest.HEADERS_RECEIVED = 2;
	XMLHttpRequest.LOADING = 3;
	XMLHttpRequest.DONE = 4;
	exports.default = XMLHttpRequest;

/***/ }),
/* 19 */
/***/ (function(module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});

	var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

	var _util = __webpack_require__(8);

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	var _socketTask = new WeakMap();

	var WebSocket = function () {
	  // TODO 更新 binaryType
	  // The connection is in the process of closing.
	  // The connection is not yet open.
	  function WebSocket(url) {
	    var _this = this;

	    var protocols = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];

	    _classCallCheck(this, WebSocket);

	    this.binaryType = '';
	    this.bufferedAmount = 0;
	    this.extensions = '';
	    this.onclose = null;
	    this.onerror = null;
	    this.onmessage = null;
	    this.onopen = null;
	    this.protocol = '';
	    this.readyState = 3;

	    if ((0, _util.isSubContext)()) {
	      throw new Error('WebSocket is not supported in SubContext.');
	    }

	    if (typeof url !== 'string' || !/(^ws:\/\/)|(^wss:\/\/)/.test(url)) {
	      throw new TypeError('Failed to construct \'WebSocket\': The URL \'' + url + '\' is invalid');
	    }

	    this.url = url;
	    this.readyState = WebSocket.CONNECTING;

	    var socketTask = wx.connectSocket({
	      url: url,
	      protocols: Array.isArray(protocols) ? protocols : [protocols]
	    });

	    _socketTask.set(this, socketTask);

	    socketTask.onClose(function (res) {
	      _this.readyState = WebSocket.CLOSED;
	      if (typeof _this.onclose === 'function') {
	        _this.onclose(res);
	      }
	    });

	    socketTask.onMessage(function (res) {
	      if (typeof _this.onmessage === 'function') {
	        _this.onmessage(res);
	      }
	    });

	    socketTask.onOpen(function () {
	      _this.readyState = WebSocket.OPEN;
	      if (typeof _this.onopen === 'function') {
	        _this.onopen();
	      }
	    });

	    socketTask.onError(function (res) {
	      if (typeof _this.onerror === 'function') {
	        _this.onerror(new Error(res.errMsg));
	      }
	    });

	    return this;
	  } // TODO 小程序内目前获取不到，实际上需要根据服务器选择的 sub-protocol 返回
	  // TODO 更新 bufferedAmount
	  // The connection is closed or couldn't be opened.

	  // The connection is open and ready to communicate.


	  _createClass(WebSocket, [{
	    key: 'close',
	    value: function close(code, reason) {
	      this.readyState = WebSocket.CLOSING;
	      var socketTask = _socketTask.get(this);

	      socketTask.close({
	        code: code,
	        reason: reason
	      });
	    }
	  }, {
	    key: 'send',
	    value: function send(data) {
	      if (typeof data !== 'string' && !(data instanceof ArrayBuffer)) {
	        throw new TypeError('Failed to send message: The data ' + data + ' is invalid');
	      }

	      var socketTask = _socketTask.get(this);

	      socketTask.send({
	        data: data
	      });
	    }
	  }]);

	  return WebSocket;
	}();

	WebSocket.CONNECTING = 0;
	WebSocket.OPEN = 1;
	WebSocket.CLOSING = 2;
	WebSocket.CLOSED = 3;
	exports.default = WebSocket;

/***/ }),
/* 20 */
/***/ (function(module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});

	var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

	var _util = __webpack_require__(8);

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	/*
	 * TODO 使用 wx.readFile 来封装 FileReader
	 */
	var FileReader = function () {
	  function FileReader() {
	    _classCallCheck(this, FileReader);
	  }

	  _createClass(FileReader, [{
	    key: 'construct',
	    value: function construct() {
	      if ((0, _util.isSubContext)()) {
	        throw new Error('FileReader is not supported in SubContext.');
	      }
	    }
	  }]);

	  return FileReader;
	}();

	exports.default = FileReader;

/***/ }),
/* 21 */
/***/ (function(module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});

	var _util = __webpack_require__(8);

	var mainContext = {
	  get length() {
	    var _wx$getStorageInfoSyn = wx.getStorageInfoSync(),
	        keys = _wx$getStorageInfoSyn.keys;

	    return keys.length;
	  },

	  key: function key(n) {
	    var _wx$getStorageInfoSyn2 = wx.getStorageInfoSync(),
	        keys = _wx$getStorageInfoSyn2.keys;

	    return keys[n];
	  },
	  getItem: function getItem(key) {
	    return wx.getStorageSync(key);
	  },
	  setItem: function setItem(key, value) {
	    return wx.setStorageSync(key, value);
	  },
	  removeItem: function removeItem(key) {
	    wx.removeStorageSync(key);
	  },
	  clear: function clear() {
	    wx.clearStorageSync();
	  }
	};

	var memLocalStorage = {};

	var subContext = {
	  get length() {
	    var keys = Object.keys(memLocalStorage);

	    return keys.length;
	  },

	  key: function key(n) {
	    var keys = Object.keys(memLocalStorage);

	    return keys[n];
	  },
	  getItem: function getItem(key) {
	    return memLocalStorage[key];
	  },
	  setItem: function setItem(key, value) {
	    memLocalStorage[key] = value;
	  },
	  removeItem: function removeItem(key) {
	    delete memLocalStorage[key];
	  },
	  clear: function clear() {
	    memLocalStorage = {};
	  }
	};

	var localStorage = (0, _util.isSubContext)() ? subContext : mainContext;

	exports.default = localStorage;

/***/ }),
/* 22 */
/***/ (function(module, exports) {

	'use strict';

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	var location = {
	  href: 'game.js',
	  reload: function reload() {}
	};

	exports.default = location;

/***/ }),
/* 23 */
/***/ (function(module, exports) {

	'use strict';

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.noop = noop;
	exports.isSubContext = isSubContext;
	function noop() {}

	function isSubContext() {
	  return typeof GameGlobal !== 'undefined' && GameGlobal.__isSubContext === true;
	}

/***/ })
/******/ ]); 
 			});
 		define("game.js", function(require, module, exports){ 			
require("./weapp-adapter");
require("./gamesettingconfig");
require("./src/settings");
if (false) {
  require("./CocosCreator161/index.js");
}
else {
  require("./cocos2d-js-min");
}

var isDebug = window._CCSettings.debug;
if (isDebug === true) {
  require("./src/project.dev");
}
else {
  require("./src/project");
}

require("./main");

wx.onWindowResize &&  wx.onWindowResize(function(res) {
	cc.error("window resize: height"+res.windowHeight + " width: "+res.windowWidth);
  //cc.view.setFrameSize(res.windowWidth,res.windowHeight);
}); 
 			}); 	require("game.js");
 	